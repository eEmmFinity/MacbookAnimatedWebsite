var JF=($,j)=>()=>(j||$((j={exports:{}}).exports,j),j.exports);var ZF=JF((exports,module)=>{function _mergeNamespaces($,j){for(var it=0;it<j.length;it++){const et=j[it];if(typeof et!="string"&&!Array.isArray(et)){for(const ut in et)if(ut!=="default"&&!(ut in $)){const dt=Object.getOwnPropertyDescriptor(et,ut);dt&&Object.defineProperty($,ut,dt.get?dt:{enumerable:!0,get:()=>et[ut]})}}}return Object.freeze(Object.defineProperty($,Symbol.toStringTag,{value:"Module"}))}(function(){const j=document.createElement("link").relList;if(j&&j.supports&&j.supports("modulepreload"))return;for(const ut of document.querySelectorAll('link[rel="modulepreload"]'))et(ut);new MutationObserver(ut=>{for(const dt of ut)if(dt.type==="childList")for(const mt of dt.addedNodes)mt.tagName==="LINK"&&mt.rel==="modulepreload"&&et(mt)}).observe(document,{childList:!0,subtree:!0});function it(ut){const dt={};return ut.integrity&&(dt.integrity=ut.integrity),ut.referrerPolicy&&(dt.referrerPolicy=ut.referrerPolicy),ut.crossOrigin==="use-credentials"?dt.credentials="include":ut.crossOrigin==="anonymous"?dt.credentials="omit":dt.credentials="same-origin",dt}function et(ut){if(ut.ep)return;ut.ep=!0;const dt=it(ut);fetch(ut.href,dt)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs($){return $&&$.__esModule&&Object.prototype.hasOwnProperty.call($,"default")?$.default:$}function getAugmentedNamespace($){if($.__esModule)return $;var j=$.default;if(typeof j=="function"){var it=function et(){return this instanceof et?Reflect.construct(j,arguments,this.constructor):j.apply(this,arguments)};it.prototype=j.prototype}else it={};return Object.defineProperty(it,"__esModule",{value:!0}),Object.keys($).forEach(function(et){var ut=Object.getOwnPropertyDescriptor($,et);Object.defineProperty(it,et,ut.get?ut:{enumerable:!0,get:function(){return $[et]}})}),it}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$2=Symbol.for("react.element"),n$2=Symbol.for("react.portal"),p$3=Symbol.for("react.fragment"),q$2=Symbol.for("react.strict_mode"),r$1=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u$1=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w$1=Symbol.for("react.suspense"),x$1=Symbol.for("react.memo"),y$1=Symbol.for("react.lazy"),z$2=Symbol.iterator;function A$2($){return $===null||typeof $!="object"?null:($=z$2&&$[z$2]||$["@@iterator"],typeof $=="function"?$:null)}var B$2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$2=Object.assign,D$2={};function E$2($,j,it){this.props=$,this.context=j,this.refs=D$2,this.updater=it||B$2}E$2.prototype.isReactComponent={};E$2.prototype.setState=function($,j){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,j,"setState")};E$2.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function F$1(){}F$1.prototype=E$2.prototype;function G$2($,j,it){this.props=$,this.context=j,this.refs=D$2,this.updater=it||B$2}var H$2=G$2.prototype=new F$1;H$2.constructor=G$2;C$2(H$2,E$2.prototype);H$2.isPureReactComponent=!0;var I$2=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1($,j,it){var et,ut={},dt=null,mt=null;if(j!=null)for(et in j.ref!==void 0&&(mt=j.ref),j.key!==void 0&&(dt=""+j.key),j)J.call(j,et)&&!L$1.hasOwnProperty(et)&&(ut[et]=j[et]);var yt=arguments.length-2;if(yt===1)ut.children=it;else if(1<yt){for(var bt=Array(yt),Rt=0;Rt<yt;Rt++)bt[Rt]=arguments[Rt+2];ut.children=bt}if($&&$.defaultProps)for(et in yt=$.defaultProps,yt)ut[et]===void 0&&(ut[et]=yt[et]);return{$$typeof:l$2,type:$,key:dt,ref:mt,props:ut,_owner:K$1.current}}function N$1($,j){return{$$typeof:l$2,type:$.type,key:j,ref:$.ref,props:$.props,_owner:$._owner}}function O$1($){return typeof $=="object"&&$!==null&&$.$$typeof===l$2}function escape$1($){var j={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(it){return j[it]})}var P$1=/\/+/g;function Q$1($,j){return typeof $=="object"&&$!==null&&$.key!=null?escape$1(""+$.key):j.toString(36)}function R$1($,j,it,et,ut){var dt=typeof $;(dt==="undefined"||dt==="boolean")&&($=null);var mt=!1;if($===null)mt=!0;else switch(dt){case"string":case"number":mt=!0;break;case"object":switch($.$$typeof){case l$2:case n$2:mt=!0}}if(mt)return mt=$,ut=ut(mt),$=et===""?"."+Q$1(mt,0):et,I$2(ut)?(it="",$!=null&&(it=$.replace(P$1,"$&/")+"/"),R$1(ut,j,it,"",function(Rt){return Rt})):ut!=null&&(O$1(ut)&&(ut=N$1(ut,it+(!ut.key||mt&&mt.key===ut.key?"":(""+ut.key).replace(P$1,"$&/")+"/")+$)),j.push(ut)),1;if(mt=0,et=et===""?".":et+":",I$2($))for(var yt=0;yt<$.length;yt++){dt=$[yt];var bt=et+Q$1(dt,yt);mt+=R$1(dt,j,it,bt,ut)}else if(bt=A$2($),typeof bt=="function")for($=bt.call($),yt=0;!(dt=$.next()).done;)dt=dt.value,bt=et+Q$1(dt,yt++),mt+=R$1(dt,j,it,bt,ut);else if(dt==="object")throw j=String($),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.");return mt}function S$1($,j,it){if($==null)return $;var et=[],ut=0;return R$1($,et,"","",function(dt){return j.call(it,dt,ut++)}),et}function T$1($){if($._status===-1){var j=$._result;j=j(),j.then(function(it){($._status===0||$._status===-1)&&($._status=1,$._result=it)},function(it){($._status===0||$._status===-1)&&($._status=2,$._result=it)}),$._status===-1&&($._status=0,$._result=j)}if($._status===1)return $._result.default;throw $._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};react_production_min.Children={map:S$1,forEach:function($,j,it){S$1($,function(){j.apply(this,arguments)},it)},count:function($){var j=0;return S$1($,function(){j++}),j},toArray:function($){return S$1($,function(j){return j})||[]},only:function($){if(!O$1($))throw Error("React.Children.only expected to receive a single React element child.");return $}};react_production_min.Component=E$2;react_production_min.Fragment=p$3;react_production_min.Profiler=r$1;react_production_min.PureComponent=G$2;react_production_min.StrictMode=q$2;react_production_min.Suspense=w$1;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.cloneElement=function($,j,it){if($==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+$+".");var et=C$2({},$.props),ut=$.key,dt=$.ref,mt=$._owner;if(j!=null){if(j.ref!==void 0&&(dt=j.ref,mt=K$1.current),j.key!==void 0&&(ut=""+j.key),$.type&&$.type.defaultProps)var yt=$.type.defaultProps;for(bt in j)J.call(j,bt)&&!L$1.hasOwnProperty(bt)&&(et[bt]=j[bt]===void 0&&yt!==void 0?yt[bt]:j[bt])}var bt=arguments.length-2;if(bt===1)et.children=it;else if(1<bt){yt=Array(bt);for(var Rt=0;Rt<bt;Rt++)yt[Rt]=arguments[Rt+2];et.children=yt}return{$$typeof:l$2,type:$.type,key:ut,ref:dt,props:et,_owner:mt}};react_production_min.createContext=function($){return $={$$typeof:u$1,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},$.Provider={$$typeof:t,_context:$},$.Consumer=$};react_production_min.createElement=M$1;react_production_min.createFactory=function($){var j=M$1.bind(null,$);return j.type=$,j};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function($){return{$$typeof:v$2,render:$}};react_production_min.isValidElement=O$1;react_production_min.lazy=function($){return{$$typeof:y$1,_payload:{_status:-1,_result:$},_init:T$1}};react_production_min.memo=function($,j){return{$$typeof:x$1,type:$,compare:j===void 0?null:j}};react_production_min.startTransition=function($){var j=V$1.transition;V$1.transition={};try{$()}finally{V$1.transition=j}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function($,j){return U$1.current.useCallback($,j)};react_production_min.useContext=function($){return U$1.current.useContext($)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function($){return U$1.current.useDeferredValue($)};react_production_min.useEffect=function($,j){return U$1.current.useEffect($,j)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function($,j,it){return U$1.current.useImperativeHandle($,j,it)};react_production_min.useInsertionEffect=function($,j){return U$1.current.useInsertionEffect($,j)};react_production_min.useLayoutEffect=function($,j){return U$1.current.useLayoutEffect($,j)};react_production_min.useMemo=function($,j){return U$1.current.useMemo($,j)};react_production_min.useReducer=function($,j,it){return U$1.current.useReducer($,j,it)};react_production_min.useRef=function($){return U$1.current.useRef($)};react_production_min.useState=function($){return U$1.current.useState($)};react_production_min.useSyncExternalStore=function($,j,it){return U$1.current.useSyncExternalStore($,j,it)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.2.0";react.exports=react_production_min;var reactExports=react.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$1=reactExports,k$2=Symbol.for("react.element"),l$1=Symbol.for("react.fragment"),m$2=Object.prototype.hasOwnProperty,n$1=f$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$2={key:!0,ref:!0,__self:!0,__source:!0};function q$1($,j,it){var et,ut={},dt=null,mt=null;it!==void 0&&(dt=""+it),j.key!==void 0&&(dt=""+j.key),j.ref!==void 0&&(mt=j.ref);for(et in j)m$2.call(j,et)&&!p$2.hasOwnProperty(et)&&(ut[et]=j[et]);if($&&$.defaultProps)for(et in j=$.defaultProps,j)ut[et]===void 0&&(ut[et]=j[et]);return{$$typeof:k$2,type:$,key:dt,ref:mt,props:ut,_owner:n$1.current}}reactJsxRuntime_production_min.Fragment=l$1;reactJsxRuntime_production_min.jsx=q$1;reactJsxRuntime_production_min.jsxs=q$1;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports;const jsx=jsxRuntimeExports.jsx,jsxs=jsxRuntimeExports.jsxs;var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function($){function j(qr,nn){var yr=qr.length;qr.push(nn);e:for(;0<yr;){var an=yr-1>>>1,sn=qr[an];if(0<ut(sn,nn))qr[an]=nn,qr[yr]=sn,yr=an;else break e}}function it(qr){return qr.length===0?null:qr[0]}function et(qr){if(qr.length===0)return null;var nn=qr[0],yr=qr.pop();if(yr!==nn){qr[0]=yr;e:for(var an=0,sn=qr.length,Rn=sn>>>1;an<Rn;){var Jr=2*(an+1)-1,mr=qr[Jr],Ar=Jr+1,jr=qr[Ar];if(0>ut(mr,yr))Ar<sn&&0>ut(jr,mr)?(qr[an]=jr,qr[Ar]=yr,an=Ar):(qr[an]=mr,qr[Jr]=yr,an=Jr);else if(Ar<sn&&0>ut(jr,yr))qr[an]=jr,qr[Ar]=yr,an=Ar;else break e}}return nn}function ut(qr,nn){var yr=qr.sortIndex-nn.sortIndex;return yr!==0?yr:qr.id-nn.id}if(typeof performance=="object"&&typeof performance.now=="function"){var dt=performance;$.unstable_now=function(){return dt.now()}}else{var mt=Date,yt=mt.now();$.unstable_now=function(){return mt.now()-yt}}var bt=[],Rt=[],jt=1,Vt=null,zt=3,Jt=!1,rr=!1,Yt=!1,dr=typeof setTimeout=="function"?setTimeout:null,Ft=typeof clearTimeout=="function"?clearTimeout:null,Ht=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function er(qr){for(var nn=it(Rt);nn!==null;){if(nn.callback===null)et(Rt);else if(nn.startTime<=qr)et(Rt),nn.sortIndex=nn.expirationTime,j(bt,nn);else break;nn=it(Rt)}}function pr(qr){if(Yt=!1,er(qr),!rr)if(it(bt)!==null)rr=!0,tn(or);else{var nn=it(Rt);nn!==null&&Tn(pr,nn.startTime-qr)}}function or(qr,nn){rr=!1,Yt&&(Yt=!1,Ft(Zt),Zt=-1),Jt=!0;var yr=zt;try{for(er(nn),Vt=it(bt);Vt!==null&&(!(Vt.expirationTime>nn)||qr&&!vr());){var an=Vt.callback;if(typeof an=="function"){Vt.callback=null,zt=Vt.priorityLevel;var sn=an(Vt.expirationTime<=nn);nn=$.unstable_now(),typeof sn=="function"?Vt.callback=sn:Vt===it(bt)&&et(bt),er(nn)}else et(bt);Vt=it(bt)}if(Vt!==null)var Rn=!0;else{var Jr=it(Rt);Jr!==null&&Tn(pr,Jr.startTime-nn),Rn=!1}return Rn}finally{Vt=null,zt=yr,Jt=!1}}var ar=!1,Wt=null,Zt=-1,sr=5,tr=-1;function vr(){return!($.unstable_now()-tr<sr)}function Vr(){if(Wt!==null){var qr=$.unstable_now();tr=qr;var nn=!0;try{nn=Wt(!0,qr)}finally{nn?hn():(ar=!1,Wt=null)}}else ar=!1}var hn;if(typeof Ht=="function")hn=function(){Ht(Vr)};else if(typeof MessageChannel<"u"){var cn=new MessageChannel,gn=cn.port2;cn.port1.onmessage=Vr,hn=function(){gn.postMessage(null)}}else hn=function(){dr(Vr,0)};function tn(qr){Wt=qr,ar||(ar=!0,hn())}function Tn(qr,nn){Zt=dr(function(){qr($.unstable_now())},nn)}$.unstable_IdlePriority=5,$.unstable_ImmediatePriority=1,$.unstable_LowPriority=4,$.unstable_NormalPriority=3,$.unstable_Profiling=null,$.unstable_UserBlockingPriority=2,$.unstable_cancelCallback=function(qr){qr.callback=null},$.unstable_continueExecution=function(){rr||Jt||(rr=!0,tn(or))},$.unstable_forceFrameRate=function(qr){0>qr||125<qr?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):sr=0<qr?Math.floor(1e3/qr):5},$.unstable_getCurrentPriorityLevel=function(){return zt},$.unstable_getFirstCallbackNode=function(){return it(bt)},$.unstable_next=function(qr){switch(zt){case 1:case 2:case 3:var nn=3;break;default:nn=zt}var yr=zt;zt=nn;try{return qr()}finally{zt=yr}},$.unstable_pauseExecution=function(){},$.unstable_requestPaint=function(){},$.unstable_runWithPriority=function(qr,nn){switch(qr){case 1:case 2:case 3:case 4:case 5:break;default:qr=3}var yr=zt;zt=qr;try{return nn()}finally{zt=yr}},$.unstable_scheduleCallback=function(qr,nn,yr){var an=$.unstable_now();switch(typeof yr=="object"&&yr!==null?(yr=yr.delay,yr=typeof yr=="number"&&0<yr?an+yr:an):yr=an,qr){case 1:var sn=-1;break;case 2:sn=250;break;case 5:sn=1073741823;break;case 4:sn=1e4;break;default:sn=5e3}return sn=yr+sn,qr={id:jt++,callback:nn,priorityLevel:qr,startTime:yr,expirationTime:sn,sortIndex:-1},yr>an?(qr.sortIndex=yr,j(Rt,qr),it(bt)===null&&qr===it(Rt)&&(Yt?(Ft(Zt),Zt=-1):Yt=!0,Tn(pr,yr-an))):(qr.sortIndex=sn,j(bt,qr),rr||Jt||(rr=!0,tn(or))),qr},$.unstable_shouldYield=vr,$.unstable_wrapCallback=function(qr){var nn=zt;return function(){var yr=zt;zt=nn;try{return qr.apply(this,arguments)}finally{zt=yr}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$1($){for(var j="https://reactjs.org/docs/error-decoder.html?invariant="+$,it=1;it<arguments.length;it++)j+="&args[]="+encodeURIComponent(arguments[it]);return"Minified React error #"+$+"; visit "+j+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa($,j){ha($,j),ha($+"Capture",j)}function ha($,j){for(ea[$]=j,$=0;$<j.length;$++)da.add(j[$])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa($){return ja.call(ma,$)?!0:ja.call(la,$)?!1:ka.test($)?ma[$]=!0:(la[$]=!0,!1)}function pa($,j,it,et){if(it!==null&&it.type===0)return!1;switch(typeof j){case"function":case"symbol":return!0;case"boolean":return et?!1:it!==null?!it.acceptsBooleans:($=$.toLowerCase().slice(0,5),$!=="data-"&&$!=="aria-");default:return!1}}function qa($,j,it,et){if(j===null||typeof j>"u"||pa($,j,it,et))return!0;if(et)return!1;if(it!==null)switch(it.type){case 3:return!j;case 4:return j===!1;case 5:return isNaN(j);case 6:return isNaN(j)||1>j}return!1}function v$1($,j,it,et,ut,dt,mt){this.acceptsBooleans=j===2||j===3||j===4,this.attributeName=et,this.attributeNamespace=ut,this.mustUseProperty=it,this.propertyName=$,this.type=j,this.sanitizeURL=dt,this.removeEmptyString=mt}var z$1={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function($){z$1[$]=new v$1($,0,!1,$,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function($){var j=$[0];z$1[j]=new v$1(j,1,!1,$[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function($){z$1[$]=new v$1($,2,!1,$.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function($){z$1[$]=new v$1($,2,!1,$,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function($){z$1[$]=new v$1($,3,!1,$.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function($){z$1[$]=new v$1($,3,!0,$,null,!1,!1)});["capture","download"].forEach(function($){z$1[$]=new v$1($,4,!1,$,null,!1,!1)});["cols","rows","size","span"].forEach(function($){z$1[$]=new v$1($,6,!1,$,null,!1,!1)});["rowSpan","start"].forEach(function($){z$1[$]=new v$1($,5,!1,$.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa($){return $[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function($){var j=$.replace(ra,sa);z$1[j]=new v$1(j,1,!1,$,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function($){var j=$.replace(ra,sa);z$1[j]=new v$1(j,1,!1,$,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function($){var j=$.replace(ra,sa);z$1[j]=new v$1(j,1,!1,$,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function($){z$1[$]=new v$1($,1,!1,$.toLowerCase(),null,!1,!1)});z$1.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function($){z$1[$]=new v$1($,1,!1,$.toLowerCase(),null,!0,!0)});function ta($,j,it,et){var ut=z$1.hasOwnProperty(j)?z$1[j]:null;(ut!==null?ut.type!==0:et||!(2<j.length)||j[0]!=="o"&&j[0]!=="O"||j[1]!=="n"&&j[1]!=="N")&&(qa(j,it,ut,et)&&(it=null),et||ut===null?oa(j)&&(it===null?$.removeAttribute(j):$.setAttribute(j,""+it)):ut.mustUseProperty?$[ut.propertyName]=it===null?ut.type===3?!1:"":it:(j=ut.attributeName,et=ut.attributeNamespace,it===null?$.removeAttribute(j):(ut=ut.type,it=ut===3||ut===4&&it===!0?"":""+it,et?$.setAttributeNS(et,j,it):$.setAttribute(j,it))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka($){return $===null||typeof $!="object"?null:($=Ja&&$[Ja]||$["@@iterator"],typeof $=="function"?$:null)}var A$1=Object.assign,La;function Ma($){if(La===void 0)try{throw Error()}catch(it){var j=it.stack.trim().match(/\n( *(at )?)/);La=j&&j[1]||""}return`
`+La+$}var Na=!1;function Oa($,j){if(!$||Na)return"";Na=!0;var it=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(j)if(j=function(){throw Error()},Object.defineProperty(j.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(j,[])}catch(Rt){var et=Rt}Reflect.construct($,[],j)}else{try{j.call()}catch(Rt){et=Rt}$.call(j.prototype)}else{try{throw Error()}catch(Rt){et=Rt}$()}}catch(Rt){if(Rt&&et&&typeof Rt.stack=="string"){for(var ut=Rt.stack.split(`
`),dt=et.stack.split(`
`),mt=ut.length-1,yt=dt.length-1;1<=mt&&0<=yt&&ut[mt]!==dt[yt];)yt--;for(;1<=mt&&0<=yt;mt--,yt--)if(ut[mt]!==dt[yt]){if(mt!==1||yt!==1)do if(mt--,yt--,0>yt||ut[mt]!==dt[yt]){var bt=`
`+ut[mt].replace(" at new "," at ");return $.displayName&&bt.includes("<anonymous>")&&(bt=bt.replace("<anonymous>",$.displayName)),bt}while(1<=mt&&0<=yt);break}}}finally{Na=!1,Error.prepareStackTrace=it}return($=$?$.displayName||$.name:"")?Ma($):""}function Pa($){switch($.tag){case 5:return Ma($.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return $=Oa($.type,!1),$;case 11:return $=Oa($.type.render,!1),$;case 1:return $=Oa($.type,!0),$;default:return""}}function Qa($){if($==null)return null;if(typeof $=="function")return $.displayName||$.name||null;if(typeof $=="string")return $;switch($){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof $=="object")switch($.$$typeof){case Ca:return($.displayName||"Context")+".Consumer";case Ba:return($._context.displayName||"Context")+".Provider";case Da:var j=$.render;return $=$.displayName,$||($=j.displayName||j.name||"",$=$!==""?"ForwardRef("+$+")":"ForwardRef"),$;case Ga:return j=$.displayName||null,j!==null?j:Qa($.type)||"Memo";case Ha:j=$._payload,$=$._init;try{return Qa($(j))}catch{}}return null}function Ra($){var j=$.type;switch($.tag){case 24:return"Cache";case 9:return(j.displayName||"Context")+".Consumer";case 10:return(j._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return $=j.render,$=$.displayName||$.name||"",j.displayName||($!==""?"ForwardRef("+$+")":"ForwardRef");case 7:return"Fragment";case 5:return j;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(j);case 8:return j===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof j=="function")return j.displayName||j.name||null;if(typeof j=="string")return j}return null}function Sa($){switch(typeof $){case"boolean":case"number":case"string":case"undefined":return $;case"object":return $;default:return""}}function Ta($){var j=$.type;return($=$.nodeName)&&$.toLowerCase()==="input"&&(j==="checkbox"||j==="radio")}function Ua($){var j=Ta($)?"checked":"value",it=Object.getOwnPropertyDescriptor($.constructor.prototype,j),et=""+$[j];if(!$.hasOwnProperty(j)&&typeof it<"u"&&typeof it.get=="function"&&typeof it.set=="function"){var ut=it.get,dt=it.set;return Object.defineProperty($,j,{configurable:!0,get:function(){return ut.call(this)},set:function(mt){et=""+mt,dt.call(this,mt)}}),Object.defineProperty($,j,{enumerable:it.enumerable}),{getValue:function(){return et},setValue:function(mt){et=""+mt},stopTracking:function(){$._valueTracker=null,delete $[j]}}}}function Va($){$._valueTracker||($._valueTracker=Ua($))}function Wa($){if(!$)return!1;var j=$._valueTracker;if(!j)return!0;var it=j.getValue(),et="";return $&&(et=Ta($)?$.checked?"true":"false":$.value),$=et,$!==it?(j.setValue($),!0):!1}function Xa($){if($=$||(typeof document<"u"?document:void 0),typeof $>"u")return null;try{return $.activeElement||$.body}catch{return $.body}}function Ya($,j){var it=j.checked;return A$1({},j,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:it??$._wrapperState.initialChecked})}function Za($,j){var it=j.defaultValue==null?"":j.defaultValue,et=j.checked!=null?j.checked:j.defaultChecked;it=Sa(j.value!=null?j.value:it),$._wrapperState={initialChecked:et,initialValue:it,controlled:j.type==="checkbox"||j.type==="radio"?j.checked!=null:j.value!=null}}function ab($,j){j=j.checked,j!=null&&ta($,"checked",j,!1)}function bb($,j){ab($,j);var it=Sa(j.value),et=j.type;if(it!=null)et==="number"?(it===0&&$.value===""||$.value!=it)&&($.value=""+it):$.value!==""+it&&($.value=""+it);else if(et==="submit"||et==="reset"){$.removeAttribute("value");return}j.hasOwnProperty("value")?cb($,j.type,it):j.hasOwnProperty("defaultValue")&&cb($,j.type,Sa(j.defaultValue)),j.checked==null&&j.defaultChecked!=null&&($.defaultChecked=!!j.defaultChecked)}function db($,j,it){if(j.hasOwnProperty("value")||j.hasOwnProperty("defaultValue")){var et=j.type;if(!(et!=="submit"&&et!=="reset"||j.value!==void 0&&j.value!==null))return;j=""+$._wrapperState.initialValue,it||j===$.value||($.value=j),$.defaultValue=j}it=$.name,it!==""&&($.name=""),$.defaultChecked=!!$._wrapperState.initialChecked,it!==""&&($.name=it)}function cb($,j,it){(j!=="number"||Xa($.ownerDocument)!==$)&&(it==null?$.defaultValue=""+$._wrapperState.initialValue:$.defaultValue!==""+it&&($.defaultValue=""+it))}var eb=Array.isArray;function fb($,j,it,et){if($=$.options,j){j={};for(var ut=0;ut<it.length;ut++)j["$"+it[ut]]=!0;for(it=0;it<$.length;it++)ut=j.hasOwnProperty("$"+$[it].value),$[it].selected!==ut&&($[it].selected=ut),ut&&et&&($[it].defaultSelected=!0)}else{for(it=""+Sa(it),j=null,ut=0;ut<$.length;ut++){if($[ut].value===it){$[ut].selected=!0,et&&($[ut].defaultSelected=!0);return}j!==null||$[ut].disabled||(j=$[ut])}j!==null&&(j.selected=!0)}}function gb($,j){if(j.dangerouslySetInnerHTML!=null)throw Error(p$1(91));return A$1({},j,{value:void 0,defaultValue:void 0,children:""+$._wrapperState.initialValue})}function hb($,j){var it=j.value;if(it==null){if(it=j.children,j=j.defaultValue,it!=null){if(j!=null)throw Error(p$1(92));if(eb(it)){if(1<it.length)throw Error(p$1(93));it=it[0]}j=it}j==null&&(j=""),it=j}$._wrapperState={initialValue:Sa(it)}}function ib($,j){var it=Sa(j.value),et=Sa(j.defaultValue);it!=null&&(it=""+it,it!==$.value&&($.value=it),j.defaultValue==null&&$.defaultValue!==it&&($.defaultValue=it)),et!=null&&($.defaultValue=""+et)}function jb($){var j=$.textContent;j===$._wrapperState.initialValue&&j!==""&&j!==null&&($.value=j)}function kb($){switch($){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb($,j){return $==null||$==="http://www.w3.org/1999/xhtml"?kb(j):$==="http://www.w3.org/2000/svg"&&j==="foreignObject"?"http://www.w3.org/1999/xhtml":$}var mb,nb=function($){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(j,it,et,ut){MSApp.execUnsafeLocalFunction(function(){return $(j,it,et,ut)})}:$}(function($,j){if($.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in $)$.innerHTML=j;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+j.valueOf().toString()+"</svg>",j=mb.firstChild;$.firstChild;)$.removeChild($.firstChild);for(;j.firstChild;)$.appendChild(j.firstChild)}});function ob($,j){if(j){var it=$.firstChild;if(it&&it===$.lastChild&&it.nodeType===3){it.nodeValue=j;return}}$.textContent=j}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function($){qb.forEach(function(j){j=j+$.charAt(0).toUpperCase()+$.substring(1),pb[j]=pb[$]})});function rb($,j,it){return j==null||typeof j=="boolean"||j===""?"":it||typeof j!="number"||j===0||pb.hasOwnProperty($)&&pb[$]?(""+j).trim():j+"px"}function sb($,j){$=$.style;for(var it in j)if(j.hasOwnProperty(it)){var et=it.indexOf("--")===0,ut=rb(it,j[it],et);it==="float"&&(it="cssFloat"),et?$.setProperty(it,ut):$[it]=ut}}var tb=A$1({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub($,j){if(j){if(tb[$]&&(j.children!=null||j.dangerouslySetInnerHTML!=null))throw Error(p$1(137,$));if(j.dangerouslySetInnerHTML!=null){if(j.children!=null)throw Error(p$1(60));if(typeof j.dangerouslySetInnerHTML!="object"||!("__html"in j.dangerouslySetInnerHTML))throw Error(p$1(61))}if(j.style!=null&&typeof j.style!="object")throw Error(p$1(62))}}function vb($,j){if($.indexOf("-")===-1)return typeof j.is=="string";switch($){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb($){return $=$.target||$.srcElement||window,$.correspondingUseElement&&($=$.correspondingUseElement),$.nodeType===3?$.parentNode:$}var yb=null,zb=null,Ab=null;function Bb($){if($=Cb($)){if(typeof yb!="function")throw Error(p$1(280));var j=$.stateNode;j&&(j=Db(j),yb($.stateNode,$.type,j))}}function Eb($){zb?Ab?Ab.push($):Ab=[$]:zb=$}function Fb(){if(zb){var $=zb,j=Ab;if(Ab=zb=null,Bb($),j)for($=0;$<j.length;$++)Bb(j[$])}}function Gb($,j){return $(j)}function Hb(){}var Ib=!1;function Jb($,j,it){if(Ib)return $(j,it);Ib=!0;try{return Gb($,j,it)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb($,j){var it=$.stateNode;if(it===null)return null;var et=Db(it);if(et===null)return null;it=et[j];e:switch(j){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(et=!et.disabled)||($=$.type,et=!($==="button"||$==="input"||$==="select"||$==="textarea")),$=!et;break e;default:$=!1}if($)return null;if(it&&typeof it!="function")throw Error(p$1(231,j,typeof it));return it}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb($,j,it,et,ut,dt,mt,yt,bt){var Rt=Array.prototype.slice.call(arguments,3);try{j.apply(it,Rt)}catch(jt){this.onError(jt)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function($){Ob=!0,Pb=$}};function Tb($,j,it,et,ut,dt,mt,yt,bt){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub($,j,it,et,ut,dt,mt,yt,bt){if(Tb.apply(this,arguments),Ob){if(Ob){var Rt=Pb;Ob=!1,Pb=null}else throw Error(p$1(198));Qb||(Qb=!0,Rb=Rt)}}function Vb($){var j=$,it=$;if($.alternate)for(;j.return;)j=j.return;else{$=j;do j=$,j.flags&4098&&(it=j.return),$=j.return;while($)}return j.tag===3?it:null}function Wb($){if($.tag===13){var j=$.memoizedState;if(j===null&&($=$.alternate,$!==null&&(j=$.memoizedState)),j!==null)return j.dehydrated}return null}function Xb($){if(Vb($)!==$)throw Error(p$1(188))}function Yb($){var j=$.alternate;if(!j){if(j=Vb($),j===null)throw Error(p$1(188));return j!==$?null:$}for(var it=$,et=j;;){var ut=it.return;if(ut===null)break;var dt=ut.alternate;if(dt===null){if(et=ut.return,et!==null){it=et;continue}break}if(ut.child===dt.child){for(dt=ut.child;dt;){if(dt===it)return Xb(ut),$;if(dt===et)return Xb(ut),j;dt=dt.sibling}throw Error(p$1(188))}if(it.return!==et.return)it=ut,et=dt;else{for(var mt=!1,yt=ut.child;yt;){if(yt===it){mt=!0,it=ut,et=dt;break}if(yt===et){mt=!0,et=ut,it=dt;break}yt=yt.sibling}if(!mt){for(yt=dt.child;yt;){if(yt===it){mt=!0,it=dt,et=ut;break}if(yt===et){mt=!0,et=dt,it=ut;break}yt=yt.sibling}if(!mt)throw Error(p$1(189))}}if(it.alternate!==et)throw Error(p$1(190))}if(it.tag!==3)throw Error(p$1(188));return it.stateNode.current===it?$:j}function Zb($){return $=Yb($),$!==null?$b($):null}function $b($){if($.tag===5||$.tag===6)return $;for($=$.child;$!==null;){var j=$b($);if(j!==null)return j;$=$.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B$1=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc($){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,$,void 0,($.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc($){return $>>>=0,$===0?32:31-(pc($)/qc|0)|0}var rc=64,sc=4194304;function tc($){switch($&-$){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return $&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return $&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return $}}function uc($,j){var it=$.pendingLanes;if(it===0)return 0;var et=0,ut=$.suspendedLanes,dt=$.pingedLanes,mt=it&268435455;if(mt!==0){var yt=mt&~ut;yt!==0?et=tc(yt):(dt&=mt,dt!==0&&(et=tc(dt)))}else mt=it&~ut,mt!==0?et=tc(mt):dt!==0&&(et=tc(dt));if(et===0)return 0;if(j!==0&&j!==et&&!(j&ut)&&(ut=et&-et,dt=j&-j,ut>=dt||ut===16&&(dt&4194240)!==0))return j;if(et&4&&(et|=it&16),j=$.entangledLanes,j!==0)for($=$.entanglements,j&=et;0<j;)it=31-oc(j),ut=1<<it,et|=$[it],j&=~ut;return et}function vc($,j){switch($){case 1:case 2:case 4:return j+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return j+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc($,j){for(var it=$.suspendedLanes,et=$.pingedLanes,ut=$.expirationTimes,dt=$.pendingLanes;0<dt;){var mt=31-oc(dt),yt=1<<mt,bt=ut[mt];bt===-1?(!(yt&it)||yt&et)&&(ut[mt]=vc(yt,j)):bt<=j&&($.expiredLanes|=yt),dt&=~yt}}function xc($){return $=$.pendingLanes&-1073741825,$!==0?$:$&1073741824?1073741824:0}function yc(){var $=rc;return rc<<=1,!(rc&4194240)&&(rc=64),$}function zc($){for(var j=[],it=0;31>it;it++)j.push($);return j}function Ac($,j,it){$.pendingLanes|=j,j!==536870912&&($.suspendedLanes=0,$.pingedLanes=0),$=$.eventTimes,j=31-oc(j),$[j]=it}function Bc($,j){var it=$.pendingLanes&~j;$.pendingLanes=j,$.suspendedLanes=0,$.pingedLanes=0,$.expiredLanes&=j,$.mutableReadLanes&=j,$.entangledLanes&=j,j=$.entanglements;var et=$.eventTimes;for($=$.expirationTimes;0<it;){var ut=31-oc(it),dt=1<<ut;j[ut]=0,et[ut]=-1,$[ut]=-1,it&=~dt}}function Cc($,j){var it=$.entangledLanes|=j;for($=$.entanglements;it;){var et=31-oc(it),ut=1<<et;ut&j|$[et]&j&&($[et]|=j),it&=~ut}}var C$1=0;function Dc($){return $&=-$,1<$?4<$?$&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc($,j){switch($){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(j.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(j.pointerId)}}function Tc($,j,it,et,ut,dt){return $===null||$.nativeEvent!==dt?($={blockedOn:j,domEventName:it,eventSystemFlags:et,nativeEvent:dt,targetContainers:[ut]},j!==null&&(j=Cb(j),j!==null&&Fc(j)),$):($.eventSystemFlags|=et,j=$.targetContainers,ut!==null&&j.indexOf(ut)===-1&&j.push(ut),$)}function Uc($,j,it,et,ut){switch(j){case"focusin":return Lc=Tc(Lc,$,j,it,et,ut),!0;case"dragenter":return Mc=Tc(Mc,$,j,it,et,ut),!0;case"mouseover":return Nc=Tc(Nc,$,j,it,et,ut),!0;case"pointerover":var dt=ut.pointerId;return Oc.set(dt,Tc(Oc.get(dt)||null,$,j,it,et,ut)),!0;case"gotpointercapture":return dt=ut.pointerId,Pc.set(dt,Tc(Pc.get(dt)||null,$,j,it,et,ut)),!0}return!1}function Vc($){var j=Wc($.target);if(j!==null){var it=Vb(j);if(it!==null){if(j=it.tag,j===13){if(j=Wb(it),j!==null){$.blockedOn=j,Ic($.priority,function(){Gc(it)});return}}else if(j===3&&it.stateNode.current.memoizedState.isDehydrated){$.blockedOn=it.tag===3?it.stateNode.containerInfo:null;return}}}$.blockedOn=null}function Xc($){if($.blockedOn!==null)return!1;for(var j=$.targetContainers;0<j.length;){var it=Yc($.domEventName,$.eventSystemFlags,j[0],$.nativeEvent);if(it===null){it=$.nativeEvent;var et=new it.constructor(it.type,it);wb=et,it.target.dispatchEvent(et),wb=null}else return j=Cb(it),j!==null&&Fc(j),$.blockedOn=it,!1;j.shift()}return!0}function Zc($,j,it){Xc($)&&it.delete(j)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad($,j){$.blockedOn===j&&($.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd($){function j(ut){return ad(ut,$)}if(0<Kc.length){ad(Kc[0],$);for(var it=1;it<Kc.length;it++){var et=Kc[it];et.blockedOn===$&&(et.blockedOn=null)}}for(Lc!==null&&ad(Lc,$),Mc!==null&&ad(Mc,$),Nc!==null&&ad(Nc,$),Oc.forEach(j),Pc.forEach(j),it=0;it<Qc.length;it++)et=Qc[it],et.blockedOn===$&&(et.blockedOn=null);for(;0<Qc.length&&(it=Qc[0],it.blockedOn===null);)Vc(it),it.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed($,j,it,et){var ut=C$1,dt=cd.transition;cd.transition=null;try{C$1=1,fd($,j,it,et)}finally{C$1=ut,cd.transition=dt}}function gd($,j,it,et){var ut=C$1,dt=cd.transition;cd.transition=null;try{C$1=4,fd($,j,it,et)}finally{C$1=ut,cd.transition=dt}}function fd($,j,it,et){if(dd){var ut=Yc($,j,it,et);if(ut===null)hd($,j,et,id,it),Sc($,et);else if(Uc(ut,$,j,it,et))et.stopPropagation();else if(Sc($,et),j&4&&-1<Rc.indexOf($)){for(;ut!==null;){var dt=Cb(ut);if(dt!==null&&Ec(dt),dt=Yc($,j,it,et),dt===null&&hd($,j,et,id,it),dt===ut)break;ut=dt}ut!==null&&et.stopPropagation()}else hd($,j,et,null,it)}}var id=null;function Yc($,j,it,et){if(id=null,$=xb(et),$=Wc($),$!==null)if(j=Vb($),j===null)$=null;else if(it=j.tag,it===13){if($=Wb(j),$!==null)return $;$=null}else if(it===3){if(j.stateNode.current.memoizedState.isDehydrated)return j.tag===3?j.stateNode.containerInfo:null;$=null}else j!==$&&($=null);return id=$,null}function jd($){switch($){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var $,j=ld,it=j.length,et,ut="value"in kd?kd.value:kd.textContent,dt=ut.length;for($=0;$<it&&j[$]===ut[$];$++);var mt=it-$;for(et=1;et<=mt&&j[it-et]===ut[dt-et];et++);return md=ut.slice($,1<et?1-et:void 0)}function od($){var j=$.keyCode;return"charCode"in $?($=$.charCode,$===0&&j===13&&($=13)):$=j,$===10&&($=13),32<=$||$===13?$:0}function pd(){return!0}function qd(){return!1}function rd($){function j(it,et,ut,dt,mt){this._reactName=it,this._targetInst=ut,this.type=et,this.nativeEvent=dt,this.target=mt,this.currentTarget=null;for(var yt in $)$.hasOwnProperty(yt)&&(it=$[yt],this[yt]=it?it(dt):dt[yt]);return this.isDefaultPrevented=(dt.defaultPrevented!=null?dt.defaultPrevented:dt.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$1(j.prototype,{preventDefault:function(){this.defaultPrevented=!0;var it=this.nativeEvent;it&&(it.preventDefault?it.preventDefault():typeof it.returnValue!="unknown"&&(it.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var it=this.nativeEvent;it&&(it.stopPropagation?it.stopPropagation():typeof it.cancelBubble!="unknown"&&(it.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),j}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function($){return $.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A$1({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$1({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function($){return $.relatedTarget===void 0?$.fromElement===$.srcElement?$.toElement:$.fromElement:$.relatedTarget},movementX:function($){return"movementX"in $?$.movementX:($!==yd&&(yd&&$.type==="mousemove"?(wd=$.screenX-yd.screenX,xd=$.screenY-yd.screenY):xd=wd=0,yd=$),wd)},movementY:function($){return"movementY"in $?$.movementY:xd}}),Bd=rd(Ad),Cd=A$1({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$1({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$1({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$1({},sd,{clipboardData:function($){return"clipboardData"in $?$.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$1({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd($){var j=this.nativeEvent;return j.getModifierState?j.getModifierState($):($=Od[$])?!!j[$]:!1}function zd(){return Pd}var Qd=A$1({},ud,{key:function($){if($.key){var j=Md[$.key]||$.key;if(j!=="Unidentified")return j}return $.type==="keypress"?($=od($),$===13?"Enter":String.fromCharCode($)):$.type==="keydown"||$.type==="keyup"?Nd[$.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function($){return $.type==="keypress"?od($):0},keyCode:function($){return $.type==="keydown"||$.type==="keyup"?$.keyCode:0},which:function($){return $.type==="keypress"?od($):$.type==="keydown"||$.type==="keyup"?$.keyCode:0}}),Rd=rd(Qd),Sd=A$1({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$1({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$1({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$1({},Ad,{deltaX:function($){return"deltaX"in $?$.deltaX:"wheelDeltaX"in $?-$.wheelDeltaX:0},deltaY:function($){return"deltaY"in $?$.deltaY:"wheelDeltaY"in $?-$.wheelDeltaY:"wheelDelta"in $?-$.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=String.fromCharCode(32),fe=!1;function ge($,j){switch($){case"keyup":return $d.indexOf(j.keyCode)!==-1;case"keydown":return j.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he($){return $=$.detail,typeof $=="object"&&"data"in $?$.data:null}var ie=!1;function je($,j){switch($){case"compositionend":return he(j);case"keypress":return j.which!==32?null:(fe=!0,ee);case"textInput":return $=j.data,$===ee&&fe?null:$;default:return null}}function ke($,j){if(ie)return $==="compositionend"||!ae&&ge($,j)?($=nd(),md=ld=kd=null,ie=!1,$):null;switch($){case"paste":return null;case"keypress":if(!(j.ctrlKey||j.altKey||j.metaKey)||j.ctrlKey&&j.altKey){if(j.char&&1<j.char.length)return j.char;if(j.which)return String.fromCharCode(j.which)}return null;case"compositionend":return de&&j.locale!=="ko"?null:j.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me($){var j=$&&$.nodeName&&$.nodeName.toLowerCase();return j==="input"?!!le[$.type]:j==="textarea"}function ne($,j,it,et){Eb(et),j=oe(j,"onChange"),0<j.length&&(it=new td("onChange","change",null,it,et),$.push({event:it,listeners:j}))}var pe=null,qe=null;function re($){se($,0)}function te($){var j=ue($);if(Wa(j))return $}function ve($,j){if($==="change")return j}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be($){if($.propertyName==="value"&&te(qe)){var j=[];ne(j,qe,$,xb($)),Jb(re,j)}}function Ce($,j,it){$==="focusin"?(Ae(),pe=j,qe=it,pe.attachEvent("onpropertychange",Be)):$==="focusout"&&Ae()}function De($){if($==="selectionchange"||$==="keyup"||$==="keydown")return te(qe)}function Ee($,j){if($==="click")return te(j)}function Fe($,j){if($==="input"||$==="change")return te(j)}function Ge($,j){return $===j&&($!==0||1/$===1/j)||$!==$&&j!==j}var He=typeof Object.is=="function"?Object.is:Ge;function Ie($,j){if(He($,j))return!0;if(typeof $!="object"||$===null||typeof j!="object"||j===null)return!1;var it=Object.keys($),et=Object.keys(j);if(it.length!==et.length)return!1;for(et=0;et<it.length;et++){var ut=it[et];if(!ja.call(j,ut)||!He($[ut],j[ut]))return!1}return!0}function Je($){for(;$&&$.firstChild;)$=$.firstChild;return $}function Ke($,j){var it=Je($);$=0;for(var et;it;){if(it.nodeType===3){if(et=$+it.textContent.length,$<=j&&et>=j)return{node:it,offset:j-$};$=et}e:{for(;it;){if(it.nextSibling){it=it.nextSibling;break e}it=it.parentNode}it=void 0}it=Je(it)}}function Le($,j){return $&&j?$===j?!0:$&&$.nodeType===3?!1:j&&j.nodeType===3?Le($,j.parentNode):"contains"in $?$.contains(j):$.compareDocumentPosition?!!($.compareDocumentPosition(j)&16):!1:!1}function Me(){for(var $=window,j=Xa();j instanceof $.HTMLIFrameElement;){try{var it=typeof j.contentWindow.location.href=="string"}catch{it=!1}if(it)$=j.contentWindow;else break;j=Xa($.document)}return j}function Ne($){var j=$&&$.nodeName&&$.nodeName.toLowerCase();return j&&(j==="input"&&($.type==="text"||$.type==="search"||$.type==="tel"||$.type==="url"||$.type==="password")||j==="textarea"||$.contentEditable==="true")}function Oe($){var j=Me(),it=$.focusedElem,et=$.selectionRange;if(j!==it&&it&&it.ownerDocument&&Le(it.ownerDocument.documentElement,it)){if(et!==null&&Ne(it)){if(j=et.start,$=et.end,$===void 0&&($=j),"selectionStart"in it)it.selectionStart=j,it.selectionEnd=Math.min($,it.value.length);else if($=(j=it.ownerDocument||document)&&j.defaultView||window,$.getSelection){$=$.getSelection();var ut=it.textContent.length,dt=Math.min(et.start,ut);et=et.end===void 0?dt:Math.min(et.end,ut),!$.extend&&dt>et&&(ut=et,et=dt,dt=ut),ut=Ke(it,dt);var mt=Ke(it,et);ut&&mt&&($.rangeCount!==1||$.anchorNode!==ut.node||$.anchorOffset!==ut.offset||$.focusNode!==mt.node||$.focusOffset!==mt.offset)&&(j=j.createRange(),j.setStart(ut.node,ut.offset),$.removeAllRanges(),dt>et?($.addRange(j),$.extend(mt.node,mt.offset)):(j.setEnd(mt.node,mt.offset),$.addRange(j)))}}for(j=[],$=it;$=$.parentNode;)$.nodeType===1&&j.push({element:$,left:$.scrollLeft,top:$.scrollTop});for(typeof it.focus=="function"&&it.focus(),it=0;it<j.length;it++)$=j[it],$.element.scrollLeft=$.left,$.element.scrollTop=$.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue($,j,it){var et=it.window===it?it.document:it.nodeType===9?it:it.ownerDocument;Te||Qe==null||Qe!==Xa(et)||(et=Qe,"selectionStart"in et&&Ne(et)?et={start:et.selectionStart,end:et.selectionEnd}:(et=(et.ownerDocument&&et.ownerDocument.defaultView||window).getSelection(),et={anchorNode:et.anchorNode,anchorOffset:et.anchorOffset,focusNode:et.focusNode,focusOffset:et.focusOffset}),Se&&Ie(Se,et)||(Se=et,et=oe(Re,"onSelect"),0<et.length&&(j=new td("onSelect","select",null,j,it),$.push({event:j,listeners:et}),j.target=Qe)))}function Ve($,j){var it={};return it[$.toLowerCase()]=j.toLowerCase(),it["Webkit"+$]="webkit"+j,it["Moz"+$]="moz"+j,it}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze($){if(Xe[$])return Xe[$];if(!We[$])return $;var j=We[$],it;for(it in j)if(j.hasOwnProperty(it)&&it in Ye)return Xe[$]=j[it];return $}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff($,j){df.set($,j),fa(j,[$])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf($,j,it){var et=$.type||"unknown-event";$.currentTarget=it,Ub(et,j,void 0,$),$.currentTarget=null}function se($,j){j=(j&4)!==0;for(var it=0;it<$.length;it++){var et=$[it],ut=et.event;et=et.listeners;e:{var dt=void 0;if(j)for(var mt=et.length-1;0<=mt;mt--){var yt=et[mt],bt=yt.instance,Rt=yt.currentTarget;if(yt=yt.listener,bt!==dt&&ut.isPropagationStopped())break e;nf(ut,yt,Rt),dt=bt}else for(mt=0;mt<et.length;mt++){if(yt=et[mt],bt=yt.instance,Rt=yt.currentTarget,yt=yt.listener,bt!==dt&&ut.isPropagationStopped())break e;nf(ut,yt,Rt),dt=bt}}}if(Qb)throw $=Rb,Qb=!1,Rb=null,$}function D$1($,j){var it=j[of];it===void 0&&(it=j[of]=new Set);var et=$+"__bubble";it.has(et)||(pf(j,$,2,!1),it.add(et))}function qf($,j,it){var et=0;j&&(et|=4),pf(it,$,et,j)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf($){if(!$[rf]){$[rf]=!0,da.forEach(function(it){it!=="selectionchange"&&(mf.has(it)||qf(it,!1,$),qf(it,!0,$))});var j=$.nodeType===9?$:$.ownerDocument;j===null||j[rf]||(j[rf]=!0,qf("selectionchange",!1,j))}}function pf($,j,it,et){switch(jd(j)){case 1:var ut=ed;break;case 4:ut=gd;break;default:ut=fd}it=ut.bind(null,j,it,$),ut=void 0,!Lb||j!=="touchstart"&&j!=="touchmove"&&j!=="wheel"||(ut=!0),et?ut!==void 0?$.addEventListener(j,it,{capture:!0,passive:ut}):$.addEventListener(j,it,!0):ut!==void 0?$.addEventListener(j,it,{passive:ut}):$.addEventListener(j,it,!1)}function hd($,j,it,et,ut){var dt=et;if(!(j&1)&&!(j&2)&&et!==null)e:for(;;){if(et===null)return;var mt=et.tag;if(mt===3||mt===4){var yt=et.stateNode.containerInfo;if(yt===ut||yt.nodeType===8&&yt.parentNode===ut)break;if(mt===4)for(mt=et.return;mt!==null;){var bt=mt.tag;if((bt===3||bt===4)&&(bt=mt.stateNode.containerInfo,bt===ut||bt.nodeType===8&&bt.parentNode===ut))return;mt=mt.return}for(;yt!==null;){if(mt=Wc(yt),mt===null)return;if(bt=mt.tag,bt===5||bt===6){et=dt=mt;continue e}yt=yt.parentNode}}et=et.return}Jb(function(){var Rt=dt,jt=xb(it),Vt=[];e:{var zt=df.get($);if(zt!==void 0){var Jt=td,rr=$;switch($){case"keypress":if(od(it)===0)break e;case"keydown":case"keyup":Jt=Rd;break;case"focusin":rr="focus",Jt=Fd;break;case"focusout":rr="blur",Jt=Fd;break;case"beforeblur":case"afterblur":Jt=Fd;break;case"click":if(it.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Jt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Jt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Jt=Vd;break;case $e:case af:case bf:Jt=Hd;break;case cf:Jt=Xd;break;case"scroll":Jt=vd;break;case"wheel":Jt=Zd;break;case"copy":case"cut":case"paste":Jt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Jt=Td}var Yt=(j&4)!==0,dr=!Yt&&$==="scroll",Ft=Yt?zt!==null?zt+"Capture":null:zt;Yt=[];for(var Ht=Rt,er;Ht!==null;){er=Ht;var pr=er.stateNode;if(er.tag===5&&pr!==null&&(er=pr,Ft!==null&&(pr=Kb(Ht,Ft),pr!=null&&Yt.push(tf(Ht,pr,er)))),dr)break;Ht=Ht.return}0<Yt.length&&(zt=new Jt(zt,rr,null,it,jt),Vt.push({event:zt,listeners:Yt}))}}if(!(j&7)){e:{if(zt=$==="mouseover"||$==="pointerover",Jt=$==="mouseout"||$==="pointerout",zt&&it!==wb&&(rr=it.relatedTarget||it.fromElement)&&(Wc(rr)||rr[uf]))break e;if((Jt||zt)&&(zt=jt.window===jt?jt:(zt=jt.ownerDocument)?zt.defaultView||zt.parentWindow:window,Jt?(rr=it.relatedTarget||it.toElement,Jt=Rt,rr=rr?Wc(rr):null,rr!==null&&(dr=Vb(rr),rr!==dr||rr.tag!==5&&rr.tag!==6)&&(rr=null)):(Jt=null,rr=Rt),Jt!==rr)){if(Yt=Bd,pr="onMouseLeave",Ft="onMouseEnter",Ht="mouse",($==="pointerout"||$==="pointerover")&&(Yt=Td,pr="onPointerLeave",Ft="onPointerEnter",Ht="pointer"),dr=Jt==null?zt:ue(Jt),er=rr==null?zt:ue(rr),zt=new Yt(pr,Ht+"leave",Jt,it,jt),zt.target=dr,zt.relatedTarget=er,pr=null,Wc(jt)===Rt&&(Yt=new Yt(Ft,Ht+"enter",rr,it,jt),Yt.target=er,Yt.relatedTarget=dr,pr=Yt),dr=pr,Jt&&rr)t:{for(Yt=Jt,Ft=rr,Ht=0,er=Yt;er;er=vf(er))Ht++;for(er=0,pr=Ft;pr;pr=vf(pr))er++;for(;0<Ht-er;)Yt=vf(Yt),Ht--;for(;0<er-Ht;)Ft=vf(Ft),er--;for(;Ht--;){if(Yt===Ft||Ft!==null&&Yt===Ft.alternate)break t;Yt=vf(Yt),Ft=vf(Ft)}Yt=null}else Yt=null;Jt!==null&&wf(Vt,zt,Jt,Yt,!1),rr!==null&&dr!==null&&wf(Vt,dr,rr,Yt,!0)}}e:{if(zt=Rt?ue(Rt):window,Jt=zt.nodeName&&zt.nodeName.toLowerCase(),Jt==="select"||Jt==="input"&&zt.type==="file")var or=ve;else if(me(zt))if(we)or=Fe;else{or=De;var ar=Ce}else(Jt=zt.nodeName)&&Jt.toLowerCase()==="input"&&(zt.type==="checkbox"||zt.type==="radio")&&(or=Ee);if(or&&(or=or($,Rt))){ne(Vt,or,it,jt);break e}ar&&ar($,zt,Rt),$==="focusout"&&(ar=zt._wrapperState)&&ar.controlled&&zt.type==="number"&&cb(zt,"number",zt.value)}switch(ar=Rt?ue(Rt):window,$){case"focusin":(me(ar)||ar.contentEditable==="true")&&(Qe=ar,Re=Rt,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(Vt,it,jt);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(Vt,it,jt)}var Wt;if(ae)e:{switch($){case"compositionstart":var Zt="onCompositionStart";break e;case"compositionend":Zt="onCompositionEnd";break e;case"compositionupdate":Zt="onCompositionUpdate";break e}Zt=void 0}else ie?ge($,it)&&(Zt="onCompositionEnd"):$==="keydown"&&it.keyCode===229&&(Zt="onCompositionStart");Zt&&(de&&it.locale!=="ko"&&(ie||Zt!=="onCompositionStart"?Zt==="onCompositionEnd"&&ie&&(Wt=nd()):(kd=jt,ld="value"in kd?kd.value:kd.textContent,ie=!0)),ar=oe(Rt,Zt),0<ar.length&&(Zt=new Ld(Zt,$,null,it,jt),Vt.push({event:Zt,listeners:ar}),Wt?Zt.data=Wt:(Wt=he(it),Wt!==null&&(Zt.data=Wt)))),(Wt=ce?je($,it):ke($,it))&&(Rt=oe(Rt,"onBeforeInput"),0<Rt.length&&(jt=new Ld("onBeforeInput","beforeinput",null,it,jt),Vt.push({event:jt,listeners:Rt}),jt.data=Wt))}se(Vt,j)})}function tf($,j,it){return{instance:$,listener:j,currentTarget:it}}function oe($,j){for(var it=j+"Capture",et=[];$!==null;){var ut=$,dt=ut.stateNode;ut.tag===5&&dt!==null&&(ut=dt,dt=Kb($,it),dt!=null&&et.unshift(tf($,dt,ut)),dt=Kb($,j),dt!=null&&et.push(tf($,dt,ut))),$=$.return}return et}function vf($){if($===null)return null;do $=$.return;while($&&$.tag!==5);return $||null}function wf($,j,it,et,ut){for(var dt=j._reactName,mt=[];it!==null&&it!==et;){var yt=it,bt=yt.alternate,Rt=yt.stateNode;if(bt!==null&&bt===et)break;yt.tag===5&&Rt!==null&&(yt=Rt,ut?(bt=Kb(it,dt),bt!=null&&mt.unshift(tf(it,bt,yt))):ut||(bt=Kb(it,dt),bt!=null&&mt.push(tf(it,bt,yt)))),it=it.return}mt.length!==0&&$.push({event:j,listeners:mt})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf($){return(typeof $=="string"?$:""+$).replace(xf,`
`).replace(yf,"")}function Af($,j,it){if(j=zf(j),zf($)!==j&&it)throw Error(p$1(425))}function Bf(){}var Cf=null,Df=null;function Ef($,j){return $==="textarea"||$==="noscript"||typeof j.children=="string"||typeof j.children=="number"||typeof j.dangerouslySetInnerHTML=="object"&&j.dangerouslySetInnerHTML!==null&&j.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function($){return Hf.resolve(null).then($).catch(If)}:Ff;function If($){setTimeout(function(){throw $})}function Kf($,j){var it=j,et=0;do{var ut=it.nextSibling;if($.removeChild(it),ut&&ut.nodeType===8)if(it=ut.data,it==="/$"){if(et===0){$.removeChild(ut),bd(j);return}et--}else it!=="$"&&it!=="$?"&&it!=="$!"||et++;it=ut}while(it);bd(j)}function Lf($){for(;$!=null;$=$.nextSibling){var j=$.nodeType;if(j===1||j===3)break;if(j===8){if(j=$.data,j==="$"||j==="$!"||j==="$?")break;if(j==="/$")return null}}return $}function Mf($){$=$.previousSibling;for(var j=0;$;){if($.nodeType===8){var it=$.data;if(it==="$"||it==="$!"||it==="$?"){if(j===0)return $;j--}else it==="/$"&&j++}$=$.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc($){var j=$[Of];if(j)return j;for(var it=$.parentNode;it;){if(j=it[uf]||it[Of]){if(it=j.alternate,j.child!==null||it!==null&&it.child!==null)for($=Mf($);$!==null;){if(it=$[Of])return it;$=Mf($)}return j}$=it,it=$.parentNode}return null}function Cb($){return $=$[Of]||$[uf],!$||$.tag!==5&&$.tag!==6&&$.tag!==13&&$.tag!==3?null:$}function ue($){if($.tag===5||$.tag===6)return $.stateNode;throw Error(p$1(33))}function Db($){return $[Pf]||null}var Sf=[],Tf=-1;function Uf($){return{current:$}}function E$1($){0>Tf||($.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G$1($,j){Tf++,Sf[Tf]=$.current,$.current=j}var Vf={},H$1=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf($,j){var it=$.type.contextTypes;if(!it)return Vf;var et=$.stateNode;if(et&&et.__reactInternalMemoizedUnmaskedChildContext===j)return et.__reactInternalMemoizedMaskedChildContext;var ut={},dt;for(dt in it)ut[dt]=j[dt];return et&&($=$.stateNode,$.__reactInternalMemoizedUnmaskedChildContext=j,$.__reactInternalMemoizedMaskedChildContext=ut),ut}function Zf($){return $=$.childContextTypes,$!=null}function $f(){E$1(Wf),E$1(H$1)}function ag($,j,it){if(H$1.current!==Vf)throw Error(p$1(168));G$1(H$1,j),G$1(Wf,it)}function bg($,j,it){var et=$.stateNode;if(j=j.childContextTypes,typeof et.getChildContext!="function")return it;et=et.getChildContext();for(var ut in et)if(!(ut in j))throw Error(p$1(108,Ra($)||"Unknown",ut));return A$1({},it,et)}function cg($){return $=($=$.stateNode)&&$.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$1.current,G$1(H$1,$),G$1(Wf,Wf.current),!0}function dg($,j,it){var et=$.stateNode;if(!et)throw Error(p$1(169));it?($=bg($,j,Xf),et.__reactInternalMemoizedMergedChildContext=$,E$1(Wf),E$1(H$1),G$1(H$1,$)):E$1(Wf),G$1(Wf,it)}var eg=null,fg=!1,gg=!1;function hg($){eg===null?eg=[$]:eg.push($)}function ig($){fg=!0,hg($)}function jg(){if(!gg&&eg!==null){gg=!0;var $=0,j=C$1;try{var it=eg;for(C$1=1;$<it.length;$++){var et=it[$];do et=et(!0);while(et!==null)}eg=null,fg=!1}catch(ut){throw eg!==null&&(eg=eg.slice($+1)),ac(fc,jg),ut}finally{C$1=j,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg($,j){kg[lg++]=ng,kg[lg++]=mg,mg=$,ng=j}function ug($,j,it){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=$;var et=rg;$=sg;var ut=32-oc(et)-1;et&=~(1<<ut),it+=1;var dt=32-oc(j)+ut;if(30<dt){var mt=ut-ut%5;dt=(et&(1<<mt)-1).toString(32),et>>=mt,ut-=mt,rg=1<<32-oc(j)+ut|it<<ut|et,sg=dt+$}else rg=1<<dt|it<<ut|et,sg=$}function vg($){$.return!==null&&(tg($,1),ug($,1,0))}function wg($){for(;$===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;$===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$1=!1,zg=null;function Ag($,j){var it=Bg(5,null,null,0);it.elementType="DELETED",it.stateNode=j,it.return=$,j=$.deletions,j===null?($.deletions=[it],$.flags|=16):j.push(it)}function Cg($,j){switch($.tag){case 5:var it=$.type;return j=j.nodeType!==1||it.toLowerCase()!==j.nodeName.toLowerCase()?null:j,j!==null?($.stateNode=j,xg=$,yg=Lf(j.firstChild),!0):!1;case 6:return j=$.pendingProps===""||j.nodeType!==3?null:j,j!==null?($.stateNode=j,xg=$,yg=null,!0):!1;case 13:return j=j.nodeType!==8?null:j,j!==null?(it=qg!==null?{id:rg,overflow:sg}:null,$.memoizedState={dehydrated:j,treeContext:it,retryLane:1073741824},it=Bg(18,null,null,0),it.stateNode=j,it.return=$,$.child=it,xg=$,yg=null,!0):!1;default:return!1}}function Dg($){return($.mode&1)!==0&&($.flags&128)===0}function Eg($){if(I$1){var j=yg;if(j){var it=j;if(!Cg($,j)){if(Dg($))throw Error(p$1(418));j=Lf(it.nextSibling);var et=xg;j&&Cg($,j)?Ag(et,it):($.flags=$.flags&-4097|2,I$1=!1,xg=$)}}else{if(Dg($))throw Error(p$1(418));$.flags=$.flags&-4097|2,I$1=!1,xg=$}}}function Fg($){for($=$.return;$!==null&&$.tag!==5&&$.tag!==3&&$.tag!==13;)$=$.return;xg=$}function Gg($){if($!==xg)return!1;if(!I$1)return Fg($),I$1=!0,!1;var j;if((j=$.tag!==3)&&!(j=$.tag!==5)&&(j=$.type,j=j!=="head"&&j!=="body"&&!Ef($.type,$.memoizedProps)),j&&(j=yg)){if(Dg($))throw Hg(),Error(p$1(418));for(;j;)Ag($,j),j=Lf(j.nextSibling)}if(Fg($),$.tag===13){if($=$.memoizedState,$=$!==null?$.dehydrated:null,!$)throw Error(p$1(317));e:{for($=$.nextSibling,j=0;$;){if($.nodeType===8){var it=$.data;if(it==="/$"){if(j===0){yg=Lf($.nextSibling);break e}j--}else it!=="$"&&it!=="$!"&&it!=="$?"||j++}$=$.nextSibling}yg=null}}else yg=xg?Lf($.stateNode.nextSibling):null;return!0}function Hg(){for(var $=yg;$;)$=Lf($.nextSibling)}function Ig(){yg=xg=null,I$1=!1}function Jg($){zg===null?zg=[$]:zg.push($)}var Kg=ua.ReactCurrentBatchConfig;function Lg($,j){if($&&$.defaultProps){j=A$1({},j),$=$.defaultProps;for(var it in $)j[it]===void 0&&(j[it]=$[it]);return j}return j}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg($){var j=Mg.current;E$1(Mg),$._currentValue=j}function Sg($,j,it){for(;$!==null;){var et=$.alternate;if(($.childLanes&j)!==j?($.childLanes|=j,et!==null&&(et.childLanes|=j)):et!==null&&(et.childLanes&j)!==j&&(et.childLanes|=j),$===it)break;$=$.return}}function Tg($,j){Ng=$,Pg=Og=null,$=$.dependencies,$!==null&&$.firstContext!==null&&($.lanes&j&&(Ug=!0),$.firstContext=null)}function Vg($){var j=$._currentValue;if(Pg!==$)if($={context:$,memoizedValue:j,next:null},Og===null){if(Ng===null)throw Error(p$1(308));Og=$,Ng.dependencies={lanes:0,firstContext:$}}else Og=Og.next=$;return j}var Wg=null;function Xg($){Wg===null?Wg=[$]:Wg.push($)}function Yg($,j,it,et){var ut=j.interleaved;return ut===null?(it.next=it,Xg(j)):(it.next=ut.next,ut.next=it),j.interleaved=it,Zg($,et)}function Zg($,j){$.lanes|=j;var it=$.alternate;for(it!==null&&(it.lanes|=j),it=$,$=$.return;$!==null;)$.childLanes|=j,it=$.alternate,it!==null&&(it.childLanes|=j),it=$,$=$.return;return it.tag===3?it.stateNode:null}var $g=!1;function ah($){$.updateQueue={baseState:$.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh($,j){$=$.updateQueue,j.updateQueue===$&&(j.updateQueue={baseState:$.baseState,firstBaseUpdate:$.firstBaseUpdate,lastBaseUpdate:$.lastBaseUpdate,shared:$.shared,effects:$.effects})}function ch($,j){return{eventTime:$,lane:j,tag:0,payload:null,callback:null,next:null}}function dh($,j,it){var et=$.updateQueue;if(et===null)return null;if(et=et.shared,K&2){var ut=et.pending;return ut===null?j.next=j:(j.next=ut.next,ut.next=j),et.pending=j,Zg($,it)}return ut=et.interleaved,ut===null?(j.next=j,Xg(et)):(j.next=ut.next,ut.next=j),et.interleaved=j,Zg($,it)}function eh($,j,it){if(j=j.updateQueue,j!==null&&(j=j.shared,(it&4194240)!==0)){var et=j.lanes;et&=$.pendingLanes,it|=et,j.lanes=it,Cc($,it)}}function fh($,j){var it=$.updateQueue,et=$.alternate;if(et!==null&&(et=et.updateQueue,it===et)){var ut=null,dt=null;if(it=it.firstBaseUpdate,it!==null){do{var mt={eventTime:it.eventTime,lane:it.lane,tag:it.tag,payload:it.payload,callback:it.callback,next:null};dt===null?ut=dt=mt:dt=dt.next=mt,it=it.next}while(it!==null);dt===null?ut=dt=j:dt=dt.next=j}else ut=dt=j;it={baseState:et.baseState,firstBaseUpdate:ut,lastBaseUpdate:dt,shared:et.shared,effects:et.effects},$.updateQueue=it;return}$=it.lastBaseUpdate,$===null?it.firstBaseUpdate=j:$.next=j,it.lastBaseUpdate=j}function gh($,j,it,et){var ut=$.updateQueue;$g=!1;var dt=ut.firstBaseUpdate,mt=ut.lastBaseUpdate,yt=ut.shared.pending;if(yt!==null){ut.shared.pending=null;var bt=yt,Rt=bt.next;bt.next=null,mt===null?dt=Rt:mt.next=Rt,mt=bt;var jt=$.alternate;jt!==null&&(jt=jt.updateQueue,yt=jt.lastBaseUpdate,yt!==mt&&(yt===null?jt.firstBaseUpdate=Rt:yt.next=Rt,jt.lastBaseUpdate=bt))}if(dt!==null){var Vt=ut.baseState;mt=0,jt=Rt=bt=null,yt=dt;do{var zt=yt.lane,Jt=yt.eventTime;if((et&zt)===zt){jt!==null&&(jt=jt.next={eventTime:Jt,lane:0,tag:yt.tag,payload:yt.payload,callback:yt.callback,next:null});e:{var rr=$,Yt=yt;switch(zt=j,Jt=it,Yt.tag){case 1:if(rr=Yt.payload,typeof rr=="function"){Vt=rr.call(Jt,Vt,zt);break e}Vt=rr;break e;case 3:rr.flags=rr.flags&-65537|128;case 0:if(rr=Yt.payload,zt=typeof rr=="function"?rr.call(Jt,Vt,zt):rr,zt==null)break e;Vt=A$1({},Vt,zt);break e;case 2:$g=!0}}yt.callback!==null&&yt.lane!==0&&($.flags|=64,zt=ut.effects,zt===null?ut.effects=[yt]:zt.push(yt))}else Jt={eventTime:Jt,lane:zt,tag:yt.tag,payload:yt.payload,callback:yt.callback,next:null},jt===null?(Rt=jt=Jt,bt=Vt):jt=jt.next=Jt,mt|=zt;if(yt=yt.next,yt===null){if(yt=ut.shared.pending,yt===null)break;zt=yt,yt=zt.next,zt.next=null,ut.lastBaseUpdate=zt,ut.shared.pending=null}}while(1);if(jt===null&&(bt=Vt),ut.baseState=bt,ut.firstBaseUpdate=Rt,ut.lastBaseUpdate=jt,j=ut.shared.interleaved,j!==null){ut=j;do mt|=ut.lane,ut=ut.next;while(ut!==j)}else dt===null&&(ut.shared.lanes=0);hh|=mt,$.lanes=mt,$.memoizedState=Vt}}function ih($,j,it){if($=j.effects,j.effects=null,$!==null)for(j=0;j<$.length;j++){var et=$[j],ut=et.callback;if(ut!==null){if(et.callback=null,et=it,typeof ut!="function")throw Error(p$1(191,ut));ut.call(et)}}}var jh=new aa.Component().refs;function kh($,j,it,et){j=$.memoizedState,it=it(et,j),it=it==null?j:A$1({},j,it),$.memoizedState=it,$.lanes===0&&($.updateQueue.baseState=it)}var nh={isMounted:function($){return($=$._reactInternals)?Vb($)===$:!1},enqueueSetState:function($,j,it){$=$._reactInternals;var et=L(),ut=lh($),dt=ch(et,ut);dt.payload=j,it!=null&&(dt.callback=it),j=dh($,dt,ut),j!==null&&(mh(j,$,ut,et),eh(j,$,ut))},enqueueReplaceState:function($,j,it){$=$._reactInternals;var et=L(),ut=lh($),dt=ch(et,ut);dt.tag=1,dt.payload=j,it!=null&&(dt.callback=it),j=dh($,dt,ut),j!==null&&(mh(j,$,ut,et),eh(j,$,ut))},enqueueForceUpdate:function($,j){$=$._reactInternals;var it=L(),et=lh($),ut=ch(it,et);ut.tag=2,j!=null&&(ut.callback=j),j=dh($,ut,et),j!==null&&(mh(j,$,et,it),eh(j,$,et))}};function oh($,j,it,et,ut,dt,mt){return $=$.stateNode,typeof $.shouldComponentUpdate=="function"?$.shouldComponentUpdate(et,dt,mt):j.prototype&&j.prototype.isPureReactComponent?!Ie(it,et)||!Ie(ut,dt):!0}function ph($,j,it){var et=!1,ut=Vf,dt=j.contextType;return typeof dt=="object"&&dt!==null?dt=Vg(dt):(ut=Zf(j)?Xf:H$1.current,et=j.contextTypes,dt=(et=et!=null)?Yf($,ut):Vf),j=new j(it,dt),$.memoizedState=j.state!==null&&j.state!==void 0?j.state:null,j.updater=nh,$.stateNode=j,j._reactInternals=$,et&&($=$.stateNode,$.__reactInternalMemoizedUnmaskedChildContext=ut,$.__reactInternalMemoizedMaskedChildContext=dt),j}function qh($,j,it,et){$=j.state,typeof j.componentWillReceiveProps=="function"&&j.componentWillReceiveProps(it,et),typeof j.UNSAFE_componentWillReceiveProps=="function"&&j.UNSAFE_componentWillReceiveProps(it,et),j.state!==$&&nh.enqueueReplaceState(j,j.state,null)}function rh($,j,it,et){var ut=$.stateNode;ut.props=it,ut.state=$.memoizedState,ut.refs=jh,ah($);var dt=j.contextType;typeof dt=="object"&&dt!==null?ut.context=Vg(dt):(dt=Zf(j)?Xf:H$1.current,ut.context=Yf($,dt)),ut.state=$.memoizedState,dt=j.getDerivedStateFromProps,typeof dt=="function"&&(kh($,j,dt,it),ut.state=$.memoizedState),typeof j.getDerivedStateFromProps=="function"||typeof ut.getSnapshotBeforeUpdate=="function"||typeof ut.UNSAFE_componentWillMount!="function"&&typeof ut.componentWillMount!="function"||(j=ut.state,typeof ut.componentWillMount=="function"&&ut.componentWillMount(),typeof ut.UNSAFE_componentWillMount=="function"&&ut.UNSAFE_componentWillMount(),j!==ut.state&&nh.enqueueReplaceState(ut,ut.state,null),gh($,it,ut,et),ut.state=$.memoizedState),typeof ut.componentDidMount=="function"&&($.flags|=4194308)}function sh($,j,it){if($=it.ref,$!==null&&typeof $!="function"&&typeof $!="object"){if(it._owner){if(it=it._owner,it){if(it.tag!==1)throw Error(p$1(309));var et=it.stateNode}if(!et)throw Error(p$1(147,$));var ut=et,dt=""+$;return j!==null&&j.ref!==null&&typeof j.ref=="function"&&j.ref._stringRef===dt?j.ref:(j=function(mt){var yt=ut.refs;yt===jh&&(yt=ut.refs={}),mt===null?delete yt[dt]:yt[dt]=mt},j._stringRef=dt,j)}if(typeof $!="string")throw Error(p$1(284));if(!it._owner)throw Error(p$1(290,$))}return $}function th($,j){throw $=Object.prototype.toString.call(j),Error(p$1(31,$==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":$))}function uh($){var j=$._init;return j($._payload)}function vh($){function j(Ft,Ht){if($){var er=Ft.deletions;er===null?(Ft.deletions=[Ht],Ft.flags|=16):er.push(Ht)}}function it(Ft,Ht){if(!$)return null;for(;Ht!==null;)j(Ft,Ht),Ht=Ht.sibling;return null}function et(Ft,Ht){for(Ft=new Map;Ht!==null;)Ht.key!==null?Ft.set(Ht.key,Ht):Ft.set(Ht.index,Ht),Ht=Ht.sibling;return Ft}function ut(Ft,Ht){return Ft=wh(Ft,Ht),Ft.index=0,Ft.sibling=null,Ft}function dt(Ft,Ht,er){return Ft.index=er,$?(er=Ft.alternate,er!==null?(er=er.index,er<Ht?(Ft.flags|=2,Ht):er):(Ft.flags|=2,Ht)):(Ft.flags|=1048576,Ht)}function mt(Ft){return $&&Ft.alternate===null&&(Ft.flags|=2),Ft}function yt(Ft,Ht,er,pr){return Ht===null||Ht.tag!==6?(Ht=xh(er,Ft.mode,pr),Ht.return=Ft,Ht):(Ht=ut(Ht,er),Ht.return=Ft,Ht)}function bt(Ft,Ht,er,pr){var or=er.type;return or===ya?jt(Ft,Ht,er.props.children,pr,er.key):Ht!==null&&(Ht.elementType===or||typeof or=="object"&&or!==null&&or.$$typeof===Ha&&uh(or)===Ht.type)?(pr=ut(Ht,er.props),pr.ref=sh(Ft,Ht,er),pr.return=Ft,pr):(pr=yh(er.type,er.key,er.props,null,Ft.mode,pr),pr.ref=sh(Ft,Ht,er),pr.return=Ft,pr)}function Rt(Ft,Ht,er,pr){return Ht===null||Ht.tag!==4||Ht.stateNode.containerInfo!==er.containerInfo||Ht.stateNode.implementation!==er.implementation?(Ht=zh(er,Ft.mode,pr),Ht.return=Ft,Ht):(Ht=ut(Ht,er.children||[]),Ht.return=Ft,Ht)}function jt(Ft,Ht,er,pr,or){return Ht===null||Ht.tag!==7?(Ht=Ah(er,Ft.mode,pr,or),Ht.return=Ft,Ht):(Ht=ut(Ht,er),Ht.return=Ft,Ht)}function Vt(Ft,Ht,er){if(typeof Ht=="string"&&Ht!==""||typeof Ht=="number")return Ht=xh(""+Ht,Ft.mode,er),Ht.return=Ft,Ht;if(typeof Ht=="object"&&Ht!==null){switch(Ht.$$typeof){case va:return er=yh(Ht.type,Ht.key,Ht.props,null,Ft.mode,er),er.ref=sh(Ft,null,Ht),er.return=Ft,er;case wa:return Ht=zh(Ht,Ft.mode,er),Ht.return=Ft,Ht;case Ha:var pr=Ht._init;return Vt(Ft,pr(Ht._payload),er)}if(eb(Ht)||Ka(Ht))return Ht=Ah(Ht,Ft.mode,er,null),Ht.return=Ft,Ht;th(Ft,Ht)}return null}function zt(Ft,Ht,er,pr){var or=Ht!==null?Ht.key:null;if(typeof er=="string"&&er!==""||typeof er=="number")return or!==null?null:yt(Ft,Ht,""+er,pr);if(typeof er=="object"&&er!==null){switch(er.$$typeof){case va:return er.key===or?bt(Ft,Ht,er,pr):null;case wa:return er.key===or?Rt(Ft,Ht,er,pr):null;case Ha:return or=er._init,zt(Ft,Ht,or(er._payload),pr)}if(eb(er)||Ka(er))return or!==null?null:jt(Ft,Ht,er,pr,null);th(Ft,er)}return null}function Jt(Ft,Ht,er,pr,or){if(typeof pr=="string"&&pr!==""||typeof pr=="number")return Ft=Ft.get(er)||null,yt(Ht,Ft,""+pr,or);if(typeof pr=="object"&&pr!==null){switch(pr.$$typeof){case va:return Ft=Ft.get(pr.key===null?er:pr.key)||null,bt(Ht,Ft,pr,or);case wa:return Ft=Ft.get(pr.key===null?er:pr.key)||null,Rt(Ht,Ft,pr,or);case Ha:var ar=pr._init;return Jt(Ft,Ht,er,ar(pr._payload),or)}if(eb(pr)||Ka(pr))return Ft=Ft.get(er)||null,jt(Ht,Ft,pr,or,null);th(Ht,pr)}return null}function rr(Ft,Ht,er,pr){for(var or=null,ar=null,Wt=Ht,Zt=Ht=0,sr=null;Wt!==null&&Zt<er.length;Zt++){Wt.index>Zt?(sr=Wt,Wt=null):sr=Wt.sibling;var tr=zt(Ft,Wt,er[Zt],pr);if(tr===null){Wt===null&&(Wt=sr);break}$&&Wt&&tr.alternate===null&&j(Ft,Wt),Ht=dt(tr,Ht,Zt),ar===null?or=tr:ar.sibling=tr,ar=tr,Wt=sr}if(Zt===er.length)return it(Ft,Wt),I$1&&tg(Ft,Zt),or;if(Wt===null){for(;Zt<er.length;Zt++)Wt=Vt(Ft,er[Zt],pr),Wt!==null&&(Ht=dt(Wt,Ht,Zt),ar===null?or=Wt:ar.sibling=Wt,ar=Wt);return I$1&&tg(Ft,Zt),or}for(Wt=et(Ft,Wt);Zt<er.length;Zt++)sr=Jt(Wt,Ft,Zt,er[Zt],pr),sr!==null&&($&&sr.alternate!==null&&Wt.delete(sr.key===null?Zt:sr.key),Ht=dt(sr,Ht,Zt),ar===null?or=sr:ar.sibling=sr,ar=sr);return $&&Wt.forEach(function(vr){return j(Ft,vr)}),I$1&&tg(Ft,Zt),or}function Yt(Ft,Ht,er,pr){var or=Ka(er);if(typeof or!="function")throw Error(p$1(150));if(er=or.call(er),er==null)throw Error(p$1(151));for(var ar=or=null,Wt=Ht,Zt=Ht=0,sr=null,tr=er.next();Wt!==null&&!tr.done;Zt++,tr=er.next()){Wt.index>Zt?(sr=Wt,Wt=null):sr=Wt.sibling;var vr=zt(Ft,Wt,tr.value,pr);if(vr===null){Wt===null&&(Wt=sr);break}$&&Wt&&vr.alternate===null&&j(Ft,Wt),Ht=dt(vr,Ht,Zt),ar===null?or=vr:ar.sibling=vr,ar=vr,Wt=sr}if(tr.done)return it(Ft,Wt),I$1&&tg(Ft,Zt),or;if(Wt===null){for(;!tr.done;Zt++,tr=er.next())tr=Vt(Ft,tr.value,pr),tr!==null&&(Ht=dt(tr,Ht,Zt),ar===null?or=tr:ar.sibling=tr,ar=tr);return I$1&&tg(Ft,Zt),or}for(Wt=et(Ft,Wt);!tr.done;Zt++,tr=er.next())tr=Jt(Wt,Ft,Zt,tr.value,pr),tr!==null&&($&&tr.alternate!==null&&Wt.delete(tr.key===null?Zt:tr.key),Ht=dt(tr,Ht,Zt),ar===null?or=tr:ar.sibling=tr,ar=tr);return $&&Wt.forEach(function(Vr){return j(Ft,Vr)}),I$1&&tg(Ft,Zt),or}function dr(Ft,Ht,er,pr){if(typeof er=="object"&&er!==null&&er.type===ya&&er.key===null&&(er=er.props.children),typeof er=="object"&&er!==null){switch(er.$$typeof){case va:e:{for(var or=er.key,ar=Ht;ar!==null;){if(ar.key===or){if(or=er.type,or===ya){if(ar.tag===7){it(Ft,ar.sibling),Ht=ut(ar,er.props.children),Ht.return=Ft,Ft=Ht;break e}}else if(ar.elementType===or||typeof or=="object"&&or!==null&&or.$$typeof===Ha&&uh(or)===ar.type){it(Ft,ar.sibling),Ht=ut(ar,er.props),Ht.ref=sh(Ft,ar,er),Ht.return=Ft,Ft=Ht;break e}it(Ft,ar);break}else j(Ft,ar);ar=ar.sibling}er.type===ya?(Ht=Ah(er.props.children,Ft.mode,pr,er.key),Ht.return=Ft,Ft=Ht):(pr=yh(er.type,er.key,er.props,null,Ft.mode,pr),pr.ref=sh(Ft,Ht,er),pr.return=Ft,Ft=pr)}return mt(Ft);case wa:e:{for(ar=er.key;Ht!==null;){if(Ht.key===ar)if(Ht.tag===4&&Ht.stateNode.containerInfo===er.containerInfo&&Ht.stateNode.implementation===er.implementation){it(Ft,Ht.sibling),Ht=ut(Ht,er.children||[]),Ht.return=Ft,Ft=Ht;break e}else{it(Ft,Ht);break}else j(Ft,Ht);Ht=Ht.sibling}Ht=zh(er,Ft.mode,pr),Ht.return=Ft,Ft=Ht}return mt(Ft);case Ha:return ar=er._init,dr(Ft,Ht,ar(er._payload),pr)}if(eb(er))return rr(Ft,Ht,er,pr);if(Ka(er))return Yt(Ft,Ht,er,pr);th(Ft,er)}return typeof er=="string"&&er!==""||typeof er=="number"?(er=""+er,Ht!==null&&Ht.tag===6?(it(Ft,Ht.sibling),Ht=ut(Ht,er),Ht.return=Ft,Ft=Ht):(it(Ft,Ht),Ht=xh(er,Ft.mode,pr),Ht.return=Ft,Ft=Ht),mt(Ft)):it(Ft,Ht)}return dr}var Bh=vh(!0),Ch=vh(!1),Dh={},Eh=Uf(Dh),Fh=Uf(Dh),Gh=Uf(Dh);function Hh($){if($===Dh)throw Error(p$1(174));return $}function Ih($,j){switch(G$1(Gh,j),G$1(Fh,$),G$1(Eh,Dh),$=j.nodeType,$){case 9:case 11:j=(j=j.documentElement)?j.namespaceURI:lb(null,"");break;default:$=$===8?j.parentNode:j,j=$.namespaceURI||null,$=$.tagName,j=lb(j,$)}E$1(Eh),G$1(Eh,j)}function Jh(){E$1(Eh),E$1(Fh),E$1(Gh)}function Kh($){Hh(Gh.current);var j=Hh(Eh.current),it=lb(j,$.type);j!==it&&(G$1(Fh,$),G$1(Eh,it))}function Lh($){Fh.current===$&&(E$1(Eh),E$1(Fh))}var M=Uf(0);function Mh($){for(var j=$;j!==null;){if(j.tag===13){var it=j.memoizedState;if(it!==null&&(it=it.dehydrated,it===null||it.data==="$?"||it.data==="$!"))return j}else if(j.tag===19&&j.memoizedProps.revealOrder!==void 0){if(j.flags&128)return j}else if(j.child!==null){j.child.return=j,j=j.child;continue}if(j===$)break;for(;j.sibling===null;){if(j.return===null||j.return===$)return null;j=j.return}j.sibling.return=j.return,j=j.sibling}return null}var Nh=[];function Oh(){for(var $=0;$<Nh.length;$++)Nh[$]._workInProgressVersionPrimary=null;Nh.length=0}var Ph=ua.ReactCurrentDispatcher,Qh=ua.ReactCurrentBatchConfig,Rh=0,N=null,O=null,P=null,Sh=!1,Th=!1,Uh=0,Vh=0;function Q(){throw Error(p$1(321))}function Wh($,j){if(j===null)return!1;for(var it=0;it<j.length&&it<$.length;it++)if(!He($[it],j[it]))return!1;return!0}function Xh($,j,it,et,ut,dt){if(Rh=dt,N=j,j.memoizedState=null,j.updateQueue=null,j.lanes=0,Ph.current=$===null||$.memoizedState===null?Yh:Zh,$=it(et,ut),Th){dt=0;do{if(Th=!1,Uh=0,25<=dt)throw Error(p$1(301));dt+=1,P=O=null,j.updateQueue=null,Ph.current=$h,$=it(et,ut)}while(Th)}if(Ph.current=ai,j=O!==null&&O.next!==null,Rh=0,P=O=N=null,Sh=!1,j)throw Error(p$1(300));return $}function bi(){var $=Uh!==0;return Uh=0,$}function ci(){var $={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P===null?N.memoizedState=P=$:P=P.next=$,P}function di(){if(O===null){var $=N.alternate;$=$!==null?$.memoizedState:null}else $=O.next;var j=P===null?N.memoizedState:P.next;if(j!==null)P=j,O=$;else{if($===null)throw Error(p$1(310));O=$,$={memoizedState:O.memoizedState,baseState:O.baseState,baseQueue:O.baseQueue,queue:O.queue,next:null},P===null?N.memoizedState=P=$:P=P.next=$}return P}function ei($,j){return typeof j=="function"?j($):j}function fi($){var j=di(),it=j.queue;if(it===null)throw Error(p$1(311));it.lastRenderedReducer=$;var et=O,ut=et.baseQueue,dt=it.pending;if(dt!==null){if(ut!==null){var mt=ut.next;ut.next=dt.next,dt.next=mt}et.baseQueue=ut=dt,it.pending=null}if(ut!==null){dt=ut.next,et=et.baseState;var yt=mt=null,bt=null,Rt=dt;do{var jt=Rt.lane;if((Rh&jt)===jt)bt!==null&&(bt=bt.next={lane:0,action:Rt.action,hasEagerState:Rt.hasEagerState,eagerState:Rt.eagerState,next:null}),et=Rt.hasEagerState?Rt.eagerState:$(et,Rt.action);else{var Vt={lane:jt,action:Rt.action,hasEagerState:Rt.hasEagerState,eagerState:Rt.eagerState,next:null};bt===null?(yt=bt=Vt,mt=et):bt=bt.next=Vt,N.lanes|=jt,hh|=jt}Rt=Rt.next}while(Rt!==null&&Rt!==dt);bt===null?mt=et:bt.next=yt,He(et,j.memoizedState)||(Ug=!0),j.memoizedState=et,j.baseState=mt,j.baseQueue=bt,it.lastRenderedState=et}if($=it.interleaved,$!==null){ut=$;do dt=ut.lane,N.lanes|=dt,hh|=dt,ut=ut.next;while(ut!==$)}else ut===null&&(it.lanes=0);return[j.memoizedState,it.dispatch]}function gi($){var j=di(),it=j.queue;if(it===null)throw Error(p$1(311));it.lastRenderedReducer=$;var et=it.dispatch,ut=it.pending,dt=j.memoizedState;if(ut!==null){it.pending=null;var mt=ut=ut.next;do dt=$(dt,mt.action),mt=mt.next;while(mt!==ut);He(dt,j.memoizedState)||(Ug=!0),j.memoizedState=dt,j.baseQueue===null&&(j.baseState=dt),it.lastRenderedState=dt}return[dt,et]}function hi(){}function ii($,j){var it=N,et=di(),ut=j(),dt=!He(et.memoizedState,ut);if(dt&&(et.memoizedState=ut,Ug=!0),et=et.queue,ji(ki.bind(null,it,et,$),[$]),et.getSnapshot!==j||dt||P!==null&&P.memoizedState.tag&1){if(it.flags|=2048,li(9,mi.bind(null,it,et,ut,j),void 0,null),R===null)throw Error(p$1(349));Rh&30||ni(it,j,ut)}return ut}function ni($,j,it){$.flags|=16384,$={getSnapshot:j,value:it},j=N.updateQueue,j===null?(j={lastEffect:null,stores:null},N.updateQueue=j,j.stores=[$]):(it=j.stores,it===null?j.stores=[$]:it.push($))}function mi($,j,it,et){j.value=it,j.getSnapshot=et,oi(j)&&pi($)}function ki($,j,it){return it(function(){oi(j)&&pi($)})}function oi($){var j=$.getSnapshot;$=$.value;try{var it=j();return!He($,it)}catch{return!0}}function pi($){var j=Zg($,1);j!==null&&mh(j,$,1,-1)}function qi($){var j=ci();return typeof $=="function"&&($=$()),j.memoizedState=j.baseState=$,$={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:$},j.queue=$,$=$.dispatch=ri.bind(null,N,$),[j.memoizedState,$]}function li($,j,it,et){return $={tag:$,create:j,destroy:it,deps:et,next:null},j=N.updateQueue,j===null?(j={lastEffect:null,stores:null},N.updateQueue=j,j.lastEffect=$.next=$):(it=j.lastEffect,it===null?j.lastEffect=$.next=$:(et=it.next,it.next=$,$.next=et,j.lastEffect=$)),$}function si(){return di().memoizedState}function ti($,j,it,et){var ut=ci();N.flags|=$,ut.memoizedState=li(1|j,it,void 0,et===void 0?null:et)}function ui($,j,it,et){var ut=di();et=et===void 0?null:et;var dt=void 0;if(O!==null){var mt=O.memoizedState;if(dt=mt.destroy,et!==null&&Wh(et,mt.deps)){ut.memoizedState=li(j,it,dt,et);return}}N.flags|=$,ut.memoizedState=li(1|j,it,dt,et)}function vi($,j){return ti(8390656,8,$,j)}function ji($,j){return ui(2048,8,$,j)}function wi($,j){return ui(4,2,$,j)}function xi($,j){return ui(4,4,$,j)}function yi($,j){if(typeof j=="function")return $=$(),j($),function(){j(null)};if(j!=null)return $=$(),j.current=$,function(){j.current=null}}function zi($,j,it){return it=it!=null?it.concat([$]):null,ui(4,4,yi.bind(null,j,$),it)}function Ai(){}function Bi($,j){var it=di();j=j===void 0?null:j;var et=it.memoizedState;return et!==null&&j!==null&&Wh(j,et[1])?et[0]:(it.memoizedState=[$,j],$)}function Ci($,j){var it=di();j=j===void 0?null:j;var et=it.memoizedState;return et!==null&&j!==null&&Wh(j,et[1])?et[0]:($=$(),it.memoizedState=[$,j],$)}function Di($,j,it){return Rh&21?(He(it,j)||(it=yc(),N.lanes|=it,hh|=it,$.baseState=!0),j):($.baseState&&($.baseState=!1,Ug=!0),$.memoizedState=it)}function Ei($,j){var it=C$1;C$1=it!==0&&4>it?it:4,$(!0);var et=Qh.transition;Qh.transition={};try{$(!1),j()}finally{C$1=it,Qh.transition=et}}function Fi(){return di().memoizedState}function Gi($,j,it){var et=lh($);if(it={lane:et,action:it,hasEagerState:!1,eagerState:null,next:null},Hi($))Ii(j,it);else if(it=Yg($,j,it,et),it!==null){var ut=L();mh(it,$,et,ut),Ji(it,j,et)}}function ri($,j,it){var et=lh($),ut={lane:et,action:it,hasEagerState:!1,eagerState:null,next:null};if(Hi($))Ii(j,ut);else{var dt=$.alternate;if($.lanes===0&&(dt===null||dt.lanes===0)&&(dt=j.lastRenderedReducer,dt!==null))try{var mt=j.lastRenderedState,yt=dt(mt,it);if(ut.hasEagerState=!0,ut.eagerState=yt,He(yt,mt)){var bt=j.interleaved;bt===null?(ut.next=ut,Xg(j)):(ut.next=bt.next,bt.next=ut),j.interleaved=ut;return}}catch{}finally{}it=Yg($,j,ut,et),it!==null&&(ut=L(),mh(it,$,et,ut),Ji(it,j,et))}}function Hi($){var j=$.alternate;return $===N||j!==null&&j===N}function Ii($,j){Th=Sh=!0;var it=$.pending;it===null?j.next=j:(j.next=it.next,it.next=j),$.pending=j}function Ji($,j,it){if(it&4194240){var et=j.lanes;et&=$.pendingLanes,it|=et,j.lanes=it,Cc($,it)}}var ai={readContext:Vg,useCallback:Q,useContext:Q,useEffect:Q,useImperativeHandle:Q,useInsertionEffect:Q,useLayoutEffect:Q,useMemo:Q,useReducer:Q,useRef:Q,useState:Q,useDebugValue:Q,useDeferredValue:Q,useTransition:Q,useMutableSource:Q,useSyncExternalStore:Q,useId:Q,unstable_isNewReconciler:!1},Yh={readContext:Vg,useCallback:function($,j){return ci().memoizedState=[$,j===void 0?null:j],$},useContext:Vg,useEffect:vi,useImperativeHandle:function($,j,it){return it=it!=null?it.concat([$]):null,ti(4194308,4,yi.bind(null,j,$),it)},useLayoutEffect:function($,j){return ti(4194308,4,$,j)},useInsertionEffect:function($,j){return ti(4,2,$,j)},useMemo:function($,j){var it=ci();return j=j===void 0?null:j,$=$(),it.memoizedState=[$,j],$},useReducer:function($,j,it){var et=ci();return j=it!==void 0?it(j):j,et.memoizedState=et.baseState=j,$={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$,lastRenderedState:j},et.queue=$,$=$.dispatch=Gi.bind(null,N,$),[et.memoizedState,$]},useRef:function($){var j=ci();return $={current:$},j.memoizedState=$},useState:qi,useDebugValue:Ai,useDeferredValue:function($){return ci().memoizedState=$},useTransition:function(){var $=qi(!1),j=$[0];return $=Ei.bind(null,$[1]),ci().memoizedState=$,[j,$]},useMutableSource:function(){},useSyncExternalStore:function($,j,it){var et=N,ut=ci();if(I$1){if(it===void 0)throw Error(p$1(407));it=it()}else{if(it=j(),R===null)throw Error(p$1(349));Rh&30||ni(et,j,it)}ut.memoizedState=it;var dt={value:it,getSnapshot:j};return ut.queue=dt,vi(ki.bind(null,et,dt,$),[$]),et.flags|=2048,li(9,mi.bind(null,et,dt,it,j),void 0,null),it},useId:function(){var $=ci(),j=R.identifierPrefix;if(I$1){var it=sg,et=rg;it=(et&~(1<<32-oc(et)-1)).toString(32)+it,j=":"+j+"R"+it,it=Uh++,0<it&&(j+="H"+it.toString(32)),j+=":"}else it=Vh++,j=":"+j+"r"+it.toString(32)+":";return $.memoizedState=j},unstable_isNewReconciler:!1},Zh={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:fi,useRef:si,useState:function(){return fi(ei)},useDebugValue:Ai,useDeferredValue:function($){var j=di();return Di(j,O.memoizedState,$)},useTransition:function(){var $=fi(ei)[0],j=di().memoizedState;return[$,j]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1},$h={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:gi,useRef:si,useState:function(){return gi(ei)},useDebugValue:Ai,useDeferredValue:function($){var j=di();return O===null?j.memoizedState=$:Di(j,O.memoizedState,$)},useTransition:function(){var $=gi(ei)[0],j=di().memoizedState;return[$,j]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1};function Ki($,j){try{var it="",et=j;do it+=Pa(et),et=et.return;while(et);var ut=it}catch(dt){ut=`
Error generating stack: `+dt.message+`
`+dt.stack}return{value:$,source:j,stack:ut,digest:null}}function Li($,j,it){return{value:$,source:null,stack:it??null,digest:j??null}}function Mi($,j){try{console.error(j.value)}catch(it){setTimeout(function(){throw it})}}var Ni=typeof WeakMap=="function"?WeakMap:Map;function Oi($,j,it){it=ch(-1,it),it.tag=3,it.payload={element:null};var et=j.value;return it.callback=function(){Pi||(Pi=!0,Qi=et),Mi($,j)},it}function Ri($,j,it){it=ch(-1,it),it.tag=3;var et=$.type.getDerivedStateFromError;if(typeof et=="function"){var ut=j.value;it.payload=function(){return et(ut)},it.callback=function(){Mi($,j)}}var dt=$.stateNode;return dt!==null&&typeof dt.componentDidCatch=="function"&&(it.callback=function(){Mi($,j),typeof et!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var mt=j.stack;this.componentDidCatch(j.value,{componentStack:mt!==null?mt:""})}),it}function Ti($,j,it){var et=$.pingCache;if(et===null){et=$.pingCache=new Ni;var ut=new Set;et.set(j,ut)}else ut=et.get(j),ut===void 0&&(ut=new Set,et.set(j,ut));ut.has(it)||(ut.add(it),$=Ui.bind(null,$,j,it),j.then($,$))}function Vi($){do{var j;if((j=$.tag===13)&&(j=$.memoizedState,j=j!==null?j.dehydrated!==null:!0),j)return $;$=$.return}while($!==null);return null}function Wi($,j,it,et,ut){return $.mode&1?($.flags|=65536,$.lanes=ut,$):($===j?$.flags|=65536:($.flags|=128,it.flags|=131072,it.flags&=-52805,it.tag===1&&(it.alternate===null?it.tag=17:(j=ch(-1,1),j.tag=2,dh(it,j,1))),it.lanes|=1),$)}var Xi=ua.ReactCurrentOwner,Ug=!1;function Yi($,j,it,et){j.child=$===null?Ch(j,null,it,et):Bh(j,$.child,it,et)}function Zi($,j,it,et,ut){it=it.render;var dt=j.ref;return Tg(j,ut),et=Xh($,j,it,et,dt,ut),it=bi(),$!==null&&!Ug?(j.updateQueue=$.updateQueue,j.flags&=-2053,$.lanes&=~ut,$i($,j,ut)):(I$1&&it&&vg(j),j.flags|=1,Yi($,j,et,ut),j.child)}function aj($,j,it,et,ut){if($===null){var dt=it.type;return typeof dt=="function"&&!bj(dt)&&dt.defaultProps===void 0&&it.compare===null&&it.defaultProps===void 0?(j.tag=15,j.type=dt,cj($,j,dt,et,ut)):($=yh(it.type,null,et,j,j.mode,ut),$.ref=j.ref,$.return=j,j.child=$)}if(dt=$.child,!($.lanes&ut)){var mt=dt.memoizedProps;if(it=it.compare,it=it!==null?it:Ie,it(mt,et)&&$.ref===j.ref)return $i($,j,ut)}return j.flags|=1,$=wh(dt,et),$.ref=j.ref,$.return=j,j.child=$}function cj($,j,it,et,ut){if($!==null){var dt=$.memoizedProps;if(Ie(dt,et)&&$.ref===j.ref)if(Ug=!1,j.pendingProps=et=dt,($.lanes&ut)!==0)$.flags&131072&&(Ug=!0);else return j.lanes=$.lanes,$i($,j,ut)}return dj($,j,it,et,ut)}function ej($,j,it){var et=j.pendingProps,ut=et.children,dt=$!==null?$.memoizedState:null;if(et.mode==="hidden")if(!(j.mode&1))j.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$1(fj,gj),gj|=it;else{if(!(it&1073741824))return $=dt!==null?dt.baseLanes|it:it,j.lanes=j.childLanes=1073741824,j.memoizedState={baseLanes:$,cachePool:null,transitions:null},j.updateQueue=null,G$1(fj,gj),gj|=$,null;j.memoizedState={baseLanes:0,cachePool:null,transitions:null},et=dt!==null?dt.baseLanes:it,G$1(fj,gj),gj|=et}else dt!==null?(et=dt.baseLanes|it,j.memoizedState=null):et=it,G$1(fj,gj),gj|=et;return Yi($,j,ut,it),j.child}function hj($,j){var it=j.ref;($===null&&it!==null||$!==null&&$.ref!==it)&&(j.flags|=512,j.flags|=2097152)}function dj($,j,it,et,ut){var dt=Zf(it)?Xf:H$1.current;return dt=Yf(j,dt),Tg(j,ut),it=Xh($,j,it,et,dt,ut),et=bi(),$!==null&&!Ug?(j.updateQueue=$.updateQueue,j.flags&=-2053,$.lanes&=~ut,$i($,j,ut)):(I$1&&et&&vg(j),j.flags|=1,Yi($,j,it,ut),j.child)}function ij($,j,it,et,ut){if(Zf(it)){var dt=!0;cg(j)}else dt=!1;if(Tg(j,ut),j.stateNode===null)jj($,j),ph(j,it,et),rh(j,it,et,ut),et=!0;else if($===null){var mt=j.stateNode,yt=j.memoizedProps;mt.props=yt;var bt=mt.context,Rt=it.contextType;typeof Rt=="object"&&Rt!==null?Rt=Vg(Rt):(Rt=Zf(it)?Xf:H$1.current,Rt=Yf(j,Rt));var jt=it.getDerivedStateFromProps,Vt=typeof jt=="function"||typeof mt.getSnapshotBeforeUpdate=="function";Vt||typeof mt.UNSAFE_componentWillReceiveProps!="function"&&typeof mt.componentWillReceiveProps!="function"||(yt!==et||bt!==Rt)&&qh(j,mt,et,Rt),$g=!1;var zt=j.memoizedState;mt.state=zt,gh(j,et,mt,ut),bt=j.memoizedState,yt!==et||zt!==bt||Wf.current||$g?(typeof jt=="function"&&(kh(j,it,jt,et),bt=j.memoizedState),(yt=$g||oh(j,it,yt,et,zt,bt,Rt))?(Vt||typeof mt.UNSAFE_componentWillMount!="function"&&typeof mt.componentWillMount!="function"||(typeof mt.componentWillMount=="function"&&mt.componentWillMount(),typeof mt.UNSAFE_componentWillMount=="function"&&mt.UNSAFE_componentWillMount()),typeof mt.componentDidMount=="function"&&(j.flags|=4194308)):(typeof mt.componentDidMount=="function"&&(j.flags|=4194308),j.memoizedProps=et,j.memoizedState=bt),mt.props=et,mt.state=bt,mt.context=Rt,et=yt):(typeof mt.componentDidMount=="function"&&(j.flags|=4194308),et=!1)}else{mt=j.stateNode,bh($,j),yt=j.memoizedProps,Rt=j.type===j.elementType?yt:Lg(j.type,yt),mt.props=Rt,Vt=j.pendingProps,zt=mt.context,bt=it.contextType,typeof bt=="object"&&bt!==null?bt=Vg(bt):(bt=Zf(it)?Xf:H$1.current,bt=Yf(j,bt));var Jt=it.getDerivedStateFromProps;(jt=typeof Jt=="function"||typeof mt.getSnapshotBeforeUpdate=="function")||typeof mt.UNSAFE_componentWillReceiveProps!="function"&&typeof mt.componentWillReceiveProps!="function"||(yt!==Vt||zt!==bt)&&qh(j,mt,et,bt),$g=!1,zt=j.memoizedState,mt.state=zt,gh(j,et,mt,ut);var rr=j.memoizedState;yt!==Vt||zt!==rr||Wf.current||$g?(typeof Jt=="function"&&(kh(j,it,Jt,et),rr=j.memoizedState),(Rt=$g||oh(j,it,Rt,et,zt,rr,bt)||!1)?(jt||typeof mt.UNSAFE_componentWillUpdate!="function"&&typeof mt.componentWillUpdate!="function"||(typeof mt.componentWillUpdate=="function"&&mt.componentWillUpdate(et,rr,bt),typeof mt.UNSAFE_componentWillUpdate=="function"&&mt.UNSAFE_componentWillUpdate(et,rr,bt)),typeof mt.componentDidUpdate=="function"&&(j.flags|=4),typeof mt.getSnapshotBeforeUpdate=="function"&&(j.flags|=1024)):(typeof mt.componentDidUpdate!="function"||yt===$.memoizedProps&&zt===$.memoizedState||(j.flags|=4),typeof mt.getSnapshotBeforeUpdate!="function"||yt===$.memoizedProps&&zt===$.memoizedState||(j.flags|=1024),j.memoizedProps=et,j.memoizedState=rr),mt.props=et,mt.state=rr,mt.context=bt,et=Rt):(typeof mt.componentDidUpdate!="function"||yt===$.memoizedProps&&zt===$.memoizedState||(j.flags|=4),typeof mt.getSnapshotBeforeUpdate!="function"||yt===$.memoizedProps&&zt===$.memoizedState||(j.flags|=1024),et=!1)}return kj($,j,it,et,dt,ut)}function kj($,j,it,et,ut,dt){hj($,j);var mt=(j.flags&128)!==0;if(!et&&!mt)return ut&&dg(j,it,!1),$i($,j,dt);et=j.stateNode,Xi.current=j;var yt=mt&&typeof it.getDerivedStateFromError!="function"?null:et.render();return j.flags|=1,$!==null&&mt?(j.child=Bh(j,$.child,null,dt),j.child=Bh(j,null,yt,dt)):Yi($,j,yt,dt),j.memoizedState=et.state,ut&&dg(j,it,!0),j.child}function lj($){var j=$.stateNode;j.pendingContext?ag($,j.pendingContext,j.pendingContext!==j.context):j.context&&ag($,j.context,!1),Ih($,j.containerInfo)}function mj($,j,it,et,ut){return Ig(),Jg(ut),j.flags|=256,Yi($,j,it,et),j.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj($){return{baseLanes:$,cachePool:null,transitions:null}}function pj($,j,it){var et=j.pendingProps,ut=M.current,dt=!1,mt=(j.flags&128)!==0,yt;if((yt=mt)||(yt=$!==null&&$.memoizedState===null?!1:(ut&2)!==0),yt?(dt=!0,j.flags&=-129):($===null||$.memoizedState!==null)&&(ut|=1),G$1(M,ut&1),$===null)return Eg(j),$=j.memoizedState,$!==null&&($=$.dehydrated,$!==null)?(j.mode&1?$.data==="$!"?j.lanes=8:j.lanes=1073741824:j.lanes=1,null):(mt=et.children,$=et.fallback,dt?(et=j.mode,dt=j.child,mt={mode:"hidden",children:mt},!(et&1)&&dt!==null?(dt.childLanes=0,dt.pendingProps=mt):dt=qj(mt,et,0,null),$=Ah($,et,it,null),dt.return=j,$.return=j,dt.sibling=$,j.child=dt,j.child.memoizedState=oj(it),j.memoizedState=nj,$):rj(j,mt));if(ut=$.memoizedState,ut!==null&&(yt=ut.dehydrated,yt!==null))return sj($,j,mt,et,yt,ut,it);if(dt){dt=et.fallback,mt=j.mode,ut=$.child,yt=ut.sibling;var bt={mode:"hidden",children:et.children};return!(mt&1)&&j.child!==ut?(et=j.child,et.childLanes=0,et.pendingProps=bt,j.deletions=null):(et=wh(ut,bt),et.subtreeFlags=ut.subtreeFlags&14680064),yt!==null?dt=wh(yt,dt):(dt=Ah(dt,mt,it,null),dt.flags|=2),dt.return=j,et.return=j,et.sibling=dt,j.child=et,et=dt,dt=j.child,mt=$.child.memoizedState,mt=mt===null?oj(it):{baseLanes:mt.baseLanes|it,cachePool:null,transitions:mt.transitions},dt.memoizedState=mt,dt.childLanes=$.childLanes&~it,j.memoizedState=nj,et}return dt=$.child,$=dt.sibling,et=wh(dt,{mode:"visible",children:et.children}),!(j.mode&1)&&(et.lanes=it),et.return=j,et.sibling=null,$!==null&&(it=j.deletions,it===null?(j.deletions=[$],j.flags|=16):it.push($)),j.child=et,j.memoizedState=null,et}function rj($,j){return j=qj({mode:"visible",children:j},$.mode,0,null),j.return=$,$.child=j}function tj($,j,it,et){return et!==null&&Jg(et),Bh(j,$.child,null,it),$=rj(j,j.pendingProps.children),$.flags|=2,j.memoizedState=null,$}function sj($,j,it,et,ut,dt,mt){if(it)return j.flags&256?(j.flags&=-257,et=Li(Error(p$1(422))),tj($,j,mt,et)):j.memoizedState!==null?(j.child=$.child,j.flags|=128,null):(dt=et.fallback,ut=j.mode,et=qj({mode:"visible",children:et.children},ut,0,null),dt=Ah(dt,ut,mt,null),dt.flags|=2,et.return=j,dt.return=j,et.sibling=dt,j.child=et,j.mode&1&&Bh(j,$.child,null,mt),j.child.memoizedState=oj(mt),j.memoizedState=nj,dt);if(!(j.mode&1))return tj($,j,mt,null);if(ut.data==="$!"){if(et=ut.nextSibling&&ut.nextSibling.dataset,et)var yt=et.dgst;return et=yt,dt=Error(p$1(419)),et=Li(dt,et,void 0),tj($,j,mt,et)}if(yt=(mt&$.childLanes)!==0,Ug||yt){if(et=R,et!==null){switch(mt&-mt){case 4:ut=2;break;case 16:ut=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:ut=32;break;case 536870912:ut=268435456;break;default:ut=0}ut=ut&(et.suspendedLanes|mt)?0:ut,ut!==0&&ut!==dt.retryLane&&(dt.retryLane=ut,Zg($,ut),mh(et,$,ut,-1))}return uj(),et=Li(Error(p$1(421))),tj($,j,mt,et)}return ut.data==="$?"?(j.flags|=128,j.child=$.child,j=vj.bind(null,$),ut._reactRetry=j,null):($=dt.treeContext,yg=Lf(ut.nextSibling),xg=j,I$1=!0,zg=null,$!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=$.id,sg=$.overflow,qg=j),j=rj(j,et.children),j.flags|=4096,j)}function wj($,j,it){$.lanes|=j;var et=$.alternate;et!==null&&(et.lanes|=j),Sg($.return,j,it)}function xj($,j,it,et,ut){var dt=$.memoizedState;dt===null?$.memoizedState={isBackwards:j,rendering:null,renderingStartTime:0,last:et,tail:it,tailMode:ut}:(dt.isBackwards=j,dt.rendering=null,dt.renderingStartTime=0,dt.last=et,dt.tail=it,dt.tailMode=ut)}function yj($,j,it){var et=j.pendingProps,ut=et.revealOrder,dt=et.tail;if(Yi($,j,et.children,it),et=M.current,et&2)et=et&1|2,j.flags|=128;else{if($!==null&&$.flags&128)e:for($=j.child;$!==null;){if($.tag===13)$.memoizedState!==null&&wj($,it,j);else if($.tag===19)wj($,it,j);else if($.child!==null){$.child.return=$,$=$.child;continue}if($===j)break e;for(;$.sibling===null;){if($.return===null||$.return===j)break e;$=$.return}$.sibling.return=$.return,$=$.sibling}et&=1}if(G$1(M,et),!(j.mode&1))j.memoizedState=null;else switch(ut){case"forwards":for(it=j.child,ut=null;it!==null;)$=it.alternate,$!==null&&Mh($)===null&&(ut=it),it=it.sibling;it=ut,it===null?(ut=j.child,j.child=null):(ut=it.sibling,it.sibling=null),xj(j,!1,ut,it,dt);break;case"backwards":for(it=null,ut=j.child,j.child=null;ut!==null;){if($=ut.alternate,$!==null&&Mh($)===null){j.child=ut;break}$=ut.sibling,ut.sibling=it,it=ut,ut=$}xj(j,!0,it,null,dt);break;case"together":xj(j,!1,null,null,void 0);break;default:j.memoizedState=null}return j.child}function jj($,j){!(j.mode&1)&&$!==null&&($.alternate=null,j.alternate=null,j.flags|=2)}function $i($,j,it){if($!==null&&(j.dependencies=$.dependencies),hh|=j.lanes,!(it&j.childLanes))return null;if($!==null&&j.child!==$.child)throw Error(p$1(153));if(j.child!==null){for($=j.child,it=wh($,$.pendingProps),j.child=it,it.return=j;$.sibling!==null;)$=$.sibling,it=it.sibling=wh($,$.pendingProps),it.return=j;it.sibling=null}return j.child}function zj($,j,it){switch(j.tag){case 3:lj(j),Ig();break;case 5:Kh(j);break;case 1:Zf(j.type)&&cg(j);break;case 4:Ih(j,j.stateNode.containerInfo);break;case 10:var et=j.type._context,ut=j.memoizedProps.value;G$1(Mg,et._currentValue),et._currentValue=ut;break;case 13:if(et=j.memoizedState,et!==null)return et.dehydrated!==null?(G$1(M,M.current&1),j.flags|=128,null):it&j.child.childLanes?pj($,j,it):(G$1(M,M.current&1),$=$i($,j,it),$!==null?$.sibling:null);G$1(M,M.current&1);break;case 19:if(et=(it&j.childLanes)!==0,$.flags&128){if(et)return yj($,j,it);j.flags|=128}if(ut=j.memoizedState,ut!==null&&(ut.rendering=null,ut.tail=null,ut.lastEffect=null),G$1(M,M.current),et)break;return null;case 22:case 23:return j.lanes=0,ej($,j,it)}return $i($,j,it)}var Aj,Bj,Cj,Dj;Aj=function($,j){for(var it=j.child;it!==null;){if(it.tag===5||it.tag===6)$.appendChild(it.stateNode);else if(it.tag!==4&&it.child!==null){it.child.return=it,it=it.child;continue}if(it===j)break;for(;it.sibling===null;){if(it.return===null||it.return===j)return;it=it.return}it.sibling.return=it.return,it=it.sibling}};Bj=function(){};Cj=function($,j,it,et){var ut=$.memoizedProps;if(ut!==et){$=j.stateNode,Hh(Eh.current);var dt=null;switch(it){case"input":ut=Ya($,ut),et=Ya($,et),dt=[];break;case"select":ut=A$1({},ut,{value:void 0}),et=A$1({},et,{value:void 0}),dt=[];break;case"textarea":ut=gb($,ut),et=gb($,et),dt=[];break;default:typeof ut.onClick!="function"&&typeof et.onClick=="function"&&($.onclick=Bf)}ub(it,et);var mt;it=null;for(Rt in ut)if(!et.hasOwnProperty(Rt)&&ut.hasOwnProperty(Rt)&&ut[Rt]!=null)if(Rt==="style"){var yt=ut[Rt];for(mt in yt)yt.hasOwnProperty(mt)&&(it||(it={}),it[mt]="")}else Rt!=="dangerouslySetInnerHTML"&&Rt!=="children"&&Rt!=="suppressContentEditableWarning"&&Rt!=="suppressHydrationWarning"&&Rt!=="autoFocus"&&(ea.hasOwnProperty(Rt)?dt||(dt=[]):(dt=dt||[]).push(Rt,null));for(Rt in et){var bt=et[Rt];if(yt=ut!=null?ut[Rt]:void 0,et.hasOwnProperty(Rt)&&bt!==yt&&(bt!=null||yt!=null))if(Rt==="style")if(yt){for(mt in yt)!yt.hasOwnProperty(mt)||bt&&bt.hasOwnProperty(mt)||(it||(it={}),it[mt]="");for(mt in bt)bt.hasOwnProperty(mt)&&yt[mt]!==bt[mt]&&(it||(it={}),it[mt]=bt[mt])}else it||(dt||(dt=[]),dt.push(Rt,it)),it=bt;else Rt==="dangerouslySetInnerHTML"?(bt=bt?bt.__html:void 0,yt=yt?yt.__html:void 0,bt!=null&&yt!==bt&&(dt=dt||[]).push(Rt,bt)):Rt==="children"?typeof bt!="string"&&typeof bt!="number"||(dt=dt||[]).push(Rt,""+bt):Rt!=="suppressContentEditableWarning"&&Rt!=="suppressHydrationWarning"&&(ea.hasOwnProperty(Rt)?(bt!=null&&Rt==="onScroll"&&D$1("scroll",$),dt||yt===bt||(dt=[])):(dt=dt||[]).push(Rt,bt))}it&&(dt=dt||[]).push("style",it);var Rt=dt;(j.updateQueue=Rt)&&(j.flags|=4)}};Dj=function($,j,it,et){it!==et&&(j.flags|=4)};function Ej($,j){if(!I$1)switch($.tailMode){case"hidden":j=$.tail;for(var it=null;j!==null;)j.alternate!==null&&(it=j),j=j.sibling;it===null?$.tail=null:it.sibling=null;break;case"collapsed":it=$.tail;for(var et=null;it!==null;)it.alternate!==null&&(et=it),it=it.sibling;et===null?j||$.tail===null?$.tail=null:$.tail.sibling=null:et.sibling=null}}function S($){var j=$.alternate!==null&&$.alternate.child===$.child,it=0,et=0;if(j)for(var ut=$.child;ut!==null;)it|=ut.lanes|ut.childLanes,et|=ut.subtreeFlags&14680064,et|=ut.flags&14680064,ut.return=$,ut=ut.sibling;else for(ut=$.child;ut!==null;)it|=ut.lanes|ut.childLanes,et|=ut.subtreeFlags,et|=ut.flags,ut.return=$,ut=ut.sibling;return $.subtreeFlags|=et,$.childLanes=it,j}function Fj($,j,it){var et=j.pendingProps;switch(wg(j),j.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(j),null;case 1:return Zf(j.type)&&$f(),S(j),null;case 3:return et=j.stateNode,Jh(),E$1(Wf),E$1(H$1),Oh(),et.pendingContext&&(et.context=et.pendingContext,et.pendingContext=null),($===null||$.child===null)&&(Gg(j)?j.flags|=4:$===null||$.memoizedState.isDehydrated&&!(j.flags&256)||(j.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj($,j),S(j),null;case 5:Lh(j);var ut=Hh(Gh.current);if(it=j.type,$!==null&&j.stateNode!=null)Cj($,j,it,et,ut),$.ref!==j.ref&&(j.flags|=512,j.flags|=2097152);else{if(!et){if(j.stateNode===null)throw Error(p$1(166));return S(j),null}if($=Hh(Eh.current),Gg(j)){et=j.stateNode,it=j.type;var dt=j.memoizedProps;switch(et[Of]=j,et[Pf]=dt,$=(j.mode&1)!==0,it){case"dialog":D$1("cancel",et),D$1("close",et);break;case"iframe":case"object":case"embed":D$1("load",et);break;case"video":case"audio":for(ut=0;ut<lf.length;ut++)D$1(lf[ut],et);break;case"source":D$1("error",et);break;case"img":case"image":case"link":D$1("error",et),D$1("load",et);break;case"details":D$1("toggle",et);break;case"input":Za(et,dt),D$1("invalid",et);break;case"select":et._wrapperState={wasMultiple:!!dt.multiple},D$1("invalid",et);break;case"textarea":hb(et,dt),D$1("invalid",et)}ub(it,dt),ut=null;for(var mt in dt)if(dt.hasOwnProperty(mt)){var yt=dt[mt];mt==="children"?typeof yt=="string"?et.textContent!==yt&&(dt.suppressHydrationWarning!==!0&&Af(et.textContent,yt,$),ut=["children",yt]):typeof yt=="number"&&et.textContent!==""+yt&&(dt.suppressHydrationWarning!==!0&&Af(et.textContent,yt,$),ut=["children",""+yt]):ea.hasOwnProperty(mt)&&yt!=null&&mt==="onScroll"&&D$1("scroll",et)}switch(it){case"input":Va(et),db(et,dt,!0);break;case"textarea":Va(et),jb(et);break;case"select":case"option":break;default:typeof dt.onClick=="function"&&(et.onclick=Bf)}et=ut,j.updateQueue=et,et!==null&&(j.flags|=4)}else{mt=ut.nodeType===9?ut:ut.ownerDocument,$==="http://www.w3.org/1999/xhtml"&&($=kb(it)),$==="http://www.w3.org/1999/xhtml"?it==="script"?($=mt.createElement("div"),$.innerHTML="<script><\/script>",$=$.removeChild($.firstChild)):typeof et.is=="string"?$=mt.createElement(it,{is:et.is}):($=mt.createElement(it),it==="select"&&(mt=$,et.multiple?mt.multiple=!0:et.size&&(mt.size=et.size))):$=mt.createElementNS($,it),$[Of]=j,$[Pf]=et,Aj($,j,!1,!1),j.stateNode=$;e:{switch(mt=vb(it,et),it){case"dialog":D$1("cancel",$),D$1("close",$),ut=et;break;case"iframe":case"object":case"embed":D$1("load",$),ut=et;break;case"video":case"audio":for(ut=0;ut<lf.length;ut++)D$1(lf[ut],$);ut=et;break;case"source":D$1("error",$),ut=et;break;case"img":case"image":case"link":D$1("error",$),D$1("load",$),ut=et;break;case"details":D$1("toggle",$),ut=et;break;case"input":Za($,et),ut=Ya($,et),D$1("invalid",$);break;case"option":ut=et;break;case"select":$._wrapperState={wasMultiple:!!et.multiple},ut=A$1({},et,{value:void 0}),D$1("invalid",$);break;case"textarea":hb($,et),ut=gb($,et),D$1("invalid",$);break;default:ut=et}ub(it,ut),yt=ut;for(dt in yt)if(yt.hasOwnProperty(dt)){var bt=yt[dt];dt==="style"?sb($,bt):dt==="dangerouslySetInnerHTML"?(bt=bt?bt.__html:void 0,bt!=null&&nb($,bt)):dt==="children"?typeof bt=="string"?(it!=="textarea"||bt!=="")&&ob($,bt):typeof bt=="number"&&ob($,""+bt):dt!=="suppressContentEditableWarning"&&dt!=="suppressHydrationWarning"&&dt!=="autoFocus"&&(ea.hasOwnProperty(dt)?bt!=null&&dt==="onScroll"&&D$1("scroll",$):bt!=null&&ta($,dt,bt,mt))}switch(it){case"input":Va($),db($,et,!1);break;case"textarea":Va($),jb($);break;case"option":et.value!=null&&$.setAttribute("value",""+Sa(et.value));break;case"select":$.multiple=!!et.multiple,dt=et.value,dt!=null?fb($,!!et.multiple,dt,!1):et.defaultValue!=null&&fb($,!!et.multiple,et.defaultValue,!0);break;default:typeof ut.onClick=="function"&&($.onclick=Bf)}switch(it){case"button":case"input":case"select":case"textarea":et=!!et.autoFocus;break e;case"img":et=!0;break e;default:et=!1}}et&&(j.flags|=4)}j.ref!==null&&(j.flags|=512,j.flags|=2097152)}return S(j),null;case 6:if($&&j.stateNode!=null)Dj($,j,$.memoizedProps,et);else{if(typeof et!="string"&&j.stateNode===null)throw Error(p$1(166));if(it=Hh(Gh.current),Hh(Eh.current),Gg(j)){if(et=j.stateNode,it=j.memoizedProps,et[Of]=j,(dt=et.nodeValue!==it)&&($=xg,$!==null))switch($.tag){case 3:Af(et.nodeValue,it,($.mode&1)!==0);break;case 5:$.memoizedProps.suppressHydrationWarning!==!0&&Af(et.nodeValue,it,($.mode&1)!==0)}dt&&(j.flags|=4)}else et=(it.nodeType===9?it:it.ownerDocument).createTextNode(et),et[Of]=j,j.stateNode=et}return S(j),null;case 13:if(E$1(M),et=j.memoizedState,$===null||$.memoizedState!==null&&$.memoizedState.dehydrated!==null){if(I$1&&yg!==null&&j.mode&1&&!(j.flags&128))Hg(),Ig(),j.flags|=98560,dt=!1;else if(dt=Gg(j),et!==null&&et.dehydrated!==null){if($===null){if(!dt)throw Error(p$1(318));if(dt=j.memoizedState,dt=dt!==null?dt.dehydrated:null,!dt)throw Error(p$1(317));dt[Of]=j}else Ig(),!(j.flags&128)&&(j.memoizedState=null),j.flags|=4;S(j),dt=!1}else zg!==null&&(Gj(zg),zg=null),dt=!0;if(!dt)return j.flags&65536?j:null}return j.flags&128?(j.lanes=it,j):(et=et!==null,et!==($!==null&&$.memoizedState!==null)&&et&&(j.child.flags|=8192,j.mode&1&&($===null||M.current&1?T===0&&(T=3):uj())),j.updateQueue!==null&&(j.flags|=4),S(j),null);case 4:return Jh(),Bj($,j),$===null&&sf(j.stateNode.containerInfo),S(j),null;case 10:return Rg(j.type._context),S(j),null;case 17:return Zf(j.type)&&$f(),S(j),null;case 19:if(E$1(M),dt=j.memoizedState,dt===null)return S(j),null;if(et=(j.flags&128)!==0,mt=dt.rendering,mt===null)if(et)Ej(dt,!1);else{if(T!==0||$!==null&&$.flags&128)for($=j.child;$!==null;){if(mt=Mh($),mt!==null){for(j.flags|=128,Ej(dt,!1),et=mt.updateQueue,et!==null&&(j.updateQueue=et,j.flags|=4),j.subtreeFlags=0,et=it,it=j.child;it!==null;)dt=it,$=et,dt.flags&=14680066,mt=dt.alternate,mt===null?(dt.childLanes=0,dt.lanes=$,dt.child=null,dt.subtreeFlags=0,dt.memoizedProps=null,dt.memoizedState=null,dt.updateQueue=null,dt.dependencies=null,dt.stateNode=null):(dt.childLanes=mt.childLanes,dt.lanes=mt.lanes,dt.child=mt.child,dt.subtreeFlags=0,dt.deletions=null,dt.memoizedProps=mt.memoizedProps,dt.memoizedState=mt.memoizedState,dt.updateQueue=mt.updateQueue,dt.type=mt.type,$=mt.dependencies,dt.dependencies=$===null?null:{lanes:$.lanes,firstContext:$.firstContext}),it=it.sibling;return G$1(M,M.current&1|2),j.child}$=$.sibling}dt.tail!==null&&B$1()>Hj&&(j.flags|=128,et=!0,Ej(dt,!1),j.lanes=4194304)}else{if(!et)if($=Mh(mt),$!==null){if(j.flags|=128,et=!0,it=$.updateQueue,it!==null&&(j.updateQueue=it,j.flags|=4),Ej(dt,!0),dt.tail===null&&dt.tailMode==="hidden"&&!mt.alternate&&!I$1)return S(j),null}else 2*B$1()-dt.renderingStartTime>Hj&&it!==1073741824&&(j.flags|=128,et=!0,Ej(dt,!1),j.lanes=4194304);dt.isBackwards?(mt.sibling=j.child,j.child=mt):(it=dt.last,it!==null?it.sibling=mt:j.child=mt,dt.last=mt)}return dt.tail!==null?(j=dt.tail,dt.rendering=j,dt.tail=j.sibling,dt.renderingStartTime=B$1(),j.sibling=null,it=M.current,G$1(M,et?it&1|2:it&1),j):(S(j),null);case 22:case 23:return Ij(),et=j.memoizedState!==null,$!==null&&$.memoizedState!==null!==et&&(j.flags|=8192),et&&j.mode&1?gj&1073741824&&(S(j),j.subtreeFlags&6&&(j.flags|=8192)):S(j),null;case 24:return null;case 25:return null}throw Error(p$1(156,j.tag))}function Jj($,j){switch(wg(j),j.tag){case 1:return Zf(j.type)&&$f(),$=j.flags,$&65536?(j.flags=$&-65537|128,j):null;case 3:return Jh(),E$1(Wf),E$1(H$1),Oh(),$=j.flags,$&65536&&!($&128)?(j.flags=$&-65537|128,j):null;case 5:return Lh(j),null;case 13:if(E$1(M),$=j.memoizedState,$!==null&&$.dehydrated!==null){if(j.alternate===null)throw Error(p$1(340));Ig()}return $=j.flags,$&65536?(j.flags=$&-65537|128,j):null;case 19:return E$1(M),null;case 4:return Jh(),null;case 10:return Rg(j.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Mj($,j){var it=$.ref;if(it!==null)if(typeof it=="function")try{it(null)}catch(et){W($,j,et)}else it.current=null}function Nj($,j,it){try{it()}catch(et){W($,j,et)}}var Oj=!1;function Pj($,j){if(Cf=dd,$=Me(),Ne($)){if("selectionStart"in $)var it={start:$.selectionStart,end:$.selectionEnd};else e:{it=(it=$.ownerDocument)&&it.defaultView||window;var et=it.getSelection&&it.getSelection();if(et&&et.rangeCount!==0){it=et.anchorNode;var ut=et.anchorOffset,dt=et.focusNode;et=et.focusOffset;try{it.nodeType,dt.nodeType}catch{it=null;break e}var mt=0,yt=-1,bt=-1,Rt=0,jt=0,Vt=$,zt=null;t:for(;;){for(var Jt;Vt!==it||ut!==0&&Vt.nodeType!==3||(yt=mt+ut),Vt!==dt||et!==0&&Vt.nodeType!==3||(bt=mt+et),Vt.nodeType===3&&(mt+=Vt.nodeValue.length),(Jt=Vt.firstChild)!==null;)zt=Vt,Vt=Jt;for(;;){if(Vt===$)break t;if(zt===it&&++Rt===ut&&(yt=mt),zt===dt&&++jt===et&&(bt=mt),(Jt=Vt.nextSibling)!==null)break;Vt=zt,zt=Vt.parentNode}Vt=Jt}it=yt===-1||bt===-1?null:{start:yt,end:bt}}else it=null}it=it||{start:0,end:0}}else it=null;for(Df={focusedElem:$,selectionRange:it},dd=!1,V=j;V!==null;)if(j=V,$=j.child,(j.subtreeFlags&1028)!==0&&$!==null)$.return=j,V=$;else for(;V!==null;){j=V;try{var rr=j.alternate;if(j.flags&1024)switch(j.tag){case 0:case 11:case 15:break;case 1:if(rr!==null){var Yt=rr.memoizedProps,dr=rr.memoizedState,Ft=j.stateNode,Ht=Ft.getSnapshotBeforeUpdate(j.elementType===j.type?Yt:Lg(j.type,Yt),dr);Ft.__reactInternalSnapshotBeforeUpdate=Ht}break;case 3:var er=j.stateNode.containerInfo;er.nodeType===1?er.textContent="":er.nodeType===9&&er.documentElement&&er.removeChild(er.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$1(163))}}catch(pr){W(j,j.return,pr)}if($=j.sibling,$!==null){$.return=j.return,V=$;break}V=j.return}return rr=Oj,Oj=!1,rr}function Qj($,j,it){var et=j.updateQueue;if(et=et!==null?et.lastEffect:null,et!==null){var ut=et=et.next;do{if((ut.tag&$)===$){var dt=ut.destroy;ut.destroy=void 0,dt!==void 0&&Nj(j,it,dt)}ut=ut.next}while(ut!==et)}}function Rj($,j){if(j=j.updateQueue,j=j!==null?j.lastEffect:null,j!==null){var it=j=j.next;do{if((it.tag&$)===$){var et=it.create;it.destroy=et()}it=it.next}while(it!==j)}}function Sj($){var j=$.ref;if(j!==null){var it=$.stateNode;switch($.tag){case 5:$=it;break;default:$=it}typeof j=="function"?j($):j.current=$}}function Tj($){var j=$.alternate;j!==null&&($.alternate=null,Tj(j)),$.child=null,$.deletions=null,$.sibling=null,$.tag===5&&(j=$.stateNode,j!==null&&(delete j[Of],delete j[Pf],delete j[of],delete j[Qf],delete j[Rf])),$.stateNode=null,$.return=null,$.dependencies=null,$.memoizedProps=null,$.memoizedState=null,$.pendingProps=null,$.stateNode=null,$.updateQueue=null}function Uj($){return $.tag===5||$.tag===3||$.tag===4}function Vj($){e:for(;;){for(;$.sibling===null;){if($.return===null||Uj($.return))return null;$=$.return}for($.sibling.return=$.return,$=$.sibling;$.tag!==5&&$.tag!==6&&$.tag!==18;){if($.flags&2||$.child===null||$.tag===4)continue e;$.child.return=$,$=$.child}if(!($.flags&2))return $.stateNode}}function Wj($,j,it){var et=$.tag;if(et===5||et===6)$=$.stateNode,j?it.nodeType===8?it.parentNode.insertBefore($,j):it.insertBefore($,j):(it.nodeType===8?(j=it.parentNode,j.insertBefore($,it)):(j=it,j.appendChild($)),it=it._reactRootContainer,it!=null||j.onclick!==null||(j.onclick=Bf));else if(et!==4&&($=$.child,$!==null))for(Wj($,j,it),$=$.sibling;$!==null;)Wj($,j,it),$=$.sibling}function Xj($,j,it){var et=$.tag;if(et===5||et===6)$=$.stateNode,j?it.insertBefore($,j):it.appendChild($);else if(et!==4&&($=$.child,$!==null))for(Xj($,j,it),$=$.sibling;$!==null;)Xj($,j,it),$=$.sibling}var X=null,Yj=!1;function Zj($,j,it){for(it=it.child;it!==null;)ak($,j,it),it=it.sibling}function ak($,j,it){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,it)}catch{}switch(it.tag){case 5:U||Mj(it,j);case 6:var et=X,ut=Yj;X=null,Zj($,j,it),X=et,Yj=ut,X!==null&&(Yj?($=X,it=it.stateNode,$.nodeType===8?$.parentNode.removeChild(it):$.removeChild(it)):X.removeChild(it.stateNode));break;case 18:X!==null&&(Yj?($=X,it=it.stateNode,$.nodeType===8?Kf($.parentNode,it):$.nodeType===1&&Kf($,it),bd($)):Kf(X,it.stateNode));break;case 4:et=X,ut=Yj,X=it.stateNode.containerInfo,Yj=!0,Zj($,j,it),X=et,Yj=ut;break;case 0:case 11:case 14:case 15:if(!U&&(et=it.updateQueue,et!==null&&(et=et.lastEffect,et!==null))){ut=et=et.next;do{var dt=ut,mt=dt.destroy;dt=dt.tag,mt!==void 0&&(dt&2||dt&4)&&Nj(it,j,mt),ut=ut.next}while(ut!==et)}Zj($,j,it);break;case 1:if(!U&&(Mj(it,j),et=it.stateNode,typeof et.componentWillUnmount=="function"))try{et.props=it.memoizedProps,et.state=it.memoizedState,et.componentWillUnmount()}catch(yt){W(it,j,yt)}Zj($,j,it);break;case 21:Zj($,j,it);break;case 22:it.mode&1?(U=(et=U)||it.memoizedState!==null,Zj($,j,it),U=et):Zj($,j,it);break;default:Zj($,j,it)}}function bk($){var j=$.updateQueue;if(j!==null){$.updateQueue=null;var it=$.stateNode;it===null&&(it=$.stateNode=new Lj),j.forEach(function(et){var ut=ck.bind(null,$,et);it.has(et)||(it.add(et),et.then(ut,ut))})}}function dk($,j){var it=j.deletions;if(it!==null)for(var et=0;et<it.length;et++){var ut=it[et];try{var dt=$,mt=j,yt=mt;e:for(;yt!==null;){switch(yt.tag){case 5:X=yt.stateNode,Yj=!1;break e;case 3:X=yt.stateNode.containerInfo,Yj=!0;break e;case 4:X=yt.stateNode.containerInfo,Yj=!0;break e}yt=yt.return}if(X===null)throw Error(p$1(160));ak(dt,mt,ut),X=null,Yj=!1;var bt=ut.alternate;bt!==null&&(bt.return=null),ut.return=null}catch(Rt){W(ut,j,Rt)}}if(j.subtreeFlags&12854)for(j=j.child;j!==null;)ek(j,$),j=j.sibling}function ek($,j){var it=$.alternate,et=$.flags;switch($.tag){case 0:case 11:case 14:case 15:if(dk(j,$),fk($),et&4){try{Qj(3,$,$.return),Rj(3,$)}catch(Yt){W($,$.return,Yt)}try{Qj(5,$,$.return)}catch(Yt){W($,$.return,Yt)}}break;case 1:dk(j,$),fk($),et&512&&it!==null&&Mj(it,it.return);break;case 5:if(dk(j,$),fk($),et&512&&it!==null&&Mj(it,it.return),$.flags&32){var ut=$.stateNode;try{ob(ut,"")}catch(Yt){W($,$.return,Yt)}}if(et&4&&(ut=$.stateNode,ut!=null)){var dt=$.memoizedProps,mt=it!==null?it.memoizedProps:dt,yt=$.type,bt=$.updateQueue;if($.updateQueue=null,bt!==null)try{yt==="input"&&dt.type==="radio"&&dt.name!=null&&ab(ut,dt),vb(yt,mt);var Rt=vb(yt,dt);for(mt=0;mt<bt.length;mt+=2){var jt=bt[mt],Vt=bt[mt+1];jt==="style"?sb(ut,Vt):jt==="dangerouslySetInnerHTML"?nb(ut,Vt):jt==="children"?ob(ut,Vt):ta(ut,jt,Vt,Rt)}switch(yt){case"input":bb(ut,dt);break;case"textarea":ib(ut,dt);break;case"select":var zt=ut._wrapperState.wasMultiple;ut._wrapperState.wasMultiple=!!dt.multiple;var Jt=dt.value;Jt!=null?fb(ut,!!dt.multiple,Jt,!1):zt!==!!dt.multiple&&(dt.defaultValue!=null?fb(ut,!!dt.multiple,dt.defaultValue,!0):fb(ut,!!dt.multiple,dt.multiple?[]:"",!1))}ut[Pf]=dt}catch(Yt){W($,$.return,Yt)}}break;case 6:if(dk(j,$),fk($),et&4){if($.stateNode===null)throw Error(p$1(162));ut=$.stateNode,dt=$.memoizedProps;try{ut.nodeValue=dt}catch(Yt){W($,$.return,Yt)}}break;case 3:if(dk(j,$),fk($),et&4&&it!==null&&it.memoizedState.isDehydrated)try{bd(j.containerInfo)}catch(Yt){W($,$.return,Yt)}break;case 4:dk(j,$),fk($);break;case 13:dk(j,$),fk($),ut=$.child,ut.flags&8192&&(dt=ut.memoizedState!==null,ut.stateNode.isHidden=dt,!dt||ut.alternate!==null&&ut.alternate.memoizedState!==null||(gk=B$1())),et&4&&bk($);break;case 22:if(jt=it!==null&&it.memoizedState!==null,$.mode&1?(U=(Rt=U)||jt,dk(j,$),U=Rt):dk(j,$),fk($),et&8192){if(Rt=$.memoizedState!==null,($.stateNode.isHidden=Rt)&&!jt&&$.mode&1)for(V=$,jt=$.child;jt!==null;){for(Vt=V=jt;V!==null;){switch(zt=V,Jt=zt.child,zt.tag){case 0:case 11:case 14:case 15:Qj(4,zt,zt.return);break;case 1:Mj(zt,zt.return);var rr=zt.stateNode;if(typeof rr.componentWillUnmount=="function"){et=zt,it=zt.return;try{j=et,rr.props=j.memoizedProps,rr.state=j.memoizedState,rr.componentWillUnmount()}catch(Yt){W(et,it,Yt)}}break;case 5:Mj(zt,zt.return);break;case 22:if(zt.memoizedState!==null){hk(Vt);continue}}Jt!==null?(Jt.return=zt,V=Jt):hk(Vt)}jt=jt.sibling}e:for(jt=null,Vt=$;;){if(Vt.tag===5){if(jt===null){jt=Vt;try{ut=Vt.stateNode,Rt?(dt=ut.style,typeof dt.setProperty=="function"?dt.setProperty("display","none","important"):dt.display="none"):(yt=Vt.stateNode,bt=Vt.memoizedProps.style,mt=bt!=null&&bt.hasOwnProperty("display")?bt.display:null,yt.style.display=rb("display",mt))}catch(Yt){W($,$.return,Yt)}}}else if(Vt.tag===6){if(jt===null)try{Vt.stateNode.nodeValue=Rt?"":Vt.memoizedProps}catch(Yt){W($,$.return,Yt)}}else if((Vt.tag!==22&&Vt.tag!==23||Vt.memoizedState===null||Vt===$)&&Vt.child!==null){Vt.child.return=Vt,Vt=Vt.child;continue}if(Vt===$)break e;for(;Vt.sibling===null;){if(Vt.return===null||Vt.return===$)break e;jt===Vt&&(jt=null),Vt=Vt.return}jt===Vt&&(jt=null),Vt.sibling.return=Vt.return,Vt=Vt.sibling}}break;case 19:dk(j,$),fk($),et&4&&bk($);break;case 21:break;default:dk(j,$),fk($)}}function fk($){var j=$.flags;if(j&2){try{e:{for(var it=$.return;it!==null;){if(Uj(it)){var et=it;break e}it=it.return}throw Error(p$1(160))}switch(et.tag){case 5:var ut=et.stateNode;et.flags&32&&(ob(ut,""),et.flags&=-33);var dt=Vj($);Xj($,dt,ut);break;case 3:case 4:var mt=et.stateNode.containerInfo,yt=Vj($);Wj($,yt,mt);break;default:throw Error(p$1(161))}}catch(bt){W($,$.return,bt)}$.flags&=-3}j&4096&&($.flags&=-4097)}function ik($,j,it){V=$,jk($)}function jk($,j,it){for(var et=($.mode&1)!==0;V!==null;){var ut=V,dt=ut.child;if(ut.tag===22&&et){var mt=ut.memoizedState!==null||Kj;if(!mt){var yt=ut.alternate,bt=yt!==null&&yt.memoizedState!==null||U;yt=Kj;var Rt=U;if(Kj=mt,(U=bt)&&!Rt)for(V=ut;V!==null;)mt=V,bt=mt.child,mt.tag===22&&mt.memoizedState!==null?kk(ut):bt!==null?(bt.return=mt,V=bt):kk(ut);for(;dt!==null;)V=dt,jk(dt),dt=dt.sibling;V=ut,Kj=yt,U=Rt}lk($)}else ut.subtreeFlags&8772&&dt!==null?(dt.return=ut,V=dt):lk($)}}function lk($){for(;V!==null;){var j=V;if(j.flags&8772){var it=j.alternate;try{if(j.flags&8772)switch(j.tag){case 0:case 11:case 15:U||Rj(5,j);break;case 1:var et=j.stateNode;if(j.flags&4&&!U)if(it===null)et.componentDidMount();else{var ut=j.elementType===j.type?it.memoizedProps:Lg(j.type,it.memoizedProps);et.componentDidUpdate(ut,it.memoizedState,et.__reactInternalSnapshotBeforeUpdate)}var dt=j.updateQueue;dt!==null&&ih(j,dt,et);break;case 3:var mt=j.updateQueue;if(mt!==null){if(it=null,j.child!==null)switch(j.child.tag){case 5:it=j.child.stateNode;break;case 1:it=j.child.stateNode}ih(j,mt,it)}break;case 5:var yt=j.stateNode;if(it===null&&j.flags&4){it=yt;var bt=j.memoizedProps;switch(j.type){case"button":case"input":case"select":case"textarea":bt.autoFocus&&it.focus();break;case"img":bt.src&&(it.src=bt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(j.memoizedState===null){var Rt=j.alternate;if(Rt!==null){var jt=Rt.memoizedState;if(jt!==null){var Vt=jt.dehydrated;Vt!==null&&bd(Vt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$1(163))}U||j.flags&512&&Sj(j)}catch(zt){W(j,j.return,zt)}}if(j===$){V=null;break}if(it=j.sibling,it!==null){it.return=j.return,V=it;break}V=j.return}}function hk($){for(;V!==null;){var j=V;if(j===$){V=null;break}var it=j.sibling;if(it!==null){it.return=j.return,V=it;break}V=j.return}}function kk($){for(;V!==null;){var j=V;try{switch(j.tag){case 0:case 11:case 15:var it=j.return;try{Rj(4,j)}catch(bt){W(j,it,bt)}break;case 1:var et=j.stateNode;if(typeof et.componentDidMount=="function"){var ut=j.return;try{et.componentDidMount()}catch(bt){W(j,ut,bt)}}var dt=j.return;try{Sj(j)}catch(bt){W(j,dt,bt)}break;case 5:var mt=j.return;try{Sj(j)}catch(bt){W(j,mt,bt)}}}catch(bt){W(j,j.return,bt)}if(j===$){V=null;break}var yt=j.sibling;if(yt!==null){yt.return=j.return,V=yt;break}V=j.return}}var mk=Math.ceil,nk=ua.ReactCurrentDispatcher,ok=ua.ReactCurrentOwner,pk=ua.ReactCurrentBatchConfig,K=0,R=null,Y=null,Z=0,gj=0,fj=Uf(0),T=0,qk=null,hh=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi=!1,Qi=null,Si=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L(){return K&6?B$1():Bk!==-1?Bk:Bk=B$1()}function lh($){return $.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Ck===0&&(Ck=yc()),Ck):($=C$1,$!==0||($=window.event,$=$===void 0?16:jd($.type)),$):1}function mh($,j,it,et){if(50<zk)throw zk=0,Ak=null,Error(p$1(185));Ac($,it,et),(!(K&2)||$!==R)&&($===R&&(!(K&2)&&(rk|=it),T===4&&Dk($,Z)),Ek($,et),it===1&&K===0&&!(j.mode&1)&&(Hj=B$1()+500,fg&&jg()))}function Ek($,j){var it=$.callbackNode;wc($,j);var et=uc($,$===R?Z:0);if(et===0)it!==null&&bc(it),$.callbackNode=null,$.callbackPriority=0;else if(j=et&-et,$.callbackPriority!==j){if(it!=null&&bc(it),j===1)$.tag===0?ig(Fk.bind(null,$)):hg(Fk.bind(null,$)),Jf(function(){!(K&6)&&jg()}),it=null;else{switch(Dc(et)){case 1:it=fc;break;case 4:it=gc;break;case 16:it=hc;break;case 536870912:it=jc;break;default:it=hc}it=Gk(it,Hk.bind(null,$))}$.callbackPriority=j,$.callbackNode=it}}function Hk($,j){if(Bk=-1,Ck=0,K&6)throw Error(p$1(327));var it=$.callbackNode;if(Ik()&&$.callbackNode!==it)return null;var et=uc($,$===R?Z:0);if(et===0)return null;if(et&30||et&$.expiredLanes||j)j=Jk($,et);else{j=et;var ut=K;K|=2;var dt=Kk();(R!==$||Z!==j)&&(vk=null,Hj=B$1()+500,Lk($,j));do try{Mk();break}catch(yt){Nk($,yt)}while(1);Qg(),nk.current=dt,K=ut,Y!==null?j=0:(R=null,Z=0,j=T)}if(j!==0){if(j===2&&(ut=xc($),ut!==0&&(et=ut,j=Ok($,ut))),j===1)throw it=qk,Lk($,0),Dk($,et),Ek($,B$1()),it;if(j===6)Dk($,et);else{if(ut=$.current.alternate,!(et&30)&&!Pk(ut)&&(j=Jk($,et),j===2&&(dt=xc($),dt!==0&&(et=dt,j=Ok($,dt))),j===1))throw it=qk,Lk($,0),Dk($,et),Ek($,B$1()),it;switch($.finishedWork=ut,$.finishedLanes=et,j){case 0:case 1:throw Error(p$1(345));case 2:Qk($,uk,vk);break;case 3:if(Dk($,et),(et&130023424)===et&&(j=gk+500-B$1(),10<j)){if(uc($,0)!==0)break;if(ut=$.suspendedLanes,(ut&et)!==et){L(),$.pingedLanes|=$.suspendedLanes&ut;break}$.timeoutHandle=Ff(Qk.bind(null,$,uk,vk),j);break}Qk($,uk,vk);break;case 4:if(Dk($,et),(et&4194240)===et)break;for(j=$.eventTimes,ut=-1;0<et;){var mt=31-oc(et);dt=1<<mt,mt=j[mt],mt>ut&&(ut=mt),et&=~dt}if(et=ut,et=B$1()-et,et=(120>et?120:480>et?480:1080>et?1080:1920>et?1920:3e3>et?3e3:4320>et?4320:1960*mk(et/1960))-et,10<et){$.timeoutHandle=Ff(Qk.bind(null,$,uk,vk),et);break}Qk($,uk,vk);break;case 5:Qk($,uk,vk);break;default:throw Error(p$1(329))}}}return Ek($,B$1()),$.callbackNode===it?Hk.bind(null,$):null}function Ok($,j){var it=tk;return $.current.memoizedState.isDehydrated&&(Lk($,j).flags|=256),$=Jk($,j),$!==2&&(j=uk,uk=it,j!==null&&Gj(j)),$}function Gj($){uk===null?uk=$:uk.push.apply(uk,$)}function Pk($){for(var j=$;;){if(j.flags&16384){var it=j.updateQueue;if(it!==null&&(it=it.stores,it!==null))for(var et=0;et<it.length;et++){var ut=it[et],dt=ut.getSnapshot;ut=ut.value;try{if(!He(dt(),ut))return!1}catch{return!1}}}if(it=j.child,j.subtreeFlags&16384&&it!==null)it.return=j,j=it;else{if(j===$)break;for(;j.sibling===null;){if(j.return===null||j.return===$)return!0;j=j.return}j.sibling.return=j.return,j=j.sibling}}return!0}function Dk($,j){for(j&=~sk,j&=~rk,$.suspendedLanes|=j,$.pingedLanes&=~j,$=$.expirationTimes;0<j;){var it=31-oc(j),et=1<<it;$[it]=-1,j&=~et}}function Fk($){if(K&6)throw Error(p$1(327));Ik();var j=uc($,0);if(!(j&1))return Ek($,B$1()),null;var it=Jk($,j);if($.tag!==0&&it===2){var et=xc($);et!==0&&(j=et,it=Ok($,et))}if(it===1)throw it=qk,Lk($,0),Dk($,j),Ek($,B$1()),it;if(it===6)throw Error(p$1(345));return $.finishedWork=$.current.alternate,$.finishedLanes=j,Qk($,uk,vk),Ek($,B$1()),null}function Rk($,j){var it=K;K|=1;try{return $(j)}finally{K=it,K===0&&(Hj=B$1()+500,fg&&jg())}}function Sk($){xk!==null&&xk.tag===0&&!(K&6)&&Ik();var j=K;K|=1;var it=pk.transition,et=C$1;try{if(pk.transition=null,C$1=1,$)return $()}finally{C$1=et,pk.transition=it,K=j,!(K&6)&&jg()}}function Ij(){gj=fj.current,E$1(fj)}function Lk($,j){$.finishedWork=null,$.finishedLanes=0;var it=$.timeoutHandle;if(it!==-1&&($.timeoutHandle=-1,Gf(it)),Y!==null)for(it=Y.return;it!==null;){var et=it;switch(wg(et),et.tag){case 1:et=et.type.childContextTypes,et!=null&&$f();break;case 3:Jh(),E$1(Wf),E$1(H$1),Oh();break;case 5:Lh(et);break;case 4:Jh();break;case 13:E$1(M);break;case 19:E$1(M);break;case 10:Rg(et.type._context);break;case 22:case 23:Ij()}it=it.return}if(R=$,Y=$=wh($.current,null),Z=gj=j,T=0,qk=null,sk=rk=hh=0,uk=tk=null,Wg!==null){for(j=0;j<Wg.length;j++)if(it=Wg[j],et=it.interleaved,et!==null){it.interleaved=null;var ut=et.next,dt=it.pending;if(dt!==null){var mt=dt.next;dt.next=ut,et.next=mt}it.pending=et}Wg=null}return $}function Nk($,j){do{var it=Y;try{if(Qg(),Ph.current=ai,Sh){for(var et=N.memoizedState;et!==null;){var ut=et.queue;ut!==null&&(ut.pending=null),et=et.next}Sh=!1}if(Rh=0,P=O=N=null,Th=!1,Uh=0,ok.current=null,it===null||it.return===null){T=1,qk=j,Y=null;break}e:{var dt=$,mt=it.return,yt=it,bt=j;if(j=Z,yt.flags|=32768,bt!==null&&typeof bt=="object"&&typeof bt.then=="function"){var Rt=bt,jt=yt,Vt=jt.tag;if(!(jt.mode&1)&&(Vt===0||Vt===11||Vt===15)){var zt=jt.alternate;zt?(jt.updateQueue=zt.updateQueue,jt.memoizedState=zt.memoizedState,jt.lanes=zt.lanes):(jt.updateQueue=null,jt.memoizedState=null)}var Jt=Vi(mt);if(Jt!==null){Jt.flags&=-257,Wi(Jt,mt,yt,dt,j),Jt.mode&1&&Ti(dt,Rt,j),j=Jt,bt=Rt;var rr=j.updateQueue;if(rr===null){var Yt=new Set;Yt.add(bt),j.updateQueue=Yt}else rr.add(bt);break e}else{if(!(j&1)){Ti(dt,Rt,j),uj();break e}bt=Error(p$1(426))}}else if(I$1&&yt.mode&1){var dr=Vi(mt);if(dr!==null){!(dr.flags&65536)&&(dr.flags|=256),Wi(dr,mt,yt,dt,j),Jg(Ki(bt,yt));break e}}dt=bt=Ki(bt,yt),T!==4&&(T=2),tk===null?tk=[dt]:tk.push(dt),dt=mt;do{switch(dt.tag){case 3:dt.flags|=65536,j&=-j,dt.lanes|=j;var Ft=Oi(dt,bt,j);fh(dt,Ft);break e;case 1:yt=bt;var Ht=dt.type,er=dt.stateNode;if(!(dt.flags&128)&&(typeof Ht.getDerivedStateFromError=="function"||er!==null&&typeof er.componentDidCatch=="function"&&(Si===null||!Si.has(er)))){dt.flags|=65536,j&=-j,dt.lanes|=j;var pr=Ri(dt,yt,j);fh(dt,pr);break e}}dt=dt.return}while(dt!==null)}Tk(it)}catch(or){j=or,Y===it&&it!==null&&(Y=it=it.return);continue}break}while(1)}function Kk(){var $=nk.current;return nk.current=ai,$===null?ai:$}function uj(){(T===0||T===3||T===2)&&(T=4),R===null||!(hh&268435455)&&!(rk&268435455)||Dk(R,Z)}function Jk($,j){var it=K;K|=2;var et=Kk();(R!==$||Z!==j)&&(vk=null,Lk($,j));do try{Uk();break}catch(ut){Nk($,ut)}while(1);if(Qg(),K=it,nk.current=et,Y!==null)throw Error(p$1(261));return R=null,Z=0,T}function Uk(){for(;Y!==null;)Vk(Y)}function Mk(){for(;Y!==null&&!cc();)Vk(Y)}function Vk($){var j=Wk($.alternate,$,gj);$.memoizedProps=$.pendingProps,j===null?Tk($):Y=j,ok.current=null}function Tk($){var j=$;do{var it=j.alternate;if($=j.return,j.flags&32768){if(it=Jj(it,j),it!==null){it.flags&=32767,Y=it;return}if($!==null)$.flags|=32768,$.subtreeFlags=0,$.deletions=null;else{T=6,Y=null;return}}else if(it=Fj(it,j,gj),it!==null){Y=it;return}if(j=j.sibling,j!==null){Y=j;return}Y=j=$}while(j!==null);T===0&&(T=5)}function Qk($,j,it){var et=C$1,ut=pk.transition;try{pk.transition=null,C$1=1,Xk($,j,it,et)}finally{pk.transition=ut,C$1=et}return null}function Xk($,j,it,et){do Ik();while(xk!==null);if(K&6)throw Error(p$1(327));it=$.finishedWork;var ut=$.finishedLanes;if(it===null)return null;if($.finishedWork=null,$.finishedLanes=0,it===$.current)throw Error(p$1(177));$.callbackNode=null,$.callbackPriority=0;var dt=it.lanes|it.childLanes;if(Bc($,dt),$===R&&(Y=R=null,Z=0),!(it.subtreeFlags&2064)&&!(it.flags&2064)||wk||(wk=!0,Gk(hc,function(){return Ik(),null})),dt=(it.flags&15990)!==0,it.subtreeFlags&15990||dt){dt=pk.transition,pk.transition=null;var mt=C$1;C$1=1;var yt=K;K|=4,ok.current=null,Pj($,it),ek(it,$),Oe(Df),dd=!!Cf,Df=Cf=null,$.current=it,ik(it),dc(),K=yt,C$1=mt,pk.transition=dt}else $.current=it;if(wk&&(wk=!1,xk=$,yk=ut),dt=$.pendingLanes,dt===0&&(Si=null),mc(it.stateNode),Ek($,B$1()),j!==null)for(et=$.onRecoverableError,it=0;it<j.length;it++)ut=j[it],et(ut.value,{componentStack:ut.stack,digest:ut.digest});if(Pi)throw Pi=!1,$=Qi,Qi=null,$;return yk&1&&$.tag!==0&&Ik(),dt=$.pendingLanes,dt&1?$===Ak?zk++:(zk=0,Ak=$):zk=0,jg(),null}function Ik(){if(xk!==null){var $=Dc(yk),j=pk.transition,it=C$1;try{if(pk.transition=null,C$1=16>$?16:$,xk===null)var et=!1;else{if($=xk,xk=null,yk=0,K&6)throw Error(p$1(331));var ut=K;for(K|=4,V=$.current;V!==null;){var dt=V,mt=dt.child;if(V.flags&16){var yt=dt.deletions;if(yt!==null){for(var bt=0;bt<yt.length;bt++){var Rt=yt[bt];for(V=Rt;V!==null;){var jt=V;switch(jt.tag){case 0:case 11:case 15:Qj(8,jt,dt)}var Vt=jt.child;if(Vt!==null)Vt.return=jt,V=Vt;else for(;V!==null;){jt=V;var zt=jt.sibling,Jt=jt.return;if(Tj(jt),jt===Rt){V=null;break}if(zt!==null){zt.return=Jt,V=zt;break}V=Jt}}}var rr=dt.alternate;if(rr!==null){var Yt=rr.child;if(Yt!==null){rr.child=null;do{var dr=Yt.sibling;Yt.sibling=null,Yt=dr}while(Yt!==null)}}V=dt}}if(dt.subtreeFlags&2064&&mt!==null)mt.return=dt,V=mt;else e:for(;V!==null;){if(dt=V,dt.flags&2048)switch(dt.tag){case 0:case 11:case 15:Qj(9,dt,dt.return)}var Ft=dt.sibling;if(Ft!==null){Ft.return=dt.return,V=Ft;break e}V=dt.return}}var Ht=$.current;for(V=Ht;V!==null;){mt=V;var er=mt.child;if(mt.subtreeFlags&2064&&er!==null)er.return=mt,V=er;else e:for(mt=Ht;V!==null;){if(yt=V,yt.flags&2048)try{switch(yt.tag){case 0:case 11:case 15:Rj(9,yt)}}catch(or){W(yt,yt.return,or)}if(yt===mt){V=null;break e}var pr=yt.sibling;if(pr!==null){pr.return=yt.return,V=pr;break e}V=yt.return}}if(K=ut,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,$)}catch{}et=!0}return et}finally{C$1=it,pk.transition=j}}return!1}function Yk($,j,it){j=Ki(it,j),j=Oi($,j,1),$=dh($,j,1),j=L(),$!==null&&(Ac($,1,j),Ek($,j))}function W($,j,it){if($.tag===3)Yk($,$,it);else for(;j!==null;){if(j.tag===3){Yk(j,$,it);break}else if(j.tag===1){var et=j.stateNode;if(typeof j.type.getDerivedStateFromError=="function"||typeof et.componentDidCatch=="function"&&(Si===null||!Si.has(et))){$=Ki(it,$),$=Ri(j,$,1),j=dh(j,$,1),$=L(),j!==null&&(Ac(j,1,$),Ek(j,$));break}}j=j.return}}function Ui($,j,it){var et=$.pingCache;et!==null&&et.delete(j),j=L(),$.pingedLanes|=$.suspendedLanes&it,R===$&&(Z&it)===it&&(T===4||T===3&&(Z&130023424)===Z&&500>B$1()-gk?Lk($,0):sk|=it),Ek($,j)}function Zk($,j){j===0&&($.mode&1?(j=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):j=1);var it=L();$=Zg($,j),$!==null&&(Ac($,j,it),Ek($,it))}function vj($){var j=$.memoizedState,it=0;j!==null&&(it=j.retryLane),Zk($,it)}function ck($,j){var it=0;switch($.tag){case 13:var et=$.stateNode,ut=$.memoizedState;ut!==null&&(it=ut.retryLane);break;case 19:et=$.stateNode;break;default:throw Error(p$1(314))}et!==null&&et.delete(j),Zk($,it)}var Wk;Wk=function($,j,it){if($!==null)if($.memoizedProps!==j.pendingProps||Wf.current)Ug=!0;else{if(!($.lanes&it)&&!(j.flags&128))return Ug=!1,zj($,j,it);Ug=!!($.flags&131072)}else Ug=!1,I$1&&j.flags&1048576&&ug(j,ng,j.index);switch(j.lanes=0,j.tag){case 2:var et=j.type;jj($,j),$=j.pendingProps;var ut=Yf(j,H$1.current);Tg(j,it),ut=Xh(null,j,et,$,ut,it);var dt=bi();return j.flags|=1,typeof ut=="object"&&ut!==null&&typeof ut.render=="function"&&ut.$$typeof===void 0?(j.tag=1,j.memoizedState=null,j.updateQueue=null,Zf(et)?(dt=!0,cg(j)):dt=!1,j.memoizedState=ut.state!==null&&ut.state!==void 0?ut.state:null,ah(j),ut.updater=nh,j.stateNode=ut,ut._reactInternals=j,rh(j,et,$,it),j=kj(null,j,et,!0,dt,it)):(j.tag=0,I$1&&dt&&vg(j),Yi(null,j,ut,it),j=j.child),j;case 16:et=j.elementType;e:{switch(jj($,j),$=j.pendingProps,ut=et._init,et=ut(et._payload),j.type=et,ut=j.tag=$k(et),$=Lg(et,$),ut){case 0:j=dj(null,j,et,$,it);break e;case 1:j=ij(null,j,et,$,it);break e;case 11:j=Zi(null,j,et,$,it);break e;case 14:j=aj(null,j,et,Lg(et.type,$),it);break e}throw Error(p$1(306,et,""))}return j;case 0:return et=j.type,ut=j.pendingProps,ut=j.elementType===et?ut:Lg(et,ut),dj($,j,et,ut,it);case 1:return et=j.type,ut=j.pendingProps,ut=j.elementType===et?ut:Lg(et,ut),ij($,j,et,ut,it);case 3:e:{if(lj(j),$===null)throw Error(p$1(387));et=j.pendingProps,dt=j.memoizedState,ut=dt.element,bh($,j),gh(j,et,null,it);var mt=j.memoizedState;if(et=mt.element,dt.isDehydrated)if(dt={element:et,isDehydrated:!1,cache:mt.cache,pendingSuspenseBoundaries:mt.pendingSuspenseBoundaries,transitions:mt.transitions},j.updateQueue.baseState=dt,j.memoizedState=dt,j.flags&256){ut=Ki(Error(p$1(423)),j),j=mj($,j,et,it,ut);break e}else if(et!==ut){ut=Ki(Error(p$1(424)),j),j=mj($,j,et,it,ut);break e}else for(yg=Lf(j.stateNode.containerInfo.firstChild),xg=j,I$1=!0,zg=null,it=Ch(j,null,et,it),j.child=it;it;)it.flags=it.flags&-3|4096,it=it.sibling;else{if(Ig(),et===ut){j=$i($,j,it);break e}Yi($,j,et,it)}j=j.child}return j;case 5:return Kh(j),$===null&&Eg(j),et=j.type,ut=j.pendingProps,dt=$!==null?$.memoizedProps:null,mt=ut.children,Ef(et,ut)?mt=null:dt!==null&&Ef(et,dt)&&(j.flags|=32),hj($,j),Yi($,j,mt,it),j.child;case 6:return $===null&&Eg(j),null;case 13:return pj($,j,it);case 4:return Ih(j,j.stateNode.containerInfo),et=j.pendingProps,$===null?j.child=Bh(j,null,et,it):Yi($,j,et,it),j.child;case 11:return et=j.type,ut=j.pendingProps,ut=j.elementType===et?ut:Lg(et,ut),Zi($,j,et,ut,it);case 7:return Yi($,j,j.pendingProps,it),j.child;case 8:return Yi($,j,j.pendingProps.children,it),j.child;case 12:return Yi($,j,j.pendingProps.children,it),j.child;case 10:e:{if(et=j.type._context,ut=j.pendingProps,dt=j.memoizedProps,mt=ut.value,G$1(Mg,et._currentValue),et._currentValue=mt,dt!==null)if(He(dt.value,mt)){if(dt.children===ut.children&&!Wf.current){j=$i($,j,it);break e}}else for(dt=j.child,dt!==null&&(dt.return=j);dt!==null;){var yt=dt.dependencies;if(yt!==null){mt=dt.child;for(var bt=yt.firstContext;bt!==null;){if(bt.context===et){if(dt.tag===1){bt=ch(-1,it&-it),bt.tag=2;var Rt=dt.updateQueue;if(Rt!==null){Rt=Rt.shared;var jt=Rt.pending;jt===null?bt.next=bt:(bt.next=jt.next,jt.next=bt),Rt.pending=bt}}dt.lanes|=it,bt=dt.alternate,bt!==null&&(bt.lanes|=it),Sg(dt.return,it,j),yt.lanes|=it;break}bt=bt.next}}else if(dt.tag===10)mt=dt.type===j.type?null:dt.child;else if(dt.tag===18){if(mt=dt.return,mt===null)throw Error(p$1(341));mt.lanes|=it,yt=mt.alternate,yt!==null&&(yt.lanes|=it),Sg(mt,it,j),mt=dt.sibling}else mt=dt.child;if(mt!==null)mt.return=dt;else for(mt=dt;mt!==null;){if(mt===j){mt=null;break}if(dt=mt.sibling,dt!==null){dt.return=mt.return,mt=dt;break}mt=mt.return}dt=mt}Yi($,j,ut.children,it),j=j.child}return j;case 9:return ut=j.type,et=j.pendingProps.children,Tg(j,it),ut=Vg(ut),et=et(ut),j.flags|=1,Yi($,j,et,it),j.child;case 14:return et=j.type,ut=Lg(et,j.pendingProps),ut=Lg(et.type,ut),aj($,j,et,ut,it);case 15:return cj($,j,j.type,j.pendingProps,it);case 17:return et=j.type,ut=j.pendingProps,ut=j.elementType===et?ut:Lg(et,ut),jj($,j),j.tag=1,Zf(et)?($=!0,cg(j)):$=!1,Tg(j,it),ph(j,et,ut),rh(j,et,ut,it),kj(null,j,et,!0,$,it);case 19:return yj($,j,it);case 22:return ej($,j,it)}throw Error(p$1(156,j.tag))};function Gk($,j){return ac($,j)}function al($,j,it,et){this.tag=$,this.key=it,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=j,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=et,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg($,j,it,et){return new al($,j,it,et)}function bj($){return $=$.prototype,!(!$||!$.isReactComponent)}function $k($){if(typeof $=="function")return bj($)?1:0;if($!=null){if($=$.$$typeof,$===Da)return 11;if($===Ga)return 14}return 2}function wh($,j){var it=$.alternate;return it===null?(it=Bg($.tag,j,$.key,$.mode),it.elementType=$.elementType,it.type=$.type,it.stateNode=$.stateNode,it.alternate=$,$.alternate=it):(it.pendingProps=j,it.type=$.type,it.flags=0,it.subtreeFlags=0,it.deletions=null),it.flags=$.flags&14680064,it.childLanes=$.childLanes,it.lanes=$.lanes,it.child=$.child,it.memoizedProps=$.memoizedProps,it.memoizedState=$.memoizedState,it.updateQueue=$.updateQueue,j=$.dependencies,it.dependencies=j===null?null:{lanes:j.lanes,firstContext:j.firstContext},it.sibling=$.sibling,it.index=$.index,it.ref=$.ref,it}function yh($,j,it,et,ut,dt){var mt=2;if(et=$,typeof $=="function")bj($)&&(mt=1);else if(typeof $=="string")mt=5;else e:switch($){case ya:return Ah(it.children,ut,dt,j);case za:mt=8,ut|=8;break;case Aa:return $=Bg(12,it,j,ut|2),$.elementType=Aa,$.lanes=dt,$;case Ea:return $=Bg(13,it,j,ut),$.elementType=Ea,$.lanes=dt,$;case Fa:return $=Bg(19,it,j,ut),$.elementType=Fa,$.lanes=dt,$;case Ia:return qj(it,ut,dt,j);default:if(typeof $=="object"&&$!==null)switch($.$$typeof){case Ba:mt=10;break e;case Ca:mt=9;break e;case Da:mt=11;break e;case Ga:mt=14;break e;case Ha:mt=16,et=null;break e}throw Error(p$1(130,$==null?$:typeof $,""))}return j=Bg(mt,it,j,ut),j.elementType=$,j.type=et,j.lanes=dt,j}function Ah($,j,it,et){return $=Bg(7,$,et,j),$.lanes=it,$}function qj($,j,it,et){return $=Bg(22,$,et,j),$.elementType=Ia,$.lanes=it,$.stateNode={isHidden:!1},$}function xh($,j,it){return $=Bg(6,$,null,j),$.lanes=it,$}function zh($,j,it){return j=Bg(4,$.children!==null?$.children:[],$.key,j),j.lanes=it,j.stateNode={containerInfo:$.containerInfo,pendingChildren:null,implementation:$.implementation},j}function bl($,j,it,et,ut){this.tag=j,this.containerInfo=$,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=et,this.onRecoverableError=ut,this.mutableSourceEagerHydrationData=null}function cl($,j,it,et,ut,dt,mt,yt,bt){return $=new bl($,j,it,yt,bt),j===1?(j=1,dt===!0&&(j|=8)):j=0,dt=Bg(3,null,null,j),$.current=dt,dt.stateNode=$,dt.memoizedState={element:et,isDehydrated:it,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah(dt),$}function dl($,j,it){var et=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:et==null?null:""+et,children:$,containerInfo:j,implementation:it}}function el($){if(!$)return Vf;$=$._reactInternals;e:{if(Vb($)!==$||$.tag!==1)throw Error(p$1(170));var j=$;do{switch(j.tag){case 3:j=j.stateNode.context;break e;case 1:if(Zf(j.type)){j=j.stateNode.__reactInternalMemoizedMergedChildContext;break e}}j=j.return}while(j!==null);throw Error(p$1(171))}if($.tag===1){var it=$.type;if(Zf(it))return bg($,it,j)}return j}function fl($,j,it,et,ut,dt,mt,yt,bt){return $=cl(it,et,!0,$,ut,dt,mt,yt,bt),$.context=el(null),it=$.current,et=L(),ut=lh(it),dt=ch(et,ut),dt.callback=j??null,dh(it,dt,ut),$.current.lanes=ut,Ac($,ut,et),Ek($,et),$}function gl($,j,it,et){var ut=j.current,dt=L(),mt=lh(ut);return it=el(it),j.context===null?j.context=it:j.pendingContext=it,j=ch(dt,mt),j.payload={element:$},et=et===void 0?null:et,et!==null&&(j.callback=et),$=dh(ut,j,mt),$!==null&&(mh($,ut,mt,dt),eh($,ut,mt)),mt}function hl($){if($=$.current,!$.child)return null;switch($.child.tag){case 5:return $.child.stateNode;default:return $.child.stateNode}}function il($,j){if($=$.memoizedState,$!==null&&$.dehydrated!==null){var it=$.retryLane;$.retryLane=it!==0&&it<j?it:j}}function jl($,j){il($,j),($=$.alternate)&&il($,j)}function kl(){return null}var ll=typeof reportError=="function"?reportError:function($){console.error($)};function ml($){this._internalRoot=$}nl.prototype.render=ml.prototype.render=function($){var j=this._internalRoot;if(j===null)throw Error(p$1(409));gl($,j,null,null)};nl.prototype.unmount=ml.prototype.unmount=function(){var $=this._internalRoot;if($!==null){this._internalRoot=null;var j=$.containerInfo;Sk(function(){gl(null,$,null,null)}),j[uf]=null}};function nl($){this._internalRoot=$}nl.prototype.unstable_scheduleHydration=function($){if($){var j=Hc();$={blockedOn:null,target:$,priority:j};for(var it=0;it<Qc.length&&j!==0&&j<Qc[it].priority;it++);Qc.splice(it,0,$),it===0&&Vc($)}};function ol($){return!(!$||$.nodeType!==1&&$.nodeType!==9&&$.nodeType!==11)}function pl($){return!(!$||$.nodeType!==1&&$.nodeType!==9&&$.nodeType!==11&&($.nodeType!==8||$.nodeValue!==" react-mount-point-unstable "))}function ql(){}function rl($,j,it,et,ut){if(ut){if(typeof et=="function"){var dt=et;et=function(){var Rt=hl(mt);dt.call(Rt)}}var mt=fl(j,et,$,0,null,!1,!1,"",ql);return $._reactRootContainer=mt,$[uf]=mt.current,sf($.nodeType===8?$.parentNode:$),Sk(),mt}for(;ut=$.lastChild;)$.removeChild(ut);if(typeof et=="function"){var yt=et;et=function(){var Rt=hl(bt);yt.call(Rt)}}var bt=cl($,0,!1,null,null,!1,!1,"",ql);return $._reactRootContainer=bt,$[uf]=bt.current,sf($.nodeType===8?$.parentNode:$),Sk(function(){gl(j,bt,it,et)}),bt}function sl($,j,it,et,ut){var dt=it._reactRootContainer;if(dt){var mt=dt;if(typeof ut=="function"){var yt=ut;ut=function(){var bt=hl(mt);yt.call(bt)}}gl(j,mt,$,ut)}else mt=rl(it,j,$,ut,et);return hl(mt)}Ec=function($){switch($.tag){case 3:var j=$.stateNode;if(j.current.memoizedState.isDehydrated){var it=tc(j.pendingLanes);it!==0&&(Cc(j,it|1),Ek(j,B$1()),!(K&6)&&(Hj=B$1()+500,jg()))}break;case 13:Sk(function(){var et=Zg($,1);if(et!==null){var ut=L();mh(et,$,1,ut)}}),jl($,1)}};Fc=function($){if($.tag===13){var j=Zg($,134217728);if(j!==null){var it=L();mh(j,$,134217728,it)}jl($,134217728)}};Gc=function($){if($.tag===13){var j=lh($),it=Zg($,j);if(it!==null){var et=L();mh(it,$,j,et)}jl($,j)}};Hc=function(){return C$1};Ic=function($,j){var it=C$1;try{return C$1=$,j()}finally{C$1=it}};yb=function($,j,it){switch(j){case"input":if(bb($,it),j=it.name,it.type==="radio"&&j!=null){for(it=$;it.parentNode;)it=it.parentNode;for(it=it.querySelectorAll("input[name="+JSON.stringify(""+j)+'][type="radio"]'),j=0;j<it.length;j++){var et=it[j];if(et!==$&&et.form===$.form){var ut=Db(et);if(!ut)throw Error(p$1(90));Wa(et),bb(et,ut)}}}break;case"textarea":ib($,it);break;case"select":j=it.value,j!=null&&fb($,!!it.multiple,j,!1)}};Gb=Rk;Hb=Sk;var tl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Rk]},ul={findFiberByHostInstance:Wc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function($){return $=Zb($),$===null?null:$.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||kl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{kc=wl.inject(vl),lc=wl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl;reactDom_production_min.createPortal=function($,j){var it=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(j))throw Error(p$1(200));return dl($,j,null,it)};reactDom_production_min.createRoot=function($,j){if(!ol($))throw Error(p$1(299));var it=!1,et="",ut=ll;return j!=null&&(j.unstable_strictMode===!0&&(it=!0),j.identifierPrefix!==void 0&&(et=j.identifierPrefix),j.onRecoverableError!==void 0&&(ut=j.onRecoverableError)),j=cl($,1,!1,null,null,it,!1,et,ut),$[uf]=j.current,sf($.nodeType===8?$.parentNode:$),new ml(j)};reactDom_production_min.findDOMNode=function($){if($==null)return null;if($.nodeType===1)return $;var j=$._reactInternals;if(j===void 0)throw typeof $.render=="function"?Error(p$1(188)):($=Object.keys($).join(","),Error(p$1(268,$)));return $=Zb(j),$=$===null?null:$.stateNode,$};reactDom_production_min.flushSync=function($){return Sk($)};reactDom_production_min.hydrate=function($,j,it){if(!pl(j))throw Error(p$1(200));return sl(null,$,j,!0,it)};reactDom_production_min.hydrateRoot=function($,j,it){if(!ol($))throw Error(p$1(405));var et=it!=null&&it.hydratedSources||null,ut=!1,dt="",mt=ll;if(it!=null&&(it.unstable_strictMode===!0&&(ut=!0),it.identifierPrefix!==void 0&&(dt=it.identifierPrefix),it.onRecoverableError!==void 0&&(mt=it.onRecoverableError)),j=fl(j,null,$,1,it??null,ut,!1,dt,mt),$[uf]=j.current,sf($),et)for($=0;$<et.length;$++)it=et[$],ut=it._getVersion,ut=ut(it._source),j.mutableSourceEagerHydrationData==null?j.mutableSourceEagerHydrationData=[it,ut]:j.mutableSourceEagerHydrationData.push(it,ut);return new nl(j)};reactDom_production_min.render=function($,j,it){if(!pl(j))throw Error(p$1(200));return sl(null,$,j,!1,it)};reactDom_production_min.unmountComponentAtNode=function($){if(!pl($))throw Error(p$1(40));return $._reactRootContainer?(Sk(function(){sl(null,null,$,!1,function(){$._reactRootContainer=null,$[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function($,j,it,et){if(!pl(it))throw Error(p$1(200));if($==null||$._reactInternals===void 0)throw Error(p$1(38));return sl($,j,it,!1,et)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch($){console.error($)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m$1=reactDomExports;client.createRoot=m$1.createRoot,client.hydrateRoot=m$1.hydrateRoot;const Logo="/assets/logo-4c5a80d0.svg";function NavigationBar(){return jsx("nav",{className:"nav-wrapper",children:jsx("div",{className:"nav-content",children:jsx("ul",{className:"list-styled",children:jsx("li",{children:jsx("img",{src:Logo,alt:"Apple",style:{textAlign:"center"}})})})})})}function DisplaySection({triggerPreview:$}){return jsxs("div",{className:"display-section wrapper",children:[jsx("h2",{className:"title",children:" New "}),jsx("p",{className:"text",children:"Brillient"}),jsx("span",{className:"deccription",children:"A display that's up to 2x brighter in the sun"}),jsx("button",{className:"button",onClick:$,children:"Try me!"})]})}/*! For license information please see bundle.m.js.LICENSE.txt */var __webpackgi_modules__={798:function($,j,it){var et=it(352),ut=it.n(et)()(function(dt){return dt[1]});ut.push([$.id,"#assetManagerPopup{z-index:300;position:absolute;bottom:2rem;right:2rem;-webkit-backdrop-filter:blur(16px);backdrop-filter:blur(16px);color:#fff;background-blend-mode:luminosity;background-color:#28223CAA;padding:1.5rem;font-size:1rem;width:-webkit-max-content;width:-moz-max-content;width:max-content;max-width:80vw;max-height:80vh;overflow-y:scroll;border-radius:.5rem;height:-webkit-max-content;height:-moz-max-content;height:max-content}#assetManagerPopupClose{position:absolute;top:0;right:0;padding:.5rem;cursor:pointer}#assetManagerPopupContent{padding-top:.5rem}.processState{font-weight:bold}",""]),j.Z=ut},898:function($,j,it){var et=it(352),ut=it.n(et)()(function(dt){return dt[1]});ut.push([$.id,':root{--tp-blade-unit-size: 24px;--tp-element-border-radius: 0.25rem;--tp-base-background-color: #28223C;--tp-base-shadow-color: hsla(0, 0%, 0%, 0.2);--tp-button-background-color: hsla(230, 10%, 80%, 1.00);--tp-button-background-color-active: hsla(230, 10%, 95%, 1.00);--tp-button-background-color-focus: hsla(230, 10%, 90%, 1.00);--tp-button-background-color-hover: hsla(230, 10%, 85%, 1.00);--tp-button-foreground-color: hsla(230, 20%, 11%, 1.00);--tp-container-background-color: hsla(230, 25%, 16%, 0.65);--tp-container-background-color-active: hsla(230, 25%, 31%, 0.65);--tp-container-background-color-focus: hsla(230, 25%, 26%, 0.65);--tp-container-background-color-hover: hsla(230, 25%, 21%, 0.65);--tp-container-foreground-color: hsl(240, 10%, 92%);--tp-groove-foreground-color: hsla(230, 20%, 8%, 1.00);--tp-input-background-color: hsla(230, 20%, 8%, 1.00);--tp-input-background-color-active: hsla(230, 28%, 23%, 1.00);--tp-input-background-color-focus: hsla(230, 28%, 18%, 1.00);--tp-input-background-color-hover: hsla(230, 20%, 13%, 1.00);--tp-input-foreground-color: hsla(230, 10%, 80%, 1.00);--tp-monitor-background-color: hsla(230, 20%, 8%, 1.00);--tp-monitor-foreground-color: hsla(230, 12%, 48%, 1.00);--tp-label-foreground-color: #E4E2ED;--tp-font-family: "Inter"}.tp-fldv{margin-top:.25rem;margin-bottom:.25rem;background-blend-mode:luminosity;position:relative}.tp-fldv .tp-fldv{margin-top:.5rem;margin-bottom:.5rem}.tp-fldv .tp-brkv{background-color:rgba(32,32,50,.85)}.tp-fldv .tp-fldv .tp-brkv{background-color:rgba(32,32,50,.25) !important}.tp-fldv-expanded>.tp-fldv_b{background-color:rgba(32,32,50,.8) !important}.tp-fldv_b{height:calc(var(--bld-us)*1.5 + 4px) !important;font-size:.85rem !important}.tp-fldv_b+.tp-brkv .tp-fldv_b{height:calc(var(--bld-us)*1.1 + 4px) !important;font-size:.65rem !important}.tp-lblv_l{font-size:.7rem !important;font-weight:400 !important;flex-grow:1 !important;flex-basis:20% !important}.tp-lblv_v{flex-grow:1 !important;flex-basis:50% !important}.tp-txtv_i{font-size:.7rem !important;font-weight:400 !important}.tp-fldv_t{font-weight:400 !important;padding-left:1.5rem !important}.tp-fldv_m{right:auto !important;left:.75rem;opacity:1 !important}.pluginOptionsButton{position:absolute;right:0;top:.75rem;padding-left:.5rem;padding-right:.5rem;height:-webkit-min-content;height:-moz-min-content;height:min-content;background:transparent;color:#eee;border:none}',""]),j.Z=ut},513:function($,j,it){var et=it(352),ut=it.n(et)()(function(dt){return dt[1]});ut.push([$.id,".wwise-perspective{perspective:1000px;position:fixed;left:0;top:0;width:100vw;height:100vh}.wwise-wrapper{position:fixed;width:0;height:0;font-weight:400}.wwise-wrapper.v-center{top:50%}.wwise-wrapper.h-center{left:50%}.wwise-wrapper.left{left:0}.wwise-wrapper.right{right:0}.wwise-wrapper.top{top:0}.wwise-wrapper.bottom{bottom:0}.wwise *.preset{color:#fafafa}.wwise *.preset.ok{background:rgba(45,193,80,.95)}.wwise *.preset.error{background:rgba(190,17,51,.95)}.wwise *.preset.info{background:rgba(40,34,60,.95)}.wwise *.preset.caution{background:rgba(239,128,0,.95)}.wwise-no-scroll{position:relative;overflow:hidden}.wwise-overlay{position:fixed;left:0;top:0;width:100vw;height:100vh;background:rgba(50,50,50,.5)}.wwise{position:absolute;left:0;top:0;display:flex;flex-direction:column;border-radius:5px;box-shadow:1px 1px 10px rgba(150,150,150,.5);box-sizing:border-box}.wwise.no-radius{border-radius:0}.wwise *{box-sizing:border-box}.wwise .clear{clear:both}.wwise>.content{padding:0;margin:0;flex-grow:1;border-radius:0 0 4px 4px;background:#fff;color:#333;box-shadow:0 1px 3px rgba(200,200,200,.5) inset}.wwise>.content.no-topbar{border-radius:4px;box-shadow:none}.wwise.no-radius>.content,.wwise.no-radius>.content.no-topbar{border-radius:0}.wwise .modal>.main{width:90vw;max-width:400px;border-radius:4px 4px 0 0;text-align:center;padding-bottom:10px;color:#fff}.wwise .modal>.main .icon{display:block;margin:0 auto;fill:#fff;width:100px}.wwise .modal>.main .title{font-size:30px}.wwise .modal>.main .text{margin:10px 0;font-weight:300;font-size:16px}.wwise .modal>.main.no-op{border-radius:4px}.wwise .modal>.main.ok{background:#2dc150}.wwise .modal>.main.error{background:#be1133}.wwise .modal>.main.info{background:#28223c}.wwise .modal>.main.caution{background:#ef8000}.wwise .modal>.operation .button-wrapper{text-align:center;margin:30px 0 20px 0}.wwise .modal>.operation .button{display:inline-block;line-height:18px;padding:8px 10px;margin:0 15px;line-height:18px;width:100px;border-radius:4px;border:1px solid #eee;box-shadow:1px 1px 3px rgba(220,220,220,.8);color:#555;transition:all ease .2s}.wwise .modal>.operation .button:hover{background:#f5f5f5;cursor:pointer}.wwise .modal>.operation .button.main{color:#fff}.wwise .modal>.operation.ok .main{background:#2dc150}.wwise .modal>.operation.ok .main:hover{background:#23983f}.wwise .modal>.operation.error .main{background:#be1133}.wwise .modal>.operation.error .main:hover{background:#8f0d26}.wwise .modal>.operation.info .main{background:#28223c}.wwise .modal>.operation.info .main:hover{background:#12101b}.wwise .modal>.operation.caution .main{background:#ef8000}.wwise .modal>.operation.caution .main:hover{background:#bc6500}.wwise .input-wrapper{margin:15px auto -15px auto}.wwise .input-wrapper .input{display:block;margin:0 auto;width:95%;max-width:300px;outline:none;border:none;background:#f3f3f3;padding:15px;font-size:16px;border-radius:5px}.wwise .input-wrapper .error{width:95%;text-align:center;margin-top:10px;color:red}div:has(>.wwise-wrapper){position:absolute !important}.wwise-wrapper{position:absolute !important}.wwise .modal>.main{padding-top:10px}",""]),j.Z=ut},476:function($){var j;j=function(){return function(it){var et={};function ut(dt){if(et[dt])return et[dt].exports;var mt=et[dt]={i:dt,l:!1,exports:{}};return it[dt].call(mt.exports,mt,mt.exports,ut),mt.l=!0,mt.exports}return ut.m=it,ut.c=et,ut.i=function(dt){return dt},ut.d=function(dt,mt,yt){ut.o(dt,mt)||Object.defineProperty(dt,mt,{configurable:!1,enumerable:!0,get:yt})},ut.n=function(dt){var mt=dt&&dt.__esModule?function(){return dt.default}:function(){return dt};return ut.d(mt,"a",mt),mt},ut.o=function(dt,mt){return Object.prototype.hasOwnProperty.call(dt,mt)},ut.p="",ut(ut.s=5)}([function(it,et,ut){Object.defineProperty(et,"__esModule",{value:!0});var dt={convertToObject:function(mt){var yt=mt.substring(mt.indexOf("{")+1).trim().slice(0,-1),bt={};return yt.split(";").map(function(Rt){if(Rt=Rt.trim()){var jt=Rt.split(":");bt[jt[0].trim()]=jt[1].trim()}}),bt},getFromSheets:function(mt){var yt=document.styleSheets;for(var bt in yt){var Rt=null;try{Rt=yt[bt].rules||yt[bt].cssRules}catch{}if(Rt){for(var jt in Rt)if(Rt[jt].selectorText&&Rt[jt].selectorText.split(",").indexOf(mt)!=-1)return Rt[jt].cssText?dt.convertToObject(Rt[jt].cssText):dt.convertToObject(Rt[jt].style.cssText)}}return{}},getPropertyDefault:function(mt){return mt=="timing-function"?"ease":mt=="iteration-count"?1:mt=="direction"?"normal":mt=="fill-mode"?"none":null}};et.default=dt},function(it,et,ut){Object.defineProperty(et,"__esModule",{value:!0});var dt={generateId:function(){for(var mt="",yt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",bt=0;bt<8;++bt)mt+=yt.charAt(Math.floor(Math.random()*yt.length));return mt},frameToString:function(mt){var yt="";for(var bt in mt)yt+=bt+":"+mt[bt]+";";return yt},convertTimeToMs:function(mt){if(!mt)return 0;if(typeof mt=="number")return mt;var yt=parseFloat(mt);return mt.indexOf("ms")!=-1?yt:1e3*yt},prefixes:["","-webkit-","-moz-","-o-"]};et.default=dt},function(it,et,ut){Object.defineProperty(et,"__esModule",{value:!0});var dt,mt=(dt=ut(0))&&dt.__esModule?dt:{default:dt};et.default=function yt(bt,Rt){if(function(zt,Jt){if(!(zt instanceof Jt))throw new TypeError("Cannot call a class as a function")}(this,yt),this.styles=typeof bt=="string"?mt.default.getFromSheets(bt):bt,typeof Rt=="string"){var jt=mt.default.getFromSheets(Rt);for(var Vt in this.options={},jt)this.options[Vt.replace("animation-","")]=jt[Vt]}else this.options=typeof Rt=="number"?{duration:Rt}:Rt}},function(it,et,ut){Object.defineProperty(et,"__esModule",{value:!0});var dt=function(){function Vt(zt,Jt){for(var rr=0;rr<Jt.length;rr++){var Yt=Jt[rr];Yt.enumerable=Yt.enumerable||!1,Yt.configurable=!0,"value"in Yt&&(Yt.writable=!0),Object.defineProperty(zt,Yt.key,Yt)}}return function(zt,Jt,rr){return Jt&&Vt(zt.prototype,Jt),rr&&Vt(zt,rr),zt}}(),mt=Rt(ut(4)),yt=Rt(ut(1)),bt=Rt(ut(0));function Rt(Vt){return Vt&&Vt.__esModule?Vt:{default:Vt}}var jt=function(){function Vt(zt,Jt,rr,Yt){if(function(Ht,er){if(!(Ht instanceof er))throw new TypeError("Cannot call a class as a function")}(this,Vt),zt.constructor===Array?this.doms=zt:this.doms=[zt],Jt.constructor===Array?this.frames=Jt:this.frames=[Jt],this.options={startFrom:0,pauseAt:[],prefix:!1,count:1,clear:!0,applyOnEnd:!1,instant:!1},rr!=null&&rr!=null)if(typeof rr=="boolean")this.options.instant=rr;else if(typeof rr=="number")this.options.count=rr,typeof Yt=="boolean"&&(this.options.instant=Yt);else for(var dr in rr)dr=="pauseAt"&&rr.pauseAt.constructor!==Array?this.options[dr]=[rr[dr]]:this.options[dr]=rr[dr];for(var Ft in this.promiseSupported=typeof Promise<"u"&&Promise.toString().indexOf("[native code]")!==-1,this.countRemainder=[],this.animations=[],this.styleDoms=[],this.superSets=[],this.eventHandler=[],this.options.prefix?this.prefixes=yt.default.prefixes:this.prefixes=[""],zt)this.countRemainder[Ft]=this.options.count-1;this.options.instant&&this.play()}return dt(Vt,[{key:"play",value:function(){var zt=this;for(var Jt in this.clear(),this.promiseSupported&&(this.promise=new Promise(function(Yt){zt.promiseResolve=Yt})),this.doms){var rr=this.makeAnimation(this.doms[Jt]);this.animations[Jt]=rr.names,this.styleDoms[Jt]=rr.styleDom,this.superSets[Jt]=this.makeSuperSet(this.doms[Jt],this.animations[Jt]),this.playAnimation(this.doms[Jt],this.superSets[Jt]),this.eventHandler[Jt]=this.handleAnimationEnd.bind(this,Jt),this.doms[Jt].addEventListener("animationend",this.eventHandler[Jt])}if(this.promiseSupported)return this.promise}},{key:"clear",value:function(zt){if(!zt){for(var Jt in this.doms)this.clear(Jt);return this.animationEnded=0,this.promise=void 0,void(this.promiseResolve=void 0)}var rr=this.styleDoms[zt];for(var Yt in rr&&rr.parentNode&&rr.parentNode.removeChild(rr),this.superSets[zt])for(var dr in this.prefixes)this.doms[zt].style[this.prefixes[dr]+"animation-"+Yt]=null;for(var Ft in this.prefixes)this.doms[zt].style[this.prefixes[Ft]+"animation-play-state"]=null;this.doms[zt].removeEventListener("animationend",this.eventHandler[zt]),this.countRemainder[zt]=this.options.count-1}},{key:"replay",value:function(zt){var Jt=this.doms[zt],rr=Jt.cloneNode(!0);Jt.parentNode.replaceChild(rr,Jt),this.doms[zt].removeEventListener("animationend",this.eventHandler[zt]),this.doms[zt]=rr,this.doms[zt].addEventListener("animationend",this.eventHandler[zt])}},{key:"pause",value:function(){for(var zt in this.doms)this.pauseDom(this.doms[zt])}},{key:"resume",value:function(){for(var zt in this.doms)this.resumeDom(this.doms[zt])}},{key:"getPromise",value:function(){return this.promise}},{key:"handleAnimationEnd",value:function(zt,Jt){var rr=Jt.animationName,Yt=rr.substring(rr.lastIndexOf("-")+1);this.options.pauseAt.includes(parseInt(Yt))&&this.pauseDom(this.doms[zt]),Yt==this.frames.length&&(this.countRemainder[zt]==-1?this.replay(zt):this.countRemainder[zt]>0?(this.countRemainder[zt]--,this.replay(zt)):(this.options.applyOnEnd&&this.applyOnEnd(zt),this.animationEnded++,this.animationEnded==this.doms.length&&(this.promiseSupported&&this.promiseResolve(),this.options.clear&&this.clear())))}},{key:"pauseDom",value:function(zt){for(var Jt in this.prefixes)zt.style[this.prefixes[Jt]+"animation-play-state"]="paused"}},{key:"resumeDom",value:function(zt){for(var Jt in this.prefixes)zt.style[this.prefixes[Jt]+"animation-play-state"]="running"}},{key:"applyOnEnd",value:function(zt){var Jt=this.newFrames[this.frames.length];for(var rr in Jt)this.doms[zt].style[rr]=Jt[rr]}},{key:"makeAnimation",value:function(zt){var Jt={},rr=[],Yt={};for(var dr in this.frames)for(var Ft in rr.push(this.frames[dr].styles),rr[dr])Yt[Ft]=!0;var Ht=window.getComputedStyle(zt);for(var er in Yt)Jt[er]=Ht[er];rr.unshift(Jt);for(var pr=[rr[0]],or=1;or<rr.length;++or){var ar=JSON.parse(JSON.stringify(pr[or-1]));for(var Wt in rr[or])ar[Wt]=rr[or][Wt];pr.push(ar)}return this.newFrames=pr,mt.default.make(pr,this.prefixes)}},{key:"makeSuperSet",value:function(zt,Jt){var rr=0,Yt={};for(var dr in this.frames)for(var Ft in this.frames[dr].options)Yt[Ft]="";Yt.name="",Yt.duration="",Yt.delay="";for(var Ht=0;Ht<this.frames.length;++Ht){if(Ht)for(var er in Yt)Yt[er]+=",";var pr=yt.default.convertTimeToMs(this.frames[Ht].options.duration),or=yt.default.convertTimeToMs(this.frames[Ht].options.delay);for(var ar in Ht<this.options.startFrom&&(pr=0,or=0),Yt.name+=Jt[Ht],Yt.duration+=pr+"ms",Yt.delay+=rr+or+"ms",Yt)ar!="name"&&ar!="duration"&&ar!="delay"&&(Yt[ar]+=this.frames[Ht].options[ar]?this.frames[Ht].options[ar]:bt.default.getPropertyDefault(ar));var Wt=this.frames[Ht].options["iteration-count"];rr+=pr*parseInt(Wt||1)+or}return Yt}},{key:"playAnimation",value:function(zt,Jt){for(var rr in Jt)for(var Yt in this.prefixes)zt.style[this.prefixes[Yt]+"animation-"+rr]=Jt[rr];this.options.pauseAt.includes(0)&&this.pauseDom(zt)}}]),Vt}();et.default=jt},function(it,et,ut){Object.defineProperty(et,"__esModule",{value:!0});var dt,mt=(dt=ut(1))&&dt.__esModule?dt:{default:dt},yt={make:function(bt,Rt){for(var jt=[],Vt="",zt="atr-"+mt.default.generateId(),Jt=document.createElement("style"),rr=0;rr<bt.length-1;++rr)jt.push(zt+"-"+(rr+1)),Vt+=yt.makeFromTwoFrames(bt[rr],bt[rr+1],jt[rr],Rt);return Jt.innerHTML=Vt,Jt.class="foo",document.getElementsByTagName("head")[0].appendChild(Jt),{names:jt,styleDom:Jt}},makeFromTwoFrames:function(bt,Rt,jt,Vt){var zt="";for(var Jt in Vt)zt+="@"+Vt[Jt]+"keyframes "+jt+" {",zt+="0%",zt+="{"+mt.default.frameToString(bt)+"}",zt+="100%",zt+="{"+mt.default.frameToString(Rt)+"}",zt+="}";return zt}};et.default=yt},function(it,et,ut){Object.defineProperty(et,"__esModule",{value:!0}),et.Queue=et.Frame=void 0;var dt=yt(ut(2)),mt=yt(ut(3));function yt(bt){return bt&&bt.__esModule?bt:{default:bt}}et.Frame=dt.default,et.Queue=mt.default}])},$.exports=j()},352:function($){$.exports=function(j){var it=[];return it.toString=function(){return this.map(function(et){var ut=j(et);return et[2]?"@media ".concat(et[2]," {").concat(ut,"}"):ut}).join("")},it.i=function(et,ut,dt){typeof et=="string"&&(et=[[null,et,""]]);var mt={};if(dt)for(var yt=0;yt<this.length;yt++){var bt=this[yt][0];bt!=null&&(mt[bt]=!0)}for(var Rt=0;Rt<et.length;Rt++){var jt=[].concat(et[Rt]);dt&&mt[jt[0]]||(ut&&(jt[2]?jt[2]="".concat(ut," and ").concat(jt[2]):jt[2]=ut),it.push(jt))}},it}},388:function($){$.exports=function j(it,et,ut){function dt(bt,Rt){if(!et[bt]){if(!it[bt]){if(mt)return mt(bt,!0);throw new Error("Cannot find module '"+bt+"'")}var jt=et[bt]={exports:{}};it[bt][0].call(jt.exports,function(Vt){return dt(it[bt][1][Vt]||Vt)},jt,jt.exports,j,it,et,ut)}return et[bt].exports}for(var mt=void 0,yt=0;yt<ut.length;yt++)dt(ut[yt]);return dt}({1:[function(j,it,et){(function(ut,dt,mt,yt,bt,Rt,jt,Vt,zt){var Jt=j("crypto");function rr(or,ar){return function(Wt,Zt){var sr;if((sr=Zt.algorithm!=="passthrough"?Jt.createHash(Zt.algorithm):new pr).write===void 0&&(sr.write=sr.update,sr.end=sr.update),er(Zt,sr).dispatch(Wt),sr.update||sr.end(""),sr.digest)return sr.digest(Zt.encoding==="buffer"?void 0:Zt.encoding);var tr=sr.read();return Zt.encoding!=="buffer"?tr.toString(Zt.encoding):tr}(or,ar=Ft(or,ar))}(et=it.exports=rr).sha1=function(or){return rr(or)},et.keys=function(or){return rr(or,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},et.MD5=function(or){return rr(or,{algorithm:"md5",encoding:"hex"})},et.keysMD5=function(or){return rr(or,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var Yt=Jt.getHashes?Jt.getHashes().slice():["sha1","md5"];Yt.push("passthrough");var dr=["buffer","hex","binary","base64"];function Ft(or,ar){ar=ar||{};var Wt={};if(Wt.algorithm=ar.algorithm||"sha1",Wt.encoding=ar.encoding||"hex",Wt.excludeValues=!!ar.excludeValues,Wt.algorithm=Wt.algorithm.toLowerCase(),Wt.encoding=Wt.encoding.toLowerCase(),Wt.ignoreUnknown=ar.ignoreUnknown===!0,Wt.respectType=ar.respectType!==!1,Wt.respectFunctionNames=ar.respectFunctionNames!==!1,Wt.respectFunctionProperties=ar.respectFunctionProperties!==!1,Wt.unorderedArrays=ar.unorderedArrays===!0,Wt.unorderedSets=ar.unorderedSets!==!1,Wt.unorderedObjects=ar.unorderedObjects!==!1,Wt.replacer=ar.replacer||void 0,Wt.excludeKeys=ar.excludeKeys||void 0,or===void 0)throw new Error("Object argument required.");for(var Zt=0;Zt<Yt.length;++Zt)Yt[Zt].toLowerCase()===Wt.algorithm.toLowerCase()&&(Wt.algorithm=Yt[Zt]);if(Yt.indexOf(Wt.algorithm)===-1)throw new Error('Algorithm "'+Wt.algorithm+'"  not supported. supported values: '+Yt.join(", "));if(dr.indexOf(Wt.encoding)===-1&&Wt.algorithm!=="passthrough")throw new Error('Encoding "'+Wt.encoding+'"  not supported. supported values: '+dr.join(", "));return Wt}function Ht(or){if(typeof or=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(or))!=null}function er(or,ar,Wt){function Zt(sr){return ar.update?ar.update(sr,"utf8"):ar.write(sr,"utf8")}return Wt=Wt||[],{dispatch:function(sr){return or.replacer&&(sr=or.replacer(sr)),this["_"+(sr===null?"null":typeof sr)](sr)},_object:function(sr){var tr,vr=Object.prototype.toString.call(sr),Vr=/\[object (.*)\]/i.exec(vr);if(Vr=(Vr=Vr?Vr[1]:"unknown:["+vr+"]").toLowerCase(),0<=(tr=Wt.indexOf(sr)))return this.dispatch("[CIRCULAR:"+tr+"]");if(Wt.push(sr),mt!==void 0&&mt.isBuffer&&mt.isBuffer(sr))return Zt("buffer:"),Zt(sr);if(Vr==="object"||Vr==="function"||Vr==="asyncfunction"){var hn=Object.keys(sr);or.unorderedObjects&&(hn=hn.sort()),or.respectType===!1||Ht(sr)||hn.splice(0,0,"prototype","__proto__","constructor"),or.excludeKeys&&(hn=hn.filter(function(gn){return!or.excludeKeys(gn)})),Zt("object:"+hn.length+":");var cn=this;return hn.forEach(function(gn){cn.dispatch(gn),Zt(":"),or.excludeValues||cn.dispatch(sr[gn]),Zt(",")})}if(!this["_"+Vr]){if(or.ignoreUnknown)return Zt("["+Vr+"]");throw new Error('Unknown object type "'+Vr+'"')}this["_"+Vr](sr)},_array:function(sr,tr){tr=tr!==void 0?tr:or.unorderedArrays!==!1;var vr=this;if(Zt("array:"+sr.length+":"),!tr||sr.length<=1)return sr.forEach(function(cn){return vr.dispatch(cn)});var Vr=[],hn=sr.map(function(cn){var gn=new pr,tn=Wt.slice();return er(or,gn,tn).dispatch(cn),Vr=Vr.concat(tn.slice(Wt.length)),gn.read().toString()});return Wt=Wt.concat(Vr),hn.sort(),this._array(hn,!1)},_date:function(sr){return Zt("date:"+sr.toJSON())},_symbol:function(sr){return Zt("symbol:"+sr.toString())},_error:function(sr){return Zt("error:"+sr.toString())},_boolean:function(sr){return Zt("bool:"+sr.toString())},_string:function(sr){Zt("string:"+sr.length+":"),Zt(sr.toString())},_function:function(sr){Zt("fn:"),Ht(sr)?this.dispatch("[native]"):this.dispatch(sr.toString()),or.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(sr.name)),or.respectFunctionProperties&&this._object(sr)},_number:function(sr){return Zt("number:"+sr.toString())},_xml:function(sr){return Zt("xml:"+sr.toString())},_null:function(){return Zt("Null")},_undefined:function(){return Zt("Undefined")},_regexp:function(sr){return Zt("regex:"+sr.toString())},_uint8array:function(sr){return Zt("uint8array:"),this.dispatch(Array.prototype.slice.call(sr))},_uint8clampedarray:function(sr){return Zt("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(sr))},_int8array:function(sr){return Zt("uint8array:"),this.dispatch(Array.prototype.slice.call(sr))},_uint16array:function(sr){return Zt("uint16array:"),this.dispatch(Array.prototype.slice.call(sr))},_int16array:function(sr){return Zt("uint16array:"),this.dispatch(Array.prototype.slice.call(sr))},_uint32array:function(sr){return Zt("uint32array:"),this.dispatch(Array.prototype.slice.call(sr))},_int32array:function(sr){return Zt("uint32array:"),this.dispatch(Array.prototype.slice.call(sr))},_float32array:function(sr){return Zt("float32array:"),this.dispatch(Array.prototype.slice.call(sr))},_float64array:function(sr){return Zt("float64array:"),this.dispatch(Array.prototype.slice.call(sr))},_arraybuffer:function(sr){return Zt("arraybuffer:"),this.dispatch(new Uint8Array(sr))},_url:function(sr){return Zt("url:"+sr.toString())},_map:function(sr){Zt("map:");var tr=Array.from(sr);return this._array(tr,or.unorderedSets!==!1)},_set:function(sr){Zt("set:");var tr=Array.from(sr);return this._array(tr,or.unorderedSets!==!1)},_file:function(sr){return Zt("file:"),this.dispatch([sr.name,sr.size,sr.type,sr.lastModfied])},_blob:function(){if(or.ignoreUnknown)return Zt("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return Zt("domwindow")},_bigint:function(sr){return Zt("bigint:"+sr.toString())},_process:function(){return Zt("process")},_timer:function(){return Zt("timer")},_pipe:function(){return Zt("pipe")},_tcp:function(){return Zt("tcp")},_udp:function(){return Zt("udp")},_tty:function(){return Zt("tty")},_statwatcher:function(){return Zt("statwatcher")},_securecontext:function(){return Zt("securecontext")},_connection:function(){return Zt("connection")},_zlib:function(){return Zt("zlib")},_context:function(){return Zt("context")},_nodescript:function(){return Zt("nodescript")},_httpparser:function(){return Zt("httpparser")},_dataview:function(){return Zt("dataview")},_signal:function(){return Zt("signal")},_fsevent:function(){return Zt("fsevent")},_tlswrap:function(){return Zt("tlswrap")}}}function pr(){return{buf:"",write:function(or){this.buf+=or},end:function(or){this.buf+=or},read:function(){return this.buf}}}et.writeToStream=function(or,ar,Wt){return Wt===void 0&&(Wt=ar,ar={}),er(ar=Ft(or,ar),Wt).dispatch(or)}}).call(this,j("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},j("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_7eac155c.js","/")},{buffer:3,crypto:5,lYpoI2:10}],2:[function(j,it,et){(function(ut,dt,mt,yt,bt,Rt,jt,Vt,zt){(function(Jt){var rr=typeof Uint8Array<"u"?Uint8Array:Array,Yt="+".charCodeAt(0),dr="/".charCodeAt(0),Ft="0".charCodeAt(0),Ht="a".charCodeAt(0),er="A".charCodeAt(0),pr="-".charCodeAt(0),or="_".charCodeAt(0);function ar(Wt){var Zt=Wt.charCodeAt(0);return Zt===Yt||Zt===pr?62:Zt===dr||Zt===or?63:Zt<Ft?-1:Zt<Ft+10?Zt-Ft+26+26:Zt<er+26?Zt-er:Zt<Ht+26?Zt-Ht+26:void 0}Jt.toByteArray=function(Wt){var Zt,sr;if(0<Wt.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var tr=Wt.length,vr=Wt.charAt(tr-2)==="="?2:Wt.charAt(tr-1)==="="?1:0,Vr=new rr(3*Wt.length/4-vr),hn=0<vr?Wt.length-4:Wt.length,cn=0;function gn(tn){Vr[cn++]=tn}for(Zt=0;Zt<hn;Zt+=4,0)gn((16711680&(sr=ar(Wt.charAt(Zt))<<18|ar(Wt.charAt(Zt+1))<<12|ar(Wt.charAt(Zt+2))<<6|ar(Wt.charAt(Zt+3))))>>16),gn((65280&sr)>>8),gn(255&sr);return vr==2?gn(255&(sr=ar(Wt.charAt(Zt))<<2|ar(Wt.charAt(Zt+1))>>4)):vr==1&&(gn((sr=ar(Wt.charAt(Zt))<<10|ar(Wt.charAt(Zt+1))<<4|ar(Wt.charAt(Zt+2))>>2)>>8&255),gn(255&sr)),Vr},Jt.fromByteArray=function(Wt){var Zt,sr,tr,vr,Vr=Wt.length%3,hn="";function cn(gn){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(gn)}for(Zt=0,tr=Wt.length-Vr;Zt<tr;Zt+=3)hn+=cn((vr=sr=(Wt[Zt]<<16)+(Wt[Zt+1]<<8)+Wt[Zt+2])>>18&63)+cn(vr>>12&63)+cn(vr>>6&63)+cn(63&vr);switch(Vr){case 1:hn+=cn((sr=Wt[Wt.length-1])>>2),hn+=cn(sr<<4&63),hn+="==";break;case 2:hn+=cn((sr=(Wt[Wt.length-2]<<8)+Wt[Wt.length-1])>>10),hn+=cn(sr>>4&63),hn+=cn(sr<<2&63),hn+="="}return hn}})(et===void 0?this.base64js={}:et)}).call(this,j("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},j("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:10}],3:[function(j,it,et){(function(ut,dt,Yt,yt,bt,Rt,jt,Vt,zt){var Jt=j("base64-js"),rr=j("ieee754");function Yt(mr,Ar,jr){if(!(this instanceof Yt))return new Yt(mr,Ar,jr);var On,$n,jn,As,ps,qs=typeof mr;if(Ar==="base64"&&qs=="string")for(mr=(On=mr).trim?On.trim():On.replace(/^\s+|\s+$/g,"");mr.length%4!=0;)mr+="=";if(qs=="number")$n=cn(mr);else if(qs=="string")$n=Yt.byteLength(mr,Ar);else{if(qs!="object")throw new Error("First argument needs to be a number, array or string.");$n=cn(mr.length)}if(Yt._useTypedArrays?jn=Yt._augment(new Uint8Array($n)):((jn=this).length=$n,jn._isBuffer=!0),Yt._useTypedArrays&&typeof mr.byteLength=="number")jn._set(mr);else if(gn(ps=mr)||Yt.isBuffer(ps)||ps&&typeof ps=="object"&&typeof ps.length=="number")for(As=0;As<$n;As++)Yt.isBuffer(mr)?jn[As]=mr.readUInt8(As):jn[As]=mr[As];else if(qs=="string")jn.write(mr,0,Ar);else if(qs=="number"&&!Yt._useTypedArrays&&!jr)for(As=0;As<$n;As++)jn[As]=0;return jn}function dr(mr,Ar,jr,On){On||(Jr(typeof jr=="boolean","missing or invalid endian"),Jr(Ar!=null,"missing offset"),Jr(Ar+1<mr.length,"Trying to read beyond buffer length"));var $n,jn=mr.length;if(!(jn<=Ar))return jr?($n=mr[Ar],Ar+1<jn&&($n|=mr[Ar+1]<<8)):($n=mr[Ar]<<8,Ar+1<jn&&($n|=mr[Ar+1])),$n}function Ft(mr,Ar,jr,On){On||(Jr(typeof jr=="boolean","missing or invalid endian"),Jr(Ar!=null,"missing offset"),Jr(Ar+3<mr.length,"Trying to read beyond buffer length"));var $n,jn=mr.length;if(!(jn<=Ar))return jr?(Ar+2<jn&&($n=mr[Ar+2]<<16),Ar+1<jn&&($n|=mr[Ar+1]<<8),$n|=mr[Ar],Ar+3<jn&&($n+=mr[Ar+3]<<24>>>0)):(Ar+1<jn&&($n=mr[Ar+1]<<16),Ar+2<jn&&($n|=mr[Ar+2]<<8),Ar+3<jn&&($n|=mr[Ar+3]),$n+=mr[Ar]<<24>>>0),$n}function Ht(mr,Ar,jr,On){if(On||(Jr(typeof jr=="boolean","missing or invalid endian"),Jr(Ar!=null,"missing offset"),Jr(Ar+1<mr.length,"Trying to read beyond buffer length")),!(mr.length<=Ar)){var $n=dr(mr,Ar,jr,!0);return 32768&$n?-1*(65535-$n+1):$n}}function er(mr,Ar,jr,On){if(On||(Jr(typeof jr=="boolean","missing or invalid endian"),Jr(Ar!=null,"missing offset"),Jr(Ar+3<mr.length,"Trying to read beyond buffer length")),!(mr.length<=Ar)){var $n=Ft(mr,Ar,jr,!0);return 2147483648&$n?-1*(4294967295-$n+1):$n}}function pr(mr,Ar,jr,On){return On||(Jr(typeof jr=="boolean","missing or invalid endian"),Jr(Ar+3<mr.length,"Trying to read beyond buffer length")),rr.read(mr,Ar,jr,23,4)}function or(mr,Ar,jr,On){return On||(Jr(typeof jr=="boolean","missing or invalid endian"),Jr(Ar+7<mr.length,"Trying to read beyond buffer length")),rr.read(mr,Ar,jr,52,8)}function ar(mr,Ar,jr,On,$n){$n||(Jr(Ar!=null,"missing value"),Jr(typeof On=="boolean","missing or invalid endian"),Jr(jr!=null,"missing offset"),Jr(jr+1<mr.length,"trying to write beyond buffer length"),an(Ar,65535));var jn=mr.length;if(!(jn<=jr))for(var As=0,ps=Math.min(jn-jr,2);As<ps;As++)mr[jr+As]=(Ar&255<<8*(On?As:1-As))>>>8*(On?As:1-As)}function Wt(mr,Ar,jr,On,$n){$n||(Jr(Ar!=null,"missing value"),Jr(typeof On=="boolean","missing or invalid endian"),Jr(jr!=null,"missing offset"),Jr(jr+3<mr.length,"trying to write beyond buffer length"),an(Ar,4294967295));var jn=mr.length;if(!(jn<=jr))for(var As=0,ps=Math.min(jn-jr,4);As<ps;As++)mr[jr+As]=Ar>>>8*(On?As:3-As)&255}function Zt(mr,Ar,jr,On,$n){$n||(Jr(Ar!=null,"missing value"),Jr(typeof On=="boolean","missing or invalid endian"),Jr(jr!=null,"missing offset"),Jr(jr+1<mr.length,"Trying to write beyond buffer length"),sn(Ar,32767,-32768)),mr.length<=jr||ar(mr,0<=Ar?Ar:65535+Ar+1,jr,On,$n)}function sr(mr,Ar,jr,On,$n){$n||(Jr(Ar!=null,"missing value"),Jr(typeof On=="boolean","missing or invalid endian"),Jr(jr!=null,"missing offset"),Jr(jr+3<mr.length,"Trying to write beyond buffer length"),sn(Ar,2147483647,-2147483648)),mr.length<=jr||Wt(mr,0<=Ar?Ar:4294967295+Ar+1,jr,On,$n)}function tr(mr,Ar,jr,On,$n){$n||(Jr(Ar!=null,"missing value"),Jr(typeof On=="boolean","missing or invalid endian"),Jr(jr!=null,"missing offset"),Jr(jr+3<mr.length,"Trying to write beyond buffer length"),Rn(Ar,34028234663852886e22,-34028234663852886e22)),mr.length<=jr||rr.write(mr,Ar,jr,On,23,4)}function vr(mr,Ar,jr,On,$n){$n||(Jr(Ar!=null,"missing value"),Jr(typeof On=="boolean","missing or invalid endian"),Jr(jr!=null,"missing offset"),Jr(jr+7<mr.length,"Trying to write beyond buffer length"),Rn(Ar,17976931348623157e292,-17976931348623157e292)),mr.length<=jr||rr.write(mr,Ar,jr,On,52,8)}et.Buffer=Yt,et.SlowBuffer=Yt,et.INSPECT_MAX_BYTES=50,Yt.poolSize=8192,Yt._useTypedArrays=function(){try{var mr=new ArrayBuffer(0),Ar=new Uint8Array(mr);return Ar.foo=function(){return 42},Ar.foo()===42&&typeof Ar.subarray=="function"}catch{return!1}}(),Yt.isEncoding=function(mr){switch(String(mr).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Yt.isBuffer=function(mr){return!(mr==null||!mr._isBuffer)},Yt.byteLength=function(mr,Ar){var jr;switch(mr+="",Ar||"utf8"){case"hex":jr=mr.length/2;break;case"utf8":case"utf-8":jr=Tn(mr).length;break;case"ascii":case"binary":case"raw":jr=mr.length;break;case"base64":jr=qr(mr).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":jr=2*mr.length;break;default:throw new Error("Unknown encoding")}return jr},Yt.concat=function(mr,Ar){if(Jr(gn(mr),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),mr.length===0)return new Yt(0);if(mr.length===1)return mr[0];if(typeof Ar!="number")for($n=Ar=0;$n<mr.length;$n++)Ar+=mr[$n].length;for(var jr=new Yt(Ar),On=0,$n=0;$n<mr.length;$n++){var jn=mr[$n];jn.copy(jr,On),On+=jn.length}return jr},Yt.prototype.write=function(mr,Ar,jr,On){var $n;isFinite(Ar)?isFinite(jr)||(On=jr,jr=void 0):($n=On,On=Ar,Ar=jr,jr=$n),Ar=Number(Ar)||0;var jn,As,ps,qs,Vs,Eo,js,mn=this.length-Ar;switch((!jr||mn<(jr=Number(jr)))&&(jr=mn),On=String(On||"utf8").toLowerCase()){case"hex":jn=function(uo,_o,Vl,Vo){Vl=Number(Vl)||0;var Oo=uo.length-Vl;(!Vo||Oo<(Vo=Number(Vo)))&&(Vo=Oo);var Lo=_o.length;Jr(Lo%2==0,"Invalid hex string"),Lo/2<Vo&&(Vo=Lo/2);for(var No=0;No<Vo;No++){var eu=parseInt(_o.substr(2*No,2),16);Jr(!isNaN(eu),"Invalid hex string"),uo[Vl+No]=eu}return Yt._charsWritten=2*No,No}(this,mr,Ar,jr);break;case"utf8":case"utf-8":Vs=mr,Eo=Ar,js=jr,jn=Yt._charsWritten=nn(Tn(Vs),this,Eo,js);break;case"ascii":case"binary":jn=function(uo,_o,Vl,Vo){return Yt._charsWritten=nn(function(Oo){for(var Lo=[],No=0;No<Oo.length;No++)Lo.push(255&Oo.charCodeAt(No));return Lo}(_o),uo,Vl,Vo)}(this,mr,Ar,jr);break;case"base64":As=mr,ps=Ar,qs=jr,jn=Yt._charsWritten=nn(qr(As),this,ps,qs);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":jn=function(uo,_o,Vl,Vo){return Yt._charsWritten=nn(function(Oo){for(var Lo,No,eu,So=[],co=0;co<Oo.length;co++)No=(Lo=Oo.charCodeAt(co))>>8,eu=Lo%256,So.push(eu),So.push(No);return So}(_o),uo,Vl,Vo)}(this,mr,Ar,jr);break;default:throw new Error("Unknown encoding")}return jn},Yt.prototype.toString=function(mr,Ar,jr){var On,$n,jn,As,ps=this;if(mr=String(mr||"utf8").toLowerCase(),Ar=Number(Ar)||0,(jr=jr!==void 0?Number(jr):jr=ps.length)===Ar)return"";switch(mr){case"hex":On=function(qs,Vs,Eo){var js=qs.length;(!Vs||Vs<0)&&(Vs=0),(!Eo||Eo<0||js<Eo)&&(Eo=js);for(var mn="",uo=Vs;uo<Eo;uo++)mn+=tn(qs[uo]);return mn}(ps,Ar,jr);break;case"utf8":case"utf-8":On=function(qs,Vs,Eo){var js="",mn="";Eo=Math.min(qs.length,Eo);for(var uo=Vs;uo<Eo;uo++)qs[uo]<=127?(js+=yr(mn)+String.fromCharCode(qs[uo]),mn=""):mn+="%"+qs[uo].toString(16);return js+yr(mn)}(ps,Ar,jr);break;case"ascii":case"binary":On=function(qs,Vs,Eo){var js="";Eo=Math.min(qs.length,Eo);for(var mn=Vs;mn<Eo;mn++)js+=String.fromCharCode(qs[mn]);return js}(ps,Ar,jr);break;case"base64":$n=ps,As=jr,On=(jn=Ar)===0&&As===$n.length?Jt.fromByteArray($n):Jt.fromByteArray($n.slice(jn,As));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":On=function(qs,Vs,Eo){for(var js=qs.slice(Vs,Eo),mn="",uo=0;uo<js.length;uo+=2)mn+=String.fromCharCode(js[uo]+256*js[uo+1]);return mn}(ps,Ar,jr);break;default:throw new Error("Unknown encoding")}return On},Yt.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Yt.prototype.copy=function(mr,Ar,jr,On){if(jr=jr||0,On||On===0||(On=this.length),Ar=Ar||0,On!==jr&&mr.length!==0&&this.length!==0){Jr(jr<=On,"sourceEnd < sourceStart"),Jr(0<=Ar&&Ar<mr.length,"targetStart out of bounds"),Jr(0<=jr&&jr<this.length,"sourceStart out of bounds"),Jr(0<=On&&On<=this.length,"sourceEnd out of bounds"),On>this.length&&(On=this.length),mr.length-Ar<On-jr&&(On=mr.length-Ar+jr);var $n=On-jr;if($n<100||!Yt._useTypedArrays)for(var jn=0;jn<$n;jn++)mr[jn+Ar]=this[jn+jr];else mr._set(this.subarray(jr,jr+$n),Ar)}},Yt.prototype.slice=function(mr,Ar){var jr=this.length;if(mr=hn(mr,jr,0),Ar=hn(Ar,jr,jr),Yt._useTypedArrays)return Yt._augment(this.subarray(mr,Ar));for(var On=Ar-mr,$n=new Yt(On,void 0,!0),jn=0;jn<On;jn++)$n[jn]=this[jn+mr];return $n},Yt.prototype.get=function(mr){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(mr)},Yt.prototype.set=function(mr,Ar){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(mr,Ar)},Yt.prototype.readUInt8=function(mr,Ar){if(Ar||(Jr(mr!=null,"missing offset"),Jr(mr<this.length,"Trying to read beyond buffer length")),!(mr>=this.length))return this[mr]},Yt.prototype.readUInt16LE=function(mr,Ar){return dr(this,mr,!0,Ar)},Yt.prototype.readUInt16BE=function(mr,Ar){return dr(this,mr,!1,Ar)},Yt.prototype.readUInt32LE=function(mr,Ar){return Ft(this,mr,!0,Ar)},Yt.prototype.readUInt32BE=function(mr,Ar){return Ft(this,mr,!1,Ar)},Yt.prototype.readInt8=function(mr,Ar){if(Ar||(Jr(mr!=null,"missing offset"),Jr(mr<this.length,"Trying to read beyond buffer length")),!(mr>=this.length))return 128&this[mr]?-1*(255-this[mr]+1):this[mr]},Yt.prototype.readInt16LE=function(mr,Ar){return Ht(this,mr,!0,Ar)},Yt.prototype.readInt16BE=function(mr,Ar){return Ht(this,mr,!1,Ar)},Yt.prototype.readInt32LE=function(mr,Ar){return er(this,mr,!0,Ar)},Yt.prototype.readInt32BE=function(mr,Ar){return er(this,mr,!1,Ar)},Yt.prototype.readFloatLE=function(mr,Ar){return pr(this,mr,!0,Ar)},Yt.prototype.readFloatBE=function(mr,Ar){return pr(this,mr,!1,Ar)},Yt.prototype.readDoubleLE=function(mr,Ar){return or(this,mr,!0,Ar)},Yt.prototype.readDoubleBE=function(mr,Ar){return or(this,mr,!1,Ar)},Yt.prototype.writeUInt8=function(mr,Ar,jr){jr||(Jr(mr!=null,"missing value"),Jr(Ar!=null,"missing offset"),Jr(Ar<this.length,"trying to write beyond buffer length"),an(mr,255)),Ar>=this.length||(this[Ar]=mr)},Yt.prototype.writeUInt16LE=function(mr,Ar,jr){ar(this,mr,Ar,!0,jr)},Yt.prototype.writeUInt16BE=function(mr,Ar,jr){ar(this,mr,Ar,!1,jr)},Yt.prototype.writeUInt32LE=function(mr,Ar,jr){Wt(this,mr,Ar,!0,jr)},Yt.prototype.writeUInt32BE=function(mr,Ar,jr){Wt(this,mr,Ar,!1,jr)},Yt.prototype.writeInt8=function(mr,Ar,jr){jr||(Jr(mr!=null,"missing value"),Jr(Ar!=null,"missing offset"),Jr(Ar<this.length,"Trying to write beyond buffer length"),sn(mr,127,-128)),Ar>=this.length||(0<=mr?this.writeUInt8(mr,Ar,jr):this.writeUInt8(255+mr+1,Ar,jr))},Yt.prototype.writeInt16LE=function(mr,Ar,jr){Zt(this,mr,Ar,!0,jr)},Yt.prototype.writeInt16BE=function(mr,Ar,jr){Zt(this,mr,Ar,!1,jr)},Yt.prototype.writeInt32LE=function(mr,Ar,jr){sr(this,mr,Ar,!0,jr)},Yt.prototype.writeInt32BE=function(mr,Ar,jr){sr(this,mr,Ar,!1,jr)},Yt.prototype.writeFloatLE=function(mr,Ar,jr){tr(this,mr,Ar,!0,jr)},Yt.prototype.writeFloatBE=function(mr,Ar,jr){tr(this,mr,Ar,!1,jr)},Yt.prototype.writeDoubleLE=function(mr,Ar,jr){vr(this,mr,Ar,!0,jr)},Yt.prototype.writeDoubleBE=function(mr,Ar,jr){vr(this,mr,Ar,!1,jr)},Yt.prototype.fill=function(mr,Ar,jr){if(mr=mr||0,Ar=Ar||0,jr=jr||this.length,typeof mr=="string"&&(mr=mr.charCodeAt(0)),Jr(typeof mr=="number"&&!isNaN(mr),"value is not a number"),Jr(Ar<=jr,"end < start"),jr!==Ar&&this.length!==0){Jr(0<=Ar&&Ar<this.length,"start out of bounds"),Jr(0<=jr&&jr<=this.length,"end out of bounds");for(var On=Ar;On<jr;On++)this[On]=mr}},Yt.prototype.inspect=function(){for(var mr=[],Ar=this.length,jr=0;jr<Ar;jr++)if(mr[jr]=tn(this[jr]),jr===et.INSPECT_MAX_BYTES){mr[jr+1]="...";break}return"<Buffer "+mr.join(" ")+">"},Yt.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(Yt._useTypedArrays)return new Yt(this).buffer;for(var mr=new Uint8Array(this.length),Ar=0,jr=mr.length;Ar<jr;Ar+=1)mr[Ar]=this[Ar];return mr.buffer};var Vr=Yt.prototype;function hn(mr,Ar,jr){return typeof mr!="number"?jr:Ar<=(mr=~~mr)?Ar:0<=mr||0<=(mr+=Ar)?mr:0}function cn(mr){return(mr=~~Math.ceil(+mr))<0?0:mr}function gn(mr){return(Array.isArray||function(Ar){return Object.prototype.toString.call(Ar)==="[object Array]"})(mr)}function tn(mr){return mr<16?"0"+mr.toString(16):mr.toString(16)}function Tn(mr){for(var Ar=[],jr=0;jr<mr.length;jr++){var On=mr.charCodeAt(jr);if(On<=127)Ar.push(mr.charCodeAt(jr));else{var $n=jr;55296<=On&&On<=57343&&jr++;for(var jn=encodeURIComponent(mr.slice($n,jr+1)).substr(1).split("%"),As=0;As<jn.length;As++)Ar.push(parseInt(jn[As],16))}}return Ar}function qr(mr){return Jt.toByteArray(mr)}function nn(mr,Ar,jr,On){for(var $n=0;$n<On&&!($n+jr>=Ar.length||$n>=mr.length);$n++)Ar[$n+jr]=mr[$n];return $n}function yr(mr){try{return decodeURIComponent(mr)}catch{return String.fromCharCode(65533)}}function an(mr,Ar){Jr(typeof mr=="number","cannot write a non-number as a number"),Jr(0<=mr,"specified a negative value for writing an unsigned value"),Jr(mr<=Ar,"value is larger than maximum value for type"),Jr(Math.floor(mr)===mr,"value has a fractional component")}function sn(mr,Ar,jr){Jr(typeof mr=="number","cannot write a non-number as a number"),Jr(mr<=Ar,"value larger than maximum allowed value"),Jr(jr<=mr,"value smaller than minimum allowed value"),Jr(Math.floor(mr)===mr,"value has a fractional component")}function Rn(mr,Ar,jr){Jr(typeof mr=="number","cannot write a non-number as a number"),Jr(mr<=Ar,"value larger than maximum allowed value"),Jr(jr<=mr,"value smaller than minimum allowed value")}function Jr(mr,Ar){if(!mr)throw new Error(Ar||"Failed assertion")}Yt._augment=function(mr){return mr._isBuffer=!0,mr._get=mr.get,mr._set=mr.set,mr.get=Vr.get,mr.set=Vr.set,mr.write=Vr.write,mr.toString=Vr.toString,mr.toLocaleString=Vr.toString,mr.toJSON=Vr.toJSON,mr.copy=Vr.copy,mr.slice=Vr.slice,mr.readUInt8=Vr.readUInt8,mr.readUInt16LE=Vr.readUInt16LE,mr.readUInt16BE=Vr.readUInt16BE,mr.readUInt32LE=Vr.readUInt32LE,mr.readUInt32BE=Vr.readUInt32BE,mr.readInt8=Vr.readInt8,mr.readInt16LE=Vr.readInt16LE,mr.readInt16BE=Vr.readInt16BE,mr.readInt32LE=Vr.readInt32LE,mr.readInt32BE=Vr.readInt32BE,mr.readFloatLE=Vr.readFloatLE,mr.readFloatBE=Vr.readFloatBE,mr.readDoubleLE=Vr.readDoubleLE,mr.readDoubleBE=Vr.readDoubleBE,mr.writeUInt8=Vr.writeUInt8,mr.writeUInt16LE=Vr.writeUInt16LE,mr.writeUInt16BE=Vr.writeUInt16BE,mr.writeUInt32LE=Vr.writeUInt32LE,mr.writeUInt32BE=Vr.writeUInt32BE,mr.writeInt8=Vr.writeInt8,mr.writeInt16LE=Vr.writeInt16LE,mr.writeInt16BE=Vr.writeInt16BE,mr.writeInt32LE=Vr.writeInt32LE,mr.writeInt32BE=Vr.writeInt32BE,mr.writeFloatLE=Vr.writeFloatLE,mr.writeFloatBE=Vr.writeFloatBE,mr.writeDoubleLE=Vr.writeDoubleLE,mr.writeDoubleBE=Vr.writeDoubleBE,mr.fill=Vr.fill,mr.inspect=Vr.inspect,mr.toArrayBuffer=Vr.toArrayBuffer,mr}}).call(this,j("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},j("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:11,lYpoI2:10}],4:[function(j,it,et){(function(ut,dt,mt,yt,bt,Rt,jt,Vt,zt){mt=j("buffer").Buffer;var Jt=new mt(4);Jt.fill(0),it.exports={hash:function(rr,Yt,dr,Ft){return mt.isBuffer(rr)||(rr=new mt(rr)),function(Ht,er,pr){for(var or=new mt(er),ar=pr?or.writeInt32BE:or.writeInt32LE,Wt=0;Wt<Ht.length;Wt++)ar.call(or,Ht[Wt],4*Wt,!0);return or}(Yt(function(Ht,er){var pr;Ht.length%4!=0&&(pr=Ht.length+(4-Ht.length%4),Ht=mt.concat([Ht,Jt],pr));for(var or=[],ar=er?Ht.readInt32BE:Ht.readInt32LE,Wt=0;Wt<Ht.length;Wt+=4)or.push(ar.call(Ht,Wt));return or}(rr,Ft),8*rr.length),dr,Ft)}}}).call(this,j("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},j("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],5:[function(j,it,et){(function(ut,dt,mt,yt,bt,Rt,jt,Vt,zt){mt=j("buffer").Buffer;var Jt=j("./sha"),rr=j("./sha256"),Yt=j("./rng"),dr={sha1:Jt,sha256:rr,md5:j("./md5")},Ft=64,Ht=new mt(Ft);function er(or,ar){var Wt=dr[or=or||"sha1"],Zt=[];return Wt||pr("algorithm:",or,"is not yet supported"),{update:function(sr){return mt.isBuffer(sr)||(sr=new mt(sr)),Zt.push(sr),sr.length,this},digest:function(sr){var tr=mt.concat(Zt),vr=ar?function(Vr,hn,cn){mt.isBuffer(hn)||(hn=new mt(hn)),mt.isBuffer(cn)||(cn=new mt(cn)),hn.length>Ft?hn=Vr(hn):hn.length<Ft&&(hn=mt.concat([hn,Ht],Ft));for(var gn=new mt(Ft),tn=new mt(Ft),Tn=0;Tn<Ft;Tn++)gn[Tn]=54^hn[Tn],tn[Tn]=92^hn[Tn];var qr=Vr(mt.concat([gn,cn]));return Vr(mt.concat([tn,qr]))}(Wt,ar,tr):Wt(tr);return Zt=null,sr?vr.toString(sr):vr}}}function pr(){var or=[].slice.call(arguments).join(" ");throw new Error([or,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}Ht.fill(0),et.createHash=function(or){return er(or)},et.createHmac=er,et.randomBytes=function(or,ar){if(!ar||!ar.call)return new mt(Yt(or));try{ar.call(this,void 0,new mt(Yt(or)))}catch(Wt){ar(Wt)}},function(or,ar){for(var Wt in or)ar(or[Wt])}(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],function(or){et[or]=function(){pr("sorry,",or,"is not implemented yet")}})}).call(this,j("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},j("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:10}],6:[function(j,it,et){(function(ut,dt,mt,yt,bt,Rt,jt,Vt,zt){var Jt=j("./helpers");function rr(or,ar){or[ar>>5]|=128<<ar%32,or[14+(ar+64>>>9<<4)]=ar;for(var Wt=1732584193,Zt=-271733879,sr=-1732584194,tr=271733878,vr=0;vr<or.length;vr+=16){var Vr=Wt,hn=Zt,cn=sr,gn=tr;Wt=dr(Wt,Zt,sr,tr,or[vr+0],7,-680876936),tr=dr(tr,Wt,Zt,sr,or[vr+1],12,-389564586),sr=dr(sr,tr,Wt,Zt,or[vr+2],17,606105819),Zt=dr(Zt,sr,tr,Wt,or[vr+3],22,-1044525330),Wt=dr(Wt,Zt,sr,tr,or[vr+4],7,-176418897),tr=dr(tr,Wt,Zt,sr,or[vr+5],12,1200080426),sr=dr(sr,tr,Wt,Zt,or[vr+6],17,-1473231341),Zt=dr(Zt,sr,tr,Wt,or[vr+7],22,-45705983),Wt=dr(Wt,Zt,sr,tr,or[vr+8],7,1770035416),tr=dr(tr,Wt,Zt,sr,or[vr+9],12,-1958414417),sr=dr(sr,tr,Wt,Zt,or[vr+10],17,-42063),Zt=dr(Zt,sr,tr,Wt,or[vr+11],22,-1990404162),Wt=dr(Wt,Zt,sr,tr,or[vr+12],7,1804603682),tr=dr(tr,Wt,Zt,sr,or[vr+13],12,-40341101),sr=dr(sr,tr,Wt,Zt,or[vr+14],17,-1502002290),Wt=Ft(Wt,Zt=dr(Zt,sr,tr,Wt,or[vr+15],22,1236535329),sr,tr,or[vr+1],5,-165796510),tr=Ft(tr,Wt,Zt,sr,or[vr+6],9,-1069501632),sr=Ft(sr,tr,Wt,Zt,or[vr+11],14,643717713),Zt=Ft(Zt,sr,tr,Wt,or[vr+0],20,-373897302),Wt=Ft(Wt,Zt,sr,tr,or[vr+5],5,-701558691),tr=Ft(tr,Wt,Zt,sr,or[vr+10],9,38016083),sr=Ft(sr,tr,Wt,Zt,or[vr+15],14,-660478335),Zt=Ft(Zt,sr,tr,Wt,or[vr+4],20,-405537848),Wt=Ft(Wt,Zt,sr,tr,or[vr+9],5,568446438),tr=Ft(tr,Wt,Zt,sr,or[vr+14],9,-1019803690),sr=Ft(sr,tr,Wt,Zt,or[vr+3],14,-187363961),Zt=Ft(Zt,sr,tr,Wt,or[vr+8],20,1163531501),Wt=Ft(Wt,Zt,sr,tr,or[vr+13],5,-1444681467),tr=Ft(tr,Wt,Zt,sr,or[vr+2],9,-51403784),sr=Ft(sr,tr,Wt,Zt,or[vr+7],14,1735328473),Wt=Ht(Wt,Zt=Ft(Zt,sr,tr,Wt,or[vr+12],20,-1926607734),sr,tr,or[vr+5],4,-378558),tr=Ht(tr,Wt,Zt,sr,or[vr+8],11,-2022574463),sr=Ht(sr,tr,Wt,Zt,or[vr+11],16,1839030562),Zt=Ht(Zt,sr,tr,Wt,or[vr+14],23,-35309556),Wt=Ht(Wt,Zt,sr,tr,or[vr+1],4,-1530992060),tr=Ht(tr,Wt,Zt,sr,or[vr+4],11,1272893353),sr=Ht(sr,tr,Wt,Zt,or[vr+7],16,-155497632),Zt=Ht(Zt,sr,tr,Wt,or[vr+10],23,-1094730640),Wt=Ht(Wt,Zt,sr,tr,or[vr+13],4,681279174),tr=Ht(tr,Wt,Zt,sr,or[vr+0],11,-358537222),sr=Ht(sr,tr,Wt,Zt,or[vr+3],16,-722521979),Zt=Ht(Zt,sr,tr,Wt,or[vr+6],23,76029189),Wt=Ht(Wt,Zt,sr,tr,or[vr+9],4,-640364487),tr=Ht(tr,Wt,Zt,sr,or[vr+12],11,-421815835),sr=Ht(sr,tr,Wt,Zt,or[vr+15],16,530742520),Wt=er(Wt,Zt=Ht(Zt,sr,tr,Wt,or[vr+2],23,-995338651),sr,tr,or[vr+0],6,-198630844),tr=er(tr,Wt,Zt,sr,or[vr+7],10,1126891415),sr=er(sr,tr,Wt,Zt,or[vr+14],15,-1416354905),Zt=er(Zt,sr,tr,Wt,or[vr+5],21,-57434055),Wt=er(Wt,Zt,sr,tr,or[vr+12],6,1700485571),tr=er(tr,Wt,Zt,sr,or[vr+3],10,-1894986606),sr=er(sr,tr,Wt,Zt,or[vr+10],15,-1051523),Zt=er(Zt,sr,tr,Wt,or[vr+1],21,-2054922799),Wt=er(Wt,Zt,sr,tr,or[vr+8],6,1873313359),tr=er(tr,Wt,Zt,sr,or[vr+15],10,-30611744),sr=er(sr,tr,Wt,Zt,or[vr+6],15,-1560198380),Zt=er(Zt,sr,tr,Wt,or[vr+13],21,1309151649),Wt=er(Wt,Zt,sr,tr,or[vr+4],6,-145523070),tr=er(tr,Wt,Zt,sr,or[vr+11],10,-1120210379),sr=er(sr,tr,Wt,Zt,or[vr+2],15,718787259),Zt=er(Zt,sr,tr,Wt,or[vr+9],21,-343485551),Wt=pr(Wt,Vr),Zt=pr(Zt,hn),sr=pr(sr,cn),tr=pr(tr,gn)}return Array(Wt,Zt,sr,tr)}function Yt(or,ar,Wt,Zt,sr,tr){return pr((vr=pr(pr(ar,or),pr(Zt,tr)))<<(Vr=sr)|vr>>>32-Vr,Wt);var vr,Vr}function dr(or,ar,Wt,Zt,sr,tr,vr){return Yt(ar&Wt|~ar&Zt,or,ar,sr,tr,vr)}function Ft(or,ar,Wt,Zt,sr,tr,vr){return Yt(ar&Zt|Wt&~Zt,or,ar,sr,tr,vr)}function Ht(or,ar,Wt,Zt,sr,tr,vr){return Yt(ar^Wt^Zt,or,ar,sr,tr,vr)}function er(or,ar,Wt,Zt,sr,tr,vr){return Yt(Wt^(ar|~Zt),or,ar,sr,tr,vr)}function pr(or,ar){var Wt=(65535&or)+(65535&ar);return(or>>16)+(ar>>16)+(Wt>>16)<<16|65535&Wt}it.exports=function(or){return Jt.hash(or,rr,16)}}).call(this,j("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},j("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],7:[function(j,it,et){(function(ut,dt,mt,yt,bt,Rt,jt,Vt,zt){var Jt;Jt=function(rr){for(var Yt,dr=new Array(rr),Ft=0;Ft<rr;Ft++)!(3&Ft)&&(Yt=4294967296*Math.random()),dr[Ft]=Yt>>>((3&Ft)<<3)&255;return dr},it.exports=Jt}).call(this,j("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},j("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],8:[function(j,it,et){(function(ut,dt,mt,yt,bt,Rt,jt,Vt,zt){var Jt=j("./helpers");function rr(Ft,Ht){Ft[Ht>>5]|=128<<24-Ht%32,Ft[15+(Ht+64>>9<<4)]=Ht;for(var er,pr,or,ar,Wt,Zt=Array(80),sr=1732584193,tr=-271733879,vr=-1732584194,Vr=271733878,hn=-1009589776,cn=0;cn<Ft.length;cn+=16){for(var gn=sr,tn=tr,Tn=vr,qr=Vr,nn=hn,yr=0;yr<80;yr++){Zt[yr]=yr<16?Ft[cn+yr]:dr(Zt[yr-3]^Zt[yr-8]^Zt[yr-14]^Zt[yr-16],1);var an=Yt(Yt(dr(sr,5),(or=tr,ar=vr,Wt=Vr,(pr=yr)<20?or&ar|~or&Wt:!(pr<40)&&pr<60?or&ar|or&Wt|ar&Wt:or^ar^Wt)),Yt(Yt(hn,Zt[yr]),(er=yr)<20?1518500249:er<40?1859775393:er<60?-1894007588:-899497514));hn=Vr,Vr=vr,vr=dr(tr,30),tr=sr,sr=an}sr=Yt(sr,gn),tr=Yt(tr,tn),vr=Yt(vr,Tn),Vr=Yt(Vr,qr),hn=Yt(hn,nn)}return Array(sr,tr,vr,Vr,hn)}function Yt(Ft,Ht){var er=(65535&Ft)+(65535&Ht);return(Ft>>16)+(Ht>>16)+(er>>16)<<16|65535&er}function dr(Ft,Ht){return Ft<<Ht|Ft>>>32-Ht}it.exports=function(Ft){return Jt.hash(Ft,rr,20,!0)}}).call(this,j("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},j("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],9:[function(j,it,et){(function(ut,dt,mt,yt,bt,Rt,jt,Vt,zt){function Jt(Ft,Ht){var er=(65535&Ft)+(65535&Ht);return(Ft>>16)+(Ht>>16)+(er>>16)<<16|65535&er}function rr(Ft,Ht){return Ft>>>Ht|Ft<<32-Ht}function Yt(Ft,Ht){var er,pr,or,ar,Wt,Zt,sr,tr,vr,Vr,hn=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),cn=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),gn=new Array(64);Ft[Ht>>5]|=128<<24-Ht%32,Ft[15+(Ht+64>>9<<4)]=Ht;for(var tn,Tn,qr,nn,yr,an,sn,Rn,Jr=0;Jr<Ft.length;Jr+=16){er=cn[0],pr=cn[1],or=cn[2],ar=cn[3],Wt=cn[4],Zt=cn[5],sr=cn[6],tr=cn[7];for(var mr=0;mr<64;mr++)gn[mr]=mr<16?Ft[mr+Jr]:Jt(Jt(Jt(rr(Rn=gn[mr-2],17)^rr(Rn,19)^Rn>>>10,gn[mr-7]),rr(sn=gn[mr-15],7)^rr(sn,18)^sn>>>3),gn[mr-16]),vr=Jt(Jt(Jt(Jt(tr,rr(an=Wt,6)^rr(an,11)^rr(an,25)),(yr=Wt)&Zt^~yr&sr),hn[mr]),gn[mr]),Vr=Jt(rr(nn=er,2)^rr(nn,13)^rr(nn,22),(tn=er)&(Tn=pr)^tn&(qr=or)^Tn&qr),tr=sr,sr=Zt,Zt=Wt,Wt=Jt(ar,vr),ar=or,or=pr,pr=er,er=Jt(vr,Vr);cn[0]=Jt(er,cn[0]),cn[1]=Jt(pr,cn[1]),cn[2]=Jt(or,cn[2]),cn[3]=Jt(ar,cn[3]),cn[4]=Jt(Wt,cn[4]),cn[5]=Jt(Zt,cn[5]),cn[6]=Jt(sr,cn[6]),cn[7]=Jt(tr,cn[7])}return cn}var dr=j("./helpers");it.exports=function(Ft){return dr.hash(Ft,Yt,32,!0)}}).call(this,j("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},j("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],10:[function(j,it,et){(function(ut,dt,mt,yt,bt,Rt,jt,Vt,zt){function Jt(){}(ut=it.exports={}).nextTick=function(){var rr=typeof window<"u"&&window.setImmediate,Yt=typeof window<"u"&&window.postMessage&&window.addEventListener;if(rr)return function(Ft){return window.setImmediate(Ft)};if(Yt){var dr=[];return window.addEventListener("message",function(Ft){var Ht=Ft.source;Ht!==window&&Ht!==null||Ft.data!=="process-tick"||(Ft.stopPropagation(),0<dr.length&&dr.shift()())},!0),function(Ft){dr.push(Ft),window.postMessage("process-tick","*")}}return function(Ft){setTimeout(Ft,0)}}(),ut.title="browser",ut.browser=!0,ut.env={},ut.argv=[],ut.on=Jt,ut.addListener=Jt,ut.once=Jt,ut.off=Jt,ut.removeListener=Jt,ut.removeAllListeners=Jt,ut.emit=Jt,ut.binding=function(rr){throw new Error("process.binding is not supported")},ut.cwd=function(){return"/"},ut.chdir=function(rr){throw new Error("process.chdir is not supported")}}).call(this,j("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},j("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:10}],11:[function(j,it,et){(function(ut,dt,mt,yt,bt,Rt,jt,Vt,zt){et.read=function(Jt,rr,Yt,dr,Ft){var Ht,er,pr=8*Ft-dr-1,or=(1<<pr)-1,ar=or>>1,Wt=-7,Zt=Yt?Ft-1:0,sr=Yt?-1:1,tr=Jt[rr+Zt];for(Zt+=sr,Ht=tr&(1<<-Wt)-1,tr>>=-Wt,Wt+=pr;0<Wt;Ht=256*Ht+Jt[rr+Zt],Zt+=sr,Wt-=8);for(er=Ht&(1<<-Wt)-1,Ht>>=-Wt,Wt+=dr;0<Wt;er=256*er+Jt[rr+Zt],Zt+=sr,Wt-=8);if(Ht===0)Ht=1-ar;else{if(Ht===or)return er?NaN:1/0*(tr?-1:1);er+=Math.pow(2,dr),Ht-=ar}return(tr?-1:1)*er*Math.pow(2,Ht-dr)},et.write=function(Jt,rr,Yt,dr,Ft,Ht){var er,pr,or,ar=8*Ht-Ft-1,Wt=(1<<ar)-1,Zt=Wt>>1,sr=Ft===23?Math.pow(2,-24)-Math.pow(2,-77):0,tr=dr?0:Ht-1,vr=dr?1:-1,Vr=rr<0||rr===0&&1/rr<0?1:0;for(rr=Math.abs(rr),isNaN(rr)||rr===1/0?(pr=isNaN(rr)?1:0,er=Wt):(er=Math.floor(Math.log(rr)/Math.LN2),rr*(or=Math.pow(2,-er))<1&&(er--,or*=2),2<=(rr+=1<=er+Zt?sr/or:sr*Math.pow(2,1-Zt))*or&&(er++,or/=2),Wt<=er+Zt?(pr=0,er=Wt):1<=er+Zt?(pr=(rr*or-1)*Math.pow(2,Ft),er+=Zt):(pr=rr*Math.pow(2,Zt-1)*Math.pow(2,Ft),er=0));8<=Ft;Jt[Yt+tr]=255&pr,tr+=vr,pr/=256,Ft-=8);for(er=er<<Ft|pr,ar+=Ft;0<ar;Jt[Yt+tr]=255&er,tr+=vr,er/=256,ar-=8);Jt[Yt+tr-vr]|=128*Vr}}).call(this,j("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},j("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/ieee754/index.js","/node_modules/ieee754")},{buffer:3,lYpoI2:10}]},{},[1])(1)},654:function($){var j=function(){function it(Yt){return jt(Yt,Vt(Rt(zt(Yt.length),Yt),1/Yt.length))}function et(Yt){return Rt(Jt(Yt),Yt)}function ut(Yt,dr){return Vt(Yt,dr?1/(Yt.length-1):1/Yt.length)}function dt(Yt){var dr=function(Ht){var er,pr=Math.pow(2,-52),or=1e-64/pr,ar=0,Wt=0,Zt=0,sr=0,tr=0,vr=rr(Ht),Vr=vr.length,hn=vr[0].length;if(Vr<hn)throw"Need more rows than columns";var cn=new Array(hn),gn=new Array(hn);for(Wt=0;Wt<hn;Wt++)cn[Wt]=gn[Wt]=0;var tn=function On($n,jn,As){As===void 0&&(As=0);var ps,qs=$n[As],Vs=Array(qs);if(As===$n.length-1){for(ps=qs-2;ps>=0;ps-=2)Vs[ps+1]=jn,Vs[ps]=jn;return ps===-1&&(Vs[0]=jn),Vs}for(ps=qs-1;ps>=0;ps--)Vs[ps]=On($n,jn,As+1);return Vs}([hn,hn],0);function Tn(On,$n){return(On=Math.abs(On))>($n=Math.abs($n))?On*Math.sqrt(1+$n*$n/On/On):$n==0?On:$n*Math.sqrt(1+On*On/$n/$n)}var qr=0,nn=0,yr=0,an=0,sn=0,Rn=0,Jr=0;for(Wt=0;Wt<hn;Wt++){for(cn[Wt]=nn,Jr=0,tr=Wt+1,Zt=Wt;Zt<Vr;Zt++)Jr+=vr[Zt][Wt]*vr[Zt][Wt];if(Jr<=or)nn=0;else for(qr=vr[Wt][Wt],nn=Math.sqrt(Jr),qr>=0&&(nn=-nn),yr=qr*nn-Jr,vr[Wt][Wt]=qr-nn,Zt=tr;Zt<hn;Zt++){for(Jr=0,sr=Wt;sr<Vr;sr++)Jr+=vr[sr][Wt]*vr[sr][Zt];for(qr=Jr/yr,sr=Wt;sr<Vr;sr++)vr[sr][Zt]+=qr*vr[sr][Wt]}for(gn[Wt]=nn,Jr=0,Zt=tr;Zt<hn;Zt++)Jr+=vr[Wt][Zt]*vr[Wt][Zt];if(Jr<=or)nn=0;else{for(qr=vr[Wt][Wt+1],nn=Math.sqrt(Jr),qr>=0&&(nn=-nn),yr=qr*nn-Jr,vr[Wt][Wt+1]=qr-nn,Zt=tr;Zt<hn;Zt++)cn[Zt]=vr[Wt][Zt]/yr;for(Zt=tr;Zt<Vr;Zt++){for(Jr=0,sr=tr;sr<hn;sr++)Jr+=vr[Zt][sr]*vr[Wt][sr];for(sr=tr;sr<hn;sr++)vr[Zt][sr]+=Jr*cn[sr]}}(sn=Math.abs(gn[Wt])+Math.abs(cn[Wt]))>an&&(an=sn)}for(Wt=hn-1;Wt!=-1;Wt+=-1){if(nn!=0){for(yr=nn*vr[Wt][Wt+1],Zt=tr;Zt<hn;Zt++)tn[Zt][Wt]=vr[Wt][Zt]/yr;for(Zt=tr;Zt<hn;Zt++){for(Jr=0,sr=tr;sr<hn;sr++)Jr+=vr[Wt][sr]*tn[sr][Zt];for(sr=tr;sr<hn;sr++)tn[sr][Zt]+=Jr*tn[sr][Wt]}}for(Zt=tr;Zt<hn;Zt++)tn[Wt][Zt]=0,tn[Zt][Wt]=0;tn[Wt][Wt]=1,nn=cn[Wt],tr=Wt}for(Wt=hn-1;Wt!=-1;Wt+=-1){for(tr=Wt+1,nn=gn[Wt],Zt=tr;Zt<hn;Zt++)vr[Wt][Zt]=0;if(nn!=0){for(yr=vr[Wt][Wt]*nn,Zt=tr;Zt<hn;Zt++){for(Jr=0,sr=tr;sr<Vr;sr++)Jr+=vr[sr][Wt]*vr[sr][Zt];for(qr=Jr/yr,sr=Wt;sr<Vr;sr++)vr[sr][Zt]+=qr*vr[sr][Wt]}for(Zt=Wt;Zt<Vr;Zt++)vr[Zt][Wt]=vr[Zt][Wt]/nn}else for(Zt=Wt;Zt<Vr;Zt++)vr[Zt][Wt]=0;vr[Wt][Wt]+=1}for(pr*=an,sr=hn-1;sr!=-1;sr+=-1)for(var mr=0;mr<50;mr++){var Ar=!1;for(tr=sr;tr!=-1;tr+=-1){if(Math.abs(cn[tr])<=pr){Ar=!0;break}if(Math.abs(gn[tr-1])<=pr)break}if(!Ar){ar=0,Jr=1;var jr=tr-1;for(Wt=tr;Wt<sr+1&&(qr=Jr*cn[Wt],cn[Wt]=ar*cn[Wt],!(Math.abs(qr)<=pr));Wt++)for(yr=Tn(qr,nn=gn[Wt]),gn[Wt]=yr,ar=nn/yr,Jr=-qr/yr,Zt=0;Zt<Vr;Zt++)sn=vr[Zt][jr],Rn=vr[Zt][Wt],vr[Zt][jr]=sn*ar+Rn*Jr,vr[Zt][Wt]=-sn*Jr+Rn*ar}if(Rn=gn[sr],tr==sr){if(Rn<0)for(gn[sr]=-Rn,Zt=0;Zt<hn;Zt++)tn[Zt][sr]=-tn[Zt][sr];break}if(mr>=49)throw"Error: no convergence.";for(an=gn[tr],nn=Tn(qr=(((sn=gn[sr-1])-Rn)*(sn+Rn)+((nn=cn[sr-1])-(yr=cn[sr]))*(nn+yr))/(2*yr*sn),1),qr=qr<0?((an-Rn)*(an+Rn)+yr*(sn/(qr-nn)-yr))/an:((an-Rn)*(an+Rn)+yr*(sn/(qr+nn)-yr))/an,ar=1,Jr=1,Wt=tr+1;Wt<sr+1;Wt++){for(nn=cn[Wt],sn=gn[Wt],yr=Jr*nn,nn*=ar,Rn=Tn(qr,yr),cn[Wt-1]=Rn,qr=an*(ar=qr/Rn)+nn*(Jr=yr/Rn),nn=-an*Jr+nn*ar,yr=sn*Jr,sn*=ar,Zt=0;Zt<hn;Zt++)an=tn[Zt][Wt-1],Rn=tn[Zt][Wt],tn[Zt][Wt-1]=an*ar+Rn*Jr,tn[Zt][Wt]=-an*Jr+Rn*ar;for(Rn=Tn(qr,yr),gn[Wt-1]=Rn,qr=(ar=qr/Rn)*nn+(Jr=yr/Rn)*sn,an=-Jr*nn+ar*sn,Zt=0;Zt<Vr;Zt++)sn=vr[Zt][Wt-1],Rn=vr[Zt][Wt],vr[Zt][Wt-1]=sn*ar+Rn*Jr,vr[Zt][Wt]=-sn*Jr+Rn*ar}cn[tr]=0,cn[sr]=qr,gn[sr]=an}for(Wt=0;Wt<gn.length;Wt++)gn[Wt]<pr&&(gn[Wt]=0);for(Wt=0;Wt<hn;Wt++)for(Zt=Wt-1;Zt>=0;Zt--)if(gn[Zt]<gn[Wt]){for(ar=gn[Zt],gn[Zt]=gn[Wt],gn[Wt]=ar,sr=0;sr<vr.length;sr++)er=vr[sr][Wt],vr[sr][Wt]=vr[sr][Zt],vr[sr][Zt]=er;for(sr=0;sr<tn.length;sr++)er=tn[sr][Wt],tn[sr][Wt]=tn[sr][Zt],tn[sr][Zt]=er;Wt=Zt}return{U:vr,S:gn,V:tn}}(Yt);console.log(dr);var Ft=dr.U;return dr.S.map(function(Ht,er){var pr={};return pr.eigenvalue=Ht,pr.vector=Ft.map(function(or,ar){return-1*or[er]}),pr})}function mt(Yt,...dr){var Ft=dr.map(function(pr){return pr.vector}),Ht=Rt(Ft,Jt(it(Yt))),er=Vt(Rt(zt(Yt.length),Yt),-1/Yt.length);return{adjustedData:Ht,formattedAdjustedData:bt(Ht,2),avgData:er,selectedVectors:Ft}}function yt(Yt){return dt(ut(et(it(Yt)),!1))}function bt(Yt,dr){var Ft=Math.pow(10,dr||2);return Yt.map(function(Ht,er){return Ht.map(function(pr){return Math.round(pr*Ft)/Ft})})}function Rt(Yt,dr){if(!(Yt[0]&&dr[0]&&Yt.length&&dr.length))throw new Error("Both A and B should be matrices");if(dr.length!==Yt[0].length)throw new Error("Columns in A should be the same as the number of rows in B");for(var Ft=[],Ht=0;Ht<Yt.length;Ht++){Ft[Ht]=[];for(var er=0;er<dr[0].length;er++)for(var pr=0;pr<Yt[0].length;pr++)Ft[Ht][er]=Ft[Ht][er]?Ft[Ht][er]+Yt[Ht][pr]*dr[pr][er]:Yt[Ht][pr]*dr[pr][er]}return Ft}function jt(Yt,dr){if(Yt.length!==dr.length||Yt[0].length!==dr[0].length)throw new Error("Both A and B should have the same dimensions");for(var Ft=[],Ht=0;Ht<Yt.length;Ht++){Ft[Ht]=[];for(var er=0;er<dr[0].length;er++)Ft[Ht][er]=Yt[Ht][er]-dr[Ht][er]}return Ft}function Vt(Yt,dr){for(var Ft=[],Ht=0;Ht<Yt.length;Ht++){Ft[Ht]=[];for(var er=0;er<Yt[0].length;er++)Ft[Ht][er]=Yt[Ht][er]*dr}return Ft}function zt(Yt){for(var dr=[],Ft=0;Ft<Yt;Ft++){dr[Ft]=[];for(var Ht=0;Ht<Yt;Ht++)dr[Ft][Ht]=1}return dr}function Jt(Yt){return rr(Yt)[0].map(function(dr,Ft){return Yt.map(function(Ht){return Ht[Ft]})})}function rr(Yt){var dr=JSON.stringify(Yt);return JSON.parse(dr)}return{computeDeviationScores:et,computeDeviationMatrix:it,computeSVD:dt,computePercentageExplained:function(Yt,...dr){var Ft=Yt.map(function(Ht){return Ht.eigenvalue}).reduce(function(Ht,er){return Ht+er});return dr.map(function(Ht){return Ht.eigenvalue}).reduce(function(Ht,er){return Ht+er})/Ft},computeOriginalData:function(Yt,dr,Ft){var Ht=jt(Jt(Rt(Jt(dr),Yt)),Ft);return{originalData:Ht,formattedOriginalData:bt(Ht,2)}},computeVarianceCovariance:ut,computeAdjustedData:mt,getEigenVectors:yt,analyseTopResult:function(Yt){var dr=yt(Yt).sort(function(Ft,Ht){return Ht.eigenvalue-Ft.eigenvalue});return console.log("Sorted Vectors",dr),mt(Yt,dr[0].vector)},transpose:Jt,multiply:Rt,clone:rr,scale:Vt}}();$.exports=j},701:function($){var j=[];function it(dt){for(var mt=-1,yt=0;yt<j.length;yt++)if(j[yt].identifier===dt){mt=yt;break}return mt}function et(dt,mt){for(var yt={},bt=[],Rt=0;Rt<dt.length;Rt++){var jt=dt[Rt],Vt=mt.base?jt[0]+mt.base:jt[0],zt=yt[Vt]||0,Jt="".concat(Vt," ").concat(zt);yt[Vt]=zt+1;var rr=it(Jt),Yt={css:jt[1],media:jt[2],sourceMap:jt[3],supports:jt[4],layer:jt[5]};if(rr!==-1)j[rr].references++,j[rr].updater(Yt);else{var dr=ut(Yt,mt);mt.byIndex=Rt,j.splice(Rt,0,{identifier:Jt,updater:dr,references:1})}bt.push(Jt)}return bt}function ut(dt,mt){var yt=mt.domAPI(mt);return yt.update(dt),function(bt){if(bt){if(bt.css===dt.css&&bt.media===dt.media&&bt.sourceMap===dt.sourceMap&&bt.supports===dt.supports&&bt.layer===dt.layer)return;yt.update(dt=bt)}else yt.remove()}}$.exports=function(dt,mt){var yt=et(dt=dt||[],mt=mt||{});return function(bt){bt=bt||[];for(var Rt=0;Rt<yt.length;Rt++){var jt=it(yt[Rt]);j[jt].references--}for(var Vt=et(bt,mt),zt=0;zt<yt.length;zt++){var Jt=it(yt[zt]);j[Jt].references===0&&(j[Jt].updater(),j.splice(Jt,1))}yt=Vt}}},182:function($){$.exports=function(j){var it=document.createElement("style");return j.setAttributes(it,j.attributes),j.insert(it,j.options),it}},850:function($,j,it){$.exports=function(et){var ut=it.nc;ut&&et.setAttribute("nonce",ut)}},236:function($){$.exports=function(j){var it=j.insertStyleElement(j);return{update:function(et){(function(ut,dt,mt){var yt="";mt.supports&&(yt+="@supports (".concat(mt.supports,") {")),mt.media&&(yt+="@media ".concat(mt.media," {"));var bt=mt.layer!==void 0;bt&&(yt+="@layer".concat(mt.layer.length>0?" ".concat(mt.layer):""," {")),yt+=mt.css,bt&&(yt+="}"),mt.media&&(yt+="}"),mt.supports&&(yt+="}");var Rt=mt.sourceMap;Rt&&typeof btoa<"u"&&(yt+=`
/`,yt+="*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(Rt))))," *"),yt+="/"),dt.styleTagTransform(yt,ut,dt.options)})(it,j,et)},remove:function(){(function(et){if(et.parentNode===null)return!1;et.parentNode.removeChild(et)})(it)}}}},213:function($){$.exports=function(j,it){if(it.styleSheet)it.styleSheet.cssText=j;else{for(;it.firstChild;)it.removeChild(it.firstChild);it.appendChild(document.createTextNode(j))}}},1:function($){$.exports=function(){var j={820:function(dt,mt,yt){var bt=yt(537),Rt=yt.n(bt),jt=yt(645),Vt=yt.n(jt)()(Rt());Vt.push([dt.id,`.treejs {
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  font-size: 14px;
  margin-left: -18px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.treejs *:after,
.treejs *:before {
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
}
.treejs > .treejs-node {
  padding-left: 0;
}
.treejs .treejs-nodes {
  list-style: none;
  padding-left: 18px;
  margin: 0;
  overflow: hidden;
  -webkit-transition: height 150ms ease-out, opacity 150ms ease-out;
  -o-transition: height 150ms ease-out, opacity 150ms ease-out;
  transition: height 150ms ease-out, opacity 150ms ease-out;
}
.treejs .treejs-node {
  cursor: pointer;
  overflow: hidden;
}
.treejs .treejs-node.treejs-placeholder {
  padding-left: 18px;
}
.treejs .treejs-switcher {
  display: inline-block;
  vertical-align: middle;
  width: 20px;
  height: 20px;
  cursor: pointer;
  position: relative;
  -webkit-transition: -webkit-transform 150ms ease-out;
  transition: -webkit-transform 150ms ease-out;
  -o-transition: transform 150ms ease-out;
  transition: transform 150ms ease-out;
  transition: transform 150ms ease-out, -webkit-transform 150ms ease-out;
}
.treejs .treejs-switcher:before {
  position: absolute;
  top: 8px;
  left: 6px;
  display: block;
  content: ' ';
  border: 4px solid transparent;
  border-top: 4px solid rgba(245, 245, 245, 0.7);
  -webkit-transition: border-color 150ms;
  -o-transition: border-color 150ms;
  transition: border-color 150ms;
}
.treejs .treejs-switcher:hover:before {
  border-top: 4px solid rgba(245, 245, 245, 0.96);
}
.treejs .treejs-node__close > .treejs-switcher {
  -webkit-transform: rotate(-90deg);
      -ms-transform: rotate(-90deg);
          transform: rotate(-90deg);
}
.treejs .treejs-node__close > .treejs-nodes {
  height: 0;
}
.treejs .treejs-checkbox {
  display: inline-block;
  vertical-align: middle;
  width: 20px;
  height: 20px;
  cursor: pointer;
  position: relative;
}
.treejs .treejs-checkbox:before {
  -webkit-transition: all 0.3s;
  -o-transition: all 0.3s;
  transition: all 0.3s;
  cursor: pointer;
  position: absolute;
  top: 2px;
  content: ' ';
  display: block;
  width: 16px;
  height: 16px;
  border: 1px solid #d9d9d9;
  border-radius: 2px;
}
.treejs .treejs-checkbox:hover:before {
  -webkit-box-shadow: 0 0 2px 1px #1890ff;
          box-shadow: 0 0 2px 1px #1890ff;
}
.treejs .treejs-node__checked > .treejs-checkbox:before {
  background-color: #1890ff;
  border-color: #1890ff;
}
.treejs .treejs-node__checked > .treejs-checkbox:after {
  position: absolute;
  content: ' ';
  display: block;
  top: 4px;
  left: 5px;
  width: 5px;
  height: 9px;
  border: 2px solid #fff;
  border-top: none;
  border-left: none;
  -webkit-transform: rotate(45deg);
      -ms-transform: rotate(45deg);
          transform: rotate(45deg);
}
.treejs .treejs-node__halfchecked > .treejs-checkbox:before {
  background-color: #1890ff;
  border-color: #1890ff;
}
.treejs .treejs-node__halfchecked > .treejs-checkbox:after {
  position: absolute;
  content: ' ';
  display: block;
  top: 9px;
  left: 3px;
  width: 10px;
  height: 2px;
  background-color: #fff;
}
.treejs .treejs-node__disabled {
  cursor: not-allowed;
  color: rgba(255, 255, 255, 0.25);
}
.treejs .treejs-node__disabled .treejs-checkbox {
  cursor: not-allowed;
}
.treejs .treejs-node__disabled .treejs-checkbox:before {
  cursor: not-allowed;
  border-color: #d9d9d9 !important;
  background-color: #f5f5f5 !important;
}
.treejs .treejs-node__disabled .treejs-checkbox:hover:before {
  -webkit-box-shadow: none !important;
          box-shadow: none !important;
}
.treejs .treejs-node__disabled .treejs-node__checked > .treejs-checkbox:after {
  border-color: #d9d9d9;
}
.treejs .treejs-node__disabled .treejs-node__halfchecked > .treejs-checkbox:after {
  background-color: #d9d9d9;
}
.treejs .treejs-node__disabled.treejs-node__checked > .treejs-checkbox:after {
  border-color: #d9d9d9;
}
.treejs .treejs-node__disabled.treejs-node__halfchecked > .treejs-checkbox:after {
  background-color: #d9d9d9;
}
.treejs .treejs-label {
  vertical-align: middle;
}
`,"",{version:3,sources:["webpack://./src/index.less"],names:[],mappings:"AAKA;EACE,8BAAA;UAAA,sBAAA;EACA,eAAA;EACA,kBAAA;EACA,yBAAA;KAAA,sBAAA;MAAA,qBAAA;UAAA,iBAAA;AAJF;AAAA;;EAQI,8BAAA;UAAA,sBAAA;AAJJ;AAOE;EACE,eAAA;AALJ;AAPA;EAgBI,gBAAA;EACA,kBAAA;EACA,SAAA;EACA,gBAAA;EACA,iEAAA;EAAA,4DAAA;EAAA,yDAAA;AANJ;AAdA;EAwBI,eAAA;EACA,gBAAA;AAPJ;AASI;EACE,kBAAA;AAPN;AArBA;EAiCI,qBAAA;EACA,sBAAA;EACA,WAAA;EACA,YAAA;EACA,eAAA;EACA,kBAAA;EACA,oDAAA;EAAA,4CAAA;EAAA,uCAAA;EAAA,oCAAA;EAAA,sEAAA;AATJ;AAWI;EACE,kBAAA;EACA,QAAA;EACA,SAAA;EACA,cAAA;EACA,YAAA;EACA,6BAAA;EACA,8CAAA;EACA,sCAAA;EAAA,iCAAA;EAAA,8BAAA;AATN;AAWI;EACE,+CAAA;AATN;AA3CA;EAwDI,iCAAA;MAAA,6BAAA;UAAA,yBAAA;AAVJ;AA9CA;EA2DI,SAAA;AAVJ;AAjDA;EA+DI,qBAAA;EACA,sBAAA;EACA,WAAA;EACA,YAAA;EACA,eAAA;EACA,kBAAA;AAXJ;AAaI;EACE,4BAAA;EAAA,uBAAA;EAAA,oBAAA;EACA,eAAA;EACA,kBAAA;EACA,QAAA;EACA,YAAA;EACA,cAAA;EACA,WAAA;EACA,YAAA;EACA,yBAAA;EACA,kBAAA;AAXN;AAaI;EACE,uCAAA;UAAA,+BAAA;AAXN;AAgBM;EACE,yBAAA;EACA,qBAAA;AAdR;AAgBM;EACE,kBAAA;EACA,YAAA;EACA,cAAA;EACA,QAAA;EACA,SAAA;EACA,UAAA;EACA,WAAA;EACA,sBAAA;EACA,gBAAA;EACA,iBAAA;EACA,gCAAA;MAAA,4BAAA;UAAA,wBAAA;AAdR;AAoBM;EACE,yBAAA;EACA,qBAAA;AAlBR;AAoBM;EACE,kBAAA;EACA,YAAA;EACA,cAAA;EACA,QAAA;EACA,SAAA;EACA,WAAA;EACA,WAAA;EACA,sBAAA;AAlBR;AAvGA;EA+HI,mBAAA;EACA,gCAAA;AArBJ;AA3GA;EAkIM,mBAAA;AApBN;AAqBM;EACE,mBAAA;EACA,gCAAA;EACA,oCAAA;AAnBR;AAqBM;EACE,mCAAA;UAAA,2BAAA;AAnBR;AAwBQ;EACE,qBAAA;AAtBV;AA4BQ;EACE,yBAAA;AA1BV;AAiCM;EACE,qBAAA;AA/BR;AAqCM;EACE,yBAAA;AAnCR;AAlIA;EA2KI,sBAAA;AAtCJ",sourcesContent:[`@color-disable: #d4d4d4;
@bgcolor-disable: #f5f5f5;
@greyborder: #d9d9d9;
@bluebg: #1890ff;

.treejs {
  box-sizing: border-box;
  font-size: 14px;
  margin-left: -18px;
  user-select: none;

  *:after,
  *:before {
    box-sizing: border-box;
  }

  & > .treejs-node {
    padding-left: 0;
  }

  .treejs-nodes {
    list-style: none;
    padding-left: 18px;
    margin: 0; //  for default ul...
    overflow: hidden;
    transition: height 150ms ease-out, opacity 150ms ease-out;
  }

  .treejs-node {
    cursor: pointer;
    overflow: hidden;

    &.treejs-placeholder {
      padding-left: 18px;
    }
  }

  .treejs-switcher {
    display: inline-block;
    vertical-align: middle;
    width: 20px;
    height: 20px;
    cursor: pointer;
    position: relative;
    transition: transform 150ms ease-out;

    &:before {
      position: absolute;
      top: 8px;
      left: 6px;
      display: block;
      content: ' ';
      border: 4px solid transparent;
      border-top: 4px solid rgba(245, 245, 245, 0.7);
      transition: border-color 150ms;
    }
    &:hover:before {
      border-top: 4px solid rgba(245, 245, 245, 0.96);
    }
  }
  .treejs-node__close > .treejs-switcher {
    transform: rotate(-90deg);
  }
  .treejs-node__close > .treejs-nodes {
    height: 0;
  }

  .treejs-checkbox {
    display: inline-block;
    vertical-align: middle;
    width: 20px;
    height: 20px;
    cursor: pointer;
    position: relative;

    &:before {
      transition: all 0.3s;
      cursor: pointer;
      position: absolute;
      top: 2px;
      content: ' ';
      display: block;
      width: 16px;
      height: 16px;
      border: 1px solid @greyborder;
      border-radius: 2px;
    }
    &:hover:before {
      box-shadow: 0 0 2px 1px @bluebg;
    }
  }
  .treejs-node__checked {
    & > .treejs-checkbox {
      &:before {
        background-color: @bluebg;
        border-color: @bluebg;
      }
      &:after {
        position: absolute;
        content: ' ';
        display: block;
        top: 4px;
        left: 5px;
        width: 5px;
        height: 9px;
        border: 2px solid #fff;
        border-top: none;
        border-left: none;
        transform: rotate(45deg);
      }
    }
  }
  .treejs-node__halfchecked {
    & > .treejs-checkbox {
      &:before {
        background-color: @bluebg;
        border-color: @bluebg;
      }
      &:after {
        position: absolute;
        content: ' ';
        display: block;
        top: 9px;
        left: 3px;
        width: 10px;
        height: 2px;
        background-color: #fff;
      }
    }
  }

  .treejs-node__disabled {
    cursor: not-allowed;
    color: rgba(255, 255, 255, 0.25);
    .treejs-checkbox {
      cursor: not-allowed;
      &:before {
        cursor: not-allowed;
        border-color: @greyborder !important;
        background-color: @bgcolor-disable !important;
      }
      &:hover:before {
        box-shadow: none !important;
      }
    }
    .treejs-node__checked {
      & > .treejs-checkbox {
        &:after {
          border-color: @greyborder;
        }
      }
    }
    .treejs-node__halfchecked {
      & > .treejs-checkbox {
        &:after {
          background-color: @greyborder;
        }
      }
    }
  }
  .treejs-node__disabled.treejs-node__checked {
    & > .treejs-checkbox {
      &:after {
        border-color: @greyborder;
      }
    }
  }
  .treejs-node__disabled.treejs-node__halfchecked {
    & > .treejs-checkbox {
      &:after {
        background-color: @greyborder;
      }
    }
  }

  .treejs-label {
    vertical-align: middle;
  }
}
`],sourceRoot:""}]),mt.Z=Vt},645:function(dt){dt.exports=function(mt){var yt=[];return yt.toString=function(){return this.map(function(bt){var Rt="",jt=bt[5]!==void 0;return bt[4]&&(Rt+="@supports (".concat(bt[4],") {")),bt[2]&&(Rt+="@media ".concat(bt[2]," {")),jt&&(Rt+="@layer".concat(bt[5].length>0?" ".concat(bt[5]):""," {")),Rt+=mt(bt),jt&&(Rt+="}"),bt[2]&&(Rt+="}"),bt[4]&&(Rt+="}"),Rt}).join("")},yt.i=function(bt,Rt,jt,Vt,zt){typeof bt=="string"&&(bt=[[null,bt,void 0]]);var Jt={};if(jt)for(var rr=0;rr<this.length;rr++){var Yt=this[rr][0];Yt!=null&&(Jt[Yt]=!0)}for(var dr=0;dr<bt.length;dr++){var Ft=[].concat(bt[dr]);jt&&Jt[Ft[0]]||(zt!==void 0&&(Ft[5]===void 0||(Ft[1]="@layer".concat(Ft[5].length>0?" ".concat(Ft[5]):""," {").concat(Ft[1],"}")),Ft[5]=zt),Rt&&(Ft[2]&&(Ft[1]="@media ".concat(Ft[2]," {").concat(Ft[1],"}")),Ft[2]=Rt),Vt&&(Ft[4]?(Ft[1]="@supports (".concat(Ft[4],") {").concat(Ft[1],"}"),Ft[4]=Vt):Ft[4]="".concat(Vt)),yt.push(Ft))}},yt}},537:function(dt){dt.exports=function(mt){var yt=mt[1],bt=mt[3];if(!bt)return yt;if(typeof btoa=="function"){var Rt=btoa(unescape(encodeURIComponent(JSON.stringify(bt)))),jt="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(Rt),Vt="/*# ".concat(jt," */"),zt=bt.sources.map(function(Jt){return"/*# sourceURL=".concat(bt.sourceRoot||"").concat(Jt," */")});return[yt].concat(zt).concat([Vt]).join(`
`)}return[yt].join(`
`)}},379:function(dt){var mt=[];function yt(jt){for(var Vt=-1,zt=0;zt<mt.length;zt++)if(mt[zt].identifier===jt){Vt=zt;break}return Vt}function bt(jt,Vt){for(var zt={},Jt=[],rr=0;rr<jt.length;rr++){var Yt=jt[rr],dr=Vt.base?Yt[0]+Vt.base:Yt[0],Ft=zt[dr]||0,Ht="".concat(dr," ").concat(Ft);zt[dr]=Ft+1;var er=yt(Ht),pr={css:Yt[1],media:Yt[2],sourceMap:Yt[3],supports:Yt[4],layer:Yt[5]};if(er!==-1)mt[er].references++,mt[er].updater(pr);else{var or=Rt(pr,Vt);Vt.byIndex=rr,mt.splice(rr,0,{identifier:Ht,updater:or,references:1})}Jt.push(Ht)}return Jt}function Rt(jt,Vt){var zt=Vt.domAPI(Vt);return zt.update(jt),function(Jt){if(Jt){if(Jt.css===jt.css&&Jt.media===jt.media&&Jt.sourceMap===jt.sourceMap&&Jt.supports===jt.supports&&Jt.layer===jt.layer)return;zt.update(jt=Jt)}else zt.remove()}}dt.exports=function(jt,Vt){var zt=bt(jt=jt||[],Vt=Vt||{});return function(Jt){Jt=Jt||[];for(var rr=0;rr<zt.length;rr++){var Yt=yt(zt[rr]);mt[Yt].references--}for(var dr=bt(Jt,Vt),Ft=0;Ft<zt.length;Ft++){var Ht=yt(zt[Ft]);mt[Ht].references===0&&(mt[Ht].updater(),mt.splice(Ht,1))}zt=dr}}},216:function(dt){dt.exports=function(mt){var yt=document.createElement("style");return mt.setAttributes(yt,mt.attributes),mt.insert(yt,mt.options),yt}},636:function(dt,mt,yt){dt.exports=function(bt){var Rt=yt.nc;Rt&&bt.setAttribute("nonce",Rt)}},795:function(dt){dt.exports=function(mt){var yt=mt.insertStyleElement(mt);return{update:function(bt){(function(Rt,jt,Vt){var zt="";Vt.supports&&(zt+="@supports (".concat(Vt.supports,") {")),Vt.media&&(zt+="@media ".concat(Vt.media," {"));var Jt=Vt.layer!==void 0;Jt&&(zt+="@layer".concat(Vt.layer.length>0?" ".concat(Vt.layer):""," {")),zt+=Vt.css,Jt&&(zt+="}"),Vt.media&&(zt+="}"),Vt.supports&&(zt+="}");var rr=Vt.sourceMap;rr&&typeof btoa<"u"&&(zt+=`
/`,zt+="*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(rr))))," *"),zt+="/"),jt.styleTagTransform(zt,Rt,jt.options)})(yt,mt,bt)},remove:function(){(function(bt){if(bt.parentNode===null)return!1;bt.parentNode.removeChild(bt)})(yt)}}}},589:function(dt){dt.exports=function(mt,yt){if(yt.styleSheet)yt.styleSheet.cssText=mt;else{for(;yt.firstChild;)yt.removeChild(yt.firstChild);yt.appendChild(document.createTextNode(mt))}}}},it={};function et(dt){var mt=it[dt];if(mt!==void 0)return mt.exports;var yt=it[dt]={id:dt,exports:{}};return j[dt](yt,yt.exports,et),yt.exports}et.n=function(dt){var mt=dt&&dt.__esModule?function(){return dt.default}:function(){return dt};return et.d(mt,{a:mt}),mt},et.d=function(dt,mt){for(var yt in mt)et.o(mt,yt)&&!et.o(dt,yt)&&Object.defineProperty(dt,yt,{enumerable:!0,get:mt[yt]})},et.o=function(dt,mt){return Object.prototype.hasOwnProperty.call(dt,mt)},et.nc=void 0;var ut={};return function(){et.d(ut,{default:function(){return gn}});var dt=et(379),mt=et.n(dt),yt=et(795),bt=et.n(yt),Rt=et(636),jt=et.n(Rt),Vt=et(216),zt=et.n(Vt),Jt=et(589),rr=et.n(Jt),Yt=et(820),dr={};Yt.Z&&Yt.Z.locals&&(dr.locals=Yt.Z.locals);var Ft,Ht=0,er={};er.styleTagTransform=rr(),er.setAttributes=jt(),er.insert=function(tn,Tn){(Tn.target||document.head).appendChild(tn)},er.domAPI=bt(),er.insertStyleElement=zt(),dr.use=function(tn){return er.options=tn||{},Ht++||(Ft=mt()(Yt.Z,er)),dr},dr.unuse=function(){Ht>0&&!--Ht&&(Ft(),Ft=null)};var pr=dr;function or(tn,Tn){return function(qr){if(Array.isArray(qr))return qr}(tn)||function(qr,nn){var yr=qr==null?null:typeof Symbol<"u"&&qr[Symbol.iterator]||qr["@@iterator"];if(yr!=null){var an,sn,Rn=[],Jr=!0,mr=!1;try{for(yr=yr.call(qr);!(Jr=(an=yr.next()).done)&&(Rn.push(an.value),!nn||Rn.length!==nn);Jr=!0);}catch(Ar){mr=!0,sn=Ar}finally{try{Jr||yr.return==null||yr.return()}finally{if(mr)throw sn}}return Rn}}(tn,Tn)||function(qr,nn){if(qr){if(typeof qr=="string")return ar(qr,nn);var yr=Object.prototype.toString.call(qr).slice(8,-1);return yr==="Object"&&qr.constructor&&(yr=qr.constructor.name),yr==="Map"||yr==="Set"?Array.from(qr):yr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(yr)?ar(qr,nn):void 0}}(tn,Tn)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ar(tn,Tn){(Tn==null||Tn>tn.length)&&(Tn=tn.length);for(var qr=0,nn=new Array(Tn);qr<Tn;qr++)nn[qr]=tn[qr];return nn}function Wt(tn,Tn){var qr=Object.keys(tn);if(Object.getOwnPropertySymbols){var nn=Object.getOwnPropertySymbols(tn);Tn&&(nn=nn.filter(function(yr){return Object.getOwnPropertyDescriptor(tn,yr).enumerable})),qr.push.apply(qr,nn)}return qr}function Zt(tn){for(var Tn=1;Tn<arguments.length;Tn++){var qr=arguments[Tn]!=null?arguments[Tn]:{};Tn%2?Wt(Object(qr),!0).forEach(function(nn){sr(tn,nn,qr[nn])}):Object.getOwnPropertyDescriptors?Object.defineProperties(tn,Object.getOwnPropertyDescriptors(qr)):Wt(Object(qr)).forEach(function(nn){Object.defineProperty(tn,nn,Object.getOwnPropertyDescriptor(qr,nn))})}return tn}function sr(tn,Tn,qr){return Tn in tn?Object.defineProperty(tn,Tn,{value:qr,enumerable:!0,configurable:!0,writable:!0}):tn[Tn]=qr,tn}function tr(tn,Tn){for(var qr=0;qr<Tn.length;qr++){var nn=Tn[qr];nn.enumerable=nn.enumerable||!1,nn.configurable=!0,"value"in nn&&(nn.writable=!0),Object.defineProperty(tn,nn.key,nn)}}function vr(tn){var Tn={};return tn.reduce(function(qr,nn){return Tn[nn]||(Tn[nn]=!0,qr.push(nn)),qr},[])}function Vr(tn,Tn){requestAnimationFrame(function(){Tn.enter(),requestAnimationFrame(function(){Tn.active(),setTimeout(function(){Tn.leave()},tn)})})}function hn(tn,Tn){try{var qr=tn.liElementsById[Tn.parent.id];qr.classList.contains("treejs-node__close")||qr.getElementsByClassName("treejs-switcher")[0].click()}catch{return}Object.prototype.hasOwnProperty.call(Tn,"parent")&&hn(tn,Tn.parent)}function cn(tn,Tn){var qr=tn.liElementsById[Tn.id];qr.classList.contains("treejs-node__close")&&qr.getElementsByClassName("treejs-switcher")[0].click(),Object.prototype.hasOwnProperty.call(Tn,"children")&&Tn.children.forEach(function(nn){return cn(tn,nn)})}var gn=function(){function tn(yr,an){(function(sn,Rn){if(!(sn instanceof Rn))throw new TypeError("Cannot call a class as a function")})(this,tn),pr.use({target:typeof this.container=="string"?document.querySelector(this.container):this.container}),this.treeNodes=[],this.nodesById={},this.leafNodesById={},this.liElementsById={},this.willUpdateNodesById={},this.container=yr,this.options=Object.assign({values:[],disables:[],loaded:null,closeDepth:null},an),Object.defineProperties(this,{values:{get:function(){return this.getValues()},set:function(sn){this.setValues(vr(sn))}},disables:{get:function(){return this.getDisables()},set:function(sn){this.setDisables(vr(sn))}},selectedNodes:{get:function(){var sn=[],Rn=this.nodesById;return Object.keys(Rn).forEach(function(Jr){if(Object.prototype.hasOwnProperty.call(Rn,Jr)&&(Rn[Jr].status===1||Rn[Jr].status===2)){var mr=Zt({},Rn[Jr]);delete mr.parent,delete mr.children,sn.push(mr)}}),sn}},disabledNodes:{get:function(){var sn=[],Rn=this.nodesById;return Object.keys(Rn).forEach(function(Jr){if(Object.prototype.hasOwnProperty.call(Rn,Jr)&&Rn[Jr].disabled){var mr=Zt({},Rn[Jr]);delete mr.parent,sn.push(mr)}}),sn}}}),this.init(this.options.data)}var Tn,qr,nn;return Tn=tn,nn=[{key:"onSwitcherClick",value:function(yr){var an=yr.parentNode,sn=an.lastChild,Rn=sn.scrollHeight;an.classList.contains("treejs-node__close")?Vr(150,{enter:function(){sn.style.height=0,sn.style.opacity=0},active:function(){sn.style.height="".concat(Rn,"px"),sn.style.opacity=1},leave:function(){sn.style.height="",sn.style.opacity="",an.classList.remove("treejs-node__close")}}):Vr(150,{enter:function(){sn.style.height="".concat(Rn,"px"),sn.style.opacity=1},active:function(){sn.style.height=0,sn.style.opacity=0},leave:function(){sn.style.height="",sn.style.opacity="",an.classList.add("treejs-node__close")}})}},{key:"parseTreeData",value:function(yr){var an,sn=(an=yr,JSON.parse(JSON.stringify(an))),Rn={},Jr={},mr=[],Ar=[];return function jr(On,$n){On.forEach(function(jn){Rn[jn.id]=jn,jn.checked&&mr.push(jn.id),jn.disabled&&Ar.push(jn.id),$n&&(jn.parent=$n),jn.children&&jn.children.length?jr(jn.children,jn):Jr[jn.id]=jn})}(sn),{treeNodes:sn,nodesById:Rn,leafNodesById:Jr,defaultValues:mr,defaultDisables:Ar}}},{key:"createRootEle",value:function(){var yr=document.createElement("div");return yr.classList.add("treejs"),yr}},{key:"createUlEle",value:function(){var yr=document.createElement("ul");return yr.classList.add("treejs-nodes"),yr}},{key:"createLiEle",value:function(yr,an){var sn=document.createElement("li");if(sn.classList.add("treejs-node"),an&&sn.classList.add("treejs-node__close"),yr.children&&yr.children.length){var Rn=document.createElement("span");Rn.classList.add("treejs-switcher"),sn.appendChild(Rn)}else sn.classList.add("treejs-placeholder");var Jr=document.createElement("span");Jr.classList.add("treejs-checkbox"),sn.appendChild(Jr);var mr=document.createElement("span");mr.classList.add("treejs-label");var Ar=document.createTextNode(yr.text);return mr.appendChild(Ar),sn.appendChild(mr),sn.nodeId=yr.id,sn}}],(qr=[{key:"init",value:function(yr){var an=tn.parseTreeData(yr),sn=an.treeNodes,Rn=an.nodesById,Jr=an.leafNodesById,mr=an.defaultValues,Ar=an.defaultDisables;this.treeNodes=sn,this.nodesById=Rn,this.leafNodesById=Jr,this.render(this.treeNodes);var jr=this.options,On=jr.values,$n=jr.disables,jn=jr.loaded;On&&On.length?this.setValues(On):mr&&mr.length&&this.setValues(mr),$n&&$n.length?this.setDisables($n):Ar&&Ar.length&&this.setDisables(Ar),typeof jn=="function"&&jn.call(this)}},{key:"render",value:function(yr){var an=tn.createRootEle();an.appendChild(this.buildTree(yr,0)),this.bindEvent(an);var sn=typeof this.container=="string"?document.querySelector(this.container):this.container;(function(Rn){for(;Rn.firstChild;)Rn.removeChild(Rn.firstChild)})(sn),sn.appendChild(an)}},{key:"buildTree",value:function(yr,an){var sn=this,Rn=tn.createUlEle();return yr&&yr.length&&yr.forEach(function(Jr){var mr=tn.createLiEle(Jr,an===sn.options.closeDepth-1);sn.liElementsById[Jr.id]=mr;var Ar=null;Jr.children&&Jr.children.length&&(Ar=sn.buildTree(Jr.children,an+1)),Ar&&mr.appendChild(Ar),Rn.appendChild(mr)}),Rn}},{key:"bindEvent",value:function(yr){var an=this;yr.addEventListener("click",function(sn){var Rn=sn.target;Rn.nodeName==="SPAN"&&Rn.classList.contains("treejs-checkbox")?an.onItemClick(Rn.parentNode.nodeId):Rn.nodeName==="SPAN"&&Rn.classList.contains("treejs-label")?an.onItemLabelClick(Rn.parentNode.nodeId):Rn.nodeName==="LI"&&Rn.classList.contains("treejs-node")?an.onItemClick(Rn.nodeId):Rn.nodeName==="SPAN"&&Rn.classList.contains("treejs-switcher")&&tn.onSwitcherClick(Rn)},!1)}},{key:"onItemClick",value:function(yr){var an=this.nodesById[yr],sn=this.options.onChange;an.disabled||(this.setValue(yr),this.updateLiElements()),sn&&sn.call(this)}},{key:"onItemLabelClick",value:function(yr){var an=this.options.onItemLabelClick;an&&an.call(this,yr)}},{key:"setValue",value:function(yr){var an=this.nodesById[yr];if(an){var sn=an.status,Rn=sn===1||sn===2?0:2;an.status=Rn,this.markWillUpdateNode(an),this.walkUp(an,"status"),this.walkDown(an,"status")}}},{key:"getValues",value:function(){var yr=this,an=[];return Object.keys(this.leafNodesById).forEach(function(sn){Object.prototype.hasOwnProperty.call(yr.leafNodesById,sn)&&(yr.leafNodesById[sn].status!==1&&yr.leafNodesById[sn].status!==2||an.push(sn))}),an}},{key:"setValues",value:function(yr){var an=this;this.emptyNodesCheckStatus(),yr.forEach(function(Rn){an.setValue(Rn)}),this.updateLiElements();var sn=this.options.onChange;sn&&sn.call(this)}},{key:"setDisable",value:function(yr){var an=this.nodesById[yr];an&&(an.disabled||(an.disabled=!0,this.markWillUpdateNode(an),this.walkUp(an,"disabled"),this.walkDown(an,"disabled")))}},{key:"getDisables",value:function(){var yr=this,an=[];return Object.keys(this.leafNodesById).forEach(function(sn){Object.prototype.hasOwnProperty.call(yr.leafNodesById,sn)&&yr.leafNodesById[sn].disabled&&an.push(sn)}),an}},{key:"setDisables",value:function(yr){var an=this;this.emptyNodesDisable(),yr.forEach(function(sn){an.setDisable(sn)}),this.updateLiElements()}},{key:"emptyNodesCheckStatus",value:function(){this.willUpdateNodesById=this.getSelectedNodesById(),Object.values(this.willUpdateNodesById).forEach(function(yr){yr.disabled||(yr.status=0)})}},{key:"emptyNodesDisable",value:function(){this.willUpdateNodesById=this.getDisabledNodesById(),Object.values(this.willUpdateNodesById).forEach(function(yr){yr.disabled=!1})}},{key:"getSelectedNodesById",value:function(){return Object.entries(this.nodesById).reduce(function(yr,an){var sn=or(an,2),Rn=sn[0],Jr=sn[1];return Jr.status!==1&&Jr.status!==2||(yr[Rn]=Jr),yr},{})}},{key:"getDisabledNodesById",value:function(){return Object.entries(this.nodesById).reduce(function(yr,an){var sn=or(an,2),Rn=sn[0],Jr=sn[1];return Jr.disabled&&(yr[Rn]=Jr),yr},{})}},{key:"updateLiElements",value:function(){var yr=this;Object.values(this.willUpdateNodesById).forEach(function(an){yr.updateLiElement(an)}),this.willUpdateNodesById={}}},{key:"markWillUpdateNode",value:function(yr){this.willUpdateNodesById[yr.id]=yr}},{key:"walkUp",value:function(yr,an){var sn=yr.parent;if(sn){if(an==="status"){var Rn,Jr=sn.children.reduce(function(Ar,jr){return Number.isNaN(jr.status)?Ar:Ar+jr.status},0);if(Rn=Jr?Jr===2*sn.children.length?2:1:0,sn.status===Rn)return;sn.status=Rn}else{var mr=sn.children.reduce(function(Ar,jr){return Ar&&jr.disabled},!0);if(sn.disabled===mr)return;sn.disabled=mr}this.markWillUpdateNode(sn),this.walkUp(sn,an)}}},{key:"walkDown",value:function(yr,an){var sn=this;yr.children&&yr.children.length&&yr.children.forEach(function(Rn){an==="status"&&Rn.disabled||(Rn[an]=yr[an],sn.markWillUpdateNode(Rn),sn.walkDown(Rn,an))})}},{key:"updateLiElement",value:function(yr){var an=this.liElementsById[yr.id].classList;switch(yr.status){case 0:an.remove("treejs-node__halfchecked","treejs-node__checked");break;case 1:an.remove("treejs-node__checked"),an.add("treejs-node__halfchecked");break;case 2:an.remove("treejs-node__halfchecked"),an.add("treejs-node__checked")}switch(yr.disabled){case!0:an.contains("treejs-node__disabled")||an.add("treejs-node__disabled");break;case!1:an.contains("treejs-node__disabled")&&an.remove("treejs-node__disabled")}}},{key:"collapseAll",value:function(){var yr=this;Object.keys(this.leafNodesById).forEach(function(an){var sn=yr.leafNodesById[an];hn(yr,sn)})}},{key:"expandAll",value:function(){cn(this,this.treeNodes[0])}}])&&tr(Tn.prototype,qr),nn&&tr(Tn,nn),Object.defineProperty(Tn,"prototype",{writable:!1}),tn}()}(),ut.default}()},819:function($,j){(function(it){const et="tp";function ut(dr){return Ft=>Ht=>{if(!Ft&&Ht===void 0)return{succeeded:!1,value:void 0};if(Ft&&Ht===void 0)return{succeeded:!0,value:void 0};const er=dr(Ht);return er!==void 0?{succeeded:!0,value:er}:{succeeded:!1,value:void 0}}}function dt(dr){return{custom:Ft=>ut(Ft)(dr),boolean:ut(Ft=>typeof Ft=="boolean"?Ft:void 0)(dr),number:ut(Ft=>typeof Ft=="number"?Ft:void 0)(dr),string:ut(Ft=>typeof Ft=="string"?Ft:void 0)(dr),function:ut(Ft=>typeof Ft=="function"?Ft:void 0)(dr),constant:Ft=>ut(Ht=>Ht===Ft?Ft:void 0)(dr),raw:ut(Ft=>Ft)(dr),object:Ft=>ut(Ht=>{if((er=Ht)!==null&&typeof er=="object")return function(pr,or){return Object.keys(or).reduce((ar,Wt)=>{if(ar===void 0)return;const Zt=(0,or[Wt])(pr[Wt]);return Zt.succeeded?Object.assign(Object.assign({},ar),{[Wt]:Zt.value}):void 0},{})}(Ht,Ft);var er})(dr),array:Ft=>ut(Ht=>{if(Array.isArray(Ht))return er=Ft,Ht.reduce((pr,or)=>{if(pr===void 0)return;const ar=er(or);return ar.succeeded&&ar.value!==void 0?[...pr,ar.value]:void 0},[]);var er})(dr)}}const mt={optional:dt(!0),required:dt(!1)};function yt(dr,Ft,Ht,er){return new(Ht||(Ht=Promise))(function(pr,or){function ar(sr){try{Zt(er.next(sr))}catch(tr){or(tr)}}function Wt(sr){try{Zt(er.throw(sr))}catch(tr){or(tr)}}function Zt(sr){var tr;sr.done?pr(sr.value):(tr=sr.value,tr instanceof Ht?tr:new Ht(function(vr){vr(tr)})).then(ar,Wt)}Zt((er=er.apply(dr,Ft||[])).next())})}function bt(dr){return yt(this,void 0,void 0,function*(){const Ft=new Image;return Ft.crossOrigin="anonymous",new Promise((Ht,er)=>{Ft.src=dr,Ft.onload=()=>{Ht(Ft)},Ft.onerror=er})})}const Rt=(jt="img",(dr,Ft)=>[et,"-",jt,"v",dr?`_${dr}`:"",Ft?`-${Ft}`:""].join(""));var jt;class Vt{constructor(Ft,Ht){this.element=Ft.createElement("div"),this.element.classList.add(Rt()),Ht.viewProps.bindClassModifiers(this.element),this.input=Ft.createElement("input"),this.input.classList.add(Rt("input")),this.input.setAttribute("type","file"),this.input.setAttribute("accept",Ht.extensions.join(",")),this.image_=Ft.createElement("img"),this.image_.classList.add(Rt("image")),this.image_.classList.add(Rt(`image_${Ht.imageFit}`)),this.image_.crossOrigin="anonymous",this.image_.onclick=er=>{Ht.clickCallback?Ht.clickCallback(er,this.input):this.input.click()},this.element.classList.add(Rt("area_root")),this.element.appendChild(this.image_),this.element.appendChild(this.input)}changeImage(Ft){this.image_.src=Ft}changeDraggingState(Ft){const Ht=this.element;Ft?Ht==null||Ht.classList.add(Rt("area_dragging")):Ht==null||Ht.classList.remove(Rt("area_dragging"))}}let zt=null;class Jt{constructor(Ft,Ht){this.value=Ht.value,this.viewProps=Ht.viewProps,this.view=new Vt(Ft,{viewProps:this.viewProps,extensions:Ht.extensions,imageFit:Ht.imageFit,clickCallback:Ht.clickCallback}),this.onFile=this.onFile.bind(this),this.onDrop=this.onDrop.bind(this),this.onDragOver=this.onDragOver.bind(this),this.onDragLeave=this.onDragLeave.bind(this),this.view.input.addEventListener("change",this.onFile),this.view.element.addEventListener("drop",this.onDrop),this.view.element.addEventListener("dragover",this.onDragOver),this.view.element.addEventListener("dragleave",this.onDragLeave),this.viewProps.handleDispose(()=>{this.view.input.removeEventListener("change",this.onFile),this.view.input.removeEventListener("drop",this.onDrop),this.view.input.removeEventListener("dragover",this.onDragOver),this.view.input.removeEventListener("dragleave",this.onDragLeave)}),this.value.emitter.on("change",this.handleValueChange.bind(this)),this.handleValueChange()}onFile(Ft){const Ht=(Ft==null?void 0:Ft.target).files;if(!Ht||!Ht.length)return;const er=Ht[0];this.setValue(er)}onDrop(Ft){return yt(this,void 0,void 0,function*(){Ft.preventDefault();try{const{dataTransfer:Ht}=Ft,er=Ht==null?void 0:Ht.files[0];if(er)this.setValue(er);else{const pr=Ht==null?void 0:Ht.getData("url");if(!pr)throw new Error("No url");this.setValue(pr)}}catch(Ht){console.error("Could not parse the dropped image",Ht)}finally{this.view.changeDraggingState(!1)}})}onDragOver(Ft){Ft.preventDefault(),this.view.changeDraggingState(!0)}onDragLeave(){this.view.changeDraggingState(!1)}handleImage(Ft){return yt(this,void 0,void 0,function*(){Ft instanceof HTMLImageElement?this.updateImage(Ft.src):typeof Ft!="string"&&Ft?yield this.setValue(Ft):(Ft!=="placeholder"&&Ft||(Ft=(yield this.handlePlaceholderImage()).src),this.updateImage(Ft))})}updateImage(Ft){this.view.changeImage(Ft)}setValue(Ft){return yt(this,void 0,void 0,function*(){if(Ft instanceof HTMLImageElement)this.value.setRawValue(Ft);else if(Ft instanceof File){const Ht=URL.createObjectURL(Ft)+"#"+Ft.name;Ft.src=Ht;const er=yield bt(Ht).catch(()=>{});this.value.setRawValue(er||Ft)}else Ft?this.value.setRawValue(yield bt(Ft)):this.value.setRawValue(yield this.handlePlaceholderImage())})}handleValueChange(){this.handleImage(this.value.rawValue)}handlePlaceholderImage(){return yt(this,void 0,void 0,function*(){return zt||(zt=yield function(){const Ft=document.createElement("canvas");Ft.width=320,Ft.height=50;const Ht=Ft.getContext("2d");return Ht.fillStyle="#00000004",Ht.fillRect(0,0,Ft.width,Ft.height),Ht.fillStyle="#eee",Ht.font='1.25rem "Roboto Mono", "Source Code Pro", Menlo, Courier, monospace',Ht.textAlign="center",Ht.textBaseline="middle",Ht.fillText("No image",.5*Ft.width,.5*Ft.height),new Promise(er=>{Ft.toBlob(pr=>{const or=new Image;or.src=URL.createObjectURL(pr),or.isPlaceholder=!0,or.onload=()=>{er(or)}})})}()),zt})}}const rr=[".jpg",".png",".gif"],Yt={id:"input-image",type:"input",css:".tp-imgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-imgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-imgv:hover{background-color:var(--in-bg-h)}.tp-imgv:focus{background-color:var(--in-bg-f)}.tp-imgv:active{background-color:var(--in-bg-a)}.tp-imgv:disabled{opacity:0.5}:root{--tp-plugin-image-dragging-color: hsla(230, 100%, 66%, 1.00)}.tp-imgv{cursor:pointer;display:inline-flex;height:auto !important;max-height:calc(var(--bld-us) * 3);border-radius:4px;position:relative}.tp-imgv.tp-v-disabled{opacity:0.5}.tp-imgv_input{width:0;height:0;pointer-events:none;visibility:hidden}.tp-imgv_image{width:100%;height:-webkit-max-content;height:-moz-max-content;height:max-content;max-height:calc(var(--bld-us) * 3);border:0}.tp-imgv_image_contain{-o-object-fit:contain;object-fit:contain}.tp-imgv_image_cover{-o-object-fit:cover;object-fit:cover}.tp-imgv_area_root{transition:opacity 0.16s ease-in-out}.tp-imgv_area_dragging{border:2px dashed var(--tp-plugin-image-dragging-color);border-radius:4px;opacity:0.6}",accept(dr,Ft){if(!(dr instanceof HTMLImageElement||typeof dr=="string"))return null;const Ht=mt,er=function(pr,or){const ar=mt.required.object(or)(pr);return ar.succeeded?ar.value:void 0}(Ft,{view:Ht.required.constant("input-image"),acceptUrl:Ht.optional.boolean,clickCallback:Ht.optional.function,imageFit:Ht.optional.custom(pr=>pr==="contain"||pr==="cover"?pr:void 0),extensions:Ht.optional.array(Ht.required.string)});return er?{initialValue:dr,params:er}:null},binding:{reader:dr=>Ft=>Ft.src!==void 0?Ft.src===""?"placeholder":Ft.src:Ft,writer:dr=>(Ft,Ht)=>{Ft.write(Ht)}},controller(dr){var Ft,Ht;return new Jt(dr.document,{value:dr.value,imageFit:(Ft=dr.params.imageFit)!==null&&Ft!==void 0?Ft:"cover",clickCallback:dr.params.clickCallback,viewProps:dr.viewProps,extensions:(Ht=dr.params.extensions)!==null&&Ht!==void 0?Ht:rr})}};it.plugin=Yt,Object.defineProperty(it,"__esModule",{value:!0})})(j)},665:function($,j){(function(it){class et{constructor(gt){this.controller_=gt}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(gt){this.controller_.viewProps.set("disabled",gt)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(gt){this.controller_.viewProps.set("hidden",gt)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class ut{constructor(gt){this.target=gt}}class dt extends ut{constructor(gt,xt,$t,hr){super(gt),this.value=xt,this.presetKey=$t,this.last=hr==null||hr}}class mt extends ut{constructor(gt,xt,$t){super(gt),this.value=xt,this.presetKey=$t}}class yt extends ut{constructor(gt,xt){super(gt),this.expanded=xt}}function bt(Dt){return Dt==null}function Rt(Dt,gt){if(Dt.length!==gt.length)return!1;for(let xt=0;xt<Dt.length;xt++)if(Dt[xt]!==gt[xt])return!1;return!0}const jt={alreadydisposed:()=>"View has been already disposed",invalidparams:Dt=>`Invalid parameters for '${Dt.name}'`,nomatchingcontroller:Dt=>`No matching controller for '${Dt.key}'`,nomatchingview:Dt=>`No matching view for '${JSON.stringify(Dt.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:Dt=>`Property '${Dt.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class Vt{constructor(gt){var xt;this.message=(xt=jt[gt.type](gt.context))!==null&&xt!==void 0?xt:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=gt.type}static alreadyDisposed(){return new Vt({type:"alreadydisposed"})}static notBindable(){return new Vt({type:"notbindable"})}static propertyNotFound(gt){return new Vt({type:"propertynotfound",context:{name:gt}})}static shouldNeverHappen(){return new Vt({type:"shouldneverhappen"})}}class zt{constructor(gt,xt,$t){this.obj_=gt,this.key_=xt,this.presetKey_=$t??xt}static isBindable(gt){return gt!==null&&typeof gt=="object"}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(gt){this.obj_[this.key_]=gt}writeProperty(gt,xt){const $t=this.read();if(!zt.isBindable($t))throw Vt.notBindable();if(!(gt in $t))throw Vt.propertyNotFound(gt);$t[gt]=xt}}class Jt extends et{get label(){return this.controller_.props.get("label")}set label(gt){this.controller_.props.set("label",gt)}get title(){var gt;return(gt=this.controller_.valueController.props.get("title"))!==null&&gt!==void 0?gt:""}set title(gt){this.controller_.valueController.props.set("title",gt)}on(gt,xt){const $t=xt.bind(this);return this.controller_.valueController.emitter.on(gt,()=>{$t(new ut(this))}),this}}class rr{constructor(){this.observers_={}}on(gt,xt){let $t=this.observers_[gt];return $t||($t=this.observers_[gt]=[]),$t.push({handler:xt}),this}off(gt,xt){const $t=this.observers_[gt];return $t&&(this.observers_[gt]=$t.filter(hr=>hr.handler!==xt)),this}emit(gt,xt){const $t=this.observers_[gt];$t&&$t.forEach(hr=>{hr.handler(xt)})}}const Yt="tp";function dr(Dt){return(gt,xt)=>[Yt,"-",Dt,"v",gt?`_${gt}`:"",xt?`-${xt}`:""].join("")}function Ft(Dt){return Dt.rawValue}function Ht(Dt,gt){var xt,$t;Dt.emitter.on("change",(xt=Ft,$t=gt,hr=>$t(xt(hr)))),gt(Dt.rawValue)}function er(Dt,gt,xt){Ht(Dt.value(gt),xt)}function pr(Dt,gt){return xt=>{(function($t,hr,Pr){Pr?$t.classList.add(hr):$t.classList.remove(hr)})(Dt,gt,xt)}}function or(Dt,gt){Ht(Dt,xt=>{gt.textContent=xt??""})}const ar=dr("btn");class Wt{constructor(gt,xt){this.element=gt.createElement("div"),this.element.classList.add(ar()),xt.viewProps.bindClassModifiers(this.element);const $t=gt.createElement("button");$t.classList.add(ar("b")),xt.viewProps.bindDisabled($t),this.element.appendChild($t),this.buttonElement=$t;const hr=gt.createElement("div");hr.classList.add(ar("t")),or(xt.props.value("title"),hr),this.buttonElement.appendChild(hr)}}class Zt{constructor(gt,xt){this.emitter=new rr,this.onClick_=this.onClick_.bind(this),this.props=xt.props,this.viewProps=xt.viewProps,this.view=new Wt(gt,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class sr{constructor(gt,xt){var $t;this.constraint_=xt==null?void 0:xt.constraint,this.equals_=($t=xt==null?void 0:xt.equals)!==null&&$t!==void 0?$t:(hr,Pr)=>hr===Pr,this.emitter=new rr,this.rawValue_=gt}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(gt){this.setRawValue(gt,{forceEmit:!1,last:!0})}setRawValue(gt,xt){const $t=xt??{forceEmit:!1,last:!0},hr=this.constraint_?this.constraint_.constrain(gt):gt;(!this.equals_(this.rawValue_,hr)||$t.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=hr,this.emitter.emit("change",{options:$t,rawValue:hr,sender:this}))}}class tr{constructor(gt){this.emitter=new rr,this.value_=gt}get rawValue(){return this.value_}set rawValue(gt){this.setRawValue(gt,{forceEmit:!1,last:!0})}setRawValue(gt,xt){const $t=xt??{forceEmit:!1,last:!0};(this.value_!==gt||$t.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=gt,this.emitter.emit("change",{options:$t,rawValue:this.value_,sender:this}))}}function vr(Dt,gt){const xt=gt==null?void 0:gt.constraint,$t=gt==null?void 0:gt.equals;return xt||$t?new sr(Dt,gt):new tr(Dt)}class Vr{constructor(gt){this.emitter=new rr,this.valMap_=gt;for(const xt in this.valMap_)this.valMap_[xt].emitter.on("change",()=>{this.emitter.emit("change",{key:xt,sender:this})})}static createCore(gt){return Object.keys(gt).reduce((xt,$t)=>Object.assign(xt,{[$t]:vr(gt[$t])}),{})}static fromObject(gt){const xt=this.createCore(gt);return new Vr(xt)}get(gt){return this.valMap_[gt].rawValue}set(gt,xt){this.valMap_[gt].rawValue=xt}value(gt){return this.valMap_[gt]}}function hn(Dt){return gt=>xt=>{if(!gt&&xt===void 0)return{succeeded:!1,value:void 0};if(gt&&xt===void 0)return{succeeded:!0,value:void 0};const $t=Dt(xt);return $t!==void 0?{succeeded:!0,value:$t}:{succeeded:!1,value:void 0}}}function cn(Dt){return{custom:gt=>hn(gt)(Dt),boolean:hn(gt=>typeof gt=="boolean"?gt:void 0)(Dt),number:hn(gt=>typeof gt=="number"?gt:void 0)(Dt),string:hn(gt=>typeof gt=="string"?gt:void 0)(Dt),function:hn(gt=>typeof gt=="function"?gt:void 0)(Dt),constant:gt=>hn(xt=>xt===gt?gt:void 0)(Dt),raw:hn(gt=>gt)(Dt),object:gt=>hn(xt=>{if(($t=xt)!==null&&typeof $t=="object")return function(hr,Pr){return Object.keys(Pr).reduce(($r,An)=>{if($r===void 0)return;const zn=(0,Pr[An])(hr[An]);return zn.succeeded?Object.assign(Object.assign({},$r),{[An]:zn.value}):void 0},{})}(xt,gt);var $t})(Dt),array:gt=>hn(xt=>{if(Array.isArray(xt))return $t=gt,xt.reduce((hr,Pr)=>{if(hr===void 0)return;const $r=$t(Pr);return $r.succeeded&&$r.value!==void 0?[...hr,$r.value]:void 0},[]);var $t})(Dt)}}const gn={optional:cn(!0),required:cn(!1)};function tn(Dt,gt){const xt=gn.required.object(gt)(Dt);return xt.succeeded?xt.value:void 0}const Tn=dr(""),qr={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class nn{constructor(gt){this.parent_=null,this.blade=gt.blade,this.view=gt.view,this.viewProps=gt.viewProps;const xt=this.view.element;this.blade.value("positions").emitter.on("change",()=>{["veryfirst","first","last","verylast"].forEach($t=>{xt.classList.remove(Tn(void 0,qr[$t]))}),this.blade.get("positions").forEach($t=>{xt.classList.add(Tn(void 0,qr[$t]))})}),this.viewProps.handleDispose(()=>{(function($t){$t&&$t.parentElement&&$t.parentElement.removeChild($t)})(xt)})}get parent(){return this.parent_}}const yr="http://www.w3.org/2000/svg";function an(Dt){Dt.offsetHeight}function sn(Dt){return Dt.ontouchstart!==void 0}function Rn(){return new Function("return this")().document}const Jr={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function mr(Dt,gt){const xt=Dt.createElementNS(yr,"svg");return xt.innerHTML=Jr[gt],xt}function Ar(Dt,gt,xt){Dt.insertBefore(gt,Dt.children[xt])}function jr(Dt){Dt.parentElement&&Dt.parentElement.removeChild(Dt)}function On(Dt){for(;Dt.children.length>0;)Dt.removeChild(Dt.children[0])}function $n(Dt){return Dt.relatedTarget?Dt.relatedTarget:"explicitOriginalTarget"in Dt?Dt.explicitOriginalTarget:null}const jn=dr("lbl");class As{constructor(gt,xt){this.element=gt.createElement("div"),this.element.classList.add(jn()),xt.viewProps.bindClassModifiers(this.element);const $t=gt.createElement("div");$t.classList.add(jn("l")),er(xt.props,"label",Pr=>{bt(Pr)?this.element.classList.add(jn(void 0,"nol")):(this.element.classList.remove(jn(void 0,"nol")),function($r){for(;$r.childNodes.length>0;)$r.removeChild($r.childNodes[0])}($t),$t.appendChild(function($r,An){const zn=$r.createDocumentFragment();return An.split(`
`).map(Ms=>$r.createTextNode(Ms)).forEach((Ms,Us)=>{Us>0&&zn.appendChild($r.createElement("br")),zn.appendChild(Ms)}),zn}(gt,Pr)))}),this.element.appendChild($t),this.labelElement=$t;const hr=gt.createElement("div");hr.classList.add(jn("v")),this.element.appendChild(hr),this.valueElement=hr}}class ps extends nn{constructor(gt,xt){const $t=xt.valueController.viewProps;super(Object.assign(Object.assign({},xt),{view:new As(gt,{props:xt.props,viewProps:$t}),viewProps:$t})),this.props=xt.props,this.valueController=xt.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const qs={id:"button",type:"blade",accept(Dt){const gt=gn,xt=tn(Dt,{title:gt.required.string,view:gt.required.constant("button"),label:gt.optional.string});return xt?{params:xt}:null},controller:Dt=>new ps(Dt.document,{blade:Dt.blade,props:Vr.fromObject({label:Dt.params.label}),valueController:new Zt(Dt.document,{props:Vr.fromObject({title:Dt.params.title}),viewProps:Dt.viewProps})}),api:Dt=>Dt.controller instanceof ps&&Dt.controller.valueController instanceof Zt?new Jt(Dt.controller):null};class Vs extends nn{constructor(gt){super(gt),this.value=gt.value}}function Eo(){return new Vr({positions:vr([],{equals:Rt})})}class js extends Vr{constructor(gt){super(gt)}static create(gt){const xt={completed:!0,expanded:gt,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},$t=Vr.createCore(xt);return new js($t)}get styleExpanded(){var gt;return(gt=this.get("temporaryExpanded"))!==null&&gt!==void 0?gt:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const gt=this.get("expandedHeight");return this.get("shouldFixHeight")&&!bt(gt)?`${gt}px`:"auto"}bindExpandedClass(gt,xt){const $t=()=>{this.styleExpanded?gt.classList.add(xt):gt.classList.remove(xt)};er(this,"expanded",$t),er(this,"temporaryExpanded",$t)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function mn(Dt,gt){gt.style.height=Dt.styleHeight}function uo(Dt,gt){Dt.value("expanded").emitter.on("beforechange",()=>{Dt.set("completed",!1),bt(Dt.get("expandedHeight"))&&Dt.set("expandedHeight",function(xt,$t){let hr=0;return function(Pr,$r){const An=Pr.style.transition;Pr.style.transition="none",$r(),Pr.style.transition=An}($t,()=>{xt.set("expandedHeight",null),xt.set("temporaryExpanded",!0),an($t),hr=$t.clientHeight,xt.set("temporaryExpanded",null),an($t)}),hr}(Dt,gt)),Dt.set("shouldFixHeight",!0),an(gt)}),Dt.emitter.on("change",()=>{mn(Dt,gt)}),mn(Dt,gt),gt.addEventListener("transitionend",xt=>{xt.propertyName==="height"&&Dt.cleanUpTransition()})}class _o extends et{constructor(gt,xt){super(gt),this.rackApi_=xt}}class Vl{constructor(gt){this.emitter=new rr,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=gt}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(gt){for(const xt of this.allItems())if(gt(xt))return xt;return null}includes(gt){return this.cache_.has(gt)}add(gt,xt){if(this.includes(gt))throw Vt.shouldNeverHappen();const $t=xt!==void 0?xt:this.items_.length;this.items_.splice($t,0,gt),this.cache_.add(gt);const hr=this.extract_(gt);hr&&(hr.emitter.on("add",this.onSubListAdd_),hr.emitter.on("remove",this.onSubListRemove_),hr.allItems().forEach(Pr=>{this.cache_.add(Pr)})),this.emitter.emit("add",{index:$t,item:gt,root:this,target:this})}remove(gt){const xt=this.items_.indexOf(gt);if(xt<0)return;this.items_.splice(xt,1),this.cache_.delete(gt);const $t=this.extract_(gt);$t&&($t.emitter.off("add",this.onSubListAdd_),$t.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:xt,item:gt,root:this,target:this})}onSubListAdd_(gt){this.cache_.add(gt.item),this.emitter.emit("add",{index:gt.index,item:gt.item,root:this,target:gt.target})}onSubListRemove_(gt){this.cache_.delete(gt.item),this.emitter.emit("remove",{index:gt.index,item:gt.item,root:this,target:gt.target})}}class Vo extends et{constructor(gt){super(gt),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new rr,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(gt){this.controller_.props.set("label",gt)}on(gt,xt){const $t=xt.bind(this);return this.emitter_.on(gt,hr=>{$t(hr.event)}),this}refresh(){this.controller_.binding.read()}onBindingChange_(gt){const xt=gt.sender.target.read();this.emitter_.emit("change",{event:new dt(this,xt,this.controller_.binding.target.presetKey,gt.options.last)})}}class Oo extends ps{constructor(gt,xt){super(gt,xt),this.binding=xt.binding}}class Lo extends et{constructor(gt){super(gt),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new rr,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(gt){this.controller_.props.set("label",gt)}on(gt,xt){const $t=xt.bind(this);return this.emitter_.on(gt,hr=>{$t(hr.event)}),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(gt){const xt=gt.sender.target.read();this.emitter_.emit("update",{event:new mt(this,xt,this.controller_.binding.target.presetKey)})}}class No extends ps{constructor(gt,xt){super(gt,xt),this.binding=xt.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose(()=>{this.binding.dispose()})}}function eu(Dt){return Dt instanceof Il?Dt.apiSet_:Dt instanceof _o?Dt.rackApi_.apiSet_:null}function So(Dt,gt){const xt=Dt.find($t=>$t.controller_===gt);if(!xt)throw Vt.shouldNeverHappen();return xt}function co(Dt,gt,xt){if(!zt.isBindable(Dt))throw Vt.notBindable();return new zt(Dt,gt,xt)}class Il extends et{constructor(gt,xt){super(gt),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new rr,this.apiSet_=new Vl(eu),this.pool_=xt;const $t=this.controller_.rack;$t.emitter.on("add",this.onRackAdd_),$t.emitter.on("remove",this.onRackRemove_),$t.emitter.on("inputchange",this.onRackInputChange_),$t.emitter.on("monitorupdate",this.onRackMonitorUpdate_),$t.children.forEach(hr=>{this.setUpApi_(hr)})}get children(){return this.controller_.rack.children.map(gt=>So(this.apiSet_,gt))}addInput(gt,xt,$t){const hr=$t||{},Pr=this.controller_.view.element.ownerDocument,$r=this.pool_.createInput(Pr,co(gt,xt,hr.presetKey),hr),An=new Vo($r);return this.add(An,hr.index)}addMonitor(gt,xt,$t){const hr=$t||{},Pr=this.controller_.view.element.ownerDocument,$r=this.pool_.createMonitor(Pr,co(gt,xt),hr),An=new Lo($r);return this.add(An,hr.index)}addFolder(gt){return function(xt,$t){return xt.addBlade(Object.assign(Object.assign({},$t),{view:"folder"}))}(this,gt)}addButton(gt){return function(xt,$t){return xt.addBlade(Object.assign(Object.assign({},$t),{view:"button"}))}(this,gt)}addSeparator(gt){return function(xt,$t){const hr=$t||{};return xt.addBlade(Object.assign(Object.assign({},hr),{view:"separator"}))}(this,gt)}addTab(gt){return function(xt,$t){return xt.addBlade(Object.assign(Object.assign({},$t),{view:"tab"}))}(this,gt)}add(gt,xt){this.controller_.rack.add(gt.controller_,xt);const $t=this.apiSet_.find(hr=>hr.controller_===gt.controller_);return $t&&this.apiSet_.remove($t),this.apiSet_.add(gt),gt}remove(gt){this.controller_.rack.remove(gt.controller_)}addBlade(gt){const xt=this.controller_.view.element.ownerDocument,$t=this.pool_.createBlade(xt,gt),hr=this.pool_.createBladeApi($t);return this.add(hr,gt.index)}on(gt,xt){const $t=xt.bind(this);return this.emitter_.on(gt,hr=>{$t(hr.event)}),this}setUpApi_(gt){this.apiSet_.find(xt=>xt.controller_===gt)||this.apiSet_.add(this.pool_.createBladeApi(gt))}onRackAdd_(gt){this.setUpApi_(gt.bladeController)}onRackRemove_(gt){if(gt.isRoot){const xt=So(this.apiSet_,gt.bladeController);this.apiSet_.remove(xt)}}onRackInputChange_(gt){const xt=gt.bladeController;if(xt instanceof Oo){const $t=So(this.apiSet_,xt),hr=xt.binding;this.emitter_.emit("change",{event:new dt($t,hr.target.read(),hr.target.presetKey,gt.options.last)})}else if(xt instanceof Vs){const $t=So(this.apiSet_,xt);this.emitter_.emit("change",{event:new dt($t,xt.value.rawValue,void 0,gt.options.last)})}}onRackMonitorUpdate_(gt){if(!(gt.bladeController instanceof No))throw Vt.shouldNeverHappen();const xt=So(this.apiSet_,gt.bladeController),$t=gt.bladeController.binding;this.emitter_.emit("update",{event:new mt(xt,$t.target.read(),$t.target.presetKey)})}}class ga extends _o{constructor(gt,xt){super(gt,new Il(gt.rackController,xt)),this.emitter_=new rr,this.controller_.foldable.value("expanded").emitter.on("change",$t=>{this.emitter_.emit("fold",{event:new yt(this,$t.sender.rawValue)})}),this.rackApi_.on("change",$t=>{this.emitter_.emit("change",{event:$t})}),this.rackApi_.on("update",$t=>{this.emitter_.emit("update",{event:$t})})}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(gt){this.controller_.foldable.set("expanded",gt)}get title(){return this.controller_.props.get("title")}set title(gt){this.controller_.props.set("title",gt)}get children(){return this.rackApi_.children}addInput(gt,xt,$t){return this.rackApi_.addInput(gt,xt,$t)}addMonitor(gt,xt,$t){return this.rackApi_.addMonitor(gt,xt,$t)}addFolder(gt){return this.rackApi_.addFolder(gt)}addButton(gt){return this.rackApi_.addButton(gt)}addSeparator(gt){return this.rackApi_.addSeparator(gt)}addTab(gt){return this.rackApi_.addTab(gt)}add(gt,xt){return this.rackApi_.add(gt,xt)}remove(gt){this.rackApi_.remove(gt)}addBlade(gt){return this.rackApi_.addBlade(gt)}on(gt,xt){const $t=xt.bind(this);return this.emitter_.on(gt,hr=>{$t(hr.event)}),this}}class Go extends nn{constructor(gt){super({blade:gt.blade,view:gt.view,viewProps:gt.rackController.viewProps}),this.rackController=gt.rackController}}class Up{constructor(gt,xt){const $t=dr(xt.viewName);this.element=gt.createElement("div"),this.element.classList.add($t()),xt.viewProps.bindClassModifiers(this.element)}}function ba(Dt){return Dt instanceof Lu?Dt.rack:Dt instanceof Go?Dt.rackController.rack:null}function bu(Dt){const gt=ba(Dt);return gt?gt.bcSet_:null}class Ko{constructor(gt){var xt;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new rr,this.blade_=gt??null,(xt=this.blade_)===null||xt===void 0||xt.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new Vl(bu),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(gt,xt){gt.parent&&gt.parent.remove(gt),gt.parent_=this,this.bcSet_.add(gt,xt)}remove(gt){gt.parent_=null,this.bcSet_.remove(gt)}find(gt){return this.bcSet_.allItems().filter(xt=>xt instanceof gt)}onSetAdd_(gt){this.updatePositions_();const xt=gt.target===gt.root;if(this.emitter.emit("add",{bladeController:gt.item,index:gt.index,isRoot:xt,sender:this}),!xt)return;const $t=gt.item;if($t.viewProps.emitter.on("change",this.onChildViewPropsChange_),$t.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),$t.viewProps.handleDispose(this.onChildDispose_),$t instanceof Oo)$t.binding.emitter.on("change",this.onChildInputChange_);else if($t instanceof No)$t.binding.emitter.on("update",this.onChildMonitorUpdate_);else if($t instanceof Vs)$t.value.emitter.on("change",this.onChildValueChange_);else{const hr=ba($t);if(hr){const Pr=hr.emitter;Pr.on("layout",this.onDescendantLayout_),Pr.on("inputchange",this.onDescendantInputChange_),Pr.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(gt){this.updatePositions_();const xt=gt.target===gt.root;if(this.emitter.emit("remove",{bladeController:gt.item,isRoot:xt,sender:this}),!xt)return;const $t=gt.item;if($t instanceof Oo)$t.binding.emitter.off("change",this.onChildInputChange_);else if($t instanceof No)$t.binding.emitter.off("update",this.onChildMonitorUpdate_);else if($t instanceof Vs)$t.value.emitter.off("change",this.onChildValueChange_);else{const hr=ba($t);if(hr){const Pr=hr.emitter;Pr.off("layout",this.onDescendantLayout_),Pr.off("inputchange",this.onDescendantInputChange_),Pr.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const gt=this.bcSet_.items.filter(hr=>!hr.viewProps.get("hidden")),xt=gt[0],$t=gt[gt.length-1];this.bcSet_.items.forEach(hr=>{const Pr=[];hr===xt&&(Pr.push("first"),this.blade_&&!this.blade_.get("positions").includes("veryfirst")||Pr.push("veryfirst")),hr===$t&&(Pr.push("last"),this.blade_&&!this.blade_.get("positions").includes("verylast")||Pr.push("verylast")),hr.blade.set("positions",Pr)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(gt){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(gt=>gt.viewProps.get("disposed")).forEach(gt=>{this.bcSet_.remove(gt)})}onChildInputChange_(gt){const xt=function($t,hr){for(let Pr=0;Pr<$t.length;Pr++){const $r=$t[Pr];if($r instanceof Oo&&$r.binding===hr)return $r}return null}(this.find(Oo),gt.sender);if(!xt)throw Vt.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:xt,options:gt.options,sender:this})}onChildMonitorUpdate_(gt){const xt=function($t,hr){for(let Pr=0;Pr<$t.length;Pr++){const $r=$t[Pr];if($r instanceof No&&$r.binding===hr)return $r}return null}(this.find(No),gt.sender);if(!xt)throw Vt.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:xt,sender:this})}onChildValueChange_(gt){const xt=function($t,hr){for(let Pr=0;Pr<$t.length;Pr++){const $r=$t[Pr];if($r instanceof Vs&&$r.value===hr)return $r}return null}(this.find(Vs),gt.sender);if(!xt)throw Vt.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:xt,options:gt.options,sender:this})}onDescendantLayout_(gt){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(gt){this.emitter.emit("inputchange",{bladeController:gt.bladeController,options:gt.options,sender:this})}onDescendantMonitorUpdate_(gt){this.emitter.emit("monitorupdate",{bladeController:gt.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class Lu extends nn{constructor(gt,xt){super(Object.assign(Object.assign({},xt),{view:new Up(gt,{viewName:"brk",viewProps:xt.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const $t=new Ko(xt.root?void 0:xt.blade);$t.emitter.on("add",this.onRackAdd_),$t.emitter.on("remove",this.onRackRemove_),this.rack=$t,this.viewProps.handleDispose(()=>{for(let hr=this.rack.children.length-1;hr>=0;hr--)this.rack.children[hr].viewProps.set("disposed",!0)})}onRackAdd_(gt){gt.isRoot&&Ar(this.view.element,gt.bladeController.view.element,gt.index)}onRackRemove_(gt){gt.isRoot&&jr(gt.bladeController.view.element)}}const $p=dr("cnt");class ys{constructor(gt,xt){this.className_=dr(xt.viewName||"fld"),this.element=gt.createElement("div"),this.element.classList.add(this.className_(),$p()),xt.viewProps.bindClassModifiers(this.element),this.foldable_=xt.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),er(this.foldable_,"completed",pr(this.element,this.className_(void 0,"cpl")));const $t=gt.createElement("button");$t.classList.add(this.className_("b")),er(xt.props,"title",An=>{bt(An)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),xt.viewProps.bindDisabled($t),this.element.appendChild($t),this.buttonElement=$t;const hr=gt.createElement("div");hr.classList.add(this.className_("t")),or(xt.props.value("title"),hr),this.buttonElement.appendChild(hr),this.titleElement=hr;const Pr=gt.createElement("div");Pr.classList.add(this.className_("m")),this.buttonElement.appendChild(Pr);const $r=xt.containerElement;$r.classList.add(this.className_("c")),this.element.appendChild($r),this.containerElement=$r}}class Bo extends Go{constructor(gt,xt){var $t;const hr=js.create(($t=xt.expanded)===null||$t===void 0||$t),Pr=new Lu(gt,{blade:xt.blade,root:xt.root,viewProps:xt.viewProps});super(Object.assign(Object.assign({},xt),{rackController:Pr,view:new ys(gt,{containerElement:Pr.view.element,foldable:hr,props:xt.props,viewName:xt.root?"rot":void 0,viewProps:xt.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=xt.props,this.foldable=hr,uo(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const su={id:"folder",type:"blade",accept(Dt){const gt=gn,xt=tn(Dt,{title:gt.required.string,view:gt.required.constant("folder"),expanded:gt.optional.boolean});return xt?{params:xt}:null},controller:Dt=>new Bo(Dt.document,{blade:Dt.blade,expanded:Dt.params.expanded,props:Vr.fromObject({title:Dt.params.title}),viewProps:Dt.viewProps}),api:Dt=>Dt.controller instanceof Bo?new ga(Dt.controller,Dt.pool):null};class Ol extends Vs{constructor(gt,xt){const $t=xt.valueController.viewProps;super(Object.assign(Object.assign({},xt),{value:xt.valueController.value,view:new As(gt,{props:xt.props,viewProps:$t}),viewProps:$t})),this.props=xt.props,this.valueController=xt.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class pp extends et{}const _c=dr("spr");class Cp{constructor(gt,xt){this.element=gt.createElement("div"),this.element.classList.add(_c()),xt.viewProps.bindClassModifiers(this.element);const $t=gt.createElement("hr");$t.classList.add(_c("r")),this.element.appendChild($t)}}class Yr extends nn{constructor(gt,xt){super(Object.assign(Object.assign({},xt),{view:new Cp(gt,{viewProps:xt.viewProps})}))}}const Cl={id:"separator",type:"blade",accept(Dt){const gt=tn(Dt,{view:gn.required.constant("separator")});return gt?{params:gt}:null},controller:Dt=>new Yr(Dt.document,{blade:Dt.blade,viewProps:Dt.viewProps}),api:Dt=>Dt.controller instanceof Yr?new pp(Dt.controller):null},_d=dr("");function Js(Dt,gt){return pr(Dt,_d(void 0,gt))}class rs extends Vr{constructor(gt){super(gt)}static create(gt){var xt,$t;const hr=gt??{},Pr={disabled:(xt=hr.disabled)!==null&&xt!==void 0&&xt,disposed:!1,hidden:($t=hr.hidden)!==null&&$t!==void 0&&$t},$r=Vr.createCore(Pr);return new rs($r)}bindClassModifiers(gt){er(this,"disabled",Js(gt,"disabled")),er(this,"hidden",Js(gt,"hidden"))}bindDisabled(gt){er(this,"disabled",xt=>{gt.disabled=xt})}bindTabIndex(gt){er(this,"disabled",xt=>{gt.tabIndex=xt?-1:0})}handleDispose(gt){this.value("disposed").emitter.on("change",xt=>{xt&&gt()})}}const In=dr("tbi");class Ns{constructor(gt,xt){this.element=gt.createElement("div"),this.element.classList.add(In()),xt.viewProps.bindClassModifiers(this.element),er(xt.props,"selected",Pr=>{Pr?this.element.classList.add(In(void 0,"sel")):this.element.classList.remove(In(void 0,"sel"))});const $t=gt.createElement("button");$t.classList.add(In("b")),xt.viewProps.bindDisabled($t),this.element.appendChild($t),this.buttonElement=$t;const hr=gt.createElement("div");hr.classList.add(In("t")),or(xt.props.value("title"),hr),this.buttonElement.appendChild(hr),this.titleElement=hr}}class Fs{constructor(gt,xt){this.emitter=new rr,this.onClick_=this.onClick_.bind(this),this.props=xt.props,this.viewProps=xt.viewProps,this.view=new Ns(gt,{props:xt.props,viewProps:xt.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class Ps{constructor(gt,xt){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Fs(gt,{props:xt.itemProps,viewProps:rs.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new Lu(gt,{blade:Eo(),viewProps:rs.create()}),this.props=xt.props,er(this.props,"selected",$t=>{this.itemController.props.set("selected",$t),this.contentController.viewProps.set("hidden",!$t)})}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class Xo{constructor(gt,xt){this.controller_=gt,this.rackApi_=xt}get title(){var gt;return(gt=this.controller_.itemController.props.get("title"))!==null&&gt!==void 0?gt:""}set title(gt){this.controller_.itemController.props.set("title",gt)}get selected(){return this.controller_.props.get("selected")}set selected(gt){this.controller_.props.set("selected",gt)}get children(){return this.rackApi_.children}addButton(gt){return this.rackApi_.addButton(gt)}addFolder(gt){return this.rackApi_.addFolder(gt)}addSeparator(gt){return this.rackApi_.addSeparator(gt)}addTab(gt){return this.rackApi_.addTab(gt)}add(gt,xt){this.rackApi_.add(gt,xt)}remove(gt){this.rackApi_.remove(gt)}addInput(gt,xt,$t){return this.rackApi_.addInput(gt,xt,$t)}addMonitor(gt,xt,$t){return this.rackApi_.addMonitor(gt,xt,$t)}addBlade(gt){return this.rackApi_.addBlade(gt)}}class oo extends _o{constructor(gt,xt){super(gt,new Il(gt.rackController,xt)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.emitter_=new rr,this.pageApiMap_=new Map,this.rackApi_.on("change",$t=>{this.emitter_.emit("change",{event:$t})}),this.rackApi_.on("update",$t=>{this.emitter_.emit("update",{event:$t})}),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach($t=>{this.setUpPageApi_($t)})}get pages(){return this.controller_.pageSet.items.map(gt=>{const xt=this.pageApiMap_.get(gt);if(!xt)throw Vt.shouldNeverHappen();return xt})}addPage(gt){const xt=this.controller_.view.element.ownerDocument,$t=new Ps(xt,{itemProps:Vr.fromObject({selected:!1,title:gt.title}),props:Vr.fromObject({selected:!1})});this.controller_.add($t,gt.index);const hr=this.pageApiMap_.get($t);if(!hr)throw Vt.shouldNeverHappen();return hr}removePage(gt){this.controller_.remove(gt)}on(gt,xt){const $t=xt.bind(this);return this.emitter_.on(gt,hr=>{$t(hr.event)}),this}setUpPageApi_(gt){const xt=this.rackApi_.apiSet_.find(hr=>hr.controller_===gt.contentController);if(!xt)throw Vt.shouldNeverHappen();const $t=new Xo(gt,xt);this.pageApiMap_.set(gt,$t)}onPageAdd_(gt){this.setUpPageApi_(gt.item)}onPageRemove_(gt){if(!this.pageApiMap_.get(gt.item))throw Vt.shouldNeverHappen();this.pageApiMap_.delete(gt.item)}}const Uo=dr("tab");class Jo{constructor(gt,xt){this.element=gt.createElement("div"),this.element.classList.add(Uo(),$p()),xt.viewProps.bindClassModifiers(this.element),Ht(xt.empty,pr(this.element,Uo(void 0,"nop")));const $t=gt.createElement("div");$t.classList.add(Uo("i")),this.element.appendChild($t),this.itemsElement=$t;const hr=xt.contentsElement;hr.classList.add(Uo("c")),this.element.appendChild(hr),this.contentsElement=hr}}class ep extends Go{constructor(gt,xt){const $t=new Lu(gt,{blade:xt.blade,viewProps:xt.viewProps}),hr=vr(!0);super({blade:xt.blade,rackController:$t,view:new Jo(gt,{contentsElement:$t.view.element,empty:hr,viewProps:xt.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onPageSelectedChange_=this.onPageSelectedChange_.bind(this),this.pageSet_=new Vl(()=>null),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.empty_=hr,this.applyPages_()}get pageSet(){return this.pageSet_}add(gt,xt){this.pageSet_.add(gt,xt??this.pageSet_.items.length)}remove(gt){this.pageSet_.remove(this.pageSet_.items[gt])}applyPages_(){this.keepSelection_(),this.empty_.rawValue=this.pageSet_.items.length===0}onPageAdd_(gt){const xt=gt.item;Ar(this.view.itemsElement,xt.itemController.view.element,gt.index),this.rackController.rack.add(xt.contentController,gt.index),xt.props.value("selected").emitter.on("change",this.onPageSelectedChange_),this.applyPages_()}onPageRemove_(gt){const xt=gt.item;jr(xt.itemController.view.element),this.rackController.rack.remove(xt.contentController),xt.props.value("selected").emitter.off("change",this.onPageSelectedChange_),this.applyPages_()}keepSelection_(){if(this.pageSet_.items.length===0)return;const gt=this.pageSet_.items.findIndex(xt=>xt.props.get("selected"));gt<0?this.pageSet_.items.forEach((xt,$t)=>{xt.props.set("selected",$t===0)}):this.pageSet_.items.forEach((xt,$t)=>{xt.props.set("selected",$t===gt)})}onPageSelectedChange_(gt){if(gt.rawValue){const xt=this.pageSet_.items.findIndex($t=>$t.props.value("selected")===gt.sender);this.pageSet_.items.forEach(($t,hr)=>{$t.props.set("selected",hr===xt)})}else this.keepSelection_()}}const po={id:"tab",type:"blade",accept(Dt){const gt=gn,xt=tn(Dt,{pages:gt.required.array(gt.required.object({title:gt.required.string})),view:gt.required.constant("tab")});return xt&&xt.pages.length!==0?{params:xt}:null},controller(Dt){const gt=new ep(Dt.document,{blade:Dt.blade,viewProps:Dt.viewProps});return Dt.params.pages.forEach(xt=>{const $t=new Ps(Dt.document,{itemProps:Vr.fromObject({selected:!1,title:xt.title}),props:Vr.fromObject({selected:!1})});gt.add($t)}),gt},api:Dt=>Dt.controller instanceof ep?new oo(Dt.controller,Dt.pool):null};class tu{constructor(){this.disabled=!1,this.emitter=new rr}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class Tp{constructor(gt,xt){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=gt,this.emitter=new rr,this.interval_=xt,this.setTimer_()}get disabled(){return this.disabled_}set disabled(gt){this.disabled_=gt,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const gt=this.doc_.defaultView;gt&&gt.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const gt=this.doc_.defaultView;gt&&(this.timerId_=gt.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class Zo{constructor(gt){this.constraints=gt}constrain(gt){return this.constraints.reduce((xt,$t)=>$t.constrain(xt),gt)}}function To(Dt,gt){if(Dt instanceof gt)return Dt;if(Dt instanceof Zo){const xt=Dt.constraints.reduce(($t,hr)=>$t||(hr instanceof gt?hr:null),null);if(xt)return xt}return null}class Al{constructor(gt){this.options=gt}constrain(gt){const xt=this.options;return xt.length===0||xt.filter($t=>$t.value===gt).length>0?gt:xt[0].value}}class Co{constructor(gt){this.maxValue=gt.max,this.minValue=gt.min}constrain(gt){let xt=gt;return bt(this.minValue)||(xt=Math.max(xt,this.minValue)),bt(this.maxValue)||(xt=Math.min(xt,this.maxValue)),xt}}class wu{constructor(gt){this.step=gt}constrain(gt){return(gt<0?-Math.round(-gt/this.step):Math.round(gt/this.step))*this.step}}const Mo=dr("lst");class xl{constructor(gt,xt){this.onValueChange_=this.onValueChange_.bind(this),this.props_=xt.props,this.element=gt.createElement("div"),this.element.classList.add(Mo()),xt.viewProps.bindClassModifiers(this.element);const $t=gt.createElement("select");$t.classList.add(Mo("s")),er(this.props_,"options",Pr=>{On($t),Pr.forEach(($r,An)=>{const zn=gt.createElement("option");zn.dataset.index=String(An),zn.textContent=$r.text,zn.value=String($r.value),$t.appendChild(zn)})}),xt.viewProps.bindDisabled($t),this.element.appendChild($t),this.selectElement=$t;const hr=gt.createElement("div");hr.classList.add(Mo("m")),hr.appendChild(mr(gt,"dropdown")),this.element.appendChild(hr),xt.value.emitter.on("change",this.onValueChange_),this.value_=xt.value,this.update_()}update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}}class Pl{constructor(gt,xt){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=xt.props,this.value=xt.value,this.viewProps=xt.viewProps,this.view=new xl(gt,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(gt){const xt=gt.currentTarget.selectedOptions.item(0);if(!xt)return;const $t=Number(xt.dataset.index);this.value.rawValue=this.props.get("options")[$t].value}}const ds=dr("pop");class Hm{constructor(gt,xt){this.element=gt.createElement("div"),this.element.classList.add(ds()),xt.viewProps.bindClassModifiers(this.element),Ht(xt.shows,pr(this.element,ds(void 0,"v")))}}class gs{constructor(gt,xt){this.shows=vr(!1),this.viewProps=xt.viewProps,this.view=new Hm(gt,{shows:this.shows,viewProps:this.viewProps})}}const ou=dr("txt");class Mp{constructor(gt,xt){this.onChange_=this.onChange_.bind(this),this.element=gt.createElement("div"),this.element.classList.add(ou()),xt.viewProps.bindClassModifiers(this.element),this.props_=xt.props,this.props_.emitter.on("change",this.onChange_);const $t=gt.createElement("input");$t.classList.add(ou("i")),$t.type="text",xt.viewProps.bindDisabled($t),this.element.appendChild($t),this.inputElement=$t,xt.value.emitter.on("change",this.onChange_),this.value_=xt.value,this.refresh()}refresh(){const gt=this.props_.get("formatter");this.inputElement.value=gt(this.value_.rawValue)}onChange_(){this.refresh()}}class Qo{constructor(gt,xt){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=xt.parser,this.props=xt.props,this.value=xt.value,this.viewProps=xt.viewProps,this.view=new Mp(gt,{props:xt.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(gt){const xt=gt.currentTarget.value,$t=this.parser_(xt);bt($t)||(this.value.rawValue=$t),this.view.refresh()}}function yo(Dt){return Dt!=="false"&&!!Dt}function vv(Dt){return function(gt){return String(gt)}(Dt)}class By{constructor(gt){this.text=gt}evaluate(){return Number(this.text)}toString(){return this.text}}const Yv={"**":(Dt,gt)=>Math.pow(Dt,gt),"*":(Dt,gt)=>Dt*gt,"/":(Dt,gt)=>Dt/gt,"%":(Dt,gt)=>Dt%gt,"+":(Dt,gt)=>Dt+gt,"-":(Dt,gt)=>Dt-gt,"<<":(Dt,gt)=>Dt<<gt,">>":(Dt,gt)=>Dt>>gt,">>>":(Dt,gt)=>Dt>>>gt,"&":(Dt,gt)=>Dt&gt,"^":(Dt,gt)=>Dt^gt,"|":(Dt,gt)=>Dt|gt};class R_{constructor(gt,xt,$t){this.left=xt,this.operator=gt,this.right=$t}evaluate(){const gt=Yv[this.operator];if(!gt)throw new Error(`unexpected binary operator: '${this.operator}`);return gt(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const Ao={"+":Dt=>Dt,"-":Dt=>-Dt,"~":Dt=>~Dt};class EA{constructor(gt,xt){this.operator=gt,this.expression=xt}evaluate(){const gt=Ao[this.operator];if(!gt)throw new Error(`unexpected unary operator: '${this.operator}`);return gt(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function I_(Dt){return(gt,xt)=>{for(let $t=0;$t<Dt.length;$t++){const hr=Dt[$t](gt,xt);if(hr!=="")return hr}return""}}function Kv(Dt,gt){var xt;const $t=Dt.substr(gt).match(/^\s+/);return(xt=$t&&$t[0])!==null&&xt!==void 0?xt:""}function Xv(Dt,gt){var xt;const $t=Dt.substr(gt).match(/^[0-9]+/);return(xt=$t&&$t[0])!==null&&xt!==void 0?xt:""}function xa(Dt,gt){const xt=Dt.substr(gt,1);if(gt+=1,xt.toLowerCase()!=="e")return"";const $t=function(hr,Pr){const $r=Xv(hr,Pr);if($r!=="")return $r;const An=hr.substr(Pr,1);if(An!=="-"&&An!=="+")return"";const zn=Xv(hr,Pr+=1);return zn===""?"":An+zn}(Dt,gt);return $t===""?"":xt+$t}function Ho(Dt,gt){const xt=Dt.substr(gt,1);if(xt==="0")return xt;const $t=function(hr,Pr){const $r=hr.substr(Pr,1);return $r.match(/^[1-9]$/)?$r:""}(Dt,gt);return gt+=$t.length,$t===""?"":$t+Xv(Dt,gt)}const _v=I_([function(Dt,gt){const xt=Ho(Dt,gt);if(gt+=xt.length,xt==="")return"";const $t=Dt.substr(gt,1);if(gt+=$t.length,$t!==".")return"";const hr=Xv(Dt,gt);return xt+$t+hr+xa(Dt,gt+=hr.length)},function(Dt,gt){const xt=Dt.substr(gt,1);if(gt+=xt.length,xt!==".")return"";const $t=Xv(Dt,gt);return gt+=$t.length,$t===""?"":xt+$t+xa(Dt,gt)},function(Dt,gt){const xt=Ho(Dt,gt);return gt+=xt.length,xt===""?"":xt+xa(Dt,gt)}]),Rp=I_([function(Dt,gt){const xt=Dt.substr(gt,2);if(gt+=xt.length,xt.toLowerCase()!=="0b")return"";const $t=function(hr,Pr){var $r;const An=hr.substr(Pr).match(/^[01]+/);return($r=An&&An[0])!==null&&$r!==void 0?$r:""}(Dt,gt);return $t===""?"":xt+$t},function(Dt,gt){const xt=Dt.substr(gt,2);if(gt+=xt.length,xt.toLowerCase()!=="0o")return"";const $t=function(hr,Pr){var $r;const An=hr.substr(Pr).match(/^[0-7]+/);return($r=An&&An[0])!==null&&$r!==void 0?$r:""}(Dt,gt);return $t===""?"":xt+$t},function(Dt,gt){const xt=Dt.substr(gt,2);if(gt+=xt.length,xt.toLowerCase()!=="0x")return"";const $t=function(hr,Pr){var $r;const An=hr.substr(Pr).match(/^[0-9a-f]+/i);return($r=An&&An[0])!==null&&$r!==void 0?$r:""}(Dt,gt);return $t===""?"":xt+$t}]),SA=I_([Rp,_v]);function P_(Dt,gt){return function(xt,$t){const hr=SA(xt,$t);return $t+=hr.length,hr===""?null:{evaluable:new By(hr),cursor:$t}}(Dt,gt)||function(xt,$t){const hr=xt.substr($t,1);if($t+=hr.length,hr!=="(")return null;const Pr=Nu(xt,$t);if(!Pr)return null;$t=Pr.cursor,$t+=Kv(xt,$t).length;const $r=xt.substr($t,1);return $t+=$r.length,$r!==")"?null:{evaluable:Pr.evaluable,cursor:$t}}(Dt,gt)}function D_(Dt,gt,xt){xt+=Kv(gt,xt).length;const $t=Dt.filter(hr=>gt.startsWith(hr,xt))[0];return $t?(xt+=$t.length,{cursor:xt+=Kv(gt,xt).length,operator:$t}):null}const I0=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((Dt,gt)=>function(xt,$t){return(hr,Pr)=>{const $r=xt(hr,Pr);if(!$r)return null;Pr=$r.cursor;let An=$r.evaluable;for(;;){const zn=D_($t,hr,Pr);if(!zn)break;Pr=zn.cursor;const Ms=xt(hr,Pr);if(!Ms)return null;Pr=Ms.cursor,An=new R_(zn.operator,An,Ms.evaluable)}return An?{cursor:Pr,evaluable:An}:null}}(Dt,gt),function Dt(gt,xt){const $t=P_(gt,xt);if($t)return $t;const hr=gt.substr(xt,1);if(xt+=hr.length,hr!=="+"&&hr!=="-"&&hr!=="~")return null;const Pr=Dt(gt,xt);return Pr?{cursor:xt=Pr.cursor,evaluable:new EA(hr,Pr.evaluable)}:null});function Nu(Dt,gt){return gt+=Kv(Dt,gt).length,I0(Dt,gt)}function Su(Dt){var gt;const xt=function($t){const hr=Nu($t,0);return hr?hr.cursor+Kv($t,hr.cursor).length!==$t.length?null:hr.evaluable:null}(Dt);return(gt=xt==null?void 0:xt.evaluate())!==null&&gt!==void 0?gt:null}function _f(Dt){if(typeof Dt=="number")return Dt;if(typeof Dt=="string"){const gt=Su(Dt);if(!bt(gt))return gt}return 0}function B_(Dt){return String(Dt)}function Ll(Dt){return gt=>gt.toFixed(Math.max(Math.min(Dt,20),0))}const CA=Ll(0);function Jv(Dt){return CA(Dt)+"%"}function Tx(Dt){return String(Dt)}function k_(Dt){return Dt}function Sm(Dt,gt){for(;Dt.length<gt;)Dt.push(void 0)}function bo(Dt){const gt=[];return Sm(gt,Dt),vr(gt)}function Nw(Dt){const gt=Dt.indexOf(void 0);return gt<0?Dt:Dt.slice(0,gt)}function O_({primary:Dt,secondary:gt,forward:xt,backward:$t}){let hr=!1;function Pr($r){hr||(hr=!0,$r(),hr=!1)}Dt.emitter.on("change",$r=>{Pr(()=>{gt.setRawValue(xt(Dt,gt),$r.options)})}),gt.emitter.on("change",$r=>{Pr(()=>{Dt.setRawValue($t(Dt,gt),$r.options)}),Pr(()=>{gt.setRawValue(xt(Dt,gt),$r.options)})}),Pr(()=>{gt.setRawValue(xt(Dt,gt),{forceEmit:!1,last:!0})})}function hp(Dt,gt){const xt=Dt*(gt.altKey?.1:1)*(gt.shiftKey?10:1);return gt.upKey?+xt:gt.downKey?-xt:0}function P0(Dt){return{altKey:Dt.altKey,downKey:Dt.key==="ArrowDown",shiftKey:Dt.shiftKey,upKey:Dt.key==="ArrowUp"}}function Fu(Dt){return{altKey:Dt.altKey,downKey:Dt.key==="ArrowLeft",shiftKey:Dt.shiftKey,upKey:Dt.key==="ArrowRight"}}function Uu(Dt){return function(gt){return gt==="ArrowUp"||gt==="ArrowDown"}(Dt)||Dt==="ArrowLeft"||Dt==="ArrowRight"}function L_(Dt,gt){const xt=gt.ownerDocument.defaultView,$t=gt.getBoundingClientRect();return{x:Dt.pageX-((xt&&xt.scrollX||0)+$t.left),y:Dt.pageY-((xt&&xt.scrollY||0)+$t.top)}}class $u{constructor(gt){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=gt,this.emitter=new rr,gt.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),gt.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),gt.addEventListener("touchend",this.onTouchEnd_),gt.addEventListener("mousedown",this.onMouseDown_)}computePosition_(gt){const xt=this.elem_.getBoundingClientRect();return{bounds:{width:xt.width,height:xt.height},point:gt?{x:gt.x,y:gt.y}:null}}onMouseDown_(gt){var xt;gt.preventDefault(),(xt=gt.currentTarget)===null||xt===void 0||xt.focus();const $t=this.elem_.ownerDocument;$t.addEventListener("mousemove",this.onDocumentMouseMove_),$t.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:gt.altKey,data:this.computePosition_(L_(gt,this.elem_)),sender:this,shiftKey:gt.shiftKey})}onDocumentMouseMove_(gt){this.emitter.emit("move",{altKey:gt.altKey,data:this.computePosition_(L_(gt,this.elem_)),sender:this,shiftKey:gt.shiftKey})}onDocumentMouseUp_(gt){const xt=this.elem_.ownerDocument;xt.removeEventListener("mousemove",this.onDocumentMouseMove_),xt.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:gt.altKey,data:this.computePosition_(L_(gt,this.elem_)),sender:this,shiftKey:gt.shiftKey})}onTouchStart_(gt){gt.preventDefault();const xt=gt.targetTouches.item(0),$t=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:gt.altKey,data:this.computePosition_(xt?{x:xt.clientX-$t.left,y:xt.clientY-$t.top}:void 0),sender:this,shiftKey:gt.shiftKey}),this.lastTouch_=xt}onTouchMove_(gt){const xt=gt.targetTouches.item(0),$t=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:gt.altKey,data:this.computePosition_(xt?{x:xt.clientX-$t.left,y:xt.clientY-$t.top}:void 0),sender:this,shiftKey:gt.shiftKey}),this.lastTouch_=xt}onTouchEnd_(gt){var xt;const $t=(xt=gt.targetTouches.item(0))!==null&&xt!==void 0?xt:this.lastTouch_,hr=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:gt.altKey,data:this.computePosition_($t?{x:$t.clientX-hr.left,y:$t.clientY-hr.top}:void 0),sender:this,shiftKey:gt.shiftKey})}}function Ro(Dt,gt,xt,$t,hr){return $t+(Dt-gt)/(xt-gt)*(hr-$t)}function Ru(Dt){return String(Dt.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function na(Dt,gt,xt){return Math.min(Math.max(Dt,gt),xt)}function TA(Dt,gt){return(Dt%gt+gt)%gt}const em=dr("txt");class Zv{constructor(gt,xt){this.onChange_=this.onChange_.bind(this),this.props_=xt.props,this.props_.emitter.on("change",this.onChange_),this.element=gt.createElement("div"),this.element.classList.add(em(),em(void 0,"num")),xt.arrayPosition&&this.element.classList.add(em(void 0,xt.arrayPosition)),xt.viewProps.bindClassModifiers(this.element);const $t=gt.createElement("input");$t.classList.add(em("i")),$t.type="text",xt.viewProps.bindDisabled($t),this.element.appendChild($t),this.inputElement=$t,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=xt.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(em()),this.inputElement.classList.add(em("i"));const hr=gt.createElement("div");hr.classList.add(em("k")),this.element.appendChild(hr),this.knobElement=hr;const Pr=gt.createElementNS(yr,"svg");Pr.classList.add(em("g")),this.knobElement.appendChild(Pr);const $r=gt.createElementNS(yr,"path");$r.classList.add(em("gb")),Pr.appendChild($r),this.guideBodyElem_=$r;const An=gt.createElementNS(yr,"path");An.classList.add(em("gh")),Pr.appendChild(An),this.guideHeadElem_=An;const zn=gt.createElement("div");zn.classList.add(dr("tt")()),this.knobElement.appendChild(zn),this.tooltipElem_=zn,xt.value.emitter.on("change",this.onChange_),this.value=xt.value,this.refresh()}onDraggingChange_(gt){if(gt.rawValue===null)return void this.element.classList.remove(em(void 0,"drg"));this.element.classList.add(em(void 0,"drg"));const xt=gt.rawValue/this.props_.get("draggingScale"),$t=xt+(xt>0?-1:xt<0?1:0),hr=na(-$t,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${$t+hr},0 L${$t},4 L${$t+hr},8`,`M ${xt},-1 L${xt},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${xt},4`);const Pr=this.props_.get("formatter");this.tooltipElem_.textContent=Pr(this.value.rawValue),this.tooltipElem_.style.left=`${xt}px`}refresh(){const gt=this.props_.get("formatter");this.inputElement.value=gt(this.value.rawValue)}onChange_(){this.refresh()}}class N_{constructor(gt,xt){this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=xt.baseStep,this.parser_=xt.parser,this.props=xt.props,this.value=xt.value,this.viewProps=xt.viewProps,this.dragging_=vr(null),this.view=new Zv(gt,{arrayPosition:xt.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const $t=new $u(this.view.knobElement);$t.emitter.on("down",this.onPointerDown_),$t.emitter.on("move",this.onPointerMove_),$t.emitter.on("up",this.onPointerUp_)}onInputChange_(gt){const xt=gt.currentTarget.value,$t=this.parser_(xt);bt($t)||(this.value.rawValue=$t),this.view.refresh()}onInputKeyDown_(gt){const xt=hp(this.baseStep_,P0(gt));xt!==0&&this.value.setRawValue(this.value.rawValue+xt,{forceEmit:!1,last:!1})}onInputKeyUp_(gt){hp(this.baseStep_,P0(gt))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(gt){if(!gt.point)return null;const xt=gt.point.x-gt.bounds.width/2;return this.originRawValue_+xt*this.props.get("draggingScale")}onPointerMove_(gt){const xt=this.computeDraggingValue_(gt.data);xt!==null&&(this.value.setRawValue(xt,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(gt){const xt=this.computeDraggingValue_(gt.data);xt!==null&&(this.value.setRawValue(xt,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Wl=dr("sld");class Fw{constructor(gt,xt){this.onChange_=this.onChange_.bind(this),this.props_=xt.props,this.props_.emitter.on("change",this.onChange_),this.element=gt.createElement("div"),this.element.classList.add(Wl()),xt.viewProps.bindClassModifiers(this.element);const $t=gt.createElement("div");$t.classList.add(Wl("t")),xt.viewProps.bindTabIndex($t),this.element.appendChild($t),this.trackElement=$t;const hr=gt.createElement("div");hr.classList.add(Wl("k")),this.trackElement.appendChild(hr),this.knobElement=hr,xt.value.emitter.on("change",this.onChange_),this.value=xt.value,this.update_()}update_(){const gt=na(Ro(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${gt}%`}onChange_(){this.update_()}}class Uw{constructor(gt,xt){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=xt.baseStep,this.value=xt.value,this.viewProps=xt.viewProps,this.props=xt.props,this.view=new Fw(gt,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new $u(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(gt,xt){gt.point&&this.value.setRawValue(Ro(na(gt.point.x,0,gt.bounds.width),0,gt.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),xt)}onPointerDownOrMove_(gt){this.handlePointerEvent_(gt.data,{forceEmit:!1,last:!1})}onPointerUp_(gt){this.handlePointerEvent_(gt.data,{forceEmit:!0,last:!0})}onKeyDown_(gt){const xt=hp(this.baseStep_,Fu(gt));xt!==0&&this.value.setRawValue(this.value.rawValue+xt,{forceEmit:!1,last:!1})}onKeyUp_(gt){hp(this.baseStep_,Fu(gt))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const tp=dr("sldtxt");class $w{constructor(gt,xt){this.element=gt.createElement("div"),this.element.classList.add(tp());const $t=gt.createElement("div");$t.classList.add(tp("s")),this.sliderView_=xt.sliderView,$t.appendChild(this.sliderView_.element),this.element.appendChild($t);const hr=gt.createElement("div");hr.classList.add(tp("t")),this.textView_=xt.textView,hr.appendChild(this.textView_.element),this.element.appendChild(hr)}}class tm{constructor(gt,xt){this.value=xt.value,this.viewProps=xt.viewProps,this.sliderC_=new Uw(gt,{baseStep:xt.baseStep,props:xt.sliderProps,value:xt.value,viewProps:this.viewProps}),this.textC_=new N_(gt,{baseStep:xt.baseStep,parser:xt.parser,props:xt.textProps,value:xt.value,viewProps:xt.viewProps}),this.view=new $w(gt,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function e_(Dt,gt){Dt.write(gt)}function D0(Dt){const gt=gn;return Array.isArray(Dt)?gt.required.array(gt.required.object({text:gt.required.string,value:gt.required.raw}))(Dt).value:typeof Dt=="object"?gt.required.raw(Dt).value:void 0}function Mx(Dt){if(Dt==="inline"||Dt==="popup")return Dt}function qm(Dt){const gt=gn;return gt.required.object({max:gt.optional.number,min:gt.optional.number,step:gt.optional.number})(Dt).value}function F_(Dt){if(Array.isArray(Dt))return Dt;const gt=[];return Object.keys(Dt).forEach(xt=>{gt.push({text:xt,value:Dt[xt]})}),gt}function Yl(Dt){return bt(Dt)?null:new Al(F_(Dt))}function MA(Dt){const gt=Dt?To(Dt,Al):null;return gt?gt.options:null}function RA(Dt,gt){const xt=Dt&&To(Dt,wu);return xt?Ru(xt.step):Math.max(Ru(gt),2)}function yv(Dt){const gt=function(xt){const $t=xt?To(xt,wu):null;return $t?$t.step:null}(Dt);return gt??1}function U_(Dt,gt){var xt;const $t=Dt&&To(Dt,wu),hr=Math.abs((xt=$t==null?void 0:$t.step)!==null&&xt!==void 0?xt:gt);return hr===0?.1:Math.pow(10,Math.floor(Math.log10(hr))-1)}const B0=dr("ckb");class IA{constructor(gt,xt){this.onValueChange_=this.onValueChange_.bind(this),this.element=gt.createElement("div"),this.element.classList.add(B0()),xt.viewProps.bindClassModifiers(this.element);const $t=gt.createElement("label");$t.classList.add(B0("l")),this.element.appendChild($t);const hr=gt.createElement("input");hr.classList.add(B0("i")),hr.type="checkbox",$t.appendChild(hr),this.inputElement=hr,xt.viewProps.bindDisabled(this.inputElement);const Pr=gt.createElement("div");Pr.classList.add(B0("w")),$t.appendChild(Pr);const $r=mr(gt,"check");Pr.appendChild($r),xt.value.emitter.on("change",this.onValueChange_),this.value=xt.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class US{constructor(gt,xt){this.onInputChange_=this.onInputChange_.bind(this),this.value=xt.value,this.viewProps=xt.viewProps,this.view=new IA(gt,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(gt){const xt=gt.currentTarget;this.value.rawValue=xt.checked}}const Rx={id:"input-bool",type:"input",accept:(Dt,gt)=>{if(typeof Dt!="boolean")return null;const xt=tn(gt,{options:gn.optional.custom(D0)});return xt?{initialValue:Dt,params:xt}:null},binding:{reader:Dt=>yo,constraint:Dt=>function(gt){const xt=[],$t=Yl(gt.options);return $t&&xt.push($t),new Zo(xt)}(Dt.params),writer:Dt=>e_},controller:Dt=>{var gt;const xt=Dt.document,$t=Dt.value,hr=Dt.constraint;return hr&&To(hr,Al)?new Pl(xt,{props:Vr.fromObject({options:(gt=MA(hr))!==null&&gt!==void 0?gt:[]}),value:$t,viewProps:Dt.viewProps}):new US(xt,{value:$t,viewProps:Dt.viewProps})}},Av=dr("col");class PA{constructor(gt,xt){this.element=gt.createElement("div"),this.element.classList.add(Av()),xt.foldable.bindExpandedClass(this.element,Av(void 0,"expanded")),er(xt.foldable,"completed",pr(this.element,Av(void 0,"cpl")));const $t=gt.createElement("div");$t.classList.add(Av("h")),this.element.appendChild($t);const hr=gt.createElement("div");hr.classList.add(Av("s")),$t.appendChild(hr),this.swatchElement=hr;const Pr=gt.createElement("div");if(Pr.classList.add(Av("t")),$t.appendChild(Pr),this.textElement=Pr,xt.pickerLayout==="inline"){const $r=gt.createElement("div");$r.classList.add(Av("p")),this.element.appendChild($r),this.pickerElement=$r}else this.pickerElement=null}}function Ws(Dt,gt,xt){const $t=TA(Dt,360),hr=na(gt/100,0,1),Pr=na(xt/100,0,1),$r=Pr*hr,An=$r*(1-Math.abs($t/60%2-1)),zn=Pr-$r;let Ms,Us,xs;return[Ms,Us,xs]=$t>=0&&$t<60?[$r,An,0]:$t>=60&&$t<120?[An,$r,0]:$t>=120&&$t<180?[0,$r,An]:$t>=180&&$t<240?[0,An,$r]:$t>=240&&$t<300?[An,0,$r]:[$r,0,An],[255*(Ms+zn),255*(Us+zn),255*(xs+zn)]}function du(Dt){return[Dt[0],Dt[1],Dt[2]]}function jw(Dt,gt){return[Dt[0],Dt[1],Dt[2],gt]}const $_={hsl:{hsl:(Dt,gt,xt)=>[Dt,gt,xt],hsv:function(Dt,gt,xt){const $t=xt+gt*(100-Math.abs(2*xt-100))/200;return[Dt,$t!==0?gt*(100-Math.abs(2*xt-100))/$t:0,xt+gt*(100-Math.abs(2*xt-100))/200]},rgb:function(Dt,gt,xt){const $t=(Dt%360+360)%360,hr=na(gt/100,0,1),Pr=na(xt/100,0,1),$r=(1-Math.abs(2*Pr-1))*hr,An=$r*(1-Math.abs($t/60%2-1)),zn=Pr-$r/2;let Ms,Us,xs;return[Ms,Us,xs]=$t>=0&&$t<60?[$r,An,0]:$t>=60&&$t<120?[An,$r,0]:$t>=120&&$t<180?[0,$r,An]:$t>=180&&$t<240?[0,An,$r]:$t>=240&&$t<300?[An,0,$r]:[$r,0,An],[255*(Ms+zn),255*(Us+zn),255*(xs+zn)]}},hsv:{hsl:function(Dt,gt,xt){const $t=100-Math.abs(xt*(200-gt)/100-100);return[Dt,$t!==0?gt*xt/$t:0,xt*(200-gt)/200]},hsv:(Dt,gt,xt)=>[Dt,gt,xt],rgb:Ws},rgb:{hsl:function(Dt,gt,xt){const $t=na(Dt/255,0,1),hr=na(gt/255,0,1),Pr=na(xt/255,0,1),$r=Math.max($t,hr,Pr),An=Math.min($t,hr,Pr),zn=$r-An;let Ms=0,Us=0;const xs=(An+$r)/2;return zn!==0&&(Us=zn/(1-Math.abs($r+An-1)),Ms=$t===$r?(hr-Pr)/zn:hr===$r?2+(Pr-$t)/zn:4+($t-hr)/zn,Ms=Ms/6+(Ms<0?1:0)),[360*Ms,100*Us,100*xs]},hsv:function(Dt,gt,xt){const $t=na(Dt/255,0,1),hr=na(gt/255,0,1),Pr=na(xt/255,0,1),$r=Math.max($t,hr,Pr),An=$r-Math.min($t,hr,Pr);let zn;return zn=An===0?0:$r===$t?((hr-Pr)/An%6+6)%6*60:$r===hr?60*((Pr-$t)/An+2):60*(($t-hr)/An+4),[zn,100*($r===0?0:An/$r),100*$r]},rgb:(Dt,gt,xt)=>[Dt,gt,xt]}},ky={hsl:Dt=>{var gt;return[TA(Dt[0],360),na(Dt[1],0,100),na(Dt[2],0,100),na((gt=Dt[3])!==null&&gt!==void 0?gt:1,0,1)]},hsv:Dt=>{var gt;return[TA(Dt[0],360),na(Dt[1],0,100),na(Dt[2],0,100),na((gt=Dt[3])!==null&&gt!==void 0?gt:1,0,1)]},rgb:Dt=>{var gt;return[na(Dt[0],0,255),na(Dt[1],0,255),na(Dt[2],0,255),na((gt=Dt[3])!==null&&gt!==void 0?gt:1,0,1)]}};function rp(Dt,gt){return typeof Dt=="object"&&!bt(Dt)&&gt in Dt&&typeof Dt[gt]=="number"}class Ls{constructor(gt,xt){this.mode_=xt,this.comps_=ky[xt](gt)}static black(){return new Ls([0,0,0],"rgb")}static fromObject(gt){const xt="a"in gt?[gt.r,gt.g,gt.b,gt.a]:[gt.r,gt.g,gt.b];return new Ls(xt,"rgb")}static toRgbaObject(gt){return gt.toRgbaObject()}static isRgbColorObject(gt){return rp(gt,"r")&&rp(gt,"g")&&rp(gt,"b")}static isRgbaColorObject(gt){return this.isRgbColorObject(gt)&&rp(gt,"a")}static isColorObject(gt){return this.isRgbColorObject(gt)}static equals(gt,xt){if(gt.mode_!==xt.mode_)return!1;const $t=gt.comps_,hr=xt.comps_;for(let Pr=0;Pr<$t.length;Pr++)if($t[Pr]!==hr[Pr])return!1;return!0}get mode(){return this.mode_}getComponents(gt){return jw((xt=du(this.comps_),$t=this.mode_,hr=gt||this.mode_,$_[$t][hr](...xt)),this.comps_[3]);var xt,$t,hr}toRgbaObject(){const gt=this.getComponents("rgb");return{r:gt[0],g:gt[1],b:gt[2],a:gt[3]}}}const Wm=dr("colp");class Oy{constructor(gt,xt){this.alphaViews_=null,this.element=gt.createElement("div"),this.element.classList.add(Wm());const $t=gt.createElement("div");$t.classList.add(Wm("hsv"));const hr=gt.createElement("div");hr.classList.add(Wm("sv")),this.svPaletteView_=xt.svPaletteView,hr.appendChild(this.svPaletteView_.element),$t.appendChild(hr);const Pr=gt.createElement("div");Pr.classList.add(Wm("h")),this.hPaletteView_=xt.hPaletteView,Pr.appendChild(this.hPaletteView_.element),$t.appendChild(Pr),this.element.appendChild($t);const $r=gt.createElement("div");if($r.classList.add(Wm("rgb")),this.textView_=xt.textView,$r.appendChild(this.textView_.element),this.element.appendChild($r),xt.alphaViews){this.alphaViews_={palette:xt.alphaViews.palette,text:xt.alphaViews.text};const An=gt.createElement("div");An.classList.add(Wm("a"));const zn=gt.createElement("div");zn.classList.add(Wm("ap")),zn.appendChild(this.alphaViews_.palette.element),An.appendChild(zn);const Ms=gt.createElement("div");Ms.classList.add(Wm("at")),Ms.appendChild(this.alphaViews_.text.element),An.appendChild(Ms),this.element.appendChild(An)}}get allFocusableElements(){const gt=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map(xt=>xt.inputElement)];return this.alphaViews_&&gt.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),gt}}function Ly(Dt){const gt=gn;return tn(Dt,{alpha:gt.optional.boolean,expanded:gt.optional.boolean,picker:gt.optional.custom(Mx)})}function t_(Dt){return Dt?.1:1}function fp(Dt,gt){const xt=Dt.match(/^(.+)%$/);return Math.min(xt?.01*parseFloat(xt[1])*gt:parseFloat(Dt),gt)}const bv={deg:Dt=>Dt,grad:Dt=>360*Dt/400,rad:Dt=>360*Dt/(2*Math.PI),turn:Dt=>360*Dt};function Tl(Dt){const gt=Dt.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!gt)return parseFloat(Dt);const xt=parseFloat(gt[1]),$t=gt[2];return bv[$t](xt)}const DA={"func.rgb":Dt=>{const gt=Dt.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!gt)return null;const xt=[fp(gt[1],255),fp(gt[2],255),fp(gt[3],255)];return isNaN(xt[0])||isNaN(xt[1])||isNaN(xt[2])?null:new Ls(xt,"rgb")},"func.rgba":Dt=>{const gt=Dt.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!gt)return null;const xt=[fp(gt[1],255),fp(gt[2],255),fp(gt[3],255),fp(gt[4],1)];return isNaN(xt[0])||isNaN(xt[1])||isNaN(xt[2])||isNaN(xt[3])?null:new Ls(xt,"rgb")},"func.hsl":Dt=>{const gt=Dt.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!gt)return null;const xt=[Tl(gt[1]),fp(gt[2],100),fp(gt[3],100)];return isNaN(xt[0])||isNaN(xt[1])||isNaN(xt[2])?null:new Ls(xt,"hsl")},"func.hsla":Dt=>{const gt=Dt.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!gt)return null;const xt=[Tl(gt[1]),fp(gt[2],100),fp(gt[3],100),fp(gt[4],1)];return isNaN(xt[0])||isNaN(xt[1])||isNaN(xt[2])||isNaN(xt[3])?null:new Ls(xt,"hsl")},"hex.rgb":Dt=>{const gt=Dt.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(gt)return new Ls([parseInt(gt[1]+gt[1],16),parseInt(gt[2]+gt[2],16),parseInt(gt[3]+gt[3],16)],"rgb");const xt=Dt.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return xt?new Ls([parseInt(xt[1],16),parseInt(xt[2],16),parseInt(xt[3],16)],"rgb"):null},"hex.rgba":Dt=>{const gt=Dt.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(gt)return new Ls([parseInt(gt[1]+gt[1],16),parseInt(gt[2]+gt[2],16),parseInt(gt[3]+gt[3],16),Ro(parseInt(gt[4]+gt[4],16),0,255,0,1)],"rgb");const xt=Dt.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return xt?new Ls([parseInt(xt[1],16),parseInt(xt[2],16),parseInt(xt[3],16),Ro(parseInt(xt[4],16),0,255,0,1)],"rgb"):null}};function Vn(Dt){return Object.keys(DA).reduce((gt,xt)=>gt||((0,DA[xt])(Dt)?xt:null),null)}const ju=Dt=>{const gt=Vn(Dt);return gt?DA[gt](Dt):null};function Ix(Dt){return Dt==="func.hsla"||Dt==="func.rgba"||Dt==="hex.rgba"}function zw(Dt){if(typeof Dt=="string"){const gt=ju(Dt);if(gt)return gt}return Ls.black()}function j_(Dt){const gt=na(Math.floor(Dt),0,255).toString(16);return gt.length===1?`0${gt}`:gt}function z_(Dt,gt="#"){return`${gt}${du(Dt.getComponents("rgb")).map(j_).join("")}`}function Cm(Dt,gt="#"){const xt=Dt.getComponents("rgb");return`${gt}${[xt[0],xt[1],xt[2],255*xt[3]].map(j_).join("")}`}function Ny(Dt){const gt=Ll(0);return`rgb(${du(Dt.getComponents("rgb")).map(xt=>gt(xt)).join(", ")})`}function k0(Dt){const gt=Ll(2),xt=Ll(0);return`rgba(${Dt.getComponents("rgb").map(($t,hr)=>(hr===3?gt:xt)($t)).join(", ")})`}const np={"func.hsl":function(Dt){const gt=[Ll(0),Jv,Jv];return`hsl(${du(Dt.getComponents("hsl")).map((xt,$t)=>gt[$t](xt)).join(", ")})`},"func.hsla":function(Dt){const gt=[Ll(0),Jv,Jv,Ll(2)];return`hsla(${Dt.getComponents("hsl").map((xt,$t)=>gt[$t](xt)).join(", ")})`},"func.rgb":Ny,"func.rgba":k0,"hex.rgb":z_,"hex.rgba":Cm};function BA(Dt){return np[Dt]}const Kl=dr("apl");class rm{constructor(gt,xt){this.onValueChange_=this.onValueChange_.bind(this),this.value=xt.value,this.value.emitter.on("change",this.onValueChange_),this.element=gt.createElement("div"),this.element.classList.add(Kl()),xt.viewProps.bindTabIndex(this.element);const $t=gt.createElement("div");$t.classList.add(Kl("b")),this.element.appendChild($t);const hr=gt.createElement("div");hr.classList.add(Kl("c")),$t.appendChild(hr),this.colorElem_=hr;const Pr=gt.createElement("div");Pr.classList.add(Kl("m")),this.element.appendChild(Pr),this.markerElem_=Pr;const $r=gt.createElement("div");$r.classList.add(Kl("p")),this.markerElem_.appendChild($r),this.previewElem_=$r,this.update_()}update_(){const gt=this.value.rawValue,xt=gt.getComponents("rgb"),$t=new Ls([xt[0],xt[1],xt[2],0],"rgb"),hr=new Ls([xt[0],xt[1],xt[2],255],"rgb"),Pr=["to right",k0($t),k0(hr)];this.colorElem_.style.background=`linear-gradient(${Pr.join(",")})`,this.previewElem_.style.backgroundColor=k0(gt);const $r=Ro(xt[3],0,1,0,100);this.markerElem_.style.left=`${$r}%`}onValueChange_(){this.update_()}}class O0{constructor(gt,xt){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=xt.value,this.viewProps=xt.viewProps,this.view=new rm(gt,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new $u(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(gt,xt){if(!gt.point)return;const $t=gt.point.x/gt.bounds.width,hr=this.value.rawValue,[Pr,$r,An]=hr.getComponents("hsv");this.value.setRawValue(new Ls([Pr,$r,An,$t],"hsv"),xt)}onPointerDown_(gt){this.handlePointerEvent_(gt.data,{forceEmit:!1,last:!1})}onPointerMove_(gt){this.handlePointerEvent_(gt.data,{forceEmit:!1,last:!1})}onPointerUp_(gt){this.handlePointerEvent_(gt.data,{forceEmit:!0,last:!0})}onKeyDown_(gt){const xt=hp(t_(!0),Fu(gt));if(xt===0)return;const $t=this.value.rawValue,[hr,Pr,$r,An]=$t.getComponents("hsv");this.value.setRawValue(new Ls([hr,Pr,$r,An+xt],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(gt){hp(t_(!0),Fu(gt))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const jp=dr("coltxt");class kA{constructor(gt,xt){this.element=gt.createElement("div"),this.element.classList.add(jp());const $t=gt.createElement("div");$t.classList.add(jp("m")),this.modeElem_=function($r){const An=$r.createElement("select");return An.appendChild([{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}].reduce((zn,Ms)=>{const Us=$r.createElement("option");return Us.textContent=Ms.text,Us.value=Ms.value,zn.appendChild(Us),zn},$r.createDocumentFragment())),An}(gt),this.modeElem_.classList.add(jp("ms")),$t.appendChild(this.modeSelectElement);const hr=gt.createElement("div");hr.classList.add(jp("mm")),hr.appendChild(mr(gt,"dropdown")),$t.appendChild(hr),this.element.appendChild($t);const Pr=gt.createElement("div");Pr.classList.add(jp("w")),this.element.appendChild(Pr),this.textsElem_=Pr,this.textViews_=xt.textViews,this.applyTextViews_(),Ht(xt.colorMode,$r=>{this.modeElem_.value=$r})}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(gt){this.textViews_=gt,this.applyTextViews_()}applyTextViews_(){On(this.textsElem_);const gt=this.element.ownerDocument;this.textViews_.forEach(xt=>{const $t=gt.createElement("div");$t.classList.add(jp("c")),$t.appendChild(xt.element),this.textsElem_.appendChild($t)})}}const ms=Ll(0),nm={rgb:()=>new Co({min:0,max:255}),hsl:Dt=>new Co(Dt===0?{min:0,max:360}:{min:0,max:100}),hsv:Dt=>new Co(Dt===0?{min:0,max:360}:{min:0,max:100})};function Fy(Dt,gt,xt){return new N_(Dt,{arrayPosition:xt===0?"fst":xt===2?"lst":"mid",baseStep:t_(!1),parser:gt.parser,props:Vr.fromObject({draggingScale:1,formatter:ms}),value:vr(0,{constraint:nm[gt.colorMode](xt)}),viewProps:gt.viewProps})}class V_{constructor(gt,xt){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.parser_=xt.parser,this.value=xt.value,this.viewProps=xt.viewProps,this.colorMode=vr(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(gt),this.view=new kA(gt,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(gt){const xt={colorMode:this.colorMode.rawValue,parser:this.parser_,viewProps:this.viewProps},$t=[Fy(gt,xt,0),Fy(gt,xt,1),Fy(gt,xt,2)];return $t.forEach((hr,Pr)=>{O_({primary:this.value,secondary:hr.value,forward:$r=>$r.rawValue.getComponents(this.colorMode.rawValue)[Pr],backward:($r,An)=>{const zn=this.colorMode.rawValue,Ms=$r.rawValue.getComponents(zn);return Ms[Pr]=An.rawValue,new Ls(jw(du(Ms),Ms[3]),zn)}})}),$t}onModeSelectChange_(gt){const xt=gt.currentTarget;this.colorMode.rawValue=xt.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const L0=dr("hpl");class Vw{constructor(gt,xt){this.onValueChange_=this.onValueChange_.bind(this),this.value=xt.value,this.value.emitter.on("change",this.onValueChange_),this.element=gt.createElement("div"),this.element.classList.add(L0()),xt.viewProps.bindTabIndex(this.element);const $t=gt.createElement("div");$t.classList.add(L0("c")),this.element.appendChild($t);const hr=gt.createElement("div");hr.classList.add(L0("m")),this.element.appendChild(hr),this.markerElem_=hr,this.update_()}update_(){const gt=this.value.rawValue,[xt]=gt.getComponents("hsv");this.markerElem_.style.backgroundColor=Ny(new Ls([xt,100,100],"hsv"));const $t=Ro(xt,0,360,0,100);this.markerElem_.style.left=`${$t}%`}onValueChange_(){this.update_()}}class Cu{constructor(gt,xt){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=xt.value,this.viewProps=xt.viewProps,this.view=new Vw(gt,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new $u(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(gt,xt){if(!gt.point)return;const $t=Ro(na(gt.point.x,0,gt.bounds.width),0,gt.bounds.width,0,359),hr=this.value.rawValue,[,Pr,$r,An]=hr.getComponents("hsv");this.value.setRawValue(new Ls([$t,Pr,$r,An],"hsv"),xt)}onPointerDown_(gt){this.handlePointerEvent_(gt.data,{forceEmit:!1,last:!1})}onPointerMove_(gt){this.handlePointerEvent_(gt.data,{forceEmit:!1,last:!1})}onPointerUp_(gt){this.handlePointerEvent_(gt.data,{forceEmit:!0,last:!0})}onKeyDown_(gt){const xt=hp(t_(!1),Fu(gt));if(xt===0)return;const $t=this.value.rawValue,[hr,Pr,$r,An]=$t.getComponents("hsv");this.value.setRawValue(new Ls([hr+xt,Pr,$r,An],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(gt){hp(t_(!1),Fu(gt))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const qo=dr("svp");class Ip{constructor(gt,xt){this.onValueChange_=this.onValueChange_.bind(this),this.value=xt.value,this.value.emitter.on("change",this.onValueChange_),this.element=gt.createElement("div"),this.element.classList.add(qo()),xt.viewProps.bindTabIndex(this.element);const $t=gt.createElement("canvas");$t.height=64,$t.width=64,$t.classList.add(qo("c")),this.element.appendChild($t),this.canvasElement=$t;const hr=gt.createElement("div");hr.classList.add(qo("m")),this.element.appendChild(hr),this.markerElem_=hr,this.update_()}update_(){const gt=function(Ms){const Us=Ms.ownerDocument.defaultView;return Us&&"document"in Us?Ms.getContext("2d"):null}(this.canvasElement);if(!gt)return;const xt=this.value.rawValue.getComponents("hsv"),$t=this.canvasElement.width,hr=this.canvasElement.height,Pr=gt.getImageData(0,0,$t,hr),$r=Pr.data;for(let Ms=0;Ms<hr;Ms++)for(let Us=0;Us<$t;Us++){const xs=Ro(Us,0,$t,0,100),Fl=Ro(Ms,0,hr,100,0),pu=Ws(xt[0],xs,Fl),fm=4*(Ms*$t+Us);$r[fm]=pu[0],$r[fm+1]=pu[1],$r[fm+2]=pu[2],$r[fm+3]=255}gt.putImageData(Pr,0,0);const An=Ro(xt[1],0,100,0,100);this.markerElem_.style.left=`${An}%`;const zn=Ro(xt[2],0,100,100,0);this.markerElem_.style.top=`${zn}%`}onValueChange_(){this.update_()}}class N0{constructor(gt,xt){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=xt.value,this.viewProps=xt.viewProps,this.view=new Ip(gt,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new $u(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(gt,xt){if(!gt.point)return;const $t=Ro(gt.point.x,0,gt.bounds.width,0,100),hr=Ro(gt.point.y,0,gt.bounds.height,100,0),[Pr,,,$r]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new Ls([Pr,$t,hr,$r],"hsv"),xt)}onPointerDown_(gt){this.handlePointerEvent_(gt.data,{forceEmit:!1,last:!1})}onPointerMove_(gt){this.handlePointerEvent_(gt.data,{forceEmit:!1,last:!1})}onPointerUp_(gt){this.handlePointerEvent_(gt.data,{forceEmit:!0,last:!0})}onKeyDown_(gt){Uu(gt.key)&&gt.preventDefault();const[xt,$t,hr,Pr]=this.value.rawValue.getComponents("hsv"),$r=t_(!1),An=hp($r,Fu(gt)),zn=hp($r,P0(gt));An===0&&zn===0||this.value.setRawValue(new Ls([xt,$t+An,hr+zn,Pr],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(gt){const xt=t_(!1),$t=hp(xt,Fu(gt)),hr=hp(xt,P0(gt));$t===0&&hr===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Px{constructor(gt,xt){this.value=xt.value,this.viewProps=xt.viewProps,this.hPaletteC_=new Cu(gt,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new N0(gt,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=xt.supportsAlpha?{palette:new O0(gt,{value:this.value,viewProps:this.viewProps}),text:new N_(gt,{parser:Su,baseStep:.1,props:Vr.fromObject({draggingScale:.01,formatter:Ll(2)}),value:vr(0,{constraint:new Co({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&O_({primary:this.value,secondary:this.alphaIcs_.text.value,forward:$t=>$t.rawValue.getComponents()[3],backward:($t,hr)=>{const Pr=$t.rawValue.getComponents();return Pr[3]=hr.rawValue,new Ls(Pr,$t.rawValue.mode)}}),this.textC_=new V_(gt,{parser:Su,value:this.value,viewProps:this.viewProps}),this.view=new Oy(gt,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:xt.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}get textController(){return this.textC_}}const G_=dr("colsw");class OA{constructor(gt,xt){this.onValueChange_=this.onValueChange_.bind(this),xt.value.emitter.on("change",this.onValueChange_),this.value=xt.value,this.element=gt.createElement("div"),this.element.classList.add(G_()),xt.viewProps.bindClassModifiers(this.element);const $t=gt.createElement("div");$t.classList.add(G_("sw")),this.element.appendChild($t),this.swatchElem_=$t;const hr=gt.createElement("button");hr.classList.add(G_("b")),xt.viewProps.bindDisabled(hr),this.element.appendChild(hr),this.buttonElement=hr,this.update_()}update_(){const gt=this.value.rawValue;this.swatchElem_.style.backgroundColor=Cm(gt)}onValueChange_(){this.update_()}}class im{constructor(gt,xt){this.value=xt.value,this.viewProps=xt.viewProps,this.view=new OA(gt,{value:this.value,viewProps:this.viewProps})}}class zu{constructor(gt,xt){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=xt.value,this.viewProps=xt.viewProps,this.foldable_=js.create(xt.expanded),this.swatchC_=new im(gt,{value:this.value,viewProps:this.viewProps});const $t=this.swatchC_.view.buttonElement;$t.addEventListener("blur",this.onButtonBlur_),$t.addEventListener("click",this.onButtonClick_),this.textC_=new Qo(gt,{parser:xt.parser,props:Vr.fromObject({formatter:xt.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new PA(gt,{foldable:this.foldable_,pickerLayout:xt.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=xt.pickerLayout==="popup"?new gs(gt,{viewProps:this.viewProps}):null;const hr=new Px(gt,{supportsAlpha:xt.supportsAlpha,value:this.value,viewProps:this.viewProps});hr.view.allFocusableElements.forEach(Pr=>{Pr.addEventListener("blur",this.onPopupChildBlur_),Pr.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=hr,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(hr.view.element),O_({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:Pr=>Pr.rawValue,backward:(Pr,$r)=>$r.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),uo(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(gt){if(!this.popC_)return;const xt=this.view.element,$t=gt.relatedTarget;$t&&xt.contains($t)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(gt){if(!this.popC_)return;const xt=this.popC_.view.element,$t=$n(gt);$t&&xt.contains($t)||$t&&$t===this.swatchC_.view.buttonElement&&!sn(xt.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(gt){this.popC_?gt.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&gt.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function Mr(Dt){return Ls.isColorObject(Dt)?Ls.fromObject(Dt):Ls.black()}function wv(Dt){return du(Dt.getComponents("rgb")).reduce((gt,xt)=>gt<<8|255&Math.floor(xt),0)}function sm(Dt){return Dt.getComponents("rgb").reduce((gt,xt,$t)=>gt<<8|255&Math.floor($t===3?255*xt:xt),0)>>>0}function Q_(Dt){return typeof Dt!="number"?Ls.black():new Ls([(gt=Dt)>>16&255,gt>>8&255,255&gt],"rgb");var gt}function xv(Dt){return typeof Dt!="number"?Ls.black():new Ls([(gt=Dt)>>24&255,gt>>16&255,gt>>8&255,Ro(255&gt,0,255,0,1)],"rgb");var gt}function H_(Dt,gt){const xt=gt.toRgbaObject();Dt.writeProperty("r",xt.r),Dt.writeProperty("g",xt.g),Dt.writeProperty("b",xt.b),Dt.writeProperty("a",xt.a)}function LA(Dt,gt){const xt=gt.toRgbaObject();Dt.writeProperty("r",xt.r),Dt.writeProperty("g",xt.g),Dt.writeProperty("b",xt.b)}function Tm(Dt){return"alpha"in Dt&&Dt.alpha===!0}function r_(Dt){return Dt?gt=>Cm(gt,"0x"):gt=>z_(gt,"0x")}const Ev={id:"input-color-number",type:"input",accept:(Dt,gt)=>{if(typeof Dt!="number"||!("view"in gt)||gt.view!=="color")return null;const xt=Ly(gt);return xt?{initialValue:Dt,params:xt}:null},binding:{reader:Dt=>Tm(Dt.params)?xv:Q_,equals:Ls.equals,writer:Dt=>function(gt){const xt=gt?sm:wv;return($t,hr)=>{e_($t,xt(hr))}}(Tm(Dt.params))},controller:Dt=>{const gt=Tm(Dt.params),xt="expanded"in Dt.params?Dt.params.expanded:void 0,$t="picker"in Dt.params?Dt.params.picker:void 0;return new zu(Dt.document,{expanded:xt!=null&&xt,formatter:r_(gt),parser:ju,pickerLayout:$t??"popup",supportsAlpha:gt,value:Dt.value,viewProps:Dt.viewProps})}},Mm={id:"input-color-object",type:"input",accept:(Dt,gt)=>{if(!Ls.isColorObject(Dt))return null;const xt=Ly(gt);return xt?{initialValue:Dt,params:xt}:null},binding:{reader:Dt=>Mr,equals:Ls.equals,writer:Dt=>{return gt=Dt.initialValue,Ls.isRgbaColorObject(gt)?H_:LA;var gt}},controller:Dt=>{const gt=Ls.isRgbaColorObject(Dt.initialValue),xt="expanded"in Dt.params?Dt.params.expanded:void 0,$t="picker"in Dt.params?Dt.params.picker:void 0,hr=gt?Cm:z_;return new zu(Dt.document,{expanded:xt!=null&&xt,formatter:hr,parser:ju,pickerLayout:$t??"popup",supportsAlpha:gt,value:Dt.value,viewProps:Dt.viewProps})}},n_={id:"input-color-string",type:"input",accept:(Dt,gt)=>{if(typeof Dt!="string"||"view"in gt&&gt.view==="text"||!Vn(Dt))return null;const xt=Ly(gt);return xt?{initialValue:Dt,params:xt}:null},binding:{reader:Dt=>zw,equals:Ls.equals,writer:Dt=>{const gt=Vn(Dt.initialValue);if(!gt)throw Vt.shouldNeverHappen();return function(xt){const $t=BA(xt);return(hr,Pr)=>{e_(hr,$t(Pr))}}(gt)}},controller:Dt=>{const gt=Vn(Dt.initialValue);if(!gt)throw Vt.shouldNeverHappen();const xt=BA(gt),$t="expanded"in Dt.params?Dt.params.expanded:void 0,hr="picker"in Dt.params?Dt.params.picker:void 0;return new zu(Dt.document,{expanded:$t!=null&&$t,formatter:xt,parser:ju,pickerLayout:hr??"popup",supportsAlpha:Ix(gt),value:Dt.value,viewProps:Dt.viewProps})}};class Pp{constructor(gt){this.components=gt.components,this.asm_=gt.assembly}constrain(gt){const xt=this.asm_.toComponents(gt).map(($t,hr)=>{var Pr,$r;return($r=(Pr=this.components[hr])===null||Pr===void 0?void 0:Pr.constrain($t))!==null&&$r!==void 0?$r:$t});return this.asm_.fromComponents(xt)}}const F0=dr("pndtxt");class NA{constructor(gt,xt){this.textViews=xt.textViews,this.element=gt.createElement("div"),this.element.classList.add(F0()),this.textViews.forEach($t=>{const hr=gt.createElement("div");hr.classList.add(F0("a")),hr.appendChild($t.element),this.element.appendChild(hr)})}}class q_{constructor(gt,xt){this.value=xt.value,this.viewProps=xt.viewProps,this.acs_=xt.axes.map(($t,hr)=>function(Pr,$r,An){return new N_(Pr,{arrayPosition:An===0?"fst":An===$r.axes.length-1?"lst":"mid",baseStep:$r.axes[An].baseStep,parser:$r.parser,props:$r.axes[An].textProps,value:vr(0,{constraint:$r.axes[An].constraint}),viewProps:$r.viewProps})}(gt,xt,hr)),this.acs_.forEach(($t,hr)=>{O_({primary:this.value,secondary:$t.value,forward:Pr=>xt.assembly.toComponents(Pr.rawValue)[hr],backward:(Pr,$r)=>{const An=xt.assembly.toComponents(Pr.rawValue);return An[hr]=$r.rawValue,xt.assembly.fromComponents(An)}})}),this.view=new NA(gt,{textViews:this.acs_.map($t=>$t.view)})}}function i_(Dt){const gt=[],xt=function(Pr){return"step"in Pr&&!bt(Pr.step)?new wu(Pr.step):null}(Dt);xt&&gt.push(xt);const $t=function(Pr){return"max"in Pr&&!bt(Pr.max)||"min"in Pr&&!bt(Pr.min)?new Co({max:Pr.max,min:Pr.min}):null}(Dt);$t&&gt.push($t);const hr=Yl(Dt.options);return hr&&gt.push(hr),new Zo(gt)}function FA(Dt){const[gt,xt]=function($t){const hr=$t?To($t,Co):null;return hr?[hr.minValue,hr.maxValue]:[void 0,void 0]}(Dt);return[gt??0,xt??100]}const Io={id:"input-number",type:"input",accept:(Dt,gt)=>{if(typeof Dt!="number")return null;const xt=gn,$t=tn(gt,{format:xt.optional.function,max:xt.optional.number,min:xt.optional.number,options:xt.optional.custom(D0),step:xt.optional.number});return $t?{initialValue:Dt,params:$t}:null},binding:{reader:Dt=>_f,constraint:Dt=>i_(Dt.params),writer:Dt=>e_},controller:Dt=>{var gt,xt;const $t=Dt.value,hr=Dt.constraint;if(hr&&To(hr,Al))return new Pl(Dt.document,{props:Vr.fromObject({options:(gt=MA(hr))!==null&&gt!==void 0?gt:[]}),value:$t,viewProps:Dt.viewProps});const Pr=(xt="format"in Dt.params?Dt.params.format:void 0)!==null&&xt!==void 0?xt:Ll(RA(hr,$t.rawValue));if(hr&&To(hr,Co)){const[$r,An]=FA(hr);return new tm(Dt.document,{baseStep:yv(hr),parser:Su,sliderProps:Vr.fromObject({maxValue:An,minValue:$r}),textProps:Vr.fromObject({draggingScale:U_(hr,$t.rawValue),formatter:Pr}),value:$t,viewProps:Dt.viewProps})}return new N_(Dt.document,{baseStep:yv(hr),parser:Su,props:Vr.fromObject({draggingScale:U_(hr,$t.rawValue),formatter:Pr}),value:$t,viewProps:Dt.viewProps})}};class Nl{constructor(gt=0,xt=0){this.x=gt,this.y=xt}getComponents(){return[this.x,this.y]}static isObject(gt){if(bt(gt))return!1;const xt=gt.x,$t=gt.y;return typeof xt=="number"&&typeof $t=="number"}static equals(gt,xt){return gt.x===xt.x&&gt.y===xt.y}toObject(){return{x:this.x,y:this.y}}}const om={toComponents:Dt=>Dt.getComponents(),fromComponents:Dt=>new Nl(...Dt)},zp=dr("p2d");class am{constructor(gt,xt){this.element=gt.createElement("div"),this.element.classList.add(zp()),xt.viewProps.bindClassModifiers(this.element),Ht(xt.expanded,pr(this.element,zp(void 0,"expanded")));const $t=gt.createElement("div");$t.classList.add(zp("h")),this.element.appendChild($t);const hr=gt.createElement("button");hr.classList.add(zp("b")),hr.appendChild(mr(gt,"p2dpad")),xt.viewProps.bindDisabled(hr),$t.appendChild(hr),this.buttonElement=hr;const Pr=gt.createElement("div");if(Pr.classList.add(zp("t")),$t.appendChild(Pr),this.textElement=Pr,xt.pickerLayout==="inline"){const $r=gt.createElement("div");$r.classList.add(zp("p")),this.element.appendChild($r),this.pickerElement=$r}else this.pickerElement=null}}const xu=dr("p2dp");class UA{constructor(gt,xt){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=xt.invertsY,this.maxValue_=xt.maxValue,this.element=gt.createElement("div"),this.element.classList.add(xu()),xt.layout==="popup"&&this.element.classList.add(xu(void 0,"p"));const $t=gt.createElement("div");$t.classList.add(xu("p")),xt.viewProps.bindTabIndex($t),this.element.appendChild($t),this.padElement=$t;const hr=gt.createElementNS(yr,"svg");hr.classList.add(xu("g")),this.padElement.appendChild(hr),this.svgElem_=hr;const Pr=gt.createElementNS(yr,"line");Pr.classList.add(xu("ax")),Pr.setAttributeNS(null,"x1","0"),Pr.setAttributeNS(null,"y1","50%"),Pr.setAttributeNS(null,"x2","100%"),Pr.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(Pr);const $r=gt.createElementNS(yr,"line");$r.classList.add(xu("ax")),$r.setAttributeNS(null,"x1","50%"),$r.setAttributeNS(null,"y1","0"),$r.setAttributeNS(null,"x2","50%"),$r.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild($r);const An=gt.createElementNS(yr,"line");An.classList.add(xu("l")),An.setAttributeNS(null,"x1","50%"),An.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(An),this.lineElem_=An;const zn=gt.createElement("div");zn.classList.add(xu("m")),this.padElement.appendChild(zn),this.markerElem_=zn,xt.value.emitter.on("change",this.onValueChange_),this.value=xt.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[gt,xt]=this.value.rawValue.getComponents(),$t=this.maxValue_,hr=Ro(gt,-$t,+$t,0,100),Pr=Ro(xt,-$t,+$t,0,100),$r=this.invertsY_?100-Pr:Pr;this.lineElem_.setAttributeNS(null,"x2",`${hr}%`),this.lineElem_.setAttributeNS(null,"y2",`${$r}%`),this.markerElem_.style.left=`${hr}%`,this.markerElem_.style.top=`${$r}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function U0(Dt,gt,xt){return[hp(gt[0],Fu(Dt)),hp(gt[1],P0(Dt))*(xt?1:-1)]}class Ym{constructor(gt,xt){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=xt.value,this.viewProps=xt.viewProps,this.baseSteps_=xt.baseSteps,this.maxValue_=xt.maxValue,this.invertsY_=xt.invertsY,this.view=new UA(gt,{invertsY:this.invertsY_,layout:xt.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new $u(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(gt,xt){if(!gt.point)return;const $t=this.maxValue_,hr=Ro(gt.point.x,0,gt.bounds.width,-$t,+$t),Pr=Ro(this.invertsY_?gt.bounds.height-gt.point.y:gt.point.y,0,gt.bounds.height,-$t,+$t);this.value.setRawValue(new Nl(hr,Pr),xt)}onPointerDown_(gt){this.handlePointerEvent_(gt.data,{forceEmit:!1,last:!1})}onPointerMove_(gt){this.handlePointerEvent_(gt.data,{forceEmit:!1,last:!1})}onPointerUp_(gt){this.handlePointerEvent_(gt.data,{forceEmit:!0,last:!0})}onPadKeyDown_(gt){Uu(gt.key)&&gt.preventDefault();const[xt,$t]=U0(gt,this.baseSteps_,this.invertsY_);xt===0&&$t===0||this.value.setRawValue(new Nl(this.value.rawValue.x+xt,this.value.rawValue.y+$t),{forceEmit:!1,last:!1})}onPadKeyUp_(gt){const[xt,$t]=U0(gt,this.baseSteps_,this.invertsY_);xt===0&&$t===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class $0{constructor(gt,xt){var $t,hr;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=xt.value,this.viewProps=xt.viewProps,this.foldable_=js.create(xt.expanded),this.popC_=xt.pickerLayout==="popup"?new gs(gt,{viewProps:this.viewProps}):null;const Pr=new Ym(gt,{baseSteps:[xt.axes[0].baseStep,xt.axes[1].baseStep],invertsY:xt.invertsY,layout:xt.pickerLayout,maxValue:xt.maxValue,value:this.value,viewProps:this.viewProps});Pr.view.allFocusableElements.forEach($r=>{$r.addEventListener("blur",this.onPopupChildBlur_),$r.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=Pr,this.textC_=new q_(gt,{assembly:om,axes:xt.axes,parser:xt.parser,value:this.value,viewProps:this.viewProps}),this.view=new am(gt,{expanded:this.foldable_.value("expanded"),pickerLayout:xt.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),($t=this.view.buttonElement)===null||$t===void 0||$t.addEventListener("blur",this.onPadButtonBlur_),(hr=this.view.buttonElement)===null||hr===void 0||hr.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),O_({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:$r=>$r.rawValue,backward:($r,An)=>An.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),uo(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(gt){if(!this.popC_)return;const xt=this.view.element,$t=gt.relatedTarget;$t&&xt.contains($t)||(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(gt){if(!this.popC_)return;const xt=this.popC_.view.element,$t=$n(gt);$t&&xt.contains($t)||$t&&$t===this.view.buttonElement&&!sn(xt.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(gt){this.popC_?gt.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&gt.key==="Escape"&&this.view.buttonElement.focus()}}function Uy(Dt){return Nl.isObject(Dt)?new Nl(Dt.x,Dt.y):new Nl}function $A(Dt,gt){Dt.writeProperty("x",gt.x),Dt.writeProperty("y",gt.y)}function s_(Dt){if(!Dt)return;const gt=[];return bt(Dt.step)||gt.push(new wu(Dt.step)),bt(Dt.max)&&bt(Dt.min)||gt.push(new Co({max:Dt.max,min:Dt.min})),new Zo(gt)}function Ys(Dt,gt){const xt=Dt&&To(Dt,Co);if(xt)return Math.max(Math.abs(xt.minValue||0),Math.abs(xt.maxValue||0));const $t=yv(Dt);return Math.max(10*Math.abs($t),10*Math.abs(gt))}function $a(Dt,gt){const xt=gt instanceof Pp?gt.components[0]:void 0,$t=gt instanceof Pp?gt.components[1]:void 0,hr=Ys(xt,Dt.x),Pr=Ys($t,Dt.y);return Math.max(hr,Pr)}function Iu(Dt,gt){return{baseStep:yv(gt),constraint:gt,textProps:Vr.fromObject({draggingScale:U_(gt,Dt),formatter:Ll(RA(gt,Dt))})}}function lm(Dt){if(!("y"in Dt))return!1;const gt=Dt.y;return!!gt&&"inverted"in gt&&!!gt.inverted}const Sv={id:"input-point2d",type:"input",accept:(Dt,gt)=>{if(!Nl.isObject(Dt))return null;const xt=gn,$t=tn(gt,{expanded:xt.optional.boolean,picker:xt.optional.custom(Mx),x:xt.optional.custom(qm),y:xt.optional.object({inverted:xt.optional.boolean,max:xt.optional.number,min:xt.optional.number,step:xt.optional.number})});return $t?{initialValue:Dt,params:$t}:null},binding:{reader:Dt=>Uy,constraint:Dt=>{return gt=Dt.params,new Pp({assembly:om,components:[s_("x"in gt?gt.x:void 0),s_("y"in gt?gt.y:void 0)]});var gt},equals:Nl.equals,writer:Dt=>$A},controller:Dt=>{const gt=Dt.document,xt=Dt.value,$t=Dt.constraint;if(!($t instanceof Pp))throw Vt.shouldNeverHappen();const hr="expanded"in Dt.params?Dt.params.expanded:void 0,Pr="picker"in Dt.params?Dt.params.picker:void 0;return new $0(gt,{axes:[Iu(xt.rawValue.x,$t.components[0]),Iu(xt.rawValue.y,$t.components[1])],expanded:hr!=null&&hr,invertsY:lm(Dt.params),maxValue:$a(xt.rawValue,$t),parser:Su,pickerLayout:Pr??"popup",value:xt,viewProps:Dt.viewProps})}};class Pu{constructor(gt=0,xt=0,$t=0){this.x=gt,this.y=xt,this.z=$t}getComponents(){return[this.x,this.y,this.z]}static isObject(gt){if(bt(gt))return!1;const xt=gt.x,$t=gt.y,hr=gt.z;return typeof xt=="number"&&typeof $t=="number"&&typeof hr=="number"}static equals(gt,xt){return gt.x===xt.x&&gt.y===xt.y&&gt.z===xt.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const j0={toComponents:Dt=>Dt.getComponents(),fromComponents:Dt=>new Pu(...Dt)};function Dp(Dt){return Pu.isObject(Dt)?new Pu(Dt.x,Dt.y,Dt.z):new Pu}function Gw(Dt,gt){Dt.writeProperty("x",gt.x),Dt.writeProperty("y",gt.y),Dt.writeProperty("z",gt.z)}function $y(Dt){if(!Dt)return;const gt=[];return bt(Dt.step)||gt.push(new wu(Dt.step)),bt(Dt.max)&&bt(Dt.min)||gt.push(new Co({max:Dt.max,min:Dt.min})),new Zo(gt)}function Rm(Dt,gt){return{baseStep:yv(gt),constraint:gt,textProps:Vr.fromObject({draggingScale:U_(gt,Dt),formatter:Ll(RA(gt,Dt))})}}const mp={id:"input-point3d",type:"input",accept:(Dt,gt)=>{if(!Pu.isObject(Dt))return null;const xt=gn,$t=tn(gt,{x:xt.optional.custom(qm),y:xt.optional.custom(qm),z:xt.optional.custom(qm)});return $t?{initialValue:Dt,params:$t}:null},binding:{reader:Dt=>Dp,constraint:Dt=>{return gt=Dt.params,new Pp({assembly:j0,components:[$y("x"in gt?gt.x:void 0),$y("y"in gt?gt.y:void 0),$y("z"in gt?gt.z:void 0)]});var gt},equals:Pu.equals,writer:Dt=>Gw},controller:Dt=>{const gt=Dt.value,xt=Dt.constraint;if(!(xt instanceof Pp))throw Vt.shouldNeverHappen();return new q_(Dt.document,{assembly:j0,axes:[Rm(gt.rawValue.x,xt.components[0]),Rm(gt.rawValue.y,xt.components[1]),Rm(gt.rawValue.z,xt.components[2])],parser:Su,value:gt,viewProps:Dt.viewProps})}};class Cv{constructor(gt=0,xt=0,$t=0,hr=0){this.x=gt,this.y=xt,this.z=$t,this.w=hr}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(gt){if(bt(gt))return!1;const xt=gt.x,$t=gt.y,hr=gt.z,Pr=gt.w;return typeof xt=="number"&&typeof $t=="number"&&typeof hr=="number"&&typeof Pr=="number"}static equals(gt,xt){return gt.x===xt.x&&gt.y===xt.y&&gt.z===xt.z&&gt.w===xt.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const W_={toComponents:Dt=>Dt.getComponents(),fromComponents:Dt=>new Cv(...Dt)};function Vu(Dt){return Cv.isObject(Dt)?new Cv(Dt.x,Dt.y,Dt.z,Dt.w):new Cv}function Vp(Dt,gt){Dt.writeProperty("x",gt.x),Dt.writeProperty("y",gt.y),Dt.writeProperty("z",gt.z),Dt.writeProperty("w",gt.w)}function ip(Dt){if(!Dt)return;const gt=[];return bt(Dt.step)||gt.push(new wu(Dt.step)),bt(Dt.max)&&bt(Dt.min)||gt.push(new Co({max:Dt.max,min:Dt.min})),new Zo(gt)}const Km={id:"input-point4d",type:"input",accept:(Dt,gt)=>{if(!Cv.isObject(Dt))return null;const xt=gn,$t=tn(gt,{x:xt.optional.custom(qm),y:xt.optional.custom(qm),z:xt.optional.custom(qm),w:xt.optional.custom(qm)});return $t?{initialValue:Dt,params:$t}:null},binding:{reader:Dt=>Vu,constraint:Dt=>{return gt=Dt.params,new Pp({assembly:W_,components:[ip("x"in gt?gt.x:void 0),ip("y"in gt?gt.y:void 0),ip("z"in gt?gt.z:void 0),ip("w"in gt?gt.w:void 0)]});var gt},equals:Cv.equals,writer:Dt=>Vp},controller:Dt=>{const gt=Dt.value,xt=Dt.constraint;if(!(xt instanceof Pp))throw Vt.shouldNeverHappen();return new q_(Dt.document,{assembly:W_,axes:gt.rawValue.getComponents().map(($t,hr)=>{return Pr=$t,{baseStep:yv($r=xt.components[hr]),constraint:$r,textProps:Vr.fromObject({draggingScale:U_($r,Pr),formatter:Ll(RA($r,Pr))})};var Pr,$r}),parser:Su,value:gt,viewProps:Dt.viewProps})}},jA={id:"input-string",type:"input",accept:(Dt,gt)=>{if(typeof Dt!="string")return null;const xt=tn(gt,{options:gn.optional.custom(D0)});return xt?{initialValue:Dt,params:xt}:null},binding:{reader:Dt=>Tx,constraint:Dt=>function(gt){const xt=[],$t=Yl(gt.options);return $t&&xt.push($t),new Zo(xt)}(Dt.params),writer:Dt=>e_},controller:Dt=>{var gt;const xt=Dt.document,$t=Dt.value,hr=Dt.constraint;return hr&&To(hr,Al)?new Pl(xt,{props:Vr.fromObject({options:(gt=MA(hr))!==null&&gt!==void 0?gt:[]}),value:$t,viewProps:Dt.viewProps}):new Qo(xt,{parser:Pr=>Pr,props:Vr.fromObject({formatter:k_}),value:$t,viewProps:Dt.viewProps})}},o_={defaultInterval:200,defaultLineCount:3},jy=dr("mll");class Y_{constructor(gt,xt){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=xt.formatter,this.element=gt.createElement("div"),this.element.classList.add(jy()),xt.viewProps.bindClassModifiers(this.element);const $t=gt.createElement("textarea");$t.classList.add(jy("i")),$t.style.height=`calc(var(--bld-us) * ${xt.lineCount})`,$t.readOnly=!0,xt.viewProps.bindDisabled($t),this.element.appendChild($t),this.textareaElem_=$t,xt.value.emitter.on("change",this.onValueUpdate_),this.value=xt.value,this.update_()}update_(){const gt=this.textareaElem_,xt=gt.scrollTop===gt.scrollHeight-gt.clientHeight,$t=[];this.value.rawValue.forEach(hr=>{hr!==void 0&&$t.push(this.formatter_(hr))}),gt.textContent=$t.join(`
`),xt&&(gt.scrollTop=gt.scrollHeight)}onValueUpdate_(){this.update_()}}class a_{constructor(gt,xt){this.value=xt.value,this.viewProps=xt.viewProps,this.view=new Y_(gt,{formatter:xt.formatter,lineCount:xt.lineCount,value:this.value,viewProps:this.viewProps})}}const zA=dr("sgl");class Qw{constructor(gt,xt){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=xt.formatter,this.element=gt.createElement("div"),this.element.classList.add(zA()),xt.viewProps.bindClassModifiers(this.element);const $t=gt.createElement("input");$t.classList.add(zA("i")),$t.readOnly=!0,$t.type="text",xt.viewProps.bindDisabled($t),this.element.appendChild($t),this.inputElement=$t,xt.value.emitter.on("change",this.onValueUpdate_),this.value=xt.value,this.update_()}update_(){const gt=this.value.rawValue,xt=gt[gt.length-1];this.inputElement.value=xt!==void 0?this.formatter_(xt):""}onValueUpdate_(){this.update_()}}class ao{constructor(gt,xt){this.value=xt.value,this.viewProps=xt.viewProps,this.view=new Qw(gt,{formatter:xt.formatter,value:this.value,viewProps:this.viewProps})}}const um={id:"monitor-bool",type:"monitor",accept:(Dt,gt)=>{if(typeof Dt!="boolean")return null;const xt=tn(gt,{lineCount:gn.optional.number});return xt?{initialValue:Dt,params:xt}:null},binding:{reader:Dt=>yo},controller:Dt=>{var gt;return Dt.value.rawValue.length===1?new ao(Dt.document,{formatter:vv,value:Dt.value,viewProps:Dt.viewProps}):new a_(Dt.document,{formatter:vv,lineCount:(gt=Dt.params.lineCount)!==null&&gt!==void 0?gt:o_.defaultLineCount,value:Dt.value,viewProps:Dt.viewProps})}};class Xm{constructor(){this.emitter=new rr,this.index_=-1}get index(){return this.index_}set index(gt){this.index_!==gt&&(this.index_=gt,this.emitter.emit("change",{index:gt,sender:this}))}}const gp=dr("grl");class Im{constructor(gt,xt){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=gt.createElement("div"),this.element.classList.add(gp()),xt.viewProps.bindClassModifiers(this.element),this.formatter_=xt.formatter,this.minValue_=xt.minValue,this.maxValue_=xt.maxValue,this.cursor_=xt.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const $t=gt.createElementNS(yr,"svg");$t.classList.add(gp("g")),$t.style.height=`calc(var(--bld-us) * ${xt.lineCount})`,this.element.appendChild($t),this.svgElem_=$t;const hr=gt.createElementNS(yr,"polyline");this.svgElem_.appendChild(hr),this.lineElem_=hr;const Pr=gt.createElement("div");Pr.classList.add(gp("t"),dr("tt")()),this.element.appendChild(Pr),this.tooltipElem_=Pr,xt.value.emitter.on("change",this.onValueUpdate_),this.value=xt.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const gt=this.svgElem_.getBoundingClientRect(),xt=this.value.rawValue.length-1,$t=this.minValue_,hr=this.maxValue_,Pr=[];this.value.rawValue.forEach((Us,xs)=>{if(Us===void 0)return;const Fl=Ro(xs,0,xt,0,gt.width),pu=Ro(Us,$t,hr,gt.height,0);Pr.push([Fl,pu].join(","))}),this.lineElem_.setAttributeNS(null,"points",Pr.join(" "));const $r=this.tooltipElem_,An=this.value.rawValue[this.cursor_.index];if(An===void 0)return void $r.classList.remove(gp("t","a"));const zn=Ro(this.cursor_.index,0,xt,0,gt.width),Ms=Ro(An,$t,hr,gt.height,0);$r.style.left=`${zn}px`,$r.style.top=`${Ms}px`,$r.textContent=`${this.formatter_(An)}`,$r.classList.contains(gp("t","a"))||($r.classList.add(gp("t","a"),gp("t","in")),an($r),$r.classList.remove(gp("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class cm{constructor(gt,xt){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.value=xt.value,this.viewProps=xt.viewProps,this.cursor_=new Xm,this.view=new Im(gt,{cursor:this.cursor_,formatter:xt.formatter,lineCount:xt.lineCount,maxValue:xt.maxValue,minValue:xt.minValue,value:this.value,viewProps:this.viewProps}),sn(gt)){const $t=new $u(this.view.element);$t.emitter.on("down",this.onGraphPointerDown_),$t.emitter.on("move",this.onGraphPointerMove_),$t.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}onGraphMouseLeave_(){this.cursor_.index=-1}onGraphMouseMove_(gt){const xt=this.view.element.getBoundingClientRect();this.cursor_.index=Math.floor(Ro(gt.offsetX,0,xt.width,0,this.value.rawValue.length))}onGraphPointerDown_(gt){this.onGraphPointerMove_(gt)}onGraphPointerMove_(gt){gt.data.point?this.cursor_.index=Math.floor(Ro(gt.data.point.x,0,gt.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.index=-1}onGraphPointerUp_(){this.cursor_.index=-1}}function dm(Dt){return"format"in Dt&&!bt(Dt.format)?Dt.format:Ll(2)}function VA(Dt){return"view"in Dt&&Dt.view==="graph"}const z0={id:"monitor-number",type:"monitor",accept:(Dt,gt)=>{if(typeof Dt!="number")return null;const xt=gn,$t=tn(gt,{format:xt.optional.function,lineCount:xt.optional.number,max:xt.optional.number,min:xt.optional.number,view:xt.optional.string});return $t?{initialValue:Dt,params:$t}:null},binding:{defaultBufferSize:Dt=>VA(Dt)?64:1,reader:Dt=>_f},controller:Dt=>VA(Dt.params)?function(gt){var xt,$t,hr;return new cm(gt.document,{formatter:dm(gt.params),lineCount:(xt=gt.params.lineCount)!==null&&xt!==void 0?xt:o_.defaultLineCount,maxValue:($t="max"in gt.params?gt.params.max:null)!==null&&$t!==void 0?$t:100,minValue:(hr="min"in gt.params?gt.params.min:null)!==null&&hr!==void 0?hr:0,value:gt.value,viewProps:gt.viewProps})}(Dt):function(gt){var xt;return gt.value.rawValue.length===1?new ao(gt.document,{formatter:dm(gt.params),value:gt.value,viewProps:gt.viewProps}):new a_(gt.document,{formatter:dm(gt.params),lineCount:(xt=gt.params.lineCount)!==null&&xt!==void 0?xt:o_.defaultLineCount,value:gt.value,viewProps:gt.viewProps})}(Dt)},GA={id:"monitor-string",type:"monitor",accept:(Dt,gt)=>{if(typeof Dt!="string")return null;const xt=gn,$t=tn(gt,{lineCount:xt.optional.number,multiline:xt.optional.boolean});return $t?{initialValue:Dt,params:$t}:null},binding:{reader:Dt=>Tx},controller:Dt=>{var gt;const xt=Dt.value;return xt.rawValue.length>1||"multiline"in Dt.params&&Dt.params.multiline?new a_(Dt.document,{formatter:k_,lineCount:(gt=Dt.params.lineCount)!==null&&gt!==void 0?gt:o_.defaultLineCount,value:xt,viewProps:Dt.viewProps}):new ao(Dt.document,{formatter:k_,value:xt,viewProps:Dt.viewProps})}};class l_{constructor(gt){this.onValueChange_=this.onValueChange_.bind(this),this.reader=gt.reader,this.writer=gt.writer,this.emitter=new rr,this.value=gt.value,this.value.emitter.on("change",this.onValueChange_),this.target=gt.target,this.read()}read(){const gt=this.target.read();gt!==void 0&&(this.value.rawValue=this.reader(gt))}write_(gt){this.writer(this.target,gt)}onValueChange_(gt){this.write_(gt.rawValue),this.emitter.emit("change",{options:gt.options,rawValue:gt.rawValue,sender:this})}}class Gu{constructor(gt){this.onTick_=this.onTick_.bind(this),this.reader_=gt.reader,this.target=gt.target,this.emitter=new rr,this.value=gt.value,this.ticker=gt.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const gt=this.target.read();if(gt===void 0)return;const xt=this.value.rawValue,$t=this.reader_(gt);this.value.rawValue=function(hr,Pr){const $r=[...Nw(hr),Pr];return $r.length>hr.length?$r.splice(0,$r.length-hr.length):Sm($r,hr.length),$r}(xt,$t),this.emitter.emit("update",{rawValue:$t,sender:this})}onTick_(gt){this.read()}}function Dx(Dt,gt){return gt===0?new tu:new Tp(Dt,gt??o_.defaultInterval)}class Qu{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(gt){gt.type==="blade"?this.pluginsMap_.blades.unshift(gt):gt.type==="input"?this.pluginsMap_.inputs.unshift(gt):gt.type==="monitor"&&this.pluginsMap_.monitors.unshift(gt)}createInput(gt,xt,$t){if(bt(xt.read()))throw new Vt({context:{key:xt.key},type:"nomatchingcontroller"});const hr=this.pluginsMap_.inputs.reduce((Pr,$r)=>Pr||function(An,zn){const Ms=An.accept(zn.target.read(),zn.params);if(bt(Ms))return null;const Us=gn,xs={target:zn.target,initialValue:Ms.initialValue,params:Ms.params},Fl=An.binding.reader(xs),pu=An.binding.constraint?An.binding.constraint(xs):void 0,fm=vr(Fl(Ms.initialValue),{constraint:pu,equals:An.binding.equals}),sp=new l_({reader:Fl,target:zn.target,value:fm,writer:An.binding.writer(xs)}),Gp=Us.optional.boolean(zn.params.disabled).value,Pm=Us.optional.boolean(zn.params.hidden).value,K_=An.controller({constraint:pu,document:zn.document,initialValue:Ms.initialValue,params:Ms.params,value:sp.value,viewProps:rs.create({disabled:Gp,hidden:Pm})}),u_=Us.optional.string(zn.params.label).value;return new Oo(zn.document,{binding:sp,blade:Eo(),props:Vr.fromObject({label:u_||zn.target.key}),valueController:K_})}($r,{document:gt,target:xt,params:$t}),null);if(hr)return hr;throw new Vt({context:{key:xt.key},type:"nomatchingcontroller"})}createMonitor(gt,xt,$t){const hr=this.pluginsMap_.monitors.reduce((Pr,$r)=>Pr||function(An,zn){var Ms,Us,xs;const Fl=gn,pu=An.accept(zn.target.read(),zn.params);if(bt(pu))return null;const fm={target:zn.target,initialValue:pu.initialValue,params:pu.params},sp=An.binding.reader(fm),Gp=(Us=(Ms=Fl.optional.number(zn.params.bufferSize).value)!==null&&Ms!==void 0?Ms:An.binding.defaultBufferSize&&An.binding.defaultBufferSize(pu.params))!==null&&Us!==void 0?Us:1,Pm=Fl.optional.number(zn.params.interval).value,K_=new Gu({reader:sp,target:zn.target,ticker:Dx(zn.document,Pm),value:bo(Gp)}),u_=Fl.optional.boolean(zn.params.disabled).value,Q0=Fl.optional.boolean(zn.params.hidden).value,zy=An.controller({document:zn.document,params:pu.params,value:K_.value,viewProps:rs.create({disabled:u_,hidden:Q0})}),Vy=(xs=Fl.optional.string(zn.params.label).value)!==null&&xs!==void 0?xs:zn.target.key;return new No(zn.document,{binding:K_,blade:Eo(),props:Vr.fromObject({label:Vy}),valueController:zy})}($r,{document:gt,params:$t,target:xt}),null);if(hr)return hr;throw new Vt({context:{key:xt.key},type:"nomatchingcontroller"})}createBlade(gt,xt){const $t=this.pluginsMap_.blades.reduce((hr,Pr)=>hr||function($r,An){const zn=$r.accept(An.params);if(!zn)return null;const Ms=gn.optional.boolean(An.params.disabled).value,Us=gn.optional.boolean(An.params.hidden).value;return $r.controller({blade:Eo(),document:An.document,params:Object.assign(Object.assign({},zn.params),{disabled:Ms,hidden:Us}),viewProps:rs.create({disabled:Ms,hidden:Us})})}(Pr,{document:gt,params:xt}),null);if(!$t)throw new Vt({type:"nomatchingview",context:{params:xt}});return $t}createBladeApi(gt){if(gt instanceof Oo)return new Vo(gt);if(gt instanceof No)return new Lo(gt);if(gt instanceof Lu)return new Il(gt,this);const xt=this.pluginsMap_.blades.reduce(($t,hr)=>$t||hr.api({controller:gt,pool:this}),null);if(!xt)throw Vt.shouldNeverHappen();return xt}}class Jm extends et{constructor(gt){super(gt),this.emitter_=new rr,this.controller_.valueController.value.emitter.on("change",xt=>{this.emitter_.emit("change",{event:new dt(this,xt.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(gt){this.controller_.props.set("label",gt)}get options(){return this.controller_.valueController.props.get("options")}set options(gt){this.controller_.valueController.props.set("options",gt)}get value(){return this.controller_.valueController.value.rawValue}set value(gt){this.controller_.valueController.value.rawValue=gt}on(gt,xt){const $t=xt.bind(this);return this.emitter_.on(gt,hr=>{$t(hr.event)}),this}}class au extends et{constructor(gt){super(gt),this.emitter_=new rr,this.controller_.valueController.value.emitter.on("change",xt=>{this.emitter_.emit("change",{event:new dt(this,xt.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(gt){this.controller_.props.set("label",gt)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(gt){this.controller_.valueController.sliderController.props.set("maxValue",gt)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(gt){this.controller_.valueController.sliderController.props.set("minValue",gt)}get value(){return this.controller_.valueController.value.rawValue}set value(gt){this.controller_.valueController.value.rawValue=gt}on(gt,xt){const $t=xt.bind(this);return this.emitter_.on(gt,hr=>{$t(hr.event)}),this}}class pm extends et{constructor(gt){super(gt),this.emitter_=new rr,this.controller_.valueController.value.emitter.on("change",xt=>{this.emitter_.emit("change",{event:new dt(this,xt.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(gt){this.controller_.props.set("label",gt)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(gt){this.controller_.valueController.props.set("formatter",gt)}get value(){return this.controller_.valueController.value.rawValue}set value(gt){this.controller_.valueController.value.rawValue=gt}on(gt,xt){const $t=xt.bind(this);return this.emitter_.on(gt,hr=>{$t(hr.event)}),this}}const El={id:"list",type:"blade",accept(Dt){const gt=gn,xt=tn(Dt,{options:gt.required.custom(D0),value:gt.required.raw,view:gt.required.constant("list"),label:gt.optional.string});return xt?{params:xt}:null},controller(Dt){const gt=new Pl(Dt.document,{props:Vr.fromObject({options:F_(Dt.params.options)}),value:vr(Dt.params.value),viewProps:Dt.viewProps});return new Ol(Dt.document,{blade:Dt.blade,props:Vr.fromObject({label:Dt.params.label}),valueController:gt})},api:Dt=>Dt.controller instanceof Ol&&Dt.controller.valueController instanceof Pl?new Jm(Dt.controller):null};class V0 extends ga{constructor(gt,xt){super(gt,xt)}get element(){return this.controller_.view.element}importPreset(gt){(function(xt,$t){xt.forEach(hr=>{const Pr=$t[hr.presetKey];Pr!==void 0&&hr.write(Pr)})})(this.controller_.rackController.rack.find(Oo).map(xt=>xt.binding.target),gt),this.refresh()}exportPreset(){return this.controller_.rackController.rack.find(Oo).map(gt=>gt.binding.target).reduce((gt,xt)=>Object.assign(gt,{[xt.presetKey]:xt.read()}),{})}refresh(){this.controller_.rackController.rack.find(Oo).forEach(gt=>{gt.binding.read()}),this.controller_.rackController.rack.find(No).forEach(gt=>{gt.binding.read()})}}class hm extends Bo{constructor(gt,xt){super(gt,{expanded:xt.expanded,blade:xt.blade,props:xt.props,root:!0,viewProps:xt.viewProps})}}const G0={id:"slider",type:"blade",accept(Dt){const gt=gn,xt=tn(Dt,{max:gt.required.number,min:gt.required.number,view:gt.required.constant("slider"),format:gt.optional.function,label:gt.optional.string,value:gt.optional.number});return xt?{params:xt}:null},controller(Dt){var gt,xt;const $t=(gt=Dt.params.value)!==null&&gt!==void 0?gt:0,hr=new tm(Dt.document,{baseStep:1,parser:Su,sliderProps:Vr.fromObject({maxValue:Dt.params.max,minValue:Dt.params.min}),textProps:Vr.fromObject({draggingScale:U_(void 0,$t),formatter:(xt=Dt.params.format)!==null&&xt!==void 0?xt:B_}),value:vr($t),viewProps:Dt.viewProps});return new Ol(Dt.document,{blade:Dt.blade,props:Vr.fromObject({label:Dt.params.label}),valueController:hr})},api:Dt=>Dt.controller instanceof Ol&&Dt.controller.valueController instanceof tm?new au(Dt.controller):null},vp={id:"text",type:"blade",accept(Dt){const gt=gn,xt=tn(Dt,{parse:gt.required.function,value:gt.required.raw,view:gt.required.constant("text"),format:gt.optional.function,label:gt.optional.string});return xt?{params:xt}:null},controller(Dt){var gt;const xt=new Qo(Dt.document,{parser:Dt.params.parse,props:Vr.fromObject({formatter:(gt=Dt.params.format)!==null&&gt!==void 0?gt:$t=>String($t)}),value:vr(Dt.params.value),viewProps:Dt.viewProps});return new Ol(Dt.document,{blade:Dt.blade,props:Vr.fromObject({label:Dt.params.label}),valueController:xt})},api:Dt=>Dt.controller instanceof Ol&&Dt.controller.valueController instanceof Qo?new pm(Dt.controller):null};function Xl(Dt,gt,xt){if(Dt.querySelector(`style[data-tp-style=${gt}]`))return;const $t=Dt.createElement("style");$t.dataset.tpStyle=gt,$t.textContent=xt,Dt.head.appendChild($t)}const Hw=new class{constructor(Dt){const[gt,xt]=Dt.split("-"),$t=gt.split(".");this.major=parseInt($t[0],10),this.minor=parseInt($t[1],10),this.patch=parseInt($t[2],10),this.prerelease=xt??null}toString(){const Dt=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[Dt,this.prerelease].join("-"):Dt}}("3.0.8");it.BladeApi=et,it.ButtonApi=Jt,it.FolderApi=ga,it.InputBindingApi=Vo,it.ListApi=Jm,it.MonitorBindingApi=Lo,it.Pane=class extends V0{constructor(Dt){var gt;const xt=Dt||{},$t=(gt=xt.document)!==null&&gt!==void 0?gt:Rn(),hr=function(){const Pr=new Qu;return[Sv,mp,Km,jA,Io,n_,Mm,Ev,Rx,um,GA,z0,qs,su,Cl,po].forEach($r=>{Pr.register($r)}),Pr}();super(new hm($t,{expanded:xt.expanded,blade:Eo(),props:Vr.fromObject({title:xt.title}),viewProps:rs.create()}),hr),this.pool_=hr,this.containerElem_=xt.container||function(Pr){const $r=Pr.createElement("div");return $r.classList.add(dr("dfw")()),Pr.body&&Pr.body.appendChild($r),$r}($t),this.containerElem_.appendChild(this.element),this.doc_=$t,this.usesDefaultWrapper_=!xt.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw Vt.alreadyDisposed();return this.doc_}dispose(){const Dt=this.containerElem_;if(!Dt)throw Vt.alreadyDisposed();if(this.usesDefaultWrapper_){const gt=Dt.parentElement;gt&&gt.removeChild(Dt)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(Dt){("plugin"in Dt?[Dt.plugin]:"plugins"in Dt?Dt.plugins:[]).forEach(gt=>{this.pool_.register(gt),this.embedPluginStyle_(gt)})}embedPluginStyle_(Dt){Dt.css&&Xl(this.document,`plugin-${Dt.id}`,Dt.css)}setUpDefaultPlugins_(){Xl(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor transparent;scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:transparent}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:transparent solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, #28292e);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, #adafb8);--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, #28292e);--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, #bbbcc4);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, #bbbcc4);--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_i,.tp-fldv_c>.tp-tabv>.tp-tabv_i{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a:before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_c{border-left:var(--cnt-bg) solid 4px}.tp-fldv_b:hover+.tp-fldv_c{border-left-color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_c{border-left-color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_c{border-left-color:var(--cnt-bg-a)}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv.tp-v-disabled{opacity:.5}.tp-tabv_i{align-items:flex-end;display:flex;overflow:hidden}.tp-tabv.tp-tabv-nop .tp-tabv_i{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_i::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{border-left:var(--cnt-bg) solid 4px;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p)}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:-2px;position:absolute;width:2px}.tp-tbiv_b{background-color:var(--cnt-bg);display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);width:100%}.tp-tbiv_b:hover{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active{background-color:var(--cnt-bg-a)}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) transparent transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c,.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_i{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach(Dt=>{this.embedPluginStyle_(Dt)}),this.registerPlugin({plugins:[G0,El,po,vp]})}},it.SeparatorApi=pp,it.SliderApi=au,it.TabApi=oo,it.TabPageApi=Xo,it.TextApi=pm,it.TpChangeEvent=dt,it.VERSION=Hw,Object.defineProperty(it,"__esModule",{value:!0})})(j)},23:function(__unused_webpack_module,__webpackgi_exports__,__webpackgi_require__){__webpackgi_require__.d(__webpackgi_exports__,{Q:function(){return DRACOLoader2}});var three_examples_jsm_loaders_DRACOLoader__WEBPACK_IMPORTED_MODULE_0__=__webpackgi_require__(553),three__WEBPACK_IMPORTED_MODULE_1__=__webpackgi_require__(988);class DRACOLoader2 extends three_examples_jsm_loaders_DRACOLoader__WEBPACK_IMPORTED_MODULE_0__._{constructor($){super($),this.encoderPending=null,this.encoderConfig={type:"js"},this.setDecoderPath("https://cdn.jsdelivr.net/gh/google/draco@1.4.1/javascript/"),this.setDecoderConfig({type:"js"})}async loadAsync($,j){const it=await super.loadAsync($,j);return it?new three__WEBPACK_IMPORTED_MODULE_1__.Kj0(it,new three__WEBPACK_IMPORTED_MODULE_1__.Wid):void 0}preload($=!0,j=!1){return $&&super.preload(),j&&this.initEncoder(),this}async initEncoder(){if(this.encoderPending)return this.encoderPending;const useJS=typeof WebAssembly!="object"||this.encoderConfig.type==="js",librariesPending=[],libLoader=this._loadLibrary.bind(this);return useJS?librariesPending.push(libLoader("draco_encoder.js","text")):(librariesPending.push(libLoader("draco_wasm_wrapper.js","text")),librariesPending.push(libLoader("draco_encoder.wasm","arraybuffer"))),this.encoderPending=Promise.all(librariesPending).then(libraries=>{var _a;const jsContent=libraries[0];return useJS||(this.encoderConfig.wasmBinary=libraries[1]),(_a=eval(jsContent+`
DracoEncoderModule;`))===null||_a===void 0?void 0:_a()}),this.encoderPending}async initDecoder(){var _a;await this._initDecoder();const jsContent=await fetch(this.workerSourceURL).then(async $=>$.text()).then($=>{const j=$.indexOf("/* worker */");if(j<1)throw new Error("unable to load decoder module");return $.substring(0,j-1)});return(_a=eval(jsContent+`
DracoDecoderModule;`))===null||_a===void 0?void 0:_a()}}},87:function(){},263:function(){},988:function($,j,it){it.d(j,{$TI:function(){return zE},$V:function(){return RP},$Vf:function(){return fR},$YQ:function(){return dC},A5E:function(){return yw},AHu:function(){return Y1},AXT:function(){return g1},Aip:function(){return yR},B02:function(){return Rt},BFQ:function(){return Al},BG$:function(){return Yv},BKK:function(){return ww},BVF:function(){return Rn},BVQ:function(){return _1},BbS:function(){return g0},Bf4:function(){return No},BtG:function(){return qA},CJI:function(){return Gu},CN8:function(){return dR},CP7:function(){return fu},CaW:function(){return ds},CdI:function(){return js},Cne:function(){return eT},CtA:function(){return Tp},CtF:function(){return u0},D1R:function(){return ys},D9w:function(){return po},DT1:function(){return K1},Djp:function(){return By},DqL:function(){return qp},DvJ:function(){return Zm},E2K:function(){return Zo},EB7:function(){return m1},EJi:function(){return DC},EoG:function(){return Eo},F5T:function(){return Qu},FDw:function(){return Bo},FE5:function(){return lp},FIo:function(){return HM},FM8:function(){return Vn},FT0:function(){return kC},FUD:function(){return Xv},FvO:function(){return up},GG6:function(){return I_},GQ:function(){return iv},GUF:function(){return Ro},GVz:function(){return Px},GZb:function(){return mR},Gih:function(){return Kv},Gql:function(){return zC},H$k:function(){return nA},HTd:function(){return Up},HW6:function(){return _R},HgB:function(){return B0},HkE:function(){return cC},Hmr:function(){return U1},Hw6:function(){return V_},Hy8:function(){return nn},Hyl:function(){return kv},IEO:function(){return tw},IFH:function(){return Ll},IKL:function(){return qM},ILR:function(){return wu},IOt:function(){return Fu},Ilk:function(){return ms},Inb:function(){return O_},Ir4:function(){return U_},JOQ:function(){return X_},JQ4:function(){return Yr},JUT:function(){return G_},JWc:function(){return RA},KI_:function(){return $u},Kgo:function(){return y1},KhW:function(){return cn},Kj0:function(){return Hu},Kz5:function(){return Cp},L5g:function(){return py},L5s:function(){return xm},LBq:function(){return sR},LSk:function(){return Av},LY2:function(){return uo},L_r:function(){return PA},Lcc:function(){return ov},LgE:function(){return Nw},LgZ:function(){return Tn},LsT:function(){return _c},Ltg:function(){return qo},Lun:function(){return JA},M5h:function(){return or},M6v:function(){return jn},M8C:function(){return DA},Mig:function(){return JM},MyG:function(){return Uw},N$j:function(){return fC},N4l:function(){return pr},NDo:function(){return qs},NMF:function(){return I0},NYV:function(){return R_},Ns1:function(){return As},NwF:function(){return nv},Ny0:function(){return mE},O7d:function(){return S1},OAl:function(){return e_},OM3:function(){return $t},OTo:function(){return Ns},OdW:function(){return u1},OoA:function(){return Il},Ox3:function(){return XM},PA7:function(){return Uu},PMe:function(){return $C},Pa4:function(){return Mr},PeU:function(){return mt},Pnf:function(){return Su},PpQ:function(){return Fy},QM0:function(){return yv},QRU:function(){return VC},QZ1:function(){return MA},QmN:function(){return dt},Qpg:function(){return uR},R2R:function(){return a0},REq:function(){return bw},RNb:function(){return V0},ROQ:function(){return wC},RSm:function(){return R1},Rki:function(){return cR},RlZ:function(){return sn},RsA:function(){return ut},RvT:function(){return D0},S2y:function(){return bt},S3k:function(){return dw},S9g:function(){return mp},SJI:function(){return nR},SPe:function(){return lE},SUY:function(){return LE},Se2:function(){return Jr},Sm8:function(){return vr},So8:function(){return GC},SvJ:function(){return Ho},Syv:function(){return D_},T95:function(){return Ol},TOt:function(){return bE},TUj:function(){return IP},TUv:function(){return hC},T_1:function(){return WE},T_J:function(){return Wl},T__:function(){return UM},T_f:function(){return ZM},TlE:function(){return El},Tme:function(){return ao},Tn7:function(){return SE},TyD:function(){return ga},U7:function(){return SC},UCm:function(){return Fs},USm:function(){return Rm},UY4:function(){return dE},UZH:function(){return et},Uk6:function(){return QM},UlW:function(){return Tx},Uol:function(){return s0},V1s:function(){return HA},V4E:function(){return vR},VLJ:function(){return KC},VYz:function(){return iR},Vdb:function(){return yr},Vj0:function(){return mm},Vkp:function(){return ju},VzW:function(){return Cl},W2J:function(){return F_},WMw:function(){return er},WTc:function(){return hm},WXh:function(){return T1},Wbm:function(){return Zt},WdD:function(){return ho},Wid:function(){return PC},Wjw:function(){return YE},Wl3:function(){return rr},Wpd:function(){return an},Wqd:function(){return TC},WwZ:function(){return Jv},Wzm:function(){return f1},XZw:function(){return xw},Xaj:function(){return ar},Xcj:function(){return QC},XvJ:function(){return sy},Y8D:function(){return Xo},YBo:function(){return BC},YGz:function(){return mn},YKA:function(){return SA},YLQ:function(){return Go},YN5:function(){return hR},YT8:function(){return $M},Ywn:function(){return OA},Z6B:function(){return US},ZAu:function(){return e0},ZQ6:function(){return i0},ZRs:function(){return em},ZZA:function(){return P1},Zp0:function(){return v_},Zr5:function(){return mr},ZzF:function(){return Q_},Zzh:function(){return aR},_12:function(){return Y0},_3:function(){return ZC},_AM:function(){return Mo},_C8:function(){return iA},_Li:function(){return Yt},_MY:function(){return jt},_YM:function(){return o0},_YX:function(){return Q1},_am:function(){return $S},_fP:function(){return zu},_iA:function(){return Vt},_kC:function(){return m_},_lf:function(){return _f},_sL:function(){return B_},a$l:function(){return xt},aCh:function(){return L_},aH4:function(){return ba},aLr:function(){return am},aNw:function(){return Wu},aVm:function(){return vp},ad5:function(){return Ru},anP:function(){return Ux},aq0:function(){return q1},av9:function(){return tu},b5g:function(){return pC},bGH:function(){return Wt},b_z:function(){return Gl},bdR:function(){return Ht},blk:function(){return rw},bnF:function(){return eA},brP:function(){return Jo},bsb:function(){return _v},c8b:function(){return Vr},cBI:function(){return _0},cBK:function(){return NC},cJO:function(){return lw},cLu:function(){return _d},cPb:function(){return op},cRx:function(){return oo},cU9:function(){return LC},ce8:function(){return TA},cek:function(){return KM},cum:function(){return qm},dSO:function(){return Lo},dUE:function(){return l0},dYG:function(){return CE},dZ3:function(){return _o},dd2:function(){return Ip},dj0:function(){return Yl},dpR:function(){return FC},dwk:function(){return Jt},e62:function(){return gt},eD:function(){return jr},eMJ:function(){return Fw},eaV:function(){return Pl},ehD:function(){return dr},ejS:function(){return f_},ekQ:function(){return ou},epp:function(){return np},fHI:function(){return qu},fO1:function(){return bC},fQA:function(){return HE},fQK:function(){return eE},fSK:function(){return qr},fY$:function(){return Vo},fto:function(){return Hm},g8_:function(){return eu},gH0:function(){return G1},gSk:function(){return CA},g_z:function(){return v1},ghN:function(){return hn},gi4:function(){return vv},gti:function(){return CC},hEm:function(){return ep},hH6:function(){return d0},iAb:function(){return pp},iDF:function(){return Nv},iKG:function(){return Ox},iLg:function(){return wm},iMs:function(){return VE},iUV:function(){return Fo},iWC:function(){return gn},iWj:function(){return Kw},i_9:function(){return kE},iiP:function(){return xa},irR:function(){return rs},j4z:function(){return Mx},j87:function(){return Hw},jAl:function(){return Rp},jFi:function(){return Ft},jZA:function(){return Qo},jfJ:function(){return Zv},jwo:function(){return $w},jyi:function(){return oE},jyz:function(){return Tv},k0A:function(){return Js},k74:function(){return tn},kB5:function(){return d_},kFz:function(){return im},kaV:function(){return I1},knz:function(){return bo},kqm:function(){return uy},ksN:function(){return On},l0P:function(){return gs},l8J:function(){return IA},lCJ:function(){return Dt},lDi:function(){return F1},lLk:function(){return c0},lRF:function(){return o1},lRj:function(){return $p},lb7:function(){return Jy},lfu:function(){return OC},lk7:function(){return PE},m7l:function(){return B1},mSO:function(){return P0},mTL:function(){return TP},mXe:function(){return AE},m_w:function(){return uA},mzJ:function(){return aA},nls:function(){return Qp},ntZ:function(){return zt},nvb:function(){return pR},o8S:function(){return rA},oAp:function(){return GT},oa8:function(){return C1},oqc:function(){return N_},p3g:function(){return N0},p7A:function(){return JC},p7y:function(){return ru},pBf:function(){return Ws},pIN:function(){return Nu},pKu:function(){return EA},pQR:function(){return yp},ptH:function(){return Mp},qhX:function(){return ps},qkB:function(){return Uo},qlB:function(){return Xl},qyh:function(){return Lu},rAo:function(){return G0},rBU:function(){return ls},rDY:function(){return VT},rOj:function(){return sr},r_:function(){return tr},rnI:function(){return Sm},rpg:function(){return So},s4_:function(){return eR},sYA:function(){return k1},tEQ:function(){return sA},tGC:function(){return y_},tJx:function(){return qE},tUh:function(){return Fv},tf:function(){return j1},tm_:function(){return yt},trn:function(){return Aw},u37:function(){return oA},u7G:function(){return h0},u9r:function(){return xs},uEv:function(){return P_},uL9:function(){return Vs},uWy:function(){return co},uXU:function(){return tp},ujx:function(){return gR},v3W:function(){return Co},v9Y:function(){return Rx},vBJ:function(){return Jm},vCF:function(){return Ar},vCx:function(){return xl},vZf:function(){return bu},vmT:function(){return YM},vpT:function(){return rE},vxC:function(){return Oo},w$m:function(){return $n},wJv:function(){return In},wem:function(){return Ko},wk1:function(){return Ps},woe:function(){return fE},wuA:function(){return To},x12:function(){return h_},x5V:function(){return na},xEZ:function(){return Cu},xG9:function(){return lR},xJs:function(){return Ao},xWb:function(){return cy},xeV:function(){return nE},xfE:function(){return Vl},xo$:function(){return uw},xoR:function(){return M1},xsS:function(){return RM},y$t:function(){return sw},y2t:function(){return yo},y8_:function(){return _w},yC1:function(){return cw},yGw:function(){return Ys},ybr:function(){return ZA},yj7:function(){return EC},ylh:function(){return mw},yo9:function(){return J0},yt0:function(){return tm},ywz:function(){return su},yxD:function(){return p0},z$h:function(){return k_},z81:function(){return hp},z8B:function(){return ew},zHn:function(){return s_},zbs:function(){return D1},zf8:function(){return Bm},zob:function(){return A0}});const et="144dev",ut={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},dt={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},mt=0,yt=1,bt=2,Rt=3,jt=0,Vt=1,zt=2,Jt=3,rr=0,Yt=1,dr=2,Ft=0,Ht=1,er=2,pr=3,or=4,ar=5,Wt=100,Zt=101,sr=102,tr=103,vr=104,Vr=200,hn=201,cn=202,gn=203,tn=204,Tn=205,qr=206,nn=207,yr=208,an=209,sn=210,Rn=0,Jr=1,mr=2,Ar=3,jr=4,On=5,$n=6,jn=7,As=0,ps=1,qs=2,Vs=0,Eo=1,js=2,mn=3,uo=4,_o=5,Vl=300,Vo=301,Oo=302,Lo=303,No=304,eu=306,So=1e3,co=1001,Il=1002,ga=1003,Go=1004,Up=1004,ba=1005,bu=1005,Ko=1006,Lu=1007,$p=1007,ys=1008,Bo=1008,su=1009,Ol=1010,pp=1011,_c=1012,Cp=1013,Yr=1014,Cl=1015,_d=1016,Js=1017,rs=1018,In=1020,Ns=1021,Fs=1022,Ps=1023,Xo=1024,oo=1025,Uo=1026,Jo=1027,ep=1028,po=1029,tu=1030,Tp=1031,Zo=1033,To=33776,Al=33777,Co=33778,wu=33779,Mo=35840,xl=35841,Pl=35842,ds=35843,Hm=36196,gs=37492,ou=37496,Mp=37808,Qo=37809,yo=37810,vv=37811,By=37812,Yv=37813,R_=37814,Ao=37815,EA=37816,I_=37817,Kv=37818,Xv=37819,xa=37820,Ho=37821,_v=36492,Rp=2200,SA=2201,P_=2202,D_=2300,I0=2301,Nu=2302,Su=2400,_f=2401,B_=2402,Ll=2500,CA=2501,Jv=0,Tx=1,k_=2,Sm=3e3,bo=3001,Nw=3004,O_=3005,hp=3200,P0=3201,Fu=0,Uu=1,L_="",$u="srgb",Ro="srgb-linear",Ru=0,na=7680,TA=7681,em=7682,Zv=7683,N_=34055,Wl=34056,Fw=5386,Uw=512,tp=513,$w=514,tm=515,e_=516,D0=517,Mx=518,qm=519,F_=35044,Yl=35048,MA=35040,RA=35045,yv=35049,U_=35041,B0=35046,IA=35050,US=35042,Rx="100",Av="300 es",PA=1035;class Ws{addEventListener(_,st){this._listeners===void 0&&(this._listeners={});const at=this._listeners;at[_]===void 0&&(at[_]=[]),at[_].indexOf(st)===-1&&at[_].push(st)}hasEventListener(_,st){if(this._listeners===void 0)return!1;const at=this._listeners;return at[_]!==void 0&&at[_].indexOf(st)!==-1}removeEventListener(_,st){if(this._listeners===void 0)return;const at=this._listeners[_];if(at!==void 0){const lt=at.indexOf(st);lt!==-1&&at.splice(lt,1)}}dispatchEvent(_){if(this._listeners===void 0)return;const st=this._listeners[_.type];if(st!==void 0){_.target=this;const at=st.slice(0);for(let lt=0,ft=at.length;lt<ft;lt++)at[lt].call(this,_);_.target=null}}}const du=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let jw=1234567;const $_=Math.PI/180,ky=180/Math.PI;function rp(){const wt=4294967295*Math.random()|0,_=4294967295*Math.random()|0,st=4294967295*Math.random()|0,at=4294967295*Math.random()|0;return(du[255&wt]+du[wt>>8&255]+du[wt>>16&255]+du[wt>>24&255]+"-"+du[255&_]+du[_>>8&255]+"-"+du[_>>16&15|64]+du[_>>24&255]+"-"+du[63&st|128]+du[st>>8&255]+"-"+du[st>>16&255]+du[st>>24&255]+du[255&at]+du[at>>8&255]+du[at>>16&255]+du[at>>24&255]).toLowerCase()}function Ls(wt,_,st){return Math.max(_,Math.min(st,wt))}function Wm(wt,_){return(wt%_+_)%_}function Oy(wt,_,st){return(1-st)*wt+st*_}function Ly(wt){return(wt&wt-1)==0&&wt!==0}function t_(wt){return Math.pow(2,Math.ceil(Math.log(wt)/Math.LN2))}function fp(wt){return Math.pow(2,Math.floor(Math.log(wt)/Math.LN2))}function bv(wt,_){switch(_.constructor){case Float32Array:return wt;case Uint16Array:return wt/65535;case Uint8Array:return wt/255;case Int16Array:return Math.max(wt/32767,-1);case Int8Array:return Math.max(wt/127,-1);default:throw new Error("Invalid component type.")}}function Tl(wt,_){switch(_.constructor){case Float32Array:return wt;case Uint16Array:return Math.round(65535*wt);case Uint8Array:return Math.round(255*wt);case Int16Array:return Math.round(32767*wt);case Int8Array:return Math.round(127*wt);default:throw new Error("Invalid component type.")}}var DA=Object.freeze({__proto__:null,DEG2RAD:$_,RAD2DEG:ky,generateUUID:rp,clamp:Ls,euclideanModulo:Wm,mapLinear:function(wt,_,st,at,lt){return at+(wt-_)*(lt-at)/(st-_)},inverseLerp:function(wt,_,st){return wt!==_?(st-wt)/(_-wt):0},lerp:Oy,damp:function(wt,_,st,at){return Oy(wt,_,1-Math.exp(-st*at))},pingpong:function(wt,_=1){return _-Math.abs(Wm(wt,2*_)-_)},smoothstep:function(wt,_,st){return wt<=_?0:wt>=st?1:(wt=(wt-_)/(st-_))*wt*(3-2*wt)},smootherstep:function(wt,_,st){return wt<=_?0:wt>=st?1:(wt=(wt-_)/(st-_))*wt*wt*(wt*(6*wt-15)+10)},randInt:function(wt,_){return wt+Math.floor(Math.random()*(_-wt+1))},randFloat:function(wt,_){return wt+Math.random()*(_-wt)},randFloatSpread:function(wt){return wt*(.5-Math.random())},seededRandom:function(wt){wt!==void 0&&(jw=wt);let _=jw+=1831565813;return _=Math.imul(_^_>>>15,1|_),_^=_+Math.imul(_^_>>>7,61|_),((_^_>>>14)>>>0)/4294967296},degToRad:function(wt){return wt*$_},radToDeg:function(wt){return wt*ky},isPowerOfTwo:Ly,ceilPowerOfTwo:t_,floorPowerOfTwo:fp,setQuaternionFromProperEuler:function(wt,_,st,at,lt){const ft=Math.cos,vt=Math.sin,At=ft(st/2),Ct=vt(st/2),Tt=ft((_+at)/2),Ot=vt((_+at)/2),Ut=ft((_-at)/2),Lt=vt((_-at)/2),Gt=ft((at-_)/2),Xt=vt((at-_)/2);switch(lt){case"XYX":wt.set(At*Ot,Ct*Ut,Ct*Lt,At*Tt);break;case"YZY":wt.set(Ct*Lt,At*Ot,Ct*Ut,At*Tt);break;case"ZXZ":wt.set(Ct*Ut,Ct*Lt,At*Ot,At*Tt);break;case"XZX":wt.set(At*Ot,Ct*Xt,Ct*Gt,At*Tt);break;case"YXY":wt.set(Ct*Gt,At*Ot,Ct*Xt,At*Tt);break;case"ZYZ":wt.set(Ct*Xt,Ct*Gt,At*Ot,At*Tt);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+lt)}},normalize:Tl,denormalize:bv});class Vn{constructor(_=0,st=0){Vn.prototype.isVector2=!0,this.x=_,this.y=st}get width(){return this.x}set width(_){this.x=_}get height(){return this.y}set height(_){this.y=_}set(_,st){return this.x=_,this.y=st,this}setScalar(_){return this.x=_,this.y=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setComponent(_,st){switch(_){case 0:this.x=st;break;case 1:this.y=st;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y)}copy(_){return this.x=_.x,this.y=_.y,this}add(_){return this.x+=_.x,this.y+=_.y,this}addScalar(_){return this.x+=_,this.y+=_,this}addVectors(_,st){return this.x=_.x+st.x,this.y=_.y+st.y,this}addScaledVector(_,st){return this.x+=_.x*st,this.y+=_.y*st,this}sub(_){return this.x-=_.x,this.y-=_.y,this}subScalar(_){return this.x-=_,this.y-=_,this}subVectors(_,st){return this.x=_.x-st.x,this.y=_.y-st.y,this}multiply(_){return this.x*=_.x,this.y*=_.y,this}multiplyScalar(_){return this.x*=_,this.y*=_,this}divide(_){return this.x/=_.x,this.y/=_.y,this}divideScalar(_){return this.multiplyScalar(1/_)}applyMatrix3(_){const st=this.x,at=this.y,lt=_.elements;return this.x=lt[0]*st+lt[3]*at+lt[6],this.y=lt[1]*st+lt[4]*at+lt[7],this}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this}clamp(_,st){return this.x=Math.max(_.x,Math.min(st.x,this.x)),this.y=Math.max(_.y,Math.min(st.y,this.y)),this}clampScalar(_,st){return this.x=Math.max(_,Math.min(st,this.x)),this.y=Math.max(_,Math.min(st,this.y)),this}clampLength(_,st){const at=this.length();return this.divideScalar(at||1).multiplyScalar(Math.max(_,Math.min(st,at)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(_){return this.x*_.x+this.y*_.y}cross(_){return this.x*_.y-this.y*_.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(_){return Math.sqrt(this.distanceToSquared(_))}distanceToSquared(_){const st=this.x-_.x,at=this.y-_.y;return st*st+at*at}manhattanDistanceTo(_){return Math.abs(this.x-_.x)+Math.abs(this.y-_.y)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,st){return this.x+=(_.x-this.x)*st,this.y+=(_.y-this.y)*st,this}lerpVectors(_,st,at){return this.x=_.x+(st.x-_.x)*at,this.y=_.y+(st.y-_.y)*at,this}equals(_){return _.x===this.x&&_.y===this.y}fromArray(_,st=0){return this.x=_[st],this.y=_[st+1],this}toArray(_=[],st=0){return _[st]=this.x,_[st+1]=this.y,_}fromBufferAttribute(_,st){return this.x=_.getX(st),this.y=_.getY(st),this}rotateAround(_,st){const at=Math.cos(st),lt=Math.sin(st),ft=this.x-_.x,vt=this.y-_.y;return this.x=ft*at-vt*lt+_.x,this.y=ft*lt+vt*at+_.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ju{constructor(){ju.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(_,st,at,lt,ft,vt,At,Ct,Tt){const Ot=this.elements;return Ot[0]=_,Ot[1]=lt,Ot[2]=At,Ot[3]=st,Ot[4]=ft,Ot[5]=Ct,Ot[6]=at,Ot[7]=vt,Ot[8]=Tt,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(_){const st=this.elements,at=_.elements;return st[0]=at[0],st[1]=at[1],st[2]=at[2],st[3]=at[3],st[4]=at[4],st[5]=at[5],st[6]=at[6],st[7]=at[7],st[8]=at[8],this}extractBasis(_,st,at){return _.setFromMatrix3Column(this,0),st.setFromMatrix3Column(this,1),at.setFromMatrix3Column(this,2),this}setFromMatrix4(_){const st=_.elements;return this.set(st[0],st[4],st[8],st[1],st[5],st[9],st[2],st[6],st[10]),this}multiply(_){return this.multiplyMatrices(this,_)}premultiply(_){return this.multiplyMatrices(_,this)}multiplyMatrices(_,st){const at=_.elements,lt=st.elements,ft=this.elements,vt=at[0],At=at[3],Ct=at[6],Tt=at[1],Ot=at[4],Ut=at[7],Lt=at[2],Gt=at[5],Xt=at[8],Qt=lt[0],lr=lt[3],ur=lt[6],cr=lt[1],gr=lt[4],wr=lt[7],Er=lt[2],Cr=lt[5],zr=lt[8];return ft[0]=vt*Qt+At*cr+Ct*Er,ft[3]=vt*lr+At*gr+Ct*Cr,ft[6]=vt*ur+At*wr+Ct*zr,ft[1]=Tt*Qt+Ot*cr+Ut*Er,ft[4]=Tt*lr+Ot*gr+Ut*Cr,ft[7]=Tt*ur+Ot*wr+Ut*zr,ft[2]=Lt*Qt+Gt*cr+Xt*Er,ft[5]=Lt*lr+Gt*gr+Xt*Cr,ft[8]=Lt*ur+Gt*wr+Xt*zr,this}multiplyScalar(_){const st=this.elements;return st[0]*=_,st[3]*=_,st[6]*=_,st[1]*=_,st[4]*=_,st[7]*=_,st[2]*=_,st[5]*=_,st[8]*=_,this}determinant(){const _=this.elements,st=_[0],at=_[1],lt=_[2],ft=_[3],vt=_[4],At=_[5],Ct=_[6],Tt=_[7],Ot=_[8];return st*vt*Ot-st*At*Tt-at*ft*Ot+at*At*Ct+lt*ft*Tt-lt*vt*Ct}invert(){const _=this.elements,st=_[0],at=_[1],lt=_[2],ft=_[3],vt=_[4],At=_[5],Ct=_[6],Tt=_[7],Ot=_[8],Ut=Ot*vt-At*Tt,Lt=At*Ct-Ot*ft,Gt=Tt*ft-vt*Ct,Xt=st*Ut+at*Lt+lt*Gt;if(Xt===0)return this.set(0,0,0,0,0,0,0,0,0);const Qt=1/Xt;return _[0]=Ut*Qt,_[1]=(lt*Tt-Ot*at)*Qt,_[2]=(At*at-lt*vt)*Qt,_[3]=Lt*Qt,_[4]=(Ot*st-lt*Ct)*Qt,_[5]=(lt*ft-At*st)*Qt,_[6]=Gt*Qt,_[7]=(at*Ct-Tt*st)*Qt,_[8]=(vt*st-at*ft)*Qt,this}transpose(){let _;const st=this.elements;return _=st[1],st[1]=st[3],st[3]=_,_=st[2],st[2]=st[6],st[6]=_,_=st[5],st[5]=st[7],st[7]=_,this}getNormalMatrix(_){return this.setFromMatrix4(_).invert().transpose()}transposeIntoArray(_){const st=this.elements;return _[0]=st[0],_[1]=st[3],_[2]=st[6],_[3]=st[1],_[4]=st[4],_[5]=st[7],_[6]=st[2],_[7]=st[5],_[8]=st[8],this}setUvTransform(_,st,at,lt,ft,vt,At){const Ct=Math.cos(ft),Tt=Math.sin(ft);return this.set(at*Ct,at*Tt,-at*(Ct*vt+Tt*At)+vt+_,-lt*Tt,lt*Ct,-lt*(-Tt*vt+Ct*At)+At+st,0,0,1),this}scale(_,st){const at=this.elements;return at[0]*=_,at[3]*=_,at[6]*=_,at[1]*=st,at[4]*=st,at[7]*=st,this}rotate(_){const st=Math.cos(_),at=Math.sin(_),lt=this.elements,ft=lt[0],vt=lt[3],At=lt[6],Ct=lt[1],Tt=lt[4],Ot=lt[7];return lt[0]=st*ft+at*Ct,lt[3]=st*vt+at*Tt,lt[6]=st*At+at*Ot,lt[1]=-at*ft+st*Ct,lt[4]=-at*vt+st*Tt,lt[7]=-at*At+st*Ot,this}translate(_,st){const at=this.elements;return at[0]+=_*at[2],at[3]+=_*at[5],at[6]+=_*at[8],at[1]+=st*at[2],at[4]+=st*at[5],at[7]+=st*at[8],this}equals(_){const st=this.elements,at=_.elements;for(let lt=0;lt<9;lt++)if(st[lt]!==at[lt])return!1;return!0}fromArray(_,st=0){for(let at=0;at<9;at++)this.elements[at]=_[at+st];return this}toArray(_=[],st=0){const at=this.elements;return _[st]=at[0],_[st+1]=at[1],_[st+2]=at[2],_[st+3]=at[3],_[st+4]=at[4],_[st+5]=at[5],_[st+6]=at[6],_[st+7]=at[7],_[st+8]=at[8],_}clone(){return new this.constructor().fromArray(this.elements)}}function Ix(wt){for(let _=wt.length-1;_>=0;--_)if(wt[_]>65535)return!0;return!1}const zw={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function j_(wt,_){return new zw[wt](_)}function z_(wt){return document.createElementNS("http://www.w3.org/1999/xhtml",wt)}function Cm(wt){return wt<.04045?.0773993808*wt:Math.pow(.9478672986*wt+.0521327014,2.4)}function Ny(wt){return wt<.0031308?12.92*wt:1.055*Math.pow(wt,.41666)-.055}const k0={[$u]:{[Ro]:Cm},[Ro]:{[$u]:Ny}},np={legacyMode:!0,get workingColorSpace(){return Ro},set workingColorSpace(wt){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(wt,_,st){if(this.legacyMode||_===st||!_||!st)return wt;if(k0[_]&&k0[_][st]!==void 0){const at=k0[_][st];return wt.r=at(wt.r),wt.g=at(wt.g),wt.b=at(wt.b),wt}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(wt,_){return this.convert(wt,this.workingColorSpace,_)},toWorkingColorSpace:function(wt,_){return this.convert(wt,_,this.workingColorSpace)}},BA={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Kl={r:0,g:0,b:0},rm={h:0,s:0,l:0},O0={h:0,s:0,l:0};function jp(wt,_,st){return st<0&&(st+=1),st>1&&(st-=1),st<1/6?wt+6*(_-wt)*st:st<.5?_:st<2/3?wt+6*(_-wt)*(2/3-st):wt}function kA(wt,_){return _.r=wt.r,_.g=wt.g,_.b=wt.b,_}class ms{constructor(_,st,at){return this.isColor=!0,this.r=1,this.g=1,this.b=1,st===void 0&&at===void 0?this.set(_):this.setRGB(_,st,at)}set(_){return _&&_.isColor?this.copy(_):typeof _=="number"?this.setHex(_):typeof _=="string"&&this.setStyle(_),this}setScalar(_){return this.r=_,this.g=_,this.b=_,this}setHex(_,st=$u){return _=Math.floor(_),this.r=(_>>16&255)/255,this.g=(_>>8&255)/255,this.b=(255&_)/255,np.toWorkingColorSpace(this,st),this}setRGB(_,st,at,lt=Ro){return this.r=_,this.g=st,this.b=at,np.toWorkingColorSpace(this,lt),this}setHSL(_,st,at,lt=Ro){if(_=Wm(_,1),st=Ls(st,0,1),at=Ls(at,0,1),st===0)this.r=this.g=this.b=at;else{const ft=at<=.5?at*(1+st):at+st-at*st,vt=2*at-ft;this.r=jp(vt,ft,_+1/3),this.g=jp(vt,ft,_),this.b=jp(vt,ft,_-1/3)}return np.toWorkingColorSpace(this,lt),this}setStyle(_,st=$u){function at(ft){ft!==void 0&&parseFloat(ft)<1&&console.warn("THREE.Color: Alpha component of "+_+" will be ignored.")}let lt;if(lt=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(_)){let ft;const vt=lt[1],At=lt[2];switch(vt){case"rgb":case"rgba":if(ft=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(At))return this.r=Math.min(255,parseInt(ft[1],10))/255,this.g=Math.min(255,parseInt(ft[2],10))/255,this.b=Math.min(255,parseInt(ft[3],10))/255,np.toWorkingColorSpace(this,st),at(ft[4]),this;if(ft=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(At))return this.r=Math.min(100,parseInt(ft[1],10))/100,this.g=Math.min(100,parseInt(ft[2],10))/100,this.b=Math.min(100,parseInt(ft[3],10))/100,np.toWorkingColorSpace(this,st),at(ft[4]),this;break;case"hsl":case"hsla":if(ft=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(At)){const Ct=parseFloat(ft[1])/360,Tt=parseFloat(ft[2])/100,Ot=parseFloat(ft[3])/100;return at(ft[4]),this.setHSL(Ct,Tt,Ot,st)}}}else if(lt=/^\#([A-Fa-f\d]+)$/.exec(_)){const ft=lt[1],vt=ft.length;if(vt===3)return this.r=parseInt(ft.charAt(0)+ft.charAt(0),16)/255,this.g=parseInt(ft.charAt(1)+ft.charAt(1),16)/255,this.b=parseInt(ft.charAt(2)+ft.charAt(2),16)/255,np.toWorkingColorSpace(this,st),this;if(vt===6)return this.r=parseInt(ft.charAt(0)+ft.charAt(1),16)/255,this.g=parseInt(ft.charAt(2)+ft.charAt(3),16)/255,this.b=parseInt(ft.charAt(4)+ft.charAt(5),16)/255,np.toWorkingColorSpace(this,st),this}return _&&_.length>0?this.setColorName(_,st):this}setColorName(_,st=$u){const at=BA[_.toLowerCase()];return at!==void 0?this.setHex(at,st):console.warn("THREE.Color: Unknown color "+_),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(_){return this.r=_.r,this.g=_.g,this.b=_.b,this}copySRGBToLinear(_){return this.r=Cm(_.r),this.g=Cm(_.g),this.b=Cm(_.b),this}copyLinearToSRGB(_){return this.r=Ny(_.r),this.g=Ny(_.g),this.b=Ny(_.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(_=$u){return np.fromWorkingColorSpace(kA(this,Kl),_),Ls(255*Kl.r,0,255)<<16^Ls(255*Kl.g,0,255)<<8^Ls(255*Kl.b,0,255)<<0}getHexString(_=$u){return("000000"+this.getHex(_).toString(16)).slice(-6)}getHSL(_,st=Ro){np.fromWorkingColorSpace(kA(this,Kl),st);const at=Kl.r,lt=Kl.g,ft=Kl.b,vt=Math.max(at,lt,ft),At=Math.min(at,lt,ft);let Ct,Tt;const Ot=(At+vt)/2;if(At===vt)Ct=0,Tt=0;else{const Ut=vt-At;switch(Tt=Ot<=.5?Ut/(vt+At):Ut/(2-vt-At),vt){case at:Ct=(lt-ft)/Ut+(lt<ft?6:0);break;case lt:Ct=(ft-at)/Ut+2;break;case ft:Ct=(at-lt)/Ut+4}Ct/=6}return _.h=Ct,_.s=Tt,_.l=Ot,_}getRGB(_,st=Ro){return np.fromWorkingColorSpace(kA(this,Kl),st),_.r=Kl.r,_.g=Kl.g,_.b=Kl.b,_}getStyle(_=$u){return np.fromWorkingColorSpace(kA(this,Kl),_),_!==$u?`color(${_} ${Kl.r} ${Kl.g} ${Kl.b})`:`rgb(${255*Kl.r|0},${255*Kl.g|0},${255*Kl.b|0})`}offsetHSL(_,st,at){return this.getHSL(rm),rm.h+=_,rm.s+=st,rm.l+=at,this.setHSL(rm.h,rm.s,rm.l),this}add(_){return this.r+=_.r,this.g+=_.g,this.b+=_.b,this}addColors(_,st){return this.r=_.r+st.r,this.g=_.g+st.g,this.b=_.b+st.b,this}addScalar(_){return this.r+=_,this.g+=_,this.b+=_,this}sub(_){return this.r=Math.max(0,this.r-_.r),this.g=Math.max(0,this.g-_.g),this.b=Math.max(0,this.b-_.b),this}multiply(_){return this.r*=_.r,this.g*=_.g,this.b*=_.b,this}multiplyScalar(_){return this.r*=_,this.g*=_,this.b*=_,this}lerp(_,st){return this.r+=(_.r-this.r)*st,this.g+=(_.g-this.g)*st,this.b+=(_.b-this.b)*st,this}lerpColors(_,st,at){return this.r=_.r+(st.r-_.r)*at,this.g=_.g+(st.g-_.g)*at,this.b=_.b+(st.b-_.b)*at,this}lerpHSL(_,st){this.getHSL(rm),_.getHSL(O0);const at=Oy(rm.h,O0.h,st),lt=Oy(rm.s,O0.s,st),ft=Oy(rm.l,O0.l,st);return this.setHSL(at,lt,ft),this}equals(_){return _.r===this.r&&_.g===this.g&&_.b===this.b}fromArray(_,st=0){return this.r=_[st],this.g=_[st+1],this.b=_[st+2],this}toArray(_=[],st=0){return _[st]=this.r,_[st+1]=this.g,_[st+2]=this.b,_}fromBufferAttribute(_,st){return this.r=_.getX(st),this.g=_.getY(st),this.b=_.getZ(st),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let nm;ms.NAMES=BA;class Fy{static getDataURL(_,st=!1){if(/^data:/i.test(_.src)||typeof HTMLCanvasElement>"u")return _.src;let at;if(_ instanceof HTMLCanvasElement)at=_;else{nm===void 0&&(nm=z_("canvas")),nm.width=_.width,nm.height=_.height;const lt=nm.getContext("2d");_ instanceof ImageData?lt.putImageData(_,0,0):lt.drawImage(_,0,0,_.width,_.height),at=nm}return!st&&(at.width>2048||at.height>2048)?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",_),at.toDataURL("image/jpeg",.6)):at.toDataURL("image/png")}static sRGBToLinear(_){if(typeof HTMLImageElement<"u"&&_ instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_ instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_ instanceof ImageBitmap){const st=z_("canvas");st.width=_.width,st.height=_.height;const at=st.getContext("2d");at.drawImage(_,0,0,_.width,_.height);const lt=at.getImageData(0,0,_.width,_.height),ft=lt.data;for(let vt=0;vt<ft.length;vt++)ft[vt]=255*Cm(ft[vt]/255);return at.putImageData(lt,0,0),st}if(_.data){const st=_.data.slice(0);for(let at=0;at<st.length;at++)st instanceof Uint8Array||st instanceof Uint8ClampedArray?st[at]=Math.floor(255*Cm(st[at]/255)):st[at]=Cm(st[at]);return{data:st,width:_.width,height:_.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),_}}class V_{constructor(_=null){this.isSource=!0,this.uuid=rp(),this.data=_,this.version=0}set needsUpdate(_){_===!0&&this.version++}toJSON(_){const st=_===void 0||typeof _=="string";if(!st&&_.images[this.uuid]!==void 0)return _.images[this.uuid];const at={uuid:this.uuid,url:""},lt=this.data;if(lt!==null){let ft;if(Array.isArray(lt)){ft=[];for(let vt=0,At=lt.length;vt<At;vt++)lt[vt].isDataTexture?ft.push(L0(lt[vt].image)):ft.push(L0(lt[vt]))}else ft=L0(lt);at.url=ft}return st||(_.images[this.uuid]=at),at}}function L0(wt){if(typeof HTMLImageElement<"u"&&wt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&wt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&wt instanceof ImageBitmap)return Fy.getDataURL(wt);if(wt.data){let _=[];try{_=Array.from(wt.data)}catch(st){st.message.includes("Invalid array length")?console.warn("Serializing large texture, might not be saved in JSON structure."):console.error(st),_=wt.data}return{data:_,width:wt.width,height:wt.height,type:wt.data.constructor.name}}return console.warn("THREE.Texture: Unable to serialize Texture."),{}}let Vw=0;class Cu extends Ws{constructor(_=Cu.DEFAULT_IMAGE,st=Cu.DEFAULT_MAPPING,at=co,lt=co,ft=Ko,vt=ys,At=Ps,Ct=su,Tt=1,Ot=Sm){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Vw++}),this.uuid=rp(),this.name="",this.source=new V_(_),this.mipmaps=[],this.mapping=st,this.wrapS=at,this.wrapT=lt,this.magFilter=ft,this.minFilter=vt,this.anisotropy=Tt,this.format=At,this.internalFormat=null,this.type=Ct,this.offset=new Vn(0,0),this.repeat=new Vn(1,1),this.center=new Vn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ju,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=Ot,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(_){this.source.data=_}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(_){return this.name=_.name,this.source=_.source,this.mipmaps=_.mipmaps.slice(0),this.mapping=_.mapping,this.wrapS=_.wrapS,this.wrapT=_.wrapT,this.magFilter=_.magFilter,this.minFilter=_.minFilter,this.anisotropy=_.anisotropy,this.format=_.format,this.internalFormat=_.internalFormat,this.type=_.type,this.offset.copy(_.offset),this.repeat.copy(_.repeat),this.center.copy(_.center),this.rotation=_.rotation,this.matrixAutoUpdate=_.matrixAutoUpdate,this.matrix.copy(_.matrix),this.generateMipmaps=_.generateMipmaps,this.premultiplyAlpha=_.premultiplyAlpha,this.flipY=_.flipY,this.unpackAlignment=_.unpackAlignment,this.encoding=_.encoding,this.userData=JSON.parse(JSON.stringify(_.userData)),this.needsUpdate=!0,this}toJSON(_){const st=_===void 0||typeof _=="string";if(!st&&_.textures[this.uuid]!==void 0)return _.textures[this.uuid];const at={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(_).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return JSON.stringify(this.userData)!=="{}"&&(at.userData=this.userData),st||(_.textures[this.uuid]=at),at}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(_){if(this.mapping!==Vl)return _;if(_.applyMatrix3(this.matrix),_.x<0||_.x>1)switch(this.wrapS){case So:_.x=_.x-Math.floor(_.x);break;case co:_.x=_.x<0?0:1;break;case Il:Math.abs(Math.floor(_.x)%2)===1?_.x=Math.ceil(_.x)-_.x:_.x=_.x-Math.floor(_.x)}if(_.y<0||_.y>1)switch(this.wrapT){case So:_.y=_.y-Math.floor(_.y);break;case co:_.y=_.y<0?0:1;break;case Il:Math.abs(Math.floor(_.y)%2)===1?_.y=Math.ceil(_.y)-_.y:_.y=_.y-Math.floor(_.y)}return this.flipY&&(_.y=1-_.y),_}set needsUpdate(_){_===!0&&(this.version++,this.source.needsUpdate=!0)}}Cu.DEFAULT_IMAGE=null,Cu.DEFAULT_MAPPING=Vl;class qo{constructor(_=0,st=0,at=0,lt=1){qo.prototype.isVector4=!0,this.x=_,this.y=st,this.z=at,this.w=lt}get width(){return this.z}set width(_){this.z=_}get height(){return this.w}set height(_){this.w=_}set(_,st,at,lt){return this.x=_,this.y=st,this.z=at,this.w=lt,this}setScalar(_){return this.x=_,this.y=_,this.z=_,this.w=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setZ(_){return this.z=_,this}setW(_){return this.w=_,this}setComponent(_,st){switch(_){case 0:this.x=st;break;case 1:this.y=st;break;case 2:this.z=st;break;case 3:this.w=st;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this.w=_.w!==void 0?_.w:1,this}add(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this.w+=_.w,this}addScalar(_){return this.x+=_,this.y+=_,this.z+=_,this.w+=_,this}addVectors(_,st){return this.x=_.x+st.x,this.y=_.y+st.y,this.z=_.z+st.z,this.w=_.w+st.w,this}addScaledVector(_,st){return this.x+=_.x*st,this.y+=_.y*st,this.z+=_.z*st,this.w+=_.w*st,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this.w-=_.w,this}subScalar(_){return this.x-=_,this.y-=_,this.z-=_,this.w-=_,this}subVectors(_,st){return this.x=_.x-st.x,this.y=_.y-st.y,this.z=_.z-st.z,this.w=_.w-st.w,this}multiply(_){return this.x*=_.x,this.y*=_.y,this.z*=_.z,this.w*=_.w,this}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this.w*=_,this}applyMatrix4(_){const st=this.x,at=this.y,lt=this.z,ft=this.w,vt=_.elements;return this.x=vt[0]*st+vt[4]*at+vt[8]*lt+vt[12]*ft,this.y=vt[1]*st+vt[5]*at+vt[9]*lt+vt[13]*ft,this.z=vt[2]*st+vt[6]*at+vt[10]*lt+vt[14]*ft,this.w=vt[3]*st+vt[7]*at+vt[11]*lt+vt[15]*ft,this}divideScalar(_){return this.multiplyScalar(1/_)}setAxisAngleFromQuaternion(_){this.w=2*Math.acos(_.w);const st=Math.sqrt(1-_.w*_.w);return st<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=_.x/st,this.y=_.y/st,this.z=_.z/st),this}setAxisAngleFromRotationMatrix(_){let st,at,lt,ft;const Ct=_.elements,Tt=Ct[0],Ot=Ct[4],Ut=Ct[8],Lt=Ct[1],Gt=Ct[5],Xt=Ct[9],Qt=Ct[2],lr=Ct[6],ur=Ct[10];if(Math.abs(Ot-Lt)<.01&&Math.abs(Ut-Qt)<.01&&Math.abs(Xt-lr)<.01){if(Math.abs(Ot+Lt)<.1&&Math.abs(Ut+Qt)<.1&&Math.abs(Xt+lr)<.1&&Math.abs(Tt+Gt+ur-3)<.1)return this.set(1,0,0,0),this;st=Math.PI;const gr=(Tt+1)/2,wr=(Gt+1)/2,Er=(ur+1)/2,Cr=(Ot+Lt)/4,zr=(Ut+Qt)/4,Gr=(Xt+lr)/4;return gr>wr&&gr>Er?gr<.01?(at=0,lt=.707106781,ft=.707106781):(at=Math.sqrt(gr),lt=Cr/at,ft=zr/at):wr>Er?wr<.01?(at=.707106781,lt=0,ft=.707106781):(lt=Math.sqrt(wr),at=Cr/lt,ft=Gr/lt):Er<.01?(at=.707106781,lt=.707106781,ft=0):(ft=Math.sqrt(Er),at=zr/ft,lt=Gr/ft),this.set(at,lt,ft,st),this}let cr=Math.sqrt((lr-Xt)*(lr-Xt)+(Ut-Qt)*(Ut-Qt)+(Lt-Ot)*(Lt-Ot));return Math.abs(cr)<.001&&(cr=1),this.x=(lr-Xt)/cr,this.y=(Ut-Qt)/cr,this.z=(Lt-Ot)/cr,this.w=Math.acos((Tt+Gt+ur-1)/2),this}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this.z=Math.min(this.z,_.z),this.w=Math.min(this.w,_.w),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this.z=Math.max(this.z,_.z),this.w=Math.max(this.w,_.w),this}clamp(_,st){return this.x=Math.max(_.x,Math.min(st.x,this.x)),this.y=Math.max(_.y,Math.min(st.y,this.y)),this.z=Math.max(_.z,Math.min(st.z,this.z)),this.w=Math.max(_.w,Math.min(st.w,this.w)),this}clampScalar(_,st){return this.x=Math.max(_,Math.min(st,this.x)),this.y=Math.max(_,Math.min(st,this.y)),this.z=Math.max(_,Math.min(st,this.z)),this.w=Math.max(_,Math.min(st,this.w)),this}clampLength(_,st){const at=this.length();return this.divideScalar(at||1).multiplyScalar(Math.max(_,Math.min(st,at)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(_){return this.x*_.x+this.y*_.y+this.z*_.z+this.w*_.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,st){return this.x+=(_.x-this.x)*st,this.y+=(_.y-this.y)*st,this.z+=(_.z-this.z)*st,this.w+=(_.w-this.w)*st,this}lerpVectors(_,st,at){return this.x=_.x+(st.x-_.x)*at,this.y=_.y+(st.y-_.y)*at,this.z=_.z+(st.z-_.z)*at,this.w=_.w+(st.w-_.w)*at,this}equals(_){return _.x===this.x&&_.y===this.y&&_.z===this.z&&_.w===this.w}fromArray(_,st=0){return this.x=_[st],this.y=_[st+1],this.z=_[st+2],this.w=_[st+3],this}toArray(_=[],st=0){return _[st]=this.x,_[st+1]=this.y,_[st+2]=this.z,_[st+3]=this.w,_}fromBufferAttribute(_,st){return this.x=_.getX(st),this.y=_.getY(st),this.z=_.getZ(st),this.w=_.getW(st),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ip extends Ws{constructor(_,st,at={}){super(),this.isWebGLRenderTarget=!0,this.width=_,this.height=st,this.depth=1,this.scissor=new qo(0,0,_,st),this.scissorTest=!1,this.viewport=new qo(0,0,_,st);const lt={width:_,height:st,depth:1};this.texture=new Cu(lt,at.mapping,at.wrapS,at.wrapT,at.magFilter,at.minFilter,at.format,at.type,at.anisotropy,at.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=at.generateMipmaps!==void 0&&at.generateMipmaps,this.texture.internalFormat=at.internalFormat!==void 0?at.internalFormat:null,this.texture.minFilter=at.minFilter!==void 0?at.minFilter:Ko,this.depthBuffer=at.depthBuffer===void 0||at.depthBuffer,this.stencilBuffer=at.stencilBuffer!==void 0&&at.stencilBuffer,this.depthTexture=at.depthTexture!==void 0?at.depthTexture:null,this.samples=at.samples!==void 0?at.samples:0}setSize(_,st,at=1){this.width===_&&this.height===st&&this.depth===at||(this.width=_,this.height=st,this.depth=at,this.texture.image.width=_,this.texture.image.height=st,this.texture.image.depth=at,this.dispose()),this.viewport.set(0,0,_,st),this.scissor.set(0,0,_,st)}clone(){return new this.constructor().copy(this)}copy(_){this.width=_.width,this.height=_.height,this.depth=_.depth,this.viewport.copy(_.viewport),this.texture=_.texture.clone(),this.texture.isRenderTargetTexture=!0;const st=Object.assign({},_.texture.image);return this.texture.source=new V_(st),this.depthBuffer=_.depthBuffer,this.stencilBuffer=_.stencilBuffer,_.depthTexture!==null&&(this.depthTexture=_.depthTexture.clone()),this.samples=_.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class N0 extends Cu{constructor(_=null,st=1,at=1,lt=1){super(null),this.isDataArrayTexture=!0,this.image={data:_,width:st,height:at,depth:lt},this.magFilter=ga,this.minFilter=ga,this.wrapR=co,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Px extends Ip{constructor(_,st,at){super(_,st),this.isWebGLArrayRenderTarget=!0,this.depth=at,this.texture=new N0(null,_,st,at),this.texture.isRenderTargetTexture=!0}}class G_ extends Cu{constructor(_=null,st=1,at=1,lt=1){super(null),this.isData3DTexture=!0,this.image={data:_,width:st,height:at,depth:lt},this.magFilter=ga,this.minFilter=ga,this.wrapR=co,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class OA extends Ip{constructor(_,st,at){super(_,st),this.isWebGL3DRenderTarget=!0,this.depth=at,this.texture=new G_(null,_,st,at),this.texture.isRenderTargetTexture=!0}}class im extends Ip{constructor(_,st,at,lt={}){super(_,st,lt),this.isWebGLMultipleRenderTargets=!0;const ft=this.texture;this.texture=[];for(let vt=0;vt<at;vt++)this.texture[vt]=ft.clone(),this.texture[vt].isRenderTargetTexture=!0}setSize(_,st,at=1){if(this.width!==_||this.height!==st||this.depth!==at){this.width=_,this.height=st,this.depth=at;for(let lt=0,ft=this.texture.length;lt<ft;lt++)this.texture[lt].image.width=_,this.texture[lt].image.height=st,this.texture[lt].image.depth=at;this.dispose()}return this.viewport.set(0,0,_,st),this.scissor.set(0,0,_,st),this}copy(_){this.dispose(),this.width=_.width,this.height=_.height,this.depth=_.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=_.depthBuffer,this.stencilBuffer=_.stencilBuffer,_.depthTexture!==null&&(this.depthTexture=_.depthTexture.clone()),this.texture.length=0;for(let st=0,at=_.texture.length;st<at;st++)this.texture[st]=_.texture[st].clone(),this.texture[st].isRenderTargetTexture=!0;return this}}class zu{constructor(_=0,st=0,at=0,lt=1){this.isQuaternion=!0,this._x=_,this._y=st,this._z=at,this._w=lt}static slerpFlat(_,st,at,lt,ft,vt,At){let Ct=at[lt+0],Tt=at[lt+1],Ot=at[lt+2],Ut=at[lt+3];const Lt=ft[vt+0],Gt=ft[vt+1],Xt=ft[vt+2],Qt=ft[vt+3];if(At===0)return _[st+0]=Ct,_[st+1]=Tt,_[st+2]=Ot,void(_[st+3]=Ut);if(At===1)return _[st+0]=Lt,_[st+1]=Gt,_[st+2]=Xt,void(_[st+3]=Qt);if(Ut!==Qt||Ct!==Lt||Tt!==Gt||Ot!==Xt){let lr=1-At;const ur=Ct*Lt+Tt*Gt+Ot*Xt+Ut*Qt,cr=ur>=0?1:-1,gr=1-ur*ur;if(gr>Number.EPSILON){const Er=Math.sqrt(gr),Cr=Math.atan2(Er,ur*cr);lr=Math.sin(lr*Cr)/Er,At=Math.sin(At*Cr)/Er}const wr=At*cr;if(Ct=Ct*lr+Lt*wr,Tt=Tt*lr+Gt*wr,Ot=Ot*lr+Xt*wr,Ut=Ut*lr+Qt*wr,lr===1-At){const Er=1/Math.sqrt(Ct*Ct+Tt*Tt+Ot*Ot+Ut*Ut);Ct*=Er,Tt*=Er,Ot*=Er,Ut*=Er}}_[st]=Ct,_[st+1]=Tt,_[st+2]=Ot,_[st+3]=Ut}static multiplyQuaternionsFlat(_,st,at,lt,ft,vt){const At=at[lt],Ct=at[lt+1],Tt=at[lt+2],Ot=at[lt+3],Ut=ft[vt],Lt=ft[vt+1],Gt=ft[vt+2],Xt=ft[vt+3];return _[st]=At*Xt+Ot*Ut+Ct*Gt-Tt*Lt,_[st+1]=Ct*Xt+Ot*Lt+Tt*Ut-At*Gt,_[st+2]=Tt*Xt+Ot*Gt+At*Lt-Ct*Ut,_[st+3]=Ot*Xt-At*Ut-Ct*Lt-Tt*Gt,_}get x(){return this._x}set x(_){this._x=_,this._onChangeCallback()}get y(){return this._y}set y(_){this._y=_,this._onChangeCallback()}get z(){return this._z}set z(_){this._z=_,this._onChangeCallback()}get w(){return this._w}set w(_){this._w=_,this._onChangeCallback()}set(_,st,at,lt){return this._x=_,this._y=st,this._z=at,this._w=lt,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(_){return this._x=_.x,this._y=_.y,this._z=_.z,this._w=_.w,this._onChangeCallback(),this}setFromEuler(_,st){const at=_._x,lt=_._y,ft=_._z,vt=_._order,At=Math.cos,Ct=Math.sin,Tt=At(at/2),Ot=At(lt/2),Ut=At(ft/2),Lt=Ct(at/2),Gt=Ct(lt/2),Xt=Ct(ft/2);switch(vt){case"XYZ":this._x=Lt*Ot*Ut+Tt*Gt*Xt,this._y=Tt*Gt*Ut-Lt*Ot*Xt,this._z=Tt*Ot*Xt+Lt*Gt*Ut,this._w=Tt*Ot*Ut-Lt*Gt*Xt;break;case"YXZ":this._x=Lt*Ot*Ut+Tt*Gt*Xt,this._y=Tt*Gt*Ut-Lt*Ot*Xt,this._z=Tt*Ot*Xt-Lt*Gt*Ut,this._w=Tt*Ot*Ut+Lt*Gt*Xt;break;case"ZXY":this._x=Lt*Ot*Ut-Tt*Gt*Xt,this._y=Tt*Gt*Ut+Lt*Ot*Xt,this._z=Tt*Ot*Xt+Lt*Gt*Ut,this._w=Tt*Ot*Ut-Lt*Gt*Xt;break;case"ZYX":this._x=Lt*Ot*Ut-Tt*Gt*Xt,this._y=Tt*Gt*Ut+Lt*Ot*Xt,this._z=Tt*Ot*Xt-Lt*Gt*Ut,this._w=Tt*Ot*Ut+Lt*Gt*Xt;break;case"YZX":this._x=Lt*Ot*Ut+Tt*Gt*Xt,this._y=Tt*Gt*Ut+Lt*Ot*Xt,this._z=Tt*Ot*Xt-Lt*Gt*Ut,this._w=Tt*Ot*Ut-Lt*Gt*Xt;break;case"XZY":this._x=Lt*Ot*Ut-Tt*Gt*Xt,this._y=Tt*Gt*Ut-Lt*Ot*Xt,this._z=Tt*Ot*Xt+Lt*Gt*Ut,this._w=Tt*Ot*Ut+Lt*Gt*Xt;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+vt)}return st!==!1&&this._onChangeCallback(),this}setFromAxisAngle(_,st){const at=st/2,lt=Math.sin(at);return this._x=_.x*lt,this._y=_.y*lt,this._z=_.z*lt,this._w=Math.cos(at),this._onChangeCallback(),this}setFromRotationMatrix(_){const st=_.elements,at=st[0],lt=st[4],ft=st[8],vt=st[1],At=st[5],Ct=st[9],Tt=st[2],Ot=st[6],Ut=st[10],Lt=at+At+Ut;if(Lt>0){const Gt=.5/Math.sqrt(Lt+1);this._w=.25/Gt,this._x=(Ot-Ct)*Gt,this._y=(ft-Tt)*Gt,this._z=(vt-lt)*Gt}else if(at>At&&at>Ut){const Gt=2*Math.sqrt(1+at-At-Ut);this._w=(Ot-Ct)/Gt,this._x=.25*Gt,this._y=(lt+vt)/Gt,this._z=(ft+Tt)/Gt}else if(At>Ut){const Gt=2*Math.sqrt(1+At-at-Ut);this._w=(ft-Tt)/Gt,this._x=(lt+vt)/Gt,this._y=.25*Gt,this._z=(Ct+Ot)/Gt}else{const Gt=2*Math.sqrt(1+Ut-at-At);this._w=(vt-lt)/Gt,this._x=(ft+Tt)/Gt,this._y=(Ct+Ot)/Gt,this._z=.25*Gt}return this._onChangeCallback(),this}setFromUnitVectors(_,st){let at=_.dot(st)+1;return at<Number.EPSILON?(at=0,Math.abs(_.x)>Math.abs(_.z)?(this._x=-_.y,this._y=_.x,this._z=0,this._w=at):(this._x=0,this._y=-_.z,this._z=_.y,this._w=at)):(this._x=_.y*st.z-_.z*st.y,this._y=_.z*st.x-_.x*st.z,this._z=_.x*st.y-_.y*st.x,this._w=at),this.normalize()}angleTo(_){return 2*Math.acos(Math.abs(Ls(this.dot(_),-1,1)))}rotateTowards(_,st){const at=this.angleTo(_);if(at===0)return this;const lt=Math.min(1,st/at);return this.slerp(_,lt),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(_){return this._x*_._x+this._y*_._y+this._z*_._z+this._w*_._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let _=this.length();return _===0?(this._x=0,this._y=0,this._z=0,this._w=1):(_=1/_,this._x=this._x*_,this._y=this._y*_,this._z=this._z*_,this._w=this._w*_),this._onChangeCallback(),this}multiply(_){return this.multiplyQuaternions(this,_)}premultiply(_){return this.multiplyQuaternions(_,this)}multiplyQuaternions(_,st){const at=_._x,lt=_._y,ft=_._z,vt=_._w,At=st._x,Ct=st._y,Tt=st._z,Ot=st._w;return this._x=at*Ot+vt*At+lt*Tt-ft*Ct,this._y=lt*Ot+vt*Ct+ft*At-at*Tt,this._z=ft*Ot+vt*Tt+at*Ct-lt*At,this._w=vt*Ot-at*At-lt*Ct-ft*Tt,this._onChangeCallback(),this}slerp(_,st){if(st===0)return this;if(st===1)return this.copy(_);const at=this._x,lt=this._y,ft=this._z,vt=this._w;let At=vt*_._w+at*_._x+lt*_._y+ft*_._z;if(At<0?(this._w=-_._w,this._x=-_._x,this._y=-_._y,this._z=-_._z,At=-At):this.copy(_),At>=1)return this._w=vt,this._x=at,this._y=lt,this._z=ft,this;const Ct=1-At*At;if(Ct<=Number.EPSILON){const Gt=1-st;return this._w=Gt*vt+st*this._w,this._x=Gt*at+st*this._x,this._y=Gt*lt+st*this._y,this._z=Gt*ft+st*this._z,this.normalize(),this._onChangeCallback(),this}const Tt=Math.sqrt(Ct),Ot=Math.atan2(Tt,At),Ut=Math.sin((1-st)*Ot)/Tt,Lt=Math.sin(st*Ot)/Tt;return this._w=vt*Ut+this._w*Lt,this._x=at*Ut+this._x*Lt,this._y=lt*Ut+this._y*Lt,this._z=ft*Ut+this._z*Lt,this._onChangeCallback(),this}slerpQuaternions(_,st,at){return this.copy(_).slerp(st,at)}random(){const _=Math.random(),st=Math.sqrt(1-_),at=Math.sqrt(_),lt=2*Math.PI*Math.random(),ft=2*Math.PI*Math.random();return this.set(st*Math.cos(lt),at*Math.sin(ft),at*Math.cos(ft),st*Math.sin(lt))}equals(_){return _._x===this._x&&_._y===this._y&&_._z===this._z&&_._w===this._w}fromArray(_,st=0){return this._x=_[st],this._y=_[st+1],this._z=_[st+2],this._w=_[st+3],this._onChangeCallback(),this}toArray(_=[],st=0){return _[st]=this._x,_[st+1]=this._y,_[st+2]=this._z,_[st+3]=this._w,_}fromBufferAttribute(_,st){return this._x=_.getX(st),this._y=_.getY(st),this._z=_.getZ(st),this._w=_.getW(st),this}_onChange(_){return this._onChangeCallback=_,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Mr{constructor(_=0,st=0,at=0){Mr.prototype.isVector3=!0,this.x=_,this.y=st,this.z=at}set(_,st,at){return at===void 0&&(at=this.z),this.x=_,this.y=st,this.z=at,this}setScalar(_){return this.x=_,this.y=_,this.z=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setZ(_){return this.z=_,this}setComponent(_,st){switch(_){case 0:this.x=st;break;case 1:this.y=st;break;case 2:this.z=st;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this}add(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this}addScalar(_){return this.x+=_,this.y+=_,this.z+=_,this}addVectors(_,st){return this.x=_.x+st.x,this.y=_.y+st.y,this.z=_.z+st.z,this}addScaledVector(_,st){return this.x+=_.x*st,this.y+=_.y*st,this.z+=_.z*st,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this}subScalar(_){return this.x-=_,this.y-=_,this.z-=_,this}subVectors(_,st){return this.x=_.x-st.x,this.y=_.y-st.y,this.z=_.z-st.z,this}multiply(_){return this.x*=_.x,this.y*=_.y,this.z*=_.z,this}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this}multiplyVectors(_,st){return this.x=_.x*st.x,this.y=_.y*st.y,this.z=_.z*st.z,this}applyEuler(_){return this.applyQuaternion(sm.setFromEuler(_))}applyAxisAngle(_,st){return this.applyQuaternion(sm.setFromAxisAngle(_,st))}applyMatrix3(_){const st=this.x,at=this.y,lt=this.z,ft=_.elements;return this.x=ft[0]*st+ft[3]*at+ft[6]*lt,this.y=ft[1]*st+ft[4]*at+ft[7]*lt,this.z=ft[2]*st+ft[5]*at+ft[8]*lt,this}applyNormalMatrix(_){return this.applyMatrix3(_).normalize()}applyMatrix4(_){const st=this.x,at=this.y,lt=this.z,ft=_.elements,vt=1/(ft[3]*st+ft[7]*at+ft[11]*lt+ft[15]);return this.x=(ft[0]*st+ft[4]*at+ft[8]*lt+ft[12])*vt,this.y=(ft[1]*st+ft[5]*at+ft[9]*lt+ft[13])*vt,this.z=(ft[2]*st+ft[6]*at+ft[10]*lt+ft[14])*vt,this}applyQuaternion(_){const st=this.x,at=this.y,lt=this.z,ft=_.x,vt=_.y,At=_.z,Ct=_.w,Tt=Ct*st+vt*lt-At*at,Ot=Ct*at+At*st-ft*lt,Ut=Ct*lt+ft*at-vt*st,Lt=-ft*st-vt*at-At*lt;return this.x=Tt*Ct+Lt*-ft+Ot*-At-Ut*-vt,this.y=Ot*Ct+Lt*-vt+Ut*-ft-Tt*-At,this.z=Ut*Ct+Lt*-At+Tt*-vt-Ot*-ft,this}project(_){return this.applyMatrix4(_.matrixWorldInverse).applyMatrix4(_.projectionMatrix)}unproject(_){return this.applyMatrix4(_.projectionMatrixInverse).applyMatrix4(_.matrixWorld)}transformDirection(_){const st=this.x,at=this.y,lt=this.z,ft=_.elements;return this.x=ft[0]*st+ft[4]*at+ft[8]*lt,this.y=ft[1]*st+ft[5]*at+ft[9]*lt,this.z=ft[2]*st+ft[6]*at+ft[10]*lt,this.normalize()}divide(_){return this.x/=_.x,this.y/=_.y,this.z/=_.z,this}divideScalar(_){return this.multiplyScalar(1/_)}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this.z=Math.min(this.z,_.z),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this.z=Math.max(this.z,_.z),this}clamp(_,st){return this.x=Math.max(_.x,Math.min(st.x,this.x)),this.y=Math.max(_.y,Math.min(st.y,this.y)),this.z=Math.max(_.z,Math.min(st.z,this.z)),this}clampScalar(_,st){return this.x=Math.max(_,Math.min(st,this.x)),this.y=Math.max(_,Math.min(st,this.y)),this.z=Math.max(_,Math.min(st,this.z)),this}clampLength(_,st){const at=this.length();return this.divideScalar(at||1).multiplyScalar(Math.max(_,Math.min(st,at)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(_){return this.x*_.x+this.y*_.y+this.z*_.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,st){return this.x+=(_.x-this.x)*st,this.y+=(_.y-this.y)*st,this.z+=(_.z-this.z)*st,this}lerpVectors(_,st,at){return this.x=_.x+(st.x-_.x)*at,this.y=_.y+(st.y-_.y)*at,this.z=_.z+(st.z-_.z)*at,this}cross(_){return this.crossVectors(this,_)}crossVectors(_,st){const at=_.x,lt=_.y,ft=_.z,vt=st.x,At=st.y,Ct=st.z;return this.x=lt*Ct-ft*At,this.y=ft*vt-at*Ct,this.z=at*At-lt*vt,this}projectOnVector(_){const st=_.lengthSq();if(st===0)return this.set(0,0,0);const at=_.dot(this)/st;return this.copy(_).multiplyScalar(at)}projectOnPlane(_){return wv.copy(this).projectOnVector(_),this.sub(wv)}reflect(_){return this.sub(wv.copy(_).multiplyScalar(2*this.dot(_)))}angleTo(_){const st=Math.sqrt(this.lengthSq()*_.lengthSq());if(st===0)return Math.PI/2;const at=this.dot(_)/st;return Math.acos(Ls(at,-1,1))}distanceTo(_){return Math.sqrt(this.distanceToSquared(_))}distanceToSquared(_){const st=this.x-_.x,at=this.y-_.y,lt=this.z-_.z;return st*st+at*at+lt*lt}manhattanDistanceTo(_){return Math.abs(this.x-_.x)+Math.abs(this.y-_.y)+Math.abs(this.z-_.z)}setFromSpherical(_){return this.setFromSphericalCoords(_.radius,_.phi,_.theta)}setFromSphericalCoords(_,st,at){const lt=Math.sin(st)*_;return this.x=lt*Math.sin(at),this.y=Math.cos(st)*_,this.z=lt*Math.cos(at),this}setFromCylindrical(_){return this.setFromCylindricalCoords(_.radius,_.theta,_.y)}setFromCylindricalCoords(_,st,at){return this.x=_*Math.sin(st),this.y=at,this.z=_*Math.cos(st),this}setFromMatrixPosition(_){const st=_.elements;return this.x=st[12],this.y=st[13],this.z=st[14],this}setFromMatrixScale(_){const st=this.setFromMatrixColumn(_,0).length(),at=this.setFromMatrixColumn(_,1).length(),lt=this.setFromMatrixColumn(_,2).length();return this.x=st,this.y=at,this.z=lt,this}setFromMatrixColumn(_,st){return this.fromArray(_.elements,4*st)}setFromMatrix3Column(_,st){return this.fromArray(_.elements,3*st)}setFromEuler(_){return this.x=_._x,this.y=_._y,this.z=_._z,this}equals(_){return _.x===this.x&&_.y===this.y&&_.z===this.z}fromArray(_,st=0){return this.x=_[st],this.y=_[st+1],this.z=_[st+2],this}toArray(_=[],st=0){return _[st]=this.x,_[st+1]=this.y,_[st+2]=this.z,_}fromBufferAttribute(_,st){return this.x=_.getX(st),this.y=_.getY(st),this.z=_.getZ(st),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const _=2*(Math.random()-.5),st=Math.random()*Math.PI*2,at=Math.sqrt(1-_**2);return this.x=at*Math.cos(st),this.y=at*Math.sin(st),this.z=_,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const wv=new Mr,sm=new zu;class Q_{constructor(_=new Mr(1/0,1/0,1/0),st=new Mr(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=_,this.max=st}set(_,st){return this.min.copy(_),this.max.copy(st),this}setFromArray(_){let st=1/0,at=1/0,lt=1/0,ft=-1/0,vt=-1/0,At=-1/0;for(let Ct=0,Tt=_.length;Ct<Tt;Ct+=3){const Ot=_[Ct],Ut=_[Ct+1],Lt=_[Ct+2];Ot<st&&(st=Ot),Ut<at&&(at=Ut),Lt<lt&&(lt=Lt),Ot>ft&&(ft=Ot),Ut>vt&&(vt=Ut),Lt>At&&(At=Lt)}return this.min.set(st,at,lt),this.max.set(ft,vt,At),this}setFromBufferAttribute(_){let st=1/0,at=1/0,lt=1/0,ft=-1/0,vt=-1/0,At=-1/0;for(let Ct=0,Tt=_.count;Ct<Tt;Ct++){const Ot=_.getX(Ct),Ut=_.getY(Ct),Lt=_.getZ(Ct);Ot<st&&(st=Ot),Ut<at&&(at=Ut),Lt<lt&&(lt=Lt),Ot>ft&&(ft=Ot),Ut>vt&&(vt=Ut),Lt>At&&(At=Lt)}return this.min.set(st,at,lt),this.max.set(ft,vt,At),this}setFromPoints(_){this.makeEmpty();for(let st=0,at=_.length;st<at;st++)this.expandByPoint(_[st]);return this}setFromCenterAndSize(_,st){const at=H_.copy(st).multiplyScalar(.5);return this.min.copy(_).sub(at),this.max.copy(_).add(at),this}setFromObject(_,st=!1){return this.makeEmpty(),this.expandByObject(_,st)}clone(){return new this.constructor().copy(this)}copy(_){return this.min.copy(_.min),this.max.copy(_.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(_){return this.isEmpty()?_.set(0,0,0):_.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_){return this.isEmpty()?_.set(0,0,0):_.subVectors(this.max,this.min)}expandByPoint(_){return this.min.min(_),this.max.max(_),this}expandByVector(_){return this.min.sub(_),this.max.add(_),this}expandByScalar(_){return this.min.addScalar(-_),this.max.addScalar(_),this}expandByObject(_,st=!1){_.updateWorldMatrix(!1,!1);const at=_.geometry;if(at!==void 0)if(st&&at.attributes!=null&&at.attributes.position!==void 0){const ft=at.attributes.position;for(let vt=0,At=ft.count;vt<At;vt++)H_.fromBufferAttribute(ft,vt).applyMatrix4(_.matrixWorld),this.expandByPoint(H_)}else at.boundingBox===null&&at.computeBoundingBox(),LA.copy(at.boundingBox),LA.applyMatrix4(_.matrixWorld),this.union(LA);const lt=_.children;for(let ft=0,vt=lt.length;ft<vt;ft++)this.expandByObject(lt[ft],st);return this}containsPoint(_){return!(_.x<this.min.x||_.x>this.max.x||_.y<this.min.y||_.y>this.max.y||_.z<this.min.z||_.z>this.max.z)}containsBox(_){return this.min.x<=_.min.x&&_.max.x<=this.max.x&&this.min.y<=_.min.y&&_.max.y<=this.max.y&&this.min.z<=_.min.z&&_.max.z<=this.max.z}getParameter(_,st){return st.set((_.x-this.min.x)/(this.max.x-this.min.x),(_.y-this.min.y)/(this.max.y-this.min.y),(_.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(_){return!(_.max.x<this.min.x||_.min.x>this.max.x||_.max.y<this.min.y||_.min.y>this.max.y||_.max.z<this.min.z||_.min.z>this.max.z)}intersectsSphere(_){return this.clampPoint(_.center,H_),H_.distanceToSquared(_.center)<=_.radius*_.radius}intersectsPlane(_){let st,at;return _.normal.x>0?(st=_.normal.x*this.min.x,at=_.normal.x*this.max.x):(st=_.normal.x*this.max.x,at=_.normal.x*this.min.x),_.normal.y>0?(st+=_.normal.y*this.min.y,at+=_.normal.y*this.max.y):(st+=_.normal.y*this.max.y,at+=_.normal.y*this.min.y),_.normal.z>0?(st+=_.normal.z*this.min.z,at+=_.normal.z*this.max.z):(st+=_.normal.z*this.max.z,at+=_.normal.z*this.min.z),st<=-_.constant&&at>=-_.constant}intersectsTriangle(_){if(this.isEmpty())return!1;this.getCenter(F0),NA.subVectors(this.max,F0),Tm.subVectors(_.a,F0),r_.subVectors(_.b,F0),Ev.subVectors(_.c,F0),Mm.subVectors(r_,Tm),n_.subVectors(Ev,r_),Pp.subVectors(Tm,Ev);let st=[0,-Mm.z,Mm.y,0,-n_.z,n_.y,0,-Pp.z,Pp.y,Mm.z,0,-Mm.x,n_.z,0,-n_.x,Pp.z,0,-Pp.x,-Mm.y,Mm.x,0,-n_.y,n_.x,0,-Pp.y,Pp.x,0];return!!FA(st,Tm,r_,Ev,NA)&&(st=[1,0,0,0,1,0,0,0,1],!!FA(st,Tm,r_,Ev,NA)&&(q_.crossVectors(Mm,n_),st=[q_.x,q_.y,q_.z],FA(st,Tm,r_,Ev,NA)))}clampPoint(_,st){return st.copy(_).clamp(this.min,this.max)}distanceToPoint(_){return H_.copy(_).clamp(this.min,this.max).sub(_).length()}getBoundingSphere(_){return this.getCenter(_.center),_.radius=.5*this.getSize(H_).length(),_}intersect(_){return this.min.max(_.min),this.max.min(_.max),this.isEmpty()&&this.makeEmpty(),this}union(_){return this.min.min(_.min),this.max.max(_.max),this}applyMatrix4(_){return this.isEmpty()||(xv[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(_),xv[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(_),xv[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(_),xv[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(_),xv[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(_),xv[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(_),xv[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(_),xv[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(_),this.setFromPoints(xv)),this}translate(_){return this.min.add(_),this.max.add(_),this}equals(_){return _.min.equals(this.min)&&_.max.equals(this.max)}}const xv=[new Mr,new Mr,new Mr,new Mr,new Mr,new Mr,new Mr,new Mr],H_=new Mr,LA=new Q_,Tm=new Mr,r_=new Mr,Ev=new Mr,Mm=new Mr,n_=new Mr,Pp=new Mr,F0=new Mr,NA=new Mr,q_=new Mr,i_=new Mr;function FA(wt,_,st,at,lt){for(let ft=0,vt=wt.length-3;ft<=vt;ft+=3){i_.fromArray(wt,ft);const At=lt.x*Math.abs(i_.x)+lt.y*Math.abs(i_.y)+lt.z*Math.abs(i_.z),Ct=_.dot(i_),Tt=st.dot(i_),Ot=at.dot(i_);if(Math.max(-Math.max(Ct,Tt,Ot),Math.min(Ct,Tt,Ot))>At)return!1}return!0}const Io=new Q_,Nl=new Mr,om=new Mr,zp=new Mr;class am{constructor(_=new Mr,st=-1){this.center=_,this.radius=st}set(_,st){return this.center.copy(_),this.radius=st,this}setFromPoints(_,st){const at=this.center;st!==void 0?at.copy(st):Io.setFromPoints(_).getCenter(at);let lt=0;for(let ft=0,vt=_.length;ft<vt;ft++)lt=Math.max(lt,at.distanceToSquared(_[ft]));return this.radius=Math.sqrt(lt),this}copy(_){return this.center.copy(_.center),this.radius=_.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(_){return _.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(_){return _.distanceTo(this.center)-this.radius}intersectsSphere(_){const st=this.radius+_.radius;return _.center.distanceToSquared(this.center)<=st*st}intersectsBox(_){return _.intersectsSphere(this)}intersectsPlane(_){return Math.abs(_.distanceToPoint(this.center))<=this.radius}clampPoint(_,st){const at=this.center.distanceToSquared(_);return st.copy(_),at>this.radius*this.radius&&(st.sub(this.center).normalize(),st.multiplyScalar(this.radius).add(this.center)),st}getBoundingBox(_){return this.isEmpty()?(_.makeEmpty(),_):(_.set(this.center,this.center),_.expandByScalar(this.radius),_)}applyMatrix4(_){return this.center.applyMatrix4(_),this.radius=this.radius*_.getMaxScaleOnAxis(),this}translate(_){return this.center.add(_),this}expandByPoint(_){zp.subVectors(_,this.center);const st=zp.lengthSq();if(st>this.radius*this.radius){const at=Math.sqrt(st),lt=.5*(at-this.radius);this.center.add(zp.multiplyScalar(lt/at)),this.radius+=lt}return this}union(_){return this.center.equals(_.center)===!0?om.set(0,0,1).multiplyScalar(_.radius):om.subVectors(_.center,this.center).normalize().multiplyScalar(_.radius),this.expandByPoint(Nl.copy(_.center).add(om)),this.expandByPoint(Nl.copy(_.center).sub(om)),this}equals(_){return _.center.equals(this.center)&&_.radius===this.radius}clone(){return new this.constructor().copy(this)}}const xu=new Mr,UA=new Mr,U0=new Mr,Ym=new Mr,$0=new Mr,Uy=new Mr,$A=new Mr;class s_{constructor(_=new Mr,st=new Mr(0,0,-1)){this.origin=_,this.direction=st}set(_,st){return this.origin.copy(_),this.direction.copy(st),this}copy(_){return this.origin.copy(_.origin),this.direction.copy(_.direction),this}at(_,st){return st.copy(this.direction).multiplyScalar(_).add(this.origin)}lookAt(_){return this.direction.copy(_).sub(this.origin).normalize(),this}recast(_){return this.origin.copy(this.at(_,xu)),this}closestPointToPoint(_,st){st.subVectors(_,this.origin);const at=st.dot(this.direction);return at<0?st.copy(this.origin):st.copy(this.direction).multiplyScalar(at).add(this.origin)}distanceToPoint(_){return Math.sqrt(this.distanceSqToPoint(_))}distanceSqToPoint(_){const st=xu.subVectors(_,this.origin).dot(this.direction);return st<0?this.origin.distanceToSquared(_):(xu.copy(this.direction).multiplyScalar(st).add(this.origin),xu.distanceToSquared(_))}distanceSqToSegment(_,st,at,lt){UA.copy(_).add(st).multiplyScalar(.5),U0.copy(st).sub(_).normalize(),Ym.copy(this.origin).sub(UA);const ft=.5*_.distanceTo(st),vt=-this.direction.dot(U0),At=Ym.dot(this.direction),Ct=-Ym.dot(U0),Tt=Ym.lengthSq(),Ot=Math.abs(1-vt*vt);let Ut,Lt,Gt,Xt;if(Ot>0)if(Ut=vt*Ct-At,Lt=vt*At-Ct,Xt=ft*Ot,Ut>=0)if(Lt>=-Xt)if(Lt<=Xt){const Qt=1/Ot;Ut*=Qt,Lt*=Qt,Gt=Ut*(Ut+vt*Lt+2*At)+Lt*(vt*Ut+Lt+2*Ct)+Tt}else Lt=ft,Ut=Math.max(0,-(vt*Lt+At)),Gt=-Ut*Ut+Lt*(Lt+2*Ct)+Tt;else Lt=-ft,Ut=Math.max(0,-(vt*Lt+At)),Gt=-Ut*Ut+Lt*(Lt+2*Ct)+Tt;else Lt<=-Xt?(Ut=Math.max(0,-(-vt*ft+At)),Lt=Ut>0?-ft:Math.min(Math.max(-ft,-Ct),ft),Gt=-Ut*Ut+Lt*(Lt+2*Ct)+Tt):Lt<=Xt?(Ut=0,Lt=Math.min(Math.max(-ft,-Ct),ft),Gt=Lt*(Lt+2*Ct)+Tt):(Ut=Math.max(0,-(vt*ft+At)),Lt=Ut>0?ft:Math.min(Math.max(-ft,-Ct),ft),Gt=-Ut*Ut+Lt*(Lt+2*Ct)+Tt);else Lt=vt>0?-ft:ft,Ut=Math.max(0,-(vt*Lt+At)),Gt=-Ut*Ut+Lt*(Lt+2*Ct)+Tt;return at&&at.copy(this.direction).multiplyScalar(Ut).add(this.origin),lt&&lt.copy(U0).multiplyScalar(Lt).add(UA),Gt}intersectSphere(_,st){xu.subVectors(_.center,this.origin);const at=xu.dot(this.direction),lt=xu.dot(xu)-at*at,ft=_.radius*_.radius;if(lt>ft)return null;const vt=Math.sqrt(ft-lt),At=at-vt,Ct=at+vt;return At<0&&Ct<0?null:At<0?this.at(Ct,st):this.at(At,st)}intersectsSphere(_){return this.distanceSqToPoint(_.center)<=_.radius*_.radius}distanceToPlane(_){const st=_.normal.dot(this.direction);if(st===0)return _.distanceToPoint(this.origin)===0?0:null;const at=-(this.origin.dot(_.normal)+_.constant)/st;return at>=0?at:null}intersectPlane(_,st){const at=this.distanceToPlane(_);return at===null?null:this.at(at,st)}intersectsPlane(_){const st=_.distanceToPoint(this.origin);return st===0||_.normal.dot(this.direction)*st<0}intersectBox(_,st){let at,lt,ft,vt,At,Ct;const Tt=1/this.direction.x,Ot=1/this.direction.y,Ut=1/this.direction.z,Lt=this.origin;return Tt>=0?(at=(_.min.x-Lt.x)*Tt,lt=(_.max.x-Lt.x)*Tt):(at=(_.max.x-Lt.x)*Tt,lt=(_.min.x-Lt.x)*Tt),Ot>=0?(ft=(_.min.y-Lt.y)*Ot,vt=(_.max.y-Lt.y)*Ot):(ft=(_.max.y-Lt.y)*Ot,vt=(_.min.y-Lt.y)*Ot),at>vt||ft>lt?null:((ft>at||at!=at)&&(at=ft),(vt<lt||lt!=lt)&&(lt=vt),Ut>=0?(At=(_.min.z-Lt.z)*Ut,Ct=(_.max.z-Lt.z)*Ut):(At=(_.max.z-Lt.z)*Ut,Ct=(_.min.z-Lt.z)*Ut),at>Ct||At>lt?null:((At>at||at!=at)&&(at=At),(Ct<lt||lt!=lt)&&(lt=Ct),lt<0?null:this.at(at>=0?at:lt,st)))}intersectsBox(_){return this.intersectBox(_,xu)!==null}intersectTriangle(_,st,at,lt,ft){$0.subVectors(st,_),Uy.subVectors(at,_),$A.crossVectors($0,Uy);let vt,At=this.direction.dot($A);if(At>0){if(lt)return null;vt=1}else{if(!(At<0))return null;vt=-1,At=-At}Ym.subVectors(this.origin,_);const Ct=vt*this.direction.dot(Uy.crossVectors(Ym,Uy));if(Ct<0)return null;const Tt=vt*this.direction.dot($0.cross(Ym));if(Tt<0||Ct+Tt>At)return null;const Ot=-vt*Ym.dot($A);return Ot<0?null:this.at(Ot/At,ft)}applyMatrix4(_){return this.origin.applyMatrix4(_),this.direction.transformDirection(_),this}equals(_){return _.origin.equals(this.origin)&&_.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ys{constructor(){Ys.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(_,st,at,lt,ft,vt,At,Ct,Tt,Ot,Ut,Lt,Gt,Xt,Qt,lr){const ur=this.elements;return ur[0]=_,ur[4]=st,ur[8]=at,ur[12]=lt,ur[1]=ft,ur[5]=vt,ur[9]=At,ur[13]=Ct,ur[2]=Tt,ur[6]=Ot,ur[10]=Ut,ur[14]=Lt,ur[3]=Gt,ur[7]=Xt,ur[11]=Qt,ur[15]=lr,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ys().fromArray(this.elements)}copy(_){const st=this.elements,at=_.elements;return st[0]=at[0],st[1]=at[1],st[2]=at[2],st[3]=at[3],st[4]=at[4],st[5]=at[5],st[6]=at[6],st[7]=at[7],st[8]=at[8],st[9]=at[9],st[10]=at[10],st[11]=at[11],st[12]=at[12],st[13]=at[13],st[14]=at[14],st[15]=at[15],this}copyPosition(_){const st=this.elements,at=_.elements;return st[12]=at[12],st[13]=at[13],st[14]=at[14],this}setFromMatrix3(_){const st=_.elements;return this.set(st[0],st[3],st[6],0,st[1],st[4],st[7],0,st[2],st[5],st[8],0,0,0,0,1),this}extractBasis(_,st,at){return _.setFromMatrixColumn(this,0),st.setFromMatrixColumn(this,1),at.setFromMatrixColumn(this,2),this}makeBasis(_,st,at){return this.set(_.x,st.x,at.x,0,_.y,st.y,at.y,0,_.z,st.z,at.z,0,0,0,0,1),this}extractRotation(_){const st=this.elements,at=_.elements,lt=1/$a.setFromMatrixColumn(_,0).length(),ft=1/$a.setFromMatrixColumn(_,1).length(),vt=1/$a.setFromMatrixColumn(_,2).length();return st[0]=at[0]*lt,st[1]=at[1]*lt,st[2]=at[2]*lt,st[3]=0,st[4]=at[4]*ft,st[5]=at[5]*ft,st[6]=at[6]*ft,st[7]=0,st[8]=at[8]*vt,st[9]=at[9]*vt,st[10]=at[10]*vt,st[11]=0,st[12]=0,st[13]=0,st[14]=0,st[15]=1,this}makeRotationFromEuler(_){const st=this.elements,at=_.x,lt=_.y,ft=_.z,vt=Math.cos(at),At=Math.sin(at),Ct=Math.cos(lt),Tt=Math.sin(lt),Ot=Math.cos(ft),Ut=Math.sin(ft);if(_.order==="XYZ"){const Lt=vt*Ot,Gt=vt*Ut,Xt=At*Ot,Qt=At*Ut;st[0]=Ct*Ot,st[4]=-Ct*Ut,st[8]=Tt,st[1]=Gt+Xt*Tt,st[5]=Lt-Qt*Tt,st[9]=-At*Ct,st[2]=Qt-Lt*Tt,st[6]=Xt+Gt*Tt,st[10]=vt*Ct}else if(_.order==="YXZ"){const Lt=Ct*Ot,Gt=Ct*Ut,Xt=Tt*Ot,Qt=Tt*Ut;st[0]=Lt+Qt*At,st[4]=Xt*At-Gt,st[8]=vt*Tt,st[1]=vt*Ut,st[5]=vt*Ot,st[9]=-At,st[2]=Gt*At-Xt,st[6]=Qt+Lt*At,st[10]=vt*Ct}else if(_.order==="ZXY"){const Lt=Ct*Ot,Gt=Ct*Ut,Xt=Tt*Ot,Qt=Tt*Ut;st[0]=Lt-Qt*At,st[4]=-vt*Ut,st[8]=Xt+Gt*At,st[1]=Gt+Xt*At,st[5]=vt*Ot,st[9]=Qt-Lt*At,st[2]=-vt*Tt,st[6]=At,st[10]=vt*Ct}else if(_.order==="ZYX"){const Lt=vt*Ot,Gt=vt*Ut,Xt=At*Ot,Qt=At*Ut;st[0]=Ct*Ot,st[4]=Xt*Tt-Gt,st[8]=Lt*Tt+Qt,st[1]=Ct*Ut,st[5]=Qt*Tt+Lt,st[9]=Gt*Tt-Xt,st[2]=-Tt,st[6]=At*Ct,st[10]=vt*Ct}else if(_.order==="YZX"){const Lt=vt*Ct,Gt=vt*Tt,Xt=At*Ct,Qt=At*Tt;st[0]=Ct*Ot,st[4]=Qt-Lt*Ut,st[8]=Xt*Ut+Gt,st[1]=Ut,st[5]=vt*Ot,st[9]=-At*Ot,st[2]=-Tt*Ot,st[6]=Gt*Ut+Xt,st[10]=Lt-Qt*Ut}else if(_.order==="XZY"){const Lt=vt*Ct,Gt=vt*Tt,Xt=At*Ct,Qt=At*Tt;st[0]=Ct*Ot,st[4]=-Ut,st[8]=Tt*Ot,st[1]=Lt*Ut+Qt,st[5]=vt*Ot,st[9]=Gt*Ut-Xt,st[2]=Xt*Ut-Gt,st[6]=At*Ot,st[10]=Qt*Ut+Lt}return st[3]=0,st[7]=0,st[11]=0,st[12]=0,st[13]=0,st[14]=0,st[15]=1,this}makeRotationFromQuaternion(_){return this.compose(lm,_,Sv)}lookAt(_,st,at){const lt=this.elements;return Dp.subVectors(_,st),Dp.lengthSq()===0&&(Dp.z=1),Dp.normalize(),Pu.crossVectors(at,Dp),Pu.lengthSq()===0&&(Math.abs(at.z)===1?Dp.x+=1e-4:Dp.z+=1e-4,Dp.normalize(),Pu.crossVectors(at,Dp)),Pu.normalize(),j0.crossVectors(Dp,Pu),lt[0]=Pu.x,lt[4]=j0.x,lt[8]=Dp.x,lt[1]=Pu.y,lt[5]=j0.y,lt[9]=Dp.y,lt[2]=Pu.z,lt[6]=j0.z,lt[10]=Dp.z,this}multiply(_){return this.multiplyMatrices(this,_)}premultiply(_){return this.multiplyMatrices(_,this)}multiplyMatrices(_,st){const at=_.elements,lt=st.elements,ft=this.elements,vt=at[0],At=at[4],Ct=at[8],Tt=at[12],Ot=at[1],Ut=at[5],Lt=at[9],Gt=at[13],Xt=at[2],Qt=at[6],lr=at[10],ur=at[14],cr=at[3],gr=at[7],wr=at[11],Er=at[15],Cr=lt[0],zr=lt[4],Gr=lt[8],on=lt[12],ln=lt[1],Wr=lt[5],Bn=lt[9],Hn=lt[13],Pn=lt[2],es=lt[6],ts=lt[10],bn=lt[14],Sn=lt[3],Kn=lt[7],kn=lt[11],Zn=lt[15];return ft[0]=vt*Cr+At*ln+Ct*Pn+Tt*Sn,ft[4]=vt*zr+At*Wr+Ct*es+Tt*Kn,ft[8]=vt*Gr+At*Bn+Ct*ts+Tt*kn,ft[12]=vt*on+At*Hn+Ct*bn+Tt*Zn,ft[1]=Ot*Cr+Ut*ln+Lt*Pn+Gt*Sn,ft[5]=Ot*zr+Ut*Wr+Lt*es+Gt*Kn,ft[9]=Ot*Gr+Ut*Bn+Lt*ts+Gt*kn,ft[13]=Ot*on+Ut*Hn+Lt*bn+Gt*Zn,ft[2]=Xt*Cr+Qt*ln+lr*Pn+ur*Sn,ft[6]=Xt*zr+Qt*Wr+lr*es+ur*Kn,ft[10]=Xt*Gr+Qt*Bn+lr*ts+ur*kn,ft[14]=Xt*on+Qt*Hn+lr*bn+ur*Zn,ft[3]=cr*Cr+gr*ln+wr*Pn+Er*Sn,ft[7]=cr*zr+gr*Wr+wr*es+Er*Kn,ft[11]=cr*Gr+gr*Bn+wr*ts+Er*kn,ft[15]=cr*on+gr*Hn+wr*bn+Er*Zn,this}multiplyScalar(_){const st=this.elements;return st[0]*=_,st[4]*=_,st[8]*=_,st[12]*=_,st[1]*=_,st[5]*=_,st[9]*=_,st[13]*=_,st[2]*=_,st[6]*=_,st[10]*=_,st[14]*=_,st[3]*=_,st[7]*=_,st[11]*=_,st[15]*=_,this}determinant(){const _=this.elements,st=_[0],at=_[4],lt=_[8],ft=_[12],vt=_[1],At=_[5],Ct=_[9],Tt=_[13],Ot=_[2],Ut=_[6],Lt=_[10],Gt=_[14];return _[3]*(+ft*Ct*Ut-lt*Tt*Ut-ft*At*Lt+at*Tt*Lt+lt*At*Gt-at*Ct*Gt)+_[7]*(+st*Ct*Gt-st*Tt*Lt+ft*vt*Lt-lt*vt*Gt+lt*Tt*Ot-ft*Ct*Ot)+_[11]*(+st*Tt*Ut-st*At*Gt-ft*vt*Ut+at*vt*Gt+ft*At*Ot-at*Tt*Ot)+_[15]*(-lt*At*Ot-st*Ct*Ut+st*At*Lt+lt*vt*Ut-at*vt*Lt+at*Ct*Ot)}transpose(){const _=this.elements;let st;return st=_[1],_[1]=_[4],_[4]=st,st=_[2],_[2]=_[8],_[8]=st,st=_[6],_[6]=_[9],_[9]=st,st=_[3],_[3]=_[12],_[12]=st,st=_[7],_[7]=_[13],_[13]=st,st=_[11],_[11]=_[14],_[14]=st,this}setPosition(_,st,at){const lt=this.elements;return _.isVector3?(lt[12]=_.x,lt[13]=_.y,lt[14]=_.z):(lt[12]=_,lt[13]=st,lt[14]=at),this}invert(){const _=this.elements,st=_[0],at=_[1],lt=_[2],ft=_[3],vt=_[4],At=_[5],Ct=_[6],Tt=_[7],Ot=_[8],Ut=_[9],Lt=_[10],Gt=_[11],Xt=_[12],Qt=_[13],lr=_[14],ur=_[15],cr=Ut*lr*Tt-Qt*Lt*Tt+Qt*Ct*Gt-At*lr*Gt-Ut*Ct*ur+At*Lt*ur,gr=Xt*Lt*Tt-Ot*lr*Tt-Xt*Ct*Gt+vt*lr*Gt+Ot*Ct*ur-vt*Lt*ur,wr=Ot*Qt*Tt-Xt*Ut*Tt+Xt*At*Gt-vt*Qt*Gt-Ot*At*ur+vt*Ut*ur,Er=Xt*Ut*Ct-Ot*Qt*Ct-Xt*At*Lt+vt*Qt*Lt+Ot*At*lr-vt*Ut*lr,Cr=st*cr+at*gr+lt*wr+ft*Er;if(Cr===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const zr=1/Cr;return _[0]=cr*zr,_[1]=(Qt*Lt*ft-Ut*lr*ft-Qt*lt*Gt+at*lr*Gt+Ut*lt*ur-at*Lt*ur)*zr,_[2]=(At*lr*ft-Qt*Ct*ft+Qt*lt*Tt-at*lr*Tt-At*lt*ur+at*Ct*ur)*zr,_[3]=(Ut*Ct*ft-At*Lt*ft-Ut*lt*Tt+at*Lt*Tt+At*lt*Gt-at*Ct*Gt)*zr,_[4]=gr*zr,_[5]=(Ot*lr*ft-Xt*Lt*ft+Xt*lt*Gt-st*lr*Gt-Ot*lt*ur+st*Lt*ur)*zr,_[6]=(Xt*Ct*ft-vt*lr*ft-Xt*lt*Tt+st*lr*Tt+vt*lt*ur-st*Ct*ur)*zr,_[7]=(vt*Lt*ft-Ot*Ct*ft+Ot*lt*Tt-st*Lt*Tt-vt*lt*Gt+st*Ct*Gt)*zr,_[8]=wr*zr,_[9]=(Xt*Ut*ft-Ot*Qt*ft-Xt*at*Gt+st*Qt*Gt+Ot*at*ur-st*Ut*ur)*zr,_[10]=(vt*Qt*ft-Xt*At*ft+Xt*at*Tt-st*Qt*Tt-vt*at*ur+st*At*ur)*zr,_[11]=(Ot*At*ft-vt*Ut*ft-Ot*at*Tt+st*Ut*Tt+vt*at*Gt-st*At*Gt)*zr,_[12]=Er*zr,_[13]=(Ot*Qt*lt-Xt*Ut*lt+Xt*at*Lt-st*Qt*Lt-Ot*at*lr+st*Ut*lr)*zr,_[14]=(Xt*At*lt-vt*Qt*lt-Xt*at*Ct+st*Qt*Ct+vt*at*lr-st*At*lr)*zr,_[15]=(vt*Ut*lt-Ot*At*lt+Ot*at*Ct-st*Ut*Ct-vt*at*Lt+st*At*Lt)*zr,this}scale(_){const st=this.elements,at=_.x,lt=_.y,ft=_.z;return st[0]*=at,st[4]*=lt,st[8]*=ft,st[1]*=at,st[5]*=lt,st[9]*=ft,st[2]*=at,st[6]*=lt,st[10]*=ft,st[3]*=at,st[7]*=lt,st[11]*=ft,this}getMaxScaleOnAxis(){const _=this.elements,st=_[0]*_[0]+_[1]*_[1]+_[2]*_[2],at=_[4]*_[4]+_[5]*_[5]+_[6]*_[6],lt=_[8]*_[8]+_[9]*_[9]+_[10]*_[10];return Math.sqrt(Math.max(st,at,lt))}makeTranslation(_,st,at){return this.set(1,0,0,_,0,1,0,st,0,0,1,at,0,0,0,1),this}makeRotationX(_){const st=Math.cos(_),at=Math.sin(_);return this.set(1,0,0,0,0,st,-at,0,0,at,st,0,0,0,0,1),this}makeRotationY(_){const st=Math.cos(_),at=Math.sin(_);return this.set(st,0,at,0,0,1,0,0,-at,0,st,0,0,0,0,1),this}makeRotationZ(_){const st=Math.cos(_),at=Math.sin(_);return this.set(st,-at,0,0,at,st,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(_,st){const at=Math.cos(st),lt=Math.sin(st),ft=1-at,vt=_.x,At=_.y,Ct=_.z,Tt=ft*vt,Ot=ft*At;return this.set(Tt*vt+at,Tt*At-lt*Ct,Tt*Ct+lt*At,0,Tt*At+lt*Ct,Ot*At+at,Ot*Ct-lt*vt,0,Tt*Ct-lt*At,Ot*Ct+lt*vt,ft*Ct*Ct+at,0,0,0,0,1),this}makeScale(_,st,at){return this.set(_,0,0,0,0,st,0,0,0,0,at,0,0,0,0,1),this}makeShear(_,st,at,lt,ft,vt){return this.set(1,at,ft,0,_,1,vt,0,st,lt,1,0,0,0,0,1),this}compose(_,st,at){const lt=this.elements,ft=st._x,vt=st._y,At=st._z,Ct=st._w,Tt=ft+ft,Ot=vt+vt,Ut=At+At,Lt=ft*Tt,Gt=ft*Ot,Xt=ft*Ut,Qt=vt*Ot,lr=vt*Ut,ur=At*Ut,cr=Ct*Tt,gr=Ct*Ot,wr=Ct*Ut,Er=at.x,Cr=at.y,zr=at.z;return lt[0]=(1-(Qt+ur))*Er,lt[1]=(Gt+wr)*Er,lt[2]=(Xt-gr)*Er,lt[3]=0,lt[4]=(Gt-wr)*Cr,lt[5]=(1-(Lt+ur))*Cr,lt[6]=(lr+cr)*Cr,lt[7]=0,lt[8]=(Xt+gr)*zr,lt[9]=(lr-cr)*zr,lt[10]=(1-(Lt+Qt))*zr,lt[11]=0,lt[12]=_.x,lt[13]=_.y,lt[14]=_.z,lt[15]=1,this}decompose(_,st,at){const lt=this.elements;let ft=$a.set(lt[0],lt[1],lt[2]).length();const vt=$a.set(lt[4],lt[5],lt[6]).length(),At=$a.set(lt[8],lt[9],lt[10]).length();this.determinant()<0&&(ft=-ft),_.x=lt[12],_.y=lt[13],_.z=lt[14],Iu.copy(this);const Ct=1/ft,Tt=1/vt,Ot=1/At;return Iu.elements[0]*=Ct,Iu.elements[1]*=Ct,Iu.elements[2]*=Ct,Iu.elements[4]*=Tt,Iu.elements[5]*=Tt,Iu.elements[6]*=Tt,Iu.elements[8]*=Ot,Iu.elements[9]*=Ot,Iu.elements[10]*=Ot,st.setFromRotationMatrix(Iu),at.x=ft,at.y=vt,at.z=At,this}makePerspective(_,st,at,lt,ft,vt){const At=this.elements,Ct=2*ft/(st-_),Tt=2*ft/(at-lt),Ot=(st+_)/(st-_),Ut=(at+lt)/(at-lt),Lt=-(vt+ft)/(vt-ft),Gt=-2*vt*ft/(vt-ft);return At[0]=Ct,At[4]=0,At[8]=Ot,At[12]=0,At[1]=0,At[5]=Tt,At[9]=Ut,At[13]=0,At[2]=0,At[6]=0,At[10]=Lt,At[14]=Gt,At[3]=0,At[7]=0,At[11]=-1,At[15]=0,this}makeOrthographic(_,st,at,lt,ft,vt){const At=this.elements,Ct=1/(st-_),Tt=1/(at-lt),Ot=1/(vt-ft),Ut=(st+_)*Ct,Lt=(at+lt)*Tt,Gt=(vt+ft)*Ot;return At[0]=2*Ct,At[4]=0,At[8]=0,At[12]=-Ut,At[1]=0,At[5]=2*Tt,At[9]=0,At[13]=-Lt,At[2]=0,At[6]=0,At[10]=-2*Ot,At[14]=-Gt,At[3]=0,At[7]=0,At[11]=0,At[15]=1,this}equals(_){const st=this.elements,at=_.elements;for(let lt=0;lt<16;lt++)if(st[lt]!==at[lt])return!1;return!0}fromArray(_,st=0){for(let at=0;at<16;at++)this.elements[at]=_[at+st];return this}toArray(_=[],st=0){const at=this.elements;return _[st]=at[0],_[st+1]=at[1],_[st+2]=at[2],_[st+3]=at[3],_[st+4]=at[4],_[st+5]=at[5],_[st+6]=at[6],_[st+7]=at[7],_[st+8]=at[8],_[st+9]=at[9],_[st+10]=at[10],_[st+11]=at[11],_[st+12]=at[12],_[st+13]=at[13],_[st+14]=at[14],_[st+15]=at[15],_}}const $a=new Mr,Iu=new Ys,lm=new Mr(0,0,0),Sv=new Mr(1,1,1),Pu=new Mr,j0=new Mr,Dp=new Mr,Gw=new Ys,$y=new zu;class Rm{constructor(_=0,st=0,at=0,lt=Rm.DefaultOrder){this.isEuler=!0,this._x=_,this._y=st,this._z=at,this._order=lt}get x(){return this._x}set x(_){this._x=_,this._onChangeCallback()}get y(){return this._y}set y(_){this._y=_,this._onChangeCallback()}get z(){return this._z}set z(_){this._z=_,this._onChangeCallback()}get order(){return this._order}set order(_){this._order=_,this._onChangeCallback()}set(_,st,at,lt=this._order){return this._x=_,this._y=st,this._z=at,this._order=lt,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(_){return this._x=_._x,this._y=_._y,this._z=_._z,this._order=_._order,this._onChangeCallback(),this}setFromRotationMatrix(_,st=this._order,at=!0){const lt=_.elements,ft=lt[0],vt=lt[4],At=lt[8],Ct=lt[1],Tt=lt[5],Ot=lt[9],Ut=lt[2],Lt=lt[6],Gt=lt[10];switch(st){case"XYZ":this._y=Math.asin(Ls(At,-1,1)),Math.abs(At)<.9999999?(this._x=Math.atan2(-Ot,Gt),this._z=Math.atan2(-vt,ft)):(this._x=Math.atan2(Lt,Tt),this._z=0);break;case"YXZ":this._x=Math.asin(-Ls(Ot,-1,1)),Math.abs(Ot)<.9999999?(this._y=Math.atan2(At,Gt),this._z=Math.atan2(Ct,Tt)):(this._y=Math.atan2(-Ut,ft),this._z=0);break;case"ZXY":this._x=Math.asin(Ls(Lt,-1,1)),Math.abs(Lt)<.9999999?(this._y=Math.atan2(-Ut,Gt),this._z=Math.atan2(-vt,Tt)):(this._y=0,this._z=Math.atan2(Ct,ft));break;case"ZYX":this._y=Math.asin(-Ls(Ut,-1,1)),Math.abs(Ut)<.9999999?(this._x=Math.atan2(Lt,Gt),this._z=Math.atan2(Ct,ft)):(this._x=0,this._z=Math.atan2(-vt,Tt));break;case"YZX":this._z=Math.asin(Ls(Ct,-1,1)),Math.abs(Ct)<.9999999?(this._x=Math.atan2(-Ot,Tt),this._y=Math.atan2(-Ut,ft)):(this._x=0,this._y=Math.atan2(At,Gt));break;case"XZY":this._z=Math.asin(-Ls(vt,-1,1)),Math.abs(vt)<.9999999?(this._x=Math.atan2(Lt,Tt),this._y=Math.atan2(At,ft)):(this._x=Math.atan2(-Ot,Gt),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+st)}return this._order=st,at===!0&&this._onChangeCallback(),this}setFromQuaternion(_,st,at){return Gw.makeRotationFromQuaternion(_),this.setFromRotationMatrix(Gw,st,at)}setFromVector3(_,st=this._order){return this.set(_.x,_.y,_.z,st)}reorder(_){return $y.setFromEuler(this),this.setFromQuaternion($y,_)}equals(_){return _._x===this._x&&_._y===this._y&&_._z===this._z&&_._order===this._order}fromArray(_){return this._x=_[0],this._y=_[1],this._z=_[2],_[3]!==void 0&&(this._order=_[3]),this._onChangeCallback(),this}toArray(_=[],st=0){return _[st]=this._x,_[st+1]=this._y,_[st+2]=this._z,_[st+3]=this._order,_}_onChange(_){return this._onChangeCallback=_,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}Rm.DefaultOrder="XYZ",Rm.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class mp{constructor(){this.mask=1}set(_){this.mask=(1<<_|0)>>>0}enable(_){this.mask|=1<<_|0}enableAll(){this.mask=-1}toggle(_){this.mask^=1<<_|0}disable(_){this.mask&=~(1<<_|0)}disableAll(){this.mask=0}test(_){return(this.mask&_.mask)!=0}isEnabled(_){return(this.mask&(1<<_|0))!=0}}let Cv=0;const W_=new Mr,Vu=new zu,Vp=new Ys,ip=new Mr,Km=new Mr,jA=new Mr,o_=new zu,jy=new Mr(1,0,0),Y_=new Mr(0,1,0),a_=new Mr(0,0,1),zA={type:"added"},Qw={type:"removed"};class ao extends Ws{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Cv++}),this.uuid=rp(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ao.DefaultUp.clone();const _=new Mr,st=new Rm,at=new zu,lt=new Mr(1,1,1);st._onChange(function(){at.setFromEuler(st,!1)}),at._onChange(function(){st.setFromQuaternion(at,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:_},rotation:{configurable:!0,enumerable:!0,value:st},quaternion:{configurable:!0,enumerable:!0,value:at},scale:{configurable:!0,enumerable:!0,value:lt},modelViewMatrix:{value:new Ys},normalMatrix:{value:new ju}}),this.matrix=new Ys,this.matrixWorld=new Ys,this.matrixAutoUpdate=ao.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=ao.DefaultMatrixWorldAutoUpdate,this.layers=new mp,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(_,st,at,lt,ft,vt){this.dispatchEvent({type:"beforeRender",renderer:_,scene:st,camera:at,geometry:lt,material:ft,group:vt})}onAfterRender(){}applyMatrix4(_){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(_),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(_){return this.quaternion.premultiply(_),this}setRotationFromAxisAngle(_,st){this.quaternion.setFromAxisAngle(_,st)}setRotationFromEuler(_){this.quaternion.setFromEuler(_,!0)}setRotationFromMatrix(_){this.quaternion.setFromRotationMatrix(_)}setRotationFromQuaternion(_){this.quaternion.copy(_)}rotateOnAxis(_,st){return Vu.setFromAxisAngle(_,st),this.quaternion.multiply(Vu),this}rotateOnWorldAxis(_,st){return Vu.setFromAxisAngle(_,st),this.quaternion.premultiply(Vu),this}rotateX(_){return this.rotateOnAxis(jy,_)}rotateY(_){return this.rotateOnAxis(Y_,_)}rotateZ(_){return this.rotateOnAxis(a_,_)}translateOnAxis(_,st){return W_.copy(_).applyQuaternion(this.quaternion),this.position.add(W_.multiplyScalar(st)),this}translateX(_){return this.translateOnAxis(jy,_)}translateY(_){return this.translateOnAxis(Y_,_)}translateZ(_){return this.translateOnAxis(a_,_)}localToWorld(_){return _.applyMatrix4(this.matrixWorld)}worldToLocal(_){return _.applyMatrix4(Vp.copy(this.matrixWorld).invert())}lookAt(_,st,at){_.isVector3?ip.copy(_):ip.set(_,st,at);const lt=this.parent;this.updateWorldMatrix(!0,!1),Km.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Vp.lookAt(Km,ip,this.up):Vp.lookAt(ip,Km,this.up),this.quaternion.setFromRotationMatrix(Vp),lt&&(Vp.extractRotation(lt.matrixWorld),Vu.setFromRotationMatrix(Vp),this.quaternion.premultiply(Vu.invert()))}add(_){if(arguments.length>1){for(let st=0;st<arguments.length;st++)this.add(arguments[st]);return this}return _===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",_),this):(_&&_.isObject3D?(_.parent!==null&&_.parent.remove(_),_.parent=this,this.children.push(_),_.dispatchEvent(zA)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",_),this)}remove(_){if(arguments.length>1){for(let at=0;at<arguments.length;at++)this.remove(arguments[at]);return this}const st=this.children.indexOf(_);return st!==-1&&(_.parent=null,this.children.splice(st,1),_.dispatchEvent(Qw)),this}removeFromParent(){const _=this.parent;return _!==null&&_.remove(this),this}clear(){for(let _=0;_<this.children.length;_++){const st=this.children[_];st.parent=null,st.dispatchEvent(Qw)}return this.children.length=0,this}attach(_){return this.updateWorldMatrix(!0,!1),Vp.copy(this.matrixWorld).invert(),_.parent!==null&&(_.parent.updateWorldMatrix(!0,!1),Vp.multiply(_.parent.matrixWorld)),_.applyMatrix4(Vp),this.add(_),_.updateWorldMatrix(!1,!0),this}getObjectById(_){return this.getObjectByProperty("id",_)}getObjectByName(_){return this.getObjectByProperty("name",_)}getObjectByProperty(_,st){if(this[_]===st)return this;for(let at=0,lt=this.children.length;at<lt;at++){const ft=this.children[at].getObjectByProperty(_,st);if(ft!==void 0)return ft}}getWorldPosition(_){return this.updateWorldMatrix(!0,!1),_.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(_){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Km,_,jA),_}getWorldScale(_){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Km,o_,_),_}getWorldDirection(_){this.updateWorldMatrix(!0,!1);const st=this.matrixWorld.elements;return _.set(st[8],st[9],st[10]).normalize()}raycast(){}traverse(_){_(this);const st=this.children;for(let at=0,lt=st.length;at<lt;at++)st[at].traverse(_)}traverseVisible(_){if(this.visible===!1)return;_(this);const st=this.children;for(let at=0,lt=st.length;at<lt;at++)st[at].traverseVisible(_)}traverseAncestors(_){const st=this.parent;st!==null&&(_(st),st.traverseAncestors(_))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(_){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||_)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,_=!0);const st=this.children;for(let at=0,lt=st.length;at<lt;at++){const ft=st[at];ft.matrixWorldAutoUpdate!==!0&&_!==!0||ft.updateMatrixWorld(_)}}updateWorldMatrix(_,st){const at=this.parent;if(_===!0&&at!==null&&at.matrixWorldAutoUpdate===!0&&at.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),st===!0){const lt=this.children;for(let ft=0,vt=lt.length;ft<vt;ft++){const At=lt[ft];At.matrixWorldAutoUpdate===!0&&At.updateWorldMatrix(!1,!0)}}}toJSON(_){const st=_===void 0||typeof _=="string",at={};st&&(_={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},at.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const lt={};function ft(At,Ct){return At[Ct.uuid]===void 0&&(At[Ct.uuid]=Ct.toJSON(_)),Ct.uuid}if(lt.uuid=this.uuid,lt.type=this.type,this.name!==""&&(lt.name=this.name),this.castShadow===!0&&(lt.castShadow=!0),this.receiveShadow===!0&&(lt.receiveShadow=!0),this.visible===!1&&(lt.visible=!1),this.frustumCulled===!1&&(lt.frustumCulled=!1),this.renderOrder!==0&&(lt.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(lt.userData=this.userData),lt.layers=this.layers.mask,lt.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(lt.matrixAutoUpdate=!1),this.isInstancedMesh&&(lt.type="InstancedMesh",lt.count=this.count,lt.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(lt.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?lt.background=this.background.toJSON():this.background.isTexture&&(lt.background=this.background.toJSON(_).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(lt.environment=this.environment.toJSON(_).uuid);else if(this.isMesh||this.isLine||this.isPoints){lt.geometry=ft(_.geometries,this.geometry);const At=this.geometry.parameters;if(At!==void 0&&At.shapes!==void 0){const Ct=At.shapes;if(Array.isArray(Ct))for(let Tt=0,Ot=Ct.length;Tt<Ot;Tt++){const Ut=Ct[Tt];ft(_.shapes,Ut)}else ft(_.shapes,Ct)}}if(this.isSkinnedMesh&&(lt.bindMode=this.bindMode,lt.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(ft(_.skeletons,this.skeleton),lt.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const At=[];for(let Ct=0,Tt=this.material.length;Ct<Tt;Ct++)At.push(ft(_.materials,this.material[Ct]));lt.material=At}else lt.material=ft(_.materials,this.material);if(this.children.length>0){lt.children=[];for(let At=0;At<this.children.length;At++)lt.children.push(this.children[At].toJSON(_).object)}if(this.animations.length>0){lt.animations=[];for(let At=0;At<this.animations.length;At++){const Ct=this.animations[At];lt.animations.push(ft(_.animations,Ct))}}if(st){const At=vt(_.geometries),Ct=vt(_.materials),Tt=vt(_.textures),Ot=vt(_.images),Ut=vt(_.shapes),Lt=vt(_.skeletons),Gt=vt(_.animations),Xt=vt(_.nodes);At.length>0&&(at.geometries=At),Ct.length>0&&(at.materials=Ct),Tt.length>0&&(at.textures=Tt),Ot.length>0&&(at.images=Ot),Ut.length>0&&(at.shapes=Ut),Lt.length>0&&(at.skeletons=Lt),Gt.length>0&&(at.animations=Gt),Xt.length>0&&(at.nodes=Xt)}return at.object=lt,at;function vt(At){const Ct=[];for(const Tt in At){const Ot=At[Tt];delete Ot.metadata,Ct.push(Ot)}return Ct}}clone(_){return new this.constructor().copy(this,_)}copy(_,st=!0){this.name=_.name,this.up.copy(_.up),this.position.copy(_.position),this.rotation.order=_.rotation.order,this.quaternion.copy(_.quaternion),this.scale.copy(_.scale),this.matrix.copy(_.matrix),this.matrixWorld.copy(_.matrixWorld),this.matrixAutoUpdate=_.matrixAutoUpdate,this.matrixWorldNeedsUpdate=_.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=_.matrixWorldAutoUpdate,this.layers.mask=_.layers.mask,this.visible=_.visible,this.castShadow=_.castShadow,this.receiveShadow=_.receiveShadow,this.frustumCulled=_.frustumCulled,this.renderOrder=_.renderOrder,this.userData={};for(const[at,lt]of Object.entries(_.userData))this.userData[at]=!lt||lt&&(lt.isTexture||lt.isObject3D)?lt:JSON.parse(JSON.stringify(lt));if(st===!0)for(let at=0;at<_.children.length;at++){const lt=_.children[at];this.add(lt.clone())}return this}}ao.DefaultUp=new Mr(0,1,0),ao.DefaultMatrixAutoUpdate=!0,ao.DefaultMatrixWorldAutoUpdate=!0;const um=new Mr,Xm=new Mr,gp=new Mr,Im=new Mr,cm=new Mr,dm=new Mr,VA=new Mr,z0=new Mr,GA=new Mr,l_=new Mr;class Gu{constructor(_=new Mr,st=new Mr,at=new Mr){this.a=_,this.b=st,this.c=at}static getNormal(_,st,at,lt){lt.subVectors(at,st),um.subVectors(_,st),lt.cross(um);const ft=lt.lengthSq();return ft>0?lt.multiplyScalar(1/Math.sqrt(ft)):lt.set(0,0,0)}static getBarycoord(_,st,at,lt,ft){um.subVectors(lt,st),Xm.subVectors(at,st),gp.subVectors(_,st);const vt=um.dot(um),At=um.dot(Xm),Ct=um.dot(gp),Tt=Xm.dot(Xm),Ot=Xm.dot(gp),Ut=vt*Tt-At*At;if(Ut===0)return ft.set(-2,-1,-1);const Lt=1/Ut,Gt=(Tt*Ct-At*Ot)*Lt,Xt=(vt*Ot-At*Ct)*Lt;return ft.set(1-Gt-Xt,Xt,Gt)}static containsPoint(_,st,at,lt){return this.getBarycoord(_,st,at,lt,Im),Im.x>=0&&Im.y>=0&&Im.x+Im.y<=1}static getUV(_,st,at,lt,ft,vt,At,Ct){return this.getBarycoord(_,st,at,lt,Im),Ct.set(0,0),Ct.addScaledVector(ft,Im.x),Ct.addScaledVector(vt,Im.y),Ct.addScaledVector(At,Im.z),Ct}static isFrontFacing(_,st,at,lt){return um.subVectors(at,st),Xm.subVectors(_,st),um.cross(Xm).dot(lt)<0}set(_,st,at){return this.a.copy(_),this.b.copy(st),this.c.copy(at),this}setFromPointsAndIndices(_,st,at,lt){return this.a.copy(_[st]),this.b.copy(_[at]),this.c.copy(_[lt]),this}setFromAttributeAndIndices(_,st,at,lt){return this.a.fromBufferAttribute(_,st),this.b.fromBufferAttribute(_,at),this.c.fromBufferAttribute(_,lt),this}clone(){return new this.constructor().copy(this)}copy(_){return this.a.copy(_.a),this.b.copy(_.b),this.c.copy(_.c),this}getArea(){return um.subVectors(this.c,this.b),Xm.subVectors(this.a,this.b),.5*um.cross(Xm).length()}getMidpoint(_){return _.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(_){return Gu.getNormal(this.a,this.b,this.c,_)}getPlane(_){return _.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(_,st){return Gu.getBarycoord(_,this.a,this.b,this.c,st)}getUV(_,st,at,lt,ft){return Gu.getUV(_,this.a,this.b,this.c,st,at,lt,ft)}containsPoint(_){return Gu.containsPoint(_,this.a,this.b,this.c)}isFrontFacing(_){return Gu.isFrontFacing(this.a,this.b,this.c,_)}intersectsBox(_){return _.intersectsTriangle(this)}closestPointToPoint(_,st){const at=this.a,lt=this.b,ft=this.c;let vt,At;cm.subVectors(lt,at),dm.subVectors(ft,at),z0.subVectors(_,at);const Ct=cm.dot(z0),Tt=dm.dot(z0);if(Ct<=0&&Tt<=0)return st.copy(at);GA.subVectors(_,lt);const Ot=cm.dot(GA),Ut=dm.dot(GA);if(Ot>=0&&Ut<=Ot)return st.copy(lt);const Lt=Ct*Ut-Ot*Tt;if(Lt<=0&&Ct>=0&&Ot<=0)return vt=Ct/(Ct-Ot),st.copy(at).addScaledVector(cm,vt);l_.subVectors(_,ft);const Gt=cm.dot(l_),Xt=dm.dot(l_);if(Xt>=0&&Gt<=Xt)return st.copy(ft);const Qt=Gt*Tt-Ct*Xt;if(Qt<=0&&Tt>=0&&Xt<=0)return At=Tt/(Tt-Xt),st.copy(at).addScaledVector(dm,At);const lr=Ot*Xt-Gt*Ut;if(lr<=0&&Ut-Ot>=0&&Gt-Xt>=0)return VA.subVectors(ft,lt),At=(Ut-Ot)/(Ut-Ot+(Gt-Xt)),st.copy(lt).addScaledVector(VA,At);const ur=1/(lr+Qt+Lt);return vt=Qt*ur,At=Lt*ur,st.copy(at).addScaledVector(cm,vt).addScaledVector(dm,At)}equals(_){return _.a.equals(this.a)&&_.b.equals(this.b)&&_.c.equals(this.c)}}let Dx=0;class Qu extends Ws{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Dx++}),this.uuid=rp(),this.name="",this.type="Material",this.blending=Ht,this.side=rr,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=tn,this.blendDst=Tn,this.blendEquation=Wt,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Ar,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=qm,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=na,this.stencilZFail=na,this.stencilZPass=na,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(_){this._alphaTest>0!=_>0&&this.version++,this._alphaTest=_}onBuild(){}onBeforeRender(){}onAfterRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(_){if(_!==void 0)for(const st in _){const at=_[st];if(at===void 0){console.warn("THREE.Material: '"+st+"' parameter is undefined.");continue}const lt=this[st];lt!==void 0&&(lt&&lt.isColor?lt.set(at):lt&&lt.isVector3&&at&&at.isVector3?lt.copy(at):this[st]=at)}}toJSON(_){const st=_===void 0||typeof _=="string";st&&(_={textures:{},images:{}});const at={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function lt(ft){const vt=[];for(const At in ft){const Ct=ft[At];delete Ct.metadata,vt.push(Ct)}return vt}if(at.uuid=this.uuid,at.type=this.type,this.name!==""&&(at.name=this.name),this.color&&this.color.isColor&&(at.color=this.color.getHex()),this.roughness!==void 0&&(at.roughness=this.roughness),this.metalness!==void 0&&(at.metalness=this.metalness),this.sheen!==void 0&&(at.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(at.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(at.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(at.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(at.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(at.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(at.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(at.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(at.shininess=this.shininess),this.clearcoat!==void 0&&(at.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(at.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(at.clearcoatMap=this.clearcoatMap.toJSON(_).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(at.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(_).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(at.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(_).uuid,at.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(at.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(at.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(at.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(at.iridescenceMap=this.iridescenceMap.toJSON(_).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(at.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(_).uuid),this.map&&this.map.isTexture&&(at.map=this.map.toJSON(_).uuid),this.matcap&&this.matcap.isTexture&&(at.matcap=this.matcap.toJSON(_).uuid),this.alphaMap&&this.alphaMap.isTexture&&(at.alphaMap=this.alphaMap.toJSON(_).uuid),this.lightMap&&this.lightMap.isTexture&&(at.lightMap=this.lightMap.toJSON(_).uuid,at.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(at.aoMap=this.aoMap.toJSON(_).uuid,at.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(at.bumpMap=this.bumpMap.toJSON(_).uuid,at.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(at.normalMap=this.normalMap.toJSON(_).uuid,at.normalMapType=this.normalMapType,at.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(at.displacementMap=this.displacementMap.toJSON(_).uuid,at.displacementScale=this.displacementScale,at.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(at.roughnessMap=this.roughnessMap.toJSON(_).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(at.metalnessMap=this.metalnessMap.toJSON(_).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(at.emissiveMap=this.emissiveMap.toJSON(_).uuid),this.specularMap&&this.specularMap.isTexture&&(at.specularMap=this.specularMap.toJSON(_).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(at.specularIntensityMap=this.specularIntensityMap.toJSON(_).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(at.specularColorMap=this.specularColorMap.toJSON(_).uuid),this.envMap&&this.envMap.isTexture&&(at.envMap=this.envMap.toJSON(_).uuid,this.combine!==void 0&&(at.combine=this.combine)),this.envMapIntensity!==void 0&&(at.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(at.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(at.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(at.gradientMap=this.gradientMap.toJSON(_).uuid),this.transmission!==void 0&&(at.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(at.transmissionMap=this.transmissionMap.toJSON(_).uuid),this.thickness!==void 0&&(at.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(at.thicknessMap=this.thicknessMap.toJSON(_).uuid),this.attenuationDistance!==void 0&&(at.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(at.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(at.size=this.size),this.shadowSide!==null&&(at.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(at.sizeAttenuation=this.sizeAttenuation),this.blending!==Ht&&(at.blending=this.blending),this.side!==rr&&(at.side=this.side),this.vertexColors&&(at.vertexColors=!0),this.opacity<1&&(at.opacity=this.opacity),this.transparent===!0&&(at.transparent=this.transparent),at.depthFunc=this.depthFunc,at.depthTest=this.depthTest,at.depthWrite=this.depthWrite,at.colorWrite=this.colorWrite,at.stencilWrite=this.stencilWrite,at.stencilWriteMask=this.stencilWriteMask,at.stencilFunc=this.stencilFunc,at.stencilRef=this.stencilRef,at.stencilFuncMask=this.stencilFuncMask,at.stencilFail=this.stencilFail,at.stencilZFail=this.stencilZFail,at.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(at.rotation=this.rotation),this.polygonOffset===!0&&(at.polygonOffset=!0),this.polygonOffsetFactor!==0&&(at.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(at.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(at.linewidth=this.linewidth),this.dashSize!==void 0&&(at.dashSize=this.dashSize),this.gapSize!==void 0&&(at.gapSize=this.gapSize),this.scale!==void 0&&(at.scale=this.scale),this.dithering===!0&&(at.dithering=!0),this.alphaTest>0&&(at.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(at.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(at.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(at.wireframe=this.wireframe),this.wireframeLinewidth>1&&(at.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(at.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(at.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(at.flatShading=this.flatShading),this.visible===!1&&(at.visible=!1),this.toneMapped===!1&&(at.toneMapped=!1),this.fog===!1&&(at.fog=!1),JSON.stringify(this.userData)!=="{}"&&(at.userData=this.userData),st){const ft=lt(_.textures),vt=lt(_.images);ft.length>0&&(at.textures=ft),vt.length>0&&(at.images=vt)}return at}clone(){return new this.constructor().copy(this)}copy(_){this.name=_.name,this.blending=_.blending,this.side=_.side,this.vertexColors=_.vertexColors,this.opacity=_.opacity,this.transparent=_.transparent,this.blendSrc=_.blendSrc,this.blendDst=_.blendDst,this.blendEquation=_.blendEquation,this.blendSrcAlpha=_.blendSrcAlpha,this.blendDstAlpha=_.blendDstAlpha,this.blendEquationAlpha=_.blendEquationAlpha,this.depthFunc=_.depthFunc,this.depthTest=_.depthTest,this.depthWrite=_.depthWrite,this.stencilWriteMask=_.stencilWriteMask,this.stencilFunc=_.stencilFunc,this.stencilRef=_.stencilRef,this.stencilFuncMask=_.stencilFuncMask,this.stencilFail=_.stencilFail,this.stencilZFail=_.stencilZFail,this.stencilZPass=_.stencilZPass,this.stencilWrite=_.stencilWrite;const st=_.clippingPlanes;let at=null;if(st!==null){const lt=st.length;at=new Array(lt);for(let ft=0;ft!==lt;++ft)at[ft]=st[ft].clone()}this.clippingPlanes=at,this.clipIntersection=_.clipIntersection,this.clipShadows=_.clipShadows,this.shadowSide=_.shadowSide,this.colorWrite=_.colorWrite,this.precision=_.precision,this.polygonOffset=_.polygonOffset,this.polygonOffsetFactor=_.polygonOffsetFactor,this.polygonOffsetUnits=_.polygonOffsetUnits,this.dithering=_.dithering,this.alphaTest=_.alphaTest,this.alphaToCoverage=_.alphaToCoverage,this.premultipliedAlpha=_.premultipliedAlpha,this.visible=_.visible,this.toneMapped=_.toneMapped,this.userData={};for(const[lt,ft]of Object.entries(_.userData))this.userData[lt]=!ft||ft&&(ft.isTexture||ft.isObject3D)?ft:JSON.parse(JSON.stringify(ft));return this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(_){_===!0&&this.version++}}class Jm extends Qu{constructor(_){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ms(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=As,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.fog=_.fog,this}}const au=new Mr,pm=new Vn;class El{constructor(_,st,at){if(Array.isArray(_))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=_,this.itemSize=st,this.count=_!==void 0?_.length/st:0,this.normalized=at===!0,this.usage=F_,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(_){_===!0&&this.version++}setUsage(_){return this.usage=_,this}copy(_){return this.name=_.name,this.array=new _.array.constructor(_.array),this.itemSize=_.itemSize,this.count=_.count,this.normalized=_.normalized,this.usage=_.usage,this}copyAt(_,st,at){_*=this.itemSize,at*=st.itemSize;for(let lt=0,ft=this.itemSize;lt<ft;lt++)this.array[_+lt]=st.array[at+lt];return this}copyArray(_){return this.array.set(_),this}applyMatrix3(_){if(this.itemSize===2)for(let st=0,at=this.count;st<at;st++)pm.fromBufferAttribute(this,st),pm.applyMatrix3(_),this.setXY(st,pm.x,pm.y);else if(this.itemSize===3)for(let st=0,at=this.count;st<at;st++)au.fromBufferAttribute(this,st),au.applyMatrix3(_),this.setXYZ(st,au.x,au.y,au.z);return this}applyMatrix4(_){for(let st=0,at=this.count;st<at;st++)au.fromBufferAttribute(this,st),au.applyMatrix4(_),this.setXYZ(st,au.x,au.y,au.z);return this}applyNormalMatrix(_){for(let st=0,at=this.count;st<at;st++)au.fromBufferAttribute(this,st),au.applyNormalMatrix(_),this.setXYZ(st,au.x,au.y,au.z);return this}transformDirection(_){for(let st=0,at=this.count;st<at;st++)au.fromBufferAttribute(this,st),au.transformDirection(_),this.setXYZ(st,au.x,au.y,au.z);return this}set(_,st=0){return this.array.set(_,st),this}getX(_){let st=this.array[_*this.itemSize];return this.normalized&&(st=bv(st,this.array)),st}setX(_,st){return this.normalized&&(st=Tl(st,this.array)),this.array[_*this.itemSize]=st,this}getY(_){let st=this.array[_*this.itemSize+1];return this.normalized&&(st=bv(st,this.array)),st}setY(_,st){return this.normalized&&(st=Tl(st,this.array)),this.array[_*this.itemSize+1]=st,this}getZ(_){let st=this.array[_*this.itemSize+2];return this.normalized&&(st=bv(st,this.array)),st}setZ(_,st){return this.normalized&&(st=Tl(st,this.array)),this.array[_*this.itemSize+2]=st,this}getW(_){let st=this.array[_*this.itemSize+3];return this.normalized&&(st=bv(st,this.array)),st}setW(_,st){return this.normalized&&(st=Tl(st,this.array)),this.array[_*this.itemSize+3]=st,this}setXY(_,st,at){return _*=this.itemSize,this.normalized&&(st=Tl(st,this.array),at=Tl(at,this.array)),this.array[_+0]=st,this.array[_+1]=at,this}setXYZ(_,st,at,lt){return _*=this.itemSize,this.normalized&&(st=Tl(st,this.array),at=Tl(at,this.array),lt=Tl(lt,this.array)),this.array[_+0]=st,this.array[_+1]=at,this.array[_+2]=lt,this}setXYZW(_,st,at,lt,ft){return _*=this.itemSize,this.normalized&&(st=Tl(st,this.array),at=Tl(at,this.array),lt=Tl(lt,this.array),ft=Tl(ft,this.array)),this.array[_+0]=st,this.array[_+1]=at,this.array[_+2]=lt,this.array[_+3]=ft,this}onUpload(_){return this.onUploadCallback=_,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const _={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(_.name=this.name),this.usage!==F_&&(_.usage=this.usage),this.updateRange.offset===0&&this.updateRange.count===-1||(_.updateRange=this.updateRange),_}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class V0 extends El{constructor(_,st,at){super(new Int8Array(_),st,at)}}class hm extends El{constructor(_,st,at){super(new Uint8Array(_),st,at)}}class G0 extends El{constructor(_,st,at){super(new Uint8ClampedArray(_),st,at)}}class vp extends El{constructor(_,st,at){super(new Int16Array(_),st,at)}}class Xl extends El{constructor(_,st,at){super(new Uint16Array(_),st,at)}}class Hw extends El{constructor(_,st,at){super(new Int32Array(_),st,at)}}class Dt extends El{constructor(_,st,at){super(new Uint32Array(_),st,at)}}class gt extends El{constructor(_,st,at){super(new Uint16Array(_),st,at),this.isFloat16BufferAttribute=!0}}class xt extends El{constructor(_,st,at){super(new Float32Array(_),st,at)}}class $t extends El{constructor(_,st,at){super(new Float64Array(_),st,at)}}let hr=0;const Pr=new Ys,$r=new ao,An=new Mr,zn=new Q_,Ms=new Q_,Us=new Mr;class xs extends Ws{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:hr++}),this.uuid=rp(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(_){return Array.isArray(_)?this.index=new(Ix(_)?Dt:Xl)(_,1):this.index=_,this}getAttribute(_){return this.attributes[_]}setAttribute(_,st){return this.attributes[_]=st,this}deleteAttribute(_){return delete this.attributes[_],this}hasAttribute(_){return this.attributes[_]!==void 0}addGroup(_,st,at=0){this.groups.push({start:_,count:st,materialIndex:at})}clearGroups(){this.groups=[]}setDrawRange(_,st){this.drawRange.start=_,this.drawRange.count=st}applyMatrix4(_){const st=this.attributes.position;st!==void 0&&(st.applyMatrix4(_),st.needsUpdate=!0);const at=this.attributes.normal;if(at!==void 0){const ft=new ju().getNormalMatrix(_);at.applyNormalMatrix(ft),at.needsUpdate=!0}const lt=this.attributes.tangent;return lt!==void 0&&(lt.transformDirection(_),lt.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(_){return Pr.makeRotationFromQuaternion(_),this.applyMatrix4(Pr),this}rotateX(_){return Pr.makeRotationX(_),this.applyMatrix4(Pr),this}rotateY(_){return Pr.makeRotationY(_),this.applyMatrix4(Pr),this}rotateZ(_){return Pr.makeRotationZ(_),this.applyMatrix4(Pr),this}translate(_,st,at){return Pr.makeTranslation(_,st,at),this.applyMatrix4(Pr),this}scale(_,st,at){return Pr.makeScale(_,st,at),this.applyMatrix4(Pr),this}lookAt(_){return $r.lookAt(_),$r.updateMatrix(),this.applyMatrix4($r.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(An).negate(),this.translate(An.x,An.y,An.z),this}setFromPoints(_){const st=[];for(let at=0,lt=_.length;at<lt;at++){const ft=_[at];st.push(ft.x,ft.y,ft.z||0)}return this.setAttribute("position",new xt(st,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Q_);const _=this.attributes.position,st=this.morphAttributes.position;if(_&&_.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Mr(-1/0,-1/0,-1/0),new Mr(1/0,1/0,1/0));if(_!==void 0){if(this.boundingBox.setFromBufferAttribute(_),st)for(let at=0,lt=st.length;at<lt;at++){const ft=st[at];zn.setFromBufferAttribute(ft),this.morphTargetsRelative?(Us.addVectors(this.boundingBox.min,zn.min),this.boundingBox.expandByPoint(Us),Us.addVectors(this.boundingBox.max,zn.max),this.boundingBox.expandByPoint(Us)):(this.boundingBox.expandByPoint(zn.min),this.boundingBox.expandByPoint(zn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new am);const _=this.attributes.position,st=this.morphAttributes.position;if(_&&_.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Mr,1/0);if(_){const at=this.boundingSphere.center;if(zn.setFromBufferAttribute(_),st)for(let ft=0,vt=st.length;ft<vt;ft++){const At=st[ft];Ms.setFromBufferAttribute(At),this.morphTargetsRelative?(Us.addVectors(zn.min,Ms.min),zn.expandByPoint(Us),Us.addVectors(zn.max,Ms.max),zn.expandByPoint(Us)):(zn.expandByPoint(Ms.min),zn.expandByPoint(Ms.max))}zn.getCenter(at);let lt=0;for(let ft=0,vt=_.count;ft<vt;ft++)Us.fromBufferAttribute(_,ft),lt=Math.max(lt,at.distanceToSquared(Us));if(st)for(let ft=0,vt=st.length;ft<vt;ft++){const At=st[ft],Ct=this.morphTargetsRelative;for(let Tt=0,Ot=At.count;Tt<Ot;Tt++)Us.fromBufferAttribute(At,Tt),Ct&&(An.fromBufferAttribute(_,Tt),Us.add(An)),lt=Math.max(lt,at.distanceToSquared(Us))}this.boundingSphere.radius=Math.sqrt(lt),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const _=this.index,st=this.attributes;if(_===null||st.position===void 0||st.normal===void 0||st.uv===void 0)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const at=_.array,lt=st.position.array,ft=st.normal.array,vt=st.uv.array,At=lt.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new El(new Float32Array(4*At),4));const Ct=this.getAttribute("tangent").array,Tt=[],Ot=[];for(let ln=0;ln<At;ln++)Tt[ln]=new Mr,Ot[ln]=new Mr;const Ut=new Mr,Lt=new Mr,Gt=new Mr,Xt=new Vn,Qt=new Vn,lr=new Vn,ur=new Mr,cr=new Mr;function gr(ln,Wr,Bn){Ut.fromArray(lt,3*ln),Lt.fromArray(lt,3*Wr),Gt.fromArray(lt,3*Bn),Xt.fromArray(vt,2*ln),Qt.fromArray(vt,2*Wr),lr.fromArray(vt,2*Bn),Lt.sub(Ut),Gt.sub(Ut),Qt.sub(Xt),lr.sub(Xt);const Hn=1/(Qt.x*lr.y-lr.x*Qt.y);isFinite(Hn)&&(ur.copy(Lt).multiplyScalar(lr.y).addScaledVector(Gt,-Qt.y).multiplyScalar(Hn),cr.copy(Gt).multiplyScalar(Qt.x).addScaledVector(Lt,-lr.x).multiplyScalar(Hn),Tt[ln].add(ur),Tt[Wr].add(ur),Tt[Bn].add(ur),Ot[ln].add(cr),Ot[Wr].add(cr),Ot[Bn].add(cr))}let wr=this.groups;wr.length===0&&(wr=[{start:0,count:at.length}]);for(let ln=0,Wr=wr.length;ln<Wr;++ln){const Bn=wr[ln],Hn=Bn.start;for(let Pn=Hn,es=Hn+Bn.count;Pn<es;Pn+=3)gr(at[Pn+0],at[Pn+1],at[Pn+2])}const Er=new Mr,Cr=new Mr,zr=new Mr,Gr=new Mr;function on(ln){zr.fromArray(ft,3*ln),Gr.copy(zr);const Wr=Tt[ln];Er.copy(Wr),Er.sub(zr.multiplyScalar(zr.dot(Wr))).normalize(),Cr.crossVectors(Gr,Wr);const Bn=Cr.dot(Ot[ln])<0?-1:1;Ct[4*ln]=Er.x,Ct[4*ln+1]=Er.y,Ct[4*ln+2]=Er.z,Ct[4*ln+3]=Bn}for(let ln=0,Wr=wr.length;ln<Wr;++ln){const Bn=wr[ln],Hn=Bn.start;for(let Pn=Hn,es=Hn+Bn.count;Pn<es;Pn+=3)on(at[Pn+0]),on(at[Pn+1]),on(at[Pn+2])}}computeVertexNormals(){const _=this.index,st=this.getAttribute("position");if(st!==void 0){let at=this.getAttribute("normal");if(at===void 0)at=new El(new Float32Array(3*st.count),3),this.setAttribute("normal",at);else for(let Lt=0,Gt=at.count;Lt<Gt;Lt++)at.setXYZ(Lt,0,0,0);const lt=new Mr,ft=new Mr,vt=new Mr,At=new Mr,Ct=new Mr,Tt=new Mr,Ot=new Mr,Ut=new Mr;if(_)for(let Lt=0,Gt=_.count;Lt<Gt;Lt+=3){const Xt=_.getX(Lt+0),Qt=_.getX(Lt+1),lr=_.getX(Lt+2);lt.fromBufferAttribute(st,Xt),ft.fromBufferAttribute(st,Qt),vt.fromBufferAttribute(st,lr),Ot.subVectors(vt,ft),Ut.subVectors(lt,ft),Ot.cross(Ut),At.fromBufferAttribute(at,Xt),Ct.fromBufferAttribute(at,Qt),Tt.fromBufferAttribute(at,lr),At.add(Ot),Ct.add(Ot),Tt.add(Ot),at.setXYZ(Xt,At.x,At.y,At.z),at.setXYZ(Qt,Ct.x,Ct.y,Ct.z),at.setXYZ(lr,Tt.x,Tt.y,Tt.z)}else for(let Lt=0,Gt=st.count;Lt<Gt;Lt+=3)lt.fromBufferAttribute(st,Lt+0),ft.fromBufferAttribute(st,Lt+1),vt.fromBufferAttribute(st,Lt+2),Ot.subVectors(vt,ft),Ut.subVectors(lt,ft),Ot.cross(Ut),at.setXYZ(Lt+0,Ot.x,Ot.y,Ot.z),at.setXYZ(Lt+1,Ot.x,Ot.y,Ot.z),at.setXYZ(Lt+2,Ot.x,Ot.y,Ot.z);this.normalizeNormals(),at.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const _=this.attributes.normal;for(let st=0,at=_.count;st<at;st++)Us.fromBufferAttribute(_,st),Us.normalize(),_.setXYZ(st,Us.x,Us.y,Us.z)}toNonIndexed(){function _(At,Ct){const Tt=At.array,Ot=At.itemSize,Ut=At.normalized,Lt=new Tt.constructor(Ct.length*Ot);let Gt=0,Xt=0;for(let Qt=0,lr=Ct.length;Qt<lr;Qt++){Gt=At.isInterleavedBufferAttribute?Ct[Qt]*At.data.stride+At.offset:Ct[Qt]*Ot;for(let ur=0;ur<Ot;ur++)Lt[Xt++]=Tt[Gt++]}return new El(Lt,Ot,Ut)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const st=new xs,at=this.index.array,lt=this.attributes;for(const At in lt){const Ct=_(lt[At],at);st.setAttribute(At,Ct)}const ft=this.morphAttributes;for(const At in ft){const Ct=[],Tt=ft[At];for(let Ot=0,Ut=Tt.length;Ot<Ut;Ot++){const Lt=_(Tt[Ot],at);Ct.push(Lt)}st.morphAttributes[At]=Ct}st.morphTargetsRelative=this.morphTargetsRelative;const vt=this.groups;for(let At=0,Ct=vt.length;At<Ct;At++){const Tt=vt[At];st.addGroup(Tt.start,Tt.count,Tt.materialIndex)}return st}toJSON(){const _={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(_.uuid=this.uuid,_.type=this.type,this.name!==""&&(_.name=this.name),Object.keys(this.userData).length>0&&(_.userData=this.userData),this.parameters!==void 0){const Ct=this.parameters;for(const Tt in Ct)Ct[Tt]!==void 0&&(_[Tt]=Ct[Tt]);return _}_.data={attributes:{}};const st=this.index;st!==null&&(_.data.index={type:st.array.constructor.name,array:Array.prototype.slice.call(st.array)});const at=this.attributes;for(const Ct in at){const Tt=at[Ct];_.data.attributes[Ct]=Tt.toJSON(_.data)}const lt={};let ft=!1;for(const Ct in this.morphAttributes){const Tt=this.morphAttributes[Ct],Ot=[];for(let Ut=0,Lt=Tt.length;Ut<Lt;Ut++){const Gt=Tt[Ut];Ot.push(Gt.toJSON(_.data))}Ot.length>0&&(lt[Ct]=Ot,ft=!0)}ft&&(_.data.morphAttributes=lt,_.data.morphTargetsRelative=this.morphTargetsRelative);const vt=this.groups;vt.length>0&&(_.data.groups=JSON.parse(JSON.stringify(vt)));const At=this.boundingSphere;return At!==null&&(_.data.boundingSphere={center:At.center.toArray(),radius:At.radius}),_}clone(){return new this.constructor().copy(this)}copy(_){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const st={};this.name=_.name;const at=_.index;at!==null&&this.setIndex(at.clone(st));const lt=_.attributes;for(const Tt in lt){const Ot=lt[Tt];this.setAttribute(Tt,Ot.clone(st))}const ft=_.morphAttributes;for(const Tt in ft){const Ot=[],Ut=ft[Tt];for(let Lt=0,Gt=Ut.length;Lt<Gt;Lt++)Ot.push(Ut[Lt].clone(st));this.morphAttributes[Tt]=Ot}this.morphTargetsRelative=_.morphTargetsRelative;const vt=_.groups;for(let Tt=0,Ot=vt.length;Tt<Ot;Tt++){const Ut=vt[Tt];this.addGroup(Ut.start,Ut.count,Ut.materialIndex)}const At=_.boundingBox;At!==null&&(this.boundingBox=At.clone());const Ct=_.boundingSphere;return Ct!==null&&(this.boundingSphere=Ct.clone()),this.drawRange.start=_.drawRange.start,this.drawRange.count=_.drawRange.count,this.userData=_.userData,_.parameters!==void 0&&(this.parameters=Object.assign({},_.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const Fl=new Ys,pu=new s_,fm=new am,sp=new Mr,Gp=new Mr,Pm=new Mr,K_=new Mr,u_=new Mr,Q0=new Mr,zy=new Mr,Vy=new Mr,Gy=new Mr,QA=new Vn,Bx=new Vn,kx=new Vn,qw=new Mr,Qy=new Mr;class Hu extends ao{constructor(_=new xs,st=new Jm){super(),this.isMesh=!0,this.type="Mesh",this.geometry=_,this.material=st,this.updateMorphTargets()}copy(_,st){return super.copy(_,st),_.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=_.morphTargetInfluences.slice()),_.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},_.morphTargetDictionary)),this.material=_.material,this.geometry=_.geometry,this}updateMorphTargets(){const _=this.geometry.morphAttributes,st=Object.keys(_);if(st.length>0){const at=_[st[0]];if(at!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let lt=0,ft=at.length;lt<ft;lt++){const vt=at[lt].name||String(lt);this.morphTargetInfluences.push(0),this.morphTargetDictionary[vt]=lt}}}}raycast(_,st){const at=this.geometry,lt=this.material,ft=this.matrixWorld;if(lt===void 0||(at.boundingSphere===null&&at.computeBoundingSphere(),fm.copy(at.boundingSphere),fm.applyMatrix4(ft),_.ray.intersectsSphere(fm)===!1)||(Fl.copy(ft).invert(),pu.copy(_.ray).applyMatrix4(Fl),at.boundingBox!==null&&pu.intersectsBox(at.boundingBox)===!1))return;let vt;const At=at.index,Ct=at.attributes.position,Tt=at.morphAttributes.position,Ot=at.morphTargetsRelative,Ut=at.attributes.uv,Lt=at.attributes.uv2,Gt=at.groups,Xt=at.drawRange;if(At!==null)if(Array.isArray(lt))for(let Qt=0,lr=Gt.length;Qt<lr;Qt++){const ur=Gt[Qt],cr=lt[ur.materialIndex];for(let gr=Math.max(ur.start,Xt.start),wr=Math.min(At.count,Math.min(ur.start+ur.count,Xt.start+Xt.count));gr<wr;gr+=3){const Er=At.getX(gr),Cr=At.getX(gr+1),zr=At.getX(gr+2);vt=Ww(this,cr,_,pu,Ct,Tt,Ot,Ut,Lt,Er,Cr,zr),vt&&(vt.faceIndex=Math.floor(gr/3),vt.face.materialIndex=ur.materialIndex,st.push(vt))}}else for(let Qt=Math.max(0,Xt.start),lr=Math.min(At.count,Xt.start+Xt.count);Qt<lr;Qt+=3){const ur=At.getX(Qt),cr=At.getX(Qt+1),gr=At.getX(Qt+2);vt=Ww(this,lt,_,pu,Ct,Tt,Ot,Ut,Lt,ur,cr,gr),vt&&(vt.faceIndex=Math.floor(Qt/3),st.push(vt))}else if(Ct!==void 0)if(Array.isArray(lt))for(let Qt=0,lr=Gt.length;Qt<lr;Qt++){const ur=Gt[Qt],cr=lt[ur.materialIndex];for(let gr=Math.max(ur.start,Xt.start),wr=Math.min(Ct.count,Math.min(ur.start+ur.count,Xt.start+Xt.count));gr<wr;gr+=3)vt=Ww(this,cr,_,pu,Ct,Tt,Ot,Ut,Lt,gr,gr+1,gr+2),vt&&(vt.faceIndex=Math.floor(gr/3),vt.face.materialIndex=ur.materialIndex,st.push(vt))}else for(let Qt=Math.max(0,Xt.start),lr=Math.min(Ct.count,Xt.start+Xt.count);Qt<lr;Qt+=3)vt=Ww(this,lt,_,pu,Ct,Tt,Ot,Ut,Lt,Qt,Qt+1,Qt+2),vt&&(vt.faceIndex=Math.floor(Qt/3),st.push(vt))}}function Ww(wt,_,st,at,lt,ft,vt,At,Ct,Tt,Ot,Ut){sp.fromBufferAttribute(lt,Tt),Gp.fromBufferAttribute(lt,Ot),Pm.fromBufferAttribute(lt,Ut);const Lt=wt.morphTargetInfluences;if(ft&&Lt){zy.set(0,0,0),Vy.set(0,0,0),Gy.set(0,0,0);for(let Xt=0,Qt=ft.length;Xt<Qt;Xt++){const lr=Lt[Xt],ur=ft[Xt];lr!==0&&(K_.fromBufferAttribute(ur,Tt),u_.fromBufferAttribute(ur,Ot),Q0.fromBufferAttribute(ur,Ut),vt?(zy.addScaledVector(K_,lr),Vy.addScaledVector(u_,lr),Gy.addScaledVector(Q0,lr)):(zy.addScaledVector(K_.sub(sp),lr),Vy.addScaledVector(u_.sub(Gp),lr),Gy.addScaledVector(Q0.sub(Pm),lr)))}sp.add(zy),Gp.add(Vy),Pm.add(Gy)}wt.isSkinnedMesh&&(wt.boneTransform(Tt,sp),wt.boneTransform(Ot,Gp),wt.boneTransform(Ut,Pm));const Gt=function(Xt,Qt,lr,ur,cr,gr,wr,Er){let Cr;if(Cr=Qt.side===Yt?ur.intersectTriangle(wr,gr,cr,!0,Er):ur.intersectTriangle(cr,gr,wr,Qt.side!==dr,Er),Cr===null)return null;Qy.copy(Er),Qy.applyMatrix4(Xt.matrixWorld);const zr=lr.ray.origin.distanceTo(Qy);return zr<lr.near||zr>lr.far?null:{distance:zr,point:Qy.clone(),object:Xt}}(wt,_,st,at,sp,Gp,Pm,qw);if(Gt){At&&(QA.fromBufferAttribute(At,Tt),Bx.fromBufferAttribute(At,Ot),kx.fromBufferAttribute(At,Ut),Gt.uv=Gu.getUV(qw,sp,Gp,Pm,QA,Bx,kx,new Vn)),Ct&&(QA.fromBufferAttribute(Ct,Tt),Bx.fromBufferAttribute(Ct,Ot),kx.fromBufferAttribute(Ct,Ut),Gt.uv2=Gu.getUV(qw,sp,Gp,Pm,QA,Bx,kx,new Vn));const Xt={a:Tt,b:Ot,c:Ut,normal:new Mr,materialIndex:0};Gu.getNormal(sp,Gp,Pm,Xt.normal),Gt.face=Xt}return Gt}class Zm extends xs{constructor(_=1,st=1,at=1,lt=1,ft=1,vt=1){super(),this.type="BoxGeometry",this.parameters={width:_,height:st,depth:at,widthSegments:lt,heightSegments:ft,depthSegments:vt};const At=this;lt=Math.floor(lt),ft=Math.floor(ft),vt=Math.floor(vt);const Ct=[],Tt=[],Ot=[],Ut=[];let Lt=0,Gt=0;function Xt(Qt,lr,ur,cr,gr,wr,Er,Cr,zr,Gr,on){const ln=wr/zr,Wr=Er/Gr,Bn=wr/2,Hn=Er/2,Pn=Cr/2,es=zr+1,ts=Gr+1;let bn=0,Sn=0;const Kn=new Mr;for(let kn=0;kn<ts;kn++){const Zn=kn*Wr-Hn;for(let Rs=0;Rs<es;Rs++){const wo=Rs*ln-Bn;Kn[Qt]=wo*cr,Kn[lr]=Zn*gr,Kn[ur]=Pn,Tt.push(Kn.x,Kn.y,Kn.z),Kn[Qt]=0,Kn[lr]=0,Kn[ur]=Cr>0?1:-1,Ot.push(Kn.x,Kn.y,Kn.z),Ut.push(Rs/zr),Ut.push(1-kn/Gr),bn+=1}}for(let kn=0;kn<Gr;kn++)for(let Zn=0;Zn<zr;Zn++){const Rs=Lt+Zn+es*kn,wo=Lt+Zn+es*(kn+1),Ds=Lt+(Zn+1)+es*(kn+1),fo=Lt+(Zn+1)+es*kn;Ct.push(Rs,wo,fo),Ct.push(wo,Ds,fo),Sn+=6}At.addGroup(Gt,Sn,on),Gt+=Sn,Lt+=bn}Xt("z","y","x",-1,-1,at,st,_,vt,ft,0),Xt("z","y","x",1,-1,at,st,-_,vt,ft,1),Xt("x","z","y",1,1,_,at,st,lt,vt,2),Xt("x","z","y",1,-1,_,at,-st,lt,vt,3),Xt("x","y","z",1,-1,_,st,at,lt,ft,4),Xt("x","y","z",-1,-1,_,st,-at,lt,ft,5),this.setIndex(Ct),this.setAttribute("position",new xt(Tt,3)),this.setAttribute("normal",new xt(Ot,3)),this.setAttribute("uv",new xt(Ut,2))}static fromJSON(_){return new Zm(_.width,_.height,_.depth,_.widthSegments,_.heightSegments,_.depthSegments)}}function H0(wt){const _={};for(const st in wt){_[st]={};for(const at in wt[st]){const lt=wt[st][at];lt&&(lt.isColor||lt.isMatrix3||lt.isMatrix4||lt.isVector2||lt.isVector3||lt.isVector4||lt.isTexture||lt.isQuaternion)?_[st][at]=lt.clone():Array.isArray(lt)?_[st][at]=lt.slice():_[st][at]=lt}}return _}function Bp(wt){const _={};for(let st=0;st<wt.length;st++){const at=H0(wt[st]);for(const lt in at)_[lt]=at[lt]}return _}const VT={clone:H0,merge:Bp};class Tv extends Qu{constructor(_){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,_!==void 0&&this.setValues(_)}copy(_){return super.copy(_),this.fragmentShader=_.fragmentShader,this.vertexShader=_.vertexShader,this.uniforms=H0(_.uniforms),this.uniformsGroups=function(st){const at=[];for(let lt=0;lt<st.length;lt++)at.push(st[lt].clone());return at}(_.uniformsGroups),this.defines=Object.assign({},_.defines),this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.fog=_.fog,this.lights=_.lights,this.clipping=_.clipping,this.extensions=Object.assign({},_.extensions),this.glslVersion=_.glslVersion,this}toJSON(_){const st=super.toJSON(_);st.glslVersion=this.glslVersion,st.uniforms={};for(const lt in this.uniforms){const ft=this.uniforms[lt].value;ft&&ft.isTexture?st.uniforms[lt]={type:"t",value:ft.toJSON(_).uuid}:ft&&ft.isColor?st.uniforms[lt]={type:"c",value:ft.getHex()}:ft&&ft.isVector2?st.uniforms[lt]={type:"v2",value:ft.toArray()}:ft&&ft.isVector3?st.uniforms[lt]={type:"v3",value:ft.toArray()}:ft&&ft.isVector4?st.uniforms[lt]={type:"v4",value:ft.toArray()}:ft&&ft.isMatrix3?st.uniforms[lt]={type:"m3",value:ft.toArray()}:ft&&ft.isMatrix4?st.uniforms[lt]={type:"m4",value:ft.toArray()}:st.uniforms[lt]={value:ft}}Object.keys(this.defines).length>0&&(st.defines=this.defines),st.vertexShader=this.vertexShader,st.fragmentShader=this.fragmentShader;const at={};for(const lt in this.extensions)this.extensions[lt]===!0&&(at[lt]=!0);return Object.keys(at).length>0&&(st.extensions=at),st}}class HA extends ao{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ys,this.projectionMatrix=new Ys,this.projectionMatrixInverse=new Ys}copy(_,st){return super.copy(_,st),this.matrixWorldInverse.copy(_.matrixWorldInverse),this.projectionMatrix.copy(_.projectionMatrix),this.projectionMatrixInverse.copy(_.projectionMatrixInverse),this}getWorldDirection(_){this.updateWorldMatrix(!0,!1);const st=this.matrixWorld.elements;return _.set(-st[8],-st[9],-st[10]).normalize()}updateMatrixWorld(_){super.updateMatrixWorld(_),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(_,st){super.updateWorldMatrix(_,st),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class op extends HA{constructor(_=50,st=1,at=.1,lt=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=_,this.zoom=1,this.near=at,this.far=lt,this.focus=10,this.aspect=st,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(_,st){return super.copy(_,st),this.fov=_.fov,this.zoom=_.zoom,this.near=_.near,this.far=_.far,this.focus=_.focus,this.aspect=_.aspect,this.view=_.view===null?null:Object.assign({},_.view),this.filmGauge=_.filmGauge,this.filmOffset=_.filmOffset,this}setFocalLength(_){const st=.5*this.getFilmHeight()/_;this.fov=2*ky*Math.atan(st),this.updateProjectionMatrix()}getFocalLength(){const _=Math.tan(.5*$_*this.fov);return .5*this.getFilmHeight()/_}getEffectiveFOV(){return 2*ky*Math.atan(Math.tan(.5*$_*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(_,st,at,lt,ft,vt){this.aspect=_/st,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_,this.view.fullHeight=st,this.view.offsetX=at,this.view.offsetY=lt,this.view.width=ft,this.view.height=vt,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _=this.near;let st=_*Math.tan(.5*$_*this.fov)/this.zoom,at=2*st,lt=this.aspect*at,ft=-.5*lt;const vt=this.view;if(this.view!==null&&this.view.enabled){const Ct=vt.fullWidth,Tt=vt.fullHeight;ft+=vt.offsetX*lt/Ct,st-=vt.offsetY*at/Tt,lt*=vt.width/Ct,at*=vt.height/Tt}const At=this.filmOffset;At!==0&&(ft+=_*At/this.getFilmWidth()),this.projectionMatrix.makePerspective(ft,ft+lt,st,st-at,_,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_){const st=super.toJSON(_);return st.object.fov=this.fov,st.object.zoom=this.zoom,st.object.near=this.near,st.object.far=this.far,st.object.focus=this.focus,st.object.aspect=this.aspect,this.view!==null&&(st.object.view=Object.assign({},this.view)),st.object.filmGauge=this.filmGauge,st.object.filmOffset=this.filmOffset,st}}const q0=90;class $S extends ao{constructor(_,st,at){super(),this.type="CubeCamera",this.renderTarget=at;const lt=new op(q0,1,_,st);lt.layers=this.layers,lt.up.set(0,-1,0),lt.lookAt(new Mr(1,0,0)),this.add(lt);const ft=new op(q0,1,_,st);ft.layers=this.layers,ft.up.set(0,-1,0),ft.lookAt(new Mr(-1,0,0)),this.add(ft);const vt=new op(q0,1,_,st);vt.layers=this.layers,vt.up.set(0,0,1),vt.lookAt(new Mr(0,1,0)),this.add(vt);const At=new op(q0,1,_,st);At.layers=this.layers,At.up.set(0,0,-1),At.lookAt(new Mr(0,-1,0)),this.add(At);const Ct=new op(q0,1,_,st);Ct.layers=this.layers,Ct.up.set(0,-1,0),Ct.lookAt(new Mr(0,0,1)),this.add(Ct);const Tt=new op(q0,1,_,st);Tt.layers=this.layers,Tt.up.set(0,-1,0),Tt.lookAt(new Mr(0,0,-1)),this.add(Tt)}update(_,st){this.parent===null&&this.updateMatrixWorld();const at=this.renderTarget,[lt,ft,vt,At,Ct,Tt]=this.children,Ot=_.getRenderTarget(),Ut=_.toneMapping,Lt=_.xr.enabled;_.toneMapping=Vs,_.xr.enabled=!1;const Gt=at.texture.generateMipmaps;at.texture.generateMipmaps=!1,_.setRenderTarget(at,0),_.render(st,lt),_.setRenderTarget(at,1),_.render(st,ft),_.setRenderTarget(at,2),_.render(st,vt),_.setRenderTarget(at,3),_.render(st,At),_.setRenderTarget(at,4),_.render(st,Ct),at.texture.generateMipmaps=Gt,_.setRenderTarget(at,5),_.render(st,Tt),_.setRenderTarget(Ot),_.toneMapping=Ut,_.xr.enabled=Lt,at.texture.needsPMREMUpdate=!0}}class qA extends Cu{constructor(_,st,at,lt,ft,vt,At,Ct,Tt,Ot){super(_=_!==void 0?_:[],st=st!==void 0?st:Vo,at,lt,ft,vt,At,Ct,Tt,Ot),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(_){this.image=_}}class GT extends Ip{constructor(_,st={}){super(_,_,st),this.isWebGLCubeRenderTarget=!0;const at={width:_,height:_,depth:1},lt=[at,at,at,at,at,at];this.texture=new qA(lt,st.mapping,st.wrapS,st.wrapT,st.magFilter,st.minFilter,st.format,st.type,st.anisotropy,st.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=st.generateMipmaps!==void 0&&st.generateMipmaps,this.texture.minFilter=st.minFilter!==void 0?st.minFilter:Ko}fromEquirectangularTexture(_,st){this.texture.type=st.type,this.texture.encoding=st.encoding,this.texture.generateMipmaps=st.generateMipmaps,this.texture.minFilter=st.minFilter,this.texture.magFilter=st.magFilter;const at={tEquirect:{value:null}},lt=`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,ft=`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`,vt=new Zm(5,5,5),At=new Tv({name:"CubemapFromEquirect",uniforms:H0(at),vertexShader:lt,fragmentShader:ft,side:Yt,blending:Ft});At.uniforms.tEquirect.value=st;const Ct=new Hu(vt,At),Tt=st.minFilter;return st.minFilter===ys&&(st.minFilter=Ko),new $S(1,10,this).update(_,Ct),st.minFilter=Tt,Ct.geometry.dispose(),Ct.material.dispose(),this}clear(_,st,at,lt){const ft=_.getRenderTarget();for(let vt=0;vt<6;vt++)_.setRenderTarget(this,vt),_.clear(st,at,lt);_.setRenderTarget(ft)}}const jS=new Mr,W0=new Mr,zS=new ju;class X_{constructor(_=new Mr(1,0,0),st=0){this.isPlane=!0,this.normal=_,this.constant=st}set(_,st){return this.normal.copy(_),this.constant=st,this}setComponents(_,st,at,lt){return this.normal.set(_,st,at),this.constant=lt,this}setFromNormalAndCoplanarPoint(_,st){return this.normal.copy(_),this.constant=-st.dot(this.normal),this}setFromCoplanarPoints(_,st,at){const lt=jS.subVectors(at,st).cross(W0.subVectors(_,st)).normalize();return this.setFromNormalAndCoplanarPoint(lt,_),this}copy(_){return this.normal.copy(_.normal),this.constant=_.constant,this}normalize(){const _=1/this.normal.length();return this.normal.multiplyScalar(_),this.constant*=_,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(_){return this.normal.dot(_)+this.constant}distanceToSphere(_){return this.distanceToPoint(_.center)-_.radius}projectPoint(_,st){return st.copy(this.normal).multiplyScalar(-this.distanceToPoint(_)).add(_)}intersectLine(_,st){const at=_.delta(jS),lt=this.normal.dot(at);if(lt===0)return this.distanceToPoint(_.start)===0?st.copy(_.start):null;const ft=-(_.start.dot(this.normal)+this.constant)/lt;return ft<0||ft>1?null:st.copy(at).multiplyScalar(ft).add(_.start)}intersectsLine(_){const st=this.distanceToPoint(_.start),at=this.distanceToPoint(_.end);return st<0&&at>0||at<0&&st>0}intersectsBox(_){return _.intersectsPlane(this)}intersectsSphere(_){return _.intersectsPlane(this)}coplanarPoint(_){return _.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(_,st){const at=st||zS.getNormalMatrix(_),lt=this.coplanarPoint(jS).applyMatrix4(_),ft=this.normal.applyMatrix3(at).normalize();return this.constant=-lt.dot(ft),this}translate(_){return this.constant-=_.dot(this.normal),this}equals(_){return _.normal.equals(this.normal)&&_.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Hy=new am,Yw=new Mr;class Kw{constructor(_=new X_,st=new X_,at=new X_,lt=new X_,ft=new X_,vt=new X_){this.planes=[_,st,at,lt,ft,vt]}set(_,st,at,lt,ft,vt){const At=this.planes;return At[0].copy(_),At[1].copy(st),At[2].copy(at),At[3].copy(lt),At[4].copy(ft),At[5].copy(vt),this}copy(_){const st=this.planes;for(let at=0;at<6;at++)st[at].copy(_.planes[at]);return this}setFromProjectionMatrix(_){const st=this.planes,at=_.elements,lt=at[0],ft=at[1],vt=at[2],At=at[3],Ct=at[4],Tt=at[5],Ot=at[6],Ut=at[7],Lt=at[8],Gt=at[9],Xt=at[10],Qt=at[11],lr=at[12],ur=at[13],cr=at[14],gr=at[15];return st[0].setComponents(At-lt,Ut-Ct,Qt-Lt,gr-lr).normalize(),st[1].setComponents(At+lt,Ut+Ct,Qt+Lt,gr+lr).normalize(),st[2].setComponents(At+ft,Ut+Tt,Qt+Gt,gr+ur).normalize(),st[3].setComponents(At-ft,Ut-Tt,Qt-Gt,gr-ur).normalize(),st[4].setComponents(At-vt,Ut-Ot,Qt-Xt,gr-cr).normalize(),st[5].setComponents(At+vt,Ut+Ot,Qt+Xt,gr+cr).normalize(),this}intersectsObject(_){const st=_.geometry;return st.boundingSphere===null&&st.computeBoundingSphere(),Hy.copy(st.boundingSphere).applyMatrix4(_.matrixWorld),this.intersectsSphere(Hy)}intersectsSprite(_){return Hy.center.set(0,0,0),Hy.radius=.7071067811865476,Hy.applyMatrix4(_.matrixWorld),this.intersectsSphere(Hy)}intersectsSphere(_){const st=this.planes,at=_.center,lt=-_.radius;for(let ft=0;ft<6;ft++)if(st[ft].distanceToPoint(at)<lt)return!1;return!0}intersectsBox(_){const st=this.planes;for(let at=0;at<6;at++){const lt=st[at];if(Yw.x=lt.normal.x>0?_.max.x:_.min.x,Yw.y=lt.normal.y>0?_.max.y:_.min.y,Yw.z=lt.normal.z>0?_.max.z:_.min.z,lt.distanceToPoint(Yw)<0)return!1}return!0}containsPoint(_){const st=this.planes;for(let at=0;at<6;at++)if(st[at].distanceToPoint(_)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function J_(){let wt=null,_=!1,st=null,at=null;function lt(ft,vt){st(ft,vt),at=wt.requestAnimationFrame(lt)}return{start:function(){_!==!0&&st!==null&&(at=wt.requestAnimationFrame(lt),_=!0)},stop:function(){wt.cancelAnimationFrame(at),_=!1},setAnimationLoop:function(ft){st=ft},setContext:function(ft){wt=ft}}}function WA(wt,_){const st=_.isWebGL2,at=new WeakMap;return{get:function(lt){return lt.isInterleavedBufferAttribute&&(lt=lt.data),at.get(lt)},remove:function(lt){lt.isInterleavedBufferAttribute&&(lt=lt.data);const ft=at.get(lt);ft&&(wt.deleteBuffer(ft.buffer),at.delete(lt))},update:function(lt,ft){if(lt.isGLBufferAttribute){const At=at.get(lt);return void((!At||At.version<lt.version)&&at.set(lt,{buffer:lt.buffer,type:lt.type,bytesPerElement:lt.elementSize,version:lt.version}))}lt.isInterleavedBufferAttribute&&(lt=lt.data);const vt=at.get(lt);vt===void 0?at.set(lt,function(At,Ct){const Tt=At.array,Ot=At.usage,Ut=wt.createBuffer();let Lt;if(wt.bindBuffer(Ct,Ut),wt.bufferData(Ct,Tt,Ot),At.onUploadCallback(),Tt instanceof Float32Array)Lt=5126;else if(Tt instanceof Uint16Array)if(At.isFloat16BufferAttribute){if(!st)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");Lt=5131}else Lt=5123;else if(Tt instanceof Int16Array)Lt=5122;else if(Tt instanceof Uint32Array)Lt=5125;else if(Tt instanceof Int32Array)Lt=5124;else if(Tt instanceof Int8Array)Lt=5120;else if(Tt instanceof Uint8Array)Lt=5121;else{if(!(Tt instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+Tt);Lt=5121}return{buffer:Ut,type:Lt,bytesPerElement:Tt.BYTES_PER_ELEMENT,version:At.version}}(lt,ft)):vt.version<lt.version&&(function(At,Ct,Tt){const Ot=Ct.array,Ut=Ct.updateRange;wt.bindBuffer(Tt,At),Ut.count===-1?wt.bufferSubData(Tt,0,Ot):(st?wt.bufferSubData(Tt,Ut.offset*Ot.BYTES_PER_ELEMENT,Ot,Ut.offset,Ut.count):wt.bufferSubData(Tt,Ut.offset*Ot.BYTES_PER_ELEMENT,Ot.subarray(Ut.offset,Ut.offset+Ut.count)),Ut.count=-1)}(vt.buffer,lt,ft),vt.version=lt.version)}}}class Y0 extends xs{constructor(_=1,st=1,at=1,lt=1){super(),this.type="PlaneGeometry",this.parameters={width:_,height:st,widthSegments:at,heightSegments:lt};const ft=_/2,vt=st/2,At=Math.floor(at),Ct=Math.floor(lt),Tt=At+1,Ot=Ct+1,Ut=_/At,Lt=st/Ct,Gt=[],Xt=[],Qt=[],lr=[];for(let ur=0;ur<Ot;ur++){const cr=ur*Lt-vt;for(let gr=0;gr<Tt;gr++){const wr=gr*Ut-ft;Xt.push(wr,-cr,0),Qt.push(0,0,1),lr.push(gr/At),lr.push(1-ur/Ct)}}for(let ur=0;ur<Ct;ur++)for(let cr=0;cr<At;cr++){const gr=cr+Tt*ur,wr=cr+Tt*(ur+1),Er=cr+1+Tt*(ur+1),Cr=cr+1+Tt*ur;Gt.push(gr,wr,Cr),Gt.push(wr,Er,Cr)}this.setIndex(Gt),this.setAttribute("position",new xt(Xt,3)),this.setAttribute("normal",new xt(Qt,3)),this.setAttribute("uv",new xt(lr,2))}static fromJSON(_){return new Y0(_.width,_.height,_.widthSegments,_.heightSegments)}}const ho={alphamap_fragment:`#ifdef USE_ALPHAMAP
	#if defined(INVERSE_ALPHAMAP) && INVERSE_ALPHAMAP >= 1
	diffuseColor.a *= 1.0-texture2D( alphaMap, vUv ).g;
	#else
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
	#endif
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,alphatest_pars_fragment:`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,iridescence_fragment:`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex:`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common:`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	reflectVec = transformDirection1(reflectVec, rotationMatrix(vec3(0,1,0), envMapRotation));
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	vec3 transformDirection1( in vec3 dir, in mat4 matrix ) {
		return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
	}
	mat4 rotationMatrix(vec3 axis, float angle) {
		axis = normalize(axis);
		float s = sin(angle);
		float c = cos(angle);
		float oc = 1.0 - c;
		return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,
					oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,
					oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,
					0.0,                                0.0,                                0.0,                                1.0);
	}
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform float envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			worldNormal = transformDirection1(worldNormal, rotationMatrix(vec3(0,1,0), envMapRotation));
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			reflectVec = transformDirection1(reflectVec, rotationMatrix(vec3(0,1,0), envMapRotation));
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_fragment:`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,lights_lambert_pars_fragment:`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert
#define Material_LightProbeLOD( material )	(0)`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphcolor_vertex:`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,normal_fragment_begin:`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normal_pars_fragment:`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_pars_vertex:`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_vertex:`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,iridescence_pars_fragment:`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,output_fragment:`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
diffuseColor.a = min(max(diffuseColor.a, 0.), 1.);
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment:`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,transmission_pars_fragment:`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return transmissionSamplerMapTexelToLinear ( texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod ) );
		#else
			return transmissionSamplerMapTexelToLinear ( texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod ) );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
uniform bool flipX;
uniform bool flipY;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
    vUv = flipX ? vec2( 1.0 - vUv.x, vUv.y ) : vUv;
    vUv = flipY ? vec2( vUv.x, 1.0 - vUv.y ) : vUv;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		gl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );
	#endif
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshnormal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,meshnormal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`},ls={common:{diffuse:{value:new ms(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ju},uv2Transform:{value:new ju},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},envMapRotation:{value:0},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Vn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ms(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ms(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ju}},sprite:{diffuse:{value:new ms(16777215)},opacity:{value:1},center:{value:new Vn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ju}}},mm={basic:{uniforms:Bp([ls.common,ls.specularmap,ls.envmap,ls.aomap,ls.lightmap,ls.fog]),vertexShader:ho.meshbasic_vert,fragmentShader:ho.meshbasic_frag},lambert:{uniforms:Bp([ls.common,ls.specularmap,ls.envmap,ls.aomap,ls.lightmap,ls.emissivemap,ls.bumpmap,ls.normalmap,ls.displacementmap,ls.fog,ls.lights,{emissive:{value:new ms(0)}}]),vertexShader:ho.meshlambert_vert,fragmentShader:ho.meshlambert_frag},phong:{uniforms:Bp([ls.common,ls.specularmap,ls.envmap,ls.aomap,ls.lightmap,ls.emissivemap,ls.bumpmap,ls.normalmap,ls.displacementmap,ls.fog,ls.lights,{emissive:{value:new ms(0)},specular:{value:new ms(1118481)},shininess:{value:30}}]),vertexShader:ho.meshphong_vert,fragmentShader:ho.meshphong_frag},standard:{uniforms:Bp([ls.common,ls.envmap,ls.aomap,ls.lightmap,ls.emissivemap,ls.bumpmap,ls.normalmap,ls.displacementmap,ls.roughnessmap,ls.metalnessmap,ls.fog,ls.lights,{emissive:{value:new ms(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ho.meshphysical_vert,fragmentShader:ho.meshphysical_frag},toon:{uniforms:Bp([ls.common,ls.aomap,ls.lightmap,ls.emissivemap,ls.bumpmap,ls.normalmap,ls.displacementmap,ls.gradientmap,ls.fog,ls.lights,{emissive:{value:new ms(0)}}]),vertexShader:ho.meshtoon_vert,fragmentShader:ho.meshtoon_frag},matcap:{uniforms:Bp([ls.common,ls.bumpmap,ls.normalmap,ls.displacementmap,ls.fog,{matcap:{value:null}}]),vertexShader:ho.meshmatcap_vert,fragmentShader:ho.meshmatcap_frag},points:{uniforms:Bp([ls.points,ls.fog]),vertexShader:ho.points_vert,fragmentShader:ho.points_frag},dashed:{uniforms:Bp([ls.common,ls.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ho.linedashed_vert,fragmentShader:ho.linedashed_frag},depth:{uniforms:Bp([ls.common,ls.displacementmap]),vertexShader:ho.depth_vert,fragmentShader:ho.depth_frag},normal:{uniforms:Bp([ls.common,ls.bumpmap,ls.normalmap,ls.displacementmap,{opacity:{value:1}}]),vertexShader:ho.meshnormal_vert,fragmentShader:ho.meshnormal_frag},sprite:{uniforms:Bp([ls.sprite,ls.fog]),vertexShader:ho.sprite_vert,fragmentShader:ho.sprite_frag},background:{uniforms:{uvTransform:{value:new ju},t2D:{value:null},flipX:{value:!1},flipY:{value:!1}},vertexShader:ho.background_vert,fragmentShader:ho.background_frag},cube:{uniforms:Bp([ls.envmap,{opacity:{value:1}}]),vertexShader:ho.cube_vert,fragmentShader:ho.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ho.equirect_vert,fragmentShader:ho.equirect_frag},distanceRGBA:{uniforms:Bp([ls.common,ls.displacementmap,{referencePosition:{value:new Mr},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ho.distanceRGBA_vert,fragmentShader:ho.distanceRGBA_frag},shadow:{uniforms:Bp([ls.lights,ls.fog,{color:{value:new ms(0)},opacity:{value:1}}]),vertexShader:ho.shadow_vert,fragmentShader:ho.shadow_frag}};function mP(wt,_,st,at,lt,ft){const vt=new ms(0);let At,Ct,Tt=lt===!0?0:1,Ot=null,Ut=0,Lt=null;function Gt(Xt,Qt){st.buffers.color.setClear(Xt.r,Xt.g,Xt.b,Qt,ft)}return{getClearColor:function(){return vt},setClearColor:function(Xt,Qt=1){vt.set(Xt),Tt=Qt,Gt(vt,Tt)},getClearAlpha:function(){return Tt},setClearAlpha:function(Xt){Tt=Xt,Gt(vt,Tt)},getPlaneMesh:function(){return At},getBoxMesh:function(){return Ct},getBoxMesh2:function(){return Ct===void 0&&(Ct=new Hu(new Zm(1,1,1),new Tv({name:"BackgroundCubeMaterial",uniforms:H0(mm.cube.uniforms),vertexShader:mm.cube.vertexShader,fragmentShader:mm.cube.fragmentShader,side:Yt,depthTest:!1,depthWrite:!1,fog:!1})),Ct.geometry.deleteAttribute("normal"),Ct.geometry.deleteAttribute("uv"),Ct.onBeforeRender=function(Xt,Qt,lr){this.matrixWorld.copyPosition(lr.matrixWorld)},Object.defineProperty(Ct.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),at.update(Ct)),Ct},render:function(Xt,Qt){let lr=!1,ur=Qt.isScene===!0?Qt.background:null;ur&&ur.isTexture&&(ur=_.get(ur));const cr=wt.xr,gr=cr.getSession&&cr.getSession();gr&&gr.environmentBlendMode==="additive"&&(ur=null),ur===null?Gt(vt,Tt):ur&&ur.isColor&&(Gt(ur,1),lr=!0),(wt.autoClear||lr)&&wt.clear(wt.autoClearColor,wt.autoClearDepth,wt.autoClearStencil),ur&&(ur.isCubeTexture||ur.mapping===eu)?(Ct===void 0&&(Ct=new Hu(new Zm(1,1,1),new Tv({name:"BackgroundCubeMaterial",uniforms:H0(mm.cube.uniforms),vertexShader:mm.cube.vertexShader,fragmentShader:mm.cube.fragmentShader,side:Yt,depthTest:!1,depthWrite:!1,fog:!1})),Ct.geometry.deleteAttribute("normal"),Ct.geometry.deleteAttribute("uv"),Ct.onBeforeRender=function(wr,Er,Cr){this.matrixWorld.copyPosition(Cr.matrixWorld)},Object.defineProperty(Ct.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),at.update(Ct)),Ct.material.uniforms.envMap.value=ur,Ct.material.uniforms.envMapRotation.value=ur.rotation||0,Ct.material.uniforms.flipEnvMap.value=ur.isCubeTexture&&ur.isRenderTargetTexture===!1?-1:1,Ot===ur&&Ut===ur.version&&Lt===wt.toneMapping||(Ct.material.needsUpdate=!0,Ot=ur,Ut=ur.version,Lt=wt.toneMapping),Ct.layers.enableAll(),Xt.unshift(Ct,Ct.geometry,Ct.material,0,0,null)):ur&&ur.isTexture&&(At===void 0&&(At=new Hu(new Y0(2,2),new Tv({name:"BackgroundMaterial",uniforms:H0(mm.background.uniforms),vertexShader:mm.background.vertexShader,fragmentShader:mm.background.fragmentShader,side:rr,depthTest:!1,depthWrite:!1,fog:!1})),At.geometry.deleteAttribute("normal"),Object.defineProperty(At.material,"map",{get:function(){return this.uniforms.t2D.value}}),at.update(At)),At.material.uniforms.t2D.value=ur,At.material.uniforms.flipX.value=ur.userData.flipX||!1,At.material.uniforms.flipY.value=ur.userData.flipY||!1,ur.matrixAutoUpdate===!0&&ur.updateMatrix(),At.material.uniforms.uvTransform.value.copy(ur.matrix),Ot===ur&&Ut===ur.version&&Lt===wt.toneMapping||(At.material.needsUpdate=!0,Ot=ur,Ut=ur.version,Lt=wt.toneMapping),At.layers.enableAll(),Xt.unshift(At,At.geometry,At.material,0,0,null))}}}function gP(wt,_,st,at){const lt=wt.getParameter(34921),ft=at.isWebGL2?null:_.get("OES_vertex_array_object"),vt=at.isWebGL2||ft!==null,At={},Ct=Gt(null);let Tt=Ct,Ot=!1;function Ut(Er){return at.isWebGL2?wt.bindVertexArray(Er):ft.bindVertexArrayOES(Er)}function Lt(Er){return at.isWebGL2?wt.deleteVertexArray(Er):ft.deleteVertexArrayOES(Er)}function Gt(Er){const Cr=[],zr=[],Gr=[];for(let on=0;on<lt;on++)Cr[on]=0,zr[on]=0,Gr[on]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Cr,enabledAttributes:zr,attributeDivisors:Gr,object:Er,attributes:{},index:null}}function Xt(){const Er=Tt.newAttributes;for(let Cr=0,zr=Er.length;Cr<zr;Cr++)Er[Cr]=0}function Qt(Er){lr(Er,0)}function lr(Er,Cr){const zr=Tt.newAttributes,Gr=Tt.enabledAttributes,on=Tt.attributeDivisors;zr[Er]=1,Gr[Er]===0&&(wt.enableVertexAttribArray(Er),Gr[Er]=1),on[Er]!==Cr&&((at.isWebGL2?wt:_.get("ANGLE_instanced_arrays"))[at.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Er,Cr),on[Er]=Cr)}function ur(){const Er=Tt.newAttributes,Cr=Tt.enabledAttributes;for(let zr=0,Gr=Cr.length;zr<Gr;zr++)Cr[zr]!==Er[zr]&&(wt.disableVertexAttribArray(zr),Cr[zr]=0)}function cr(Er,Cr,zr,Gr,on,ln){at.isWebGL2!==!0||zr!==5124&&zr!==5125?wt.vertexAttribPointer(Er,Cr,zr,Gr,on,ln):wt.vertexAttribIPointer(Er,Cr,zr,on,ln)}function gr(){wr(),Ot=!0,Tt!==Ct&&(Tt=Ct,Ut(Tt.object))}function wr(){Ct.geometry=null,Ct.program=null,Ct.wireframe=!1}return{setup:function(Er,Cr,zr,Gr,on){let ln=!1;if(vt){const Wr=function(Bn,Hn,Pn){const es=Pn.wireframe===!0;let ts=At[Bn.id];ts===void 0&&(ts={},At[Bn.id]=ts);let bn=ts[Hn.id];bn===void 0&&(bn={},ts[Hn.id]=bn);let Sn=bn[es];return Sn===void 0&&(Sn=Gt(at.isWebGL2?wt.createVertexArray():ft.createVertexArrayOES()),bn[es]=Sn),Sn}(Gr,zr,Cr);Tt!==Wr&&(Tt=Wr,Ut(Tt.object)),ln=function(Bn,Hn,Pn,es){const ts=Tt.attributes,bn=Hn.attributes;let Sn=0;const Kn=Pn.getAttributes();for(const kn in Kn)if(Kn[kn].location>=0){const Zn=ts[kn];let Rs=bn[kn];if(Rs===void 0&&(kn==="instanceMatrix"&&Bn.instanceMatrix&&(Rs=Bn.instanceMatrix),kn==="instanceColor"&&Bn.instanceColor&&(Rs=Bn.instanceColor)),Zn===void 0||Zn.attribute!==Rs||Rs&&Zn.data!==Rs.data)return!0;Sn++}return Tt.attributesNum!==Sn||Tt.index!==es}(Er,Gr,zr,on),ln&&function(Bn,Hn,Pn,es){const ts={},bn=Hn.attributes;let Sn=0;const Kn=Pn.getAttributes();for(const kn in Kn)if(Kn[kn].location>=0){let Zn=bn[kn];Zn===void 0&&(kn==="instanceMatrix"&&Bn.instanceMatrix&&(Zn=Bn.instanceMatrix),kn==="instanceColor"&&Bn.instanceColor&&(Zn=Bn.instanceColor));const Rs={};Rs.attribute=Zn,Zn&&Zn.data&&(Rs.data=Zn.data),ts[kn]=Rs,Sn++}Tt.attributes=ts,Tt.attributesNum=Sn,Tt.index=es}(Er,Gr,zr,on)}else{const Wr=Cr.wireframe===!0;Tt.geometry===Gr.id&&Tt.program===zr.id&&Tt.wireframe===Wr||(Tt.geometry=Gr.id,Tt.program=zr.id,Tt.wireframe=Wr,ln=!0)}on!==null&&st.update(on,34963),(ln||Ot)&&(Ot=!1,function(Wr,Bn,Hn,Pn){if(at.isWebGL2===!1&&(Wr.isInstancedMesh||Pn.isInstancedBufferGeometry)&&_.get("ANGLE_instanced_arrays")===null)return;Xt();const es=Pn.attributes,ts=Hn.getAttributes(),bn=Bn.defaultAttributeValues;for(const Sn in ts){const Kn=ts[Sn];if(Kn.location>=0){let kn=es[Sn];if(kn===void 0&&(Sn==="instanceMatrix"&&Wr.instanceMatrix&&(kn=Wr.instanceMatrix),Sn==="instanceColor"&&Wr.instanceColor&&(kn=Wr.instanceColor)),kn!==void 0){const Zn=kn.normalized,Rs=kn.itemSize,wo=st.get(kn);if(wo===void 0)continue;const Ds=wo.buffer,fo=wo.type,Fr=wo.bytesPerElement;if(kn.isInterleavedBufferAttribute){const Br=kn.data,fn=Br.stride,rn=kn.offset;if(Br.isInstancedInterleavedBuffer){for(let Ur=0;Ur<Kn.locationSize;Ur++)lr(Kn.location+Ur,Br.meshPerAttribute);Wr.isInstancedMesh!==!0&&Pn._maxInstanceCount===void 0&&(Pn._maxInstanceCount=Br.meshPerAttribute*Br.count)}else for(let Ur=0;Ur<Kn.locationSize;Ur++)Qt(Kn.location+Ur);wt.bindBuffer(34962,Ds);for(let Ur=0;Ur<Kn.locationSize;Ur++)cr(Kn.location+Ur,Rs/Kn.locationSize,fo,Zn,fn*Fr,(rn+Rs/Kn.locationSize*Ur)*Fr)}else{if(kn.isInstancedBufferAttribute){for(let Br=0;Br<Kn.locationSize;Br++)lr(Kn.location+Br,kn.meshPerAttribute);Wr.isInstancedMesh!==!0&&Pn._maxInstanceCount===void 0&&(Pn._maxInstanceCount=kn.meshPerAttribute*kn.count)}else for(let Br=0;Br<Kn.locationSize;Br++)Qt(Kn.location+Br);wt.bindBuffer(34962,Ds);for(let Br=0;Br<Kn.locationSize;Br++)cr(Kn.location+Br,Rs/Kn.locationSize,fo,Zn,Rs*Fr,Rs/Kn.locationSize*Br*Fr)}}else if(bn!==void 0){const Zn=bn[Sn];if(Zn!==void 0)switch(Zn.length){case 2:wt.vertexAttrib2fv(Kn.location,Zn);break;case 3:wt.vertexAttrib3fv(Kn.location,Zn);break;case 4:wt.vertexAttrib4fv(Kn.location,Zn);break;default:wt.vertexAttrib1fv(Kn.location,Zn)}}}}ur()}(Er,Cr,zr,Gr),on!==null&&wt.bindBuffer(34963,st.get(on).buffer))},reset:gr,resetDefaultState:wr,dispose:function(){gr();for(const Er in At){const Cr=At[Er];for(const zr in Cr){const Gr=Cr[zr];for(const on in Gr)Lt(Gr[on].object),delete Gr[on];delete Cr[zr]}delete At[Er]}},releaseStatesOfGeometry:function(Er){if(At[Er.id]===void 0)return;const Cr=At[Er.id];for(const zr in Cr){const Gr=Cr[zr];for(const on in Gr)Lt(Gr[on].object),delete Gr[on];delete Cr[zr]}delete At[Er.id]},releaseStatesOfProgram:function(Er){for(const Cr in At){const zr=At[Cr];if(zr[Er.id]===void 0)continue;const Gr=zr[Er.id];for(const on in Gr)Lt(Gr[on].object),delete Gr[on];delete zr[Er.id]}},initAttributes:Xt,enableAttribute:Qt,disableUnusedAttributes:ur}}function QT(wt,_,st,at){const lt=at.isWebGL2;let ft;this.setMode=function(vt){ft=vt},this.render=function(vt,At){wt.drawArrays(ft,vt,At),st.update(At,ft,1)},this.renderInstances=function(vt,At,Ct){if(Ct===0)return;let Tt,Ot;if(lt)Tt=wt,Ot="drawArraysInstanced";else if(Tt=_.get("ANGLE_instanced_arrays"),Ot="drawArraysInstancedANGLE",Tt===null)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");Tt[Ot](ft,vt,At,Ct),st.update(At,ft,Ct)}}function HT(wt,_,st){let at;function lt(wr){if(wr==="highp"){if(wt.getShaderPrecisionFormat(35633,36338).precision>0&&wt.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";wr="mediump"}return wr==="mediump"&&wt.getShaderPrecisionFormat(35633,36337).precision>0&&wt.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const ft=typeof WebGL2RenderingContext<"u"&&wt instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&wt instanceof WebGL2ComputeRenderingContext;let vt=st.precision!==void 0?st.precision:"highp";const At=lt(vt);At!==vt&&(console.warn("THREE.WebGLRenderer:",vt,"not supported, using",At,"instead."),vt=At);const Ct=ft||_.has("WEBGL_draw_buffers"),Tt=st.logarithmicDepthBuffer===!0,Ot=wt.getParameter(34930),Ut=wt.getParameter(35660),Lt=wt.getParameter(3379),Gt=wt.getParameter(34076),Xt=wt.getParameter(34921),Qt=wt.getParameter(36347),lr=wt.getParameter(36348),ur=wt.getParameter(36349),cr=Ut>0,gr=ft||_.has("OES_texture_float");return{isWebGL2:ft,drawBuffers:Ct,getMaxAnisotropy:function(){if(at!==void 0)return at;if(_.has("EXT_texture_filter_anisotropic")===!0){const wr=_.get("EXT_texture_filter_anisotropic");at=wt.getParameter(wr.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else at=0;return at},getMaxPrecision:lt,precision:vt,logarithmicDepthBuffer:Tt,maxTextures:Ot,maxVertexTextures:Ut,maxTextureSize:Lt,maxCubemapSize:Gt,maxAttributes:Xt,maxVertexUniforms:Qt,maxVaryings:lr,maxFragmentUniforms:ur,vertexTextures:cr,floatFragmentTextures:gr,floatVertexTextures:cr&&gr,maxSamples:ft?wt.getParameter(36183):0}}function vP(wt){const _=this;let st=null,at=0,lt=!1,ft=!1;const vt=new X_,At=new ju,Ct={value:null,needsUpdate:!1};function Tt(){Ct.value!==st&&(Ct.value=st,Ct.needsUpdate=at>0),_.numPlanes=at,_.numIntersection=0}function Ot(Ut,Lt,Gt,Xt){const Qt=Ut!==null?Ut.length:0;let lr=null;if(Qt!==0){if(lr=Ct.value,Xt!==!0||lr===null){const ur=Gt+4*Qt,cr=Lt.matrixWorldInverse;At.getNormalMatrix(cr),(lr===null||lr.length<ur)&&(lr=new Float32Array(ur));for(let gr=0,wr=Gt;gr!==Qt;++gr,wr+=4)vt.copy(Ut[gr]).applyMatrix4(cr,At),vt.normal.toArray(lr,wr),lr[wr+3]=vt.constant}Ct.value=lr,Ct.needsUpdate=!0}return _.numPlanes=Qt,_.numIntersection=0,lr}this.uniform=Ct,this.numPlanes=0,this.numIntersection=0,this.init=function(Ut,Lt,Gt){const Xt=Ut.length!==0||Lt||at!==0||lt;return lt=Lt,st=Ot(Ut,Gt,0),at=Ut.length,Xt},this.beginShadows=function(){ft=!0,Ot(null)},this.endShadows=function(){ft=!1,Tt()},this.setState=function(Ut,Lt,Gt){const Xt=Ut.clippingPlanes,Qt=Ut.clipIntersection,lr=Ut.clipShadows,ur=wt.get(Ut);if(!lt||Xt===null||Xt.length===0||ft&&!lr)ft?Ot(null):Tt();else{const cr=ft?0:at,gr=4*cr;let wr=ur.clippingState||null;Ct.value=wr,wr=Ot(Xt,Lt,gr,Gt);for(let Er=0;Er!==gr;++Er)wr[Er]=st[Er];ur.clippingState=wr,this.numIntersection=Qt?this.numPlanes:0,this.numPlanes+=cr}}}function _P(wt){let _=new WeakMap;function st(lt,ft){return ft===Lo?lt.mapping=Vo:ft===No&&(lt.mapping=Oo),lt}function at(lt){const ft=lt.target;ft.removeEventListener("dispose",at);const vt=_.get(ft);vt!==void 0&&(_.delete(ft),vt.dispose())}return{get:function(lt){if(lt&&lt.isTexture&&lt.isRenderTargetTexture===!1){const ft=lt.mapping;if(ft===Lo||ft===No){if(_.has(lt)){const vt=_.get(lt).texture;return vt.rotation=lt.rotation,st(vt,lt.mapping)}{const vt=lt.image;if(vt&&vt.height>0){const At=new GT(vt.height/2);return At.fromEquirectangularTexture(wt,lt),At.texture.rotation=lt.rotation,_.set(lt,At),lt.addEventListener("dispose",at),st(At.texture,lt.mapping)}return null}}}return lt},dispose:function(){_=new WeakMap}}}mm.physical={uniforms:Bp([mm.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Vn(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new ms(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Vn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new ms(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new ms(1,1,1)},specularColorMap:{value:null}}]),vertexShader:ho.meshphysical_vert,fragmentShader:ho.meshphysical_frag};class Ox extends HA{constructor(_=-1,st=1,at=1,lt=-1,ft=.1,vt=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=_,this.right=st,this.top=at,this.bottom=lt,this.near=ft,this.far=vt,this.updateProjectionMatrix()}copy(_,st){return super.copy(_,st),this.left=_.left,this.right=_.right,this.top=_.top,this.bottom=_.bottom,this.near=_.near,this.far=_.far,this.zoom=_.zoom,this.view=_.view===null?null:Object.assign({},_.view),this}setViewOffset(_,st,at,lt,ft,vt){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_,this.view.fullHeight=st,this.view.offsetX=at,this.view.offsetY=lt,this.view.width=ft,this.view.height=vt,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _=(this.right-this.left)/(2*this.zoom),st=(this.top-this.bottom)/(2*this.zoom),at=(this.right+this.left)/2,lt=(this.top+this.bottom)/2;let ft=at-_,vt=at+_,At=lt+st,Ct=lt-st;if(this.view!==null&&this.view.enabled){const Tt=(this.right-this.left)/this.view.fullWidth/this.zoom,Ot=(this.top-this.bottom)/this.view.fullHeight/this.zoom;ft+=Tt*this.view.offsetX,vt=ft+Tt*this.view.width,At-=Ot*this.view.offsetY,Ct=At-Ot*this.view.height}this.projectionMatrix.makeOrthographic(ft,vt,At,Ct,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_){const st=super.toJSON(_);return st.object.zoom=this.zoom,st.object.left=this.left,st.object.right=this.right,st.object.top=this.top,st.object.bottom=this.bottom,st.object.near=this.near,st.object.far=this.far,this.view!==null&&(st.object.view=Object.assign({},this.view)),st}}const qT=[.125,.215,.35,.446,.526,.582],Lx=new Ox,Nx=new ms;let Fx=null;const c_=(1+Math.sqrt(5))/2,qy=1/c_,VS=[new Mr(1,1,1),new Mr(-1,1,1),new Mr(1,1,-1),new Mr(-1,1,-1),new Mr(0,c_,qy),new Mr(0,c_,-qy),new Mr(qy,0,c_),new Mr(-qy,0,c_),new Mr(c_,qy,0),new Mr(-c_,qy,0)];class Ux{constructor(_){this._renderer=_,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(_,st=0,at=.1,lt=100){Fx=this._renderer.getRenderTarget(),this._setSize(256);const ft=this._allocateTargets();return ft.depthBuffer=!0,this._sceneToCubeUV(_,at,lt,ft),st>0&&this._blur(ft,0,0,st),this._applyPMREM(ft),this._cleanup(ft),ft}fromEquirectangular(_,st=null){return this._fromTexture(_,st)}fromCubemap(_,st=null){return this._fromTexture(_,st)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=GS(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=$x(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(_){this._lodMax=Math.floor(Math.log2(_)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let _=0;_<this._lodPlanes.length;_++)this._lodPlanes[_].dispose()}_cleanup(_){this._renderer.setRenderTarget(Fx),_.scissorTest=!1,mo(_,0,0,_.width,_.height)}_fromTexture(_,st){_.mapping===Vo||_.mapping===Oo?this._setSize(_.image.length===0?16:_.image[0].width||_.image[0].image.width):this._setSize(_.image.width/4),Fx=this._renderer.getRenderTarget();const at=st||this._allocateTargets();return this._textureToCubeUV(_,at),this._applyPMREM(at),this._cleanup(at),at}_allocateTargets(){const _=3*Math.max(this._cubeSize,112),st=4*this._cubeSize,at={magFilter:Ko,minFilter:Ko,generateMipmaps:!1,type:_d,format:Ps,encoding:Sm,depthBuffer:!1},lt=WT(_,st,at);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==_){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=WT(_,st,at);const{_lodMax:ft}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(vt){const At=[],Ct=[],Tt=[];let Ot=vt;const Ut=vt-4+1+qT.length;for(let Lt=0;Lt<Ut;Lt++){const Gt=Math.pow(2,Ot);Ct.push(Gt);let Xt=1/Gt;Lt>vt-4?Xt=qT[Lt-vt+4-1]:Lt===0&&(Xt=0),Tt.push(Xt);const Qt=1/(Gt-2),lr=-Qt,ur=1+Qt,cr=[lr,lr,ur,lr,ur,ur,lr,lr,ur,ur,lr,ur],gr=6,wr=6,Er=3,Cr=2,zr=1,Gr=new Float32Array(Er*wr*gr),on=new Float32Array(Cr*wr*gr),ln=new Float32Array(zr*wr*gr);for(let Bn=0;Bn<gr;Bn++){const Hn=Bn%3*2/3-1,Pn=Bn>2?0:-1,es=[Hn,Pn,0,Hn+2/3,Pn,0,Hn+2/3,Pn+1,0,Hn,Pn,0,Hn+2/3,Pn+1,0,Hn,Pn+1,0];Gr.set(es,Er*wr*Bn),on.set(cr,Cr*wr*Bn);const ts=[Bn,Bn,Bn,Bn,Bn,Bn];ln.set(ts,zr*wr*Bn)}const Wr=new xs;Wr.setAttribute("position",new El(Gr,Er)),Wr.setAttribute("uv",new El(on,Cr)),Wr.setAttribute("faceIndex",new El(ln,zr)),At.push(Wr),Ot>4&&Ot--}return{lodPlanes:At,sizeLods:Ct,sigmas:Tt}}(ft)),this._blurMaterial=function(vt,At,Ct){const Tt=new Float32Array(20),Ot=new Mr(0,1,0);return new Tv({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/At,CUBEUV_TEXEL_HEIGHT:1/Ct,CUBEUV_MAX_MIP:`${vt}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:Tt},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:Ot}},vertexShader:`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`,fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ft,depthTest:!1,depthWrite:!1})}(ft,_,st)}return lt}_compileMaterial(_){const st=new Hu(this._lodPlanes[0],_);this._renderer.compile(st,Lx)}_sceneToCubeUV(_,st,at,lt){const ft=new op(90,1,st,at),vt=[1,-1,1,1,1,1],At=[1,1,1,-1,-1,-1],Ct=this._renderer,Tt=Ct.autoClear,Ot=Ct.toneMapping;Ct.getClearColor(Nx),Ct.toneMapping=Vs,Ct.autoClear=!1;const Ut=new Jm({name:"PMREM.Background",side:Yt,depthWrite:!1,depthTest:!1}),Lt=new Hu(new Zm,Ut);let Gt=!1;const Xt=_.background;Xt?Xt.isColor&&(Ut.color.copy(Xt),_.background=null,Gt=!0):(Ut.color.copy(Nx),Gt=!0);for(let Qt=0;Qt<6;Qt++){const lr=Qt%3;lr===0?(ft.up.set(0,vt[Qt],0),ft.lookAt(At[Qt],0,0)):lr===1?(ft.up.set(0,0,vt[Qt]),ft.lookAt(0,At[Qt],0)):(ft.up.set(0,vt[Qt],0),ft.lookAt(0,0,At[Qt]));const ur=this._cubeSize;mo(lt,lr*ur,Qt>2?ur:0,ur,ur),Ct.setRenderTarget(lt),Gt&&Ct.render(Lt,ft),Ct.render(_,ft)}Lt.geometry.dispose(),Lt.material.dispose(),Ct.toneMapping=Ot,Ct.autoClear=Tt,_.background=Xt}_textureToCubeUV(_,st){const at=this._renderer,lt=_.mapping===Vo||_.mapping===Oo;lt?(this._cubemapMaterial===null&&(this._cubemapMaterial=GS()),this._cubemapMaterial.uniforms.flipEnvMap.value=_.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=$x());const ft=lt?this._cubemapMaterial:this._equirectMaterial,vt=new Hu(this._lodPlanes[0],ft);ft.uniforms.envMap.value=_;const At=this._cubeSize;mo(st,0,0,3*At,2*At),at.setRenderTarget(st),at.render(vt,Lx)}_applyPMREM(_){const st=this._renderer,at=st.autoClear;st.autoClear=!1;for(let lt=1;lt<this._lodPlanes.length;lt++){const ft=Math.sqrt(this._sigmas[lt]*this._sigmas[lt]-this._sigmas[lt-1]*this._sigmas[lt-1]),vt=VS[(lt-1)%VS.length];this._blur(_,lt-1,lt,ft,vt)}st.autoClear=at}_blur(_,st,at,lt,ft){const vt=this._pingPongRenderTarget;this._halfBlur(_,vt,st,at,lt,"latitudinal",ft),this._halfBlur(vt,_,at,at,lt,"longitudinal",ft)}_halfBlur(_,st,at,lt,ft,vt,At){const Ct=this._renderer,Tt=this._blurMaterial;vt!=="latitudinal"&&vt!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const Ot=new Hu(this._lodPlanes[lt],Tt),Ut=Tt.uniforms,Lt=this._sizeLods[at]-1,Gt=isFinite(ft)?Math.PI/(2*Lt):2*Math.PI/39,Xt=ft/Gt,Qt=isFinite(ft)?1+Math.floor(3*Xt):20;Qt>20&&console.warn(`sigmaRadians, ${ft}, is too large and will clip, as it requested ${Qt} samples when the maximum is set to 20`);const lr=[];let ur=0;for(let wr=0;wr<20;++wr){const Er=wr/Xt,Cr=Math.exp(-Er*Er/2);lr.push(Cr),wr===0?ur+=Cr:wr<Qt&&(ur+=2*Cr)}for(let wr=0;wr<lr.length;wr++)lr[wr]=lr[wr]/ur;Ut.envMap.value=_.texture,Ut.samples.value=Qt,Ut.weights.value=lr,Ut.latitudinal.value=vt==="latitudinal",At&&(Ut.poleAxis.value=At);const{_lodMax:cr}=this;Ut.dTheta.value=Gt,Ut.mipInt.value=cr-at;const gr=this._sizeLods[lt];mo(st,3*gr*(lt>cr-4?lt-cr+4:0),4*(this._cubeSize-gr),3*gr,2*gr),Ct.setRenderTarget(st),Ct.render(Ot,Lx)}}function WT(wt,_,st){const at=new Ip(wt,_,st);return at.texture.mapping=eu,at.texture.name="PMREM.cubeUv",at.scissorTest=!0,at}function mo(wt,_,st,at,lt){wt.viewport.set(_,st,at,lt),wt.scissor.set(_,st,at,lt)}function $x(){return new Tv({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`,fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ft,depthTest:!1,depthWrite:!1})}function GS(){return new Tv({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`,fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ft,depthTest:!1,depthWrite:!1})}function YT(wt){let _=new WeakMap,st=null;function at(lt){const ft=lt.target;ft.removeEventListener("dispose",at);const vt=_.get(ft);vt!==void 0&&(_.delete(ft),vt.dispose())}return{get:function(lt){if(lt&&lt.isTexture){const ft=lt.mapping,vt=ft===Lo||ft===No,At=ft===Vo||ft===Oo;if(vt||At){if(lt.isRenderTargetTexture&&lt.needsPMREMUpdate===!0){lt.needsPMREMUpdate=!1;let Ct=_.get(lt);return st===null&&(st=new Ux(wt)),Ct=vt?st.fromEquirectangular(lt,Ct):st.fromCubemap(lt,Ct),_.set(lt,Ct),Ct.texture}if(_.has(lt))return _.get(lt).texture;{const Ct=lt.image;if(vt&&Ct&&Ct.height>0||At&&Ct&&function(Tt){let Ot=0;for(let Ut=0;Ut<6;Ut++)Tt[Ut]!==void 0&&Ot++;return Ot===6}(Ct)){st===null&&(st=new Ux(wt));const Tt=vt?st.fromEquirectangular(lt):st.fromCubemap(lt);return _.set(lt,Tt),lt.addEventListener("dispose",at),Tt.texture}return null}}}return lt},dispose:function(){_=new WeakMap,st!==null&&(st.dispose(),st=null)}}}function os(wt){const _={};function st(at){if(_[at]!==void 0)return _[at];let lt;switch(at){case"WEBGL_depth_texture":lt=wt.getExtension("WEBGL_depth_texture")||wt.getExtension("MOZ_WEBGL_depth_texture")||wt.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":lt=wt.getExtension("EXT_texture_filter_anisotropic")||wt.getExtension("MOZ_EXT_texture_filter_anisotropic")||wt.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":lt=wt.getExtension("WEBGL_compressed_texture_s3tc")||wt.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||wt.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":lt=wt.getExtension("WEBGL_compressed_texture_pvrtc")||wt.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:lt=wt.getExtension(at)}return _[at]=lt,lt}return{has:function(at){return st(at)!==null},init:function(at){at.isWebGL2?st("EXT_color_buffer_float"):(st("WEBGL_depth_texture"),st("OES_texture_float"),st("OES_texture_half_float"),st("OES_texture_half_float_linear"),st("OES_standard_derivatives"),st("OES_element_index_uint"),st("OES_vertex_array_object"),st("ANGLE_instanced_arrays")),st("OES_texture_float_linear"),st("EXT_color_buffer_half_float"),st("WEBGL_multisampled_render_to_texture")},get:function(at){const lt=st(at);return lt===null&&console.warn("THREE.WebGLRenderer: "+at+" extension not supported."),lt}}}function io(wt,_,st,at){const lt={},ft=new WeakMap;function vt(Ct){const Tt=Ct.target;Tt.index!==null&&_.remove(Tt.index);for(const Ut in Tt.attributes)_.remove(Tt.attributes[Ut]);Tt.removeEventListener("dispose",vt),delete lt[Tt.id];const Ot=ft.get(Tt);Ot&&(_.remove(Ot),ft.delete(Tt)),at.releaseStatesOfGeometry(Tt),Tt.isInstancedBufferGeometry===!0&&delete Tt._maxInstanceCount,st.memory.geometries--}function At(Ct){const Tt=[],Ot=Ct.index,Ut=Ct.attributes.position;let Lt=0;if(Ot!==null){const Qt=Ot.array;Lt=Ot.version;for(let lr=0,ur=Qt.length;lr<ur;lr+=3){const cr=Qt[lr+0],gr=Qt[lr+1],wr=Qt[lr+2];Tt.push(cr,gr,gr,wr,wr,cr)}}else{const Qt=Ut.array;Lt=Ut.version;for(let lr=0,ur=Qt.length/3-1;lr<ur;lr+=3){const cr=lr+0,gr=lr+1,wr=lr+2;Tt.push(cr,gr,gr,wr,wr,cr)}}const Gt=new(Ix(Tt)?Dt:Xl)(Tt,1);Gt.version=Lt;const Xt=ft.get(Ct);Xt&&_.remove(Xt),ft.set(Ct,Gt)}return{get:function(Ct,Tt){return lt[Tt.id]===!0||(Tt.addEventListener("dispose",vt),lt[Tt.id]=!0,st.memory.geometries++),Tt},update:function(Ct){const Tt=Ct.attributes;for(const Ut in Tt)_.update(Tt[Ut],34962);const Ot=Ct.morphAttributes;for(const Ut in Ot){const Lt=Ot[Ut];for(let Gt=0,Xt=Lt.length;Gt<Xt;Gt++)_.update(Lt[Gt],34962)}},getWireframeAttribute:function(Ct){const Tt=ft.get(Ct);if(Tt){const Ot=Ct.index;Ot!==null&&Tt.version<Ot.version&&At(Ct)}else At(Ct);return ft.get(Ct)}}}function YA(wt,_,st,at){const lt=at.isWebGL2;let ft,vt,At;this.setMode=function(Ct){ft=Ct},this.setIndex=function(Ct){vt=Ct.type,At=Ct.bytesPerElement},this.render=function(Ct,Tt){wt.drawElements(ft,Tt,vt,Ct*At),st.update(Tt,ft,1)},this.renderInstances=function(Ct,Tt,Ot){if(Ot===0)return;let Ut,Lt;if(lt)Ut=wt,Lt="drawElementsInstanced";else if(Ut=_.get("ANGLE_instanced_arrays"),Lt="drawElementsInstancedANGLE",Ut===null)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");Ut[Lt](ft,Tt,vt,Ct*At,Ot),st.update(Tt,ft,Ot)}}function Mv(wt){const _={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:_,programs:null,autoReset:!0,reset:function(){_.frame++,_.calls=0,_.triangles=0,_.points=0,_.lines=0},update:function(st,at,lt){switch(_.calls++,at){case 4:_.triangles+=lt*(st/3);break;case 1:_.lines+=lt*(st/2);break;case 3:_.lines+=lt*(st-1);break;case 2:_.lines+=lt*st;break;case 0:_.points+=lt*st;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",at)}}}}function QS(wt,_){return wt[0]-_[0]}function HS(wt,_){return Math.abs(_[1])-Math.abs(wt[1])}function KT(wt,_,st){const at={},lt=new Float32Array(8),ft=new WeakMap,vt=new qo,At=[];for(let Ct=0;Ct<8;Ct++)At[Ct]=[Ct,0];return{update:function(Ct,Tt,Ot,Ut){const Lt=Ct.morphTargetInfluences;if(_.isWebGL2===!0){const Gt=Tt.morphAttributes.position||Tt.morphAttributes.normal||Tt.morphAttributes.color,Xt=Gt!==void 0?Gt.length:0;let Qt=ft.get(Tt);if(Qt===void 0||Qt.count!==Xt){Qt!==void 0&&Qt.texture.dispose();const cr=Tt.morphAttributes.position!==void 0,gr=Tt.morphAttributes.normal!==void 0,wr=Tt.morphAttributes.color!==void 0,Er=Tt.morphAttributes.position||[],Cr=Tt.morphAttributes.normal||[],zr=Tt.morphAttributes.color||[];let Gr=0;cr===!0&&(Gr=1),gr===!0&&(Gr=2),wr===!0&&(Gr=3);let on=Tt.attributes.position.count*Gr,ln=1;on>_.maxTextureSize&&(ln=Math.ceil(on/_.maxTextureSize),on=_.maxTextureSize);const Wr=new Float32Array(on*ln*4*Xt),Bn=new N0(Wr,on,ln,Xt);Bn.type=Cl,Bn.needsUpdate=!0;const Hn=4*Gr;for(let Pn=0;Pn<Xt;Pn++){const es=Er[Pn],ts=Cr[Pn],bn=zr[Pn],Sn=on*ln*4*Pn;for(let Kn=0;Kn<es.count;Kn++){const kn=Kn*Hn;cr===!0&&(vt.fromBufferAttribute(es,Kn),Wr[Sn+kn+0]=vt.x,Wr[Sn+kn+1]=vt.y,Wr[Sn+kn+2]=vt.z,Wr[Sn+kn+3]=0),gr===!0&&(vt.fromBufferAttribute(ts,Kn),Wr[Sn+kn+4]=vt.x,Wr[Sn+kn+5]=vt.y,Wr[Sn+kn+6]=vt.z,Wr[Sn+kn+7]=0),wr===!0&&(vt.fromBufferAttribute(bn,Kn),Wr[Sn+kn+8]=vt.x,Wr[Sn+kn+9]=vt.y,Wr[Sn+kn+10]=vt.z,Wr[Sn+kn+11]=bn.itemSize===4?vt.w:1)}}Qt={count:Xt,texture:Bn,size:new Vn(on,ln)},ft.set(Tt,Qt),Tt.addEventListener("dispose",function Pn(){Bn.dispose(),ft.delete(Tt),Tt.removeEventListener("dispose",Pn)})}let lr=0;for(let cr=0;cr<Lt.length;cr++)lr+=Lt[cr];const ur=Tt.morphTargetsRelative?1:1-lr;Ut.getUniforms().setValue(wt,"morphTargetBaseInfluence",ur),Ut.getUniforms().setValue(wt,"morphTargetInfluences",Lt),Ut.getUniforms().setValue(wt,"morphTargetsTexture",Qt.texture,st),Ut.getUniforms().setValue(wt,"morphTargetsTextureSize",Qt.size)}else{const Gt=Lt===void 0?0:Lt.length;let Xt=at[Tt.id];if(Xt===void 0||Xt.length!==Gt){Xt=[];for(let gr=0;gr<Gt;gr++)Xt[gr]=[gr,0];at[Tt.id]=Xt}for(let gr=0;gr<Gt;gr++){const wr=Xt[gr];wr[0]=gr,wr[1]=Lt[gr]}Xt.sort(HS);for(let gr=0;gr<8;gr++)gr<Gt&&Xt[gr][1]?(At[gr][0]=Xt[gr][0],At[gr][1]=Xt[gr][1]):(At[gr][0]=Number.MAX_SAFE_INTEGER,At[gr][1]=0);At.sort(QS);const Qt=Tt.morphAttributes.position,lr=Tt.morphAttributes.normal;let ur=0;for(let gr=0;gr<8;gr++){const wr=At[gr],Er=wr[0],Cr=wr[1];Er!==Number.MAX_SAFE_INTEGER&&Cr?(Qt&&Tt.getAttribute("morphTarget"+gr)!==Qt[Er]&&Tt.setAttribute("morphTarget"+gr,Qt[Er]),lr&&Tt.getAttribute("morphNormal"+gr)!==lr[Er]&&Tt.setAttribute("morphNormal"+gr,lr[Er]),lt[gr]=Cr,ur+=Cr):(Qt&&Tt.hasAttribute("morphTarget"+gr)===!0&&Tt.deleteAttribute("morphTarget"+gr),lr&&Tt.hasAttribute("morphNormal"+gr)===!0&&Tt.deleteAttribute("morphNormal"+gr),lt[gr]=0)}const cr=Tt.morphTargetsRelative?1:1-ur;Ut.getUniforms().setValue(wt,"morphTargetBaseInfluence",cr),Ut.getUniforms().setValue(wt,"morphTargetInfluences",lt)}}}}function Dl(wt,_,st,at){let lt=new WeakMap;function ft(vt){const At=vt.target;At.removeEventListener("dispose",ft),st.remove(At.instanceMatrix),At.instanceColor!==null&&st.remove(At.instanceColor)}return{update:function(vt){const At=at.render.frame,Ct=vt.geometry,Tt=_.get(vt,Ct);return lt.get(Tt)!==At&&(_.update(Tt),lt.set(Tt,At)),vt.isInstancedMesh&&(vt.hasEventListener("dispose",ft)===!1&&vt.addEventListener("dispose",ft),st.update(vt.instanceMatrix,34962),vt.instanceColor!==null&&st.update(vt.instanceColor,34962)),Tt},dispose:function(){lt=new WeakMap}}}const XT=new Cu,qS=new N0,WS=new G_,YS=new qA,JT=[],jx=[],KS=new Float32Array(16),_g=new Float32Array(9),Rv=new Float32Array(4);function KA(wt,_,st){const at=wt[0];if(at<=0||at>0)return wt;const lt=_*st;let ft=JT[lt];if(ft===void 0&&(ft=new Float32Array(lt),JT[lt]=ft),_!==0){at.toArray(ft,0);for(let vt=1,At=0;vt!==_;++vt)At+=st,wt[vt].toArray(ft,At)}return ft}function ap(wt,_){if(wt.length!==_.length)return!1;for(let st=0,at=wt.length;st<at;st++)if(wt[st]!==_[st])return!1;return!0}function hu(wt,_){for(let st=0,at=_.length;st<at;st++)wt[st]=_[st]}function Xw(wt,_){let st=jx[_];st===void 0&&(st=new Int32Array(_),jx[_]=st);for(let at=0;at!==_;++at)st[at]=wt.allocateTextureUnit();return st}function Jw(wt,_){const st=this.cache;st[0]!==_&&(wt.uniform1f(this.addr,_),st[0]=_)}function XS(wt,_){const st=this.cache;if(_.x!==void 0)st[0]===_.x&&st[1]===_.y||(wt.uniform2f(this.addr,_.x,_.y),st[0]=_.x,st[1]=_.y);else{if(ap(st,_))return;wt.uniform2fv(this.addr,_),hu(st,_)}}function Zw(wt,_){const st=this.cache;if(_.x!==void 0)st[0]===_.x&&st[1]===_.y&&st[2]===_.z||(wt.uniform3f(this.addr,_.x,_.y,_.z),st[0]=_.x,st[1]=_.y,st[2]=_.z);else if(_.r!==void 0)st[0]===_.r&&st[1]===_.g&&st[2]===_.b||(wt.uniform3f(this.addr,_.r,_.g,_.b),st[0]=_.r,st[1]=_.g,st[2]=_.b);else{if(ap(st,_))return;wt.uniform3fv(this.addr,_),hu(st,_)}}function ZT(wt,_){const st=this.cache;if(_.x!==void 0)st[0]===_.x&&st[1]===_.y&&st[2]===_.z&&st[3]===_.w||(wt.uniform4f(this.addr,_.x,_.y,_.z,_.w),st[0]=_.x,st[1]=_.y,st[2]=_.z,st[3]=_.w);else{if(ap(st,_))return;wt.uniform4fv(this.addr,_),hu(st,_)}}function JS(wt,_){const st=this.cache,at=_.elements;if(at===void 0){if(ap(st,_))return;wt.uniformMatrix2fv(this.addr,!1,_),hu(st,_)}else{if(ap(st,at))return;Rv.set(at),wt.uniformMatrix2fv(this.addr,!1,Rv),hu(st,at)}}function _p(wt,_){const st=this.cache,at=_.elements;if(at===void 0){if(ap(st,_))return;wt.uniformMatrix3fv(this.addr,!1,_),hu(st,_)}else{if(ap(st,at))return;_g.set(at),wt.uniformMatrix3fv(this.addr,!1,_g),hu(st,at)}}function Iv(wt,_){const st=this.cache,at=_.elements;if(at===void 0){if(ap(st,_))return;wt.uniformMatrix4fv(this.addr,!1,_),hu(st,_)}else{if(ap(st,at))return;KS.set(at),wt.uniformMatrix4fv(this.addr,!1,KS),hu(st,at)}}function e1(wt,_){const st=this.cache;st[0]!==_&&(wt.uniform1i(this.addr,_),st[0]=_)}function zx(wt,_){const st=this.cache;ap(st,_)||(wt.uniform2iv(this.addr,_),hu(st,_))}function Pv(wt,_){const st=this.cache;ap(st,_)||(wt.uniform3iv(this.addr,_),hu(st,_))}function ZS(wt,_){const st=this.cache;ap(st,_)||(wt.uniform4iv(this.addr,_),hu(st,_))}function Vx(wt,_){const st=this.cache;st[0]!==_&&(wt.uniform1ui(this.addr,_),st[0]=_)}function eM(wt,_){const st=this.cache;ap(st,_)||(wt.uniform2uiv(this.addr,_),hu(st,_))}function Gx(wt,_){const st=this.cache;ap(st,_)||(wt.uniform3uiv(this.addr,_),hu(st,_))}function Dv(wt,_){const st=this.cache;ap(st,_)||(wt.uniform4uiv(this.addr,_),hu(st,_))}function Dm(wt,_,st){const at=this.cache,lt=st.allocateTextureUnit();at[0]!==lt&&(wt.uniform1i(this.addr,lt),at[0]=lt),st.setTexture2D(_||XT,lt)}function Qx(wt,_,st){const at=this.cache,lt=st.allocateTextureUnit();at[0]!==lt&&(wt.uniform1i(this.addr,lt),at[0]=lt),st.setTexture3D(_||WS,lt)}function tM(wt,_,st){const at=this.cache,lt=st.allocateTextureUnit();at[0]!==lt&&(wt.uniform1i(this.addr,lt),at[0]=lt),st.setTextureCube(_||YS,lt)}function Hx(wt,_,st){const at=this.cache,lt=st.allocateTextureUnit();at[0]!==lt&&(wt.uniform1i(this.addr,lt),at[0]=lt),st.setTexture2DArray(_||qS,lt)}function rM(wt,_){wt.uniform1fv(this.addr,_)}function eC(wt,_){const st=KA(_,this.size,2);wt.uniform2fv(this.addr,st)}function qx(wt,_){const st=KA(_,this.size,3);wt.uniform3fv(this.addr,st)}function nM(wt,_){const st=KA(_,this.size,4);wt.uniform4fv(this.addr,st)}function iM(wt,_){const st=KA(_,this.size,4);wt.uniformMatrix2fv(this.addr,!1,st)}function yP(wt,_){const st=KA(_,this.size,9);wt.uniformMatrix3fv(this.addr,!1,st)}function sM(wt,_){const st=KA(_,this.size,16);wt.uniformMatrix4fv(this.addr,!1,st)}function oM(wt,_){wt.uniform1iv(this.addr,_)}function aM(wt,_){wt.uniform2iv(this.addr,_)}function gm(wt,_){wt.uniform3iv(this.addr,_)}function Ul(wt,_){wt.uniform4iv(this.addr,_)}function lM(wt,_){wt.uniform1uiv(this.addr,_)}function Wy(wt,_){wt.uniform2uiv(this.addr,_)}function vm(wt,_){wt.uniform3uiv(this.addr,_)}function K0(wt,_){wt.uniform4uiv(this.addr,_)}function lu(wt,_,st){const at=_.length,lt=Xw(st,at);wt.uniform1iv(this.addr,lt);for(let ft=0;ft!==at;++ft)st.setTexture2D(_[ft]||XT,lt[ft])}function uM(wt,_,st){const at=_.length,lt=Xw(st,at);wt.uniform1iv(this.addr,lt);for(let ft=0;ft!==at;++ft)st.setTexture3D(_[ft]||WS,lt[ft])}function tC(wt,_,st){const at=_.length,lt=Xw(st,at);wt.uniform1iv(this.addr,lt);for(let ft=0;ft!==at;++ft)st.setTextureCube(_[ft]||YS,lt[ft])}function cM(wt,_,st){const at=_.length,lt=Xw(st,at);wt.uniform1iv(this.addr,lt);for(let ft=0;ft!==at;++ft)st.setTexture2DArray(_[ft]||qS,lt[ft])}class dM{constructor(_,st,at){this.id=_,this.addr=at,this.cache=[],this.setValue=function(lt){switch(lt){case 5126:return Jw;case 35664:return XS;case 35665:return Zw;case 35666:return ZT;case 35674:return JS;case 35675:return _p;case 35676:return Iv;case 5124:case 35670:return e1;case 35667:case 35671:return zx;case 35668:case 35672:return Pv;case 35669:case 35673:return ZS;case 5125:return Vx;case 36294:return eM;case 36295:return Gx;case 36296:return Dv;case 35678:case 36198:case 36298:case 36306:case 35682:return Dm;case 35679:case 36299:case 36307:return Qx;case 35680:case 36300:case 36308:case 36293:return tM;case 36289:case 36303:case 36311:case 36292:return Hx}}(st.type)}}class pM{constructor(_,st,at){this.id=_,this.addr=at,this.cache=[],this.size=st.size,this.setValue=function(lt){switch(lt){case 5126:return rM;case 35664:return eC;case 35665:return qx;case 35666:return nM;case 35674:return iM;case 35675:return yP;case 35676:return sM;case 5124:case 35670:return oM;case 35667:case 35671:return aM;case 35668:case 35672:return gm;case 35669:case 35673:return Ul;case 5125:return lM;case 36294:return Wy;case 36295:return vm;case 36296:return K0;case 35678:case 36198:case 36298:case 36306:case 35682:return lu;case 35679:case 36299:case 36307:return uM;case 35680:case 36300:case 36308:case 36293:return tC;case 36289:case 36303:case 36311:case 36292:return cM}}(st.type)}}class AP{constructor(_){this.id=_,this.seq=[],this.map={}}setValue(_,st,at){const lt=this.seq;for(let ft=0,vt=lt.length;ft!==vt;++ft){const At=lt[ft];At.setValue(_,st[At.id],at)}}}const rC=/(\w+)(\])?(\[|\.)?/g;function hM(wt,_){wt.seq.push(_),wt.map[_.id]=_}function bP(wt,_,st){const at=wt.name,lt=at.length;for(rC.lastIndex=0;;){const ft=rC.exec(at),vt=rC.lastIndex;let At=ft[1];const Ct=ft[2]==="]",Tt=ft[3];if(Ct&&(At|=0),Tt===void 0||Tt==="["&&vt+2===lt){hM(st,Tt===void 0?new dM(At,wt,_):new pM(At,wt,_));break}{let Ot=st.map[At];Ot===void 0&&(Ot=new AP(At),hM(st,Ot)),st=Ot}}}class Wx{constructor(_,st){this.seq=[],this.map={};const at=_.getProgramParameter(st,35718);for(let lt=0;lt<at;++lt){const ft=_.getActiveUniform(st,lt);bP(ft,_.getUniformLocation(st,ft.name),this)}}setValue(_,st,at,lt){const ft=this.map[st];ft!==void 0&&ft.setValue(_,at,lt)}setOptional(_,st,at){const lt=st[at];lt!==void 0&&this.setValue(_,at,lt)}static upload(_,st,at,lt){for(let ft=0,vt=st.length;ft!==vt;++ft){const At=st[ft],Ct=at[At.id];Ct.needsUpdate!==!1&&At.setValue(_,Ct.value,lt)}}static seqWithValue(_,st){const at=[];for(let lt=0,ft=_.length;lt!==ft;++lt){const vt=_[lt];vt.id in st&&at.push(vt)}return at}}function fM(wt,_,st){const at=wt.createShader(_);return wt.shaderSource(at,st),wt.compileShader(at),at}let nC=0;function t1(wt){switch(wt){case Sm:return["Linear","( value )"];case bo:return["sRGB","( value )"];case O_:return["RGBM","( value, 16.0 )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",wt),["Linear","( value )"]}}function $l(wt,_,st){const at=wt.getShaderParameter(_,35713),lt=wt.getShaderInfoLog(_).trim();if(at&&lt==="")return"";const ft=/ERROR: 0:(\d+)/.exec(lt);if(ft){const vt=parseInt(ft[1]);return st.toUpperCase()+`

`+lt+`

`+function(At,Ct){const Tt=At.split(`
`),Ot=[],Ut=Math.max(Ct-6,0),Lt=Math.min(Ct+6,Tt.length);for(let Gt=Ut;Gt<Lt;Gt++){const Xt=Gt+1;Ot.push(`${Xt===Ct?">":" "} ${Xt}: ${Tt[Gt]}`)}return Ot.join(`
`)}(wt.getShaderSource(_),vt)}return lt}function mM(wt,_){const st=t1(_);return"vec4 "+wt+"( vec4 value ) { return "+st[0]+"ToLinear"+st[1]+"; }"}function gM(wt,_){const st=t1(_);return"vec4 "+wt+"( vec4 value ) { return LinearTo"+st[0]+st[1]+"; }"}function Yx(wt,_){let st;switch(_){case Eo:st="Linear";break;case js:st="Reinhard";break;case mn:st="OptimizedCineon";break;case uo:st="ACESFilmic";break;case _o:st="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",_),st="Linear"}return"vec3 "+wt+"( vec3 color ) { return "+st+"ToneMapping( color ); }"}function X0(wt){return wt!==""}function Bv(wt,_){const st=_.numSpotLightShadows+_.numSpotLightMaps-_.numSpotLightShadowsWithMaps;return wt.replace(/NUM_DIR_LIGHTS/g,_.numDirLights).replace(/NUM_SPOT_LIGHTS/g,_.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,_.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,st).replace(/NUM_RECT_AREA_LIGHTS/g,_.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,_.numPointLights).replace(/NUM_HEMI_LIGHTS/g,_.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,_.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,_.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,_.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,_.numPointLightShadows)}function iC(wt,_){return wt.replace(/NUM_CLIPPING_PLANES/g,_.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,_.numClippingPlanes-_.numClipIntersection)}const r1=/^[ \t]*#include +<([\w\d./]+)>/gm;function Z_(wt){return wt.replace(r1,n1)}function n1(wt,_){const st=ho[_];if(st===void 0)throw new Error("Can not resolve #include <"+_+">");return Z_(st)}const Kx=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function XA(wt){return wt.replace(Kx,i1)}function i1(wt,_,st,at){let lt="";for(let ft=parseInt(_);ft<parseInt(st);ft++)lt+=at.replace(/\[\s*i\s*\]/g,"[ "+ft+" ]").replace(/UNROLLED_LOOP_INDEX/g,ft);return lt}function vM(wt){let _="precision "+wt.precision+` float;
precision `+wt.precision+" int;";return wt.precision==="highp"?_+=`
#define HIGH_PRECISION`:wt.precision==="mediump"?_+=`
#define MEDIUM_PRECISION`:wt.precision==="lowp"&&(_+=`
#define LOW_PRECISION`),_}function wP(wt,_,st,at){const lt=wt.getContext(),ft=st.defines;let vt=st.vertexShader,At=st.fragmentShader;const Ct=function(Gr){let on="SHADOWMAP_TYPE_BASIC";return Gr.shadowMapType===Vt?on="SHADOWMAP_TYPE_PCF":Gr.shadowMapType===zt?on="SHADOWMAP_TYPE_PCF_SOFT":Gr.shadowMapType===Jt&&(on="SHADOWMAP_TYPE_VSM"),on}(st),Tt=function(Gr){let on="ENVMAP_TYPE_CUBE";if(Gr.envMap)switch(Gr.envMapMode){case Vo:case Oo:on="ENVMAP_TYPE_CUBE";break;case eu:on="ENVMAP_TYPE_CUBE_UV"}return on}(st),Ot=function(Gr){let on="ENVMAP_MODE_REFLECTION";return Gr.envMap&&Gr.envMapMode===Oo&&(on="ENVMAP_MODE_REFRACTION"),on}(st),Ut=function(Gr){let on="ENVMAP_BLENDING_NONE";if(Gr.envMap)switch(Gr.combine){case As:on="ENVMAP_BLENDING_MULTIPLY";break;case ps:on="ENVMAP_BLENDING_MIX";break;case qs:on="ENVMAP_BLENDING_ADD"}return on}(st),Lt=function(Gr){const on=Gr.envMapCubeUVHeight;if(on===null)return null;const ln=Math.log2(on)-2,Wr=1/on;return{texelWidth:1/(3*Math.max(Math.pow(2,ln),112)),texelHeight:Wr,maxMip:ln}}(st),Gt=st.isWebGL2?"":function(Gr){return[Gr.extensionDerivatives||Gr.envMapCubeUVHeight||Gr.bumpMap||Gr.tangentSpaceNormalMap||Gr.clearcoatNormalMap||Gr.flatShading||Gr.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(Gr.extensionFragDepth||Gr.logarithmicDepthBuffer)&&Gr.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",Gr.extensionDrawBuffers&&Gr.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(Gr.extensionShaderTextureLOD||Gr.envMap||Gr.transmission)&&Gr.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(X0).join(`
`)}(st),Xt=function(Gr){const on=[];for(const ln in Gr){const Wr=Gr[ln];Wr!==!1&&on.push("#define "+ln+" "+Wr)}return on.join(`
`)}(ft),Qt=lt.createProgram();let lr,ur,cr=st.glslVersion?"#version "+st.glslVersion+`
`:"";st.isRawShaderMaterial?(lr=[Xt].filter(X0).join(`
`),lr.length>0&&(lr+=`
`),ur=[Gt,Xt].filter(X0).join(`
`),ur.length>0&&(ur+=`
`)):(lr=[vM(st),"#define SHADER_NAME "+st.shaderName,Xt,st.instancing?"#define USE_INSTANCING":"",st.instancingColor?"#define USE_INSTANCING_COLOR":"",st.supportsVertexTextures?"#define VERTEX_TEXTURES":"",st.useFog&&st.fog?"#define USE_FOG":"",st.useFog&&st.fogExp2?"#define FOG_EXP2":"",st.map?"#define USE_MAP":"",st.envMap?"#define USE_ENVMAP":"",st.envMap?"#define "+Ot:"",st.lightMap?"#define USE_LIGHTMAP":"",st.aoMap?"#define USE_AOMAP":"",st.emissiveMap?"#define USE_EMISSIVEMAP":"",st.bumpMap?"#define USE_BUMPMAP":"",st.normalMap?"#define USE_NORMALMAP":"",st.normalMap&&st.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",st.normalMap&&st.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",st.clearcoatMap?"#define USE_CLEARCOATMAP":"",st.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",st.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",st.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",st.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",st.displacementMap&&st.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",st.specularMap?"#define USE_SPECULARMAP":"",st.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",st.specularColorMap?"#define USE_SPECULARCOLORMAP":"",st.roughnessMap?"#define USE_ROUGHNESSMAP":"",st.metalnessMap?"#define USE_METALNESSMAP":"",st.alphaMap?"#define USE_ALPHAMAP":"",st.transmission?"#define USE_TRANSMISSION":"",st.transmissionMap?"#define USE_TRANSMISSIONMAP":"",st.thicknessMap?"#define USE_THICKNESSMAP":"",st.sheenColorMap?"#define USE_SHEENCOLORMAP":"",st.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",st.vertexTangents?"#define USE_TANGENT":"",st.vertexColors?"#define USE_COLOR":"",st.vertexAlphas?"#define USE_COLOR_ALPHA":"",st.vertexUvs?"#define USE_UV":"",st.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",st.flatShading?"#define FLAT_SHADED":"",st.skinning?"#define USE_SKINNING":"",st.morphTargets?"#define USE_MORPHTARGETS":"",st.morphNormals&&st.flatShading===!1?"#define USE_MORPHNORMALS":"",st.morphColors&&st.isWebGL2?"#define USE_MORPHCOLORS":"",st.morphTargetsCount>0&&st.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",st.morphTargetsCount>0&&st.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+st.morphTextureStride:"",st.morphTargetsCount>0&&st.isWebGL2?"#define MORPHTARGETS_COUNT "+st.morphTargetsCount:"",st.doubleSided?"#define DOUBLE_SIDED":"",st.flipSided?"#define FLIP_SIDED":"",st.shadowMapEnabled?"#define USE_SHADOWMAP":"",st.shadowMapEnabled?"#define "+Ct:"",st.sizeAttenuation?"#define USE_SIZEATTENUATION":"",st.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",st.logarithmicDepthBuffer&&st.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(X0).join(`
`),ur=[Gt,vM(st),"#define SHADER_NAME "+st.shaderName,Xt,st.useFog&&st.fog?"#define USE_FOG":"",st.useFog&&st.fogExp2?"#define FOG_EXP2":"",st.map?"#define USE_MAP":"",st.matcap?"#define USE_MATCAP":"",st.envMap?"#define USE_ENVMAP":"",st.envMap?"#define "+Tt:"",st.envMap?"#define "+Ot:"",st.envMap?"#define "+Ut:"",Lt?"#define CUBEUV_TEXEL_WIDTH "+Lt.texelWidth:"",Lt?"#define CUBEUV_TEXEL_HEIGHT "+Lt.texelHeight:"",Lt?"#define CUBEUV_MAX_MIP "+Lt.maxMip+".0":"",st.lightMap?"#define USE_LIGHTMAP":"",st.aoMap?"#define USE_AOMAP":"",st.emissiveMap?"#define USE_EMISSIVEMAP":"",st.bumpMap?"#define USE_BUMPMAP":"",st.normalMap?"#define USE_NORMALMAP":"",st.normalMap&&st.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",st.normalMap&&st.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",st.clearcoat?"#define USE_CLEARCOAT":"",st.clearcoatMap?"#define USE_CLEARCOATMAP":"",st.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",st.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",st.iridescence?"#define USE_IRIDESCENCE":"",st.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",st.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",st.specularMap?"#define USE_SPECULARMAP":"",st.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",st.specularColorMap?"#define USE_SPECULARCOLORMAP":"",st.roughnessMap?"#define USE_ROUGHNESSMAP":"",st.metalnessMap?"#define USE_METALNESSMAP":"",st.alphaMap?"#define USE_ALPHAMAP":"",st.alphaTest?"#define USE_ALPHATEST":"",st.sheen?"#define USE_SHEEN":"",st.sheenColorMap?"#define USE_SHEENCOLORMAP":"",st.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",st.transmission?"#define USE_TRANSMISSION":"",st.transmissionMap?"#define USE_TRANSMISSIONMAP":"",st.thicknessMap?"#define USE_THICKNESSMAP":"",st.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",st.vertexTangents?"#define USE_TANGENT":"",st.vertexColors||st.instancingColor?"#define USE_COLOR":"",st.vertexAlphas?"#define USE_COLOR_ALPHA":"",st.vertexUvs?"#define USE_UV":"",st.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",st.gradientMap?"#define USE_GRADIENTMAP":"",st.flatShading?"#define FLAT_SHADED":"",st.doubleSided?"#define DOUBLE_SIDED":"",st.flipSided?"#define FLIP_SIDED":"",st.shadowMapEnabled?"#define USE_SHADOWMAP":"",st.shadowMapEnabled?"#define "+Ct:"",st.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",st.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",st.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",st.logarithmicDepthBuffer&&st.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",st.toneMapping!==Vs?"#define TONE_MAPPING":"",st.toneMapping!==Vs?ho.tonemapping_pars_fragment:"",st.toneMapping!==Vs?Yx("toneMapping",st.toneMapping):"",st.dithering?"#define DITHERING":"",st.opaque?"#define OPAQUE":"",ho.encodings_pars_fragment,gM("linearToOutputTexel",st.outputEncoding),st.transmissionSamplerMapEncoding?mM("transmissionSamplerMapTexelToLinear",st.transmissionSamplerMapEncoding):"",st.useDepthPacking?"#define DEPTH_PACKING "+st.depthPacking:"",`
`].filter(X0).join(`
`)),vt=Z_(vt),vt=Bv(vt,st),vt=iC(vt,st),At=Z_(At),At=Bv(At,st),At=iC(At,st),vt=XA(vt),At=XA(At),st.isWebGL2&&st.isRawShaderMaterial!==!0&&(cr=`#version 300 es
`,lr=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+lr,ur=["#define varying in",st.glslVersion===Av?"":"layout(location = 0) out highp vec4 pc_fragColor;",st.glslVersion===Av?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+ur);const gr=cr+ur+At,wr=fM(lt,35633,cr+lr+vt),Er=fM(lt,35632,gr);if(lt.attachShader(Qt,wr),lt.attachShader(Qt,Er),st.index0AttributeName!==void 0?lt.bindAttribLocation(Qt,0,st.index0AttributeName):st.morphTargets===!0&&lt.bindAttribLocation(Qt,0,"position"),lt.linkProgram(Qt),wt.debug.checkShaderErrors){const Gr=lt.getProgramInfoLog(Qt).trim(),on=lt.getShaderInfoLog(wr).trim(),ln=lt.getShaderInfoLog(Er).trim();let Wr=!0,Bn=!0;if(lt.getProgramParameter(Qt,35714)===!1){Wr=!1;const Hn=$l(lt,wr,"vertex"),Pn=$l(lt,Er,"fragment");console.error("THREE.WebGLProgram: Shader Error "+lt.getError()+" - VALIDATE_STATUS "+lt.getProgramParameter(Qt,35715)+`

Program Info Log: `+Gr+`
`+Hn+`
`+Pn)}else Gr!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Gr):on!==""&&ln!==""||(Bn=!1);Bn&&(this.diagnostics={runnable:Wr,programLog:Gr,vertexShader:{log:on,prefix:lr},fragmentShader:{log:ln,prefix:ur}})}let Cr,zr;return lt.deleteShader(wr),lt.deleteShader(Er),this.getUniforms=function(){return Cr===void 0&&(Cr=new Wx(lt,Qt)),Cr},this.getAttributes=function(){return zr===void 0&&(zr=function(Gr,on){const ln={},Wr=Gr.getProgramParameter(on,35721);for(let Bn=0;Bn<Wr;Bn++){const Hn=Gr.getActiveAttrib(on,Bn),Pn=Hn.name;let es=1;Hn.type===35674&&(es=2),Hn.type===35675&&(es=3),Hn.type===35676&&(es=4),ln[Pn]={type:Hn.type,location:Gr.getAttribLocation(on,Pn),locationSize:es}}return ln}(lt,Qt)),zr},this.destroy=function(){at.releaseStatesOfProgram(this),lt.deleteProgram(Qt),this.program=void 0},this.name=st.shaderName,this.id=nC++,this.cacheKey=_,this.usedTimes=1,this.program=Qt,this.vertexShader=wr,this.fragmentShader=Er,this}let _M=0;class Xx{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(_){const st=_.vertexShader,at=_.fragmentShader,lt=this._getShaderStage(st),ft=this._getShaderStage(at),vt=this._getShaderCacheForMaterial(_);return vt.has(lt)===!1&&(vt.add(lt),lt.usedTimes++),vt.has(ft)===!1&&(vt.add(ft),ft.usedTimes++),this}remove(_){const st=this.materialCache.get(_);for(const at of st)at.usedTimes--,at.usedTimes===0&&this.shaderCache.delete(at.code);return this.materialCache.delete(_),this}getVertexShaderID(_){return this._getShaderStage(_.vertexShader).id}getFragmentShaderID(_){return this._getShaderStage(_.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(_){const st=this.materialCache;let at=st.get(_);return at===void 0&&(at=new Set,st.set(_,at)),at}_getShaderStage(_){const st=this.shaderCache;let at=st.get(_);return at===void 0&&(at=new yM(_),st.set(_,at)),at}}class yM{constructor(_){this.id=_M++,this.code=_,this.usedTimes=0}}function xP(wt,_,st,at,lt,ft,vt){const At=new mp,Ct=new Xx,Tt=[],Ot=lt.isWebGL2,Ut=lt.logarithmicDepthBuffer,Lt=lt.vertexTextures;let Gt=lt.precision;const Xt={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(Qt,lr,ur,cr,gr){const wr=cr.fog,Er=gr.geometry,Cr=Qt.isMeshStandardMaterial?cr.environment:null,zr=(Qt.isMeshStandardMaterial?st:_).get(Qt.envMap||Cr),Gr=zr&&zr.mapping===eu?zr.image.height:null,on=Xt[Qt.type];Qt.precision!==null&&(Gt=lt.getMaxPrecision(Qt.precision),Gt!==Qt.precision&&console.warn("THREE.WebGLProgram.getParameters:",Qt.precision,"not supported, using",Gt,"instead."));const ln=Er.morphAttributes.position||Er.morphAttributes.normal||Er.morphAttributes.color,Wr=ln!==void 0?ln.length:0;let Bn,Hn,Pn,es,ts=0;if(Er.morphAttributes.position!==void 0&&(ts=1),Er.morphAttributes.normal!==void 0&&(ts=2),Er.morphAttributes.color!==void 0&&(ts=3),on){const Rs=mm[on];Bn=Rs.vertexShader,Hn=Rs.fragmentShader}else Bn=Qt.vertexShader,Hn=Qt.fragmentShader,Ct.update(Qt),Pn=Ct.getVertexShaderID(Qt),es=Ct.getFragmentShaderID(Qt);const bn=wt.getRenderTarget(),Sn=wt.userData&&wt.userData.transmissionRenderTarget,Kn=Qt.alphaTest>0,kn=Qt.clearcoat>0,Zn=Qt.iridescence>0;return{isWebGL2:Ot,shaderID:on,shaderName:Qt.type,vertexShader:Bn,fragmentShader:Hn,defines:Qt.defines,customVertexShaderID:Pn,customFragmentShaderID:es,isRawShaderMaterial:Qt.isRawShaderMaterial===!0,glslVersion:Qt.glslVersion,precision:Gt,instancing:gr.isInstancedMesh===!0,instancingColor:gr.isInstancedMesh===!0&&gr.instanceColor!==null,supportsVertexTextures:Lt,outputEncoding:bn===null?wt.outputEncoding:bn.isXRRenderTarget===!0||bn.texture.encoding!==bo?bn.texture.encoding:Sm,map:!!Qt.map,matcap:!!Qt.matcap,envMap:!!zr,envMapMode:zr&&zr.mapping,envMapCubeUVHeight:Gr,lightMap:!!Qt.lightMap,aoMap:!!Qt.aoMap,emissiveMap:!!Qt.emissiveMap,bumpMap:!!Qt.bumpMap,normalMap:!!Qt.normalMap,objectSpaceNormalMap:Qt.normalMapType===Uu,tangentSpaceNormalMap:Qt.normalMapType===Fu,decodeVideoTexture:!!Qt.map&&Qt.map.isVideoTexture===!0&&Qt.map.encoding===bo,clearcoat:kn,clearcoatMap:kn&&!!Qt.clearcoatMap,clearcoatRoughnessMap:kn&&!!Qt.clearcoatRoughnessMap,clearcoatNormalMap:kn&&!!Qt.clearcoatNormalMap,iridescence:Zn,iridescenceMap:Zn&&!!Qt.iridescenceMap,iridescenceThicknessMap:Zn&&!!Qt.iridescenceThicknessMap,displacementMap:!!Qt.displacementMap,roughnessMap:!!Qt.roughnessMap,metalnessMap:!!Qt.metalnessMap,specularMap:!!Qt.specularMap,specularIntensityMap:!!Qt.specularIntensityMap,specularColorMap:!!Qt.specularColorMap,opaque:Qt.transparent===!1&&Qt.blending===Ht&&!(Qt.transmission>0),alphaMap:!!Qt.alphaMap,alphaTest:Kn,gradientMap:!!Qt.gradientMap,sheen:Qt.sheen>0,sheenColorMap:!!Qt.sheenColorMap,sheenRoughnessMap:!!Qt.sheenRoughnessMap,transmission:Qt.transmission>0,transmissionMap:!!Qt.transmissionMap,transmissionSamplerMapEncoding:Sn?Sn.texture.encoding:Sm,thicknessMap:!!Qt.thicknessMap,combine:Qt.combine,vertexTangents:!!Qt.normalMap&&!!Er.attributes.tangent,vertexColors:Qt.vertexColors,vertexAlphas:Qt.vertexColors===!0&&!!Er.attributes.color&&Er.attributes.color.itemSize===4,vertexUvs:!!(Qt.map||Qt.bumpMap||Qt.normalMap||Qt.specularMap||Qt.alphaMap||Qt.emissiveMap||Qt.roughnessMap||Qt.metalnessMap||Qt.clearcoatMap||Qt.clearcoatRoughnessMap||Qt.clearcoatNormalMap||Qt.iridescenceMap||Qt.iridescenceThicknessMap||Qt.displacementMap||Qt.transmissionMap||Qt.thicknessMap||Qt.specularIntensityMap||Qt.specularColorMap||Qt.sheenColorMap||Qt.sheenRoughnessMap),uvsVertexOnly:!(Qt.map||Qt.bumpMap||Qt.normalMap||Qt.specularMap||Qt.alphaMap||Qt.emissiveMap||Qt.roughnessMap||Qt.metalnessMap||Qt.clearcoatNormalMap||Qt.iridescenceMap||Qt.iridescenceThicknessMap||Qt.transmission>0||Qt.transmissionMap||Qt.thicknessMap||Qt.specularIntensityMap||Qt.specularColorMap||Qt.sheen>0||Qt.sheenColorMap||Qt.sheenRoughnessMap||!Qt.displacementMap),fog:!!wr,useFog:Qt.fog===!0,fogExp2:wr&&wr.isFogExp2,flatShading:!!Qt.flatShading,sizeAttenuation:Qt.sizeAttenuation,logarithmicDepthBuffer:Ut,skinning:gr.isSkinnedMesh===!0,morphTargets:Er.morphAttributes.position!==void 0,morphNormals:Er.morphAttributes.normal!==void 0,morphColors:Er.morphAttributes.color!==void 0,morphTargetsCount:Wr,morphTextureStride:ts,numDirLights:lr.directional.length,numPointLights:lr.point.length,numSpotLights:lr.spot.length,numSpotLightMaps:lr.spotLightMap.length,numRectAreaLights:lr.rectArea.length,numHemiLights:lr.hemi.length,numDirLightShadows:lr.directionalShadowMap.length,numPointLightShadows:lr.pointShadowMap.length,numSpotLightShadows:lr.spotShadowMap.length,numSpotLightShadowsWithMaps:lr.numSpotLightShadowsWithMaps,numClippingPlanes:vt.numPlanes,numClipIntersection:vt.numIntersection,dithering:Qt.dithering,shadowMapEnabled:wt.shadowMap.enabled&&ur.length>0,shadowMapType:wt.shadowMap.type,toneMapping:Qt.toneMapped?wt.toneMapping:Vs,physicallyCorrectLights:wt.physicallyCorrectLights,premultipliedAlpha:Qt.premultipliedAlpha,doubleSided:Qt.side===dr,flipSided:Qt.side===Yt,useDepthPacking:!!Qt.depthPacking,depthPacking:Qt.depthPacking||0,index0AttributeName:Qt.index0AttributeName,extensionDerivatives:Qt.extensions&&Qt.extensions.derivatives,extensionFragDepth:Qt.extensions&&Qt.extensions.fragDepth,extensionDrawBuffers:Qt.extensions&&Qt.extensions.drawBuffers,extensionShaderTextureLOD:Qt.extensions&&Qt.extensions.shaderTextureLOD,rendererExtensionFragDepth:Ot||at.has("EXT_frag_depth"),rendererExtensionDrawBuffers:Ot||at.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:Ot||at.has("EXT_shader_texture_lod"),customProgramCacheKey:Qt.customProgramCacheKey()}},getProgramCacheKey:function(Qt){const lr=[];if(Qt.shaderID?lr.push(Qt.shaderID):(lr.push(Qt.customVertexShaderID),lr.push(Qt.customFragmentShaderID)),Qt.defines!==void 0)for(const ur in Qt.defines)lr.push(ur),lr.push(Qt.defines[ur]);return Qt.isRawShaderMaterial===!1&&(function(ur,cr){ur.push(cr.precision),ur.push(cr.outputEncoding),ur.push(cr.envMapMode),ur.push(cr.envMapCubeUVHeight),ur.push(cr.combine),ur.push(cr.vertexUvs),ur.push(cr.fogExp2),ur.push(cr.sizeAttenuation),ur.push(cr.morphTargetsCount),ur.push(cr.morphAttributeCount),ur.push(cr.numDirLights),ur.push(cr.numPointLights),ur.push(cr.numSpotLights),ur.push(cr.numSpotLightMaps),ur.push(cr.numHemiLights),ur.push(cr.numRectAreaLights),ur.push(cr.numDirLightShadows),ur.push(cr.numPointLightShadows),ur.push(cr.numSpotLightShadows),ur.push(cr.numSpotLightShadowsWithMaps),ur.push(cr.shadowMapType),ur.push(cr.toneMapping),ur.push(cr.numClippingPlanes),ur.push(cr.numClipIntersection),ur.push(cr.depthPacking)}(lr,Qt),function(ur,cr){At.disableAll(),cr.isWebGL2&&At.enable(0),cr.supportsVertexTextures&&At.enable(1),cr.instancing&&At.enable(2),cr.instancingColor&&At.enable(3),cr.map&&At.enable(4),cr.matcap&&At.enable(5),cr.envMap&&At.enable(6),cr.lightMap&&At.enable(7),cr.aoMap&&At.enable(8),cr.emissiveMap&&At.enable(9),cr.bumpMap&&At.enable(10),cr.normalMap&&At.enable(11),cr.objectSpaceNormalMap&&At.enable(12),cr.tangentSpaceNormalMap&&At.enable(13),cr.clearcoat&&At.enable(14),cr.clearcoatMap&&At.enable(15),cr.clearcoatRoughnessMap&&At.enable(16),cr.clearcoatNormalMap&&At.enable(17),cr.iridescence&&At.enable(18),cr.iridescenceMap&&At.enable(19),cr.iridescenceThicknessMap&&At.enable(20),cr.displacementMap&&At.enable(21),cr.specularMap&&At.enable(22),cr.roughnessMap&&At.enable(23),cr.metalnessMap&&At.enable(24),cr.gradientMap&&At.enable(25),cr.alphaMap&&At.enable(26),cr.alphaTest&&At.enable(27),cr.vertexColors&&At.enable(28),cr.vertexAlphas&&At.enable(29),cr.vertexUvs&&At.enable(30),cr.vertexTangents&&At.enable(31),cr.uvsVertexOnly&&At.enable(32),ur.push(At.mask),At.disableAll(),cr.fog&&At.enable(0),cr.useFog&&At.enable(1),cr.flatShading&&At.enable(2),cr.logarithmicDepthBuffer&&At.enable(3),cr.skinning&&At.enable(4),cr.morphTargets&&At.enable(5),cr.morphNormals&&At.enable(6),cr.morphColors&&At.enable(7),cr.premultipliedAlpha&&At.enable(8),cr.shadowMapEnabled&&At.enable(9),cr.physicallyCorrectLights&&At.enable(10),cr.doubleSided&&At.enable(11),cr.flipSided&&At.enable(12),cr.useDepthPacking&&At.enable(13),cr.dithering&&At.enable(14),cr.specularIntensityMap&&At.enable(15),cr.specularColorMap&&At.enable(16),cr.transmission&&At.enable(17),cr.transmissionMap&&At.enable(18),cr.thicknessMap&&At.enable(19),cr.sheen&&At.enable(20),cr.sheenColorMap&&At.enable(21),cr.sheenRoughnessMap&&At.enable(22),cr.decodeVideoTexture&&At.enable(23),cr.opaque&&At.enable(24),ur.push(At.mask)}(lr,Qt),lr.push(wt.outputEncoding)),lr.push(Qt.customProgramCacheKey),lr.join()},getUniforms:function(Qt){const lr=Xt[Qt.type];let ur;if(lr){const cr=mm[lr];ur=VT.clone(cr.uniforms)}else ur=Qt.uniforms;return ur},acquireProgram:function(Qt,lr){let ur;for(let cr=0,gr=Tt.length;cr<gr;cr++){const wr=Tt[cr];if(wr.cacheKey===lr){ur=wr,++ur.usedTimes;break}}return ur===void 0&&(ur=new wP(wt,lr,Qt,ft),Tt.push(ur)),ur},releaseProgram:function(Qt){if(--Qt.usedTimes==0){const lr=Tt.indexOf(Qt);Tt[lr]=Tt[Tt.length-1],Tt.pop(),Qt.destroy()}},releaseShaderCache:function(Qt){Ct.remove(Qt)},programs:Tt,dispose:function(){Ct.dispose()}}}function AM(){let wt=new WeakMap;return{get:function(_){let st=wt.get(_);return st===void 0&&(st={},wt.set(_,st)),st},remove:function(_){wt.delete(_)},update:function(_,st,at){wt.get(_)[st]=at},dispose:function(){wt=new WeakMap}}}function bM(wt,_){return wt.groupOrder!==_.groupOrder?wt.groupOrder-_.groupOrder:wt.renderOrder!==_.renderOrder?wt.renderOrder-_.renderOrder:wt.material.id!==_.material.id?wt.material.id-_.material.id:wt.z!==_.z?wt.z-_.z:wt.id-_.id}function sC(wt,_){return wt.groupOrder!==_.groupOrder?wt.groupOrder-_.groupOrder:wt.renderOrder!==_.renderOrder?wt.renderOrder-_.renderOrder:wt.z!==_.z?_.z-wt.z:wt.id-_.id}function wM(){const wt=[];let _=0;const st=[],at=[],lt=[];function ft(vt,At,Ct,Tt,Ot,Ut){let Lt=wt[_];return Lt===void 0?(Lt={id:vt.id,object:vt,geometry:At,material:Ct,groupOrder:Tt,renderOrder:vt.renderOrder,z:Ot,group:Ut},wt[_]=Lt):(Lt.id=vt.id,Lt.object=vt,Lt.geometry=At,Lt.material=Ct,Lt.groupOrder=Tt,Lt.renderOrder=vt.renderOrder,Lt.z=Ot,Lt.group=Ut),_++,Lt}return{opaque:st,transmissive:at,transparent:lt,init:function(){_=0,st.length=0,at.length=0,lt.length=0},push:function(vt,At,Ct,Tt,Ot,Ut){const Lt=ft(vt,At,Ct,Tt,Ot,Ut);Ct.transmission>0?at.push(Lt):Ct.transparent===!0?lt.push(Lt):st.push(Lt)},unshift:function(vt,At,Ct,Tt,Ot,Ut){const Lt=ft(vt,At,Ct,Tt,Ot,Ut);Ct.transmission>0?at.unshift(Lt):Ct.transparent===!0?lt.unshift(Lt):st.unshift(Lt)},finish:function(){for(let vt=_,At=wt.length;vt<At;vt++){const Ct=wt[vt];if(Ct.id===null)break;Ct.id=null,Ct.object=null,Ct.geometry=null,Ct.material=null,Ct.group=null}},sort:function(vt,At){st.length>1&&st.sort(vt||bM),at.length>1&&at.sort(At||sC),lt.length>1&&lt.sort(At||sC)}}}function oC(){let wt=new WeakMap;return{get:function(_,st){const at=wt.get(_);let lt;return at===void 0?(lt=new wM,wt.set(_,[lt])):st>=at.length?(lt=new wM,at.push(lt)):lt=at[st],lt},dispose:function(){wt=new WeakMap}}}function aC(){const wt={};return{get:function(_){if(wt[_.id]!==void 0)return wt[_.id];let st;switch(_.type){case"DirectionalLight":st={direction:new Mr,color:new ms};break;case"SpotLight":st={position:new Mr,direction:new Mr,color:new ms,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":st={position:new Mr,color:new ms,distance:0,decay:0};break;case"HemisphereLight":st={direction:new Mr,skyColor:new ms,groundColor:new ms};break;case"RectAreaLight":st={color:new ms,position:new Mr,halfWidth:new Mr,halfHeight:new Mr}}return wt[_.id]=st,st}}}let s1=0;function Jx(wt,_){return(_.castShadow?2:0)-(wt.castShadow?2:0)+(_.map?1:0)-(wt.map?1:0)}function xM(wt,_){const st=new aC,at=function(){const Ct={};return{get:function(Tt){if(Ct[Tt.id]!==void 0)return Ct[Tt.id];let Ot;switch(Tt.type){case"DirectionalLight":case"SpotLight":Ot={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vn};break;case"PointLight":Ot={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vn,shadowCameraNear:1,shadowCameraFar:1e3}}return Ct[Tt.id]=Ot,Ot}}}(),lt={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let Ct=0;Ct<9;Ct++)lt.probe.push(new Mr);const ft=new Mr,vt=new Ys,At=new Ys;return{setup:function(Ct,Tt){let Ot=0,Ut=0,Lt=0;for(let on=0;on<9;on++)lt.probe[on].set(0,0,0);let Gt=0,Xt=0,Qt=0,lr=0,ur=0,cr=0,gr=0,wr=0,Er=0,Cr=0;Ct.sort(Jx);const zr=Tt!==!0?Math.PI:1;for(let on=0,ln=Ct.length;on<ln;on++){const Wr=Ct[on],Bn=Wr.color,Hn=Wr.intensity,Pn=Wr.distance,es=Wr.shadow&&Wr.shadow.map?Wr.shadow.map.texture:null;if(Wr.isAmbientLight)Ot+=Bn.r*Hn*zr,Ut+=Bn.g*Hn*zr,Lt+=Bn.b*Hn*zr;else if(Wr.isLightProbe)for(let ts=0;ts<9;ts++)lt.probe[ts].addScaledVector(Wr.sh.coefficients[ts],Hn);else if(Wr.isDirectionalLight){const ts=st.get(Wr);if(ts.color.copy(Wr.color).multiplyScalar(Wr.intensity*zr),Wr.castShadow){const bn=Wr.shadow,Sn=at.get(Wr);Sn.shadowBias=bn.bias,Sn.shadowNormalBias=bn.normalBias,Sn.shadowRadius=bn.radius,Sn.shadowMapSize=bn.mapSize,lt.directionalShadow[Gt]=Sn,lt.directionalShadowMap[Gt]=es,lt.directionalShadowMatrix[Gt]=Wr.shadow.matrix,cr++}lt.directional[Gt]=ts,Gt++}else if(Wr.isSpotLight){const ts=st.get(Wr);ts.position.setFromMatrixPosition(Wr.matrixWorld),ts.color.copy(Bn).multiplyScalar(Hn*zr),ts.distance=Pn,ts.coneCos=Math.cos(Wr.angle),ts.penumbraCos=Math.cos(Wr.angle*(1-Wr.penumbra)),ts.decay=Wr.decay,lt.spot[Qt]=ts;const bn=Wr.shadow;if(Wr.map&&(lt.spotLightMap[Er]=Wr.map,Er++,bn.updateMatrices(Wr),Wr.castShadow&&Cr++),lt.spotLightMatrix[Qt]=bn.matrix,Wr.castShadow){const Sn=at.get(Wr);Sn.shadowBias=bn.bias,Sn.shadowNormalBias=bn.normalBias,Sn.shadowRadius=bn.radius,Sn.shadowMapSize=bn.mapSize,lt.spotShadow[Qt]=Sn,lt.spotShadowMap[Qt]=es,wr++}Qt++}else if(Wr.isRectAreaLight){const ts=st.get(Wr);ts.color.copy(Bn).multiplyScalar(Hn),ts.halfWidth.set(.5*Wr.width,0,0),ts.halfHeight.set(0,.5*Wr.height,0),lt.rectArea[lr]=ts,lr++}else if(Wr.isPointLight){const ts=st.get(Wr);if(ts.color.copy(Wr.color).multiplyScalar(Wr.intensity*zr),ts.distance=Wr.distance,ts.decay=Wr.decay,Wr.castShadow){const bn=Wr.shadow,Sn=at.get(Wr);Sn.shadowBias=bn.bias,Sn.shadowNormalBias=bn.normalBias,Sn.shadowRadius=bn.radius,Sn.shadowMapSize=bn.mapSize,Sn.shadowCameraNear=bn.camera.near,Sn.shadowCameraFar=bn.camera.far,lt.pointShadow[Xt]=Sn,lt.pointShadowMap[Xt]=es,lt.pointShadowMatrix[Xt]=Wr.shadow.matrix,gr++}lt.point[Xt]=ts,Xt++}else if(Wr.isHemisphereLight){const ts=st.get(Wr);ts.skyColor.copy(Wr.color).multiplyScalar(Hn*zr),ts.groundColor.copy(Wr.groundColor).multiplyScalar(Hn*zr),lt.hemi[ur]=ts,ur++}}lr>0&&(_.isWebGL2||wt.has("OES_texture_float_linear")===!0?(lt.rectAreaLTC1=ls.LTC_FLOAT_1,lt.rectAreaLTC2=ls.LTC_FLOAT_2):wt.has("OES_texture_half_float_linear")===!0?(lt.rectAreaLTC1=ls.LTC_HALF_1,lt.rectAreaLTC2=ls.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),lt.ambient[0]=Ot,lt.ambient[1]=Ut,lt.ambient[2]=Lt;const Gr=lt.hash;Gr.directionalLength===Gt&&Gr.pointLength===Xt&&Gr.spotLength===Qt&&Gr.rectAreaLength===lr&&Gr.hemiLength===ur&&Gr.numDirectionalShadows===cr&&Gr.numPointShadows===gr&&Gr.numSpotShadows===wr&&Gr.numSpotMaps===Er||(lt.directional.length=Gt,lt.spot.length=Qt,lt.rectArea.length=lr,lt.point.length=Xt,lt.hemi.length=ur,lt.directionalShadow.length=cr,lt.directionalShadowMap.length=cr,lt.pointShadow.length=gr,lt.pointShadowMap.length=gr,lt.spotShadow.length=wr,lt.spotShadowMap.length=wr,lt.directionalShadowMatrix.length=cr,lt.pointShadowMatrix.length=gr,lt.spotLightMatrix.length=wr+Er-Cr,lt.spotLightMap.length=Er,lt.numSpotLightShadowsWithMaps=Cr,Gr.directionalLength=Gt,Gr.pointLength=Xt,Gr.spotLength=Qt,Gr.rectAreaLength=lr,Gr.hemiLength=ur,Gr.numDirectionalShadows=cr,Gr.numPointShadows=gr,Gr.numSpotShadows=wr,Gr.numSpotMaps=Er,lt.version=s1++)},setupView:function(Ct,Tt){let Ot=0,Ut=0,Lt=0,Gt=0,Xt=0;const Qt=Tt.matrixWorldInverse;for(let lr=0,ur=Ct.length;lr<ur;lr++){const cr=Ct[lr];if(cr.isDirectionalLight){const gr=lt.directional[Ot];gr.direction.setFromMatrixPosition(cr.matrixWorld),ft.setFromMatrixPosition(cr.target.matrixWorld),gr.direction.sub(ft),gr.direction.transformDirection(Qt),Ot++}else if(cr.isSpotLight){const gr=lt.spot[Lt];gr.position.setFromMatrixPosition(cr.matrixWorld),gr.position.applyMatrix4(Qt),gr.direction.setFromMatrixPosition(cr.matrixWorld),ft.setFromMatrixPosition(cr.target.matrixWorld),gr.direction.sub(ft),gr.direction.transformDirection(Qt),Lt++}else if(cr.isRectAreaLight){const gr=lt.rectArea[Gt];gr.position.setFromMatrixPosition(cr.matrixWorld),gr.position.applyMatrix4(Qt),At.identity(),vt.copy(cr.matrixWorld),vt.premultiply(Qt),At.extractRotation(vt),gr.halfWidth.set(.5*cr.width,0,0),gr.halfHeight.set(0,.5*cr.height,0),gr.halfWidth.applyMatrix4(At),gr.halfHeight.applyMatrix4(At),Gt++}else if(cr.isPointLight){const gr=lt.point[Ut];gr.position.setFromMatrixPosition(cr.matrixWorld),gr.position.applyMatrix4(Qt),Ut++}else if(cr.isHemisphereLight){const gr=lt.hemi[Xt];gr.direction.setFromMatrixPosition(cr.matrixWorld),gr.direction.transformDirection(Qt),Xt++}}},state:lt}}function Zx(wt,_){const st=new xM(wt,_),at=[],lt=[];return{init:function(){at.length=0,lt.length=0},state:{lightsArray:at,shadowsArray:lt,lights:st},setupLights:function(ft){st.setup(at,ft)},setupLightsView:function(ft){st.setupView(at,ft)},pushLight:function(ft){at.push(ft)},pushShadow:function(ft){lt.push(ft)}}}function EM(wt,_){let st=new WeakMap;return{get:function(at,lt=0){const ft=st.get(at);let vt;return ft===void 0?(vt=new Zx(wt,_),st.set(at,[vt])):lt>=ft.length?(vt=new Zx(wt,_),ft.push(vt)):vt=ft[lt],vt},dispose:function(){st=new WeakMap}}}class o1 extends Qu{constructor(_){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=hp,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(_)}copy(_){return super.copy(_),this.depthPacking=_.depthPacking,this.map=_.map,this.alphaMap=_.alphaMap,this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this}}class JA extends Qu{constructor(_){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Mr,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(_)}copy(_){return super.copy(_),this.referencePosition.copy(_.referencePosition),this.nearDistance=_.nearDistance,this.farDistance=_.farDistance,this.map=_.map,this.alphaMap=_.alphaMap,this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this}}function SM(wt,_,st){let at=new Kw;const lt=new Vn,ft=new Vn,vt=new qo,At=new o1({depthPacking:P0}),Ct=new JA,Tt={},Ot=st.maxTextureSize,Ut={0:Yt,1:rr,2:dr},Lt=new Tv({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vn},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),Gt=Lt.clone();Gt.defines.HORIZONTAL_PASS=1;const Xt=new xs;Xt.setAttribute("position",new El(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const Qt=new Hu(Xt,Lt),lr=this;function ur(wr,Er){const Cr=_.update(Qt);Lt.defines.VSM_SAMPLES!==wr.blurSamples&&(Lt.defines.VSM_SAMPLES=wr.blurSamples,Gt.defines.VSM_SAMPLES=wr.blurSamples,Lt.needsUpdate=!0,Gt.needsUpdate=!0),wr.mapPass===null&&(wr.mapPass=new Ip(lt.x,lt.y)),Lt.uniforms.shadow_pass.value=wr.map.texture,Lt.uniforms.resolution.value=wr.mapSize,Lt.uniforms.radius.value=wr.radius,wt.setRenderTarget(wr.mapPass),wt.clear(),wt.renderBufferDirect(Er,null,Cr,Lt,Qt,null),Gt.uniforms.shadow_pass.value=wr.mapPass.texture,Gt.uniforms.resolution.value=wr.mapSize,Gt.uniforms.radius.value=wr.radius,wt.setRenderTarget(wr.map),wt.clear(),wt.renderBufferDirect(Er,null,Cr,Gt,Qt,null)}function cr(wr,Er,Cr,zr,Gr,on){let ln=null;const Wr=Cr.isPointLight===!0?wr.customDistanceMaterial:wr.customDepthMaterial;if(ln=Wr!==void 0?Wr:Cr.isPointLight===!0?Ct:At,wt.localClippingEnabled&&Er.clipShadows===!0&&Array.isArray(Er.clippingPlanes)&&Er.clippingPlanes.length!==0||Er.displacementMap&&Er.displacementScale!==0||Er.alphaMap&&Er.alphaTest>0){const Bn=ln.uuid,Hn=Er.uuid;let Pn=Tt[Bn];Pn===void 0&&(Pn={},Tt[Bn]=Pn);let es=Pn[Hn];es===void 0&&(es=ln.clone(),Pn[Hn]=es),ln=es}return ln.visible=Er.visible,ln.wireframe=Er.wireframe,ln.side=on===Jt?Er.shadowSide!==null?Er.shadowSide:Er.side:Er.shadowSide!==null?Er.shadowSide:Ut[Er.side],ln.alphaMap=Er.alphaMap,ln.alphaTest=Er.alphaTest,ln.clipShadows=Er.clipShadows,ln.clippingPlanes=Er.clippingPlanes,ln.clipIntersection=Er.clipIntersection,ln.displacementMap=Er.displacementMap,ln.displacementScale=Er.displacementScale,ln.displacementBias=Er.displacementBias,ln.wireframeLinewidth=Er.wireframeLinewidth,ln.linewidth=Er.linewidth,Cr.isPointLight===!0&&ln.isMeshDistanceMaterial===!0&&(ln.referencePosition.setFromMatrixPosition(Cr.matrixWorld),ln.nearDistance=zr,ln.farDistance=Gr),ln}function gr(wr,Er,Cr,zr,Gr){if(wr.visible===!1)return;if(wr.layers.test(Er.layers)&&(wr.isMesh||wr.isLine||wr.isPoints)&&(wr.castShadow||wr.receiveShadow&&Gr===Jt)&&(!wr.frustumCulled||at.intersectsObject(wr))){wr.modelViewMatrix.multiplyMatrices(Cr.matrixWorldInverse,wr.matrixWorld);const ln=_.update(wr),Wr=wr.material;if(Array.isArray(Wr)){const Bn=ln.groups;for(let Hn=0,Pn=Bn.length;Hn<Pn;Hn++){const es=Bn[Hn],ts=Wr[es.materialIndex];if(ts&&ts.visible){const bn=cr(wr,ts,zr,Cr.near,Cr.far,Gr);wt.renderBufferDirect(Cr,null,ln,bn,wr,es)}}}else if(Wr.visible){const Bn=cr(wr,Wr,zr,Cr.near,Cr.far,Gr);wt.renderBufferDirect(Cr,null,ln,Bn,wr,null)}}const on=wr.children;for(let ln=0,Wr=on.length;ln<Wr;ln++)gr(on[ln],Er,Cr,zr,Gr)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Vt,this.render=function(wr,Er,Cr){if(lr.enabled===!1||lr.autoUpdate===!1&&lr.needsUpdate===!1||wr.length===0)return;const zr=wt.getRenderTarget(),Gr=wt.getActiveCubeFace(),on=wt.getActiveMipmapLevel(),ln=wt.state;ln.setBlending(Ft),ln.buffers.color.setClear(1,1,1,1),ln.buffers.depth.setTest(!0),ln.setScissorTest(!1);for(let Wr=0,Bn=wr.length;Wr<Bn;Wr++){const Hn=wr[Wr],Pn=Hn.shadow;if(Pn===void 0){console.warn("THREE.WebGLShadowMap:",Hn,"has no shadow.");continue}if(Pn.autoUpdate===!1&&Pn.needsUpdate===!1)continue;lt.copy(Pn.mapSize);const es=Pn.getFrameExtents();if(lt.multiply(es),ft.copy(Pn.mapSize),(lt.x>Ot||lt.y>Ot)&&(lt.x>Ot&&(ft.x=Math.floor(Ot/es.x),lt.x=ft.x*es.x,Pn.mapSize.x=ft.x),lt.y>Ot&&(ft.y=Math.floor(Ot/es.y),lt.y=ft.y*es.y,Pn.mapSize.y=ft.y)),Pn.map===null){const bn=this.type!==Jt?{minFilter:ga,magFilter:ga}:{};Pn.map=new Ip(lt.x,lt.y,bn),Pn.map.texture.name=Hn.name+".shadowMap",Pn.camera.updateProjectionMatrix()}wt.setRenderTarget(Pn.map),wt.clear();const ts=Pn.getViewportCount();for(let bn=0;bn<ts;bn++){const Sn=Pn.getViewport(bn);vt.set(ft.x*Sn.x,ft.y*Sn.y,ft.x*Sn.z,ft.y*Sn.w),ln.viewport(vt),Pn.updateMatrices(Hn,bn),at=Pn.getFrustum(),gr(Er,Cr,Pn.camera,Hn,this.type)}Pn.isPointLightShadow!==!0&&this.type===Jt&&ur(Pn,Cr),Pn.needsUpdate=!1}lr.needsUpdate=!1,wt.setRenderTarget(zr,Gr,on)}}function lC(wt,_,st){const at=st.isWebGL2,lt=new function(){let _r=!1;const En=new qo;let dn=null;const Dn=new qo(0,0,0,0);return{setMask:function(Nn){dn===Nn||_r||(wt.colorMask(Nn,Nn,Nn,Nn),dn=Nn)},setLocked:function(Nn){_r=Nn},setClear:function(Nn,as,Bs,Qs,lo){lo===!0&&(Nn*=Qs,as*=Qs,Bs*=Qs),En.set(Nn,as,Bs,Qs),Dn.equals(En)===!1&&(wt.clearColor(Nn,as,Bs,Qs),Dn.copy(En))},reset:function(){_r=!1,dn=null,Dn.set(-1,0,0,0)}}},ft=new function(){let _r=!1,En=null,dn=null,Dn=null;return{setTest:function(Nn){Nn?Ds(2929):fo(2929)},setMask:function(Nn){En===Nn||_r||(wt.depthMask(Nn),En=Nn)},setFunc:function(Nn){if(dn!==Nn){if(Nn)switch(Nn){case Rn:wt.depthFunc(512);break;case Jr:wt.depthFunc(519);break;case mr:wt.depthFunc(513);break;case Ar:wt.depthFunc(515);break;case jr:wt.depthFunc(514);break;case On:wt.depthFunc(518);break;case $n:wt.depthFunc(516);break;case jn:wt.depthFunc(517);break;default:wt.depthFunc(515)}else wt.depthFunc(515);dn=Nn}},setLocked:function(Nn){_r=Nn},setClear:function(Nn){Dn!==Nn&&(wt.clearDepth(Nn),Dn=Nn)},reset:function(){_r=!1,En=null,dn=null,Dn=null}}},vt=new function(){let _r=!1,En=null,dn=null,Dn=null,Nn=null,as=null,Bs=null,Qs=null,lo=null;return{setTest:function(zs){_r||(zs?Ds(2960):fo(2960))},setMask:function(zs){En===zs||_r||(wt.stencilMask(zs),En=zs)},setFunc:function(zs,Hs,_l){dn===zs&&Dn===Hs&&Nn===_l||(wt.stencilFunc(zs,Hs,_l),dn=zs,Dn=Hs,Nn=_l)},setOp:function(zs,Hs,_l){as===zs&&Bs===Hs&&Qs===_l||(wt.stencilOp(zs,Hs,_l),as=zs,Bs=Hs,Qs=_l)},setLocked:function(zs){_r=zs},setClear:function(zs){lo!==zs&&(wt.clearStencil(zs),lo=zs)},reset:function(){_r=!1,En=null,dn=null,Dn=null,Nn=null,as=null,Bs=null,Qs=null,lo=null}}},At=new WeakMap,Ct=new WeakMap;let Tt={},Ot={},Ut=new WeakMap,Lt=[],Gt=null,Xt=!1,Qt=null,lr=null,ur=null,cr=null,gr=null,wr=null,Er=null,Cr=!1,zr=null,Gr=null,on=null,ln=null,Wr=null;const Bn=wt.getParameter(35661);let Hn=!1,Pn=0;const es=wt.getParameter(7938);es.indexOf("WebGL")!==-1?(Pn=parseFloat(/^WebGL (\d)/.exec(es)[1]),Hn=Pn>=1):es.indexOf("OpenGL ES")!==-1&&(Pn=parseFloat(/^OpenGL ES (\d)/.exec(es)[1]),Hn=Pn>=2);let ts=null,bn={};const Sn=wt.getParameter(3088),Kn=wt.getParameter(2978),kn=new qo().fromArray(Sn),Zn=new qo().fromArray(Kn);function Rs(_r,En,dn){const Dn=new Uint8Array(4),Nn=wt.createTexture();wt.bindTexture(_r,Nn),wt.texParameteri(_r,10241,9728),wt.texParameteri(_r,10240,9728);for(let as=0;as<dn;as++)wt.texImage2D(En+as,0,6408,1,1,0,6408,5121,Dn);return Nn}const wo={};function Ds(_r){Tt[_r]!==!0&&(wt.enable(_r),Tt[_r]=!0)}function fo(_r){Tt[_r]!==!1&&(wt.disable(_r),Tt[_r]=!1)}wo[3553]=Rs(3553,3553,1),wo[34067]=Rs(34067,34069,6),lt.setClear(0,0,0,1),ft.setClear(1),vt.setClear(0),Ds(2929),ft.setFunc(Ar),rn(!1),Ur(yt),Ds(2884),fn(Ft);const Fr={[Wt]:32774,[Zt]:32778,[sr]:32779};if(at)Fr[tr]=32775,Fr[vr]=32776;else{const _r=_.get("EXT_blend_minmax");_r!==null&&(Fr[tr]=_r.MIN_EXT,Fr[vr]=_r.MAX_EXT)}const Br={[Vr]:0,[hn]:1,[cn]:768,[tn]:770,[sn]:776,[yr]:774,[qr]:772,[gn]:769,[Tn]:771,[an]:775,[nn]:773};function fn(_r,En,dn,Dn,Nn,as,Bs,Qs){if(_r!==Ft){if(Xt===!1&&(Ds(3042),Xt=!0),_r===ar)Nn=Nn||En,as=as||dn,Bs=Bs||Dn,En===lr&&Nn===gr||(wt.blendEquationSeparate(Fr[En],Fr[Nn]),lr=En,gr=Nn),dn===ur&&Dn===cr&&as===wr&&Bs===Er||(wt.blendFuncSeparate(Br[dn],Br[Dn],Br[as],Br[Bs]),ur=dn,cr=Dn,wr=as,Er=Bs),Qt=_r,Cr=null;else if(_r!==Qt||Qs!==Cr){if(lr===Wt&&gr===Wt||(wt.blendEquation(32774),lr=Wt,gr=Wt),Qs)switch(_r){case Ht:wt.blendFuncSeparate(1,771,1,771);break;case er:wt.blendFunc(1,1);break;case pr:wt.blendFuncSeparate(0,769,0,1);break;case or:wt.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",_r)}else switch(_r){case Ht:wt.blendFuncSeparate(770,771,1,771);break;case er:wt.blendFunc(770,1);break;case pr:wt.blendFuncSeparate(0,769,0,1);break;case or:wt.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",_r)}ur=null,cr=null,wr=null,Er=null,Qt=_r,Cr=Qs}}else Xt===!0&&(fo(3042),Xt=!1)}function rn(_r){zr!==_r&&(_r?wt.frontFace(2304):wt.frontFace(2305),zr=_r)}function Ur(_r){_r!==mt?(Ds(2884),_r!==Gr&&(_r===yt?wt.cullFace(1029):_r===bt?wt.cullFace(1028):wt.cullFace(1032))):fo(2884),Gr=_r}function Zr(_r,En,dn){_r?(Ds(32823),ln===En&&Wr===dn||(wt.polygonOffset(En,dn),ln=En,Wr=dn)):fo(32823)}function xn(_r){_r===void 0&&(_r=33984+Bn-1),ts!==_r&&(wt.activeTexture(_r),ts=_r)}return{buffers:{color:lt,depth:ft,stencil:vt},enable:Ds,disable:fo,bindFramebuffer:function(_r,En){return Ot[_r]!==En&&(wt.bindFramebuffer(_r,En),Ot[_r]=En,at&&(_r===36009&&(Ot[36160]=En),_r===36160&&(Ot[36009]=En)),!0)},drawBuffers:function(_r,En){let dn=Lt,Dn=!1;if(_r)if(dn=Ut.get(En),dn===void 0&&(dn=[],Ut.set(En,dn)),_r.isWebGLMultipleRenderTargets){const Nn=_r.texture;if(dn.length!==Nn.length||dn[0]!==36064){for(let as=0,Bs=Nn.length;as<Bs;as++)dn[as]=36064+as;dn.length=Nn.length,Dn=!0}}else dn[0]!==36064&&(dn[0]=36064,Dn=!0);else dn[0]!==1029&&(dn[0]=1029,Dn=!0);Dn&&(st.isWebGL2?wt.drawBuffers(dn):_.get("WEBGL_draw_buffers").drawBuffersWEBGL(dn))},useProgram:function(_r){return Gt!==_r&&(wt.useProgram(_r),Gt=_r,!0)},setBlending:fn,setMaterial:function(_r,En){_r.side===dr?fo(2884):Ds(2884);let dn=_r.side===Yt;En&&(dn=!dn),rn(dn),_r.blending===Ht&&_r.transparent===!1?fn(Ft):fn(_r.blending,_r.blendEquation,_r.blendSrc,_r.blendDst,_r.blendEquationAlpha,_r.blendSrcAlpha,_r.blendDstAlpha,_r.premultipliedAlpha),ft.setFunc(_r.depthFunc),ft.setTest(_r.depthTest),ft.setMask(_r.depthWrite),lt.setMask(_r.colorWrite);const Dn=_r.stencilWrite;vt.setTest(Dn),Dn&&(vt.setMask(_r.stencilWriteMask),vt.setFunc(_r.stencilFunc,_r.stencilRef,_r.stencilFuncMask),vt.setOp(_r.stencilFail,_r.stencilZFail,_r.stencilZPass)),Zr(_r.polygonOffset,_r.polygonOffsetFactor,_r.polygonOffsetUnits),_r.alphaToCoverage===!0?Ds(32926):fo(32926)},setFlipSided:rn,setCullFace:Ur,setLineWidth:function(_r){_r!==on&&(Hn&&wt.lineWidth(_r),on=_r)},setPolygonOffset:Zr,setScissorTest:function(_r){_r?Ds(3089):fo(3089)},activeTexture:xn,bindTexture:function(_r,En){ts===null&&xn();let dn=bn[ts];dn===void 0&&(dn={type:void 0,texture:void 0},bn[ts]=dn),dn.type===_r&&dn.texture===En||(wt.bindTexture(_r,En||wo[_r]),dn.type=_r,dn.texture=En)},unbindTexture:function(){const _r=bn[ts];_r!==void 0&&_r.type!==void 0&&(wt.bindTexture(_r.type,null),_r.type=void 0,_r.texture=void 0)},compressedTexImage2D:function(){try{wt.compressedTexImage2D.apply(wt,arguments)}catch(_r){console.error("THREE.WebGLState:",_r)}},texImage2D:function(){try{wt.texImage2D.apply(wt,arguments)}catch(_r){console.error("THREE.WebGLState:",_r)}},texImage3D:function(){try{wt.texImage3D.apply(wt,arguments)}catch(_r){console.error("THREE.WebGLState:",_r)}},updateUBOMapping:function(_r,En){let dn=Ct.get(En);dn===void 0&&(dn=new WeakMap,Ct.set(En,dn));let Dn=dn.get(_r);Dn===void 0&&(Dn=wt.getUniformBlockIndex(En,_r.name),dn.set(_r,Dn))},uniformBlockBinding:function(_r,En){const dn=Ct.get(En).get(_r);At.get(_r)!==dn&&(wt.uniformBlockBinding(En,dn,_r.__bindingPointIndex),At.set(_r,dn))},texStorage2D:function(){try{wt.texStorage2D.apply(wt,arguments)}catch(_r){console.error("THREE.WebGLState:",_r)}},texStorage3D:function(){try{wt.texStorage3D.apply(wt,arguments)}catch(_r){console.error("THREE.WebGLState:",_r)}},texSubImage2D:function(){try{wt.texSubImage2D.apply(wt,arguments)}catch(_r){console.error("THREE.WebGLState:",_r)}},texSubImage3D:function(){try{wt.texSubImage3D.apply(wt,arguments)}catch(_r){console.error("THREE.WebGLState:",_r)}},compressedTexSubImage2D:function(){try{wt.compressedTexSubImage2D.apply(wt,arguments)}catch(_r){console.error("THREE.WebGLState:",_r)}},scissor:function(_r){kn.equals(_r)===!1&&(wt.scissor(_r.x,_r.y,_r.z,_r.w),kn.copy(_r))},viewport:function(_r){Zn.equals(_r)===!1&&(wt.viewport(_r.x,_r.y,_r.z,_r.w),Zn.copy(_r))},reset:function(){wt.disable(3042),wt.disable(2884),wt.disable(2929),wt.disable(32823),wt.disable(3089),wt.disable(2960),wt.disable(32926),wt.blendEquation(32774),wt.blendFunc(1,0),wt.blendFuncSeparate(1,0,1,0),wt.colorMask(!0,!0,!0,!0),wt.clearColor(0,0,0,0),wt.depthMask(!0),wt.depthFunc(513),wt.clearDepth(1),wt.stencilMask(4294967295),wt.stencilFunc(519,0,4294967295),wt.stencilOp(7680,7680,7680),wt.clearStencil(0),wt.cullFace(1029),wt.frontFace(2305),wt.polygonOffset(0,0),wt.activeTexture(33984),wt.bindFramebuffer(36160,null),at===!0&&(wt.bindFramebuffer(36009,null),wt.bindFramebuffer(36008,null)),wt.useProgram(null),wt.lineWidth(1),wt.scissor(0,0,wt.canvas.width,wt.canvas.height),wt.viewport(0,0,wt.canvas.width,wt.canvas.height),Tt={},ts=null,bn={},Ot={},Ut=new WeakMap,Lt=[],Gt=null,Xt=!1,Qt=null,lr=null,ur=null,cr=null,gr=null,wr=null,Er=null,Cr=!1,zr=null,Gr=null,on=null,ln=null,Wr=null,kn.set(0,0,wt.canvas.width,wt.canvas.height),Zn.set(0,0,wt.canvas.width,wt.canvas.height),lt.reset(),ft.reset(),vt.reset()}}}function uC(wt,_,st,at,lt,ft,vt){const At=lt.isWebGL2,Ct=lt.maxTextures,Tt=lt.maxCubemapSize,Ot=lt.maxTextureSize,Ut=lt.maxSamples,Lt=_.has("WEBGL_multisampled_render_to_texture")?_.get("WEBGL_multisampled_render_to_texture"):null,Gt=/OculusBrowser/g.test(navigator.userAgent),Xt=new WeakMap;let Qt;const lr=new WeakMap;let ur=!1;try{ur=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function cr(Fr,Br){return ur?new OffscreenCanvas(Fr,Br):z_("canvas")}function gr(Fr,Br,fn,rn){let Ur=1;if((Fr.width>rn||Fr.height>rn)&&(Ur=rn/Math.max(Fr.width,Fr.height)),Ur<1||Br===!0){if(typeof HTMLImageElement<"u"&&Fr instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Fr instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Fr instanceof ImageBitmap){const Zr=Br?fp:Math.floor,xn=Zr(Ur*Fr.width),_r=Zr(Ur*Fr.height);Qt===void 0&&(Qt=cr(xn,_r));const En=fn?cr(xn,_r):Qt;return En.width=xn,En.height=_r,En.getContext("2d").drawImage(Fr,0,0,xn,_r),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Fr.width+"x"+Fr.height+") to ("+xn+"x"+_r+")."),En}return"data"in Fr&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Fr.width+"x"+Fr.height+")."),Fr}return Fr}function wr(Fr){return Ly(Fr.width)&&Ly(Fr.height)}function Er(Fr,Br){return Fr.generateMipmaps&&Br&&Fr.minFilter!==ga&&Fr.minFilter!==Ko}function Cr(Fr){wt.generateMipmap(Fr)}function zr(Fr,Br,fn,rn,Ur=!1){if(At===!1)return Br;if(Fr!==null){if(wt[Fr]!==void 0)return wt[Fr];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Fr+"'")}let Zr=Br;return Br===6403&&(fn===5126&&(Zr=33326),fn===5131&&(Zr=33325),fn===5121&&(Zr=33321)),Br===33319&&(fn===5126&&(Zr=33328),fn===5131&&(Zr=33327),fn===5121&&(Zr=33323)),Br===6408&&(fn===5126&&(Zr=34836),fn===5131&&(Zr=34842),fn===5121&&(Zr=rn===bo&&Ur===!1?35907:32856),fn===32819&&(Zr=32854),fn===32820&&(Zr=32855)),Zr!==33325&&Zr!==33326&&Zr!==33327&&Zr!==33328&&Zr!==34842&&Zr!==34836||_.get("EXT_color_buffer_float"),Zr}function Gr(Fr,Br,fn){return Er(Fr,fn)===!0||Fr.isFramebufferTexture&&Fr.minFilter!==ga&&Fr.minFilter!==Ko?Math.log2(Math.max(Br.width,Br.height))+1:Fr.mipmaps!==void 0&&Fr.mipmaps.length>0?Fr.mipmaps.length:Fr.isCompressedTexture&&Array.isArray(Fr.image)?Br.mipmaps.length:1}function on(Fr){return Fr===ga||Fr===Go||Fr===ba?9728:9729}function ln(Fr){const Br=Fr.target;Br.removeEventListener("dispose",ln),function(fn){const rn=at.get(fn);if(rn.__webglInit===void 0)return;const Ur=fn.source,Zr=lr.get(Ur);if(Zr){const xn=Zr[rn.__cacheKey];xn.usedTimes--,xn.usedTimes===0&&Bn(fn),Object.keys(Zr).length===0&&lr.delete(Ur)}at.remove(fn)}(Br),Br.isVideoTexture&&Xt.delete(Br)}function Wr(Fr){const Br=Fr.target;Br.removeEventListener("dispose",Wr),function(fn){const rn=fn.texture,Ur=at.get(fn),Zr=at.get(rn);if(Zr.__webglTexture!==void 0&&(wt.deleteTexture(Zr.__webglTexture),vt.memory.textures--),fn.depthTexture&&fn.depthTexture.dispose(),fn.isWebGLCubeRenderTarget)for(let xn=0;xn<6;xn++)wt.deleteFramebuffer(Ur.__webglFramebuffer[xn]),Ur.__webglDepthbuffer&&wt.deleteRenderbuffer(Ur.__webglDepthbuffer[xn]);else{if(wt.deleteFramebuffer(Ur.__webglFramebuffer),Ur.__webglDepthbuffer&&wt.deleteRenderbuffer(Ur.__webglDepthbuffer),Ur.__webglMultisampledFramebuffer&&wt.deleteFramebuffer(Ur.__webglMultisampledFramebuffer),Ur.__webglColorRenderbuffer)for(let xn=0;xn<Ur.__webglColorRenderbuffer.length;xn++)Ur.__webglColorRenderbuffer[xn]&&wt.deleteRenderbuffer(Ur.__webglColorRenderbuffer[xn]);Ur.__webglDepthRenderbuffer&&wt.deleteRenderbuffer(Ur.__webglDepthRenderbuffer)}if(fn.isWebGLMultipleRenderTargets)for(let xn=0,_r=rn.length;xn<_r;xn++){const En=at.get(rn[xn]);En.__webglTexture&&(wt.deleteTexture(En.__webglTexture),vt.memory.textures--),at.remove(rn[xn])}at.remove(rn),at.remove(fn)}(Br)}function Bn(Fr){const Br=at.get(Fr);wt.deleteTexture(Br.__webglTexture);const fn=Fr.source;delete lr.get(fn)[Br.__cacheKey],vt.memory.textures--}let Hn=0;function Pn(Fr,Br){const fn=at.get(Fr);if(Fr.isVideoTexture&&function(rn){const Ur=vt.render.frame;Xt.get(rn)!==Ur&&(Xt.set(rn,Ur),rn.update())}(Fr),Fr.isRenderTargetTexture===!1&&Fr.version>0&&fn.__version!==Fr.version){const rn=Fr.image;if(rn===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(rn.complete!==!1)return void Kn(fn,Fr,Br);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}st.activeTexture(33984+Br),st.bindTexture(3553,fn.__webglTexture)}const es={[So]:10497,[co]:33071,[Il]:33648},ts={[ga]:9728,[Go]:9984,[ba]:9986,[Ko]:9729,[Lu]:9985,[ys]:9987};function bn(Fr,Br,fn){if(fn?(wt.texParameteri(Fr,10242,es[Br.wrapS]),wt.texParameteri(Fr,10243,es[Br.wrapT]),Fr!==32879&&Fr!==35866||wt.texParameteri(Fr,32882,es[Br.wrapR]),wt.texParameteri(Fr,10240,ts[Br.magFilter]),wt.texParameteri(Fr,10241,ts[Br.minFilter])):(wt.texParameteri(Fr,10242,33071),wt.texParameteri(Fr,10243,33071),Fr!==32879&&Fr!==35866||wt.texParameteri(Fr,32882,33071),Br.wrapS===co&&Br.wrapT===co||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),wt.texParameteri(Fr,10240,on(Br.magFilter)),wt.texParameteri(Fr,10241,on(Br.minFilter)),Br.minFilter!==ga&&Br.minFilter!==Ko&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),_.has("EXT_texture_filter_anisotropic")===!0){const rn=_.get("EXT_texture_filter_anisotropic");if(Br.type===Cl&&_.has("OES_texture_float_linear")===!1||At===!1&&Br.type===_d&&_.has("OES_texture_half_float_linear")===!1)return;(Br.anisotropy>1||at.get(Br).__currentAnisotropy)&&(wt.texParameterf(Fr,rn.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Br.anisotropy,lt.getMaxAnisotropy())),at.get(Br).__currentAnisotropy=Br.anisotropy)}}function Sn(Fr,Br){let fn=!1;Fr.__webglInit===void 0&&(Fr.__webglInit=!0,Br.addEventListener("dispose",ln));const rn=Br.source;let Ur=lr.get(rn);Ur===void 0&&(Ur={},lr.set(rn,Ur));const Zr=function(xn){const _r=[];return _r.push(xn.wrapS),_r.push(xn.wrapT),_r.push(xn.magFilter),_r.push(xn.minFilter),_r.push(xn.anisotropy),_r.push(xn.internalFormat),_r.push(xn.format),_r.push(xn.type),_r.push(xn.generateMipmaps),_r.push(xn.premultiplyAlpha),_r.push(xn.flipY),_r.push(xn.unpackAlignment),_r.push(xn.encoding),_r.join()}(Br);if(Zr!==Fr.__cacheKey){Ur[Zr]===void 0&&(Ur[Zr]={texture:wt.createTexture(),usedTimes:0},vt.memory.textures++,fn=!0),Ur[Zr].usedTimes++;const xn=Ur[Fr.__cacheKey];xn!==void 0&&(Ur[Fr.__cacheKey].usedTimes--,xn.usedTimes===0&&Bn(Br)),Fr.__cacheKey=Zr,Fr.__webglTexture=Ur[Zr].texture}return fn}function Kn(Fr,Br,fn){let rn=3553;Br.isDataArrayTexture&&(rn=35866),Br.isData3DTexture&&(rn=32879);const Ur=Sn(Fr,Br),Zr=Br.source;if(st.activeTexture(33984+fn),st.bindTexture(rn,Fr.__webglTexture),Zr.version!==Zr.__currentVersion||Ur===!0){wt.pixelStorei(37440,Br.flipY),wt.pixelStorei(37441,Br.premultiplyAlpha),wt.pixelStorei(3317,Br.unpackAlignment),wt.pixelStorei(37443,0);const xn=function(Hs){return!At&&(Hs.wrapS!==co||Hs.wrapT!==co||Hs.minFilter!==ga&&Hs.minFilter!==Ko)}(Br)&&wr(Br.image)===!1;let _r=gr(Br.image,xn,!1,Ot);_r=fo(Br,_r);const En=wr(_r)||At,dn=ft.convert(Br.format,Br.encoding);let Dn,Nn=ft.convert(Br.type),as=zr(Br.internalFormat,dn,Nn,Br.encoding,Br.isVideoTexture);bn(rn,Br,En);const Bs=Br.mipmaps,Qs=At&&Br.isVideoTexture!==!0,lo=Zr.__currentVersion===void 0||Ur===!0,zs=Gr(Br,_r,En);if(Br.isDepthTexture)as=6402,At?as=Br.type===Cl?36012:Br.type===Yr?33190:Br.type===In?35056:33189:Br.type===Cl&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Br.format===Uo&&as===6402&&Br.type!==_c&&Br.type!==Yr&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Br.type=Yr,Nn=ft.convert(Br.type)),Br.format===Jo&&as===6402&&(as=34041,Br.type!==In&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Br.type=In,Nn=ft.convert(Br.type))),lo&&(Qs?st.texStorage2D(3553,1,as,_r.width,_r.height):st.texImage2D(3553,0,as,_r.width,_r.height,0,dn,Nn,null));else if(Br.isDataTexture)if(Bs.length>0&&En){Qs&&lo&&st.texStorage2D(3553,zs,as,Bs[0].width,Bs[0].height);for(let Hs=0,_l=Bs.length;Hs<_l;Hs++)Dn=Bs[Hs],Qs?st.texSubImage2D(3553,Hs,0,0,Dn.width,Dn.height,dn,Nn,Dn.data):st.texImage2D(3553,Hs,as,Dn.width,Dn.height,0,dn,Nn,Dn.data);Br.generateMipmaps=!1}else Qs?(lo&&st.texStorage2D(3553,zs,as,_r.width,_r.height),st.texSubImage2D(3553,0,0,0,_r.width,_r.height,dn,Nn,_r.data)):st.texImage2D(3553,0,as,_r.width,_r.height,0,dn,Nn,_r.data);else if(Br.isCompressedTexture){Qs&&lo&&st.texStorage2D(3553,zs,as,Bs[0].width,Bs[0].height);for(let Hs=0,_l=Bs.length;Hs<_l;Hs++)Dn=Bs[Hs],Br.format!==Ps?dn!==null?Qs?st.compressedTexSubImage2D(3553,Hs,0,0,Dn.width,Dn.height,dn,Dn.data):st.compressedTexImage2D(3553,Hs,as,Dn.width,Dn.height,0,Dn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Qs?st.texSubImage2D(3553,Hs,0,0,Dn.width,Dn.height,dn,Nn,Dn.data):st.texImage2D(3553,Hs,as,Dn.width,Dn.height,0,dn,Nn,Dn.data)}else if(Br.isDataArrayTexture)Qs?(lo&&st.texStorage3D(35866,zs,as,_r.width,_r.height,_r.depth),st.texSubImage3D(35866,0,0,0,0,_r.width,_r.height,_r.depth,dn,Nn,_r.data)):st.texImage3D(35866,0,as,_r.width,_r.height,_r.depth,0,dn,Nn,_r.data);else if(Br.isData3DTexture)Qs?(lo&&st.texStorage3D(32879,zs,as,_r.width,_r.height,_r.depth),st.texSubImage3D(32879,0,0,0,0,_r.width,_r.height,_r.depth,dn,Nn,_r.data)):st.texImage3D(32879,0,as,_r.width,_r.height,_r.depth,0,dn,Nn,_r.data);else if(Br.isFramebufferTexture){if(lo)if(Qs)st.texStorage2D(3553,zs,as,_r.width,_r.height);else{let Hs=_r.width,_l=_r.height;for(let Nm=0;Nm<zs;Nm++)st.texImage2D(3553,Nm,as,Hs,_l,0,dn,Nn,null),Hs>>=1,_l>>=1}}else if(Bs.length>0&&En){Qs&&lo&&st.texStorage2D(3553,zs,as,Bs[0].width,Bs[0].height);for(let Hs=0,_l=Bs.length;Hs<_l;Hs++)Dn=Bs[Hs],Qs?st.texSubImage2D(3553,Hs,0,0,dn,Nn,Dn):st.texImage2D(3553,Hs,as,dn,Nn,Dn);Br.generateMipmaps=!1}else Qs?(lo&&st.texStorage2D(3553,zs,as,_r.width,_r.height),st.texSubImage2D(3553,0,0,0,dn,Nn,_r)):st.texImage2D(3553,0,as,dn,Nn,_r);Er(Br,En)&&Cr(rn),Zr.__currentVersion=Zr.version,Br.onUpdate&&Br.onUpdate(Br)}Fr.__version=Br.version}function kn(Fr,Br,fn,rn,Ur){const Zr=ft.convert(fn.format,fn.encoding),xn=ft.convert(fn.type),_r=zr(fn.internalFormat,Zr,xn,fn.encoding);at.get(Br).__hasExternalTextures||(Ur===32879||Ur===35866?st.texImage3D(Ur,0,_r,Br.width,Br.height,Br.depth,0,Zr,xn,null):st.texImage2D(Ur,0,_r,Br.width,Br.height,0,Zr,xn,null)),st.bindFramebuffer(36160,Fr),Ds(Br)?Lt.framebufferTexture2DMultisampleEXT(36160,rn,Ur,at.get(fn).__webglTexture,0,wo(Br)):wt.framebufferTexture2D(36160,rn,Ur,at.get(fn).__webglTexture,0),st.bindFramebuffer(36160,null)}function Zn(Fr,Br,fn){if(wt.bindRenderbuffer(36161,Fr),Br.depthBuffer&&!Br.stencilBuffer){let rn=33189;if(fn||Ds(Br)){const Ur=Br.depthTexture;Ur&&Ur.isDepthTexture&&(Ur.type===Cl?rn=36012:Ur.type===Yr&&(rn=33190));const Zr=wo(Br);Ds(Br)?Lt.renderbufferStorageMultisampleEXT(36161,Zr,rn,Br.width,Br.height):wt.renderbufferStorageMultisample(36161,Zr,rn,Br.width,Br.height)}else wt.renderbufferStorage(36161,rn,Br.width,Br.height);wt.framebufferRenderbuffer(36160,36096,36161,Fr)}else if(Br.depthBuffer&&Br.stencilBuffer){const rn=wo(Br);fn&&Ds(Br)===!1?wt.renderbufferStorageMultisample(36161,rn,35056,Br.width,Br.height):Ds(Br)?Lt.renderbufferStorageMultisampleEXT(36161,rn,35056,Br.width,Br.height):wt.renderbufferStorage(36161,34041,Br.width,Br.height),wt.framebufferRenderbuffer(36160,33306,36161,Fr)}else{const rn=Br.isWebGLMultipleRenderTargets===!0?Br.texture:[Br.texture];for(let Ur=0;Ur<rn.length;Ur++){const Zr=rn[Ur],xn=ft.convert(Zr.format,Zr.encoding),_r=ft.convert(Zr.type),En=zr(Zr.internalFormat,xn,_r,Zr.encoding),dn=wo(Br);fn&&Ds(Br)===!1?wt.renderbufferStorageMultisample(36161,dn,En,Br.width,Br.height):Ds(Br)?Lt.renderbufferStorageMultisampleEXT(36161,dn,En,Br.width,Br.height):wt.renderbufferStorage(36161,En,Br.width,Br.height)}}wt.bindRenderbuffer(36161,null)}function Rs(Fr){const Br=at.get(Fr),fn=Fr.isWebGLCubeRenderTarget===!0;if(Fr.depthTexture&&!Br.__autoAllocateDepthBuffer){if(fn)throw new Error("target.depthTexture not supported in Cube render targets");(function(rn,Ur){if(Ur&&Ur.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(st.bindFramebuffer(36160,rn),!Ur.depthTexture||!Ur.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");at.get(Ur.depthTexture).__webglTexture&&Ur.depthTexture.image.width===Ur.width&&Ur.depthTexture.image.height===Ur.height||(Ur.depthTexture.image.width=Ur.width,Ur.depthTexture.image.height=Ur.height,Ur.depthTexture.needsUpdate=!0),Pn(Ur.depthTexture,0);const Zr=at.get(Ur.depthTexture).__webglTexture,xn=wo(Ur);if(Ur.depthTexture.format===Uo)Ds(Ur)?Lt.framebufferTexture2DMultisampleEXT(36160,36096,3553,Zr,0,xn):wt.framebufferTexture2D(36160,36096,3553,Zr,0);else{if(Ur.depthTexture.format!==Jo)throw new Error("Unknown depthTexture format");Ds(Ur)?Lt.framebufferTexture2DMultisampleEXT(36160,33306,3553,Zr,0,xn):wt.framebufferTexture2D(36160,33306,3553,Zr,0)}})(Br.__webglFramebuffer,Fr)}else if(fn){Br.__webglDepthbuffer=[];for(let rn=0;rn<6;rn++)st.bindFramebuffer(36160,Br.__webglFramebuffer[rn]),Br.__webglDepthbuffer[rn]=wt.createRenderbuffer(),Zn(Br.__webglDepthbuffer[rn],Fr,!1)}else st.bindFramebuffer(36160,Br.__webglFramebuffer),Br.__webglDepthbuffer=wt.createRenderbuffer(),Zn(Br.__webglDepthbuffer,Fr,!1);st.bindFramebuffer(36160,null)}function wo(Fr){return Math.min(Ut,Fr.samples)}function Ds(Fr){const Br=at.get(Fr);return At&&Fr.samples>0&&_.has("WEBGL_multisampled_render_to_texture")===!0&&Br.__useRenderToTexture!==!1}function fo(Fr,Br){const fn=Fr.encoding,rn=Fr.format,Ur=Fr.type;return Fr.isCompressedTexture===!0||Fr.isVideoTexture===!0||Fr.format===PA||fn!==Sm&&(fn===bo?At===!1?_.has("EXT_sRGB")===!0&&rn===Ps?(Fr.format=PA,Fr.minFilter=Ko,Fr.generateMipmaps=!1):Br=Fy.sRGBToLinear(Br):rn===Ps&&Ur===su||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):fn===RGBM16Encoding||console.error("THREE.WebGLTextures: Unsupported texture encoding:",fn)),Br}this.allocateTextureUnit=function(){const Fr=Hn;return Fr>=Ct&&console.warn("THREE.WebGLTextures: Trying to use "+Fr+" texture units while this GPU supports only "+Ct),Hn+=1,Fr},this.resetTextureUnits=function(){Hn=0},this.setTexture2D=Pn,this.setTexture2DArray=function(Fr,Br){const fn=at.get(Fr);Fr.version>0&&fn.__version!==Fr.version?Kn(fn,Fr,Br):(st.activeTexture(33984+Br),st.bindTexture(35866,fn.__webglTexture))},this.setTexture3D=function(Fr,Br){const fn=at.get(Fr);Fr.version>0&&fn.__version!==Fr.version?Kn(fn,Fr,Br):(st.activeTexture(33984+Br),st.bindTexture(32879,fn.__webglTexture))},this.setTextureCube=function(Fr,Br){const fn=at.get(Fr);Fr.version>0&&fn.__version!==Fr.version?function(rn,Ur,Zr){if(Ur.image.length!==6)return;const xn=Sn(rn,Ur),_r=Ur.source;if(st.activeTexture(33984+Zr),st.bindTexture(34067,rn.__webglTexture),_r.version!==_r.__currentVersion||xn===!0){wt.pixelStorei(37440,Ur.flipY),wt.pixelStorei(37441,Ur.premultiplyAlpha),wt.pixelStorei(3317,Ur.unpackAlignment),wt.pixelStorei(37443,0);const En=Ur.isCompressedTexture||Ur.image[0].isCompressedTexture,dn=Ur.image[0]&&Ur.image[0].isDataTexture,Dn=[];for(let so=0;so<6;so++)Dn[so]=En||dn?dn?Ur.image[so].image:Ur.image[so]:gr(Ur.image[so],!1,!0,Tt),Dn[so]=fo(Ur,Dn[so]);const Nn=Dn[0],as=wr(Nn)||At,Bs=ft.convert(Ur.format,Ur.encoding),Qs=ft.convert(Ur.type),lo=zr(Ur.internalFormat,Bs,Qs,Ur.encoding),zs=At&&Ur.isVideoTexture!==!0,Hs=_r.__currentVersion===void 0||xn===!0;let _l,Nm=Gr(Ur,Nn,as);if(bn(34067,Ur,as),En){zs&&Hs&&st.texStorage2D(34067,Nm,lo,Nn.width,Nn.height);for(let so=0;so<6;so++){_l=Dn[so].mipmaps;for(let Ml=0;Ml<_l.length;Ml++){const Rl=_l[Ml];Ur.format!==Ps?Bs!==null?zs?st.compressedTexSubImage2D(34069+so,Ml,0,0,Rl.width,Rl.height,Bs,Rl.data):st.compressedTexImage2D(34069+so,Ml,lo,Rl.width,Rl.height,0,Rl.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):zs?st.texSubImage2D(34069+so,Ml,0,0,Rl.width,Rl.height,Bs,Qs,Rl.data):st.texImage2D(34069+so,Ml,lo,Rl.width,Rl.height,0,Bs,Qs,Rl.data)}}}else{_l=Ur.mipmaps,zs&&Hs&&(_l.length>0&&Nm++,st.texStorage2D(34067,Nm,lo,Dn[0].width,Dn[0].height));for(let so=0;so<6;so++)if(dn){zs?st.texSubImage2D(34069+so,0,0,0,Dn[so].width,Dn[so].height,Bs,Qs,Dn[so].data):st.texImage2D(34069+so,0,lo,Dn[so].width,Dn[so].height,0,Bs,Qs,Dn[so].data);for(let Ml=0;Ml<_l.length;Ml++){const Rl=_l[Ml].image[so].image;zs?st.texSubImage2D(34069+so,Ml+1,0,0,Rl.width,Rl.height,Bs,Qs,Rl.data):st.texImage2D(34069+so,Ml+1,lo,Rl.width,Rl.height,0,Bs,Qs,Rl.data)}}else{zs?st.texSubImage2D(34069+so,0,0,0,Bs,Qs,Dn[so]):st.texImage2D(34069+so,0,lo,Bs,Qs,Dn[so]);for(let Ml=0;Ml<_l.length;Ml++){const Rl=_l[Ml];zs?st.texSubImage2D(34069+so,Ml+1,0,0,Bs,Qs,Rl.image[so]):st.texImage2D(34069+so,Ml+1,lo,Bs,Qs,Rl.image[so])}}}Er(Ur,as)&&Cr(34067),_r.__currentVersion=_r.version,Ur.onUpdate&&Ur.onUpdate(Ur)}rn.__version=Ur.version}(fn,Fr,Br):(st.activeTexture(33984+Br),st.bindTexture(34067,fn.__webglTexture))},this.rebindTextures=function(Fr,Br,fn){const rn=at.get(Fr);Br!==void 0&&kn(rn.__webglFramebuffer,Fr,Fr.texture,36064,3553),fn!==void 0&&Rs(Fr)},this.setupRenderTarget=function(Fr){const Br=Fr.texture,fn=at.get(Fr),rn=at.get(Br);Fr.addEventListener("dispose",Wr),Fr.isWebGLMultipleRenderTargets!==!0&&(rn.__webglTexture===void 0&&(rn.__webglTexture=wt.createTexture()),rn.__version=Br.version,vt.memory.textures++);const Ur=Fr.isWebGLCubeRenderTarget===!0,Zr=Fr.isWebGLMultipleRenderTargets===!0,xn=wr(Fr)||At;if(Ur){fn.__webglFramebuffer=[];for(let _r=0;_r<6;_r++)fn.__webglFramebuffer[_r]=wt.createFramebuffer()}else{if(fn.__webglFramebuffer=wt.createFramebuffer(),Zr)if(lt.drawBuffers){const _r=Fr.texture;for(let En=0,dn=_r.length;En<dn;En++){const Dn=at.get(_r[En]);Dn.__webglTexture===void 0&&(Dn.__webglTexture=wt.createTexture(),vt.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(At&&Fr.samples>0&&Ds(Fr)===!1){const _r=Zr?Br:[Br];fn.__webglMultisampledFramebuffer=wt.createFramebuffer(),fn.__webglColorRenderbuffer=[],st.bindFramebuffer(36160,fn.__webglMultisampledFramebuffer);for(let En=0;En<_r.length;En++){const dn=_r[En];fn.__webglColorRenderbuffer[En]=wt.createRenderbuffer(),wt.bindRenderbuffer(36161,fn.__webglColorRenderbuffer[En]);const Dn=ft.convert(dn.format,dn.encoding),Nn=ft.convert(dn.type),as=zr(dn.internalFormat,Dn,Nn,dn.encoding),Bs=wo(Fr);wt.renderbufferStorageMultisample(36161,Bs,as,Fr.width,Fr.height),wt.framebufferRenderbuffer(36160,36064+En,36161,fn.__webglColorRenderbuffer[En])}wt.bindRenderbuffer(36161,null),Fr.depthBuffer&&(fn.__webglDepthRenderbuffer=wt.createRenderbuffer(),Zn(fn.__webglDepthRenderbuffer,Fr,!0)),st.bindFramebuffer(36160,null)}}if(Ur){st.bindTexture(34067,rn.__webglTexture),bn(34067,Br,xn);for(let _r=0;_r<6;_r++)kn(fn.__webglFramebuffer[_r],Fr,Br,36064,34069+_r);Er(Br,xn)&&Cr(34067),st.unbindTexture()}else if(Zr){const _r=Fr.texture;for(let En=0,dn=_r.length;En<dn;En++){const Dn=_r[En],Nn=at.get(Dn);st.bindTexture(3553,Nn.__webglTexture),bn(3553,Dn,xn),kn(fn.__webglFramebuffer,Fr,Dn,36064+En,3553),Er(Dn,xn)&&Cr(3553)}st.unbindTexture()}else{let _r=3553;(Fr.isWebGL3DRenderTarget||Fr.isWebGLArrayRenderTarget)&&(At?_r=Fr.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),st.bindTexture(_r,rn.__webglTexture),bn(_r,Br,xn),kn(fn.__webglFramebuffer,Fr,Br,36064,_r),Er(Br,xn)&&Cr(_r),st.unbindTexture()}Fr.depthBuffer&&Rs(Fr)},this.updateRenderTargetMipmap=function(Fr){const Br=wr(Fr)||At,fn=Fr.isWebGLMultipleRenderTargets===!0?Fr.texture:[Fr.texture],rn=Fr.isWebGLCubeRenderTarget?34067:3553;for(let Ur=0,Zr=fn.length;Ur<Zr;Ur++){const xn=fn[Ur],_r=at.get(xn),En=_r.__webglTexture;_r.__version!==xn.version&&(st.bindTexture(rn,En),bn(rn,xn,Br),st.unbindTexture(),_r.__version=xn.version),Er(xn,Br)&&(st.bindTexture(rn,En),Cr(rn),st.unbindTexture())}},this.updateMultisampleRenderTarget=function(Fr){if(At&&Fr.samples>0&&Ds(Fr)===!1){const Br=Fr.isWebGLMultipleRenderTargets?Fr.texture:[Fr.texture],fn=Fr.width,rn=Fr.height;let Ur=16384;const Zr=[],xn=Fr.stencilBuffer?33306:36096,_r=at.get(Fr),En=Fr.isWebGLMultipleRenderTargets===!0;if(En)for(let dn=0;dn<Br.length;dn++)st.bindFramebuffer(36160,_r.__webglMultisampledFramebuffer),wt.framebufferRenderbuffer(36160,36064+dn,36161,null),st.bindFramebuffer(36160,_r.__webglFramebuffer),wt.framebufferTexture2D(36009,36064+dn,3553,null,0);st.bindFramebuffer(36008,_r.__webglMultisampledFramebuffer),st.bindFramebuffer(36009,_r.__webglFramebuffer);for(let dn=0;dn<Br.length;dn++){Zr.push(36064+dn),Fr.depthBuffer&&Zr.push(xn);const Dn=_r.__ignoreDepthValues!==void 0&&_r.__ignoreDepthValues;if(Dn===!1&&(Fr.depthBuffer&&(Ur|=256),Fr.stencilBuffer&&(Ur|=1024)),En&&wt.framebufferRenderbuffer(36008,36064,36161,_r.__webglColorRenderbuffer[dn]),Dn===!0&&(wt.invalidateFramebuffer(36008,[xn]),wt.invalidateFramebuffer(36009,[xn])),En){const Nn=at.get(Br[dn]).__webglTexture;wt.framebufferTexture2D(36009,36064,3553,Nn,0)}wt.blitFramebuffer(0,0,fn,rn,0,0,fn,rn,Ur,9728),Gt&&wt.invalidateFramebuffer(36008,Zr)}if(st.bindFramebuffer(36008,null),st.bindFramebuffer(36009,null),En)for(let dn=0;dn<Br.length;dn++){st.bindFramebuffer(36160,_r.__webglMultisampledFramebuffer),wt.framebufferRenderbuffer(36160,36064+dn,36161,_r.__webglColorRenderbuffer[dn]);const Dn=at.get(Br[dn]).__webglTexture;st.bindFramebuffer(36160,_r.__webglFramebuffer),wt.framebufferTexture2D(36009,36064+dn,3553,Dn,0)}st.bindFramebuffer(36009,_r.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=Rs,this.setupFrameBufferTexture=kn,this.useMultisampledRTT=Ds}function eE(wt,_,st){const at=st.isWebGL2;return{convert:function(lt,ft=null){let vt;if(lt===su)return 5121;if(lt===Js)return 32819;if(lt===rs)return 32820;if(lt===Ol)return 5120;if(lt===pp)return 5122;if(lt===_c)return 5123;if(lt===Cp)return 5124;if(lt===Yr)return 5125;if(lt===Cl)return 5126;if(lt===_d)return at?5131:(vt=_.get("OES_texture_half_float"),vt!==null?vt.HALF_FLOAT_OES:null);if(lt===Ns)return 6406;if(lt===Ps)return 6408;if(lt===Xo)return 6409;if(lt===oo)return 6410;if(lt===Uo)return 6402;if(lt===Jo)return 34041;if(lt===ep)return 6403;if(lt===Fs)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(lt===PA)return vt=_.get("EXT_sRGB"),vt!==null?vt.SRGB_ALPHA_EXT:null;if(lt===po)return 36244;if(lt===tu)return 33319;if(lt===Tp)return 33320;if(lt===Zo)return 36249;if(lt===To||lt===Al||lt===Co||lt===wu)if(ft===bo){if(vt=_.get("WEBGL_compressed_texture_s3tc_srgb"),vt===null)return null;if(lt===To)return vt.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(lt===Al)return vt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(lt===Co)return vt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(lt===wu)return vt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(vt=_.get("WEBGL_compressed_texture_s3tc"),vt===null)return null;if(lt===To)return vt.COMPRESSED_RGB_S3TC_DXT1_EXT;if(lt===Al)return vt.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(lt===Co)return vt.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(lt===wu)return vt.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(lt===Mo||lt===xl||lt===Pl||lt===ds){if(vt=_.get("WEBGL_compressed_texture_pvrtc"),vt===null)return null;if(lt===Mo)return vt.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(lt===xl)return vt.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(lt===Pl)return vt.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(lt===ds)return vt.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(lt===Hm)return vt=_.get("WEBGL_compressed_texture_etc1"),vt!==null?vt.COMPRESSED_RGB_ETC1_WEBGL:null;if(lt===gs||lt===ou){if(vt=_.get("WEBGL_compressed_texture_etc"),vt===null)return null;if(lt===gs)return ft===bo?vt.COMPRESSED_SRGB8_ETC2:vt.COMPRESSED_RGB8_ETC2;if(lt===ou)return ft===bo?vt.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:vt.COMPRESSED_RGBA8_ETC2_EAC}if(lt===Mp||lt===Qo||lt===yo||lt===vv||lt===By||lt===Yv||lt===R_||lt===Ao||lt===EA||lt===I_||lt===Kv||lt===Xv||lt===xa||lt===Ho){if(vt=_.get("WEBGL_compressed_texture_astc"),vt===null)return null;if(lt===Mp)return ft===bo?vt.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:vt.COMPRESSED_RGBA_ASTC_4x4_KHR;if(lt===Qo)return ft===bo?vt.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:vt.COMPRESSED_RGBA_ASTC_5x4_KHR;if(lt===yo)return ft===bo?vt.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:vt.COMPRESSED_RGBA_ASTC_5x5_KHR;if(lt===vv)return ft===bo?vt.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:vt.COMPRESSED_RGBA_ASTC_6x5_KHR;if(lt===By)return ft===bo?vt.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:vt.COMPRESSED_RGBA_ASTC_6x6_KHR;if(lt===Yv)return ft===bo?vt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:vt.COMPRESSED_RGBA_ASTC_8x5_KHR;if(lt===R_)return ft===bo?vt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:vt.COMPRESSED_RGBA_ASTC_8x6_KHR;if(lt===Ao)return ft===bo?vt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:vt.COMPRESSED_RGBA_ASTC_8x8_KHR;if(lt===EA)return ft===bo?vt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:vt.COMPRESSED_RGBA_ASTC_10x5_KHR;if(lt===I_)return ft===bo?vt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:vt.COMPRESSED_RGBA_ASTC_10x6_KHR;if(lt===Kv)return ft===bo?vt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:vt.COMPRESSED_RGBA_ASTC_10x8_KHR;if(lt===Xv)return ft===bo?vt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:vt.COMPRESSED_RGBA_ASTC_10x10_KHR;if(lt===xa)return ft===bo?vt.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:vt.COMPRESSED_RGBA_ASTC_12x10_KHR;if(lt===Ho)return ft===bo?vt.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:vt.COMPRESSED_RGBA_ASTC_12x12_KHR}if(lt===_v){if(vt=_.get("EXT_texture_compression_bptc"),vt===null)return null;if(lt===_v)return ft===bo?vt.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:vt.COMPRESSED_RGBA_BPTC_UNORM_EXT}return lt===In?at?34042:(vt=_.get("WEBGL_depth_texture"),vt!==null?vt.UNSIGNED_INT_24_8_WEBGL:null):wt[lt]!==void 0?wt[lt]:null}}}class cC extends op{constructor(_=[]){super(),this.isArrayCamera=!0,this.cameras=_}}class e0 extends ao{constructor(){super(),this.isGroup=!0,this.type="Group"}}const CM={type:"move"};class tE{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new e0,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new e0,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Mr,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Mr),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new e0,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Mr,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Mr),this._grip}dispatchEvent(_){return this._targetRay!==null&&this._targetRay.dispatchEvent(_),this._grip!==null&&this._grip.dispatchEvent(_),this._hand!==null&&this._hand.dispatchEvent(_),this}disconnect(_){return this.dispatchEvent({type:"disconnected",data:_}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(_,st,at){let lt=null,ft=null,vt=null;const At=this._targetRay,Ct=this._grip,Tt=this._hand;if(_&&st.session.visibilityState!=="visible-blurred"){if(Tt&&_.hand){vt=!0;for(const Qt of _.hand.values()){const lr=st.getJointPose(Qt,at);if(Tt.joints[Qt.jointName]===void 0){const cr=new e0;cr.matrixAutoUpdate=!1,cr.visible=!1,Tt.joints[Qt.jointName]=cr,Tt.add(cr)}const ur=Tt.joints[Qt.jointName];lr!==null&&(ur.matrix.fromArray(lr.transform.matrix),ur.matrix.decompose(ur.position,ur.rotation,ur.scale),ur.jointRadius=lr.radius),ur.visible=lr!==null}const Ot=Tt.joints["index-finger-tip"],Ut=Tt.joints["thumb-tip"],Lt=Ot.position.distanceTo(Ut.position),Gt=.02,Xt=.005;Tt.inputState.pinching&&Lt>Gt+Xt?(Tt.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:_.handedness,target:this})):!Tt.inputState.pinching&&Lt<=Gt-Xt&&(Tt.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:_.handedness,target:this}))}else Ct!==null&&_.gripSpace&&(ft=st.getPose(_.gripSpace,at),ft!==null&&(Ct.matrix.fromArray(ft.transform.matrix),Ct.matrix.decompose(Ct.position,Ct.rotation,Ct.scale),ft.linearVelocity?(Ct.hasLinearVelocity=!0,Ct.linearVelocity.copy(ft.linearVelocity)):Ct.hasLinearVelocity=!1,ft.angularVelocity?(Ct.hasAngularVelocity=!0,Ct.angularVelocity.copy(ft.angularVelocity)):Ct.hasAngularVelocity=!1));At!==null&&(lt=st.getPose(_.targetRaySpace,at),lt===null&&ft!==null&&(lt=ft),lt!==null&&(At.matrix.fromArray(lt.transform.matrix),At.matrix.decompose(At.position,At.rotation,At.scale),lt.linearVelocity?(At.hasLinearVelocity=!0,At.linearVelocity.copy(lt.linearVelocity)):At.hasLinearVelocity=!1,lt.angularVelocity?(At.hasAngularVelocity=!0,At.angularVelocity.copy(lt.angularVelocity)):At.hasAngularVelocity=!1,this.dispatchEvent(CM)))}return At!==null&&(At.visible=lt!==null),Ct!==null&&(Ct.visible=ft!==null),Tt!==null&&(Tt.visible=vt!==null),this}}class dC extends Cu{constructor(_,st,at,lt,ft,vt,At,Ct,Tt,Ot){if((Ot=Ot!==void 0?Ot:Uo)!==Uo&&Ot!==Jo)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");at===void 0&&Ot===Uo&&(at=Yr),at===void 0&&Ot===Jo&&(at=In),super(null,lt,ft,vt,At,Ct,Ot,at,Tt),this.isDepthTexture=!0,this.image={width:_,height:st},this.magFilter=At!==void 0?At:ga,this.minFilter=Ct!==void 0?Ct:ga,this.flipY=!1,this.generateMipmaps=!1}}class a1 extends Ws{constructor(_,st){super();const at=this;let lt=null,ft=1,vt=null,At="local-floor",Ct=null,Tt=null,Ot=null,Ut=null,Lt=null,Gt=null;const Xt=st.getContextAttributes();let Qt=null,lr=null;const ur=[],cr=[],gr=new op;gr.layers.enable(1),gr.viewport=new qo;const wr=new op;wr.layers.enable(2),wr.viewport=new qo;const Er=[gr,wr],Cr=new cC;Cr.layers.enable(1),Cr.layers.enable(2);let zr=null,Gr=null;function on(bn){const Sn=cr.indexOf(bn.inputSource);if(Sn===-1)return;const Kn=ur[Sn];Kn!==void 0&&Kn.dispatchEvent({type:bn.type,data:bn.inputSource})}function ln(){lt.removeEventListener("select",on),lt.removeEventListener("selectstart",on),lt.removeEventListener("selectend",on),lt.removeEventListener("squeeze",on),lt.removeEventListener("squeezestart",on),lt.removeEventListener("squeezeend",on),lt.removeEventListener("end",ln),lt.removeEventListener("inputsourceschange",Wr);for(let bn=0;bn<ur.length;bn++){const Sn=cr[bn];Sn!==null&&(cr[bn]=null,ur[bn].disconnect(Sn))}zr=null,Gr=null,_.setRenderTarget(Qt),Lt=null,Ut=null,Ot=null,lt=null,lr=null,ts.stop(),at.isPresenting=!1,at.dispatchEvent({type:"sessionend"})}function Wr(bn){for(let Sn=0;Sn<bn.removed.length;Sn++){const Kn=bn.removed[Sn],kn=cr.indexOf(Kn);kn>=0&&(cr[kn]=null,ur[kn].dispatchEvent({type:"disconnected",data:Kn}))}for(let Sn=0;Sn<bn.added.length;Sn++){const Kn=bn.added[Sn];let kn=cr.indexOf(Kn);if(kn===-1){for(let Rs=0;Rs<ur.length;Rs++){if(Rs>=cr.length){cr.push(Kn),kn=Rs;break}if(cr[Rs]===null){cr[Rs]=Kn,kn=Rs;break}}if(kn===-1)break}const Zn=ur[kn];Zn&&Zn.dispatchEvent({type:"connected",data:Kn})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(bn){let Sn=ur[bn];return Sn===void 0&&(Sn=new tE,ur[bn]=Sn),Sn.getTargetRaySpace()},this.getControllerGrip=function(bn){let Sn=ur[bn];return Sn===void 0&&(Sn=new tE,ur[bn]=Sn),Sn.getGripSpace()},this.getHand=function(bn){let Sn=ur[bn];return Sn===void 0&&(Sn=new tE,ur[bn]=Sn),Sn.getHandSpace()},this.setFramebufferScaleFactor=function(bn){ft=bn,at.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(bn){At=bn,at.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return Ct||vt},this.setReferenceSpace=function(bn){Ct=bn},this.getBaseLayer=function(){return Ut!==null?Ut:Lt},this.getBinding=function(){return Ot},this.getFrame=function(){return Gt},this.getSession=function(){return lt},this.setSession=async function(bn){if(lt=bn,lt!==null){if(Qt=_.getRenderTarget(),lt.addEventListener("select",on),lt.addEventListener("selectstart",on),lt.addEventListener("selectend",on),lt.addEventListener("squeeze",on),lt.addEventListener("squeezestart",on),lt.addEventListener("squeezeend",on),lt.addEventListener("end",ln),lt.addEventListener("inputsourceschange",Wr),Xt.xrCompatible!==!0&&await st.makeXRCompatible(),lt.renderState.layers===void 0||_.capabilities.isWebGL2===!1){const Sn={antialias:lt.renderState.layers!==void 0||Xt.antialias,alpha:Xt.alpha,depth:Xt.depth,stencil:Xt.stencil,framebufferScaleFactor:ft};Lt=new XRWebGLLayer(lt,st,Sn),lt.updateRenderState({baseLayer:Lt}),lr=new Ip(Lt.framebufferWidth,Lt.framebufferHeight,{format:Ps,type:su,encoding:_.outputEncoding,stencilBuffer:Xt.stencil})}else{let Sn=null,Kn=null,kn=null;Xt.depth&&(kn=Xt.stencil?35056:33190,Sn=Xt.stencil?Jo:Uo,Kn=Xt.stencil?In:Yr);const Zn={colorFormat:32856,depthFormat:kn,scaleFactor:ft};Ot=new XRWebGLBinding(lt,st),Ut=Ot.createProjectionLayer(Zn),lt.updateRenderState({layers:[Ut]}),lr=new Ip(Ut.textureWidth,Ut.textureHeight,{format:Ps,type:su,depthTexture:new dC(Ut.textureWidth,Ut.textureHeight,Kn,void 0,void 0,void 0,void 0,void 0,void 0,Sn),stencilBuffer:Xt.stencil,encoding:_.outputEncoding,samples:Xt.antialias?4:0}),_.properties.get(lr).__ignoreDepthValues=Ut.ignoreDepthValues}lr.isXRRenderTarget=!0,this.setFoveation(1),Ct=null,vt=await lt.requestReferenceSpace(At),ts.setContext(lt),ts.start(),at.isPresenting=!0,at.dispatchEvent({type:"sessionstart"})}};const Bn=new Mr,Hn=new Mr;function Pn(bn,Sn){Sn===null?bn.matrixWorld.copy(bn.matrix):bn.matrixWorld.multiplyMatrices(Sn.matrixWorld,bn.matrix),bn.matrixWorldInverse.copy(bn.matrixWorld).invert()}this.updateCamera=function(bn){if(lt===null)return;Cr.near=wr.near=gr.near=bn.near,Cr.far=wr.far=gr.far=bn.far,zr===Cr.near&&Gr===Cr.far||(lt.updateRenderState({depthNear:Cr.near,depthFar:Cr.far}),zr=Cr.near,Gr=Cr.far);const Sn=bn.parent,Kn=Cr.cameras;Pn(Cr,Sn);for(let Zn=0;Zn<Kn.length;Zn++)Pn(Kn[Zn],Sn);Cr.matrixWorld.decompose(Cr.position,Cr.quaternion,Cr.scale),bn.matrix.copy(Cr.matrix),bn.matrix.decompose(bn.position,bn.quaternion,bn.scale);const kn=bn.children;for(let Zn=0,Rs=kn.length;Zn<Rs;Zn++)kn[Zn].updateMatrixWorld(!0);Kn.length===2?function(Zn,Rs,wo){Bn.setFromMatrixPosition(Rs.matrixWorld),Hn.setFromMatrixPosition(wo.matrixWorld);const Ds=Bn.distanceTo(Hn),fo=Rs.projectionMatrix.elements,Fr=wo.projectionMatrix.elements,Br=fo[14]/(fo[10]-1),fn=fo[14]/(fo[10]+1),rn=(fo[9]+1)/fo[5],Ur=(fo[9]-1)/fo[5],Zr=(fo[8]-1)/fo[0],xn=(Fr[8]+1)/Fr[0],_r=Br*Zr,En=Br*xn,dn=Ds/(-Zr+xn),Dn=dn*-Zr;Rs.matrixWorld.decompose(Zn.position,Zn.quaternion,Zn.scale),Zn.translateX(Dn),Zn.translateZ(dn),Zn.matrixWorld.compose(Zn.position,Zn.quaternion,Zn.scale),Zn.matrixWorldInverse.copy(Zn.matrixWorld).invert();const Nn=Br+dn,as=fn+dn,Bs=_r-Dn,Qs=En+(Ds-Dn),lo=rn*fn/as*Nn,zs=Ur*fn/as*Nn;Zn.projectionMatrix.makePerspective(Bs,Qs,lo,zs,Nn,as)}(Cr,gr,wr):Cr.projectionMatrix.copy(gr.projectionMatrix)},this.getCamera=function(){return Cr},this.getFoveation=function(){return Ut!==null?Ut.fixedFoveation:Lt!==null?Lt.fixedFoveation:void 0},this.setFoveation=function(bn){Ut!==null&&(Ut.fixedFoveation=bn),Lt!==null&&Lt.fixedFoveation!==void 0&&(Lt.fixedFoveation=bn)};let es=null;this.onPreAnimationFrameCallback=null;const ts=new J_;ts.setAnimationLoop(function(bn,Sn){if(at.onPreAnimationFrameCallback&&at.onPreAnimationFrameCallback(bn,Sn),Tt=Sn.getViewerPose(Ct||vt),Gt=Sn,Tt!==null){const Kn=Tt.views;Lt!==null&&(_.setRenderTargetFramebuffer(lr,Lt.framebuffer),_.setRenderTarget(lr));let kn=!1;Kn.length!==Cr.cameras.length&&(Cr.cameras.length=0,kn=!0);for(let Zn=0;Zn<Kn.length;Zn++){const Rs=Kn[Zn];let wo=null;if(Lt!==null)wo=Lt.getViewport(Rs);else{const fo=Ot.getViewSubImage(Ut,Rs);wo=fo.viewport,Zn===0&&(_.setRenderTargetTextures(lr,fo.colorTexture,Ut.ignoreDepthValues?void 0:fo.depthStencilTexture),_.setRenderTarget(lr))}let Ds=Er[Zn];Ds===void 0&&(Ds=new op,Ds.layers.enable(Zn),Ds.viewport=new qo,Er[Zn]=Ds),Ds.matrix.fromArray(Rs.transform.matrix),Ds.projectionMatrix.fromArray(Rs.projectionMatrix),Ds.viewport.set(wo.x,wo.y,wo.width,wo.height),Zn===0&&Cr.matrix.copy(Ds.matrix),kn===!0&&Cr.cameras.push(Ds)}}for(let Kn=0;Kn<ur.length;Kn++){const kn=cr[Kn],Zn=ur[Kn];kn!==null&&Zn!==void 0&&Zn.update(kn,Sn,Ct||vt)}es&&es(bn,Sn),Gt=null}),this.setAnimationLoop=function(bn){es=bn},this.dispose=function(){}}}function TM(wt,_){function st(at,lt){at.opacity.value=lt.opacity,lt.color&&at.diffuse.value.copy(lt.color),lt.emissive&&at.emissive.value.copy(lt.emissive).multiplyScalar(lt.emissiveIntensity),lt.map&&(at.map.value=lt.map),lt.alphaMap&&(at.alphaMap.value=lt.alphaMap),lt.bumpMap&&(at.bumpMap.value=lt.bumpMap,at.bumpScale.value=lt.bumpScale,lt.side===Yt&&(at.bumpScale.value*=-1)),lt.displacementMap&&(at.displacementMap.value=lt.displacementMap,at.displacementScale.value=lt.displacementScale,at.displacementBias.value=lt.displacementBias),lt.emissiveMap&&(at.emissiveMap.value=lt.emissiveMap),lt.normalMap&&(at.normalMap.value=lt.normalMap,at.normalScale.value.copy(lt.normalScale),lt.side===Yt&&at.normalScale.value.negate()),lt.specularMap&&(at.specularMap.value=lt.specularMap),lt.alphaTest>0&&(at.alphaTest.value=lt.alphaTest);const ft=_.get(lt).envMap;if(ft){at.envMap.value=ft;const Ct=_.get(lt).environment||ft;at.envMapRotation.value=Ct?Ct.rotation:0,at.flipEnvMap.value=ft.isCubeTexture&&ft.isRenderTargetTexture===!1?-1:1,at.reflectivity.value=lt.reflectivity,at.ior.value=lt.ior,at.refractionRatio.value=lt.refractionRatio}if(lt.lightMap){at.lightMap.value=lt.lightMap;const Ct=wt.physicallyCorrectLights!==!0?Math.PI:1;at.lightMapIntensity.value=lt.lightMapIntensity*Ct}let vt,At;lt.aoMap&&(at.aoMap.value=lt.aoMap,at.aoMapIntensity.value=lt.aoMapIntensity),lt.map?vt=lt.map:lt.specularMap?vt=lt.specularMap:lt.displacementMap?vt=lt.displacementMap:lt.normalMap?vt=lt.normalMap:lt.bumpMap?vt=lt.bumpMap:lt.roughnessMap?vt=lt.roughnessMap:lt.metalnessMap?vt=lt.metalnessMap:lt.alphaMap?vt=lt.alphaMap:lt.emissiveMap?vt=lt.emissiveMap:lt.clearcoatMap?vt=lt.clearcoatMap:lt.clearcoatNormalMap?vt=lt.clearcoatNormalMap:lt.clearcoatRoughnessMap?vt=lt.clearcoatRoughnessMap:lt.iridescenceMap?vt=lt.iridescenceMap:lt.iridescenceThicknessMap?vt=lt.iridescenceThicknessMap:lt.specularIntensityMap?vt=lt.specularIntensityMap:lt.specularColorMap?vt=lt.specularColorMap:lt.transmissionMap?vt=lt.transmissionMap:lt.thicknessMap?vt=lt.thicknessMap:lt.sheenColorMap?vt=lt.sheenColorMap:lt.sheenRoughnessMap&&(vt=lt.sheenRoughnessMap),vt!==void 0&&(vt.isWebGLRenderTarget&&(vt=vt.texture),vt.matrixAutoUpdate===!0&&vt.updateMatrix(),at.uvTransform.value.copy(vt.matrix)),lt.aoMap?At=lt.aoMap:lt.lightMap&&(At=lt.lightMap),At!==void 0&&(At.isWebGLRenderTarget&&(At=At.texture),At.matrixAutoUpdate===!0&&At.updateMatrix(),at.uv2Transform.value.copy(At.matrix))}return{refreshFogUniforms:function(at,lt){at.fogColor.value.copy(lt.color),lt.isFog?(at.fogNear.value=lt.near,at.fogFar.value=lt.far):lt.isFogExp2&&(at.fogDensity.value=lt.density)},refreshMaterialUniforms:function(at,lt,ft,vt,At){lt.isMeshBasicMaterial||lt.isMeshLambertMaterial?st(at,lt):lt.isMeshToonMaterial?(st(at,lt),function(Ct,Tt){Tt.gradientMap&&(Ct.gradientMap.value=Tt.gradientMap)}(at,lt)):lt.isMeshPhongMaterial?(st(at,lt),function(Ct,Tt){Ct.specular.value.copy(Tt.specular),Ct.shininess.value=Math.max(Tt.shininess,1e-4)}(at,lt)):lt.isMeshStandardMaterial?(st(at,lt),function(Ct,Tt){Ct.roughness.value=Tt.roughness,Ct.metalness.value=Tt.metalness,Tt.roughnessMap&&(Ct.roughnessMap.value=Tt.roughnessMap),Tt.metalnessMap&&(Ct.metalnessMap.value=Tt.metalnessMap),_.get(Tt).envMap&&(Ct.envMapIntensity.value=Tt.envMapIntensity)}(at,lt),lt.isMeshPhysicalMaterial&&function(Ct,Tt,Ot){Ct.ior.value=Tt.ior,Tt.sheen>0&&(Ct.sheenColor.value.copy(Tt.sheenColor).multiplyScalar(Tt.sheen),Ct.sheenRoughness.value=Tt.sheenRoughness,Tt.sheenColorMap&&(Ct.sheenColorMap.value=Tt.sheenColorMap),Tt.sheenRoughnessMap&&(Ct.sheenRoughnessMap.value=Tt.sheenRoughnessMap)),Tt.clearcoat>0&&(Ct.clearcoat.value=Tt.clearcoat,Ct.clearcoatRoughness.value=Tt.clearcoatRoughness,Tt.clearcoatMap&&(Ct.clearcoatMap.value=Tt.clearcoatMap),Tt.clearcoatRoughnessMap&&(Ct.clearcoatRoughnessMap.value=Tt.clearcoatRoughnessMap),Tt.clearcoatNormalMap&&(Ct.clearcoatNormalScale.value.copy(Tt.clearcoatNormalScale),Ct.clearcoatNormalMap.value=Tt.clearcoatNormalMap,Tt.side===Yt&&Ct.clearcoatNormalScale.value.negate())),Tt.iridescence>0&&(Ct.iridescence.value=Tt.iridescence,Ct.iridescenceIOR.value=Tt.iridescenceIOR,Ct.iridescenceThicknessMinimum.value=Tt.iridescenceThicknessRange[0],Ct.iridescenceThicknessMaximum.value=Tt.iridescenceThicknessRange[1],Tt.iridescenceMap&&(Ct.iridescenceMap.value=Tt.iridescenceMap),Tt.iridescenceThicknessMap&&(Ct.iridescenceThicknessMap.value=Tt.iridescenceThicknessMap)),Tt.transmission>0&&(Ct.transmission.value=Tt.transmission,Ct.transmissionSamplerMap.value=Ot.texture,Ct.transmissionSamplerSize.value.set(Ot.width,Ot.height),Tt.transmissionMap&&(Ct.transmissionMap.value=Tt.transmissionMap),Ct.thickness.value=Tt.thickness,Tt.thicknessMap&&(Ct.thicknessMap.value=Tt.thicknessMap),Ct.attenuationDistance.value=Tt.attenuationDistance,Ct.attenuationColor.value.copy(Tt.attenuationColor)),Ct.specularIntensity.value=Tt.specularIntensity,Ct.specularColor.value.copy(Tt.specularColor),Tt.specularIntensityMap&&(Ct.specularIntensityMap.value=Tt.specularIntensityMap),Tt.specularColorMap&&(Ct.specularColorMap.value=Tt.specularColorMap)}(at,lt,At)):lt.isMeshMatcapMaterial?(st(at,lt),function(Ct,Tt){Tt.matcap&&(Ct.matcap.value=Tt.matcap)}(at,lt)):lt.isMeshDepthMaterial?st(at,lt):lt.isMeshDistanceMaterial?(st(at,lt),function(Ct,Tt){Ct.referencePosition.value.copy(Tt.referencePosition),Ct.nearDistance.value=Tt.nearDistance,Ct.farDistance.value=Tt.farDistance}(at,lt)):lt.isMeshNormalMaterial?st(at,lt):lt.isLineBasicMaterial?(function(Ct,Tt){Ct.diffuse.value.copy(Tt.color),Ct.opacity.value=Tt.opacity}(at,lt),lt.isLineDashedMaterial&&function(Ct,Tt){Ct.dashSize.value=Tt.dashSize,Ct.totalSize.value=Tt.dashSize+Tt.gapSize,Ct.scale.value=Tt.scale}(at,lt)):lt.isPointsMaterial?function(Ct,Tt,Ot,Ut){let Lt;Ct.diffuse.value.copy(Tt.color),Ct.opacity.value=Tt.opacity,Ct.size.value=Tt.size*Ot,Ct.scale.value=.5*Ut,Tt.map&&(Ct.map.value=Tt.map),Tt.alphaMap&&(Ct.alphaMap.value=Tt.alphaMap),Tt.alphaTest>0&&(Ct.alphaTest.value=Tt.alphaTest),Tt.map?Lt=Tt.map:Tt.alphaMap&&(Lt=Tt.alphaMap),Lt!==void 0&&(Lt.matrixAutoUpdate===!0&&Lt.updateMatrix(),Ct.uvTransform.value.copy(Lt.matrix))}(at,lt,ft,vt):lt.isSpriteMaterial?function(Ct,Tt){let Ot;Ct.diffuse.value.copy(Tt.color),Ct.opacity.value=Tt.opacity,Ct.rotation.value=Tt.rotation,Tt.map&&(Ct.map.value=Tt.map),Tt.alphaMap&&(Ct.alphaMap.value=Tt.alphaMap),Tt.alphaTest>0&&(Ct.alphaTest.value=Tt.alphaTest),Tt.map?Ot=Tt.map:Tt.alphaMap&&(Ot=Tt.alphaMap),Ot!==void 0&&(Ot.matrixAutoUpdate===!0&&Ot.updateMatrix(),Ct.uvTransform.value.copy(Ot.matrix))}(at,lt):lt.isShadowMaterial?(at.color.value.copy(lt.color),at.opacity.value=lt.opacity):lt.isShaderMaterial&&(lt.transmission!==void 0&&(at.transmission&&(at.transmission.value=lt.transmission),at.transmissionSamplerMap&&At&&(at.transmissionSamplerMap.value=At?At.texture:null),at.transmissionSamplerSize&&At&&at.transmissionSamplerSize.value.set(At.width,At.height)),lt.uniformsNeedUpdate=!1)}}}function MM(wt,_,st,at){let lt={},ft={},vt=[];const At=st.isWebGL2?wt.getParameter(35375):0;function Ct(Ut,Lt,Gt){const Xt=Ut.value;if(Gt[Lt]===void 0)return Gt[Lt]=typeof Xt=="number"?Xt:Xt.clone(),!0;if(typeof Xt=="number"){if(Gt[Lt]!==Xt)return Gt[Lt]=Xt,!0}else{const Qt=Gt[Lt];if(Qt.equals(Xt)===!1)return Qt.copy(Xt),!0}return!1}function Tt(Ut){const Lt=Ut.value,Gt={boundary:0,storage:0};return typeof Lt=="number"?(Gt.boundary=4,Gt.storage=4):Lt.isVector2?(Gt.boundary=8,Gt.storage=8):Lt.isVector3||Lt.isColor?(Gt.boundary=16,Gt.storage=12):Lt.isVector4?(Gt.boundary=16,Gt.storage=16):Lt.isMatrix3?(Gt.boundary=48,Gt.storage=48):Lt.isMatrix4?(Gt.boundary=64,Gt.storage=64):Lt.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",Lt),Gt}function Ot(Ut){const Lt=Ut.target;Lt.removeEventListener("dispose",Ot);const Gt=vt.indexOf(Lt.__bindingPointIndex);vt.splice(Gt,1),wt.deleteBuffer(lt[Lt.id]),delete lt[Lt.id],delete ft[Lt.id]}return{bind:function(Ut,Lt){const Gt=Lt.program;at.uniformBlockBinding(Ut,Gt)},update:function(Ut,Lt){let Gt=lt[Ut.id];Gt===void 0&&(function(lr){const ur=lr.uniforms;let cr=0,gr=0;for(let wr=0,Er=ur.length;wr<Er;wr++){const Cr=ur[wr],zr=Tt(Cr);if(Cr.__data=new Float32Array(zr.storage/Float32Array.BYTES_PER_ELEMENT),Cr.__offset=cr,wr>0){gr=cr%16;const Gr=16-gr;gr!==0&&Gr-zr.boundary<0&&(cr+=16-gr,Cr.__offset=cr)}cr+=zr.storage}gr=cr%16,gr>0&&(cr+=16-gr),lr.__size=cr,lr.__cache={}}(Ut),Gt=function(lr){const ur=function(){for(let Er=0;Er<At;Er++)if(vt.indexOf(Er)===-1)return vt.push(Er),Er;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();lr.__bindingPointIndex=ur;const cr=wt.createBuffer(),gr=lr.__size,wr=lr.usage;return wt.bindBuffer(35345,cr),wt.bufferData(35345,gr,wr),wt.bindBuffer(35345,null),wt.bindBufferBase(35345,ur,cr),cr}(Ut),lt[Ut.id]=Gt,Ut.addEventListener("dispose",Ot));const Xt=Lt.program;at.updateUBOMapping(Ut,Xt);const Qt=_.render.frame;ft[Ut.id]!==Qt&&(function(lr){const ur=lt[lr.id],cr=lr.uniforms,gr=lr.__cache;wt.bindBuffer(35345,ur);for(let wr=0,Er=cr.length;wr<Er;wr++){const Cr=cr[wr];if(Ct(Cr,wr,gr)===!0){const zr=Cr.value,Gr=Cr.__offset;typeof zr=="number"?(Cr.__data[0]=zr,wt.bufferSubData(35345,Gr,Cr.__data)):(Cr.value.isMatrix3?(Cr.__data[0]=Cr.value.elements[0],Cr.__data[1]=Cr.value.elements[1],Cr.__data[2]=Cr.value.elements[2],Cr.__data[3]=Cr.value.elements[0],Cr.__data[4]=Cr.value.elements[3],Cr.__data[5]=Cr.value.elements[4],Cr.__data[6]=Cr.value.elements[5],Cr.__data[7]=Cr.value.elements[0],Cr.__data[8]=Cr.value.elements[6],Cr.__data[9]=Cr.value.elements[7],Cr.__data[10]=Cr.value.elements[8],Cr.__data[11]=Cr.value.elements[0]):zr.toArray(Cr.__data),wt.bufferSubData(35345,Gr,Cr.__data))}}wt.bindBuffer(35345,null)}(Ut),ft[Ut.id]=Qt)},dispose:function(){for(const Ut in lt)wt.deleteBuffer(lt[Ut]);vt=[],lt={},ft={}}}}function fu(wt={}){this.isWebGLRenderer=!0;const _=wt.canvas!==void 0?wt.canvas:function(){const Or=z_("canvas");return Or.style.display="block",Or}(),st=wt.context!==void 0?wt.context:null,at=wt.depth===void 0||wt.depth,lt=wt.stencil===void 0||wt.stencil,ft=wt.antialias!==void 0&&wt.antialias,vt=wt.premultipliedAlpha===void 0||wt.premultipliedAlpha,At=wt.preserveDrawingBuffer!==void 0&&wt.preserveDrawingBuffer,Ct=wt.powerPreference!==void 0?wt.powerPreference:"default",Tt=wt.failIfMajorPerformanceCaveat!==void 0&&wt.failIfMajorPerformanceCaveat;let Ot;Ot=st!==null?st.getContextAttributes().alpha:wt.alpha!==void 0&&wt.alpha;let Ut=null,Lt=null;const Gt=[],Xt=[];this.domElement=_,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Sm,this.physicallyCorrectLights=!1,this.toneMapping=Vs,this.toneMappingExposure=1,this.userData={},Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const Qt=this;let lr=!1,ur=0,cr=0,gr=null,wr=-1,Er=null;const Cr=new qo,zr=new qo;let Gr=null,on=_.width,ln=_.height,Wr=1,Bn=null,Hn=null;const Pn=new qo(0,0,on,ln),es=new qo(0,0,on,ln);let ts=!1;const bn=new Kw;let Sn=!1,Kn=!1,kn=null;const Zn=new Ys,Rs=new Vn,wo=new Mr,Ds={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function fo(){return gr===null?Wr:1}let Fr,Br,fn,rn,Ur,Zr,xn,_r,En,dn,Dn,Nn,as,Bs,Qs,lo,zs,Hs,_l,Nm,so,Ml,Rl,KE,hs=st;function AR(Or,Mn){for(let Un=0;Un<Or.length;Un++){const Ln=Or[Un],Xn=_.getContext(Ln,Mn);if(Xn!==null)return Xn}return null}try{const Or={alpha:!0,depth:at,stencil:lt,antialias:ft,premultipliedAlpha:vt,preserveDrawingBuffer:At,powerPreference:Ct,failIfMajorPerformanceCaveat:Tt};if("setAttribute"in _&&_.setAttribute("data-engine",`three.js r${et}`),_.addEventListener("webglcontextlost",tT,!1),_.addEventListener("webglcontextrestored",wR,!1),_.addEventListener("webglcontextcreationerror",rT,!1),hs===null){const Mn=["webgl2","webgl","experimental-webgl"];if(Qt.isWebGL1Renderer===!0&&Mn.shift(),hs=AR(Mn,Or),hs===null)throw AR(Mn)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}hs.getShaderPrecisionFormat===void 0&&(hs.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Or){throw console.error("THREE.WebGLRenderer: "+Or.message),Or}function bR(){Fr=new os(hs),Br=new HT(hs,Fr,wt),Fr.init(Br),Ml=new eE(hs,Fr,Br),fn=new lC(hs,Fr,Br),rn=new Mv,Ur=new AM,Zr=new uC(hs,Fr,fn,Ur,Br,Ml,rn),xn=new _P(Qt),_r=new YT(Qt),En=new WA(hs,Br),Rl=new gP(hs,Fr,En,Br),dn=new io(hs,En,rn,Rl),Dn=new Dl(hs,dn,En,rn),_l=new KT(hs,Br,Zr),lo=new vP(Ur),Nn=new xP(Qt,xn,_r,Fr,Br,Rl,lo),as=new TM(Qt,Ur),Bs=new oC,Qs=new EM(Fr,Br),Hs=new mP(Qt,xn,fn,Dn,Ot,vt),zs=new SM(Qt,Dn,Br),KE=new MM(hs,rn,Br,fn),Nm=new QT(hs,Fr,rn,Br),so=new YA(hs,Fr,rn,Br),rn.programs=Nn.programs,Qt.capabilities=Br,Qt.extensions=Fr,Qt.properties=Ur,Qt.renderLists=Bs,Qt.shadowMap=zs,Qt.state=fn,Qt.info=rn,Qt.background=Hs,Qt.cubeuvmaps=_r}bR();const Yp=new a1(Qt,hs);function tT(Or){Or.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),lr=!0}function wR(){console.log("THREE.WebGLRenderer: Context Restored."),lr=!1;const Or=rn.autoReset,Mn=zs.enabled,Un=zs.autoUpdate,Ln=zs.needsUpdate,Xn=zs.type;bR(),rn.autoReset=Or,zs.enabled=Mn,zs.autoUpdate=Un,zs.needsUpdate=Ln,zs.type=Xn}function rT(Or){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Or.statusMessage)}function Po(Or){const Mn=Or.target;Mn.removeEventListener("dispose",Po),function(Un){(function(Ln){const Xn=Ur.get(Ln).programs;Xn!==void 0&&(Xn.forEach(function(Es){Nn.releaseProgram(Es)}),Ln.isShaderMaterial&&Nn.releaseShaderCache(Ln))})(Un),Ur.remove(Un)}(Mn)}this.xr=Yp,this.getContext=function(){return hs},this.getContextAttributes=function(){return hs.getContextAttributes()},this.forceContextLoss=function(){const Or=Fr.get("WEBGL_lose_context");Or&&Or.loseContext()},this.forceContextRestore=function(){const Or=Fr.get("WEBGL_lose_context");Or&&Or.restoreContext()},this.getPixelRatio=function(){return Wr},this.setPixelRatio=function(Or){Or!==void 0&&(Wr=Or,this.setSize(on,ln,!1))},this.getSize=function(Or){return Or.set(on,ln)},this.setSize=function(Or,Mn,Un){Yp.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(on=Or,ln=Mn,_.width=Math.floor(Or*Wr),_.height=Math.floor(Mn*Wr),Un!==!1&&(_.style.width=Or+"px",_.style.height=Mn+"px"),this.setViewport(0,0,Or,Mn))},this.getDrawingBufferSize=function(Or){return Or.set(on*Wr,ln*Wr).floor()},this.setDrawingBufferSize=function(Or,Mn,Un){on=Or,ln=Mn,Wr=Un,_.width=Math.floor(Or*Un),_.height=Math.floor(Mn*Un),this.setViewport(0,0,Or,Mn)},this.getCurrentViewport=function(Or){return Or.copy(Cr)},this.getViewport=function(Or){return Or.copy(Pn)},this.setViewport=function(Or,Mn,Un,Ln){Or.isVector4?Pn.set(Or.x,Or.y,Or.z,Or.w):Pn.set(Or,Mn,Un,Ln),fn.viewport(Cr.copy(Pn).multiplyScalar(Wr).floor())},this.getScissor=function(Or){return Or.copy(es)},this.setScissor=function(Or,Mn,Un,Ln){Or.isVector4?es.set(Or.x,Or.y,Or.z,Or.w):es.set(Or,Mn,Un,Ln),fn.scissor(zr.copy(es).multiplyScalar(Wr).floor())},this.getScissorTest=function(){return ts},this.setScissorTest=function(Or){fn.setScissorTest(ts=Or)},this.setOpaqueSort=function(Or){Bn=Or},this.setTransparentSort=function(Or){Hn=Or},this.getClearColor=function(Or){return Or.copy(Hs.getClearColor())},this.setClearColor=function(){Hs.setClearColor.apply(Hs,arguments)},this.getClearAlpha=function(){return Hs.getClearAlpha()},this.setClearAlpha=function(){Hs.setClearAlpha.apply(Hs,arguments)},this.clear=function(Or=!0,Mn=!0,Un=!0){let Ln=0;Or&&(Ln|=16384),Mn&&(Ln|=256),Un&&(Ln|=1024),hs.clear(Ln)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){_.removeEventListener("webglcontextlost",tT,!1),_.removeEventListener("webglcontextrestored",wR,!1),_.removeEventListener("webglcontextcreationerror",rT,!1),Bs.dispose(),Qs.dispose(),Ur.dispose(),xn.dispose(),_r.dispose(),Dn.dispose(),Rl.dispose(),KE.dispose(),Nn.dispose(),Yp.dispose(),Yp.removeEventListener("sessionstart",Kp),Yp.removeEventListener("sessionend",xR),kn&&(kn.dispose(),kn=null),cA.stop()},this.renderBufferDirect=function(Or,Mn,Un,Ln,Xn,Es){Mn===null&&(Mn=Ds);const $o=Xn.isMesh&&Xn.matrixWorld.determinant()<0,Gs=function(Ap,ex,$v,Zs,cp){ex.isScene!==!0&&(ex=Ds),Zr.resetTextureUnits();const eS=ex.fog,oT=Zs.isMeshStandardMaterial?ex.environment:null,CR=gr===null?Qt.outputEncoding:gr.isXRRenderTarget===!0||gr.texture.encoding&&gr.texture.encoding!==bo?gr.texture.encoding:Sm,tx=(Zs.isMeshStandardMaterial?_r:xn).get(Zs.envMap||oT),lv=Zs.vertexColors===!0&&!!$v.attributes.color&&$v.attributes.color.itemSize===4,DP=!!Zs.normalMap&&!!$v.attributes.tangent,TR=!!$v.morphAttributes.position,aT=!!$v.morphAttributes.normal,BP=!!$v.morphAttributes.color,kP=Zs.toneMapped?Qt.toneMapping:Vs,tS=$v.morphAttributes.position||$v.morphAttributes.normal||$v.morphAttributes.color,OP=tS!==void 0?tS.length:0,Bl=Ur.get(Zs),MR=Lt.state.lights;if(Sn===!0&&(Kn===!0||Ap!==Er)){const Jp=Ap===Er&&Zs.id===wr;lo.setState(Zs,Ap,Jp)}let b_=!1;Zs.version===Bl.__version?Bl.needsLights&&Bl.lightsStateVersion!==MR.state.version||Bl.outputEncoding!==CR||cp.isInstancedMesh&&Bl.instancing===!1?b_=!0:cp.isInstancedMesh||Bl.instancing!==!0?cp.isSkinnedMesh&&Bl.skinning===!1?b_=!0:cp.isSkinnedMesh||Bl.skinning!==!0?Bl.envMap!==tx||Zs.fog===!0&&Bl.fog!==eS?b_=!0:Bl.numClippingPlanes===void 0||Bl.numClippingPlanes===lo.numPlanes&&Bl.numIntersection===lo.numIntersection?(Bl.vertexAlphas!==lv||Bl.vertexTangents!==DP||Bl.morphTargets!==TR||Bl.morphNormals!==aT||Bl.morphColors!==BP||Bl.toneMapping!==kP||Br.isWebGL2===!0&&Bl.morphTargetsCount!==OP)&&(b_=!0):b_=!0:b_=!0:b_=!0:(b_=!0,Bl.__version=Zs.version);let w_=Bl.currentProgram;b_===!0&&(w_=X1(Zs,ex,cp));let rS=!1,dA=!1,Xp=!1;const bp=w_.getUniforms(),jv=Bl.uniforms;if(fn.useProgram(w_.program)&&(rS=!0,dA=!0,Xp=!0),Zs.id!==wr&&(wr=Zs.id,dA=!0),rS||Er!==Ap){if(bp.setValue(hs,"projectionMatrix",Ap.projectionMatrix),Br.logarithmicDepthBuffer&&bp.setValue(hs,"logDepthBufFC",2/(Math.log(Ap.far+1)/Math.LN2)),Er!==Ap&&(Er=Ap,dA=!0,Xp=!0),Zs.isShaderMaterial||Zs.isMeshPhongMaterial||Zs.isMeshToonMaterial||Zs.isMeshStandardMaterial||Zs.envMap){const Jp=bp.map.cameraPosition;Jp!==void 0&&Jp.setValue(hs,wo.setFromMatrixPosition(Ap.matrixWorld))}(Zs.isMeshPhongMaterial||Zs.isMeshToonMaterial||Zs.isMeshLambertMaterial||Zs.isMeshBasicMaterial||Zs.isMeshStandardMaterial||Zs.isShaderMaterial)&&bp.setValue(hs,"isOrthographic",Ap.isOrthographicCamera===!0),(Zs.isMeshPhongMaterial||Zs.isMeshToonMaterial||Zs.isMeshLambertMaterial||Zs.isMeshBasicMaterial||Zs.isMeshStandardMaterial||Zs.isShaderMaterial||Zs.isShadowMaterial||cp.isSkinnedMesh)&&bp.setValue(hs,"viewMatrix",Ap.matrixWorldInverse)}if(cp.isSkinnedMesh){bp.setOptional(hs,cp,"bindMatrix"),bp.setOptional(hs,cp,"bindMatrixInverse");const Jp=cp.skeleton;Jp&&(Br.floatVertexTextures?(Jp.boneTexture===null&&Jp.computeBoneTexture(),bp.setValue(hs,"boneTexture",Jp.boneTexture,Zr),bp.setValue(hs,"boneTextureSize",Jp.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const nS=$v.morphAttributes;var uv,cv;(nS.position!==void 0||nS.normal!==void 0||nS.color!==void 0&&Br.isWebGL2===!0)&&_l.update(cp,$v,Zs,w_),(dA||Bl.receiveShadow!==cp.receiveShadow)&&(Bl.receiveShadow=cp.receiveShadow,bp.setValue(hs,"receiveShadow",cp.receiveShadow)),Zs.isMeshGouraudMaterial&&Zs.envMap!==null&&(jv.envMap.value=tx,jv.flipEnvMap.value=tx.isCubeTexture&&tx.isRenderTargetTexture===!1?-1:1),dA&&(bp.setValue(hs,"toneMappingExposure",Qt.toneMappingExposure),Bl.needsLights&&(cv=Xp,(uv=jv).ambientLightColor.needsUpdate=cv,uv.lightProbe.needsUpdate=cv,uv.directionalLights.needsUpdate=cv,uv.directionalLightShadows.needsUpdate=cv,uv.pointLights.needsUpdate=cv,uv.pointLightShadows.needsUpdate=cv,uv.spotLights.needsUpdate=cv,uv.spotLightShadows.needsUpdate=cv,uv.rectAreaLights.needsUpdate=cv,uv.hemisphereLights.needsUpdate=cv),eS&&Zs.fog===!0&&as.refreshFogUniforms(jv,eS),as.refreshMaterialUniforms(jv,Zs,Wr,ln,Qt.userData.transmissionRenderTarget||kn),Wx.upload(hs,Bl.uniformsList,jv,Zr)),Zs.isShaderMaterial&&Zs.uniformsNeedUpdate===!0&&(Wx.upload(hs,Bl.uniformsList,jv,Zr),Zs.uniformsNeedUpdate=!1),Zs.isSpriteMaterial&&bp.setValue(hs,"center",cp.center),bp.setValue(hs,"modelViewMatrix",cp.modelViewMatrix),bp.setValue(hs,"normalMatrix",cp.normalMatrix),bp.setValue(hs,"modelMatrix",cp.matrixWorld);const lT=Zs.extraUniformsToUpload;if(lT&&Object.entries(lT).forEach(([Jp,rx])=>bp.setValue(hs,Jp,rx.value,Zr)),Zs.isShaderMaterial||Zs.isRawShaderMaterial){const Jp=Zs.uniformsGroups;for(let rx=0,LP=Jp.length;rx<LP;rx++)if(Br.isWebGL2){const RR=Jp[rx];KE.update(RR,w_),KE.bind(RR,w_)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return w_}(Or,Mn,Un,Ln,Xn);fn.setMaterial(Ln,$o);let xo=Un.index;const nu=Un.attributes.position;if(xo===null){if(nu===void 0||nu.count===0)return}else if(xo.count===0)return;let jo,go=1;Ln.wireframe===!0&&(xo=dn.getWireframeAttribute(Un),go=2),Rl.setup(Xn,Ln,Gs,Un,xo);let Bu=Nm;xo!==null&&(jo=En.get(xo),Bu=so,Bu.setIndex(jo));const J1=xo!==null?xo.count:nu.count,av=Un.drawRange.start*go,JE=Un.drawRange.count*go,A_=Es!==null?Es.start*go:0,iT=Es!==null?Es.count*go:1/0,ZE=Math.max(av,A_),sT=Math.min(J1,av+JE,A_+iT)-1,Z1=Math.max(0,sT-ZE+1);if(Z1!==0){if(Xn.isMesh)Ln.wireframe===!0?(fn.setLineWidth(Ln.wireframeLinewidth*fo()),Bu.setMode(1)):Bu.setMode(4);else if(Xn.isLine){let Ap=Ln.linewidth;Ap===void 0&&(Ap=1),fn.setLineWidth(Ap*fo()),Xn.isLineSegments?Bu.setMode(1):Xn.isLineLoop?Bu.setMode(2):Bu.setMode(3)}else Xn.isPoints?Bu.setMode(0):Xn.isSprite&&Bu.setMode(4);if(Xn.isInstancedMesh)Bu.renderInstances(ZE,Z1,Xn.count);else if(Un.isInstancedBufferGeometry){const Ap=Math.min(Un.instanceCount,Un._maxInstanceCount);Bu.renderInstances(ZE,Z1,Ap)}else Bu.render(ZE,Z1)}},this.compile=function(Or,Mn){function Un(Ln,Xn,Es){Ln.transparent===!0&&Ln.side===dr?(Ln.side=Yt,Ln.needsUpdate=!0,X1(Ln,Xn,Es),Ln.side=rr,Ln.needsUpdate=!0,X1(Ln,Xn,Es),Ln.side=dr):X1(Ln,Xn,Es)}Lt=Qs.get(Or),Lt.init(),Xt.push(Lt),Or.traverseVisible(function(Ln){Ln.isLight&&Ln.layers.test(Mn.layers)&&(Lt.pushLight(Ln),Ln.castShadow&&Lt.pushShadow(Ln))}),Lt.setupLights(Qt.physicallyCorrectLights),Or.traverse(function(Ln){const Xn=Ln.material;if(Xn)if(Array.isArray(Xn))for(let Es=0;Es<Xn.length;Es++)Un(Xn[Es],Or,Ln);else Un(Xn,Or,Ln)}),Xt.pop(),Lt=null};let _u=null;function Kp(){cA.stop()}function xR(){cA.start()}const cA=new J_;function ER(Or,Mn,Un,Ln){if(Or.visible===!1)return;if(Or.layers.test(Mn.layers)){if(Or.isGroup)Un=Or.renderOrder;else if(Or.isLOD)Or.autoUpdate===!0&&Or.update(Mn);else if(Or.isLight)Lt.pushLight(Or),Or.castShadow&&Lt.pushShadow(Or);else if(Or.isSprite){if(!Or.frustumCulled||bn.intersectsSprite(Or)){Ln&&wo.setFromMatrixPosition(Or.matrixWorld).applyMatrix4(Zn);const Es=Dn.update(Or),$o=Or.material;$o.visible&&Ut.push(Or,Es,$o,Un,wo.z,null)}}else if((Or.isMesh||Or.isLine||Or.isPoints)&&(Or.isSkinnedMesh&&Or.skeleton.frame!==rn.render.frame&&(Or.skeleton.update(),Or.skeleton.frame=rn.render.frame),!Or.frustumCulled||bn.intersectsObject(Or))){Ln&&wo.setFromMatrixPosition(Or.matrixWorld).applyMatrix4(Zn);const Es=Dn.update(Or),$o=Or.material;if(Array.isArray($o)){const Gs=Es.groups;for(let xo=0,nu=Gs.length;xo<nu;xo++){const jo=Gs[xo],go=$o[jo.materialIndex];go&&go.visible&&Ut.push(Or,Es,go,Un,wo.z,jo)}}else $o.visible&&Ut.push(Or,Es,$o,Un,wo.z,null)}}const Xn=Or.children;for(let Es=0,$o=Xn.length;Es<$o;Es++)ER(Xn[Es],Mn,Un,Ln)}function SR(Or,Mn,Un,Ln){const Xn=Or.opaque,Es=Or.transmissive,$o=Or.transparent;if(Lt.setupLightsView(Un),Qt.userData.transmissionRender===void 0&&Qt.userData.renderTransmissionPass!==!1&&Es.length>0&&function(Gs,xo,nu){console.error("three.js internal render transmission pass should not be called");const jo=Br.isWebGL2;kn===null&&(kn=new Ip(1,1,{generateMipmaps:!0,type:Fr.has("EXT_color_buffer_half_float")?_d:su,minFilter:ys,samples:jo&&ft===!0?4:0})),Qt.getDrawingBufferSize(Rs),jo?kn.setSize(Rs.x,Rs.y):kn.setSize(fp(Rs.x),fp(Rs.y));const go=Qt.getRenderTarget();Qt.setRenderTarget(kn),Qt.clear();const Bu=Qt.toneMapping;Qt.toneMapping=Vs,XE(Gs,xo,nu),Qt.toneMapping=Bu,Zr.updateMultisampleRenderTarget(kn),Zr.updateRenderTargetMipmap(kn),Qt.setRenderTarget(go)}([...Xn,...$o],Mn,Un),Ln&&fn.viewport(Cr.copy(Ln)),Qt.userData.opaqueRender!==!1&&Xn.length>0&&XE(Xn,Mn,Un),Qt.userData.transparentRender!==!1&&$o.length>0&&XE($o,Mn,Un),Qt.userData.transmissionRender!==!1&&Es.length>0){kn||(kn=new Ip(1,1));const Gs=Qt.userData.transmissionRenderTarget.texture,xo=Br.isWebGL2,nu=Gs.generateMipmaps,jo=Gs.minFilter;xo&&Qt.userData.blurTransmissionTarget&&(Gs.generateMipmaps=!0,Gs.minFilter=ys,Gs.needsUpdate=!0,Zr.updateRenderTargetMipmap(Qt.userData.transmissionRenderTarget)),XE(Es,Mn,Un),xo&&Qt.userData.blurTransmissionTarget&&(Gs.generateMipmaps=nu,Gs.minFilter=jo,Gs.needsUpdate=!0,Zr.updateRenderTargetMipmap(Qt.userData.transmissionRenderTarget))}fn.buffers.depth.setTest(!0),fn.buffers.depth.setMask(!0),fn.buffers.color.setMask(!0),fn.setPolygonOffset(!1)}function XE(Or,Mn,Un){const Ln={...Qt.userData};Qt.userData.opaqueRender=void 0,Qt.userData.transparentRender=void 0,Qt.userData.transmissionRender=void 0,Qt.userData.backgroundRender=void 0;const Xn=Mn.isScene===!0?Mn.overrideMaterial:null;for(let Es=0,$o=Or.length;Es<$o;Es++){const Gs=Or[Es],xo=Gs.object,nu=Gs.geometry,jo=Xn===null?Gs.material:Xn,go=Gs.group;xo.layers.test(Un.layers)&&PP(xo,Mn,Un,nu,jo,go)}Object.assign(Qt.userData,Ln)}function PP(Or,Mn,Un,Ln,Xn,Es){Or.onBeforeRender(Qt,Mn,Un,Ln,Xn,Es),Or.modelViewMatrix.multiplyMatrices(Un.matrixWorldInverse,Or.matrixWorld),Or.normalMatrix.getNormalMatrix(Or.modelViewMatrix),Xn.onBeforeRender(Qt,Mn,Un,Ln,Or,Es),Xn.transparent===!0&&Xn.side===dr?(Xn.side=Yt,Xn.needsUpdate=!0,Qt.renderBufferDirect(Un,Mn,Ln,Xn,Or,Es),Xn.side=rr,Xn.needsUpdate=!0,Qt.renderBufferDirect(Un,Mn,Ln,Xn,Or,Es),Xn.side=dr):Qt.renderBufferDirect(Un,Mn,Ln,Xn,Or,Es),Or.onAfterRender(Qt,Mn,Un,Ln,Xn,Es),Xn.onAfterRender(Qt,Mn,Un,Ln,Or,Es)}function X1(Or,Mn,Un){Mn.isScene!==!0&&(Mn=Ds);const Ln=Ur.get(Or),Xn=Lt.state.lights,Es=Lt.state.shadowsArray,$o=Xn.state.version,Gs=Nn.getParameters(Or,Xn.state,Es,Mn,Un),xo=Nn.getProgramCacheKey(Gs);let nu=Ln.programs;Ln.environment=Or.isMeshStandardMaterial?Mn.environment:null,Ln.fog=Mn.fog,Ln.envMap=(Or.isMeshStandardMaterial?_r:xn).get(Or.envMap||Ln.environment),nu===void 0&&(Or.addEventListener("dispose",Po),nu=new Map,Ln.programs=nu);let jo=nu.get(xo);if(jo!==void 0){if(Ln.currentProgram===jo&&Ln.lightsStateVersion===$o)return nT(Or,Gs),jo}else Gs.uniforms=Nn.getUniforms(Or),Or.onBuild(Un,Gs,Qt),Or.onBeforeCompile(Gs,Qt),jo=Nn.acquireProgram(Gs,xo),nu.set(xo,jo),Ln.uniforms=Gs.uniforms;const go=Ln.uniforms;(Or.isShaderMaterial||Or.isRawShaderMaterial)&&Or.clipping!==!0||(go.clippingPlanes=lo.uniform),nT(Or,Gs),Ln.needsLights=function(av){return av.isMeshLambertMaterial||av.isMeshToonMaterial||av.isMeshPhongMaterial||av.isMeshStandardMaterial||av.isShadowMaterial||av.isShaderMaterial&&av.lights===!0}(Or),Ln.lightsStateVersion=$o,Ln.needsLights&&(go.ambientLightColor.value=Xn.state.ambient,go.lightProbe.value=Xn.state.probe,go.directionalLights.value=Xn.state.directional,go.directionalLightShadows.value=Xn.state.directionalShadow,go.spotLights.value=Xn.state.spot,go.spotLightShadows.value=Xn.state.spotShadow,go.rectAreaLights.value=Xn.state.rectArea,go.ltc_1.value=Xn.state.rectAreaLTC1,go.ltc_2.value=Xn.state.rectAreaLTC2,go.pointLights.value=Xn.state.point,go.pointLightShadows.value=Xn.state.pointShadow,go.hemisphereLights.value=Xn.state.hemi,go.directionalShadowMap.value=Xn.state.directionalShadowMap,go.directionalShadowMatrix.value=Xn.state.directionalShadowMatrix,go.spotShadowMap.value=Xn.state.spotShadowMap,go.spotLightMatrix.value=Xn.state.spotLightMatrix,go.spotLightMap.value=Xn.state.spotLightMap,go.pointShadowMap.value=Xn.state.pointShadowMap,go.pointShadowMatrix.value=Xn.state.pointShadowMatrix);const Bu=jo.getUniforms(),J1=Wx.seqWithValue(Bu.seq,go);return Ln.currentProgram=jo,Ln.uniformsList=J1,jo}function nT(Or,Mn){const Un=Ur.get(Or);Un.outputEncoding=Mn.outputEncoding,Un.instancing=Mn.instancing,Un.skinning=Mn.skinning,Un.morphTargets=Mn.morphTargets,Un.morphNormals=Mn.morphNormals,Un.morphColors=Mn.morphColors,Un.morphTargetsCount=Mn.morphTargetsCount,Un.numClippingPlanes=Mn.numClippingPlanes,Un.numIntersection=Mn.numClipIntersection,Un.vertexAlphas=Mn.vertexAlphas,Un.vertexTangents=Mn.vertexTangents,Un.toneMapping=Mn.toneMapping}cA.setAnimationLoop(function(Or){_u&&_u(Or)}),typeof self<"u"&&cA.setContext(self),this.setAnimationLoop=function(Or){_u=Or,Yp.setAnimationLoop(Or),Or===null?cA.stop():cA.start()},Yp.addEventListener("sessionstart",Kp),Yp.addEventListener("sessionend",xR),this.render=function(Or,Mn){if(Mn===void 0||Mn.isCamera===!0){if(lr!==!0){if(Or.matrixWorldAutoUpdate===!0&&Or.updateMatrixWorld(),Mn.parent===null&&Mn.matrixWorldAutoUpdate===!0&&Mn.updateMatrixWorld(),Yp.enabled===!0&&Yp.isPresenting===!0&&(Yp.cameraAutoUpdate===!0&&Yp.updateCamera(Mn),Mn=Yp.getCamera()),Or.isScene===!0&&Or.onBeforeRender(Qt,Or,Mn,gr),Lt=Qs.get(Or,Xt.length),Lt.init(),Xt.push(Lt),Zn.multiplyMatrices(Mn.projectionMatrix,Mn.matrixWorldInverse),bn.setFromProjectionMatrix(Zn),Kn=this.localClippingEnabled,Sn=lo.init(this.clippingPlanes,Kn,Mn),Ut=Bs.get(Or,Gt.length),Ut.init(),Gt.push(Ut),ER(Or,Mn,0,Qt.sortObjects),Ut.finish(),Qt.sortObjects===!0&&Ut.sort(Bn,Hn),Qt.userData.shadowMapRender){Sn===!0&&lo.beginShadows();const Un=Lt.state.shadowsArray;Un.length>0&&zs.render(Un,Or,Mn),Sn===!0&&lo.endShadows()}if(this.info.autoReset===!0&&this.info.reset(),Qt.userData.backgroundRender!==!1&&Hs.render(Ut,Or),Qt.userData.sceneRender!==!1)if(Lt.setupLights(Qt.physicallyCorrectLights),Mn.isArrayCamera){const Un=Mn.cameras;for(let Ln=0,Xn=Un.length;Ln<Xn;Ln++){const Es=Un[Ln];SR(Ut,Or,Es,Es.viewport)}}else SR(Ut,Or,Mn);gr!==null&&(Zr.updateMultisampleRenderTarget(gr),Zr.updateRenderTargetMipmap(gr)),Or.isScene===!0&&Or.onAfterRender(Qt,Or,Mn),Rl.resetDefaultState(),wr=-1,Er=null,Xt.pop(),Lt=Xt.length>0?Xt[Xt.length-1]:null,Gt.pop(),Ut=Gt.length>0?Gt[Gt.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return ur},this.getActiveMipmapLevel=function(){return cr},this.getRenderTarget=function(){return gr},this.setRenderTargetTextures=function(Or,Mn,Un){Ur.get(Or.texture).__webglTexture=Mn,Ur.get(Or.depthTexture).__webglTexture=Un;const Ln=Ur.get(Or);Ln.__hasExternalTextures=!0,Ln.__hasExternalTextures&&(Ln.__autoAllocateDepthBuffer=Un===void 0,Ln.__autoAllocateDepthBuffer||Fr.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Ln.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Or,Mn){const Un=Ur.get(Or);Un.__webglFramebuffer=Mn,Un.__useDefaultFramebuffer=Mn===void 0},this.setRenderTarget=function(Or,Mn=0,Un=0){gr=Or,ur=Mn,cr=Un;let Ln=!0;if(Or){const Gs=Ur.get(Or);Gs.__useDefaultFramebuffer!==void 0?(fn.bindFramebuffer(36160,null),Ln=!1):Gs.__webglFramebuffer===void 0?Zr.setupRenderTarget(Or):Gs.__hasExternalTextures&&Zr.rebindTextures(Or,Ur.get(Or.texture).__webglTexture,Ur.get(Or.depthTexture).__webglTexture)}let Xn=null,Es=!1,$o=!1;if(Or){const Gs=Or.texture;(Gs.isData3DTexture||Gs.isDataArrayTexture)&&($o=!0);const xo=Ur.get(Or).__webglFramebuffer;Or.isWebGLCubeRenderTarget?(Xn=xo[Mn],Es=!0):Xn=Br.isWebGL2&&Or.samples>0&&Zr.useMultisampledRTT(Or)===!1?Ur.get(Or).__webglMultisampledFramebuffer:xo,Cr.copy(Or.viewport),zr.copy(Or.scissor),Gr=Or.scissorTest}else Cr.copy(Pn).multiplyScalar(Wr).floor(),zr.copy(es).multiplyScalar(Wr).floor(),Gr=ts;if(fn.bindFramebuffer(36160,Xn)&&Br.drawBuffers&&Ln&&fn.drawBuffers(Or,Xn),fn.viewport(Cr),fn.scissor(zr),fn.setScissorTest(Gr),Es){const Gs=Ur.get(Or.texture);hs.framebufferTexture2D(36160,36064,34069+Mn,Gs.__webglTexture,Un)}else if($o){const Gs=Ur.get(Or.texture),xo=Mn||0;hs.framebufferTextureLayer(36160,36064,Gs.__webglTexture,Un||0,xo)}wr=-1},this.readRenderTargetPixels=function(Or,Mn,Un,Ln,Xn,Es,$o){if(!Or||!Or.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Gs=Ur.get(Or).__webglFramebuffer;if(Or.isWebGLCubeRenderTarget&&$o!==void 0&&(Gs=Gs[$o]),Gs){fn.bindFramebuffer(36160,Gs);try{const xo=Or.texture,nu=xo.format,jo=xo.type;if(nu!==Ps&&Ml.convert(nu)!==hs.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const go=jo===_d&&(Fr.has("EXT_color_buffer_half_float")||Br.isWebGL2&&Fr.has("EXT_color_buffer_float"));if(!(jo===su||Ml.convert(jo)===hs.getParameter(35738)||jo===Cl&&(Br.isWebGL2||Fr.has("OES_texture_float")||Fr.has("WEBGL_color_buffer_float"))||go))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Mn>=0&&Mn<=Or.width-Ln&&Un>=0&&Un<=Or.height-Xn&&hs.readPixels(Mn,Un,Ln,Xn,Ml.convert(nu),Ml.convert(jo),Es)}finally{const xo=gr!==null?Ur.get(gr).__webglFramebuffer:null;fn.bindFramebuffer(36160,xo)}}},this.copyFramebufferToTexture=function(Or,Mn,Un=0){const Ln=Math.pow(2,-Un),Xn=Math.floor(Mn.image.width*Ln),Es=Math.floor(Mn.image.height*Ln);Zr.setTexture2D(Mn,0),hs.copyTexSubImage2D(3553,Un,0,0,Or.x,Or.y,Xn,Es),fn.unbindTexture()},this.copyTextureToTexture=function(Or,Mn,Un,Ln=0){const Xn=Mn.image.width,Es=Mn.image.height,$o=Ml.convert(Un.format),Gs=Ml.convert(Un.type);Zr.setTexture2D(Un,0),hs.pixelStorei(37440,Un.flipY),hs.pixelStorei(37441,Un.premultiplyAlpha),hs.pixelStorei(3317,Un.unpackAlignment),Mn.isDataTexture?hs.texSubImage2D(3553,Ln,Or.x,Or.y,Xn,Es,$o,Gs,Mn.image.data):Mn.isCompressedTexture?hs.compressedTexSubImage2D(3553,Ln,Or.x,Or.y,Mn.mipmaps[0].width,Mn.mipmaps[0].height,$o,Mn.mipmaps[0].data):hs.texSubImage2D(3553,Ln,Or.x,Or.y,$o,Gs,Mn.image),Ln===0&&Un.generateMipmaps&&hs.generateMipmap(3553),fn.unbindTexture()},this.copyTextureToTexture3D=function(Or,Mn,Un,Ln,Xn=0){if(Qt.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Es=Or.max.x-Or.min.x+1,$o=Or.max.y-Or.min.y+1,Gs=Or.max.z-Or.min.z+1,xo=Ml.convert(Ln.format),nu=Ml.convert(Ln.type);let jo;if(Ln.isData3DTexture)Zr.setTexture3D(Ln,0),jo=32879;else{if(!Ln.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Zr.setTexture2DArray(Ln,0),jo=35866}hs.pixelStorei(37440,Ln.flipY),hs.pixelStorei(37441,Ln.premultiplyAlpha),hs.pixelStorei(3317,Ln.unpackAlignment);const go=hs.getParameter(3314),Bu=hs.getParameter(32878),J1=hs.getParameter(3316),av=hs.getParameter(3315),JE=hs.getParameter(32877),A_=Un.isCompressedTexture?Un.mipmaps[0]:Un.image;hs.pixelStorei(3314,A_.width),hs.pixelStorei(32878,A_.height),hs.pixelStorei(3316,Or.min.x),hs.pixelStorei(3315,Or.min.y),hs.pixelStorei(32877,Or.min.z),Un.isDataTexture||Un.isData3DTexture?hs.texSubImage3D(jo,Xn,Mn.x,Mn.y,Mn.z,Es,$o,Gs,xo,nu,A_.data):Un.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),hs.compressedTexSubImage3D(jo,Xn,Mn.x,Mn.y,Mn.z,Es,$o,Gs,xo,A_.data)):hs.texSubImage3D(jo,Xn,Mn.x,Mn.y,Mn.z,Es,$o,Gs,xo,nu,A_),hs.pixelStorei(3314,go),hs.pixelStorei(32878,Bu),hs.pixelStorei(3316,J1),hs.pixelStorei(3315,av),hs.pixelStorei(32877,JE),Xn===0&&Ln.generateMipmaps&&hs.generateMipmap(jo),fn.unbindTexture()},this.initTexture=function(Or){Or.isCubeTexture?Zr.setTextureCube(Or,0):Or.isData3DTexture?Zr.setTexture3D(Or,0):Or.isDataArrayTexture?Zr.setTexture2DArray(Or,0):Zr.setTexture2D(Or,0),fn.unbindTexture()},this.resetState=function(){ur=0,cr=0,gr=null,fn.reset(),Rl.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class pC extends fu{}pC.prototype.isWebGL1Renderer=!0;class J0{constructor(_,st=25e-5){this.isFogExp2=!0,this.name="",this.color=new ms(_),this.density=st}clone(){return new J0(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class ZA{constructor(_,st=1,at=1e3){this.isFog=!0,this.name="",this.color=new ms(_),this.near=st,this.far=at}clone(){return new ZA(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class RM extends ao{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(_,st){return super.copy(_,st),_.background!==null&&(this.background=_.background.clone()),_.environment!==null&&(this.environment=_.environment.clone()),_.fog!==null&&(this.fog=_.fog.clone()),_.overrideMaterial!==null&&(this.overrideMaterial=_.overrideMaterial.clone()),this.matrixAutoUpdate=_.matrixAutoUpdate,this}toJSON(_){const st=super.toJSON(_);return this.fog!==null&&(st.object.fog=this.fog.toJSON()),st}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(_){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=_}}class rE{constructor(_,st){this.isInterleavedBuffer=!0,this.array=_,this.stride=st,this.count=_!==void 0?_.length/st:0,this.usage=F_,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=rp()}onUploadCallback(){}set needsUpdate(_){_===!0&&this.version++}setUsage(_){return this.usage=_,this}copy(_){return this.array=new _.array.constructor(_.array),this.count=_.count,this.stride=_.stride,this.usage=_.usage,this}copyAt(_,st,at){_*=this.stride,at*=st.stride;for(let lt=0,ft=this.stride;lt<ft;lt++)this.array[_+lt]=st.array[at+lt];return this}set(_,st=0){return this.array.set(_,st),this}clone(_){_.arrayBuffers===void 0&&(_.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=rp()),_.arrayBuffers[this.array.buffer._uuid]===void 0&&(_.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const st=new this.array.constructor(_.arrayBuffers[this.array.buffer._uuid]),at=new this.constructor(st,this.stride);return at.setUsage(this.usage),at}onUpload(_){return this.onUploadCallback=_,this}toJSON(_){return _.arrayBuffers===void 0&&(_.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=rp()),_.arrayBuffers[this.array.buffer._uuid]===void 0&&(_.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const kp=new Mr;class d_{constructor(_,st,at,lt=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=_,this.itemSize=st,this.offset=at,this.normalized=lt===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(_){this.data.needsUpdate=_}applyMatrix4(_){for(let st=0,at=this.data.count;st<at;st++)kp.fromBufferAttribute(this,st),kp.applyMatrix4(_),this.setXYZ(st,kp.x,kp.y,kp.z);return this}applyNormalMatrix(_){for(let st=0,at=this.count;st<at;st++)kp.fromBufferAttribute(this,st),kp.applyNormalMatrix(_),this.setXYZ(st,kp.x,kp.y,kp.z);return this}transformDirection(_){for(let st=0,at=this.count;st<at;st++)kp.fromBufferAttribute(this,st),kp.transformDirection(_),this.setXYZ(st,kp.x,kp.y,kp.z);return this}setX(_,st){return this.normalized&&(st=Tl(st,this.array)),this.data.array[_*this.data.stride+this.offset]=st,this}setY(_,st){return this.normalized&&(st=Tl(st,this.array)),this.data.array[_*this.data.stride+this.offset+1]=st,this}setZ(_,st){return this.normalized&&(st=Tl(st,this.array)),this.data.array[_*this.data.stride+this.offset+2]=st,this}setW(_,st){return this.normalized&&(st=Tl(st,this.array)),this.data.array[_*this.data.stride+this.offset+3]=st,this}getX(_){let st=this.data.array[_*this.data.stride+this.offset];return this.normalized&&(st=bv(st,this.array)),st}getY(_){let st=this.data.array[_*this.data.stride+this.offset+1];return this.normalized&&(st=bv(st,this.array)),st}getZ(_){let st=this.data.array[_*this.data.stride+this.offset+2];return this.normalized&&(st=bv(st,this.array)),st}getW(_){let st=this.data.array[_*this.data.stride+this.offset+3];return this.normalized&&(st=bv(st,this.array)),st}setXY(_,st,at){return _=_*this.data.stride+this.offset,this.normalized&&(st=Tl(st,this.array),at=Tl(at,this.array)),this.data.array[_+0]=st,this.data.array[_+1]=at,this}setXYZ(_,st,at,lt){return _=_*this.data.stride+this.offset,this.normalized&&(st=Tl(st,this.array),at=Tl(at,this.array),lt=Tl(lt,this.array)),this.data.array[_+0]=st,this.data.array[_+1]=at,this.data.array[_+2]=lt,this}setXYZW(_,st,at,lt,ft){return _=_*this.data.stride+this.offset,this.normalized&&(st=Tl(st,this.array),at=Tl(at,this.array),lt=Tl(lt,this.array),ft=Tl(ft,this.array)),this.data.array[_+0]=st,this.data.array[_+1]=at,this.data.array[_+2]=lt,this.data.array[_+3]=ft,this}clone(_){if(_===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will deinterleave buffer data.");const st=[];for(let at=0;at<this.count;at++){const lt=at*this.data.stride+this.offset;for(let ft=0;ft<this.itemSize;ft++)st.push(this.data.array[lt+ft])}return new El(new this.array.constructor(st),this.itemSize,this.normalized)}return _.interleavedBuffers===void 0&&(_.interleavedBuffers={}),_.interleavedBuffers[this.data.uuid]===void 0&&(_.interleavedBuffers[this.data.uuid]=this.data.clone(_)),new d_(_.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(_){if(_===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will deinterleave buffer data.");const st=[];for(let at=0;at<this.count;at++){const lt=at*this.data.stride+this.offset;for(let ft=0;ft<this.itemSize;ft++)st.push(this.data.array[lt+ft])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:st,normalized:this.normalized}}return _.interleavedBuffers===void 0&&(_.interleavedBuffers={}),_.interleavedBuffers[this.data.uuid]===void 0&&(_.interleavedBuffers[this.data.uuid]=this.data.toJSON(_)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class nE extends Qu{constructor(_){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new ms(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.alphaMap=_.alphaMap,this.rotation=_.rotation,this.sizeAttenuation=_.sizeAttenuation,this.fog=_.fog,this}}let Z0;const t0=new Mr,Yy=new Mr,p_=new Mr,r0=new Vn,Ky=new Vn,IM=new Ys,ey=new Mr,ty=new Mr,l1=new Mr,iE=new Vn,sE=new Vn,PM=new Vn;class oE extends ao{constructor(_){if(super(),this.isSprite=!0,this.type="Sprite",Z0===void 0){Z0=new xs;const st=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),at=new rE(st,5);Z0.setIndex([0,1,2,0,2,3]),Z0.setAttribute("position",new d_(at,3,0,!1)),Z0.setAttribute("uv",new d_(at,2,3,!1))}this.geometry=Z0,this.material=_!==void 0?_:new nE,this.center=new Vn(.5,.5)}raycast(_,st){_.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Yy.setFromMatrixScale(this.matrixWorld),IM.copy(_.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(_.camera.matrixWorldInverse,this.matrixWorld),p_.setFromMatrixPosition(this.modelViewMatrix),_.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Yy.multiplyScalar(-p_.z);const at=this.material.rotation;let lt,ft;at!==0&&(ft=Math.cos(at),lt=Math.sin(at));const vt=this.center;n0(ey.set(-.5,-.5,0),p_,vt,Yy,lt,ft),n0(ty.set(.5,-.5,0),p_,vt,Yy,lt,ft),n0(l1.set(.5,.5,0),p_,vt,Yy,lt,ft),iE.set(0,0),sE.set(1,0),PM.set(1,1);let At=_.ray.intersectTriangle(ey,ty,l1,!1,t0);if(At===null&&(n0(ty.set(-.5,.5,0),p_,vt,Yy,lt,ft),sE.set(0,1),At=_.ray.intersectTriangle(ey,l1,ty,!1,t0),At===null))return;const Ct=_.ray.origin.distanceTo(t0);Ct<_.near||Ct>_.far||st.push({distance:Ct,point:t0.clone(),uv:Gu.getUV(t0,ey,ty,l1,iE,sE,PM,new Vn),face:null,object:this})}copy(_,st){return super.copy(_,st),_.center!==void 0&&this.center.copy(_.center),this.material=_.material,this}}function n0(wt,_,st,at,lt,ft){r0.subVectors(wt,st).addScalar(.5).multiply(at),lt!==void 0?(Ky.x=ft*r0.x-lt*r0.y,Ky.y=lt*r0.x+ft*r0.y):Ky.copy(r0),wt.copy(_),wt.x+=Ky.x,wt.y+=Ky.y,wt.applyMatrix4(IM)}const _b=new Mr,DM=new Mr;class ew extends ao{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(_){super.copy(_,!1);const st=_.levels;for(let at=0,lt=st.length;at<lt;at++){const ft=st[at];this.addLevel(ft.object.clone(),ft.distance)}return this.autoUpdate=_.autoUpdate,this}addLevel(_,st=0){st=Math.abs(st);const at=this.levels;let lt;for(lt=0;lt<at.length&&!(st<at[lt].distance);lt++);return at.splice(lt,0,{distance:st,object:_}),this.add(_),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(_){const st=this.levels;if(st.length>0){let at,lt;for(at=1,lt=st.length;at<lt&&!(_<st[at].distance);at++);return st[at-1].object}return null}raycast(_,st){if(this.levels.length>0){_b.setFromMatrixPosition(this.matrixWorld);const at=_.ray.origin.distanceTo(_b);this.getObjectForDistance(at).raycast(_,st)}}update(_){const st=this.levels;if(st.length>1){_b.setFromMatrixPosition(_.matrixWorld),DM.setFromMatrixPosition(this.matrixWorld);const at=_b.distanceTo(DM)/_.zoom;let lt,ft;for(st[0].object.visible=!0,lt=1,ft=st.length;lt<ft&&at>=st[lt].distance;lt++)st[lt-1].object.visible=!1,st[lt].object.visible=!0;for(this._currentLevel=lt-1;lt<ft;lt++)st[lt].object.visible=!1}}toJSON(_){const st=super.toJSON(_);this.autoUpdate===!1&&(st.object.autoUpdate=!1),st.object.levels=[];const at=this.levels;for(let lt=0,ft=at.length;lt<ft;lt++){const vt=at[lt];st.object.levels.push({object:vt.object.uuid,distance:vt.distance})}return st}}const Xy=new Mr,BM=new qo,kM=new qo,OM=new Mr,aE=new Ys;class hC extends Hu{constructor(_,st){super(_,st),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ys,this.bindMatrixInverse=new Ys}copy(_,st){return super.copy(_,st),this.bindMode=_.bindMode,this.bindMatrix.copy(_.bindMatrix),this.bindMatrixInverse.copy(_.bindMatrixInverse),this.skeleton=_.skeleton,this}bind(_,st){this.skeleton=_,st===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),st=this.matrixWorld),this.bindMatrix.copy(st),this.bindMatrixInverse.copy(st).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const _=new qo,st=this.geometry.attributes.skinWeight;for(let at=0,lt=st.count;at<lt;at++){_.fromBufferAttribute(st,at);const ft=1/_.manhattanLength();ft!==1/0?_.multiplyScalar(ft):_.set(1,0,0,0),st.setXYZW(at,_.x,_.y,_.z,_.w)}}updateMatrixWorld(_){super.updateMatrixWorld(_),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(_,st){const at=this.skeleton,lt=this.geometry;BM.fromBufferAttribute(lt.attributes.skinIndex,_),kM.fromBufferAttribute(lt.attributes.skinWeight,_),Xy.copy(st).applyMatrix4(this.bindMatrix),st.set(0,0,0);for(let ft=0;ft<4;ft++){const vt=kM.getComponent(ft);if(vt!==0){const At=BM.getComponent(ft);aE.multiplyMatrices(at.bones[At].matrixWorld,at.boneInverses[At]),st.addScaledVector(OM.copy(Xy).applyMatrix4(aE),vt)}}return st.applyMatrix4(this.bindMatrixInverse)}}class fC extends ao{constructor(){super(),this.isBone=!0,this.type="Bone"}}class tw extends Cu{constructor(_=null,st=1,at=1,lt,ft,vt,At,Ct,Tt=ga,Ot=ga,Ut,Lt){super(null,vt,At,Ct,Tt,Ot,lt,ft,Ut,Lt),this.isDataTexture=!0,this.image={data:_,width:st,height:at},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const mC=new Ys,LM=new Ys;class u1{constructor(_=[],st=[]){this.uuid=rp(),this.bones=_.slice(0),this.boneInverses=st,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const _=this.bones,st=this.boneInverses;if(this.boneMatrices=new Float32Array(16*_.length),st.length===0)this.calculateInverses();else if(_.length!==st.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let at=0,lt=this.bones.length;at<lt;at++)this.boneInverses.push(new Ys)}}calculateInverses(){this.boneInverses.length=0;for(let _=0,st=this.bones.length;_<st;_++){const at=new Ys;this.bones[_]&&at.copy(this.bones[_].matrixWorld).invert(),this.boneInverses.push(at)}}pose(){for(let _=0,st=this.bones.length;_<st;_++){const at=this.bones[_];at&&at.matrixWorld.copy(this.boneInverses[_]).invert()}for(let _=0,st=this.bones.length;_<st;_++){const at=this.bones[_];at&&(at.parent&&at.parent.isBone?(at.matrix.copy(at.parent.matrixWorld).invert(),at.matrix.multiply(at.matrixWorld)):at.matrix.copy(at.matrixWorld),at.matrix.decompose(at.position,at.quaternion,at.scale))}}update(){const _=this.bones,st=this.boneInverses,at=this.boneMatrices,lt=this.boneTexture;for(let ft=0,vt=_.length;ft<vt;ft++){const At=_[ft]?_[ft].matrixWorld:LM;mC.multiplyMatrices(At,st[ft]),mC.toArray(at,16*ft)}lt!==null&&(lt.needsUpdate=!0)}clone(){return new u1(this.bones,this.boneInverses)}computeBoneTexture(){let _=Math.sqrt(4*this.bones.length);_=t_(_),_=Math.max(_,4);const st=new Float32Array(_*_*4);st.set(this.boneMatrices);const at=new tw(st,_,_,Ps,Cl);return at.needsUpdate=!0,this.boneMatrices=st,this.boneTexture=at,this.boneTextureSize=_,this}getBoneByName(_){for(let st=0,at=this.bones.length;st<at;st++){const lt=this.bones[st];if(lt.name===_)return lt}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(_,st){this.uuid=_.uuid;for(let at=0,lt=_.bones.length;at<lt;at++){const ft=_.bones[at];let vt=st[ft];vt===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",ft),vt=new fC),this.bones.push(vt),this.boneInverses.push(new Ys().fromArray(_.boneInverses[at]))}return this.init(),this}toJSON(){const _={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};_.uuid=this.uuid;const st=this.bones,at=this.boneInverses;for(let lt=0,ft=st.length;lt<ft;lt++){const vt=st[lt];_.bones.push(vt.uuid);const At=at[lt];_.boneInverses.push(At.toArray())}return _}}class Jy extends El{constructor(_,st,at,lt=1){super(_,st,at),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=lt}copy(_){return super.copy(_),this.meshPerAttribute=_.meshPerAttribute,this}toJSON(){const _=super.toJSON();return _.meshPerAttribute=this.meshPerAttribute,_.isInstancedBufferAttribute=!0,_}}const gC=new Ys,NM=new Ys,c1=[],d1=new Hu;class lE extends Hu{constructor(_,st,at){super(_,st),this.isInstancedMesh=!0,this.instanceMatrix=new Jy(new Float32Array(16*at),16),this.instanceColor=null,this.count=at,this.frustumCulled=!1}copy(_,st){return super.copy(_,st),this.instanceMatrix.copy(_.instanceMatrix),_.instanceColor!==null&&(this.instanceColor=_.instanceColor.clone()),this.count=_.count,this}getColorAt(_,st){st.fromArray(this.instanceColor.array,3*_)}getMatrixAt(_,st){st.fromArray(this.instanceMatrix.array,16*_)}raycast(_,st){const at=this.matrixWorld,lt=this.count;if(d1.geometry=this.geometry,d1.material=this.material,d1.material!==void 0)for(let ft=0;ft<lt;ft++){this.getMatrixAt(ft,gC),NM.multiplyMatrices(at,gC),d1.matrixWorld=NM,d1.raycast(_,c1);for(let vt=0,At=c1.length;vt<At;vt++){const Ct=c1[vt];Ct.instanceId=ft,Ct.object=this,st.push(Ct)}c1.length=0}}setColorAt(_,st){this.instanceColor===null&&(this.instanceColor=new Jy(new Float32Array(3*this.instanceMatrix.count),3)),st.toArray(this.instanceColor.array,3*_)}setMatrixAt(_,st){st.toArray(this.instanceMatrix.array,16*_)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Qp extends Qu{constructor(_){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ms(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.linewidth=_.linewidth,this.linecap=_.linecap,this.linejoin=_.linejoin,this.fog=_.fog,this}}const uE=new Mr,vC=new Mr,_C=new Ys,yC=new s_,p1=new am;class h_ extends ao{constructor(_=new xs,st=new Qp){super(),this.isLine=!0,this.type="Line",this.geometry=_,this.material=st,this.updateMorphTargets()}copy(_,st){return super.copy(_,st),this.material=_.material,this.geometry=_.geometry,this}computeLineDistances(){const _=this.geometry;if(_.index===null){const st=_.attributes.position,at=[0];for(let lt=1,ft=st.count;lt<ft;lt++)uE.fromBufferAttribute(st,lt-1),vC.fromBufferAttribute(st,lt),at[lt]=at[lt-1],at[lt]+=uE.distanceTo(vC);_.setAttribute("lineDistance",new xt(at,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(_,st){const at=this.geometry,lt=this.matrixWorld,ft=_.params.Line.threshold,vt=at.drawRange;if(at.boundingSphere===null&&at.computeBoundingSphere(),p1.copy(at.boundingSphere),p1.applyMatrix4(lt),p1.radius+=ft,_.ray.intersectsSphere(p1)===!1)return;_C.copy(lt).invert(),yC.copy(_.ray).applyMatrix4(_C);const At=ft/((this.scale.x+this.scale.y+this.scale.z)/3),Ct=At*At,Tt=new Mr,Ot=new Mr,Ut=new Mr,Lt=new Mr,Gt=this.isLineSegments?2:1,Xt=at.index,Qt=at.attributes.position;if(Xt!==null)for(let lr=Math.max(0,vt.start),ur=Math.min(Xt.count,vt.start+vt.count)-1;lr<ur;lr+=Gt){const cr=Xt.getX(lr),gr=Xt.getX(lr+1);if(Tt.fromBufferAttribute(Qt,cr),Ot.fromBufferAttribute(Qt,gr),yC.distanceSqToSegment(Tt,Ot,Lt,Ut)>Ct)continue;Lt.applyMatrix4(this.matrixWorld);const wr=_.ray.origin.distanceTo(Lt);wr<_.near||wr>_.far||st.push({distance:wr,point:Ut.clone().applyMatrix4(this.matrixWorld),index:lr,face:null,faceIndex:null,object:this})}else for(let lr=Math.max(0,vt.start),ur=Math.min(Qt.count,vt.start+vt.count)-1;lr<ur;lr+=Gt){if(Tt.fromBufferAttribute(Qt,lr),Ot.fromBufferAttribute(Qt,lr+1),yC.distanceSqToSegment(Tt,Ot,Lt,Ut)>Ct)continue;Lt.applyMatrix4(this.matrixWorld);const cr=_.ray.origin.distanceTo(Lt);cr<_.near||cr>_.far||st.push({distance:cr,point:Ut.clone().applyMatrix4(this.matrixWorld),index:lr,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const _=this.geometry.morphAttributes,st=Object.keys(_);if(st.length>0){const at=_[st[0]];if(at!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let lt=0,ft=at.length;lt<ft;lt++){const vt=at[lt].name||String(lt);this.morphTargetInfluences.push(0),this.morphTargetDictionary[vt]=lt}}}}}const FM=new Mr,cE=new Mr;class f_ extends h_{constructor(_,st){super(_,st),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const _=this.geometry;if(_.index===null){const st=_.attributes.position,at=[];for(let lt=0,ft=st.count;lt<ft;lt+=2)FM.fromBufferAttribute(st,lt),cE.fromBufferAttribute(st,lt+1),at[lt]=lt===0?0:at[lt-1],at[lt+1]=at[lt]+FM.distanceTo(cE);_.setAttribute("lineDistance",new xt(at,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class rw extends h_{constructor(_,st){super(_,st),this.isLineLoop=!0,this.type="LineLoop"}}class dE extends Qu{constructor(_){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new ms(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.alphaMap=_.alphaMap,this.size=_.size,this.sizeAttenuation=_.sizeAttenuation,this.fog=_.fog,this}}const AC=new Ys,pE=new s_,hE=new am,h1=new Mr;class fE extends ao{constructor(_=new xs,st=new dE){super(),this.isPoints=!0,this.type="Points",this.geometry=_,this.material=st,this.updateMorphTargets()}copy(_,st){return super.copy(_,st),this.material=_.material,this.geometry=_.geometry,this}raycast(_,st){const at=this.geometry,lt=this.matrixWorld,ft=_.params.Points.threshold,vt=at.drawRange;if(at.boundingSphere===null&&at.computeBoundingSphere(),hE.copy(at.boundingSphere),hE.applyMatrix4(lt),hE.radius+=ft,_.ray.intersectsSphere(hE)===!1)return;AC.copy(lt).invert(),pE.copy(_.ray).applyMatrix4(AC);const At=ft/((this.scale.x+this.scale.y+this.scale.z)/3),Ct=At*At,Tt=at.index,Ot=at.attributes.position;if(Tt!==null)for(let Ut=Math.max(0,vt.start),Lt=Math.min(Tt.count,vt.start+vt.count);Ut<Lt;Ut++){const Gt=Tt.getX(Ut);h1.fromBufferAttribute(Ot,Gt),nw(h1,Gt,Ct,lt,_,st,this)}else for(let Ut=Math.max(0,vt.start),Lt=Math.min(Ot.count,vt.start+vt.count);Ut<Lt;Ut++)h1.fromBufferAttribute(Ot,Ut),nw(h1,Ut,Ct,lt,_,st,this)}updateMorphTargets(){const _=this.geometry.morphAttributes,st=Object.keys(_);if(st.length>0){const at=_[st[0]];if(at!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let lt=0,ft=at.length;lt<ft;lt++){const vt=at[lt].name||String(lt);this.morphTargetInfluences.push(0),this.morphTargetDictionary[vt]=lt}}}}}function nw(wt,_,st,at,lt,ft,vt){const At=pE.distanceSqToPoint(wt);if(At<st){const Ct=new Mr;pE.closestPointToPoint(wt,Ct),Ct.applyMatrix4(at);const Tt=lt.ray.origin.distanceTo(Ct);if(Tt<lt.near||Tt>lt.far)return;ft.push({distance:Tt,distanceToRay:Math.sqrt(At),point:Ct,index:_,face:null,object:vt})}}class bC extends Cu{constructor(_,st,at,lt,ft,vt,At,Ct,Tt){super(_,st,at,lt,ft,vt,At,Ct,Tt),this.isVideoTexture=!0,this.minFilter=vt!==void 0?vt:Ko,this.magFilter=ft!==void 0?ft:Ko,this.generateMipmaps=!1;const Ot=this;"requestVideoFrameCallback"in _&&_.requestVideoFrameCallback(function Ut(){Ot.needsUpdate=!0,_.requestVideoFrameCallback(Ut)})}clone(){return new this.constructor(this.image).copy(this)}update(){const _=this.image;!("requestVideoFrameCallback"in _)&&_.readyState>=_.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class f1 extends Cu{constructor(_,st,at){super({width:_,height:st}),this.isFramebufferTexture=!0,this.format=at,this.magFilter=ga,this.minFilter=ga,this.generateMipmaps=!1,this.needsUpdate=!0}}class m1 extends Cu{constructor(_,st,at,lt,ft,vt,At,Ct,Tt,Ot,Ut,Lt){super(null,vt,At,Ct,Tt,Ot,lt,ft,Ut,Lt),this.isCompressedTexture=!0,this.image={width:st,height:at},this.mipmaps=_,this.flipY=!1,this.generateMipmaps=!1}}class wC extends Cu{constructor(_,st,at,lt,ft,vt,At,Ct,Tt){super(_,st,at,lt,ft,vt,At,Ct,Tt),this.isCanvasTexture=!0,this.needsUpdate=!0}}class kv{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(_,st){const at=this.getUtoTmapping(_);return this.getPoint(at,st)}getPoints(_=5){const st=[];for(let at=0;at<=_;at++)st.push(this.getPoint(at/_));return st}getSpacedPoints(_=5){const st=[];for(let at=0;at<=_;at++)st.push(this.getPointAt(at/_));return st}getLength(){const _=this.getLengths();return _[_.length-1]}getLengths(_=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===_+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const st=[];let at,lt=this.getPoint(0),ft=0;st.push(0);for(let vt=1;vt<=_;vt++)at=this.getPoint(vt/_),ft+=at.distanceTo(lt),st.push(ft),lt=at;return this.cacheArcLengths=st,st}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(_,st){const at=this.getLengths();let lt=0;const ft=at.length;let vt;vt=st||_*at[ft-1];let At,Ct=0,Tt=ft-1;for(;Ct<=Tt;)if(lt=Math.floor(Ct+(Tt-Ct)/2),At=at[lt]-vt,At<0)Ct=lt+1;else{if(!(At>0)){Tt=lt;break}Tt=lt-1}if(lt=Tt,at[lt]===vt)return lt/(ft-1);const Ot=at[lt];return(lt+(vt-Ot)/(at[lt+1]-Ot))/(ft-1)}getTangent(_,st){let lt=_-1e-4,ft=_+1e-4;lt<0&&(lt=0),ft>1&&(ft=1);const vt=this.getPoint(lt),At=this.getPoint(ft),Ct=st||(vt.isVector2?new Vn:new Mr);return Ct.copy(At).sub(vt).normalize(),Ct}getTangentAt(_,st){const at=this.getUtoTmapping(_);return this.getTangent(at,st)}computeFrenetFrames(_,st){const at=new Mr,lt=[],ft=[],vt=[],At=new Mr,Ct=new Ys;for(let Gt=0;Gt<=_;Gt++){const Xt=Gt/_;lt[Gt]=this.getTangentAt(Xt,new Mr)}ft[0]=new Mr,vt[0]=new Mr;let Tt=Number.MAX_VALUE;const Ot=Math.abs(lt[0].x),Ut=Math.abs(lt[0].y),Lt=Math.abs(lt[0].z);Ot<=Tt&&(Tt=Ot,at.set(1,0,0)),Ut<=Tt&&(Tt=Ut,at.set(0,1,0)),Lt<=Tt&&at.set(0,0,1),At.crossVectors(lt[0],at).normalize(),ft[0].crossVectors(lt[0],At),vt[0].crossVectors(lt[0],ft[0]);for(let Gt=1;Gt<=_;Gt++){if(ft[Gt]=ft[Gt-1].clone(),vt[Gt]=vt[Gt-1].clone(),At.crossVectors(lt[Gt-1],lt[Gt]),At.length()>Number.EPSILON){At.normalize();const Xt=Math.acos(Ls(lt[Gt-1].dot(lt[Gt]),-1,1));ft[Gt].applyMatrix4(Ct.makeRotationAxis(At,Xt))}vt[Gt].crossVectors(lt[Gt],ft[Gt])}if(st===!0){let Gt=Math.acos(Ls(ft[0].dot(ft[_]),-1,1));Gt/=_,lt[0].dot(At.crossVectors(ft[0],ft[_]))>0&&(Gt=-Gt);for(let Xt=1;Xt<=_;Xt++)ft[Xt].applyMatrix4(Ct.makeRotationAxis(lt[Xt],Gt*Xt)),vt[Xt].crossVectors(lt[Xt],ft[Xt])}return{tangents:lt,normals:ft,binormals:vt}}clone(){return new this.constructor().copy(this)}copy(_){return this.arcLengthDivisions=_.arcLengthDivisions,this}toJSON(){const _={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return _.arcLengthDivisions=this.arcLengthDivisions,_.type=this.type,_}fromJSON(_){return this.arcLengthDivisions=_.arcLengthDivisions,this}}class mE extends kv{constructor(_=0,st=0,at=1,lt=1,ft=0,vt=2*Math.PI,At=!1,Ct=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=_,this.aY=st,this.xRadius=at,this.yRadius=lt,this.aStartAngle=ft,this.aEndAngle=vt,this.aClockwise=At,this.aRotation=Ct}getPoint(_,st){const at=st||new Vn,lt=2*Math.PI;let ft=this.aEndAngle-this.aStartAngle;const vt=Math.abs(ft)<Number.EPSILON;for(;ft<0;)ft+=lt;for(;ft>lt;)ft-=lt;ft<Number.EPSILON&&(ft=vt?0:lt),this.aClockwise!==!0||vt||(ft===lt?ft=-lt:ft-=lt);const At=this.aStartAngle+_*ft;let Ct=this.aX+this.xRadius*Math.cos(At),Tt=this.aY+this.yRadius*Math.sin(At);if(this.aRotation!==0){const Ot=Math.cos(this.aRotation),Ut=Math.sin(this.aRotation),Lt=Ct-this.aX,Gt=Tt-this.aY;Ct=Lt*Ot-Gt*Ut+this.aX,Tt=Lt*Ut+Gt*Ot+this.aY}return at.set(Ct,Tt)}copy(_){return super.copy(_),this.aX=_.aX,this.aY=_.aY,this.xRadius=_.xRadius,this.yRadius=_.yRadius,this.aStartAngle=_.aStartAngle,this.aEndAngle=_.aEndAngle,this.aClockwise=_.aClockwise,this.aRotation=_.aRotation,this}toJSON(){const _=super.toJSON();return _.aX=this.aX,_.aY=this.aY,_.xRadius=this.xRadius,_.yRadius=this.yRadius,_.aStartAngle=this.aStartAngle,_.aEndAngle=this.aEndAngle,_.aClockwise=this.aClockwise,_.aRotation=this.aRotation,_}fromJSON(_){return super.fromJSON(_),this.aX=_.aX,this.aY=_.aY,this.xRadius=_.xRadius,this.yRadius=_.yRadius,this.aStartAngle=_.aStartAngle,this.aEndAngle=_.aEndAngle,this.aClockwise=_.aClockwise,this.aRotation=_.aRotation,this}}class UM extends mE{constructor(_,st,at,lt,ft,vt){super(_,st,at,at,lt,ft,vt),this.isArcCurve=!0,this.type="ArcCurve"}}function gE(){let wt=0,_=0,st=0,at=0;function lt(ft,vt,At,Ct){wt=ft,_=At,st=-3*ft+3*vt-2*At-Ct,at=2*ft-2*vt+At+Ct}return{initCatmullRom:function(ft,vt,At,Ct,Tt){lt(vt,At,Tt*(At-ft),Tt*(Ct-vt))},initNonuniformCatmullRom:function(ft,vt,At,Ct,Tt,Ot,Ut){let Lt=(vt-ft)/Tt-(At-ft)/(Tt+Ot)+(At-vt)/Ot,Gt=(At-vt)/Ot-(Ct-vt)/(Ot+Ut)+(Ct-At)/Ut;Lt*=Ot,Gt*=Ot,lt(vt,At,Lt,Gt)},calc:function(ft){const vt=ft*ft;return wt+_*ft+st*vt+at*(vt*ft)}}}const vE=new Mr,_E=new gE,xC=new gE,yE=new gE;class $M extends kv{constructor(_=[],st=!1,at="centripetal",lt=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=_,this.closed=st,this.curveType=at,this.tension=lt}getPoint(_,st=new Mr){const at=st,lt=this.points,ft=lt.length,vt=(ft-(this.closed?0:1))*_;let At,Ct,Tt=Math.floor(vt),Ot=vt-Tt;this.closed?Tt+=Tt>0?0:(Math.floor(Math.abs(Tt)/ft)+1)*ft:Ot===0&&Tt===ft-1&&(Tt=ft-2,Ot=1),this.closed||Tt>0?At=lt[(Tt-1)%ft]:(vE.subVectors(lt[0],lt[1]).add(lt[0]),At=vE);const Ut=lt[Tt%ft],Lt=lt[(Tt+1)%ft];if(this.closed||Tt+2<ft?Ct=lt[(Tt+2)%ft]:(vE.subVectors(lt[ft-1],lt[ft-2]).add(lt[ft-1]),Ct=vE),this.curveType==="centripetal"||this.curveType==="chordal"){const Gt=this.curveType==="chordal"?.5:.25;let Xt=Math.pow(At.distanceToSquared(Ut),Gt),Qt=Math.pow(Ut.distanceToSquared(Lt),Gt),lr=Math.pow(Lt.distanceToSquared(Ct),Gt);Qt<1e-4&&(Qt=1),Xt<1e-4&&(Xt=Qt),lr<1e-4&&(lr=Qt),_E.initNonuniformCatmullRom(At.x,Ut.x,Lt.x,Ct.x,Xt,Qt,lr),xC.initNonuniformCatmullRom(At.y,Ut.y,Lt.y,Ct.y,Xt,Qt,lr),yE.initNonuniformCatmullRom(At.z,Ut.z,Lt.z,Ct.z,Xt,Qt,lr)}else this.curveType==="catmullrom"&&(_E.initCatmullRom(At.x,Ut.x,Lt.x,Ct.x,this.tension),xC.initCatmullRom(At.y,Ut.y,Lt.y,Ct.y,this.tension),yE.initCatmullRom(At.z,Ut.z,Lt.z,Ct.z,this.tension));return at.set(_E.calc(Ot),xC.calc(Ot),yE.calc(Ot)),at}copy(_){super.copy(_),this.points=[];for(let st=0,at=_.points.length;st<at;st++){const lt=_.points[st];this.points.push(lt.clone())}return this.closed=_.closed,this.curveType=_.curveType,this.tension=_.tension,this}toJSON(){const _=super.toJSON();_.points=[];for(let st=0,at=this.points.length;st<at;st++){const lt=this.points[st];_.points.push(lt.toArray())}return _.closed=this.closed,_.curveType=this.curveType,_.tension=this.tension,_}fromJSON(_){super.fromJSON(_),this.points=[];for(let st=0,at=_.points.length;st<at;st++){const lt=_.points[st];this.points.push(new Mr().fromArray(lt))}return this.closed=_.closed,this.curveType=_.curveType,this.tension=_.tension,this}}function iw(wt,_,st,at,lt){const ft=.5*(at-_),vt=.5*(lt-st),At=wt*wt;return(2*st-2*at+ft+vt)*(wt*At)+(-3*st+3*at-2*ft-vt)*At+ft*wt+st}function Zy(wt,_,st,at){return function(lt,ft){const vt=1-lt;return vt*vt*ft}(wt,_)+function(lt,ft){return 2*(1-lt)*lt*ft}(wt,st)+function(lt,ft){return lt*lt*ft}(wt,at)}function mu(wt,_,st,at,lt){return function(ft,vt){const At=1-ft;return At*At*At*vt}(wt,_)+function(ft,vt){const At=1-ft;return 3*At*At*ft*vt}(wt,st)+function(ft,vt){return 3*(1-ft)*ft*ft*vt}(wt,at)+function(ft,vt){return ft*ft*ft*vt}(wt,lt)}class g1 extends kv{constructor(_=new Vn,st=new Vn,at=new Vn,lt=new Vn){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=_,this.v1=st,this.v2=at,this.v3=lt}getPoint(_,st=new Vn){const at=st,lt=this.v0,ft=this.v1,vt=this.v2,At=this.v3;return at.set(mu(_,lt.x,ft.x,vt.x,At.x),mu(_,lt.y,ft.y,vt.y,At.y)),at}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this.v3.copy(_.v3),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_.v3=this.v3.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this.v3.fromArray(_.v3),this}}class EC extends kv{constructor(_=new Mr,st=new Mr,at=new Mr,lt=new Mr){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=_,this.v1=st,this.v2=at,this.v3=lt}getPoint(_,st=new Mr){const at=st,lt=this.v0,ft=this.v1,vt=this.v2,At=this.v3;return at.set(mu(_,lt.x,ft.x,vt.x,At.x),mu(_,lt.y,ft.y,vt.y,At.y),mu(_,lt.z,ft.z,vt.z,At.z)),at}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this.v3.copy(_.v3),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_.v3=this.v3.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this.v3.fromArray(_.v3),this}}class v1 extends kv{constructor(_=new Vn,st=new Vn){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=_,this.v2=st}getPoint(_,st=new Vn){const at=st;return _===1?at.copy(this.v2):(at.copy(this.v2).sub(this.v1),at.multiplyScalar(_).add(this.v1)),at}getPointAt(_,st){return this.getPoint(_,st)}getTangent(_,st){const at=st||new Vn;return at.copy(this.v2).sub(this.v1).normalize(),at}copy(_){return super.copy(_),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class SC extends kv{constructor(_=new Mr,st=new Mr){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=_,this.v2=st}getPoint(_,st=new Mr){const at=st;return _===1?at.copy(this.v2):(at.copy(this.v2).sub(this.v1),at.multiplyScalar(_).add(this.v1)),at}getPointAt(_,st){return this.getPoint(_,st)}copy(_){return super.copy(_),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class i0 extends kv{constructor(_=new Vn,st=new Vn,at=new Vn){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=_,this.v1=st,this.v2=at}getPoint(_,st=new Vn){const at=st,lt=this.v0,ft=this.v1,vt=this.v2;return at.set(Zy(_,lt.x,ft.x,vt.x),Zy(_,lt.y,ft.y,vt.y)),at}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class AE extends kv{constructor(_=new Mr,st=new Mr,at=new Mr){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=_,this.v1=st,this.v2=at}getPoint(_,st=new Mr){const at=st,lt=this.v0,ft=this.v1,vt=this.v2;return at.set(Zy(_,lt.x,ft.x,vt.x),Zy(_,lt.y,ft.y,vt.y),Zy(_,lt.z,ft.z,vt.z)),at}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class CC extends kv{constructor(_=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=_}getPoint(_,st=new Vn){const at=st,lt=this.points,ft=(lt.length-1)*_,vt=Math.floor(ft),At=ft-vt,Ct=lt[vt===0?vt:vt-1],Tt=lt[vt],Ot=lt[vt>lt.length-2?lt.length-1:vt+1],Ut=lt[vt>lt.length-3?lt.length-1:vt+2];return at.set(iw(At,Ct.x,Tt.x,Ot.x,Ut.x),iw(At,Ct.y,Tt.y,Ot.y,Ut.y)),at}copy(_){super.copy(_),this.points=[];for(let st=0,at=_.points.length;st<at;st++){const lt=_.points[st];this.points.push(lt.clone())}return this}toJSON(){const _=super.toJSON();_.points=[];for(let st=0,at=this.points.length;st<at;st++){const lt=this.points[st];_.points.push(lt.toArray())}return _}fromJSON(_){super.fromJSON(_),this.points=[];for(let st=0,at=_.points.length;st<at;st++){const lt=_.points[st];this.points.push(new Vn().fromArray(lt))}return this}}var Wo=Object.freeze({__proto__:null,ArcCurve:UM,CatmullRomCurve3:$M,CubicBezierCurve:g1,CubicBezierCurve3:EC,EllipseCurve:mE,LineCurve:v1,LineCurve3:SC,QuadraticBezierCurve:i0,QuadraticBezierCurve3:AE,SplineCurve:CC});class TC extends kv{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(_){this.curves.push(_)}closePath(){const _=this.curves[0].getPoint(0),st=this.curves[this.curves.length-1].getPoint(1);_.equals(st)||this.curves.push(new v1(st,_))}getPoint(_,st){const at=_*this.getLength(),lt=this.getCurveLengths();let ft=0;for(;ft<lt.length;){if(lt[ft]>=at){const vt=lt[ft]-at,At=this.curves[ft],Ct=At.getLength(),Tt=Ct===0?0:1-vt/Ct;return At.getPointAt(Tt,st)}ft++}return null}getLength(){const _=this.getCurveLengths();return _[_.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const _=[];let st=0;for(let at=0,lt=this.curves.length;at<lt;at++)st+=this.curves[at].getLength(),_.push(st);return this.cacheLengths=_,_}getSpacedPoints(_=40){const st=[];for(let at=0;at<=_;at++)st.push(this.getPoint(at/_));return this.autoClose&&st.push(st[0]),st}getPoints(_=12){const st=[];let at;for(let lt=0,ft=this.curves;lt<ft.length;lt++){const vt=ft[lt],At=vt.isEllipseCurve?2*_:vt.isLineCurve||vt.isLineCurve3?1:vt.isSplineCurve?_*vt.points.length:_,Ct=vt.getPoints(At);for(let Tt=0;Tt<Ct.length;Tt++){const Ot=Ct[Tt];at&&at.equals(Ot)||(st.push(Ot),at=Ot)}}return this.autoClose&&st.length>1&&!st[st.length-1].equals(st[0])&&st.push(st[0]),st}copy(_){super.copy(_),this.curves=[];for(let st=0,at=_.curves.length;st<at;st++){const lt=_.curves[st];this.curves.push(lt.clone())}return this.autoClose=_.autoClose,this}toJSON(){const _=super.toJSON();_.autoClose=this.autoClose,_.curves=[];for(let st=0,at=this.curves.length;st<at;st++){const lt=this.curves[st];_.curves.push(lt.toJSON())}return _}fromJSON(_){super.fromJSON(_),this.autoClose=_.autoClose,this.curves=[];for(let st=0,at=_.curves.length;st<at;st++){const lt=_.curves[st];this.curves.push(new Wo[lt.type]().fromJSON(lt))}return this}}class sw extends TC{constructor(_){super(),this.type="Path",this.currentPoint=new Vn,_&&this.setFromPoints(_)}setFromPoints(_){this.moveTo(_[0].x,_[0].y);for(let st=1,at=_.length;st<at;st++)this.lineTo(_[st].x,_[st].y);return this}moveTo(_,st){return this.currentPoint.set(_,st),this}lineTo(_,st){const at=new v1(this.currentPoint.clone(),new Vn(_,st));return this.curves.push(at),this.currentPoint.set(_,st),this}quadraticCurveTo(_,st,at,lt){const ft=new i0(this.currentPoint.clone(),new Vn(_,st),new Vn(at,lt));return this.curves.push(ft),this.currentPoint.set(at,lt),this}bezierCurveTo(_,st,at,lt,ft,vt){const At=new g1(this.currentPoint.clone(),new Vn(_,st),new Vn(at,lt),new Vn(ft,vt));return this.curves.push(At),this.currentPoint.set(ft,vt),this}splineThru(_){const st=[this.currentPoint.clone()].concat(_),at=new CC(st);return this.curves.push(at),this.currentPoint.copy(_[_.length-1]),this}arc(_,st,at,lt,ft,vt){const At=this.currentPoint.x,Ct=this.currentPoint.y;return this.absarc(_+At,st+Ct,at,lt,ft,vt),this}absarc(_,st,at,lt,ft,vt){return this.absellipse(_,st,at,at,lt,ft,vt),this}ellipse(_,st,at,lt,ft,vt,At,Ct){const Tt=this.currentPoint.x,Ot=this.currentPoint.y;return this.absellipse(_+Tt,st+Ot,at,lt,ft,vt,At,Ct),this}absellipse(_,st,at,lt,ft,vt,At,Ct){const Tt=new mE(_,st,at,lt,ft,vt,At,Ct);if(this.curves.length>0){const Ut=Tt.getPoint(0);Ut.equals(this.currentPoint)||this.lineTo(Ut.x,Ut.y)}this.curves.push(Tt);const Ot=Tt.getPoint(1);return this.currentPoint.copy(Ot),this}copy(_){return super.copy(_),this.currentPoint.copy(_.currentPoint),this}toJSON(){const _=super.toJSON();return _.currentPoint=this.currentPoint.toArray(),_}fromJSON(_){return super.fromJSON(_),this.currentPoint.fromArray(_.currentPoint),this}}class ru extends xs{constructor(_=[new Vn(0,-.5),new Vn(.5,0),new Vn(0,.5)],st=12,at=0,lt=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:_,segments:st,phiStart:at,phiLength:lt},st=Math.floor(st),lt=Ls(lt,0,2*Math.PI);const ft=[],vt=[],At=[],Ct=[],Tt=[],Ot=1/st,Ut=new Mr,Lt=new Vn,Gt=new Mr,Xt=new Mr,Qt=new Mr;let lr=0,ur=0;for(let cr=0;cr<=_.length-1;cr++)switch(cr){case 0:lr=_[cr+1].x-_[cr].x,ur=_[cr+1].y-_[cr].y,Gt.x=1*ur,Gt.y=-lr,Gt.z=0*ur,Qt.copy(Gt),Gt.normalize(),Ct.push(Gt.x,Gt.y,Gt.z);break;case _.length-1:Ct.push(Qt.x,Qt.y,Qt.z);break;default:lr=_[cr+1].x-_[cr].x,ur=_[cr+1].y-_[cr].y,Gt.x=1*ur,Gt.y=-lr,Gt.z=0*ur,Xt.copy(Gt),Gt.x+=Qt.x,Gt.y+=Qt.y,Gt.z+=Qt.z,Gt.normalize(),Ct.push(Gt.x,Gt.y,Gt.z),Qt.copy(Xt)}for(let cr=0;cr<=st;cr++){const gr=at+cr*Ot*lt,wr=Math.sin(gr),Er=Math.cos(gr);for(let Cr=0;Cr<=_.length-1;Cr++){Ut.x=_[Cr].x*wr,Ut.y=_[Cr].y,Ut.z=_[Cr].x*Er,vt.push(Ut.x,Ut.y,Ut.z),Lt.x=cr/st,Lt.y=Cr/(_.length-1),At.push(Lt.x,Lt.y);const zr=Ct[3*Cr+0]*wr,Gr=Ct[3*Cr+1],on=Ct[3*Cr+0]*Er;Tt.push(zr,Gr,on)}}for(let cr=0;cr<st;cr++)for(let gr=0;gr<_.length-1;gr++){const wr=gr+cr*_.length,Er=wr,Cr=wr+_.length,zr=wr+_.length+1,Gr=wr+1;ft.push(Er,Cr,Gr),ft.push(zr,Gr,Cr)}this.setIndex(ft),this.setAttribute("position",new xt(vt,3)),this.setAttribute("uv",new xt(At,2)),this.setAttribute("normal",new xt(Tt,3))}static fromJSON(_){return new ru(_.points,_.segments,_.phiStart,_.phiLength)}}class _1 extends ru{constructor(_=1,st=1,at=4,lt=8){const ft=new sw;ft.absarc(0,-st/2,_,1.5*Math.PI,0),ft.absarc(0,st/2,_,0,.5*Math.PI),super(ft.getPoints(at),lt),this.type="CapsuleGeometry",this.parameters={radius:_,height:st,capSegments:at,radialSegments:lt}}static fromJSON(_){return new _1(_.radius,_.length,_.capSegments,_.radialSegments)}}class Bm extends xs{constructor(_=1,st=8,at=0,lt=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:_,segments:st,thetaStart:at,thetaLength:lt},st=Math.max(3,st);const ft=[],vt=[],At=[],Ct=[],Tt=new Mr,Ot=new Vn;vt.push(0,0,0),At.push(0,0,1),Ct.push(.5,.5);for(let Ut=0,Lt=3;Ut<=st;Ut++,Lt+=3){const Gt=at+Ut/st*lt;Tt.x=_*Math.cos(Gt),Tt.y=_*Math.sin(Gt),vt.push(Tt.x,Tt.y,Tt.z),At.push(0,0,1),Ot.x=(vt[Lt]/_+1)/2,Ot.y=(vt[Lt+1]/_+1)/2,Ct.push(Ot.x,Ot.y)}for(let Ut=1;Ut<=st;Ut++)ft.push(Ut,Ut+1,0);this.setIndex(ft),this.setAttribute("position",new xt(vt,3)),this.setAttribute("normal",new xt(At,3)),this.setAttribute("uv",new xt(Ct,2))}static fromJSON(_){return new Bm(_.radius,_.segments,_.thetaStart,_.thetaLength)}}class qu extends xs{constructor(_=1,st=1,at=1,lt=8,ft=1,vt=!1,At=0,Ct=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:_,radiusBottom:st,height:at,radialSegments:lt,heightSegments:ft,openEnded:vt,thetaStart:At,thetaLength:Ct};const Tt=this;lt=Math.floor(lt),ft=Math.floor(ft);const Ot=[],Ut=[],Lt=[],Gt=[];let Xt=0;const Qt=[],lr=at/2;let ur=0;function cr(gr){const wr=Xt,Er=new Vn,Cr=new Mr;let zr=0;const Gr=gr===!0?_:st,on=gr===!0?1:-1;for(let Wr=1;Wr<=lt;Wr++)Ut.push(0,lr*on,0),Lt.push(0,on,0),Gt.push(.5,.5),Xt++;const ln=Xt;for(let Wr=0;Wr<=lt;Wr++){const Bn=Wr/lt*Ct+At,Hn=Math.cos(Bn),Pn=Math.sin(Bn);Cr.x=Gr*Pn,Cr.y=lr*on,Cr.z=Gr*Hn,Ut.push(Cr.x,Cr.y,Cr.z),Lt.push(0,on,0),Er.x=.5*Hn+.5,Er.y=.5*Pn*on+.5,Gt.push(Er.x,Er.y),Xt++}for(let Wr=0;Wr<lt;Wr++){const Bn=wr+Wr,Hn=ln+Wr;gr===!0?Ot.push(Hn,Hn+1,Bn):Ot.push(Hn+1,Hn,Bn),zr+=3}Tt.addGroup(ur,zr,gr===!0?1:2),ur+=zr}(function(){const gr=new Mr,wr=new Mr;let Er=0;const Cr=(st-_)/at;for(let zr=0;zr<=ft;zr++){const Gr=[],on=zr/ft,ln=on*(st-_)+_;for(let Wr=0;Wr<=lt;Wr++){const Bn=Wr/lt,Hn=Bn*Ct+At,Pn=Math.sin(Hn),es=Math.cos(Hn);wr.x=ln*Pn,wr.y=-on*at+lr,wr.z=ln*es,Ut.push(wr.x,wr.y,wr.z),gr.set(Pn,Cr,es).normalize(),Lt.push(gr.x,gr.y,gr.z),Gt.push(Bn,1-on),Gr.push(Xt++)}Qt.push(Gr)}for(let zr=0;zr<lt;zr++)for(let Gr=0;Gr<ft;Gr++){const on=Qt[Gr][zr],ln=Qt[Gr+1][zr],Wr=Qt[Gr+1][zr+1],Bn=Qt[Gr][zr+1];Ot.push(on,ln,Bn),Ot.push(ln,Wr,Bn),Er+=6}Tt.addGroup(ur,Er,0),ur+=Er})(),vt===!1&&(_>0&&cr(!0),st>0&&cr(!1)),this.setIndex(Ot),this.setAttribute("position",new xt(Ut,3)),this.setAttribute("normal",new xt(Lt,3)),this.setAttribute("uv",new xt(Gt,2))}static fromJSON(_){return new qu(_.radiusTop,_.radiusBottom,_.height,_.radialSegments,_.heightSegments,_.openEnded,_.thetaStart,_.thetaLength)}}class Gl extends qu{constructor(_=1,st=1,at=8,lt=1,ft=!1,vt=0,At=2*Math.PI){super(0,_,st,at,lt,ft,vt,At),this.type="ConeGeometry",this.parameters={radius:_,height:st,radialSegments:at,heightSegments:lt,openEnded:ft,thetaStart:vt,thetaLength:At}}static fromJSON(_){return new Gl(_.radius,_.height,_.radialSegments,_.heightSegments,_.openEnded,_.thetaStart,_.thetaLength)}}class s0 extends xs{constructor(_=[],st=[],at=1,lt=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:_,indices:st,radius:at,detail:lt};const ft=[],vt=[];function At(Lt,Gt,Xt,Qt){const lr=Qt+1,ur=[];for(let cr=0;cr<=lr;cr++){ur[cr]=[];const gr=Lt.clone().lerp(Xt,cr/lr),wr=Gt.clone().lerp(Xt,cr/lr),Er=lr-cr;for(let Cr=0;Cr<=Er;Cr++)ur[cr][Cr]=Cr===0&&cr===lr?gr:gr.clone().lerp(wr,Cr/Er)}for(let cr=0;cr<lr;cr++)for(let gr=0;gr<2*(lr-cr)-1;gr++){const wr=Math.floor(gr/2);gr%2==0?(Ct(ur[cr][wr+1]),Ct(ur[cr+1][wr]),Ct(ur[cr][wr])):(Ct(ur[cr][wr+1]),Ct(ur[cr+1][wr+1]),Ct(ur[cr+1][wr]))}}function Ct(Lt){ft.push(Lt.x,Lt.y,Lt.z)}function Tt(Lt,Gt){const Xt=3*Lt;Gt.x=_[Xt+0],Gt.y=_[Xt+1],Gt.z=_[Xt+2]}function Ot(Lt,Gt,Xt,Qt){Qt<0&&Lt.x===1&&(vt[Gt]=Lt.x-1),Xt.x===0&&Xt.z===0&&(vt[Gt]=Qt/2/Math.PI+.5)}function Ut(Lt){return Math.atan2(Lt.z,-Lt.x)}(function(Lt){const Gt=new Mr,Xt=new Mr,Qt=new Mr;for(let lr=0;lr<st.length;lr+=3)Tt(st[lr+0],Gt),Tt(st[lr+1],Xt),Tt(st[lr+2],Qt),At(Gt,Xt,Qt,Lt)})(lt),function(Lt){const Gt=new Mr;for(let Xt=0;Xt<ft.length;Xt+=3)Gt.x=ft[Xt+0],Gt.y=ft[Xt+1],Gt.z=ft[Xt+2],Gt.normalize().multiplyScalar(Lt),ft[Xt+0]=Gt.x,ft[Xt+1]=Gt.y,ft[Xt+2]=Gt.z}(at),function(){const Lt=new Mr;for(let Xt=0;Xt<ft.length;Xt+=3){Lt.x=ft[Xt+0],Lt.y=ft[Xt+1],Lt.z=ft[Xt+2];const Qt=Ut(Lt)/2/Math.PI+.5,lr=(Gt=Lt,Math.atan2(-Gt.y,Math.sqrt(Gt.x*Gt.x+Gt.z*Gt.z))/Math.PI+.5);vt.push(Qt,1-lr)}var Gt;(function(){const Xt=new Mr,Qt=new Mr,lr=new Mr,ur=new Mr,cr=new Vn,gr=new Vn,wr=new Vn;for(let Er=0,Cr=0;Er<ft.length;Er+=9,Cr+=6){Xt.set(ft[Er+0],ft[Er+1],ft[Er+2]),Qt.set(ft[Er+3],ft[Er+4],ft[Er+5]),lr.set(ft[Er+6],ft[Er+7],ft[Er+8]),cr.set(vt[Cr+0],vt[Cr+1]),gr.set(vt[Cr+2],vt[Cr+3]),wr.set(vt[Cr+4],vt[Cr+5]),ur.copy(Xt).add(Qt).add(lr).divideScalar(3);const zr=Ut(ur);Ot(cr,Cr+0,Xt,zr),Ot(gr,Cr+2,Qt,zr),Ot(wr,Cr+4,lr,zr)}})(),function(){for(let Xt=0;Xt<vt.length;Xt+=6){const Qt=vt[Xt+0],lr=vt[Xt+2],ur=vt[Xt+4],cr=Math.max(Qt,lr,ur),gr=Math.min(Qt,lr,ur);cr>.9&&gr<.1&&(Qt<.2&&(vt[Xt+0]+=1),lr<.2&&(vt[Xt+2]+=1),ur<.2&&(vt[Xt+4]+=1))}}()}(),this.setAttribute("position",new xt(ft,3)),this.setAttribute("normal",new xt(ft.slice(),3)),this.setAttribute("uv",new xt(vt,2)),lt===0?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(_){return new s0(_.vertices,_.indices,_.radius,_.details)}}class y1 extends s0{constructor(_=1,st=0){const at=(1+Math.sqrt(5))/2,lt=1/at;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-lt,-at,0,-lt,at,0,lt,-at,0,lt,at,-lt,-at,0,-lt,at,0,lt,-at,0,lt,at,0,-at,0,-lt,at,0,-lt,-at,0,lt,at,0,lt],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],_,st),this.type="DodecahedronGeometry",this.parameters={radius:_,detail:st}}static fromJSON(_){return new y1(_.radius,_.detail)}}const Ov=new Mr,ow=new Mr,A1=new Mr,aw=new Gu;class bE extends xs{constructor(_=null,st=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:_,thresholdAngle:st},_!==null){const lt=Math.pow(10,4),ft=Math.cos($_*st),vt=_.getIndex(),At=_.getAttribute("position"),Ct=vt?vt.count:At.count,Tt=[0,0,0],Ot=["a","b","c"],Ut=new Array(3),Lt={},Gt=[];for(let Xt=0;Xt<Ct;Xt+=3){vt?(Tt[0]=vt.getX(Xt),Tt[1]=vt.getX(Xt+1),Tt[2]=vt.getX(Xt+2)):(Tt[0]=Xt,Tt[1]=Xt+1,Tt[2]=Xt+2);const{a:Qt,b:lr,c:ur}=aw;if(Qt.fromBufferAttribute(At,Tt[0]),lr.fromBufferAttribute(At,Tt[1]),ur.fromBufferAttribute(At,Tt[2]),aw.getNormal(A1),Ut[0]=`${Math.round(Qt.x*lt)},${Math.round(Qt.y*lt)},${Math.round(Qt.z*lt)}`,Ut[1]=`${Math.round(lr.x*lt)},${Math.round(lr.y*lt)},${Math.round(lr.z*lt)}`,Ut[2]=`${Math.round(ur.x*lt)},${Math.round(ur.y*lt)},${Math.round(ur.z*lt)}`,Ut[0]!==Ut[1]&&Ut[1]!==Ut[2]&&Ut[2]!==Ut[0])for(let cr=0;cr<3;cr++){const gr=(cr+1)%3,wr=Ut[cr],Er=Ut[gr],Cr=aw[Ot[cr]],zr=aw[Ot[gr]],Gr=`${wr}_${Er}`,on=`${Er}_${wr}`;on in Lt&&Lt[on]?(A1.dot(Lt[on].normal)<=ft&&(Gt.push(Cr.x,Cr.y,Cr.z),Gt.push(zr.x,zr.y,zr.z)),Lt[on]=null):Gr in Lt||(Lt[Gr]={index0:Tt[cr],index1:Tt[gr],normal:A1.clone()})}}for(const Xt in Lt)if(Lt[Xt]){const{index0:Qt,index1:lr}=Lt[Xt];Ov.fromBufferAttribute(At,Qt),ow.fromBufferAttribute(At,lr),Gt.push(Ov.x,Ov.y,Ov.z),Gt.push(ow.x,ow.y,ow.z)}this.setAttribute("position",new xt(Gt,3))}}}class eA extends sw{constructor(_){super(_),this.uuid=rp(),this.type="Shape",this.holes=[]}getPointsHoles(_){const st=[];for(let at=0,lt=this.holes.length;at<lt;at++)st[at]=this.holes[at].getPoints(_);return st}extractPoints(_){return{shape:this.getPoints(_),holes:this.getPointsHoles(_)}}copy(_){super.copy(_),this.holes=[];for(let st=0,at=_.holes.length;st<at;st++){const lt=_.holes[st];this.holes.push(lt.clone())}return this}toJSON(){const _=super.toJSON();_.uuid=this.uuid,_.holes=[];for(let st=0,at=this.holes.length;st<at;st++){const lt=this.holes[st];_.holes.push(lt.toJSON())}return _}fromJSON(_){super.fromJSON(_),this.uuid=_.uuid,this.holes=[];for(let st=0,at=_.holes.length;st<at;st++){const lt=_.holes[st];this.holes.push(new sw().fromJSON(lt))}return this}}function jM(wt,_,st,at,lt){let ft,vt;if(lt===function(At,Ct,Tt,Ot){let Ut=0;for(let Lt=Ct,Gt=Tt-Ot;Lt<Tt;Lt+=Ot)Ut+=(At[Gt]-At[Lt])*(At[Lt+1]+At[Gt+1]),Gt=Lt;return Ut}(wt,_,st,at)>0)for(ft=_;ft<st;ft+=at)vt=Am(ft,wt[ft],wt[ft+1],vt);else for(ft=st-at;ft>=_;ft-=at)vt=Am(ft,wt[ft],wt[ft+1],vt);return vt&&_m(vt,vt.next)&&(E1(vt),vt=vt.next),vt}function ry(wt,_){if(!wt)return wt;_||(_=wt);let st,at=wt;do if(st=!1,at.steiner||!_m(at,at.next)&&Jl(at.prev,at,at.next)!==0)at=at.next;else{if(E1(at),at=_=at.prev,at===at.next)break;st=!0}while(st||at!==_);return _}function b1(wt,_,st,at,lt,ft,vt){if(!wt)return;!vt&&ft&&function(Ot,Ut,Lt,Gt){let Xt=Ot;do Xt.z===null&&(Xt.z=wE(Xt.x,Xt.y,Ut,Lt,Gt)),Xt.prevZ=Xt.prev,Xt.nextZ=Xt.next,Xt=Xt.next;while(Xt!==Ot);Xt.prevZ.nextZ=null,Xt.prevZ=null,function(Qt){let lr,ur,cr,gr,wr,Er,Cr,zr,Gr=1;do{for(ur=Qt,Qt=null,wr=null,Er=0;ur;){for(Er++,cr=ur,Cr=0,lr=0;lr<Gr&&(Cr++,cr=cr.nextZ,cr);lr++);for(zr=Gr;Cr>0||zr>0&&cr;)Cr!==0&&(zr===0||!cr||ur.z<=cr.z)?(gr=ur,ur=ur.nextZ,Cr--):(gr=cr,cr=cr.nextZ,zr--),wr?wr.nextZ=gr:Qt=gr,gr.prevZ=wr,wr=gr;ur=cr}wr.nextZ=null,Gr*=2}while(Er>1)}(Xt)}(wt,at,lt,ft);let At,Ct,Tt=wt;for(;wt.prev!==wt.next;)if(At=wt.prev,Ct=wt.next,ft?w1(wt,at,lt,ft):zM(wt))_.push(At.i/st),_.push(wt.i/st),_.push(Ct.i/st),E1(wt),wt=Ct.next,Tt=Ct.next;else if((wt=Ct)===Tt){vt?vt===1?b1(wt=VM(ry(wt),_,st),_,st,at,lt,ft,2):vt===2&&MC(wt,_,st,at,lt,ft):b1(ry(wt),_,st,at,lt,ft,1);break}}function zM(wt){const _=wt.prev,st=wt,at=wt.next;if(Jl(_,st,at)>=0)return!1;let lt=wt.next.next;for(;lt!==wt.prev;){if(ev(_.x,_.y,st.x,st.y,at.x,at.y,lt.x,lt.y)&&Jl(lt.prev,lt,lt.next)>=0)return!1;lt=lt.next}return!0}function w1(wt,_,st,at){const lt=wt.prev,ft=wt,vt=wt.next;if(Jl(lt,ft,vt)>=0)return!1;const At=lt.x<ft.x?lt.x<vt.x?lt.x:vt.x:ft.x<vt.x?ft.x:vt.x,Ct=lt.y<ft.y?lt.y<vt.y?lt.y:vt.y:ft.y<vt.y?ft.y:vt.y,Tt=lt.x>ft.x?lt.x>vt.x?lt.x:vt.x:ft.x>vt.x?ft.x:vt.x,Ot=lt.y>ft.y?lt.y>vt.y?lt.y:vt.y:ft.y>vt.y?ft.y:vt.y,Ut=wE(At,Ct,_,st,at),Lt=wE(Tt,Ot,_,st,at);let Gt=wt.prevZ,Xt=wt.nextZ;for(;Gt&&Gt.z>=Ut&&Xt&&Xt.z<=Lt;){if(Gt!==wt.prev&&Gt!==wt.next&&ev(lt.x,lt.y,ft.x,ft.y,vt.x,vt.y,Gt.x,Gt.y)&&Jl(Gt.prev,Gt,Gt.next)>=0||(Gt=Gt.prevZ,Xt!==wt.prev&&Xt!==wt.next&&ev(lt.x,lt.y,ft.x,ft.y,vt.x,vt.y,Xt.x,Xt.y)&&Jl(Xt.prev,Xt,Xt.next)>=0))return!1;Xt=Xt.nextZ}for(;Gt&&Gt.z>=Ut;){if(Gt!==wt.prev&&Gt!==wt.next&&ev(lt.x,lt.y,ft.x,ft.y,vt.x,vt.y,Gt.x,Gt.y)&&Jl(Gt.prev,Gt,Gt.next)>=0)return!1;Gt=Gt.prevZ}for(;Xt&&Xt.z<=Lt;){if(Xt!==wt.prev&&Xt!==wt.next&&ev(lt.x,lt.y,ft.x,ft.y,vt.x,vt.y,Xt.x,Xt.y)&&Jl(Xt.prev,Xt,Xt.next)>=0)return!1;Xt=Xt.nextZ}return!0}function VM(wt,_,st){let at=wt;do{const lt=at.prev,ft=at.next.next;!_m(lt,ft)&&ny(lt,at,at.next,ft)&&iy(lt,ft)&&iy(ft,lt)&&(_.push(lt.i/st),_.push(at.i/st),_.push(ft.i/st),E1(at),E1(at.next),at=wt=ft),at=at.next}while(at!==wt);return ry(at)}function MC(wt,_,st,at,lt,ft){let vt=wt;do{let At=vt.next.next;for(;At!==vt.prev;){if(vt.i!==At.i&&Op(vt,At)){let Ct=xE(vt,At);return vt=ry(vt,vt.next),Ct=ry(Ct,Ct.next),b1(vt,_,st,at,lt,ft),void b1(Ct,_,st,at,lt,ft)}At=At.next}vt=vt.next}while(vt!==wt)}function x1(wt,_){return wt.x-_.x}function Lv(wt,_){if(_=function(st,at){let lt=at;const ft=st.x,vt=st.y;let At,Ct=-1/0;do{if(vt<=lt.y&&vt>=lt.next.y&&lt.next.y!==lt.y){const Xt=lt.x+(vt-lt.y)*(lt.next.x-lt.x)/(lt.next.y-lt.y);if(Xt<=ft&&Xt>Ct){if(Ct=Xt,Xt===ft){if(vt===lt.y)return lt;if(vt===lt.next.y)return lt.next}At=lt.x<lt.next.x?lt:lt.next}}lt=lt.next}while(lt!==at);if(!At)return null;if(ft===Ct)return At;const Tt=At,Ot=At.x,Ut=At.y;let Lt,Gt=1/0;lt=At;do ft>=lt.x&&lt.x>=Ot&&ft!==lt.x&&ev(vt<Ut?ft:Ct,vt,Ot,Ut,vt<Ut?Ct:ft,vt,lt.x,lt.y)&&(Lt=Math.abs(vt-lt.y)/(ft-lt.x),iy(lt,st)&&(Lt<Gt||Lt===Gt&&(lt.x>At.x||lt.x===At.x&&GM(At,lt)))&&(At=lt,Gt=Lt)),lt=lt.next;while(lt!==Tt);return At}(wt,_),_){const st=xE(_,wt);ry(_,_.next),ry(st,st.next)}}function GM(wt,_){return Jl(wt.prev,wt,_.prev)<0&&Jl(_.next,wt,wt.next)<0}function wE(wt,_,st,at,lt){return(wt=1431655765&((wt=858993459&((wt=252645135&((wt=16711935&((wt=32767*(wt-st)*lt)|wt<<8))|wt<<4))|wt<<2))|wt<<1))|(_=1431655765&((_=858993459&((_=252645135&((_=16711935&((_=32767*(_-at)*lt)|_<<8))|_<<4))|_<<2))|_<<1))<<1}function tA(wt){let _=wt,st=wt;do(_.x<st.x||_.x===st.x&&_.y<st.y)&&(st=_),_=_.next;while(_!==wt);return st}function ev(wt,_,st,at,lt,ft,vt,At){return(lt-vt)*(_-At)-(wt-vt)*(ft-At)>=0&&(wt-vt)*(at-At)-(st-vt)*(_-At)>=0&&(st-vt)*(ft-At)-(lt-vt)*(at-At)>=0}function Op(wt,_){return wt.next.i!==_.i&&wt.prev.i!==_.i&&!function(st,at){let lt=st;do{if(lt.i!==st.i&&lt.next.i!==st.i&&lt.i!==at.i&&lt.next.i!==at.i&&ny(lt,lt.next,st,at))return!0;lt=lt.next}while(lt!==st);return!1}(wt,_)&&(iy(wt,_)&&iy(_,wt)&&function(st,at){let lt=st,ft=!1;const vt=(st.x+at.x)/2,At=(st.y+at.y)/2;do lt.y>At!=lt.next.y>At&&lt.next.y!==lt.y&&vt<(lt.next.x-lt.x)*(At-lt.y)/(lt.next.y-lt.y)+lt.x&&(ft=!ft),lt=lt.next;while(lt!==st);return ft}(wt,_)&&(Jl(wt.prev,wt,_.prev)||Jl(wt,_.prev,_))||_m(wt,_)&&Jl(wt.prev,wt,wt.next)>0&&Jl(_.prev,_,_.next)>0)}function Jl(wt,_,st){return(_.y-wt.y)*(st.x-_.x)-(_.x-wt.x)*(st.y-_.y)}function _m(wt,_){return wt.x===_.x&&wt.y===_.y}function ny(wt,_,st,at){const lt=ym(Jl(wt,_,st)),ft=ym(Jl(wt,_,at)),vt=ym(Jl(st,at,wt)),At=ym(Jl(st,at,_));return lt!==ft&&vt!==At||!(lt!==0||!tv(wt,st,_))||!(ft!==0||!tv(wt,at,_))||!(vt!==0||!tv(st,wt,at))||!(At!==0||!tv(st,_,at))}function tv(wt,_,st){return _.x<=Math.max(wt.x,st.x)&&_.x>=Math.min(wt.x,st.x)&&_.y<=Math.max(wt.y,st.y)&&_.y>=Math.min(wt.y,st.y)}function ym(wt){return wt>0?1:wt<0?-1:0}function iy(wt,_){return Jl(wt.prev,wt,wt.next)<0?Jl(wt,_,wt.next)>=0&&Jl(wt,wt.prev,_)>=0:Jl(wt,_,wt.prev)<0||Jl(wt,wt.next,_)<0}function xE(wt,_){const st=new RC(wt.i,wt.x,wt.y),at=new RC(_.i,_.x,_.y),lt=wt.next,ft=_.prev;return wt.next=_,_.prev=wt,st.next=lt,lt.prev=st,at.next=st,st.prev=at,ft.next=at,at.prev=ft,at}function Am(wt,_,st,at){const lt=new RC(wt,_,st);return at?(lt.next=at.next,lt.prev=at,at.next.prev=lt,at.next=lt):(lt.prev=lt,lt.next=lt),lt}function E1(wt){wt.next.prev=wt.prev,wt.prev.next=wt.next,wt.prevZ&&(wt.prevZ.nextZ=wt.nextZ),wt.nextZ&&(wt.nextZ.prevZ=wt.prevZ)}function RC(wt,_,st){this.i=wt,this.x=_,this.y=st,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Nv{static area(_){const st=_.length;let at=0;for(let lt=st-1,ft=0;ft<st;lt=ft++)at+=_[lt].x*_[ft].y-_[ft].x*_[lt].y;return .5*at}static isClockWise(_){return Nv.area(_)<0}static triangulateShape(_,st){const at=[],lt=[],ft=[];km(_),EE(at,_);let vt=_.length;st.forEach(km);for(let Ct=0;Ct<st.length;Ct++)lt.push(vt),vt+=st[Ct].length,EE(at,st[Ct]);const At=function(Ct,Tt,Ot=2){const Ut=Tt&&Tt.length,Lt=Ut?Tt[0]*Ot:Ct.length;let Gt=jM(Ct,0,Lt,Ot,!0);const Xt=[];if(!Gt||Gt.next===Gt.prev)return Xt;let Qt,lr,ur,cr,gr,wr,Er;if(Ut&&(Gt=function(Cr,zr,Gr,on){const ln=[];let Wr,Bn,Hn,Pn,es;for(Wr=0,Bn=zr.length;Wr<Bn;Wr++)Hn=zr[Wr]*on,Pn=Wr<Bn-1?zr[Wr+1]*on:Cr.length,es=jM(Cr,Hn,Pn,on,!1),es===es.next&&(es.steiner=!0),ln.push(tA(es));for(ln.sort(x1),Wr=0;Wr<ln.length;Wr++)Lv(ln[Wr],Gr),Gr=ry(Gr,Gr.next);return Gr}(Ct,Tt,Gt,Ot)),Ct.length>80*Ot){Qt=ur=Ct[0],lr=cr=Ct[1];for(let Cr=Ot;Cr<Lt;Cr+=Ot)gr=Ct[Cr],wr=Ct[Cr+1],gr<Qt&&(Qt=gr),wr<lr&&(lr=wr),gr>ur&&(ur=gr),wr>cr&&(cr=wr);Er=Math.max(ur-Qt,cr-lr),Er=Er!==0?1/Er:0}return b1(Gt,Xt,Ot,Qt,lr,Er),Xt}(at,lt);for(let Ct=0;Ct<At.length;Ct+=3)ft.push(At.slice(Ct,Ct+3));return ft}}function km(wt){const _=wt.length;_>2&&wt[_-1].equals(wt[0])&&wt.pop()}function EE(wt,_){for(let st=0;st<_.length;st++)wt.push(_[st].x),wt.push(_[st].y)}class S1 extends xs{constructor(_=new eA([new Vn(.5,.5),new Vn(-.5,.5),new Vn(-.5,-.5),new Vn(.5,-.5)]),st={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:_,options:st},_=Array.isArray(_)?_:[_];const at=this,lt=[],ft=[];for(let At=0,Ct=_.length;At<Ct;At++)vt(_[At]);function vt(At){const Ct=[],Tt=st.curveSegments!==void 0?st.curveSegments:12,Ot=st.steps!==void 0?st.steps:1,Ut=st.depth!==void 0?st.depth:1;let Lt=st.bevelEnabled===void 0||st.bevelEnabled,Gt=st.bevelThickness!==void 0?st.bevelThickness:.2,Xt=st.bevelSize!==void 0?st.bevelSize:Gt-.1,Qt=st.bevelOffset!==void 0?st.bevelOffset:0,lr=st.bevelSegments!==void 0?st.bevelSegments:3;const ur=st.extrudePath,cr=st.UVGenerator!==void 0?st.UVGenerator:EP;let gr,wr,Er,Cr,zr,Gr=!1;ur&&(gr=ur.getSpacedPoints(Ot),Gr=!0,Lt=!1,wr=ur.computeFrenetFrames(Ot,!1),Er=new Mr,Cr=new Mr,zr=new Mr),Lt||(lr=0,Gt=0,Xt=0,Qt=0);const on=At.extractPoints(Tt);let ln=on.shape;const Wr=on.holes;if(!Nv.isClockWise(ln)){ln=ln.reverse();for(let rn=0,Ur=Wr.length;rn<Ur;rn++){const Zr=Wr[rn];Nv.isClockWise(Zr)&&(Wr[rn]=Zr.reverse())}}const Bn=Nv.triangulateShape(ln,Wr),Hn=ln;for(let rn=0,Ur=Wr.length;rn<Ur;rn++){const Zr=Wr[rn];ln=ln.concat(Zr)}function Pn(rn,Ur,Zr){return Ur||console.error("THREE.ExtrudeGeometry: vec does not exist"),Ur.clone().multiplyScalar(Zr).add(rn)}const es=ln.length,ts=Bn.length;function bn(rn,Ur,Zr){let xn,_r,En;const dn=rn.x-Ur.x,Dn=rn.y-Ur.y,Nn=Zr.x-rn.x,as=Zr.y-rn.y,Bs=dn*dn+Dn*Dn,Qs=dn*as-Dn*Nn;if(Math.abs(Qs)>Number.EPSILON){const lo=Math.sqrt(Bs),zs=Math.sqrt(Nn*Nn+as*as),Hs=Ur.x-Dn/lo,_l=Ur.y+dn/lo,Nm=((Zr.x-as/zs-Hs)*as-(Zr.y+Nn/zs-_l)*Nn)/(dn*as-Dn*Nn);xn=Hs+dn*Nm-rn.x,_r=_l+Dn*Nm-rn.y;const so=xn*xn+_r*_r;if(so<=2)return new Vn(xn,_r);En=Math.sqrt(so/2)}else{let lo=!1;dn>Number.EPSILON?Nn>Number.EPSILON&&(lo=!0):dn<-Number.EPSILON?Nn<-Number.EPSILON&&(lo=!0):Math.sign(Dn)===Math.sign(as)&&(lo=!0),lo?(xn=-Dn,_r=dn,En=Math.sqrt(Bs)):(xn=dn,_r=Dn,En=Math.sqrt(Bs/2))}return new Vn(xn/En,_r/En)}const Sn=[];for(let rn=0,Ur=Hn.length,Zr=Ur-1,xn=rn+1;rn<Ur;rn++,Zr++,xn++)Zr===Ur&&(Zr=0),xn===Ur&&(xn=0),Sn[rn]=bn(Hn[rn],Hn[Zr],Hn[xn]);const Kn=[];let kn,Zn=Sn.concat();for(let rn=0,Ur=Wr.length;rn<Ur;rn++){const Zr=Wr[rn];kn=[];for(let xn=0,_r=Zr.length,En=_r-1,dn=xn+1;xn<_r;xn++,En++,dn++)En===_r&&(En=0),dn===_r&&(dn=0),kn[xn]=bn(Zr[xn],Zr[En],Zr[dn]);Kn.push(kn),Zn=Zn.concat(kn)}for(let rn=0;rn<lr;rn++){const Ur=rn/lr,Zr=Gt*Math.cos(Ur*Math.PI/2),xn=Xt*Math.sin(Ur*Math.PI/2)+Qt;for(let _r=0,En=Hn.length;_r<En;_r++){const dn=Pn(Hn[_r],Sn[_r],xn);Ds(dn.x,dn.y,-Zr)}for(let _r=0,En=Wr.length;_r<En;_r++){const dn=Wr[_r];kn=Kn[_r];for(let Dn=0,Nn=dn.length;Dn<Nn;Dn++){const as=Pn(dn[Dn],kn[Dn],xn);Ds(as.x,as.y,-Zr)}}}const Rs=Xt+Qt;for(let rn=0;rn<es;rn++){const Ur=Lt?Pn(ln[rn],Zn[rn],Rs):ln[rn];Gr?(Cr.copy(wr.normals[0]).multiplyScalar(Ur.x),Er.copy(wr.binormals[0]).multiplyScalar(Ur.y),zr.copy(gr[0]).add(Cr).add(Er),Ds(zr.x,zr.y,zr.z)):Ds(Ur.x,Ur.y,0)}for(let rn=1;rn<=Ot;rn++)for(let Ur=0;Ur<es;Ur++){const Zr=Lt?Pn(ln[Ur],Zn[Ur],Rs):ln[Ur];Gr?(Cr.copy(wr.normals[rn]).multiplyScalar(Zr.x),Er.copy(wr.binormals[rn]).multiplyScalar(Zr.y),zr.copy(gr[rn]).add(Cr).add(Er),Ds(zr.x,zr.y,zr.z)):Ds(Zr.x,Zr.y,Ut/Ot*rn)}for(let rn=lr-1;rn>=0;rn--){const Ur=rn/lr,Zr=Gt*Math.cos(Ur*Math.PI/2),xn=Xt*Math.sin(Ur*Math.PI/2)+Qt;for(let _r=0,En=Hn.length;_r<En;_r++){const dn=Pn(Hn[_r],Sn[_r],xn);Ds(dn.x,dn.y,Ut+Zr)}for(let _r=0,En=Wr.length;_r<En;_r++){const dn=Wr[_r];kn=Kn[_r];for(let Dn=0,Nn=dn.length;Dn<Nn;Dn++){const as=Pn(dn[Dn],kn[Dn],xn);Gr?Ds(as.x,as.y+gr[Ot-1].y,gr[Ot-1].x+Zr):Ds(as.x,as.y,Ut+Zr)}}}function wo(rn,Ur){let Zr=rn.length;for(;--Zr>=0;){const xn=Zr;let _r=Zr-1;_r<0&&(_r=rn.length-1);for(let En=0,dn=Ot+2*lr;En<dn;En++){const Dn=es*En,Nn=es*(En+1);Fr(Ur+xn+Dn,Ur+_r+Dn,Ur+_r+Nn,Ur+xn+Nn)}}}function Ds(rn,Ur,Zr){Ct.push(rn),Ct.push(Ur),Ct.push(Zr)}function fo(rn,Ur,Zr){Br(rn),Br(Ur),Br(Zr);const xn=lt.length/3,_r=cr.generateTopUV(at,lt,xn-3,xn-2,xn-1);fn(_r[0]),fn(_r[1]),fn(_r[2])}function Fr(rn,Ur,Zr,xn){Br(rn),Br(Ur),Br(xn),Br(Ur),Br(Zr),Br(xn);const _r=lt.length/3,En=cr.generateSideWallUV(at,lt,_r-6,_r-3,_r-2,_r-1);fn(En[0]),fn(En[1]),fn(En[3]),fn(En[1]),fn(En[2]),fn(En[3])}function Br(rn){lt.push(Ct[3*rn+0]),lt.push(Ct[3*rn+1]),lt.push(Ct[3*rn+2])}function fn(rn){ft.push(rn.x),ft.push(rn.y)}(function(){const rn=lt.length/3;if(Lt){let Ur=0,Zr=es*Ur;for(let xn=0;xn<ts;xn++){const _r=Bn[xn];fo(_r[2]+Zr,_r[1]+Zr,_r[0]+Zr)}Ur=Ot+2*lr,Zr=es*Ur;for(let xn=0;xn<ts;xn++){const _r=Bn[xn];fo(_r[0]+Zr,_r[1]+Zr,_r[2]+Zr)}}else{for(let Ur=0;Ur<ts;Ur++){const Zr=Bn[Ur];fo(Zr[2],Zr[1],Zr[0])}for(let Ur=0;Ur<ts;Ur++){const Zr=Bn[Ur];fo(Zr[0]+es*Ot,Zr[1]+es*Ot,Zr[2]+es*Ot)}}at.addGroup(rn,lt.length/3-rn,0)})(),function(){const rn=lt.length/3;let Ur=0;wo(Hn,Ur),Ur+=Hn.length;for(let Zr=0,xn=Wr.length;Zr<xn;Zr++){const _r=Wr[Zr];wo(_r,Ur),Ur+=_r.length}at.addGroup(rn,lt.length/3-rn,1)}()}this.setAttribute("position",new xt(lt,3)),this.setAttribute("uv",new xt(ft,2)),this.computeVertexNormals()}toJSON(){const _=super.toJSON();return function(st,at,lt){if(lt.shapes=[],Array.isArray(st))for(let ft=0,vt=st.length;ft<vt;ft++){const At=st[ft];lt.shapes.push(At.uuid)}else lt.shapes.push(st.uuid);return lt.options=Object.assign({},at),at.extrudePath!==void 0&&(lt.options.extrudePath=at.extrudePath.toJSON()),lt}(this.parameters.shapes,this.parameters.options,_)}static fromJSON(_,st){const at=[];for(let ft=0,vt=_.shapes.length;ft<vt;ft++){const At=st[_.shapes[ft]];at.push(At)}const lt=_.options.extrudePath;return lt!==void 0&&(_.options.extrudePath=new Wo[lt.type]().fromJSON(lt)),new S1(at,_.options)}}const EP={generateTopUV:function(wt,_,st,at,lt){const ft=_[3*st],vt=_[3*st+1],At=_[3*at],Ct=_[3*at+1],Tt=_[3*lt],Ot=_[3*lt+1];return[new Vn(ft,vt),new Vn(At,Ct),new Vn(Tt,Ot)]},generateSideWallUV:function(wt,_,st,at,lt,ft){const vt=_[3*st],At=_[3*st+1],Ct=_[3*st+2],Tt=_[3*at],Ot=_[3*at+1],Ut=_[3*at+2],Lt=_[3*lt],Gt=_[3*lt+1],Xt=_[3*lt+2],Qt=_[3*ft],lr=_[3*ft+1],ur=_[3*ft+2];return Math.abs(At-Ot)<Math.abs(vt-Tt)?[new Vn(vt,1-Ct),new Vn(Tt,1-Ut),new Vn(Lt,1-Xt),new Vn(Qt,1-ur)]:[new Vn(At,1-Ct),new Vn(Ot,1-Ut),new Vn(Gt,1-Xt),new Vn(lr,1-ur)]}};class lw extends s0{constructor(_=1,st=0){const at=(1+Math.sqrt(5))/2;super([-1,at,0,1,at,0,-1,-at,0,1,-at,0,0,-1,at,0,1,at,0,-1,-at,0,1,-at,at,0,-1,at,0,1,-at,0,-1,-at,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],_,st),this.type="IcosahedronGeometry",this.parameters={radius:_,detail:st}}static fromJSON(_){return new lw(_.radius,_.detail)}}class yp extends s0{constructor(_=1,st=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],_,st),this.type="OctahedronGeometry",this.parameters={radius:_,detail:st}}static fromJSON(_){return new yp(_.radius,_.detail)}}class rA extends xs{constructor(_=.5,st=1,at=8,lt=1,ft=0,vt=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:_,outerRadius:st,thetaSegments:at,phiSegments:lt,thetaStart:ft,thetaLength:vt},at=Math.max(3,at);const At=[],Ct=[],Tt=[],Ot=[];let Ut=_;const Lt=(st-_)/(lt=Math.max(1,lt)),Gt=new Mr,Xt=new Vn;for(let Qt=0;Qt<=lt;Qt++){for(let lr=0;lr<=at;lr++){const ur=ft+lr/at*vt;Gt.x=Ut*Math.cos(ur),Gt.y=Ut*Math.sin(ur),Ct.push(Gt.x,Gt.y,Gt.z),Tt.push(0,0,1),Xt.x=(Gt.x/st+1)/2,Xt.y=(Gt.y/st+1)/2,Ot.push(Xt.x,Xt.y)}Ut+=Lt}for(let Qt=0;Qt<lt;Qt++){const lr=Qt*(at+1);for(let ur=0;ur<at;ur++){const cr=ur+lr,gr=cr,wr=cr+at+1,Er=cr+at+2,Cr=cr+1;At.push(gr,wr,Cr),At.push(wr,Er,Cr)}}this.setIndex(At),this.setAttribute("position",new xt(Ct,3)),this.setAttribute("normal",new xt(Tt,3)),this.setAttribute("uv",new xt(Ot,2))}static fromJSON(_){return new rA(_.innerRadius,_.outerRadius,_.thetaSegments,_.phiSegments,_.thetaStart,_.thetaLength)}}class C1 extends xs{constructor(_=new eA([new Vn(0,.5),new Vn(-.5,-.5),new Vn(.5,-.5)]),st=12){super(),this.type="ShapeGeometry",this.parameters={shapes:_,curveSegments:st};const at=[],lt=[],ft=[],vt=[];let At=0,Ct=0;if(Array.isArray(_)===!1)Tt(_);else for(let Ot=0;Ot<_.length;Ot++)Tt(_[Ot]),this.addGroup(At,Ct,Ot),At+=Ct,Ct=0;function Tt(Ot){const Ut=lt.length/3,Lt=Ot.extractPoints(st);let Gt=Lt.shape;const Xt=Lt.holes;Nv.isClockWise(Gt)===!1&&(Gt=Gt.reverse());for(let lr=0,ur=Xt.length;lr<ur;lr++){const cr=Xt[lr];Nv.isClockWise(cr)===!0&&(Xt[lr]=cr.reverse())}const Qt=Nv.triangulateShape(Gt,Xt);for(let lr=0,ur=Xt.length;lr<ur;lr++){const cr=Xt[lr];Gt=Gt.concat(cr)}for(let lr=0,ur=Gt.length;lr<ur;lr++){const cr=Gt[lr];lt.push(cr.x,cr.y,0),ft.push(0,0,1),vt.push(cr.x,cr.y)}for(let lr=0,ur=Qt.length;lr<ur;lr++){const cr=Qt[lr],gr=cr[0]+Ut,wr=cr[1]+Ut,Er=cr[2]+Ut;at.push(gr,wr,Er),Ct+=3}}this.setIndex(at),this.setAttribute("position",new xt(lt,3)),this.setAttribute("normal",new xt(ft,3)),this.setAttribute("uv",new xt(vt,2))}toJSON(){const _=super.toJSON();return function(st,at){if(at.shapes=[],Array.isArray(st))for(let lt=0,ft=st.length;lt<ft;lt++){const vt=st[lt];at.shapes.push(vt.uuid)}else at.shapes.push(st.uuid);return at}(this.parameters.shapes,_)}static fromJSON(_,st){const at=[];for(let lt=0,ft=_.shapes.length;lt<ft;lt++){const vt=st[_.shapes[lt]];at.push(vt)}return new C1(at,_.curveSegments)}}class uw extends xs{constructor(_=1,st=32,at=16,lt=0,ft=2*Math.PI,vt=0,At=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:_,widthSegments:st,heightSegments:at,phiStart:lt,phiLength:ft,thetaStart:vt,thetaLength:At},st=Math.max(3,Math.floor(st)),at=Math.max(2,Math.floor(at));const Ct=Math.min(vt+At,Math.PI);let Tt=0;const Ot=[],Ut=new Mr,Lt=new Mr,Gt=[],Xt=[],Qt=[],lr=[];for(let ur=0;ur<=at;ur++){const cr=[],gr=ur/at;let wr=0;ur==0&&vt==0?wr=.5/st:ur==at&&Ct==Math.PI&&(wr=-.5/st);for(let Er=0;Er<=st;Er++){const Cr=Er/st;Ut.x=-_*Math.cos(lt+Cr*ft)*Math.sin(vt+gr*At),Ut.y=_*Math.cos(vt+gr*At),Ut.z=_*Math.sin(lt+Cr*ft)*Math.sin(vt+gr*At),Xt.push(Ut.x,Ut.y,Ut.z),Lt.copy(Ut).normalize(),Qt.push(Lt.x,Lt.y,Lt.z),lr.push(Cr+wr,1-gr),cr.push(Tt++)}Ot.push(cr)}for(let ur=0;ur<at;ur++)for(let cr=0;cr<st;cr++){const gr=Ot[ur][cr+1],wr=Ot[ur][cr],Er=Ot[ur+1][cr],Cr=Ot[ur+1][cr+1];(ur!==0||vt>0)&&Gt.push(gr,wr,Cr),(ur!==at-1||Ct<Math.PI)&&Gt.push(wr,Er,Cr)}this.setIndex(Gt),this.setAttribute("position",new xt(Xt,3)),this.setAttribute("normal",new xt(Qt,3)),this.setAttribute("uv",new xt(lr,2))}static fromJSON(_){return new uw(_.radius,_.widthSegments,_.heightSegments,_.phiStart,_.phiLength,_.thetaStart,_.thetaLength)}}class nA extends s0{constructor(_=1,st=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],_,st),this.type="TetrahedronGeometry",this.parameters={radius:_,detail:st}}static fromJSON(_){return new nA(_.radius,_.detail)}}class sy extends xs{constructor(_=1,st=.4,at=8,lt=6,ft=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:_,tube:st,radialSegments:at,tubularSegments:lt,arc:ft},at=Math.floor(at),lt=Math.floor(lt);const vt=[],At=[],Ct=[],Tt=[],Ot=new Mr,Ut=new Mr,Lt=new Mr;for(let Gt=0;Gt<=at;Gt++)for(let Xt=0;Xt<=lt;Xt++){const Qt=Xt/lt*ft,lr=Gt/at*Math.PI*2;Ut.x=(_+st*Math.cos(lr))*Math.cos(Qt),Ut.y=(_+st*Math.cos(lr))*Math.sin(Qt),Ut.z=st*Math.sin(lr),At.push(Ut.x,Ut.y,Ut.z),Ot.x=_*Math.cos(Qt),Ot.y=_*Math.sin(Qt),Lt.subVectors(Ut,Ot).normalize(),Ct.push(Lt.x,Lt.y,Lt.z),Tt.push(Xt/lt),Tt.push(Gt/at)}for(let Gt=1;Gt<=at;Gt++)for(let Xt=1;Xt<=lt;Xt++){const Qt=(lt+1)*Gt+Xt-1,lr=(lt+1)*(Gt-1)+Xt-1,ur=(lt+1)*(Gt-1)+Xt,cr=(lt+1)*Gt+Xt;vt.push(Qt,lr,cr),vt.push(lr,ur,cr)}this.setIndex(vt),this.setAttribute("position",new xt(At,3)),this.setAttribute("normal",new xt(Ct,3)),this.setAttribute("uv",new xt(Tt,2))}static fromJSON(_){return new sy(_.radius,_.tube,_.radialSegments,_.tubularSegments,_.arc)}}class lp extends xs{constructor(_=1,st=.4,at=64,lt=8,ft=2,vt=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:_,tube:st,tubularSegments:at,radialSegments:lt,p:ft,q:vt},at=Math.floor(at),lt=Math.floor(lt);const At=[],Ct=[],Tt=[],Ot=[],Ut=new Mr,Lt=new Mr,Gt=new Mr,Xt=new Mr,Qt=new Mr,lr=new Mr,ur=new Mr;for(let gr=0;gr<=at;++gr){const wr=gr/at*ft*Math.PI*2;cr(wr,ft,vt,_,Gt),cr(wr+.01,ft,vt,_,Xt),lr.subVectors(Xt,Gt),ur.addVectors(Xt,Gt),Qt.crossVectors(lr,ur),ur.crossVectors(Qt,lr),Qt.normalize(),ur.normalize();for(let Er=0;Er<=lt;++Er){const Cr=Er/lt*Math.PI*2,zr=-st*Math.cos(Cr),Gr=st*Math.sin(Cr);Ut.x=Gt.x+(zr*ur.x+Gr*Qt.x),Ut.y=Gt.y+(zr*ur.y+Gr*Qt.y),Ut.z=Gt.z+(zr*ur.z+Gr*Qt.z),Ct.push(Ut.x,Ut.y,Ut.z),Lt.subVectors(Ut,Gt).normalize(),Tt.push(Lt.x,Lt.y,Lt.z),Ot.push(gr/at),Ot.push(Er/lt)}}for(let gr=1;gr<=at;gr++)for(let wr=1;wr<=lt;wr++){const Er=(lt+1)*(gr-1)+(wr-1),Cr=(lt+1)*gr+(wr-1),zr=(lt+1)*gr+wr,Gr=(lt+1)*(gr-1)+wr;At.push(Er,Cr,Gr),At.push(Cr,zr,Gr)}function cr(gr,wr,Er,Cr,zr){const Gr=Math.cos(gr),on=Math.sin(gr),ln=Er/wr*gr,Wr=Math.cos(ln);zr.x=Cr*(2+Wr)*.5*Gr,zr.y=Cr*(2+Wr)*on*.5,zr.z=Cr*Math.sin(ln)*.5}this.setIndex(At),this.setAttribute("position",new xt(Ct,3)),this.setAttribute("normal",new xt(Tt,3)),this.setAttribute("uv",new xt(Ot,2))}static fromJSON(_){return new lp(_.radius,_.tube,_.tubularSegments,_.radialSegments,_.p,_.q)}}class T1 extends xs{constructor(_=new AE(new Mr(-1,-1,0),new Mr(-1,1,0),new Mr(1,1,0)),st=64,at=1,lt=8,ft=!1){super(),this.type="TubeGeometry",this.parameters={path:_,tubularSegments:st,radius:at,radialSegments:lt,closed:ft};const vt=_.computeFrenetFrames(st,ft);this.tangents=vt.tangents,this.normals=vt.normals,this.binormals=vt.binormals;const At=new Mr,Ct=new Mr,Tt=new Vn;let Ot=new Mr;const Ut=[],Lt=[],Gt=[],Xt=[];function Qt(lr){Ot=_.getPointAt(lr/st,Ot);const ur=vt.normals[lr],cr=vt.binormals[lr];for(let gr=0;gr<=lt;gr++){const wr=gr/lt*Math.PI*2,Er=Math.sin(wr),Cr=-Math.cos(wr);Ct.x=Cr*ur.x+Er*cr.x,Ct.y=Cr*ur.y+Er*cr.y,Ct.z=Cr*ur.z+Er*cr.z,Ct.normalize(),Lt.push(Ct.x,Ct.y,Ct.z),At.x=Ot.x+at*Ct.x,At.y=Ot.y+at*Ct.y,At.z=Ot.z+at*Ct.z,Ut.push(At.x,At.y,At.z)}}(function(){for(let lr=0;lr<st;lr++)Qt(lr);Qt(ft===!1?st:0),function(){for(let lr=0;lr<=st;lr++)for(let ur=0;ur<=lt;ur++)Tt.x=lr/st,Tt.y=ur/lt,Gt.push(Tt.x,Tt.y)}(),function(){for(let lr=1;lr<=st;lr++)for(let ur=1;ur<=lt;ur++){const cr=(lt+1)*(lr-1)+(ur-1),gr=(lt+1)*lr+(ur-1),wr=(lt+1)*lr+ur,Er=(lt+1)*(lr-1)+ur;Xt.push(cr,gr,Er),Xt.push(gr,wr,Er)}}()})(),this.setIndex(Xt),this.setAttribute("position",new xt(Ut,3)),this.setAttribute("normal",new xt(Lt,3)),this.setAttribute("uv",new xt(Gt,2))}toJSON(){const _=super.toJSON();return _.path=this.parameters.path.toJSON(),_}static fromJSON(_){return new T1(new Wo[_.path.type]().fromJSON(_.path),_.tubularSegments,_.radius,_.radialSegments,_.closed)}}class QM extends xs{constructor(_=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:_},_!==null){const st=[],at=new Set,lt=new Mr,ft=new Mr;if(_.index!==null){const vt=_.attributes.position,At=_.index;let Ct=_.groups;Ct.length===0&&(Ct=[{start:0,count:At.count,materialIndex:0}]);for(let Tt=0,Ot=Ct.length;Tt<Ot;++Tt){const Ut=Ct[Tt],Lt=Ut.start;for(let Gt=Lt,Xt=Lt+Ut.count;Gt<Xt;Gt+=3)for(let Qt=0;Qt<3;Qt++){const lr=At.getX(Gt+Qt),ur=At.getX(Gt+(Qt+1)%3);lt.fromBufferAttribute(vt,lr),ft.fromBufferAttribute(vt,ur),IC(lt,ft,at)===!0&&(st.push(lt.x,lt.y,lt.z),st.push(ft.x,ft.y,ft.z))}}}else{const vt=_.attributes.position;for(let At=0,Ct=vt.count/3;At<Ct;At++)for(let Tt=0;Tt<3;Tt++){const Ot=3*At+Tt,Ut=3*At+(Tt+1)%3;lt.fromBufferAttribute(vt,Ot),ft.fromBufferAttribute(vt,Ut),IC(lt,ft,at)===!0&&(st.push(lt.x,lt.y,lt.z),st.push(ft.x,ft.y,ft.z))}}this.setAttribute("position",new xt(st,3))}}}function IC(wt,_,st){const at=`${wt.x},${wt.y},${wt.z}-${_.x},${_.y},${_.z}`,lt=`${_.x},${_.y},${_.z}-${wt.x},${wt.y},${wt.z}`;return st.has(at)!==!0&&st.has(lt)!==!0&&(st.add(at),st.add(lt),!0)}var rv=Object.freeze({__proto__:null,BoxGeometry:Zm,CapsuleGeometry:_1,CircleGeometry:Bm,ConeGeometry:Gl,CylinderGeometry:qu,DodecahedronGeometry:y1,EdgesGeometry:bE,ExtrudeGeometry:S1,IcosahedronGeometry:lw,LatheGeometry:ru,OctahedronGeometry:yp,PlaneGeometry:Y0,PolyhedronGeometry:s0,RingGeometry:rA,ShapeGeometry:C1,SphereGeometry:uw,TetrahedronGeometry:nA,TorusGeometry:sy,TorusKnotGeometry:lp,TubeGeometry:T1,WireframeGeometry:QM});class SE extends Qu{constructor(_){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new ms(0),this.transparent=!0,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.fog=_.fog,this}}class HM extends Tv{constructor(_){super(_),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class PC extends Qu{constructor(_){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ms(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ms(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Fu,this.normalScale=new Vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.defines={STANDARD:""},this.color.copy(_.color),this.roughness=_.roughness,this.metalness=_.metalness,this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.roughnessMap=_.roughnessMap,this.metalnessMap=_.metalnessMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapIntensity=_.envMapIntensity,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.flatShading=_.flatShading,this.fog=_.fog,this}}class DC extends PC{constructor(_){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Ls(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(st){this.ior=(1+.4*st)/(1-.4*st)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ms(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new ms(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ms(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(_)}get sheen(){return this._sheen}set sheen(_){this._sheen>0!=_>0&&this.version++,this._sheen=_}get clearcoat(){return this._clearcoat}set clearcoat(_){this._clearcoat>0!=_>0&&this.version++,this._clearcoat=_}get iridescence(){return this._iridescence}set iridescence(_){this._iridescence>0!=_>0&&this.version++,this._iridescence=_}get transmission(){return this._transmission}set transmission(_){this._transmission>0!=_>0&&this.version++,this._transmission=_}copy(_){return super.copy(_),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=_.clearcoat,this.clearcoatMap=_.clearcoatMap,this.clearcoatRoughness=_.clearcoatRoughness,this.clearcoatRoughnessMap=_.clearcoatRoughnessMap,this.clearcoatNormalMap=_.clearcoatNormalMap,this.clearcoatNormalScale.copy(_.clearcoatNormalScale),this.ior=_.ior,this.iridescence=_.iridescence,this.iridescenceMap=_.iridescenceMap,this.iridescenceIOR=_.iridescenceIOR,this.iridescenceThicknessRange=[..._.iridescenceThicknessRange],this.iridescenceThicknessMap=_.iridescenceThicknessMap,this.sheen=_.sheen,this.sheenColor.copy(_.sheenColor),this.sheenColorMap=_.sheenColorMap,this.sheenRoughness=_.sheenRoughness,this.sheenRoughnessMap=_.sheenRoughnessMap,this.transmission=_.transmission,this.transmissionMap=_.transmissionMap,this.thickness=_.thickness,this.thicknessMap=_.thicknessMap,this.attenuationDistance=_.attenuationDistance,this.attenuationColor.copy(_.attenuationColor),this.specularIntensity=_.specularIntensity,this.specularIntensityMap=_.specularIntensityMap,this.specularColor.copy(_.specularColor),this.specularColorMap=_.specularColorMap,this}}class M1 extends Qu{constructor(_){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ms(16777215),this.specular=new ms(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ms(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Fu,this.normalScale=new Vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=As,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.specular.copy(_.specular),this.shininess=_.shininess,this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.flatShading=_.flatShading,this.fog=_.fog,this}}class qM extends Qu{constructor(_){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ms(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ms(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Fu,this.normalScale=new Vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.gradientMap=_.gradientMap,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.alphaMap=_.alphaMap,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.fog=_.fog,this}}class R1 extends Qu{constructor(_){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Fu,this.normalScale=new Vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(_)}copy(_){return super.copy(_),this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.flatShading=_.flatShading,this}}class BC extends Qu{constructor(_){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new ms(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ms(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Fu,this.normalScale=new Vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=As,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.flatShading=_.flatShading,this.fog=_.fog,this}}class I1 extends Qu{constructor(_){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ms(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Fu,this.normalScale=new Vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.defines={MATCAP:""},this.color.copy(_.color),this.matcap=_.matcap,this.map=_.map,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.alphaMap=_.alphaMap,this.flatShading=_.flatShading,this.fog=_.fog,this}}class kC extends Qp{constructor(_){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(_)}copy(_){return super.copy(_),this.scale=_.scale,this.dashSize=_.dashSize,this.gapSize=_.gapSize,this}}function Om(wt,_,st){return uu(wt)?new wt.constructor(wt.subarray(_,st!==void 0?st:wt.length)):wt.slice(_,st)}function bm(wt,_,st){return!wt||!st&&wt.constructor===_?wt:typeof _.BYTES_PER_ELEMENT=="number"?new _(wt):Array.prototype.slice.call(wt)}function uu(wt){return ArrayBuffer.isView(wt)&&!(wt instanceof DataView)}function WM(wt){const _=wt.length,st=new Array(_);for(let at=0;at!==_;++at)st[at]=at;return st.sort(function(at,lt){return wt[at]-wt[lt]}),st}function Hp(wt,_,st){const at=wt.length,lt=new wt.constructor(at);for(let ft=0,vt=0;vt!==at;++ft){const At=st[ft]*_;for(let Ct=0;Ct!==_;++Ct)lt[vt++]=wt[At+Ct]}return lt}function gu(wt,_,st,at){let lt=1,ft=wt[0];for(;ft!==void 0&&ft[at]===void 0;)ft=wt[lt++];if(ft===void 0)return;let vt=ft[at];if(vt!==void 0)if(Array.isArray(vt))do vt=ft[at],vt!==void 0&&(_.push(ft.time),st.push.apply(st,vt)),ft=wt[lt++];while(ft!==void 0);else if(vt.toArray!==void 0)do vt=ft[at],vt!==void 0&&(_.push(ft.time),vt.toArray(st,st.length)),ft=wt[lt++];while(ft!==void 0);else do vt=ft[at],vt!==void 0&&(_.push(ft.time),st.push(vt)),ft=wt[lt++];while(ft!==void 0)}var P1=Object.freeze({__proto__:null,arraySlice:Om,convertArray:bm,isTypedArray:uu,getKeyframeOrder:WM,sortedArray:Hp,flattenJSON:gu,subclip:function(wt,_,st,at,lt=30){const ft=wt.clone();ft.name=_;const vt=[];for(let Ct=0;Ct<ft.tracks.length;++Ct){const Tt=ft.tracks[Ct],Ot=Tt.getValueSize(),Ut=[],Lt=[];for(let Gt=0;Gt<Tt.times.length;++Gt){const Xt=Tt.times[Gt]*lt;if(!(Xt<st||Xt>=at)){Ut.push(Tt.times[Gt]);for(let Qt=0;Qt<Ot;++Qt)Lt.push(Tt.values[Gt*Ot+Qt])}}Ut.length!==0&&(Tt.times=bm(Ut,Tt.times.constructor),Tt.values=bm(Lt,Tt.values.constructor),vt.push(Tt))}ft.tracks=vt;let At=1/0;for(let Ct=0;Ct<ft.tracks.length;++Ct)At>ft.tracks[Ct].times[0]&&(At=ft.tracks[Ct].times[0]);for(let Ct=0;Ct<ft.tracks.length;++Ct)ft.tracks[Ct].shift(-1*At);return ft.resetDuration(),ft},makeClipAdditive:function(wt,_=0,st=wt,at=30){at<=0&&(at=30);const lt=st.tracks.length,ft=_/at;for(let vt=0;vt<lt;++vt){const At=st.tracks[vt],Ct=At.ValueTypeName;if(Ct==="bool"||Ct==="string")continue;const Tt=wt.tracks.find(function(ur){return ur.name===At.name&&ur.ValueTypeName===Ct});if(Tt===void 0)continue;let Ot=0;const Ut=At.getValueSize();At.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(Ot=Ut/3);let Lt=0;const Gt=Tt.getValueSize();Tt.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(Lt=Gt/3);const Xt=At.times.length-1;let Qt;if(ft<=At.times[0]){const ur=Ot,cr=Ut-Ot;Qt=Om(At.values,ur,cr)}else if(ft>=At.times[Xt]){const ur=Xt*Ut+Ot,cr=ur+Ut-Ot;Qt=Om(At.values,ur,cr)}else{const ur=At.createInterpolant(),cr=Ot,gr=Ut-Ot;ur.evaluate(ft),Qt=Om(ur.resultBuffer,cr,gr)}Ct==="quaternion"&&new zu().fromArray(Qt).normalize().conjugate().toArray(Qt);const lr=Tt.times.length;for(let ur=0;ur<lr;++ur){const cr=ur*Gt+Lt;if(Ct==="quaternion")zu.multiplyQuaternionsFlat(Tt.values,cr,Qt,0,Tt.values,cr);else{const gr=Gt-2*Lt;for(let wr=0;wr<gr;++wr)Tt.values[cr+wr]-=Qt[wr]}}}return wt.blendMode=CA,wt}});class iA{constructor(_,st,at,lt){this.parameterPositions=_,this._cachedIndex=0,this.resultBuffer=lt!==void 0?lt:new st.constructor(at),this.sampleValues=st,this.valueSize=at,this.settings=null,this.DefaultSettings_={}}evaluate(_){const st=this.parameterPositions;let at=this._cachedIndex,lt=st[at],ft=st[at-1];e:{t:{let vt;r:{n:if(!(_<lt)){for(let At=at+2;;){if(lt===void 0){if(_<ft)break n;return at=st.length,this._cachedIndex=at,this.copySampleValue_(at-1)}if(at===At)break;if(ft=lt,lt=st[++at],_<lt)break t}vt=st.length;break r}if(_>=ft)break e;{const At=st[1];_<At&&(at=2,ft=At);for(let Ct=at-2;;){if(ft===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(at===Ct)break;if(lt=ft,ft=st[--at-1],_>=ft)break t}vt=at,at=0}}for(;at<vt;){const At=at+vt>>>1;_<st[At]?vt=At:at=At+1}if(lt=st[at],ft=st[at-1],ft===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(lt===void 0)return at=st.length,this._cachedIndex=at,this.copySampleValue_(at-1)}this._cachedIndex=at,this.intervalChanged_(at,ft,lt)}return this.interpolate_(at,ft,_,lt)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(_){const st=this.resultBuffer,at=this.sampleValues,lt=this.valueSize,ft=_*lt;for(let vt=0;vt!==lt;++vt)st[vt]=at[ft+vt];return st}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class CE extends iA{constructor(_,st,at,lt){super(_,st,at,lt),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Su,endingEnd:Su}}intervalChanged_(_,st,at){const lt=this.parameterPositions;let ft=_-2,vt=_+1,At=lt[ft],Ct=lt[vt];if(At===void 0)switch(this.getSettings_().endingStart){case _f:ft=_,At=2*st-at;break;case B_:ft=lt.length-2,At=st+lt[ft]-lt[ft+1];break;default:ft=_,At=at}if(Ct===void 0)switch(this.getSettings_().endingEnd){case _f:vt=_,Ct=2*at-st;break;case B_:vt=1,Ct=at+lt[1]-lt[0];break;default:vt=_-1,Ct=st}const Tt=.5*(at-st),Ot=this.valueSize;this._weightPrev=Tt/(st-At),this._weightNext=Tt/(Ct-at),this._offsetPrev=ft*Ot,this._offsetNext=vt*Ot}interpolate_(_,st,at,lt){const ft=this.resultBuffer,vt=this.sampleValues,At=this.valueSize,Ct=_*At,Tt=Ct-At,Ot=this._offsetPrev,Ut=this._offsetNext,Lt=this._weightPrev,Gt=this._weightNext,Xt=(at-st)/(lt-st),Qt=Xt*Xt,lr=Qt*Xt,ur=-Lt*lr+2*Lt*Qt-Lt*Xt,cr=(1+Lt)*lr+(-1.5-2*Lt)*Qt+(-.5+Lt)*Xt+1,gr=(-1-Gt)*lr+(1.5+Gt)*Qt+.5*Xt,wr=Gt*lr-Gt*Qt;for(let Er=0;Er!==At;++Er)ft[Er]=ur*vt[Ot+Er]+cr*vt[Tt+Er]+gr*vt[Ct+Er]+wr*vt[Ut+Er];return ft}}class OC extends iA{constructor(_,st,at,lt){super(_,st,at,lt)}interpolate_(_,st,at,lt){const ft=this.resultBuffer,vt=this.sampleValues,At=this.valueSize,Ct=_*At,Tt=Ct-At,Ot=(at-st)/(lt-st),Ut=1-Ot;for(let Lt=0;Lt!==At;++Lt)ft[Lt]=vt[Tt+Lt]*Ut+vt[Ct+Lt]*Ot;return ft}}class LC extends iA{constructor(_,st,at,lt){super(_,st,at,lt)}interpolate_(_){return this.copySampleValue_(_-1)}}class Fv{constructor(_,st,at,lt){if(_===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(st===void 0||st.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+_);this.name=_,this.times=bm(st,this.TimeBufferType),this.values=bm(at,this.ValueBufferType),this.setInterpolation(lt||this.DefaultInterpolation)}static toJSON(_){const st=_.constructor;let at;if(st.toJSON!==this.toJSON)at=st.toJSON(_);else{at={name:_.name,times:bm(_.times,Array),values:bm(_.values,Array)};const lt=_.getInterpolation();lt!==_.DefaultInterpolation&&(at.interpolation=lt)}return at.type=_.ValueTypeName,at}InterpolantFactoryMethodDiscrete(_){return new LC(this.times,this.values,this.getValueSize(),_)}InterpolantFactoryMethodLinear(_){return new OC(this.times,this.values,this.getValueSize(),_)}InterpolantFactoryMethodSmooth(_){return new CE(this.times,this.values,this.getValueSize(),_)}setInterpolation(_){let st;switch(_){case D_:st=this.InterpolantFactoryMethodDiscrete;break;case I0:st=this.InterpolantFactoryMethodLinear;break;case Nu:st=this.InterpolantFactoryMethodSmooth}if(st===void 0){const at="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0){if(_===this.DefaultInterpolation)throw new Error(at);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",at),this}return this.createInterpolant=st,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return D_;case this.InterpolantFactoryMethodLinear:return I0;case this.InterpolantFactoryMethodSmooth:return Nu}}getValueSize(){return this.values.length/this.times.length}shift(_){if(_!==0){const st=this.times;for(let at=0,lt=st.length;at!==lt;++at)st[at]+=_}return this}scale(_){if(_!==1){const st=this.times;for(let at=0,lt=st.length;at!==lt;++at)st[at]*=_}return this}trim(_,st){const at=this.times,lt=at.length;let ft=0,vt=lt-1;for(;ft!==lt&&at[ft]<_;)++ft;for(;vt!==-1&&at[vt]>st;)--vt;if(++vt,ft!==0||vt!==lt){ft>=vt&&(vt=Math.max(vt,1),ft=vt-1);const At=this.getValueSize();this.times=Om(at,ft,vt),this.values=Om(this.values,ft*At,vt*At)}return this}validate(){let _=!0;const st=this.getValueSize();st-Math.floor(st)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),_=!1);const at=this.times,lt=this.values,ft=at.length;ft===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),_=!1);let vt=null;for(let At=0;At!==ft;At++){const Ct=at[At];if(typeof Ct=="number"&&isNaN(Ct)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,At,Ct),_=!1;break}if(vt!==null&&vt>Ct){console.error("THREE.KeyframeTrack: Out of order keys.",this,At,Ct,vt),_=!1;break}vt=Ct}if(lt!==void 0&&uu(lt))for(let At=0,Ct=lt.length;At!==Ct;++At){const Tt=lt[At];if(isNaN(Tt)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,At,Tt),_=!1;break}}return _}optimize(){const _=Om(this.times),st=Om(this.values),at=this.getValueSize(),lt=this.getInterpolation()===Nu,ft=_.length-1;let vt=1;for(let At=1;At<ft;++At){let Ct=!1;const Tt=_[At];if(Tt!==_[At+1]&&(At!==1||Tt!==_[0]))if(lt)Ct=!0;else{const Ot=At*at,Ut=Ot-at,Lt=Ot+at;for(let Gt=0;Gt!==at;++Gt){const Xt=st[Ot+Gt];if(Xt!==st[Ut+Gt]||Xt!==st[Lt+Gt]){Ct=!0;break}}}if(Ct){if(At!==vt){_[vt]=_[At];const Ot=At*at,Ut=vt*at;for(let Lt=0;Lt!==at;++Lt)st[Ut+Lt]=st[Ot+Lt]}++vt}}if(ft>0){_[vt]=_[ft];for(let At=ft*at,Ct=vt*at,Tt=0;Tt!==at;++Tt)st[Ct+Tt]=st[At+Tt];++vt}return vt!==_.length?(this.times=Om(_,0,vt),this.values=Om(st,0,vt*at)):(this.times=_,this.values=st),this}clone(){const _=Om(this.times,0),st=Om(this.values,0),at=new this.constructor(this.name,_,st);return at.createInterpolant=this.createInterpolant,at}}Fv.prototype.TimeBufferType=Float32Array,Fv.prototype.ValueBufferType=Float32Array,Fv.prototype.DefaultInterpolation=I0;class o0 extends Fv{}o0.prototype.ValueTypeName="bool",o0.prototype.ValueBufferType=Array,o0.prototype.DefaultInterpolation=D_,o0.prototype.InterpolantFactoryMethodLinear=void 0,o0.prototype.InterpolantFactoryMethodSmooth=void 0;class a0 extends Fv{}a0.prototype.ValueTypeName="color";class l0 extends Fv{}l0.prototype.ValueTypeName="number";class D1 extends iA{constructor(_,st,at,lt){super(_,st,at,lt)}interpolate_(_,st,at,lt){const ft=this.resultBuffer,vt=this.sampleValues,At=this.valueSize,Ct=(at-st)/(lt-st);let Tt=_*At;for(let Ot=Tt+At;Tt!==Ot;Tt+=4)zu.slerpFlat(ft,0,vt,Tt-At,vt,Tt,Ct);return ft}}class wm extends Fv{InterpolantFactoryMethodLinear(_){return new D1(this.times,this.values,this.getValueSize(),_)}}wm.prototype.ValueTypeName="quaternion",wm.prototype.DefaultInterpolation=I0,wm.prototype.InterpolantFactoryMethodSmooth=void 0;class nv extends Fv{}nv.prototype.ValueTypeName="string",nv.prototype.ValueBufferType=Array,nv.prototype.DefaultInterpolation=D_,nv.prototype.InterpolantFactoryMethodLinear=void 0,nv.prototype.InterpolantFactoryMethodSmooth=void 0;class cw extends Fv{}cw.prototype.ValueTypeName="vector";class B1{constructor(_,st=-1,at,lt=Ll){this.name=_,this.tracks=at,this.duration=st,this.blendMode=lt,this.uuid=rp(),this.duration<0&&this.resetDuration()}static parse(_){const st=[],at=_.tracks,lt=1/(_.fps||1);for(let vt=0,At=at.length;vt!==At;++vt)st.push(oy(at[vt]).scale(lt));const ft=new this(_.name,_.duration,st,_.blendMode);return ft.uuid=_.uuid,ft}static toJSON(_){const st=[],at=_.tracks,lt={name:_.name,duration:_.duration,tracks:st,uuid:_.uuid,blendMode:_.blendMode};for(let ft=0,vt=at.length;ft!==vt;++ft)st.push(Fv.toJSON(at[ft]));return lt}static CreateFromMorphTargetSequence(_,st,at,lt){const ft=st.length,vt=[];for(let At=0;At<ft;At++){let Ct=[],Tt=[];Ct.push((At+ft-1)%ft,At,(At+1)%ft),Tt.push(0,1,0);const Ot=WM(Ct);Ct=Hp(Ct,1,Ot),Tt=Hp(Tt,1,Ot),lt||Ct[0]!==0||(Ct.push(ft),Tt.push(Tt[0])),vt.push(new l0(".morphTargetInfluences["+st[At].name+"]",Ct,Tt).scale(1/at))}return new this(_,-1,vt)}static findByName(_,st){let at=_;if(!Array.isArray(_)){const lt=_;at=lt.geometry&&lt.geometry.animations||lt.animations}for(let lt=0;lt<at.length;lt++)if(at[lt].name===st)return at[lt];return null}static CreateClipsFromMorphTargetSequences(_,st,at){const lt={},ft=/^([\w-]*?)([\d]+)$/;for(let At=0,Ct=_.length;At<Ct;At++){const Tt=_[At],Ot=Tt.name.match(ft);if(Ot&&Ot.length>1){const Ut=Ot[1];let Lt=lt[Ut];Lt||(lt[Ut]=Lt=[]),Lt.push(Tt)}}const vt=[];for(const At in lt)vt.push(this.CreateFromMorphTargetSequence(At,lt[At],st,at));return vt}static parseAnimation(_,st){if(!_)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const at=function(Ot,Ut,Lt,Gt,Xt){if(Lt.length!==0){const Qt=[],lr=[];gu(Lt,Qt,lr,Gt),Qt.length!==0&&Xt.push(new Ot(Ut,Qt,lr))}},lt=[],ft=_.name||"default",vt=_.fps||30,At=_.blendMode;let Ct=_.length||-1;const Tt=_.hierarchy||[];for(let Ot=0;Ot<Tt.length;Ot++){const Ut=Tt[Ot].keys;if(Ut&&Ut.length!==0)if(Ut[0].morphTargets){const Lt={};let Gt;for(Gt=0;Gt<Ut.length;Gt++)if(Ut[Gt].morphTargets)for(let Xt=0;Xt<Ut[Gt].morphTargets.length;Xt++)Lt[Ut[Gt].morphTargets[Xt]]=-1;for(const Xt in Lt){const Qt=[],lr=[];for(let ur=0;ur!==Ut[Gt].morphTargets.length;++ur){const cr=Ut[Gt];Qt.push(cr.time),lr.push(cr.morphTarget===Xt?1:0)}lt.push(new l0(".morphTargetInfluence["+Xt+"]",Qt,lr))}Ct=Lt.length*vt}else{const Lt=".bones["+st[Ot].name+"]";at(cw,Lt+".position",Ut,"pos",lt),at(wm,Lt+".quaternion",Ut,"rot",lt),at(cw,Lt+".scale",Ut,"scl",lt)}}return lt.length===0?null:new this(ft,Ct,lt,At)}resetDuration(){let _=0;for(let st=0,at=this.tracks.length;st!==at;++st){const lt=this.tracks[st];_=Math.max(_,lt.times[lt.times.length-1])}return this.duration=_,this}trim(){for(let _=0;_<this.tracks.length;_++)this.tracks[_].trim(0,this.duration);return this}validate(){let _=!0;for(let st=0;st<this.tracks.length;st++)_=_&&this.tracks[st].validate();return _}optimize(){for(let _=0;_<this.tracks.length;_++)this.tracks[_].optimize();return this}clone(){const _=[];for(let st=0;st<this.tracks.length;st++)_.push(this.tracks[st].clone());return new this.constructor(this.name,this.duration,_,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function oy(wt){if(wt.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const _=function(st){switch(st.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return l0;case"vector":case"vector2":case"vector3":case"vector4":return cw;case"color":return a0;case"quaternion":return wm;case"bool":case"boolean":return o0;case"string":return nv}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+st)}(wt.type);if(wt.times===void 0){const st=[],at=[];gu(wt.keys,st,at,"value"),wt.times=st,wt.values=at}return _.parse!==void 0?_.parse(wt):new _(wt.name,wt.times,wt.values,wt.interpolation)}const u0={enabled:!1,files:{},add:function(wt,_){this.enabled!==!1&&(this.files[wt]=_)},get:function(wt,_){return this.enabled===!1?_?Promise.resolve():void 0:_?Promise.resolve(this.files[wt]):this.files[wt]},remove:function(wt){delete this.files[wt]},clear:function(){this.files={}}};class c0{constructor(_,st,at){const lt=this;let ft,vt=!1,At=0,Ct=0;const Tt=[];this.onStart=void 0,this.onLoad=_,this.onProgress=st,this.onError=at,this.itemStart=function(Ot){Ct++,vt===!1&&lt.onStart!==void 0&&lt.onStart(Ot,At,Ct),vt=!0},this.itemEnd=function(Ot){At++,lt.onProgress!==void 0&&lt.onProgress(Ot,At,Ct),At===Ct&&(vt=!1,lt.onLoad!==void 0&&lt.onLoad())},this.itemError=function(Ot){lt.onError!==void 0&&lt.onError(Ot)},this.resolveURL=function(Ot){return ft?ft(Ot):Ot},this.setURLModifier=function(Ot){return ft=Ot,this},this.addHandler=function(Ot,Ut){return Tt.push(Ot,Ut),this},this.removeHandler=function(Ot){const Ut=Tt.indexOf(Ot);return Ut!==-1&&Tt.splice(Ut,2),this},this.getHandler=function(Ot){for(let Ut=0,Lt=Tt.length;Ut<Lt;Ut+=2){const Gt=Tt[Ut],Xt=Tt[Ut+1];if(Gt.global&&(Gt.lastIndex=0),Gt.test(Ot))return Xt}return null}}}const sA=new c0;class Wu{constructor(_){this.manager=_!==void 0?_:sA,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(_,st){const at=this;return new Promise(function(lt,ft){at.load(_,lt,st,ft)})}parse(){}setCrossOrigin(_){return this.crossOrigin=_,this}setWithCredentials(_){return this.withCredentials=_,this}setPath(_){return this.path=_,this}setResourcePath(_){return this.resourcePath=_,this}setRequestHeader(_){return this.requestHeader=_,this}}const Du={};class SP extends Error{constructor(_,st){super(_),this.response=st}}class d0 extends Wu{constructor(_){super(_),this.responseType="text"}load(_,st,at,lt){_===void 0&&(_=""),this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_),u0.get(_,this.responseType,this.mimeType).then(ft=>{if(ft!==void 0)return this.manager.itemStart(_),setTimeout(()=>{st&&st(ft),this.manager.itemEnd(_)},0),ft;if(Du[_]!==void 0)return void Du[_].push({onLoad:st,onProgress:at,onError:lt});Du[_]=[],Du[_].push({onLoad:st,onProgress:at,onError:lt});const vt=new Request(_,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),At=this.mimeType,Ct=this.responseType;fetch(vt).then(Tt=>{if(Tt.status===200||Tt.status===0){if(Tt.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||Tt.body===void 0||Tt.body.getReader===void 0)return Tt;const Ot=Du[_],Ut=Tt.body.getReader(),Lt=Tt.headers.get("Content-Length"),Gt=Lt?parseInt(Lt):0,Xt=Gt!==0;let Qt=0;const lr=new ReadableStream({start(ur){(function cr(){Ut.read().then(({done:gr,value:wr})=>{if(gr)ur.close();else{Qt+=wr.byteLength;const Er=new ProgressEvent("progress",{lengthComputable:Xt,loaded:Qt,total:Gt});for(let Cr=0,zr=Ot.length;Cr<zr;Cr++){const Gr=Ot[Cr];Gr.onProgress&&Gr.onProgress(Er)}ur.enqueue(wr),cr()}})})()}});return new Response(lr)}throw new SP(`fetch for "${Tt.url}" responded with ${Tt.status}: ${Tt.statusText}`,Tt)}).then(Tt=>{switch(Ct){case"arraybuffer":return Tt.arrayBuffer();case"blob":return Tt.blob();case"document":return Tt.text().then(Ot=>new DOMParser().parseFromString(Ot,At));case"json":return Tt.json();default:if(At===void 0)return Tt.text();{const Ot=/charset="?([^;"\s]*)"?/i.exec(At),Ut=Ot&&Ot[1]?Ot[1].toLowerCase():void 0,Lt=new TextDecoder(Ut);return Tt.arrayBuffer().then(Gt=>Lt.decode(Gt))}}}).then(Tt=>{u0.add(_,Tt,this.responseType);const Ot=Du[_];delete Du[_];for(let Ut=0,Lt=Ot.length;Ut<Lt;Ut++){const Gt=Ot[Ut];Gt.onLoad&&Gt.onLoad(Tt)}}).catch(Tt=>{const Ot=Du[_];if(Ot===void 0)throw this.manager.itemError(_),Tt;delete Du[_];for(let Ut=0,Lt=Ot.length;Ut<Lt;Ut++){const Gt=Ot[Ut];Gt.onError&&Gt.onError(Tt)}this.manager.itemError(_)}).finally(()=>{this.manager.itemEnd(_)}),this.manager.itemStart(_)})}setResponseType(_){return this.responseType=_,this}setMimeType(_){return this.mimeType=_,this}}class k1 extends Wu{constructor(_){super(_)}load(_,st,at,lt){const ft=this,vt=new d0(this.manager);vt.setPath(this.path),vt.setRequestHeader(this.requestHeader),vt.setWithCredentials(this.withCredentials),vt.load(_,function(At){try{st(ft.parse(JSON.parse(At)))}catch(Ct){lt?lt(Ct):console.error(Ct),ft.manager.itemError(_)}},at,lt)}parse(_){const st=[];for(let at=0;at<_.length;at++){const lt=B1.parse(_[at]);st.push(lt)}return st}}class qp extends Wu{constructor(_){super(_)}load(_,st,at,lt){const ft=this,vt=[],At=new m1,Ct=new d0(this.manager);Ct.setPath(this.path),Ct.setResponseType("arraybuffer"),Ct.setRequestHeader(this.requestHeader),Ct.setWithCredentials(ft.withCredentials);let Tt=0;function Ot(Ut){Ct.load(_[Ut],function(Lt){const Gt=ft.parse(Lt,!0);vt[Ut]={width:Gt.width,height:Gt.height,format:Gt.format,mipmaps:Gt.mipmaps},Tt+=1,Tt===6&&(Gt.mipmapCount===1&&(At.minFilter=Ko),At.image=vt,At.format=Gt.format,At.needsUpdate=!0,st&&st(At))},at,lt)}if(Array.isArray(_))for(let Ut=0,Lt=_.length;Ut<Lt;++Ut)Ot(Ut);else Ct.load(_,function(Ut){const Lt=ft.parse(Ut,!0);if(Lt.isCubemap){const Gt=Lt.mipmaps.length/Lt.mipmapCount;for(let Xt=0;Xt<Gt;Xt++){vt[Xt]={mipmaps:[]};for(let Qt=0;Qt<Lt.mipmapCount;Qt++)vt[Xt].mipmaps.push(Lt.mipmaps[Xt*Lt.mipmapCount+Qt]),vt[Xt].format=Lt.format,vt[Xt].width=Lt.width,vt[Xt].height=Lt.height}At.image=vt}else At.image.width=Lt.width,At.image.height=Lt.height,At.mipmaps=Lt.mipmaps;Lt.mipmapCount===1&&(At.minFilter=Ko),At.format=Lt.format,At.needsUpdate=!0,st&&st(At)},at,lt);return At}}class dw extends Wu{constructor(_){super(_)}load(_,st,at,lt){this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const ft=this,vt=u0.get(_);if(vt!==void 0)return ft.manager.itemStart(_),setTimeout(function(){st&&st(vt),ft.manager.itemEnd(_)},0),vt;const At=z_("img");function Ct(){Ot(),u0.add(_,this),st&&st(this),ft.manager.itemEnd(_)}function Tt(Ut){Ot(),lt&&lt(Ut),ft.manager.itemError(_),ft.manager.itemEnd(_)}function Ot(){At.removeEventListener("load",Ct,!1),At.removeEventListener("error",Tt,!1)}return At.addEventListener("load",Ct,!1),At.addEventListener("error",Tt,!1),_.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(At.crossOrigin=this.crossOrigin),ft.manager.itemStart(_),At.src=_,At}}class NC extends Wu{constructor(_){super(_)}load(_,st,at,lt){const ft=new qA,vt=new dw(this.manager);vt.setCrossOrigin(this.crossOrigin),vt.setPath(this.path);let At=0;function Ct(Tt){vt.load(_[Tt],function(Ot){ft.images[Tt]=Ot,At++,At===6&&(ft.needsUpdate=!0,st&&st(ft))},void 0,lt)}for(let Tt=0;Tt<_.length;++Tt)Ct(Tt);return ft}}class p0 extends Wu{constructor(_){super(_)}load(_,st,at,lt){const ft=this,vt=new tw,At=new d0(this.manager);return At.setResponseType("arraybuffer"),At.setRequestHeader(this.requestHeader),At.setPath(this.path),At.setWithCredentials(ft.withCredentials),At.load(_,function(Ct){const Tt=ft.parse(Ct);Tt&&(Tt.image!==void 0?vt.image=Tt.image:Tt.data!==void 0&&(vt.image.width=Tt.width,vt.image.height=Tt.height,vt.image.data=Tt.data,vt.image.complete=!0),vt.wrapS=Tt.wrapS!==void 0?Tt.wrapS:co,vt.wrapT=Tt.wrapT!==void 0?Tt.wrapT:co,vt.magFilter=Tt.magFilter!==void 0?Tt.magFilter:Ko,vt.minFilter=Tt.minFilter!==void 0?Tt.minFilter:Ko,vt.anisotropy=Tt.anisotropy!==void 0?Tt.anisotropy:1,Tt.encoding!==void 0&&(vt.encoding=Tt.encoding),Tt.flipY!==void 0&&(vt.flipY=Tt.flipY),Tt.format!==void 0&&(vt.format=Tt.format),Tt.type!==void 0&&(vt.type=Tt.type),Tt.mipmaps!==void 0&&(vt.mipmaps=Tt.mipmaps,vt.minFilter=ys),Tt.mipmapCount===1&&(vt.minFilter=Ko),Tt.generateMipmaps!==void 0&&(vt.generateMipmaps=Tt.generateMipmaps),vt.needsUpdate=!0,st&&st(vt,Tt))},at,lt),vt}}class FC extends Wu{constructor(_){super(_)}load(_,st,at,lt){const ft=new Cu,vt=new dw(this.manager);return vt.setCrossOrigin(this.crossOrigin),vt.setPath(this.path),vt.load(_,function(At){ft.image=At,ft.needsUpdate=!0,st!==void 0&&st(ft)},at,lt),ft}}class m_ extends ao{constructor(_,st=1){super(),this.isLight=!0,this.type="Light",this.color=new ms(_),this.intensity=st}dispose(){}copy(_,st){return super.copy(_,st),this.color.copy(_.color),this.intensity=_.intensity,this}toJSON(_){const st=super.toJSON(_);return st.object.color=this.color.getHex(),st.object.intensity=this.intensity,this.groundColor!==void 0&&(st.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(st.object.distance=this.distance),this.angle!==void 0&&(st.object.angle=this.angle),this.decay!==void 0&&(st.object.decay=this.decay),this.penumbra!==void 0&&(st.object.penumbra=this.penumbra),this.shadow!==void 0&&(st.object.shadow=this.shadow.toJSON()),st}}class YM extends m_{constructor(_,st,at){super(_,at),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(ao.DefaultUp),this.updateMatrix(),this.groundColor=new ms(st)}copy(_,st){return super.copy(_,st),this.groundColor.copy(_.groundColor),this}}const UC=new Ys,TE=new Mr,ME=new Mr;class O1{constructor(_){this.camera=_,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vn(512,512),this.map=null,this.mapPass=null,this.matrix=new Ys,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Kw,this._frameExtents=new Vn(1,1),this._viewportCount=1,this._viewports=[new qo(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(_){const st=this.camera,at=this.matrix;TE.setFromMatrixPosition(_.matrixWorld),st.position.copy(TE),ME.setFromMatrixPosition(_.target.matrixWorld),st.lookAt(ME),st.updateMatrixWorld(),UC.multiplyMatrices(st.projectionMatrix,st.matrixWorldInverse),this._frustum.setFromProjectionMatrix(UC),at.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),at.multiply(st.projectionMatrix),at.multiply(st.matrixWorldInverse)}getViewport(_){return this._viewports[_]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(_){return this.camera=_.camera.clone(),this.bias=_.bias,this.normalBias=_.normalBias,this.radius=_.radius,this.mapSize.copy(_.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const _={};return this.bias!==0&&(_.bias=this.bias),this.normalBias!==0&&(_.normalBias=this.normalBias),this.radius!==1&&(_.radius=this.radius),this.mapSize.x===512&&this.mapSize.y===512||(_.mapSize=this.mapSize.toArray()),_.camera=this.camera.toJSON(!1).object,delete _.camera.matrix,_}}class g_ extends O1{constructor(){super(new op(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(_){const st=this.camera,at=2*ky*_.angle*this.focus,lt=this.mapSize.width/this.mapSize.height,ft=_.distance||st.far;at===st.fov&&lt===st.aspect&&ft===st.far||(st.fov=at,st.aspect=lt,st.far=ft,st.updateProjectionMatrix()),super.updateMatrices(_)}copy(_){return super.copy(_),this.focus=_.focus,this}}class $C extends m_{constructor(_,st,at=0,lt=Math.PI/3,ft=0,vt=1){super(_,st),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ao.DefaultUp),this.updateMatrix(),this.target=new ao,this.distance=at,this.angle=lt,this.penumbra=ft,this.decay=vt,this.map=null,this.shadow=new g_}get power(){return this.intensity*Math.PI}set power(_){this.intensity=_/Math.PI}dispose(){this.shadow.dispose()}copy(_,st){return super.copy(_,st),this.distance=_.distance,this.angle=_.angle,this.penumbra=_.penumbra,this.decay=_.decay,this.target=_.target.clone(),this.shadow=_.shadow.clone(),this}}const RE=new Ys,L1=new Mr,N1=new Mr;class jC extends O1{constructor(){super(new op(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vn(4,2),this._viewportCount=6,this._viewports=[new qo(2,1,1,1),new qo(0,1,1,1),new qo(3,1,1,1),new qo(1,1,1,1),new qo(3,0,1,1),new qo(1,0,1,1)],this._cubeDirections=[new Mr(1,0,0),new Mr(-1,0,0),new Mr(0,0,1),new Mr(0,0,-1),new Mr(0,1,0),new Mr(0,-1,0)],this._cubeUps=[new Mr(0,1,0),new Mr(0,1,0),new Mr(0,1,0),new Mr(0,1,0),new Mr(0,0,1),new Mr(0,0,-1)]}updateMatrices(_,st=0){const at=this.camera,lt=this.matrix,ft=_.distance||at.far;ft!==at.far&&(at.far=ft,at.updateProjectionMatrix()),L1.setFromMatrixPosition(_.matrixWorld),at.position.copy(L1),N1.copy(at.position),N1.add(this._cubeDirections[st]),at.up.copy(this._cubeUps[st]),at.lookAt(N1),at.updateMatrixWorld(),lt.makeTranslation(-L1.x,-L1.y,-L1.z),RE.multiplyMatrices(at.projectionMatrix,at.matrixWorldInverse),this._frustum.setFromProjectionMatrix(RE)}}class KM extends m_{constructor(_,st,at=0,lt=1){super(_,st),this.isPointLight=!0,this.type="PointLight",this.distance=at,this.decay=lt,this.shadow=new jC}get power(){return 4*this.intensity*Math.PI}set power(_){this.intensity=_/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(_,st){return super.copy(_,st),this.distance=_.distance,this.decay=_.decay,this.shadow=_.shadow.clone(),this}}class IE extends O1{constructor(){super(new Ox(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class XM extends m_{constructor(_,st){super(_,st),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ao.DefaultUp),this.updateMatrix(),this.target=new ao,this.shadow=new IE}dispose(){this.shadow.dispose()}copy(_){return super.copy(_),this.target=_.target.clone(),this.shadow=_.shadow.clone(),this}}class JM extends m_{constructor(_,st){super(_,st),this.isAmbientLight=!0,this.type="AmbientLight"}}class ZM extends m_{constructor(_,st,at=10,lt=10){super(_,st),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=at,this.height=lt}get power(){return this.intensity*this.width*this.height*Math.PI}set power(_){this.intensity=_/(this.width*this.height*Math.PI)}copy(_){return super.copy(_),this.width=_.width,this.height=_.height,this}toJSON(_){const st=super.toJSON(_);return st.object.width=this.width,st.object.height=this.height,st}}class F1{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let _=0;_<9;_++)this.coefficients.push(new Mr)}set(_){for(let st=0;st<9;st++)this.coefficients[st].copy(_[st]);return this}zero(){for(let _=0;_<9;_++)this.coefficients[_].set(0,0,0);return this}getAt(_,st){const at=_.x,lt=_.y,ft=_.z,vt=this.coefficients;return st.copy(vt[0]).multiplyScalar(.282095),st.addScaledVector(vt[1],.488603*lt),st.addScaledVector(vt[2],.488603*ft),st.addScaledVector(vt[3],.488603*at),st.addScaledVector(vt[4],at*lt*1.092548),st.addScaledVector(vt[5],lt*ft*1.092548),st.addScaledVector(vt[6],.315392*(3*ft*ft-1)),st.addScaledVector(vt[7],at*ft*1.092548),st.addScaledVector(vt[8],.546274*(at*at-lt*lt)),st}getIrradianceAt(_,st){const at=_.x,lt=_.y,ft=_.z,vt=this.coefficients;return st.copy(vt[0]).multiplyScalar(.886227),st.addScaledVector(vt[1],1.023328*lt),st.addScaledVector(vt[2],1.023328*ft),st.addScaledVector(vt[3],1.023328*at),st.addScaledVector(vt[4],.858086*at*lt),st.addScaledVector(vt[5],.858086*lt*ft),st.addScaledVector(vt[6],.743125*ft*ft-.247708),st.addScaledVector(vt[7],.858086*at*ft),st.addScaledVector(vt[8],.429043*(at*at-lt*lt)),st}add(_){for(let st=0;st<9;st++)this.coefficients[st].add(_.coefficients[st]);return this}addScaledSH(_,st){for(let at=0;at<9;at++)this.coefficients[at].addScaledVector(_.coefficients[at],st);return this}scale(_){for(let st=0;st<9;st++)this.coefficients[st].multiplyScalar(_);return this}lerp(_,st){for(let at=0;at<9;at++)this.coefficients[at].lerp(_.coefficients[at],st);return this}equals(_){for(let st=0;st<9;st++)if(!this.coefficients[st].equals(_.coefficients[st]))return!1;return!0}copy(_){return this.set(_.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(_,st=0){const at=this.coefficients;for(let lt=0;lt<9;lt++)at[lt].fromArray(_,st+3*lt);return this}toArray(_=[],st=0){const at=this.coefficients;for(let lt=0;lt<9;lt++)at[lt].toArray(_,st+3*lt);return _}static getBasisAt(_,st){const at=_.x,lt=_.y,ft=_.z;st[0]=.282095,st[1]=.488603*lt,st[2]=.488603*ft,st[3]=.488603*at,st[4]=1.092548*at*lt,st[5]=1.092548*lt*ft,st[6]=.315392*(3*ft*ft-1),st[7]=1.092548*at*ft,st[8]=.546274*(at*at-lt*lt)}}class PE extends m_{constructor(_=new F1,st=1){super(void 0,st),this.isLightProbe=!0,this.sh=_}copy(_){return super.copy(_),this.sh.copy(_.sh),this}fromJSON(_){return this.intensity=_.intensity,this.sh.fromArray(_.sh),this}toJSON(_){const st=super.toJSON(_);return st.object.sh=this.sh.toArray(),st}}class h0 extends Wu{constructor(_){super(_),this.textures={}}load(_,st,at,lt){const ft=this,vt=new d0(ft.manager);vt.setPath(ft.path),vt.setRequestHeader(ft.requestHeader),vt.setWithCredentials(ft.withCredentials),vt.load(_,function(At){try{st(ft.parse(JSON.parse(At)))}catch(Ct){lt?lt(Ct):console.error(Ct),ft.manager.itemError(_)}},at,lt)}parse(_){const st=this.textures;function at(ft){return st[ft]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",ft),st[ft]}const lt=h0.createMaterialFromType(_.type);if(_.uuid!==void 0&&(lt.uuid=_.uuid),_.name!==void 0&&(lt.name=_.name),_.color!==void 0&&lt.color!==void 0&&lt.color.setHex(_.color),_.roughness!==void 0&&(lt.roughness=_.roughness),_.metalness!==void 0&&(lt.metalness=_.metalness),_.sheen!==void 0&&(lt.sheen=_.sheen),_.sheenColor!==void 0&&(lt.sheenColor=new ms().setHex(_.sheenColor)),_.sheenRoughness!==void 0&&(lt.sheenRoughness=_.sheenRoughness),_.emissive!==void 0&&lt.emissive!==void 0&&lt.emissive.setHex(_.emissive),_.specular!==void 0&&lt.specular!==void 0&&lt.specular.setHex(_.specular),_.specularIntensity!==void 0&&(lt.specularIntensity=_.specularIntensity),_.specularColor!==void 0&&lt.specularColor!==void 0&&lt.specularColor.setHex(_.specularColor),_.shininess!==void 0&&(lt.shininess=_.shininess),_.clearcoat!==void 0&&(lt.clearcoat=_.clearcoat),_.clearcoatRoughness!==void 0&&(lt.clearcoatRoughness=_.clearcoatRoughness),_.iridescence!==void 0&&(lt.iridescence=_.iridescence),_.iridescenceIOR!==void 0&&(lt.iridescenceIOR=_.iridescenceIOR),_.iridescenceThicknessRange!==void 0&&(lt.iridescenceThicknessRange=_.iridescenceThicknessRange),_.transmission!==void 0&&(lt.transmission=_.transmission),_.thickness!==void 0&&(lt.thickness=_.thickness),_.attenuationDistance!==void 0&&(lt.attenuationDistance=_.attenuationDistance),_.attenuationColor!==void 0&&lt.attenuationColor!==void 0&&lt.attenuationColor.setHex(_.attenuationColor),_.fog!==void 0&&(lt.fog=_.fog),_.flatShading!==void 0&&(lt.flatShading=_.flatShading),_.blending!==void 0&&(lt.blending=_.blending),_.combine!==void 0&&(lt.combine=_.combine),_.side!==void 0&&(lt.side=_.side),_.shadowSide!==void 0&&(lt.shadowSide=_.shadowSide),_.opacity!==void 0&&(lt.opacity=_.opacity),_.transparent!==void 0&&(lt.transparent=_.transparent),_.alphaTest!==void 0&&(lt.alphaTest=_.alphaTest),_.depthTest!==void 0&&(lt.depthTest=_.depthTest),_.depthWrite!==void 0&&(lt.depthWrite=_.depthWrite),_.colorWrite!==void 0&&(lt.colorWrite=_.colorWrite),_.stencilWrite!==void 0&&(lt.stencilWrite=_.stencilWrite),_.stencilWriteMask!==void 0&&(lt.stencilWriteMask=_.stencilWriteMask),_.stencilFunc!==void 0&&(lt.stencilFunc=_.stencilFunc),_.stencilRef!==void 0&&(lt.stencilRef=_.stencilRef),_.stencilFuncMask!==void 0&&(lt.stencilFuncMask=_.stencilFuncMask),_.stencilFail!==void 0&&(lt.stencilFail=_.stencilFail),_.stencilZFail!==void 0&&(lt.stencilZFail=_.stencilZFail),_.stencilZPass!==void 0&&(lt.stencilZPass=_.stencilZPass),_.wireframe!==void 0&&(lt.wireframe=_.wireframe),_.wireframeLinewidth!==void 0&&(lt.wireframeLinewidth=_.wireframeLinewidth),_.wireframeLinecap!==void 0&&(lt.wireframeLinecap=_.wireframeLinecap),_.wireframeLinejoin!==void 0&&(lt.wireframeLinejoin=_.wireframeLinejoin),_.rotation!==void 0&&(lt.rotation=_.rotation),_.linewidth!==1&&(lt.linewidth=_.linewidth),_.dashSize!==void 0&&(lt.dashSize=_.dashSize),_.gapSize!==void 0&&(lt.gapSize=_.gapSize),_.scale!==void 0&&(lt.scale=_.scale),_.polygonOffset!==void 0&&(lt.polygonOffset=_.polygonOffset),_.polygonOffsetFactor!==void 0&&(lt.polygonOffsetFactor=_.polygonOffsetFactor),_.polygonOffsetUnits!==void 0&&(lt.polygonOffsetUnits=_.polygonOffsetUnits),_.dithering!==void 0&&(lt.dithering=_.dithering),_.alphaToCoverage!==void 0&&(lt.alphaToCoverage=_.alphaToCoverage),_.premultipliedAlpha!==void 0&&(lt.premultipliedAlpha=_.premultipliedAlpha),_.visible!==void 0&&(lt.visible=_.visible),_.toneMapped!==void 0&&(lt.toneMapped=_.toneMapped),_.userData!==void 0&&(lt.userData=_.userData),_.vertexColors!==void 0&&(typeof _.vertexColors=="number"?lt.vertexColors=_.vertexColors>0:lt.vertexColors=_.vertexColors),_.uniforms!==void 0)for(const ft in _.uniforms){const vt=_.uniforms[ft];switch(lt.uniforms[ft]={},vt.type){case"t":lt.uniforms[ft].value=at(vt.value);break;case"c":lt.uniforms[ft].value=new ms().setHex(vt.value);break;case"v2":lt.uniforms[ft].value=new Vn().fromArray(vt.value);break;case"v3":lt.uniforms[ft].value=new Mr().fromArray(vt.value);break;case"v4":lt.uniforms[ft].value=new qo().fromArray(vt.value);break;case"m3":lt.uniforms[ft].value=new ju().fromArray(vt.value);break;case"m4":lt.uniforms[ft].value=new Ys().fromArray(vt.value);break;default:lt.uniforms[ft].value=vt.value}}if(_.defines!==void 0&&(lt.defines=_.defines),_.vertexShader!==void 0&&(lt.vertexShader=_.vertexShader),_.fragmentShader!==void 0&&(lt.fragmentShader=_.fragmentShader),_.glslVersion!==void 0&&(lt.glslVersion=_.glslVersion),_.extensions!==void 0)for(const ft in _.extensions)lt.extensions[ft]=_.extensions[ft];if(_.size!==void 0&&(lt.size=_.size),_.sizeAttenuation!==void 0&&(lt.sizeAttenuation=_.sizeAttenuation),_.map!==void 0&&(lt.map=at(_.map)),_.matcap!==void 0&&(lt.matcap=at(_.matcap)),_.alphaMap!==void 0&&(lt.alphaMap=at(_.alphaMap)),_.bumpMap!==void 0&&(lt.bumpMap=at(_.bumpMap)),_.bumpScale!==void 0&&(lt.bumpScale=_.bumpScale),_.normalMap!==void 0&&(lt.normalMap=at(_.normalMap)),_.normalMapType!==void 0&&(lt.normalMapType=_.normalMapType),_.normalScale!==void 0){let ft=_.normalScale;Array.isArray(ft)===!1&&(ft=[ft,ft]),lt.normalScale=new Vn().fromArray(ft)}return _.displacementMap!==void 0&&(lt.displacementMap=at(_.displacementMap)),_.displacementScale!==void 0&&(lt.displacementScale=_.displacementScale),_.displacementBias!==void 0&&(lt.displacementBias=_.displacementBias),_.roughnessMap!==void 0&&(lt.roughnessMap=at(_.roughnessMap)),_.metalnessMap!==void 0&&(lt.metalnessMap=at(_.metalnessMap)),_.emissiveMap!==void 0&&(lt.emissiveMap=at(_.emissiveMap)),_.emissiveIntensity!==void 0&&(lt.emissiveIntensity=_.emissiveIntensity),_.specularMap!==void 0&&(lt.specularMap=at(_.specularMap)),_.specularIntensityMap!==void 0&&(lt.specularIntensityMap=at(_.specularIntensityMap)),_.specularColorMap!==void 0&&(lt.specularColorMap=at(_.specularColorMap)),_.envMap!==void 0&&(lt.envMap=at(_.envMap)),_.envMapIntensity!==void 0&&(lt.envMapIntensity=_.envMapIntensity),_.reflectivity!==void 0&&(lt.reflectivity=_.reflectivity),_.refractionRatio!==void 0&&(lt.refractionRatio=_.refractionRatio),_.lightMap!==void 0&&(lt.lightMap=at(_.lightMap)),_.lightMapIntensity!==void 0&&(lt.lightMapIntensity=_.lightMapIntensity),_.aoMap!==void 0&&(lt.aoMap=at(_.aoMap)),_.aoMapIntensity!==void 0&&(lt.aoMapIntensity=_.aoMapIntensity),_.gradientMap!==void 0&&(lt.gradientMap=at(_.gradientMap)),_.clearcoatMap!==void 0&&(lt.clearcoatMap=at(_.clearcoatMap)),_.clearcoatRoughnessMap!==void 0&&(lt.clearcoatRoughnessMap=at(_.clearcoatRoughnessMap)),_.clearcoatNormalMap!==void 0&&(lt.clearcoatNormalMap=at(_.clearcoatNormalMap)),_.clearcoatNormalScale!==void 0&&(lt.clearcoatNormalScale=new Vn().fromArray(_.clearcoatNormalScale)),_.iridescenceMap!==void 0&&(lt.iridescenceMap=at(_.iridescenceMap)),_.iridescenceThicknessMap!==void 0&&(lt.iridescenceThicknessMap=at(_.iridescenceThicknessMap)),_.transmissionMap!==void 0&&(lt.transmissionMap=at(_.transmissionMap)),_.thicknessMap!==void 0&&(lt.thicknessMap=at(_.thicknessMap)),_.sheenColorMap!==void 0&&(lt.sheenColorMap=at(_.sheenColorMap)),_.sheenRoughnessMap!==void 0&&(lt.sheenRoughnessMap=at(_.sheenRoughnessMap)),lt}setTextures(_){return this.textures=_,this}static createMaterialFromType(_){return new{ShadowMaterial:SE,SpriteMaterial:nE,RawShaderMaterial:HM,ShaderMaterial:Tv,PointsMaterial:dE,MeshPhysicalMaterial:DC,MeshStandardMaterial:PC,MeshPhongMaterial:M1,MeshToonMaterial:qM,MeshNormalMaterial:R1,MeshLambertMaterial:BC,MeshDepthMaterial:o1,MeshDistanceMaterial:JA,MeshBasicMaterial:Jm,MeshMatcapMaterial:I1,LineDashedMaterial:kC,LineBasicMaterial:Qp,Material:Qu}[_]}}class v_{static decodeText(_){if(typeof TextDecoder<"u")return new TextDecoder().decode(_);let st="";for(let at=0,lt=_.length;at<lt;at++)st+=String.fromCharCode(_[at]);try{return decodeURIComponent(escape(st))}catch{return st}}static extractUrlBase(_){const st=_.lastIndexOf("/");return st===-1?"./":_.slice(0,st+1)}static resolveURL(_,st){return typeof _!="string"||_===""?"":(/^https?:\/\//i.test(st)&&/^\//.test(_)&&(st=st.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(_)||/^data:.*,.*$/i.test(_)||/^blob:.*$/i.test(_)?_:st+_)}}class xm extends xs{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(_){return super.copy(_),this.instanceCount=_.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const _=super.toJSON(this);return _.instanceCount=this.instanceCount,_.isInstancedBufferGeometry=!0,_}}class eR extends Wu{constructor(_){super(_)}load(_,st,at,lt){const ft=this,vt=new d0(ft.manager);vt.setPath(ft.path),vt.setRequestHeader(ft.requestHeader),vt.setWithCredentials(ft.withCredentials),vt.load(_,function(At){try{st(ft.parse(JSON.parse(At)))}catch(Ct){lt?lt(Ct):console.error(Ct),ft.manager.itemError(_)}},at,lt)}parse(_){const st={},at={};function lt(Ut,Lt){if(st[Lt]!==void 0)return st[Lt];const Gt=Ut.interleavedBuffers[Lt],Xt=function(ur,cr){if(at[cr]!==void 0)return at[cr];const gr=ur.arrayBuffers[cr],wr=new Uint32Array(gr).buffer;return at[cr]=wr,wr}(Ut,Gt.buffer),Qt=j_(Gt.type,Xt),lr=new rE(Qt,Gt.stride);return lr.uuid=Gt.uuid,st[Lt]=lr,lr}const ft=_.isInstancedBufferGeometry?new xm:new xs,vt=_.data.index;if(vt!==void 0){const Ut=j_(vt.type,vt.array);ft.setIndex(new El(Ut,1))}const At=_.data.attributes;for(const Ut in At){const Lt=At[Ut];let Gt;if(Lt.isInterleavedBufferAttribute){const Xt=lt(_.data,Lt.data);Gt=new d_(Xt,Lt.itemSize,Lt.offset,Lt.normalized)}else{const Xt=j_(Lt.type,Lt.array);Gt=new(Lt.isInstancedBufferAttribute?Jy:El)(Xt,Lt.itemSize,Lt.normalized)}Lt.name!==void 0&&(Gt.name=Lt.name),Lt.usage!==void 0&&Gt.setUsage(Lt.usage),Lt.updateRange!==void 0&&(Gt.updateRange.offset=Lt.updateRange.offset,Gt.updateRange.count=Lt.updateRange.count),ft.setAttribute(Ut,Gt)}const Ct=_.data.morphAttributes;if(Ct)for(const Ut in Ct){const Lt=Ct[Ut],Gt=[];for(let Xt=0,Qt=Lt.length;Xt<Qt;Xt++){const lr=Lt[Xt];let ur;if(lr.isInterleavedBufferAttribute){const cr=lt(_.data,lr.data);ur=new d_(cr,lr.itemSize,lr.offset,lr.normalized)}else{const cr=j_(lr.type,lr.array);ur=new El(cr,lr.itemSize,lr.normalized)}lr.name!==void 0&&(ur.name=lr.name),Gt.push(ur)}ft.morphAttributes[Ut]=Gt}_.data.morphTargetsRelative&&(ft.morphTargetsRelative=!0);const Tt=_.data.groups||_.data.drawcalls||_.data.offsets;if(Tt!==void 0)for(let Ut=0,Lt=Tt.length;Ut!==Lt;++Ut){const Gt=Tt[Ut];ft.addGroup(Gt.start,Gt.count,Gt.materialIndex)}const Ot=_.data.boundingSphere;if(Ot!==void 0){const Ut=new Mr;Ot.center!==void 0&&Ut.fromArray(Ot.center),ft.boundingSphere=new am(Ut,Ot.radius)}return _.name&&(ft.name=_.name),_.userData&&(ft.userData=_.userData),ft}}class zC extends Wu{constructor(_){super(_)}load(_,st,at,lt){const ft=this,vt=this.path===""?v_.extractUrlBase(_):this.path;this.resourcePath=this.resourcePath||vt;const At=new d0(this.manager);At.setPath(this.path),At.setRequestHeader(this.requestHeader),At.setWithCredentials(this.withCredentials),At.load(_,function(Ct){let Tt=null;try{Tt=JSON.parse(Ct)}catch(Ut){return lt!==void 0&&lt(Ut),void console.error("THREE:ObjectLoader: Can't parse "+_+".",Ut.message)}const Ot=Tt.metadata;Ot!==void 0&&Ot.type!==void 0&&Ot.type.toLowerCase()!=="geometry"?ft.parse(Tt,st):console.error("THREE.ObjectLoader: Can't load "+_)},at,lt)}async loadAsync(_,st){const at=this.path===""?v_.extractUrlBase(_):this.path;this.resourcePath=this.resourcePath||at;const lt=new d0(this.manager);lt.setPath(this.path),lt.setRequestHeader(this.requestHeader),lt.setWithCredentials(this.withCredentials);const ft=await lt.loadAsync(_,st),vt=JSON.parse(ft),At=vt.metadata;if(At===void 0||At.type===void 0||At.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+_);return await this.parseAsync(vt)}parse(_,st){const at=this.parseAnimations(_.animations),lt=this.parseShapes(_.shapes),ft=this.parseGeometries(_.geometries,lt),vt=this.parseImages(_.images,function(){st!==void 0&&st(Tt)}),At=this.parseTextures(_.textures,vt),Ct=this.parseMaterials(_.materials,At),Tt=this.parseObject(_.object,ft,Ct,At,at),Ot=this.parseSkeletons(_.skeletons,Tt);if(this.bindSkeletons(Tt,Ot),st!==void 0){let Ut=!1;for(const Lt in vt)if(vt[Lt].data instanceof HTMLImageElement){Ut=!0;break}Ut===!1&&st(Tt)}return Tt}async parseAsync(_){const st=this.parseAnimations(_.animations),at=this.parseShapes(_.shapes),lt=this.parseGeometries(_.geometries,at),ft=await this.parseImagesAsync(_.images),vt=this.parseTextures(_.textures,ft),At=this.parseMaterials(_.materials,vt),Ct=this.parseObject(_.object,lt,At,vt,st),Tt=this.parseSkeletons(_.skeletons,Ct);return this.bindSkeletons(Ct,Tt),Ct}parseShapes(_){const st={};if(_!==void 0)for(let at=0,lt=_.length;at<lt;at++){const ft=new eA().fromJSON(_[at]);st[ft.uuid]=ft}return st}parseSkeletons(_,st){const at={},lt={};if(st.traverse(function(ft){ft.isBone&&(lt[ft.uuid]=ft)}),_!==void 0)for(let ft=0,vt=_.length;ft<vt;ft++){const At=new u1().fromJSON(_[ft],lt);at[At.uuid]=At}return at}parseGeometries(_,st){const at={};if(_!==void 0){const lt=new eR;for(let ft=0,vt=_.length;ft<vt;ft++){let At;const Ct=_[ft];switch(Ct.type){case"BufferGeometry":case"InstancedBufferGeometry":At=lt.parse(Ct);break;default:Ct.type in rv?At=rv[Ct.type].fromJSON(Ct,st):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${Ct.type}"`)}At.uuid=Ct.uuid,Ct.name!==void 0&&(At.name=Ct.name),At.isBufferGeometry===!0&&Ct.userData!==void 0&&(At.userData=Ct.userData),at[Ct.uuid]=At}}return at}parseMaterials(_,st){const at={},lt={};if(_!==void 0){const ft=new h0;ft.setTextures(st);for(let vt=0,At=_.length;vt<At;vt++){const Ct=_[vt];at[Ct.uuid]===void 0&&(at[Ct.uuid]=ft.parse(Ct)),lt[Ct.uuid]=at[Ct.uuid]}}return lt}parseAnimations(_){const st={};if(_!==void 0)for(let at=0;at<_.length;at++){const lt=_[at],ft=B1.parse(lt);st[ft.uuid]=ft}return st}parseImages(_,st){const at=this,lt={};let ft;function vt(At){if(typeof At=="string"){const Ct=At;return function(Tt){return at.manager.itemStart(Tt),ft.load(Tt,function(){at.manager.itemEnd(Tt)},void 0,function(){at.manager.itemError(Tt),at.manager.itemEnd(Tt)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(Ct)?Ct:at.resourcePath+Ct)}return At.data?{data:j_(At.type,At.data),width:At.width,height:At.height,complete:!0}:null}if(_!==void 0&&_.length>0){const At=new c0(st);ft=new dw(At),ft.setCrossOrigin(this.crossOrigin);for(let Ct=0,Tt=_.length;Ct<Tt;Ct++){const Ot=_[Ct],Ut=Ot.url;if(Array.isArray(Ut)){const Lt=[];for(let Gt=0,Xt=Ut.length;Gt<Xt;Gt++){const Qt=vt(Ut[Gt]);Qt!==null&&(Qt instanceof HTMLImageElement?Lt.push(Qt):Lt.push(new tw(Qt.data,Qt.width,Qt.height)))}lt[Ot.uuid]=new V_(Lt)}else{const Lt=vt(Ot.url);lt[Ot.uuid]=new V_(Lt)}}}return lt}async parseImagesAsync(_){const st=this,at={};let lt;async function ft(vt){if(typeof vt=="string"){const At=vt,Ct=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(At)?At:st.resourcePath+At;return await lt.loadAsync(Ct)}return vt.data?{data:j_(vt.type,vt.data),width:vt.width,height:vt.height,complete:!0}:null}if(_!==void 0&&_.length>0){lt=new dw(this.manager),lt.setCrossOrigin(this.crossOrigin);for(let vt=0,At=_.length;vt<At;vt++){const Ct=_[vt],Tt=Ct.url;if(Array.isArray(Tt)){const Ot=[];for(let Ut=0,Lt=Tt.length;Ut<Lt;Ut++){const Gt=Tt[Ut],Xt=await ft(Gt);Xt!==null&&(Xt instanceof HTMLImageElement?Ot.push(Xt):Ot.push(new tw(Xt.data,Xt.width,Xt.height)))}at[Ct.uuid]=new V_(Ot)}else{const Ot=await ft(Ct.url);at[Ct.uuid]=new V_(Ot)}}}return at}parseTextures(_,st){function at(ft,vt){return typeof ft=="number"?ft:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",ft),vt[ft])}const lt={};if(_!==void 0)for(let ft=0,vt=_.length;ft<vt;ft++){const At=_[ft];At.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',At.uuid),st[At.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",At.image);const Ct=st[At.image],Tt=Ct?Ct.data:void 0;let Ot;Array.isArray(Tt)?(Ot=new qA,Tt.length===6&&(Ot.needsUpdate=!0)):(Ot=Tt&&Tt.data?new tw:new Cu,Tt&&Tt.complete&&(Ot.needsUpdate=!0)),Ot.source=Ct,Ot.uuid=At.uuid,At.name!==void 0&&(Ot.name=At.name),At.mapping!==void 0&&(Ot.mapping=at(At.mapping,CP)),At.offset!==void 0&&Ot.offset.fromArray(At.offset),At.repeat!==void 0&&Ot.repeat.fromArray(At.repeat),At.center!==void 0&&Ot.center.fromArray(At.center),At.rotation!==void 0&&(Ot.rotation=At.rotation),At.wrap!==void 0&&(Ot.wrapS=at(At.wrap[0],DE),Ot.wrapT=at(At.wrap[1],DE)),At.format!==void 0&&(Ot.format=At.format),At.type!==void 0&&(Ot.type=At.type),At.encoding!==void 0&&(Ot.encoding=At.encoding),At.minFilter!==void 0&&(Ot.minFilter=at(At.minFilter,tR)),At.magFilter!==void 0&&(Ot.magFilter=at(At.magFilter,tR)),At.anisotropy!==void 0&&(Ot.anisotropy=At.anisotropy),At.flipY!==void 0&&(Ot.flipY=At.flipY),At.premultiplyAlpha!==void 0&&(Ot.premultiplyAlpha=At.premultiplyAlpha),At.unpackAlignment!==void 0&&(Ot.unpackAlignment=At.unpackAlignment),At.userData!==void 0&&(Ot.userData=At.userData),lt[At.uuid]=Ot}return lt}parseObject(_,st,at,lt,ft){let vt,At,Ct;function Tt(Lt){return st[Lt]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",Lt),st[Lt]}function Ot(Lt){if(Lt!==void 0){if(Array.isArray(Lt)){const Gt=[];for(let Xt=0,Qt=Lt.length;Xt<Qt;Xt++){const lr=Lt[Xt];at[lr]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",lr),Gt.push(at[lr])}return Gt}return at[Lt]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",Lt),at[Lt]}}function Ut(Lt){return lt[Lt]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",Lt),lt[Lt]}switch(_.type){case"Scene":vt=new RM,_.background!==void 0&&(Number.isInteger(_.background)?vt.background=new ms(_.background):vt.background=Ut(_.background)),_.environment!==void 0&&(vt.environment=Ut(_.environment)),_.fog!==void 0&&(_.fog.type==="Fog"?vt.fog=new ZA(_.fog.color,_.fog.near,_.fog.far):_.fog.type==="FogExp2"&&(vt.fog=new J0(_.fog.color,_.fog.density)));break;case"PerspectiveCamera":vt=new op(_.fov,_.aspect,_.near,_.far),_.focus!==void 0&&(vt.focus=_.focus),_.zoom!==void 0&&(vt.zoom=_.zoom),_.filmGauge!==void 0&&(vt.filmGauge=_.filmGauge),_.filmOffset!==void 0&&(vt.filmOffset=_.filmOffset),_.view!==void 0&&(vt.view=Object.assign({},_.view));break;case"OrthographicCamera":vt=new Ox(_.left,_.right,_.top,_.bottom,_.near,_.far),_.zoom!==void 0&&(vt.zoom=_.zoom),_.view!==void 0&&(vt.view=Object.assign({},_.view));break;case"AmbientLight":vt=new JM(_.color,_.intensity);break;case"DirectionalLight":vt=new XM(_.color,_.intensity);break;case"PointLight":vt=new KM(_.color,_.intensity,_.distance,_.decay);break;case"RectAreaLight":vt=new ZM(_.color,_.intensity,_.width,_.height);break;case"SpotLight":vt=new $C(_.color,_.intensity,_.distance,_.angle,_.penumbra,_.decay);break;case"HemisphereLight":vt=new YM(_.color,_.groundColor,_.intensity);break;case"LightProbe":vt=new PE().fromJSON(_);break;case"SkinnedMesh":At=Tt(_.geometry),Ct=Ot(_.material),vt=new hC(At,Ct),_.bindMode!==void 0&&(vt.bindMode=_.bindMode),_.bindMatrix!==void 0&&vt.bindMatrix.fromArray(_.bindMatrix),_.skeleton!==void 0&&(vt.skeleton=_.skeleton);break;case"Mesh":At=Tt(_.geometry),Ct=Ot(_.material),vt=new Hu(At,Ct);break;case"InstancedMesh":At=Tt(_.geometry),Ct=Ot(_.material);const Lt=_.count,Gt=_.instanceMatrix,Xt=_.instanceColor;vt=new lE(At,Ct,Lt),vt.instanceMatrix=new Jy(new Float32Array(Gt.array),16),Xt!==void 0&&(vt.instanceColor=new Jy(new Float32Array(Xt.array),Xt.itemSize));break;case"LOD":vt=new ew;break;case"Line":vt=new h_(Tt(_.geometry),Ot(_.material));break;case"LineLoop":vt=new rw(Tt(_.geometry),Ot(_.material));break;case"LineSegments":vt=new f_(Tt(_.geometry),Ot(_.material));break;case"PointCloud":case"Points":vt=new fE(Tt(_.geometry),Ot(_.material));break;case"Sprite":vt=new oE(Ot(_.material));break;case"Group":vt=new e0;break;case"Bone":vt=new fC;break;default:vt=new ao}if(vt.uuid=_.uuid,_.name!==void 0&&(vt.name=_.name),_.matrix!==void 0?(vt.matrix.fromArray(_.matrix),_.matrixAutoUpdate!==void 0&&(vt.matrixAutoUpdate=_.matrixAutoUpdate),vt.matrixAutoUpdate&&vt.matrix.decompose(vt.position,vt.quaternion,vt.scale)):(_.position!==void 0&&vt.position.fromArray(_.position),_.rotation!==void 0&&vt.rotation.fromArray(_.rotation),_.quaternion!==void 0&&vt.quaternion.fromArray(_.quaternion),_.scale!==void 0&&vt.scale.fromArray(_.scale)),_.castShadow!==void 0&&(vt.castShadow=_.castShadow),_.receiveShadow!==void 0&&(vt.receiveShadow=_.receiveShadow),_.shadow&&(_.shadow.bias!==void 0&&(vt.shadow.bias=_.shadow.bias),_.shadow.normalBias!==void 0&&(vt.shadow.normalBias=_.shadow.normalBias),_.shadow.radius!==void 0&&(vt.shadow.radius=_.shadow.radius),_.shadow.mapSize!==void 0&&vt.shadow.mapSize.fromArray(_.shadow.mapSize),_.shadow.camera!==void 0&&(vt.shadow.camera=this.parseObject(_.shadow.camera))),_.visible!==void 0&&(vt.visible=_.visible),_.frustumCulled!==void 0&&(vt.frustumCulled=_.frustumCulled),_.renderOrder!==void 0&&(vt.renderOrder=_.renderOrder),_.userData!==void 0&&(vt.userData=_.userData),_.layers!==void 0&&(vt.layers.mask=_.layers),_.children!==void 0){const Lt=_.children;for(let Gt=0;Gt<Lt.length;Gt++)vt.add(this.parseObject(Lt[Gt],st,at,lt,ft))}if(_.animations!==void 0){const Lt=_.animations;for(let Gt=0;Gt<Lt.length;Gt++){const Xt=Lt[Gt];vt.animations.push(ft[Xt])}}if(_.type==="LOD"){_.autoUpdate!==void 0&&(vt.autoUpdate=_.autoUpdate);const Lt=_.levels;for(let Gt=0;Gt<Lt.length;Gt++){const Xt=Lt[Gt],Qt=vt.getObjectByProperty("uuid",Xt.object);Qt!==void 0&&vt.addLevel(Qt,Xt.distance)}}return vt}bindSkeletons(_,st){Object.keys(st).length!==0&&_.traverse(function(at){if(at.isSkinnedMesh===!0&&at.skeleton!==void 0){const lt=st[at.skeleton];lt===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",at.skeleton):at.bind(lt,at.bindMatrix)}})}}const CP={UVMapping:Vl,CubeReflectionMapping:Vo,CubeRefractionMapping:Oo,EquirectangularReflectionMapping:Lo,EquirectangularRefractionMapping:No,CubeUVReflectionMapping:eu},DE={RepeatWrapping:So,ClampToEdgeWrapping:co,MirroredRepeatWrapping:Il},tR={NearestFilter:ga,NearestMipmapNearestFilter:Go,NearestMipmapLinearFilter:ba,LinearFilter:Ko,LinearMipmapNearestFilter:Lu,LinearMipmapLinearFilter:ys};class VC extends Wu{constructor(_){super(_),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(_){return this.options=_,this}load(_,st,at,lt){_===void 0&&(_=""),this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const ft=this,vt=u0.get(_);if(vt!==void 0)return ft.manager.itemStart(_),setTimeout(function(){st&&st(vt),ft.manager.itemEnd(_)},0),vt;const At={};At.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",At.headers=this.requestHeader,fetch(_,At).then(function(Ct){return Ct.blob()}).then(function(Ct){return createImageBitmap(Ct,Object.assign(ft.options,{colorSpaceConversion:"none"}))}).then(function(Ct){u0.add(_,Ct),st&&st(Ct),ft.manager.itemEnd(_)}).catch(function(Ct){lt&&lt(Ct),ft.manager.itemError(_),ft.manager.itemEnd(_)}),ft.manager.itemStart(_)}}let BE;const U1={getContext:function(){return BE===void 0&&(BE=new(window.AudioContext||window.webkitAudioContext)),BE},setContext:function(wt){BE=wt}};class TP extends Wu{constructor(_){super(_)}load(_,st,at,lt){const ft=this,vt=new d0(this.manager);vt.setResponseType("arraybuffer"),vt.setPath(this.path),vt.setRequestHeader(this.requestHeader),vt.setWithCredentials(this.withCredentials),vt.load(_,function(At){try{const Ct=At.slice(0);U1.getContext().decodeAudioData(Ct,function(Tt){st(Tt)})}catch(Ct){lt?lt(Ct):console.error(Ct),ft.manager.itemError(_)}},at,lt)}}class GC extends PE{constructor(_,st,at=1){super(void 0,at),this.isHemisphereLightProbe=!0;const lt=new ms().set(_),ft=new ms().set(st),vt=new Mr(lt.r,lt.g,lt.b),At=new Mr(ft.r,ft.g,ft.b),Ct=Math.sqrt(Math.PI),Tt=Ct*Math.sqrt(.75);this.sh.coefficients[0].copy(vt).add(At).multiplyScalar(Ct),this.sh.coefficients[1].copy(vt).sub(At).multiplyScalar(Tt)}}class kE extends PE{constructor(_,st=1){super(void 0,st),this.isAmbientLightProbe=!0;const at=new ms().set(_);this.sh.coefficients[0].set(at.r,at.g,at.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const pw=new Ys,OE=new Ys,f0=new Ys;class oA{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new op,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new op,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(_){const st=this._cache;if(st.focus!==_.focus||st.fov!==_.fov||st.aspect!==_.aspect*this.aspect||st.near!==_.near||st.far!==_.far||st.zoom!==_.zoom||st.eyeSep!==this.eyeSep){st.focus=_.focus,st.fov=_.fov,st.aspect=_.aspect*this.aspect,st.near=_.near,st.far=_.far,st.zoom=_.zoom,st.eyeSep=this.eyeSep,f0.copy(_.projectionMatrix);const at=st.eyeSep/2,lt=at*st.near/st.focus,ft=st.near*Math.tan($_*st.fov*.5)/st.zoom;let vt,At;OE.elements[12]=-at,pw.elements[12]=at,vt=-ft*st.aspect+lt,At=ft*st.aspect+lt,f0.elements[0]=2*st.near/(At-vt),f0.elements[8]=(At+vt)/(At-vt),this.cameraL.projectionMatrix.copy(f0),vt=-ft*st.aspect-lt,At=ft*st.aspect-lt,f0.elements[0]=2*st.near/(At-vt),f0.elements[8]=(At+vt)/(At-vt),this.cameraR.projectionMatrix.copy(f0)}this.cameraL.matrixWorld.copy(_.matrixWorld).multiply(OE),this.cameraR.matrixWorld.copy(_.matrixWorld).multiply(pw)}}class LE{constructor(_=!0){this.autoStart=_,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=rR(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let _=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const st=rR();_=(st-this.oldTime)/1e3,this.oldTime=st,this.elapsedTime+=_}return _}}function rR(){return(typeof performance>"u"?Date:performance).now()}const ay=new Mr,m0=new zu,MP=new Mr,Lp=new Mr;class nR extends ao{constructor(){super(),this.type="AudioListener",this.context=U1.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new LE}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(_){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=_,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(_){return this.gain.gain.setTargetAtTime(_,this.context.currentTime,.01),this}updateMatrixWorld(_){super.updateMatrixWorld(_);const st=this.context.listener,at=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(ay,m0,MP),Lp.set(0,0,-1).applyQuaternion(m0),st.positionX){const lt=this.context.currentTime+this.timeDelta;st.positionX.linearRampToValueAtTime(ay.x,lt),st.positionY.linearRampToValueAtTime(ay.y,lt),st.positionZ.linearRampToValueAtTime(ay.z,lt),st.forwardX.linearRampToValueAtTime(Lp.x,lt),st.forwardY.linearRampToValueAtTime(Lp.y,lt),st.forwardZ.linearRampToValueAtTime(Lp.z,lt),st.upX.linearRampToValueAtTime(at.x,lt),st.upY.linearRampToValueAtTime(at.y,lt),st.upZ.linearRampToValueAtTime(at.z,lt)}else st.setPosition(ay.x,ay.y,ay.z),st.setOrientation(Lp.x,Lp.y,Lp.z,at.x,at.y,at.z)}}class g0 extends ao{constructor(_){super(),this.type="Audio",this.listener=_,this.context=_.context,this.gain=this.context.createGain(),this.gain.connect(_.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(_){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=_,this.connect(),this}setMediaElementSource(_){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(_),this.connect(),this}setMediaStreamSource(_){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(_),this.connect(),this}setBuffer(_){return this.buffer=_,this.sourceType="buffer",this.autoplay&&this.play(),this}play(_=0){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+_;const st=this.context.createBufferSource();return st.buffer=this.buffer,st.loop=this.loop,st.loopStart=this.loopStart,st.loopEnd=this.loopEnd,st.onended=this.onEnded.bind(this),st.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=st,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl!==!1)return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(this.hasPlaybackControl!==!1)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let _=1,st=this.filters.length;_<st;_++)this.filters[_-1].connect(this.filters[_]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let _=1,st=this.filters.length;_<st;_++)this.filters[_-1].disconnect(this.filters[_]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(_){return _||(_=[]),this._connected===!0?(this.disconnect(),this.filters=_.slice(),this.connect()):this.filters=_.slice(),this}setDetune(_){if(this.detune=_,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(_){return this.setFilters(_?[_]:[])}setPlaybackRate(_){if(this.hasPlaybackControl!==!1)return this.playbackRate=_,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(_){if(this.hasPlaybackControl!==!1)return this.loop=_,this.isPlaying===!0&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(_){return this.loopStart=_,this}setLoopEnd(_){return this.loopEnd=_,this}getVolume(){return this.gain.gain.value}setVolume(_){return this.gain.gain.setTargetAtTime(_,this.context.currentTime,.01),this}}const ly=new Mr,NE=new zu,$1=new Mr,Uv=new Mr;class iR extends g0{constructor(_){super(_),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(_){return this.panner.refDistance=_,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(_){return this.panner.rolloffFactor=_,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(_){return this.panner.distanceModel=_,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(_){return this.panner.maxDistance=_,this}setDirectionalCone(_,st,at){return this.panner.coneInnerAngle=_,this.panner.coneOuterAngle=st,this.panner.coneOuterGain=at,this}updateMatrixWorld(_){if(super.updateMatrixWorld(_),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(ly,NE,$1),Uv.set(0,0,1).applyQuaternion(NE);const st=this.panner;if(st.positionX){const at=this.context.currentTime+this.listener.timeDelta;st.positionX.linearRampToValueAtTime(ly.x,at),st.positionY.linearRampToValueAtTime(ly.y,at),st.positionZ.linearRampToValueAtTime(ly.z,at),st.orientationX.linearRampToValueAtTime(Uv.x,at),st.orientationY.linearRampToValueAtTime(Uv.y,at),st.orientationZ.linearRampToValueAtTime(Uv.z,at)}else st.setPosition(ly.x,ly.y,ly.z),st.setOrientation(Uv.x,Uv.y,Uv.z)}}class uy{constructor(_,st=2048){this.analyser=_.context.createAnalyser(),this.analyser.fftSize=st,this.data=new Uint8Array(this.analyser.frequencyBinCount),_.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let _=0;const st=this.getFrequencyData();for(let at=0;at<st.length;at++)_+=st[at];return _/st.length}}class j1{constructor(_,st,at){let lt,ft,vt;switch(this.binding=_,this.valueSize=at,st){case"quaternion":lt=this._slerp,ft=this._slerpAdditive,vt=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*at),this._workIndex=5;break;case"string":case"bool":lt=this._select,ft=this._select,vt=this._setAdditiveIdentityOther,this.buffer=new Array(5*at);break;default:lt=this._lerp,ft=this._lerpAdditive,vt=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*at)}this._mixBufferRegion=lt,this._mixBufferRegionAdditive=ft,this._setIdentity=vt,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(_,st){const at=this.buffer,lt=this.valueSize,ft=_*lt+lt;let vt=this.cumulativeWeight;if(vt===0){for(let At=0;At!==lt;++At)at[ft+At]=at[At];vt=st}else{vt+=st;const At=st/vt;this._mixBufferRegion(at,ft,0,At,lt)}this.cumulativeWeight=vt}accumulateAdditive(_){const st=this.buffer,at=this.valueSize,lt=at*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(st,lt,0,_,at),this.cumulativeWeightAdditive+=_}apply(_){const st=this.valueSize,at=this.buffer,lt=_*st+st,ft=this.cumulativeWeight,vt=this.cumulativeWeightAdditive,At=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,ft<1){const Ct=st*this._origIndex;this._mixBufferRegion(at,lt,Ct,1-ft,st)}vt>0&&this._mixBufferRegionAdditive(at,lt,this._addIndex*st,1,st);for(let Ct=st,Tt=st+st;Ct!==Tt;++Ct)if(at[Ct]!==at[Ct+st]){At.setValue(at,lt);break}}saveOriginalState(){const _=this.binding,st=this.buffer,at=this.valueSize,lt=at*this._origIndex;_.getValue(st,lt);for(let ft=at,vt=lt;ft!==vt;++ft)st[ft]=st[lt+ft%at];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const _=3*this.valueSize;this.binding.setValue(this.buffer,_)}_setAdditiveIdentityNumeric(){const _=this._addIndex*this.valueSize,st=_+this.valueSize;for(let at=_;at<st;at++)this.buffer[at]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const _=this._origIndex*this.valueSize,st=this._addIndex*this.valueSize;for(let at=0;at<this.valueSize;at++)this.buffer[st+at]=this.buffer[_+at]}_select(_,st,at,lt,ft){if(lt>=.5)for(let vt=0;vt!==ft;++vt)_[st+vt]=_[at+vt]}_slerp(_,st,at,lt){zu.slerpFlat(_,st,_,st,_,at,lt)}_slerpAdditive(_,st,at,lt,ft){const vt=this._workIndex*ft;zu.multiplyQuaternionsFlat(_,vt,_,st,_,at),zu.slerpFlat(_,st,_,st,_,vt,lt)}_lerp(_,st,at,lt,ft){const vt=1-lt;for(let At=0;At!==ft;++At){const Ct=st+At;_[Ct]=_[Ct]*vt+_[at+At]*lt}}_lerpAdditive(_,st,at,lt,ft){for(let vt=0;vt!==ft;++vt){const At=st+vt;_[At]=_[At]+_[at+vt]*lt}}}const z1=new RegExp("[\\[\\]\\.:\\/]","g"),hw="[^\\[\\]\\.:\\/]",fw="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",FE=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",hw)+/(WCOD+)?/.source.replace("WCOD",fw)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",hw)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",hw)+"$"),V1=["material","materials","bones","map"];class Fo{constructor(_,st,at){this.path=st,this.parsedPath=at||Fo.parseTrackName(st),this.node=Fo.findNode(_,this.parsedPath.nodeName)||_,this.rootNode=_,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(_,st,at){return _&&_.isAnimationObjectGroup?new Fo.Composite(_,st,at):new Fo(_,st,at)}static sanitizeNodeName(_){return _.replace(/\s/g,"_").replace(z1,"")}static parseTrackName(_){const st=FE.exec(_);if(st===null)throw new Error("PropertyBinding: Cannot parse trackName: "+_);const at={nodeName:st[2],objectName:st[3],objectIndex:st[4],propertyName:st[5],propertyIndex:st[6]},lt=at.nodeName&&at.nodeName.lastIndexOf(".");if(lt!==void 0&&lt!==-1){const ft=at.nodeName.substring(lt+1);V1.indexOf(ft)!==-1&&(at.nodeName=at.nodeName.substring(0,lt),at.objectName=ft)}if(at.propertyName===null||at.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+_);return at}static findNode(_,st){if(st===void 0||st===""||st==="."||st===-1||st===_.name||st===_.uuid)return _;if(_.skeleton){const at=_.skeleton.getBoneByName(st);if(at!==void 0)return at}if(_.children){const at=function(ft){for(let vt=0;vt<ft.length;vt++){const At=ft[vt];if(At.name===st||At.uuid===st)return At;const Ct=at(At.children);if(Ct)return Ct}return null},lt=at(_.children);if(lt)return lt}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(_,st){_[st]=this.targetObject[this.propertyName]}_getValue_array(_,st){const at=this.resolvedProperty;for(let lt=0,ft=at.length;lt!==ft;++lt)_[st++]=at[lt]}_getValue_arrayElement(_,st){_[st]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(_,st){this.resolvedProperty.toArray(_,st)}_setValue_direct(_,st){this.targetObject[this.propertyName]=_[st]}_setValue_direct_setNeedsUpdate(_,st){this.targetObject[this.propertyName]=_[st],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(_,st){this.targetObject[this.propertyName]=_[st],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(_,st){const at=this.resolvedProperty;for(let lt=0,ft=at.length;lt!==ft;++lt)at[lt]=_[st++]}_setValue_array_setNeedsUpdate(_,st){const at=this.resolvedProperty;for(let lt=0,ft=at.length;lt!==ft;++lt)at[lt]=_[st++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(_,st){const at=this.resolvedProperty;for(let lt=0,ft=at.length;lt!==ft;++lt)at[lt]=_[st++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(_,st){this.resolvedProperty[this.propertyIndex]=_[st]}_setValue_arrayElement_setNeedsUpdate(_,st){this.resolvedProperty[this.propertyIndex]=_[st],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(_,st){this.resolvedProperty[this.propertyIndex]=_[st],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(_,st){this.resolvedProperty.fromArray(_,st)}_setValue_fromArray_setNeedsUpdate(_,st){this.resolvedProperty.fromArray(_,st),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(_,st){this.resolvedProperty.fromArray(_,st),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(_,st){this.bind(),this.getValue(_,st)}_setValue_unbound(_,st){this.bind(),this.setValue(_,st)}bind(){let _=this.node;const st=this.parsedPath,at=st.objectName,lt=st.propertyName;let ft=st.propertyIndex;if(_||(_=Fo.findNode(this.rootNode,st.nodeName)||this.rootNode,this.node=_),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!_)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(at){let Tt=st.objectIndex;switch(at){case"materials":if(!_.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!_.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);_=_.material.materials;break;case"bones":if(!_.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);_=_.skeleton.bones;for(let Ot=0;Ot<_.length;Ot++)if(_[Ot].name===Tt){Tt=Ot;break}break;case"map":if(!_.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!_.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);_=_.material.map;break;default:if(_[at]===void 0)return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);_=_[at]}if(Tt!==void 0){if(_[Tt]===void 0)return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,_);_=_[Tt]}}const vt=_[lt];if(vt===void 0){const Tt=st.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+Tt+"."+lt+" but it wasn't found.",_)}let At=this.Versioning.None;this.targetObject=_,_.needsUpdate!==void 0?At=this.Versioning.NeedsUpdate:_.matrixWorldNeedsUpdate!==void 0&&(At=this.Versioning.MatrixWorldNeedsUpdate);let Ct=this.BindingType.Direct;if(ft!==void 0){if(lt==="morphTargetInfluences"){if(!_.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!_.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);_.morphTargetDictionary[ft]!==void 0&&(ft=_.morphTargetDictionary[ft])}Ct=this.BindingType.ArrayElement,this.resolvedProperty=vt,this.propertyIndex=ft}else vt.fromArray!==void 0&&vt.toArray!==void 0?(Ct=this.BindingType.HasFromToArray,this.resolvedProperty=vt):Array.isArray(vt)?(Ct=this.BindingType.EntireArray,this.resolvedProperty=vt):this.propertyName=lt;this.getValue=this.GetterByBindingType[Ct],this.setValue=this.SetterByBindingTypeAndVersioning[Ct][At]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Fo.Composite=class{constructor(wt,_,st){const at=st||Fo.parseTrackName(_);this._targetGroup=wt,this._bindings=wt.subscribe_(_,at)}getValue(wt,_){this.bind();const st=this._targetGroup.nCachedObjects_,at=this._bindings[st];at!==void 0&&at.getValue(wt,_)}setValue(wt,_){const st=this._bindings;for(let at=this._targetGroup.nCachedObjects_,lt=st.length;at!==lt;++at)st[at].setValue(wt,_)}bind(){const wt=this._bindings;for(let _=this._targetGroup.nCachedObjects_,st=wt.length;_!==st;++_)wt[_].bind()}unbind(){const wt=this._bindings;for(let _=this._targetGroup.nCachedObjects_,st=wt.length;_!==st;++_)wt[_].unbind()}},Fo.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Fo.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Fo.prototype.GetterByBindingType=[Fo.prototype._getValue_direct,Fo.prototype._getValue_array,Fo.prototype._getValue_arrayElement,Fo.prototype._getValue_toArray],Fo.prototype.SetterByBindingTypeAndVersioning=[[Fo.prototype._setValue_direct,Fo.prototype._setValue_direct_setNeedsUpdate,Fo.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Fo.prototype._setValue_array,Fo.prototype._setValue_array_setNeedsUpdate,Fo.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Fo.prototype._setValue_arrayElement,Fo.prototype._setValue_arrayElement_setNeedsUpdate,Fo.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Fo.prototype._setValue_fromArray,Fo.prototype._setValue_fromArray_setNeedsUpdate,Fo.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class aA{constructor(){this.isAnimationObjectGroup=!0,this.uuid=rp(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const _={};this._indicesByUUID=_;for(let at=0,lt=arguments.length;at!==lt;++at)_[arguments[at].uuid]=at;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const st=this;this.stats={objects:{get total(){return st._objects.length},get inUse(){return this.total-st.nCachedObjects_}},get bindingsPerObject(){return st._bindings.length}}}add(){const _=this._objects,st=this._indicesByUUID,at=this._paths,lt=this._parsedPaths,ft=this._bindings,vt=ft.length;let At,Ct=_.length,Tt=this.nCachedObjects_;for(let Ot=0,Ut=arguments.length;Ot!==Ut;++Ot){const Lt=arguments[Ot],Gt=Lt.uuid;let Xt=st[Gt];if(Xt===void 0){Xt=Ct++,st[Gt]=Xt,_.push(Lt);for(let Qt=0,lr=vt;Qt!==lr;++Qt)ft[Qt].push(new Fo(Lt,at[Qt],lt[Qt]))}else if(Xt<Tt){At=_[Xt];const Qt=--Tt,lr=_[Qt];st[lr.uuid]=Xt,_[Xt]=lr,st[Gt]=Qt,_[Qt]=Lt;for(let ur=0,cr=vt;ur!==cr;++ur){const gr=ft[ur],wr=gr[Qt];let Er=gr[Xt];gr[Xt]=wr,Er===void 0&&(Er=new Fo(Lt,at[ur],lt[ur])),gr[Qt]=Er}}else _[Xt]!==At&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=Tt}remove(){const _=this._objects,st=this._indicesByUUID,at=this._bindings,lt=at.length;let ft=this.nCachedObjects_;for(let vt=0,At=arguments.length;vt!==At;++vt){const Ct=arguments[vt],Tt=Ct.uuid,Ot=st[Tt];if(Ot!==void 0&&Ot>=ft){const Ut=ft++,Lt=_[Ut];st[Lt.uuid]=Ot,_[Ot]=Lt,st[Tt]=Ut,_[Ut]=Ct;for(let Gt=0,Xt=lt;Gt!==Xt;++Gt){const Qt=at[Gt],lr=Qt[Ut],ur=Qt[Ot];Qt[Ot]=lr,Qt[Ut]=ur}}}this.nCachedObjects_=ft}uncache(){const _=this._objects,st=this._indicesByUUID,at=this._bindings,lt=at.length;let ft=this.nCachedObjects_,vt=_.length;for(let At=0,Ct=arguments.length;At!==Ct;++At){const Tt=arguments[At].uuid,Ot=st[Tt];if(Ot!==void 0)if(delete st[Tt],Ot<ft){const Ut=--ft,Lt=_[Ut],Gt=--vt,Xt=_[Gt];st[Lt.uuid]=Ot,_[Ot]=Lt,st[Xt.uuid]=Ut,_[Ut]=Xt,_.pop();for(let Qt=0,lr=lt;Qt!==lr;++Qt){const ur=at[Qt],cr=ur[Ut],gr=ur[Gt];ur[Ot]=cr,ur[Ut]=gr,ur.pop()}}else{const Ut=--vt,Lt=_[Ut];Ut>0&&(st[Lt.uuid]=Ot),_[Ot]=Lt,_.pop();for(let Gt=0,Xt=lt;Gt!==Xt;++Gt){const Qt=at[Gt];Qt[Ot]=Qt[Ut],Qt.pop()}}}this.nCachedObjects_=ft}subscribe_(_,st){const at=this._bindingsIndicesByPath;let lt=at[_];const ft=this._bindings;if(lt!==void 0)return ft[lt];const vt=this._paths,At=this._parsedPaths,Ct=this._objects,Tt=Ct.length,Ot=this.nCachedObjects_,Ut=new Array(Tt);lt=ft.length,at[_]=lt,vt.push(_),At.push(st),ft.push(Ut);for(let Lt=Ot,Gt=Ct.length;Lt!==Gt;++Lt){const Xt=Ct[Lt];Ut[Lt]=new Fo(Xt,_,st)}return Ut}unsubscribe_(_){const st=this._bindingsIndicesByPath,at=st[_];if(at!==void 0){const lt=this._paths,ft=this._parsedPaths,vt=this._bindings,At=vt.length-1,Ct=vt[At];st[_[At]]=at,vt[at]=Ct,vt.pop(),ft[at]=ft[At],ft.pop(),lt[at]=lt[At],lt.pop()}}}class UE{constructor(_,st,at=null,lt=st.blendMode){this._mixer=_,this._clip=st,this._localRoot=at,this.blendMode=lt;const ft=st.tracks,vt=ft.length,At=new Array(vt),Ct={endingStart:Su,endingEnd:Su};for(let Tt=0;Tt!==vt;++Tt){const Ot=ft[Tt].createInterpolant(null);At[Tt]=Ot,Ot.settings=Ct}this._interpolantSettings=Ct,this._interpolants=At,this._propertyBindings=new Array(vt),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=SA,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(_){return this._startTime=_,this}setLoop(_,st){return this.loop=_,this.repetitions=st,this}setEffectiveWeight(_){return this.weight=_,this._effectiveWeight=this.enabled?_:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(_){return this._scheduleFading(_,0,1)}fadeOut(_){return this._scheduleFading(_,1,0)}crossFadeFrom(_,st,at){if(_.fadeOut(st),this.fadeIn(st),at){const lt=this._clip.duration,ft=_._clip.duration,vt=ft/lt,At=lt/ft;_.warp(1,vt,st),this.warp(At,1,st)}return this}crossFadeTo(_,st,at){return _.crossFadeFrom(this,st,at)}stopFading(){const _=this._weightInterpolant;return _!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(_)),this}setEffectiveTimeScale(_){return this.timeScale=_,this._effectiveTimeScale=this.paused?0:_,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(_){return this.timeScale=this._clip.duration/_,this.stopWarping()}syncWith(_){return this.time=_.time,this.timeScale=_.timeScale,this.stopWarping()}halt(_){return this.warp(this._effectiveTimeScale,0,_)}warp(_,st,at){const lt=this._mixer,ft=lt.time,vt=this.timeScale;let At=this._timeScaleInterpolant;At===null&&(At=lt._lendControlInterpolant(),this._timeScaleInterpolant=At);const Ct=At.parameterPositions,Tt=At.sampleValues;return Ct[0]=ft,Ct[1]=ft+at,Tt[0]=_/vt,Tt[1]=st/vt,this}stopWarping(){const _=this._timeScaleInterpolant;return _!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(_)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(_,st,at,lt){if(!this.enabled)return void this._updateWeight(_);const ft=this._startTime;if(ft!==null){const Ct=(_-ft)*at;Ct<0||at===0?st=0:(this._startTime=null,st=at*Ct)}st*=this._updateTimeScale(_);const vt=this._updateTime(st),At=this._updateWeight(_);if(At>0){const Ct=this._interpolants,Tt=this._propertyBindings;if(this.blendMode===CA)for(let Ot=0,Ut=Ct.length;Ot!==Ut;++Ot)Ct[Ot].evaluate(vt),Tt[Ot].accumulateAdditive(At);else for(let Ot=0,Ut=Ct.length;Ot!==Ut;++Ot)Ct[Ot].evaluate(vt),Tt[Ot].accumulate(lt,At)}}_updateWeight(_){let st=0;if(this.enabled){st=this.weight;const at=this._weightInterpolant;if(at!==null){const lt=at.evaluate(_)[0];st*=lt,_>at.parameterPositions[1]&&(this.stopFading(),lt===0&&(this.enabled=!1))}}return this._effectiveWeight=st,st}_updateTimeScale(_){let st=0;if(!this.paused){st=this.timeScale;const at=this._timeScaleInterpolant;at!==null&&(st*=at.evaluate(_)[0],_>at.parameterPositions[1]&&(this.stopWarping(),st===0?this.paused=!0:this.timeScale=st))}return this._effectiveTimeScale=st,st}_updateTime(_){const st=this._clip.duration,at=this.loop;let lt=this.time+_,ft=this._loopCount;const vt=at===P_;if(_===0)return ft===-1?lt:vt&&(1&ft)==1?st-lt:lt;if(at===Rp){ft===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(lt>=st)lt=st;else{if(!(lt<0)){this.time=lt;break e}lt=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=lt,this._mixer.dispatchEvent({type:"finished",action:this,direction:_<0?-1:1})}}else{if(ft===-1&&(_>=0?(ft=0,this._setEndings(!0,this.repetitions===0,vt)):this._setEndings(this.repetitions===0,!0,vt)),lt>=st||lt<0){const At=Math.floor(lt/st);lt-=st*At,ft+=Math.abs(At);const Ct=this.repetitions-ft;if(Ct<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,lt=_>0?st:0,this.time=lt,this._mixer.dispatchEvent({type:"finished",action:this,direction:_>0?1:-1});else{if(Ct===1){const Tt=_<0;this._setEndings(Tt,!Tt,vt)}else this._setEndings(!1,!1,vt);this._loopCount=ft,this.time=lt,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:At})}}else this.time=lt;if(vt&&(1&ft)==1)return st-lt}return lt}_setEndings(_,st,at){const lt=this._interpolantSettings;at?(lt.endingStart=_f,lt.endingEnd=_f):(lt.endingStart=_?this.zeroSlopeAtStart?_f:Su:B_,lt.endingEnd=st?this.zeroSlopeAtEnd?_f:Su:B_)}_scheduleFading(_,st,at){const lt=this._mixer,ft=lt.time;let vt=this._weightInterpolant;vt===null&&(vt=lt._lendControlInterpolant(),this._weightInterpolant=vt);const At=vt.parameterPositions,Ct=vt.sampleValues;return At[0]=ft,Ct[0]=st,At[1]=ft+_,Ct[1]=at,this}}const $E=new Float32Array(1);class QC extends Ws{constructor(_){super(),this._root=_,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(_,st){const at=_._localRoot||this._root,lt=_._clip.tracks,ft=lt.length,vt=_._propertyBindings,At=_._interpolants,Ct=at.uuid,Tt=this._bindingsByRootAndName;let Ot=Tt[Ct];Ot===void 0&&(Ot={},Tt[Ct]=Ot);for(let Ut=0;Ut!==ft;++Ut){const Lt=lt[Ut],Gt=Lt.name;let Xt=Ot[Gt];if(Xt!==void 0)++Xt.referenceCount,vt[Ut]=Xt;else{if(Xt=vt[Ut],Xt!==void 0){Xt._cacheIndex===null&&(++Xt.referenceCount,this._addInactiveBinding(Xt,Ct,Gt));continue}const Qt=st&&st._propertyBindings[Ut].binding.parsedPath;Xt=new j1(Fo.create(at,Gt,Qt),Lt.ValueTypeName,Lt.getValueSize()),++Xt.referenceCount,this._addInactiveBinding(Xt,Ct,Gt),vt[Ut]=Xt}At[Ut].resultBuffer=Xt.buffer}}_activateAction(_){if(!this._isActiveAction(_)){if(_._cacheIndex===null){const at=(_._localRoot||this._root).uuid,lt=_._clip.uuid,ft=this._actionsByClip[lt];this._bindAction(_,ft&&ft.knownActions[0]),this._addInactiveAction(_,lt,at)}const st=_._propertyBindings;for(let at=0,lt=st.length;at!==lt;++at){const ft=st[at];ft.useCount++==0&&(this._lendBinding(ft),ft.saveOriginalState())}this._lendAction(_)}}_deactivateAction(_){if(this._isActiveAction(_)){const st=_._propertyBindings;for(let at=0,lt=st.length;at!==lt;++at){const ft=st[at];--ft.useCount==0&&(ft.restoreOriginalState(),this._takeBackBinding(ft))}this._takeBackAction(_)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const _=this;this.stats={actions:{get total(){return _._actions.length},get inUse(){return _._nActiveActions}},bindings:{get total(){return _._bindings.length},get inUse(){return _._nActiveBindings}},controlInterpolants:{get total(){return _._controlInterpolants.length},get inUse(){return _._nActiveControlInterpolants}}}}_isActiveAction(_){const st=_._cacheIndex;return st!==null&&st<this._nActiveActions}_addInactiveAction(_,st,at){const lt=this._actions,ft=this._actionsByClip;let vt=ft[st];if(vt===void 0)vt={knownActions:[_],actionByRoot:{}},_._byClipCacheIndex=0,ft[st]=vt;else{const At=vt.knownActions;_._byClipCacheIndex=At.length,At.push(_)}_._cacheIndex=lt.length,lt.push(_),vt.actionByRoot[at]=_}_removeInactiveAction(_){const st=this._actions,at=st[st.length-1],lt=_._cacheIndex;at._cacheIndex=lt,st[lt]=at,st.pop(),_._cacheIndex=null;const ft=_._clip.uuid,vt=this._actionsByClip,At=vt[ft],Ct=At.knownActions,Tt=Ct[Ct.length-1],Ot=_._byClipCacheIndex;Tt._byClipCacheIndex=Ot,Ct[Ot]=Tt,Ct.pop(),_._byClipCacheIndex=null,delete At.actionByRoot[(_._localRoot||this._root).uuid],Ct.length===0&&delete vt[ft],this._removeInactiveBindingsForAction(_)}_removeInactiveBindingsForAction(_){const st=_._propertyBindings;for(let at=0,lt=st.length;at!==lt;++at){const ft=st[at];--ft.referenceCount==0&&this._removeInactiveBinding(ft)}}_lendAction(_){const st=this._actions,at=_._cacheIndex,lt=this._nActiveActions++,ft=st[lt];_._cacheIndex=lt,st[lt]=_,ft._cacheIndex=at,st[at]=ft}_takeBackAction(_){const st=this._actions,at=_._cacheIndex,lt=--this._nActiveActions,ft=st[lt];_._cacheIndex=lt,st[lt]=_,ft._cacheIndex=at,st[at]=ft}_addInactiveBinding(_,st,at){const lt=this._bindingsByRootAndName,ft=this._bindings;let vt=lt[st];vt===void 0&&(vt={},lt[st]=vt),vt[at]=_,_._cacheIndex=ft.length,ft.push(_)}_removeInactiveBinding(_){const st=this._bindings,at=_.binding,lt=at.rootNode.uuid,ft=at.path,vt=this._bindingsByRootAndName,At=vt[lt],Ct=st[st.length-1],Tt=_._cacheIndex;Ct._cacheIndex=Tt,st[Tt]=Ct,st.pop(),delete At[ft],Object.keys(At).length===0&&delete vt[lt]}_lendBinding(_){const st=this._bindings,at=_._cacheIndex,lt=this._nActiveBindings++,ft=st[lt];_._cacheIndex=lt,st[lt]=_,ft._cacheIndex=at,st[at]=ft}_takeBackBinding(_){const st=this._bindings,at=_._cacheIndex,lt=--this._nActiveBindings,ft=st[lt];_._cacheIndex=lt,st[lt]=_,ft._cacheIndex=at,st[at]=ft}_lendControlInterpolant(){const _=this._controlInterpolants,st=this._nActiveControlInterpolants++;let at=_[st];return at===void 0&&(at=new OC(new Float32Array(2),new Float32Array(2),1,$E),at.__cacheIndex=st,_[st]=at),at}_takeBackControlInterpolant(_){const st=this._controlInterpolants,at=_.__cacheIndex,lt=--this._nActiveControlInterpolants,ft=st[lt];_.__cacheIndex=lt,st[lt]=_,ft.__cacheIndex=at,st[at]=ft}clipAction(_,st,at){const lt=st||this._root,ft=lt.uuid;let vt=typeof _=="string"?B1.findByName(lt,_):_;const At=vt!==null?vt.uuid:_,Ct=this._actionsByClip[At];let Tt=null;if(at===void 0&&(at=vt!==null?vt.blendMode:Ll),Ct!==void 0){const Ut=Ct.actionByRoot[ft];if(Ut!==void 0&&Ut.blendMode===at)return Ut;Tt=Ct.knownActions[0],vt===null&&(vt=Tt._clip)}if(vt===null)return null;const Ot=new UE(this,vt,st,at);return this._bindAction(Ot,Tt),this._addInactiveAction(Ot,At,ft),Ot}existingAction(_,st){const at=st||this._root,lt=at.uuid,ft=typeof _=="string"?B1.findByName(at,_):_,vt=ft?ft.uuid:_,At=this._actionsByClip[vt];return At!==void 0&&At.actionByRoot[lt]||null}stopAllAction(){const _=this._actions;for(let st=this._nActiveActions-1;st>=0;--st)_[st].stop();return this}update(_){_*=this.timeScale;const st=this._actions,at=this._nActiveActions,lt=this.time+=_,ft=Math.sign(_),vt=this._accuIndex^=1;for(let Tt=0;Tt!==at;++Tt)st[Tt]._update(lt,_,ft,vt);const At=this._bindings,Ct=this._nActiveBindings;for(let Tt=0;Tt!==Ct;++Tt)At[Tt].apply(vt);return this}setTime(_){this.time=0;for(let st=0;st<this._actions.length;st++)this._actions[st].time=0;return this.update(_)}getRoot(){return this._root}uncacheClip(_){const st=this._actions,at=_.uuid,lt=this._actionsByClip,ft=lt[at];if(ft!==void 0){const vt=ft.knownActions;for(let At=0,Ct=vt.length;At!==Ct;++At){const Tt=vt[At];this._deactivateAction(Tt);const Ot=Tt._cacheIndex,Ut=st[st.length-1];Tt._cacheIndex=null,Tt._byClipCacheIndex=null,Ut._cacheIndex=Ot,st[Ot]=Ut,st.pop(),this._removeInactiveBindingsForAction(Tt)}delete lt[at]}}uncacheRoot(_){const st=_.uuid,at=this._actionsByClip;for(const ft in at){const vt=at[ft].actionByRoot[st];vt!==void 0&&(this._deactivateAction(vt),this._removeInactiveAction(vt))}const lt=this._bindingsByRootAndName[st];if(lt!==void 0)for(const ft in lt){const vt=lt[ft];vt.restoreOriginalState(),this._removeInactiveBinding(vt)}}uncacheAction(_,st){const at=this.existingAction(_,st);at!==null&&(this._deactivateAction(at),this._removeInactiveAction(at))}}class cy{constructor(_){this.value=_}clone(){return new cy(this.value.clone===void 0?this.value:this.value.clone())}}let jE=0;class G1 extends Ws{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:jE++}),this.name="",this.usage=F_,this.uniforms=[]}add(_){return this.uniforms.push(_),this}remove(_){const st=this.uniforms.indexOf(_);return st!==-1&&this.uniforms.splice(st,1),this}setName(_){return this.name=_,this}setUsage(_){return this.usage=_,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(_){this.name=_.name,this.usage=_.usage;const st=_.uniforms;this.uniforms.length=0;for(let at=0,lt=st.length;at<lt;at++)this.uniforms.push(st[at].clone());return this}clone(){return new this.constructor().copy(this)}}class zE extends rE{constructor(_,st,at=1){super(_,st),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=at}copy(_){return super.copy(_),this.meshPerAttribute=_.meshPerAttribute,this}clone(_){const st=super.clone(_);return st.meshPerAttribute=this.meshPerAttribute,st}toJSON(_){const st=super.toJSON(_);return st.isInstancedInterleavedBuffer=!0,st.meshPerAttribute=this.meshPerAttribute,st}}class mw{constructor(_,st,at,lt,ft){this.isGLBufferAttribute=!0,this.buffer=_,this.type=st,this.itemSize=at,this.elementSize=lt,this.count=ft,this.version=0}set needsUpdate(_){_===!0&&this.version++}setBuffer(_){return this.buffer=_,this}setType(_,st){return this.type=_,this.elementSize=st,this}setItemSize(_){return this.itemSize=_,this}setCount(_){return this.count=_,this}}class VE{constructor(_,st,at=0,lt=1/0){this.ray=new s_(_,st),this.near=at,this.far=lt,this.camera=null,this.layers=new mp,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(_,st){this.ray.set(_,st)}setFromCamera(_,st){st.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(st.matrixWorld),this.ray.direction.set(_.x,_.y,.5).unproject(st).sub(this.ray.origin).normalize(),this.camera=st):st.isOrthographicCamera?(this.ray.origin.set(_.x,_.y,(st.near+st.far)/(st.near-st.far)).unproject(st),this.ray.direction.set(0,0,-1).transformDirection(st.matrixWorld),this.camera=st):console.error("THREE.Raycaster: Unsupported camera type: "+st.type)}intersectObject(_,st=!0,at=[]){return QE(_,this,at,st),at.sort(GE),at}intersectObjects(_,st=!0,at=[]){for(let lt=0,ft=_.length;lt<ft;lt++)QE(_[lt],this,at,st);return at.sort(GE),at}}function GE(wt,_){return wt.distance-_.distance}function QE(wt,_,st,at){if(wt.layers.test(_.layers)&&wt.raycast(_,st),at===!0){const lt=wt.children;for(let ft=0,vt=lt.length;ft<vt;ft++)QE(lt[ft],_,st,!0)}}class RP{constructor(_=1,st=0,at=0){return this.radius=_,this.phi=st,this.theta=at,this}set(_,st,at){return this.radius=_,this.phi=st,this.theta=at,this}copy(_){return this.radius=_.radius,this.phi=_.phi,this.theta=_.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(_){return this.setFromCartesianCoords(_.x,_.y,_.z)}setFromCartesianCoords(_,st,at){return this.radius=Math.sqrt(_*_+st*st+at*at),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(_,at),this.phi=Math.acos(Ls(st/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class sR{constructor(_=1,st=0,at=0){return this.radius=_,this.theta=st,this.y=at,this}set(_,st,at){return this.radius=_,this.theta=st,this.y=at,this}copy(_){return this.radius=_.radius,this.theta=_.theta,this.y=_.y,this}setFromVector3(_){return this.setFromCartesianCoords(_.x,_.y,_.z)}setFromCartesianCoords(_,st,at){return this.radius=Math.sqrt(_*_+at*at),this.theta=Math.atan2(_,at),this.y=st,this}clone(){return new this.constructor().copy(this)}}const oR=new Vn;class IP{constructor(_=new Vn(1/0,1/0),st=new Vn(-1/0,-1/0)){this.isBox2=!0,this.min=_,this.max=st}set(_,st){return this.min.copy(_),this.max.copy(st),this}setFromPoints(_){this.makeEmpty();for(let st=0,at=_.length;st<at;st++)this.expandByPoint(_[st]);return this}setFromCenterAndSize(_,st){const at=oR.copy(st).multiplyScalar(.5);return this.min.copy(_).sub(at),this.max.copy(_).add(at),this}clone(){return new this.constructor().copy(this)}copy(_){return this.min.copy(_.min),this.max.copy(_.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(_){return this.isEmpty()?_.set(0,0):_.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_){return this.isEmpty()?_.set(0,0):_.subVectors(this.max,this.min)}expandByPoint(_){return this.min.min(_),this.max.max(_),this}expandByVector(_){return this.min.sub(_),this.max.add(_),this}expandByScalar(_){return this.min.addScalar(-_),this.max.addScalar(_),this}containsPoint(_){return!(_.x<this.min.x||_.x>this.max.x||_.y<this.min.y||_.y>this.max.y)}containsBox(_){return this.min.x<=_.min.x&&_.max.x<=this.max.x&&this.min.y<=_.min.y&&_.max.y<=this.max.y}getParameter(_,st){return st.set((_.x-this.min.x)/(this.max.x-this.min.x),(_.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(_){return!(_.max.x<this.min.x||_.min.x>this.max.x||_.max.y<this.min.y||_.min.y>this.max.y)}clampPoint(_,st){return st.copy(_).clamp(this.min,this.max)}distanceToPoint(_){return oR.copy(_).clamp(this.min,this.max).sub(_).length()}intersect(_){return this.min.max(_.min),this.max.min(_.max),this}union(_){return this.min.min(_.min),this.max.max(_.max),this}translate(_){return this.min.add(_),this.max.add(_),this}equals(_){return _.min.equals(this.min)&&_.max.equals(this.max)}}const HC=new Mr,gw=new Mr;class aR{constructor(_=new Mr,st=new Mr){this.start=_,this.end=st}set(_,st){return this.start.copy(_),this.end.copy(st),this}copy(_){return this.start.copy(_.start),this.end.copy(_.end),this}getCenter(_){return _.addVectors(this.start,this.end).multiplyScalar(.5)}delta(_){return _.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(_,st){return this.delta(st).multiplyScalar(_).add(this.start)}closestPointToPointParameter(_,st){HC.subVectors(_,this.start),gw.subVectors(this.end,this.start);const at=gw.dot(gw);let lt=gw.dot(HC)/at;return st&&(lt=Ls(lt,0,1)),lt}closestPointToPoint(_,st,at){const lt=this.closestPointToPointParameter(_,st);return this.delta(at).multiplyScalar(lt).add(this.start)}applyMatrix4(_){return this.start.applyMatrix4(_),this.end.applyMatrix4(_),this}equals(_){return _.start.equals(this.start)&&_.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const ko=new Mr;class up extends ao{constructor(_,st){super(),this.light=_,this.light.updateMatrixWorld(),this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.color=st;const at=new xs,lt=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let vt=0,At=1,Ct=32;vt<Ct;vt++,At++){const Tt=vt/Ct*Math.PI*2,Ot=At/Ct*Math.PI*2;lt.push(Math.cos(Tt),Math.sin(Tt),1,Math.cos(Ot),Math.sin(Ot),1)}at.setAttribute("position",new xt(lt,3));const ft=new Qp({fog:!1,toneMapped:!1});this.cone=new f_(at,ft),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const _=this.light.distance?this.light.distance:1e3,st=_*Math.tan(this.light.angle);this.cone.scale.set(st,st,_),ko.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ko),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Np=new Mr,v0=new Ys,dy=new Ys;class Q1 extends f_{constructor(_){const st=qC(_),at=new xs,lt=[],ft=[],vt=new ms(0,0,1),At=new ms(0,1,0);for(let Ct=0;Ct<st.length;Ct++){const Tt=st[Ct];Tt.parent&&Tt.parent.isBone&&(lt.push(0,0,0),lt.push(0,0,0),ft.push(vt.r,vt.g,vt.b),ft.push(At.r,At.g,At.b))}at.setAttribute("position",new xt(lt,3)),at.setAttribute("color",new xt(ft,3)),super(at,new Qp({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=_,this.bones=st,this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(_){const st=this.bones,at=this.geometry,lt=at.getAttribute("position");dy.copy(this.root.matrixWorld).invert();for(let ft=0,vt=0;ft<st.length;ft++){const At=st[ft];At.parent&&At.parent.isBone&&(v0.multiplyMatrices(dy,At.matrixWorld),Np.setFromMatrixPosition(v0),lt.setXYZ(vt,Np.x,Np.y,Np.z),v0.multiplyMatrices(dy,At.parent.matrixWorld),Np.setFromMatrixPosition(v0),lt.setXYZ(vt+1,Np.x,Np.y,Np.z),vt+=2)}at.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(_)}}function qC(wt){const _=[];wt.isBone===!0&&_.push(wt);for(let st=0;st<wt.children.length;st++)_.push.apply(_,qC(wt.children[st]));return _}class lR extends Hu{constructor(_,st,at){super(new uw(st,4,2),new Jm({wireframe:!0,fog:!1,toneMapped:!1})),this.light=_,this.light.updateMatrixWorld(),this.color=at,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const WC=new Mr,H1=new ms,YC=new ms;class uR extends ao{constructor(_,st,at){super(),this.light=_,this.light.updateMatrixWorld(),this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.color=at;const lt=new yp(st);lt.rotateY(.5*Math.PI),this.material=new Jm({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const ft=lt.getAttribute("position"),vt=new Float32Array(3*ft.count);lt.setAttribute("color",new El(vt,3)),this.add(new Hu(lt,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const _=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const st=_.geometry.getAttribute("color");H1.copy(this.light.color),YC.copy(this.light.groundColor);for(let at=0,lt=st.count;at<lt;at++){const ft=at<lt/2?H1:YC;st.setXYZ(at,ft.r,ft.g,ft.b)}st.needsUpdate=!0}_.lookAt(WC.setFromMatrixPosition(this.light.matrixWorld).negate())}}class KC extends f_{constructor(_=10,st=10,at=4473924,lt=8947848){at=new ms(at),lt=new ms(lt);const ft=st/2,vt=_/st,At=_/2,Ct=[],Tt=[];for(let Ut=0,Lt=0,Gt=-At;Ut<=st;Ut++,Gt+=vt){Ct.push(-At,0,Gt,At,0,Gt),Ct.push(Gt,0,-At,Gt,0,At);const Xt=Ut===ft?at:lt;Xt.toArray(Tt,Lt),Lt+=3,Xt.toArray(Tt,Lt),Lt+=3,Xt.toArray(Tt,Lt),Lt+=3,Xt.toArray(Tt,Lt),Lt+=3}const Ot=new xs;Ot.setAttribute("position",new xt(Ct,3)),Ot.setAttribute("color",new xt(Tt,3)),super(Ot,new Qp({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class q1 extends f_{constructor(_=10,st=16,at=8,lt=64,ft=4473924,vt=8947848){ft=new ms(ft),vt=new ms(vt);const At=[],Ct=[];if(st>1)for(let Ot=0;Ot<st;Ot++){const Ut=Ot/st*(2*Math.PI),Lt=Math.sin(Ut)*_,Gt=Math.cos(Ut)*_;At.push(0,0,0),At.push(Lt,0,Gt);const Xt=1&Ot?ft:vt;Ct.push(Xt.r,Xt.g,Xt.b),Ct.push(Xt.r,Xt.g,Xt.b)}for(let Ot=0;Ot<at;Ot++){const Ut=1&Ot?ft:vt,Lt=_-_/at*Ot;for(let Gt=0;Gt<lt;Gt++){let Xt=Gt/lt*(2*Math.PI),Qt=Math.sin(Xt)*Lt,lr=Math.cos(Xt)*Lt;At.push(Qt,0,lr),Ct.push(Ut.r,Ut.g,Ut.b),Xt=(Gt+1)/lt*(2*Math.PI),Qt=Math.sin(Xt)*Lt,lr=Math.cos(Xt)*Lt,At.push(Qt,0,lr),Ct.push(Ut.r,Ut.g,Ut.b)}}const Tt=new xs;Tt.setAttribute("position",new xt(At,3)),Tt.setAttribute("color",new xt(Ct,3)),super(Tt,new Qp({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const Zl=new Mr,__=new Mr,Lm=new Mr;class _0 extends ao{constructor(_,st,at){super(),this.light=_,this.light.updateMatrixWorld(),this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.color=at,st===void 0&&(st=1);let lt=new xs;lt.setAttribute("position",new xt([-st,st,0,st,st,0,st,-st,0,-st,-st,0,-st,st,0],3));const ft=new Qp({fog:!1,toneMapped:!1});this.lightPlane=new h_(lt,ft),this.add(this.lightPlane),lt=new xs,lt.setAttribute("position",new xt([0,0,0,0,0,1],3)),this.targetLine=new h_(lt,ft),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){Zl.setFromMatrixPosition(this.light.matrixWorld),__.setFromMatrixPosition(this.light.target.matrixWorld),Lm.subVectors(__,Zl),this.lightPlane.lookAt(__),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(__),this.targetLine.scale.z=Lm.length()}}const y0=new Mr,vu=new HA;class cR extends f_{constructor(_){const st=new xs,at=new Qp({color:16777215,vertexColors:!0,toneMapped:!1}),lt=[],ft=[],vt={};function At(Xt,Qt){Ct(Xt),Ct(Qt)}function Ct(Xt){lt.push(0,0,0),ft.push(0,0,0),vt[Xt]===void 0&&(vt[Xt]=[]),vt[Xt].push(lt.length/3-1)}At("n1","n2"),At("n2","n4"),At("n4","n3"),At("n3","n1"),At("f1","f2"),At("f2","f4"),At("f4","f3"),At("f3","f1"),At("n1","f1"),At("n2","f2"),At("n3","f3"),At("n4","f4"),At("p","n1"),At("p","n2"),At("p","n3"),At("p","n4"),At("u1","u2"),At("u2","u3"),At("u3","u1"),At("c","t"),At("p","c"),At("cn1","cn2"),At("cn3","cn4"),At("cf1","cf2"),At("cf3","cf4"),st.setAttribute("position",new xt(lt,3)),st.setAttribute("color",new xt(ft,3)),super(st,at),this.type="CameraHelper",this.camera=_,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=vt,this.update();const Tt=new ms(16755200),Ot=new ms(16711680),Ut=new ms(43775),Lt=new ms(16777215),Gt=new ms(3355443);this.setColors(Tt,Ot,Ut,Lt,Gt)}setColors(_,st,at,lt,ft){const vt=this.geometry.getAttribute("color");vt.setXYZ(0,_.r,_.g,_.b),vt.setXYZ(1,_.r,_.g,_.b),vt.setXYZ(2,_.r,_.g,_.b),vt.setXYZ(3,_.r,_.g,_.b),vt.setXYZ(4,_.r,_.g,_.b),vt.setXYZ(5,_.r,_.g,_.b),vt.setXYZ(6,_.r,_.g,_.b),vt.setXYZ(7,_.r,_.g,_.b),vt.setXYZ(8,_.r,_.g,_.b),vt.setXYZ(9,_.r,_.g,_.b),vt.setXYZ(10,_.r,_.g,_.b),vt.setXYZ(11,_.r,_.g,_.b),vt.setXYZ(12,_.r,_.g,_.b),vt.setXYZ(13,_.r,_.g,_.b),vt.setXYZ(14,_.r,_.g,_.b),vt.setXYZ(15,_.r,_.g,_.b),vt.setXYZ(16,_.r,_.g,_.b),vt.setXYZ(17,_.r,_.g,_.b),vt.setXYZ(18,_.r,_.g,_.b),vt.setXYZ(19,_.r,_.g,_.b),vt.setXYZ(20,_.r,_.g,_.b),vt.setXYZ(21,_.r,_.g,_.b),vt.setXYZ(22,_.r,_.g,_.b),vt.setXYZ(23,_.r,_.g,_.b),vt.setXYZ(24,st.r,st.g,st.b),vt.setXYZ(25,st.r,st.g,st.b),vt.setXYZ(26,st.r,st.g,st.b),vt.setXYZ(27,st.r,st.g,st.b),vt.setXYZ(28,st.r,st.g,st.b),vt.setXYZ(29,st.r,st.g,st.b),vt.setXYZ(30,st.r,st.g,st.b),vt.setXYZ(31,st.r,st.g,st.b),vt.setXYZ(32,at.r,at.g,at.b),vt.setXYZ(33,at.r,at.g,at.b),vt.setXYZ(34,at.r,at.g,at.b),vt.setXYZ(35,at.r,at.g,at.b),vt.setXYZ(36,at.r,at.g,at.b),vt.setXYZ(37,at.r,at.g,at.b),vt.setXYZ(38,lt.r,lt.g,lt.b),vt.setXYZ(39,lt.r,lt.g,lt.b),vt.setXYZ(40,ft.r,ft.g,ft.b),vt.setXYZ(41,ft.r,ft.g,ft.b),vt.setXYZ(42,ft.r,ft.g,ft.b),vt.setXYZ(43,ft.r,ft.g,ft.b),vt.setXYZ(44,ft.r,ft.g,ft.b),vt.setXYZ(45,ft.r,ft.g,ft.b),vt.setXYZ(46,ft.r,ft.g,ft.b),vt.setXYZ(47,ft.r,ft.g,ft.b),vt.setXYZ(48,ft.r,ft.g,ft.b),vt.setXYZ(49,ft.r,ft.g,ft.b),vt.needsUpdate=!0}update(){const _=this.geometry,st=this.pointMap;vu.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Eu("c",st,_,vu,0,0,-1),Eu("t",st,_,vu,0,0,1),Eu("n1",st,_,vu,-1,-1,-1),Eu("n2",st,_,vu,1,-1,-1),Eu("n3",st,_,vu,-1,1,-1),Eu("n4",st,_,vu,1,1,-1),Eu("f1",st,_,vu,-1,-1,1),Eu("f2",st,_,vu,1,-1,1),Eu("f3",st,_,vu,-1,1,1),Eu("f4",st,_,vu,1,1,1),Eu("u1",st,_,vu,.7,1.1,-1),Eu("u2",st,_,vu,-.7,1.1,-1),Eu("u3",st,_,vu,0,2,-1),Eu("cf1",st,_,vu,-1,0,1),Eu("cf2",st,_,vu,1,0,1),Eu("cf3",st,_,vu,0,-1,1),Eu("cf4",st,_,vu,0,1,1),Eu("cn1",st,_,vu,-1,0,-1),Eu("cn2",st,_,vu,1,0,-1),Eu("cn3",st,_,vu,0,-1,-1),Eu("cn4",st,_,vu,0,1,-1),_.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Eu(wt,_,st,at,lt,ft,vt){y0.set(lt,ft,vt).unproject(at);const At=_[wt];if(At!==void 0){const Ct=st.getAttribute("position");for(let Tt=0,Ot=At.length;Tt<Ot;Tt++)Ct.setXYZ(At[Tt],y0.x,y0.y,y0.z)}}const W1=new Q_;class HE extends f_{constructor(_,st=16776960){const at=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),lt=new Float32Array(24),ft=new xs;ft.setIndex(new El(at,1)),ft.setAttribute("position",new El(lt,3)),super(ft,new Qp({color:st,toneMapped:!1})),this.object=_,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(_){if(_!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&W1.setFromObject(this.object),W1.isEmpty())return;const st=W1.min,at=W1.max,lt=this.geometry.attributes.position,ft=lt.array;ft[0]=at.x,ft[1]=at.y,ft[2]=at.z,ft[3]=st.x,ft[4]=at.y,ft[5]=at.z,ft[6]=st.x,ft[7]=st.y,ft[8]=at.z,ft[9]=at.x,ft[10]=st.y,ft[11]=at.z,ft[12]=at.x,ft[13]=at.y,ft[14]=st.z,ft[15]=st.x,ft[16]=at.y,ft[17]=st.z,ft[18]=st.x,ft[19]=st.y,ft[20]=st.z,ft[21]=at.x,ft[22]=st.y,ft[23]=st.z,lt.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(_){return this.object=_,this.update(),this}copy(_,st){return super.copy(_,st),this.object=_.object,this}}class iv extends f_{constructor(_,st=16776960){const at=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),lt=new xs;lt.setIndex(new El(at,1)),lt.setAttribute("position",new xt([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(lt,new Qp({color:st,toneMapped:!1})),this.box=_,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(_){const st=this.box;st.isEmpty()||(st.getCenter(this.position),st.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(_))}}class qE extends h_{constructor(_,st=1,at=16776960){const lt=at,ft=new xs;ft.setAttribute("position",new xt([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),ft.computeBoundingSphere(),super(ft,new Qp({color:lt,toneMapped:!1})),this.type="PlaneHelper",this.plane=_,this.size=st;const vt=new xs;vt.setAttribute("position",new xt([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),vt.computeBoundingSphere(),this.add(new Hu(vt,new Jm({color:lt,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(_){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(_)}}const vw=new Mr;let Wp,lA;class y_ extends ao{constructor(_=new Mr(0,0,1),st=new Mr(0,0,0),at=1,lt=16776960,ft=.2*at,vt=.2*ft){super(),this.type="ArrowHelper",Wp===void 0&&(Wp=new xs,Wp.setAttribute("position",new xt([0,0,0,0,1,0],3)),lA=new qu(0,.5,1,5,1),lA.translate(0,-.5,0)),this.position.copy(st),this.line=new h_(Wp,new Qp({color:lt,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Hu(lA,new Jm({color:lt,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(_),this.setLength(at,ft,vt)}setDirection(_){if(_.y>.99999)this.quaternion.set(0,0,0,1);else if(_.y<-.99999)this.quaternion.set(1,0,0,0);else{vw.set(_.z,0,-_.x).normalize();const st=Math.acos(_.y);this.quaternion.setFromAxisAngle(vw,st)}}setLength(_,st=.2*_,at=.2*st){this.line.scale.set(1,Math.max(1e-4,_-st),1),this.line.updateMatrix(),this.cone.scale.set(at,st,at),this.cone.position.y=_,this.cone.updateMatrix()}setColor(_){this.line.material.color.set(_),this.cone.material.color.set(_)}copy(_){return super.copy(_,!1),this.line.copy(_.line),this.cone.copy(_.cone),this}}class _w extends f_{constructor(_=1){const st=[0,0,0,_,0,0,0,0,0,0,_,0,0,0,0,0,0,_],at=new xs;at.setAttribute("position",new xt(st,3)),at.setAttribute("color",new xt([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(at,new Qp({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(_,st,at){const lt=new ms,ft=this.geometry.attributes.color.array;return lt.set(_),lt.toArray(ft,0),lt.toArray(ft,3),lt.set(st),lt.toArray(ft,6),lt.toArray(ft,9),lt.set(at),lt.toArray(ft,12),lt.toArray(ft,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class WE{constructor(){this.type="ShapePath",this.color=new ms,this.subPaths=[],this.currentPath=null}moveTo(_,st){return this.currentPath=new sw,this.subPaths.push(this.currentPath),this.currentPath.moveTo(_,st),this}lineTo(_,st){return this.currentPath.lineTo(_,st),this}quadraticCurveTo(_,st,at,lt){return this.currentPath.quadraticCurveTo(_,st,at,lt),this}bezierCurveTo(_,st,at,lt,ft,vt){return this.currentPath.bezierCurveTo(_,st,at,lt,ft,vt),this}splineThru(_){return this.currentPath.splineThru(_),this}toShapes(_,st){function at(cr){const gr=[];for(let wr=0,Er=cr.length;wr<Er;wr++){const Cr=cr[wr],zr=new eA;zr.curves=Cr.curves,gr.push(zr)}return gr}function lt(cr,gr){const wr=gr.length;let Er=!1;for(let Cr=wr-1,zr=0;zr<wr;Cr=zr++){let Gr=gr[Cr],on=gr[zr],ln=on.x-Gr.x,Wr=on.y-Gr.y;if(Math.abs(Wr)>Number.EPSILON){if(Wr<0&&(Gr=gr[zr],ln=-ln,on=gr[Cr],Wr=-Wr),cr.y<Gr.y||cr.y>on.y)continue;if(cr.y===Gr.y){if(cr.x===Gr.x)return!0}else{const Bn=Wr*(cr.x-Gr.x)-ln*(cr.y-Gr.y);if(Bn===0)return!0;if(Bn<0)continue;Er=!Er}}else{if(cr.y!==Gr.y)continue;if(on.x<=cr.x&&cr.x<=Gr.x||Gr.x<=cr.x&&cr.x<=on.x)return!0}}return Er}const ft=Nv.isClockWise,vt=this.subPaths;if(vt.length===0)return[];if(st===!0)return at(vt);let At,Ct,Tt;const Ot=[];if(vt.length===1)return Ct=vt[0],Tt=new eA,Tt.curves=Ct.curves,Ot.push(Tt),Ot;let Ut=!ft(vt[0].getPoints());Ut=_?!Ut:Ut;const Lt=[],Gt=[];let Xt,Qt,lr=[],ur=0;Gt[ur]=void 0,lr[ur]=[];for(let cr=0,gr=vt.length;cr<gr;cr++)Ct=vt[cr],Xt=Ct.getPoints(),At=ft(Xt),At=_?!At:At,At?(!Ut&&Gt[ur]&&ur++,Gt[ur]={s:new eA,p:Xt},Gt[ur].s.curves=Ct.curves,Ut&&ur++,lr[ur]=[]):lr[ur].push({h:Ct,p:Xt[0]});if(!Gt[0])return at(vt);if(Gt.length>1){let cr=!1,gr=0;for(let wr=0,Er=Gt.length;wr<Er;wr++)Lt[wr]=[];for(let wr=0,Er=Gt.length;wr<Er;wr++){const Cr=lr[wr];for(let zr=0;zr<Cr.length;zr++){const Gr=Cr[zr];let on=!0;for(let ln=0;ln<Gt.length;ln++)lt(Gr.p,Gt[ln].p)&&(wr!==ln&&gr++,on?(on=!1,Lt[ln].push(Gr)):cr=!0);on&&Lt[wr].push(Gr)}}gr>0&&cr===!1&&(lr=Lt)}for(let cr=0,gr=Gt.length;cr<gr;cr++){Tt=Gt[cr].s,Ot.push(Tt),Qt=lr[cr];for(let wr=0,Er=Qt.length;wr<Er;wr++)Tt.holes.push(Qt[wr].h)}return Ot}}const sv=XC();function XC(){const wt=new ArrayBuffer(4),_=new Float32Array(wt),st=new Uint32Array(wt),at=new Uint32Array(512),lt=new Uint32Array(512);for(let Ct=0;Ct<256;++Ct){const Tt=Ct-127;Tt<-27?(at[Ct]=0,at[256|Ct]=32768,lt[Ct]=24,lt[256|Ct]=24):Tt<-14?(at[Ct]=1024>>-Tt-14,at[256|Ct]=1024>>-Tt-14|32768,lt[Ct]=-Tt-1,lt[256|Ct]=-Tt-1):Tt<=15?(at[Ct]=Tt+15<<10,at[256|Ct]=Tt+15<<10|32768,lt[Ct]=13,lt[256|Ct]=13):Tt<128?(at[Ct]=31744,at[256|Ct]=64512,lt[Ct]=24,lt[256|Ct]=24):(at[Ct]=31744,at[256|Ct]=64512,lt[Ct]=13,lt[256|Ct]=13)}const ft=new Uint32Array(2048),vt=new Uint32Array(64),At=new Uint32Array(64);for(let Ct=1;Ct<1024;++Ct){let Tt=Ct<<13,Ot=0;for(;!(8388608&Tt);)Tt<<=1,Ot-=8388608;Tt&=-8388609,Ot+=947912704,ft[Ct]=Tt|Ot}for(let Ct=1024;Ct<2048;++Ct)ft[Ct]=939524096+(Ct-1024<<13);for(let Ct=1;Ct<31;++Ct)vt[Ct]=Ct<<23;vt[31]=1199570944,vt[32]=2147483648;for(let Ct=33;Ct<63;++Ct)vt[Ct]=2147483648+(Ct-32<<23);vt[63]=3347054592;for(let Ct=1;Ct<64;++Ct)Ct!==32&&(At[Ct]=1024);return{floatView:_,uint32View:st,baseTable:at,shiftTable:lt,mantissaTable:ft,exponentTable:vt,offsetTable:At}}var yw=Object.freeze({__proto__:null,toHalfFloat:function(wt){Math.abs(wt)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),wt=Ls(wt,-65504,65504),sv.floatView[0]=wt;const _=sv.uint32View[0],st=_>>23&511;return sv.baseTable[st]+((8388607&_)>>sv.shiftTable[st])},fromHalfFloat:function(wt){const _=wt>>10;return sv.uint32View[0]=sv.mantissaTable[sv.offsetTable[_]+(1023&wt)]+sv.exponentTable[_],sv.floatView[0]}});function Y1(){console.error("THREE.ImmediateRenderObject has been removed.")}class JC extends Ip{constructor(_,st,at){console.error('THREE.WebGLMultisampleRenderTarget has been removed. Use a normal render target and set the "samples" property to greater 0 to enable multisampling.'),super(_,st,at),this.samples=4}}class dR extends N0{constructor(_,st,at,lt){console.warn("THREE.DataTexture2DArray has been renamed to DataArrayTexture."),super(_,st,at,lt)}}class A0 extends G_{constructor(_,st,at,lt){console.warn("THREE.DataTexture3D has been renamed to Data3DTexture."),super(_,st,at,lt)}}class pR extends Zm{constructor(_,st,at,lt,ft,vt){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(_,st,at,lt,ft,vt)}}class hR extends _1{constructor(_,st,at,lt){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(_,st,at,lt)}}class Aw extends Bm{constructor(_,st,at,lt){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(_,st,at,lt)}}class ZC extends Gl{constructor(_,st,at,lt,ft,vt,At){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(_,st,at,lt,ft,vt,At)}}class uA extends qu{constructor(_,st,at,lt,ft,vt,At,Ct){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(_,st,at,lt,ft,vt,At,Ct)}}class K1 extends y1{constructor(_,st){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(_,st)}}class fR extends S1{constructor(_,st){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(_,st)}}class YE extends lw{constructor(_,st){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(_,st)}}class mR extends ru{constructor(_,st,at,lt){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(_,st,at,lt)}}class bw extends yp{constructor(_,st){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(_,st)}}class ww extends Y0{constructor(_,st,at,lt){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(_,st,at,lt)}}class gR extends s0{constructor(_,st,at,lt){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(_,st,at,lt)}}class vR extends rA{constructor(_,st,at,lt,ft,vt){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(_,st,at,lt,ft,vt)}}class _R extends C1{constructor(_,st){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(_,st)}}class yR extends uw{constructor(_,st,at,lt,ft,vt,At){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(_,st,at,lt,ft,vt,At)}}class py extends nA{constructor(_,st){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(_,st)}}class eT extends sy{constructor(_,st,at,lt,ft){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(_,st,at,lt,ft)}}class xw extends lp{constructor(_,st,at,lt,ft,vt){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(_,st,at,lt,ft,vt)}}class ov extends T1{constructor(_,st,at,lt,ft){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(_,st,at,lt,ft)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:et}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=et)},553:function($,j,it){it.d(j,{_:function(){return dt}});var et=it(988);const ut=new WeakMap;class dt extends et.aNw{constructor(bt){super(bt),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(bt){return this.decoderPath=bt,this}setDecoderConfig(bt){return this.decoderConfig=bt,this}setWorkerLimit(bt){return this.workerLimit=bt,this}load(bt,Rt,jt,Vt){const zt=new et.hH6(this.manager);zt.setPath(this.path),zt.setResponseType("arraybuffer"),zt.setRequestHeader(this.requestHeader),zt.setWithCredentials(this.withCredentials),zt.load(bt,Jt=>{this.decodeDracoFile(Jt,Rt).catch(Vt)},jt,Vt)}decodeDracoFile(bt,Rt,jt,Vt){const zt={attributeIDs:jt||this.defaultAttributeIDs,attributeTypes:Vt||this.defaultAttributeTypes,useUniqueIDs:!!jt};return this.decodeGeometry(bt,zt).then(Rt)}decodeGeometry(bt,Rt){const jt=JSON.stringify(Rt);if(ut.has(bt)){const Yt=ut.get(bt);if(Yt.key===jt)return Yt.promise;if(bt.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let Vt;const zt=this.workerNextTaskID++,Jt=bt.byteLength,rr=this._getWorker(zt,Jt).then(Yt=>(Vt=Yt,new Promise((dr,Ft)=>{Vt._callbacks[zt]={resolve:dr,reject:Ft},Vt.postMessage({type:"decode",id:zt,taskConfig:Rt,buffer:bt},[bt])}))).then(Yt=>this._createGeometry(Yt.geometry));return rr.catch(()=>!0).then(()=>{Vt&&zt&&this._releaseTask(Vt,zt)}),ut.set(bt,{key:jt,promise:rr}),rr}_createGeometry(bt){const Rt=new et.u9r;bt.index&&Rt.setIndex(new et.TlE(bt.index.array,1));for(let jt=0;jt<bt.attributes.length;jt++){const Vt=bt.attributes[jt],zt=Vt.name,Jt=Vt.array,rr=Vt.itemSize;Rt.setAttribute(zt,new et.TlE(Jt,rr))}return Rt}_loadLibrary(bt,Rt){const jt=new et.hH6(this.manager);return jt.setPath(this.decoderPath),jt.setResponseType(Rt),jt.setWithCredentials(this.withCredentials),new Promise((Vt,zt)=>{jt.load(bt,Vt,void 0,zt)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const bt=typeof WebAssembly!="object"||this.decoderConfig.type==="js",Rt=[];return bt?Rt.push(this._loadLibrary("draco_decoder.js","text")):(Rt.push(this._loadLibrary("draco_wasm_wrapper.js","text")),Rt.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(Rt).then(jt=>{const Vt=jt[0];bt||(this.decoderConfig.wasmBinary=jt[1]);const zt=mt.toString(),Jt=["/* draco decoder */",Vt,"","/* worker */",zt.substring(zt.indexOf("{")+1,zt.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([Jt]))}),this.decoderPending}_getWorker(bt,Rt){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const Vt=new Worker(this.workerSourceURL);Vt._callbacks={},Vt._taskCosts={},Vt._taskLoad=0,Vt.postMessage({type:"init",decoderConfig:this.decoderConfig}),Vt.onmessage=function(zt){const Jt=zt.data;switch(Jt.type){case"decode":Vt._callbacks[Jt.id].resolve(Jt);break;case"error":Vt._callbacks[Jt.id].reject(Jt);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+Jt.type+'"')}},this.workerPool.push(Vt)}else this.workerPool.sort(function(Vt,zt){return Vt._taskLoad>zt._taskLoad?-1:1});const jt=this.workerPool[this.workerPool.length-1];return jt._taskCosts[bt]=Rt,jt._taskLoad+=Rt,jt})}_releaseTask(bt,Rt){bt._taskLoad-=bt._taskCosts[Rt],delete bt._callbacks[Rt],delete bt._taskCosts[Rt]}debug(){console.log("Task load: ",this.workerPool.map(bt=>bt._taskLoad))}dispose(){for(let bt=0;bt<this.workerPool.length;++bt)this.workerPool[bt].terminate();return this.workerPool.length=0,this}}function mt(){let yt,bt;function Rt(jt,Vt,zt,Jt,rr,Yt){const dr=Yt.num_components(),Ft=zt.num_points()*dr,Ht=Ft*rr.BYTES_PER_ELEMENT,er=function(ar,Wt){switch(Wt){case Float32Array:return ar.DT_FLOAT32;case Int8Array:return ar.DT_INT8;case Int16Array:return ar.DT_INT16;case Int32Array:return ar.DT_INT32;case Uint8Array:return ar.DT_UINT8;case Uint16Array:return ar.DT_UINT16;case Uint32Array:return ar.DT_UINT32}}(jt,rr),pr=jt._malloc(Ht);Vt.GetAttributeDataArrayForAllPoints(zt,Yt,er,Ht,pr);const or=new rr(jt.HEAPF32.buffer,pr,Ft).slice();return jt._free(pr),{name:Jt,array:or,itemSize:dr}}onmessage=function(jt){const Vt=jt.data;switch(Vt.type){case"init":yt=Vt.decoderConfig,bt=new Promise(function(rr){yt.onModuleLoaded=function(Yt){rr({draco:Yt})},DracoDecoderModule(yt)});break;case"decode":const zt=Vt.buffer,Jt=Vt.taskConfig;bt.then(rr=>{const Yt=rr.draco,dr=new Yt.Decoder,Ft=new Yt.DecoderBuffer;Ft.Init(new Int8Array(zt),zt.byteLength);try{const Ht=function(pr,or,ar,Wt){const Zt=Wt.attributeIDs,sr=Wt.attributeTypes;let tr,vr;const Vr=or.GetEncodedGeometryType(ar);if(Vr===pr.TRIANGULAR_MESH)tr=new pr.Mesh,vr=or.DecodeBufferToMesh(ar,tr);else{if(Vr!==pr.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");tr=new pr.PointCloud,vr=or.DecodeBufferToPointCloud(ar,tr)}if(!vr.ok()||tr.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+vr.error_msg());const hn={index:null,attributes:[]};for(const cn in Zt){const gn=self[sr[cn]];let tn,Tn;if(Wt.useUniqueIDs)Tn=Zt[cn],tn=or.GetAttributeByUniqueId(tr,Tn);else{if(Tn=or.GetAttributeId(tr,pr[Zt[cn]]),Tn===-1)continue;tn=or.GetAttribute(tr,Tn)}hn.attributes.push(Rt(pr,or,tr,cn,gn,tn))}return Vr===pr.TRIANGULAR_MESH&&(hn.index=function(cn,gn,tn){const Tn=3*tn.num_faces(),qr=4*Tn,nn=cn._malloc(qr);gn.GetTrianglesUInt32Array(tn,qr,nn);const yr=new Uint32Array(cn.HEAPF32.buffer,nn,Tn).slice();return cn._free(nn),{array:yr,itemSize:1}}(pr,or,tr)),pr.destroy(tr),hn}(Yt,dr,Ft,Jt),er=Ht.attributes.map(pr=>pr.array.buffer);Ht.index&&er.push(Ht.index.array.buffer),self.postMessage({type:"decode",id:Vt.id,geometry:Ht},er)}catch(Ht){console.error(Ht),self.postMessage({type:"error",id:Vt.id,error:Ht.message})}finally{Yt.destroy(Ft),Yt.destroy(dr)}})}}}}},__webpackgi_module_cache__={};function __webpackgi_require__($){var j=__webpackgi_module_cache__[$];if(j!==void 0)return j.exports;var it=__webpackgi_module_cache__[$]={id:$,exports:{}};return __webpackgi_modules__[$].call(it.exports,it,it.exports,__webpackgi_require__),it.exports}__webpackgi_require__.n=function($){var j=$&&$.__esModule?function(){return $.default}:function(){return $};return __webpackgi_require__.d(j,{a:j}),j},__webpackgi_require__.d=function($,j){for(var it in j)__webpackgi_require__.o(j,it)&&!__webpackgi_require__.o($,it)&&Object.defineProperty($,it,{enumerable:!0,get:j[it]})},__webpackgi_require__.o=function($,j){return Object.prototype.hasOwnProperty.call($,j)},__webpackgi_require__.r=function($){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty($,Symbol.toStringTag,{value:"Module"}),Object.defineProperty($,"__esModule",{value:!0})},__webpackgi_require__.nc=void 0;var __webpackgi_exports__={};(function(){__webpackgi_require__.d(__webpackgi_exports__,{LY2:function(){return et.LY2},HRj:function(){return qm},li4:function(){return ZB},FO5:function(){return _k},Nlh:function(){return XB},QvI:function(){return io},JHp:function(){return XS},bGH:function(){return et.bGH},NDo:function(){return et.NDo},gSk:function(){return et.gSk},WMw:function(){return et.WMw},OTo:function(){return et.OTo},Se2:function(){return et.Se2},cum:function(){return et.cum},Mig:function(){return et.Mig},B$7:function(){return Ux},i_9:function(){return et.i_9},m7l:function(){return et.m7l},sYA:function(){return et.sYA},Xcj:function(){return et.Xcj},mzJ:function(){return et.mzJ},ZZA:function(){return et.ZZA},$Ph:function(){return Am},T__:function(){return et.T__},HkE:function(){return et.HkE},tGC:function(){return et.tGC},g1S:function(){return hy},I$C:function(){return uT},QIH:function(){return mo},_JE:function(){return m0},ksm:function(){return os},jl_:function(){return Pm},b7R:function(){return Bp},BDV:function(){return Ms},Ea_:function(){return zy},qff:function(){return Pm},tmC:function(){return pu},BON:function(){return _P},P40:function(){return Hu},wLL:function(){return mm},iHO:function(){return Bx},BbS:function(){return et.BbS},kqm:function(){return et.kqm},Hmr:function(){return et.Hmr},SJI:function(){return et.SJI},mTL:function(){return et.mTL},y8_:function(){return et.y8_},_Li:function(){return et._Li},g56:function(){return Op},bj3:function(){return Vs},z81:function(){return et.z81},_MY:function(){return et._MY},yEv:function(){return OP},dFZ:function(){return iy},N$j:function(){return et.N$j},_YM:function(){return et._YM},TUj:function(){return et.TUj},ZzF:function(){return et.ZzF},qzb:function(){return cn},GQ:function(){return et.GQ},nvb:function(){return et.nvb},DvJ:function(){return et.DvJ},fQA:function(){return et.fQA},cPz:function(){return aC},TlE:function(){return et.TlE},u9r:function(){return et.u9r},s4_:function(){return et.s4_},T95:function(){return et.T95},F5w:function(){return RI},NlP:function(){return WI},$8Z:function(){return gA},YYN:function(){return fA},CtF:function(){return et.CtF},V1s:function(){return et.V1s},jOv:function(){return Rp},Rki:function(){return et.Rki},pzV:function(){return nP},itZ:function(){return Hp},qKx:function(){return gu},vlJ:function(){return gT},nPO:function(){return _y},zcQ:function(){return kC},GH1:function(){return bm},ROQ:function(){return et.ROQ},YN5:function(){return et.YN5},BVQ:function(){return et.BVQ},YT8:function(){return et.YT8},_DE:function(){return jE},YGz:function(){return et.YGz},trn:function(){return et.trn},zf8:function(){return et.zf8},uWy:function(){return et.uWy},wYQ:function(){return rv},SUY:function(){return et.SUY},Ilk:function(){return et.Ilk},R2R:function(){return et.R2R},epp:function(){return et.epp},xmJ:function(){return Lp},GD$:function(){return Gp},EB7:function(){return et.EB7},DqL:function(){return et.DqL},_3:function(){return et._3},b_z:function(){return et.b_z},OCn:function(){return yy},_am:function(){return et._am},kB7:function(){return nM},fY$:function(){return et.fY$},vxC:function(){return et.vxC},BtG:function(){return et.BtG},cBK:function(){return et.cBK},g8_:function(){return et.g8_},AXT:function(){return et.AXT},yj7:function(){return et.yj7},dYG:function(){return et.dYG},tm_:function(){return et.tm_},S2y:function(){return et.S2y},B02:function(){return et.B02},PeU:function(){return et.PeU},Hyl:function(){return et.Hyl},Wqd:function(){return et.Wqd},Xaj:function(){return et.Xaj},DUb:function(){return lp},dZ3:function(){return et.dZ3},m_w:function(){return et.m_w},fHI:function(){return et.fHI},LBq:function(){return et.LBq},dHf:function(){return KB},Qww:function(){return q_.Q},CGV:function(){return uS},JUT:function(){return et.JUT},p3g:function(){return et.p3g},IEO:function(){return et.IEO},CN8:function(){return et.CN8},zob:function(){return et.zob},yxD:function(){return et.yxD},CUS:function(){return Bl},A5E:function(){return et.A5E},zqG:function(){return Ov},PfX:function(){return GT},Q1o:function(){return H0},jfJ:function(){return et.jfJ},T_J:function(){return et.T_J},tEQ:function(){return et.tEQ},gb4:function(){return zn},qkB:function(){return et.qkB},cvk:function(){return oy},HWo:function(){return c0},brP:function(){return et.brP},$YQ:function(){return et.$YQ},X8d:function(){return LT},Zdt:function(){return oD},yNB:function(){return Ul},h7x:function(){return ru},Ox3:function(){return et.Ox3},qtn:function(){return c_},cBI:function(){return et.cBI},cU9:function(){return et.cU9},DT1:function(){return et.DT1},Kgo:function(){return et.Kgo},ehD:function(){return et.ehD},fhJ:function(){return Xw},y1s:function(){return Jw},fSK:function(){return et.fSK},Vdb:function(){return et.Vdb},l8J:function(){return et.l8J},dj0:function(){return et.dj0},QM0:function(){return et.QM0},OIS:function(){return Yp},q8b:function(){return Zy},TOt:function(){return et.TOt},xaN:function(){return Jt},Ny0:function(){return et.Ny0},NeD:function(){return N2},Zof:function(){return jS},eD:function(){return et.eD},jwo:function(){return et.jwo},dSO:function(){return et.dSO},Bf4:function(){return et.Bf4},USm:function(){return et.USm},pBf:function(){return et.pBf},$Vf:function(){return et.$Vf},O7d:function(){return et.O7d},ksq:function(){return go},gXf:function(){return MC},hH6:function(){return et.hH6},kpi:function(){return VE},DwZ:function(){return Ep},kN3:function(){return uD},e62:function(){return et.e62},a$l:function(){return et.a$l},OM3:function(){return et.OM3},VzW:function(){return et.VzW},ybr:function(){return et.ybr},yo9:function(){return et.yo9},$Bt:function(){return i0},Wzm:function(){return et.Wzm},Wl3:function(){return et.Wl3},iWj:function(){return et.iWj},DNz:function(){return hu},m1M:function(){return Dl},ylh:function(){return et.ylh},v9Y:function(){return et.v9Y},LSk:function(){return et.LSk},LHE:function(){return Gl},KE0:function(){return s2},KCF:function(){return GB},a4n:function(){return NP},zIH:function(){return Px},Hfk:function(){return Ev},png:function(){return Tm},tAj:function(){return r_},Eb_:function(){return Mm},BT2:function(){return iT},_8p:function(){return RD},V5Z:function(){return ly},s5b:function(){return NE},hkn:function(){return TA},GFY:function(){return Mv},w$m:function(){return et.w$m},ksN:function(){return et.ksN},j4z:function(){return et.j4z},OAl:function(){return et.OAl},VLJ:function(){return et.VLJ},C73:function(){return _m},ZAu:function(){return et.ZAu},ibP:function(){return Q0},_fI:function(){return Gp},hUN:function(){return wm},cLu:function(){return et.cLu},vmT:function(){return et.vmT},Qpg:function(){return et.Qpg},So8:function(){return et.So8},eOv:function(){return ZI},Wjw:function(){return et.Wjw},cJO:function(){return et.cJO},QRU:function(){return et.QRU},S3k:function(){return et.S3k},PpQ:function(){return et.PpQ},AHu:function(){return et.AHu},q_9:function(){return Yl},ZRs:function(){return et.ZRs},oqc:function(){return et.oqc},T_x:function(){return Fl},lb7:function(){return et.lb7},L5s:function(){return et.L5s},$TI:function(){return et.$TI},SPe:function(){return et.SPe},aVm:function(){return et.aVm},j87:function(){return et.j87},RNb:function(){return et.RNb},Kz5:function(){return et.Kz5},vpT:function(){return et.vpT},kB5:function(){return et.kB5},_C8:function(){return et._C8},Syv:function(){return et.Syv},NMF:function(){return et.NMF},pIN:function(){return et.pIN},eMJ:function(){return et.eMJ},rN7:function(){return N1},iUp:function(){return jC},GFd:function(){return tS},x5V:function(){return et.x5V},tUh:function(){return et.tUh},z8B:function(){return et.z8B},vcl:function(){return FE},GZb:function(){return et.GZb},p7y:function(){return et.p7y},S9g:function(){return et.S9g},Zr5:function(){return et.Zr5},vCF:function(){return et.vCF},yt0:function(){return et.yt0},uXU:function(){return et.uXU},_kC:function(){return et._kC},lk7:function(){return et.lk7},USc:function(){return eP},x12:function(){return et.x12},Zzh:function(){return et.Zzh},nls:function(){return et.nls},g_z:function(){return et.g_z},U7:function(){return et.U7},FT0:function(){return et.FT0},blk:function(){return et.blk},ejS:function(){return et.ejS},rnI:function(){return et.rnI},wem:function(){return et.wem},lfu:function(){return et.lfu},FDw:function(){return et.FDw},lRj:function(){return et.lRj},D1R:function(){return et.D1R},qyh:function(){return et.qyh},GUF:function(){return et.GUF},EoG:function(){return et.EoG},aNw:function(){return et.aNw},Zp0:function(){return et.Zp0},lLk:function(){return et.lLk},jAl:function(){return et.jAl},uEv:function(){return et.uEv},YKA:function(){return et.YKA},cRx:function(){return et.cRx},Y8D:function(){return et.Y8D},RsA:function(){return et.RsA},Y0m:function(){return Z1},F5T:function(){return et.F5T},EDU:function(){return mI},z$Q:function(){return vx},KA8:function(){return Uu},XUj:function(){return CI},Me$:function(){return Mw},u7G:function(){return et.u7G},PEk:function(){return F_},BG4:function(){return p2},M8C:function(){return et.M8C},Vkp:function(){return et.Vkp},yGw:function(){return et.yGw},Sm8:function(){return et.Sm8},Kj0:function(){return et.Kj0},vBJ:function(){return et.vBJ},QfV:function(){return tm},lRF:function(){return et.lRF},Lun:function(){return et.Lun},YBo:function(){return et.YBo},kaV:function(){return et.kaV},RSm:function(){return et.RSm},xoR:function(){return et.xoR},EJi:function(){return et.EJi},Wid:function(){return et.Wid},iuj:function(){return tp},IKL:function(){return et.IKL},r_:function(){return et.r_},OoA:function(){return et.OoA},qhX:function(){return et.qhX},qPT:function(){return Zw},M5h:function(){return et.M5h},Ns1:function(){return et.Ns1},TyD:function(){return et.TyD},vZf:function(){return et.vZf},HTd:function(){return et.HTd},aH4:function(){return et.aH4},YLQ:function(){return et.YLQ},BVF:function(){return et.BVF},MyG:function(){return et.MyG},jFi:function(){return et.jFi},aCh:function(){return et.aCh},uL9:function(){return et.uL9},TNj:function(){return yp},IFH:function(){return et.IFH},bdR:function(){return et.bdR},kM_:function(){return iM},M6v:function(){return et.M6v},RvT:function(){return et.RvT},dUE:function(){return et.dUE},oe_:function(){return TR},BuN:function(){return aT},Tme:function(){return et.Tme},N9P:function(){return yv},Gql:function(){return et.Gql},$XY:function(){return OA},O9d:function(){return lM},zEO:function(){return B0},qfx:function(){return xy},PA7:function(){return et.PA7},REq:function(){return et.REq},pQR:function(){return et.pQR},ghN:function(){return et.ghN},Hy8:function(){return et.Hy8},Wpd:function(){return et.Wpd},LgZ:function(){return et.LgZ},iWC:function(){return et.iWC},mqn:function(){return kF},SKe:function(){return Ho},iKG:function(){return et.iKG},_iA:function(){return et._iA},ntZ:function(){return et.ntZ},anP:function(){return et.anP},X2e:function(){return HB},FCo:function(){return S0},y$t:function(){return et.y$t},cPb:function(){return et.cPb},lmx:function(){return Wo},JOQ:function(){return et.JOQ},BKK:function(){return et.BKK},_12:function(){return et._12},tJx:function(){return et.tJx},cek:function(){return et.cek},qD0:function(){return VS},xG9:function(){return et.xG9},wI8:function(){return yA},Sgv:function(){return cD},woe:function(){return et.woe},UY4:function(){return et.UY4},aq0:function(){return et.aq0},ujx:function(){return et.ujx},Uol:function(){return et.Uol},JiH:function(){return ET},VYz:function(){return et.VYz},_Pm:function(){return h0},EsW:function(){return _p},iUV:function(){return et.iUV},tf:function(){return et.tf},ZQ6:function(){return et.ZQ6},mXe:function(){return et.mXe},_fP:function(){return et._fP},iLg:function(){return et.iLg},zbs:function(){return et.zbs},UZH:function(){return et.UZH},mSO:function(){return et.mSO},wk1:function(){return et.wk1},E2K:function(){return et.E2K},FUD:function(){return et.FUD},pKu:function(){return et.pKu},GG6:function(){return et.GG6},Gih:function(){return et.Gih},iiP:function(){return et.iiP},SvJ:function(){return et.SvJ},ptH:function(){return et.ptH},jZA:function(){return et.jZA},y2t:function(){return et.y2t},gi4:function(){return et.gi4},Djp:function(){return et.Djp},BG$:function(){return et.BG$},NYV:function(){return et.NYV},xJs:function(){return et.xJs},bsb:function(){return et.bsb},ekQ:function(){return et.ekQ},CaW:function(){return et.CaW},eaV:function(){return et.eaV},BFQ:function(){return et.BFQ},v3W:function(){return et.v3W},ILR:function(){return et.ILR},UCm:function(){return et.UCm},Inb:function(){return et.Inb},U1$:function(){return qr},LgE:function(){return et.LgE},fto:function(){return et.fto},l0P:function(){return et.l0P},vCx:function(){return et.vCx},_AM:function(){return et._AM},wuA:function(){return et.wuA},av9:function(){return et.av9},CtA:function(){return et.CtA},BvQ:function(){return w1},FZJ:function(){return a0},FIo:function(){return et.FIo},zHn:function(){return et.zHn},iMs:function(){return et.iMs},T_f:function(){return et.T_f},hEm:function(){return et.hEm},D9w:function(){return et.D9w},sHH:function(){return tA},CdI:function(){return et.CdI},rkc:function(){return AA},rpg:function(){return et.rpg},ce8:function(){return et.ce8},rOj:function(){return et.rOj},P6m:function(){return A_},JA6:function(){return JE},V4E:function(){return et.V4E},o8S:function(){return et.o8S},flB:function(){return P_},DUH:function(){return mN},KI_:function(){return et.KI_},iLN:function(){return qx},jsw:function(){return Du},srG:function(){return TI},i6Z:function(){return Qx},vfv:function(){return sT},xsS:function(){return et.xsS},or:function(){return tP},EQj:function(){return xm},ov0:function(){return oC},WdD:function(){return et.WdD},Vj0:function(){return et.Vj0},jyz:function(){return et.jyz},mTM:function(){return L_},Mn1:function(){return $u},Hlq:function(){return Ru},Fi7:function(){return Lv},Tn7:function(){return et.Tn7},bnF:function(){return et.bnF},HW6:function(){return et.HW6},oa8:function(){return et.oa8},T_1:function(){return et.T_1},zHJ:function(){return Hv},iDF:function(){return et.iDF},iAb:function(){return et.iAb},d4E:function(){return oR},lBg:function(){return XI},JeJ:function(){return IP},FKY:function(){return it},zlZ:function(){return MR},vkg:function(){return IA},brh:function(){return b_},kZK:function(){return qv},puG:function(){return JI},OdW:function(){return et.OdW},_YX:function(){return et._YX},TUv:function(){return et.TUv},Hw6:function(){return et.Hw6},aLr:function(){return et.aLr},Aip:function(){return et.Aip},xo$:function(){return et.xo$},bIn:function(){return OF},$V:function(){return et.$V},lDi:function(){return et.lDi},gti:function(){return et.gti},PMe:function(){return et.PMe},iwP:function(){return qy},FvO:function(){return et.FvO},jyi:function(){return et.jyi},xeV:function(){return et.xeV},k74:function(){return et.k74},RlZ:function(){return et.RlZ},KhW:function(){return et.KhW},HgB:function(){return et.HgB},W2J:function(){return et.W2J},JWc:function(){return et.JWc},u37:function(){return et.u37},Z6B:function(){return et.Z6B},QZ1:function(){return et.QZ1},Ir4:function(){return et.Ir4},NwF:function(){return et.NwF},Wbm:function(){return et.Wbm},N4l:function(){return et.N4l},ej9:function(){return Rw},QmN:function(){return et.QmN},IOt:function(){return et.IOt},NOD:function(){return I1},L5g:function(){return et.L5g},H$k:function(){return et.H$k},cuP:function(){return xp},xEZ:function(){return et.xEZ},dpR:function(){return et.dpR},wOD:function(){return km},KNb:function(){return YT},IiN:function(){return j1},Cne:function(){return et.Cne},XvJ:function(){return et.XvJ},XZw:function(){return et.XZw},FE5:function(){return et.FE5},lVp:function(){return TC},CJI:function(){return et.CJI},z$h:function(){return et.z$h},UlW:function(){return et.UlW},WwZ:function(){return et.WwZ},Lcc:function(){return et.Lcc},WXh:function(){return et.WXh},Vjr:function(){return O2},LuM:function(){return gD},LP5:function(){return G3},xfE:function(){return et.xfE},qlB:function(){return et.qlB},lCJ:function(){return et.lCJ},WTc:function(){return et.WTc},rAo:function(){return et.rAo},LZj:function(){return iR},xWb:function(){return et.xWb},gH0:function(){return et.gH0},rBU:function(){return et.rBU},rDY:function(){return et.rDY},ywz:function(){return et.ywz},wJv:function(){return et.wJv},JQ4:function(){return et.JQ4},k0A:function(){return et.k0A},irR:function(){return et.irR},LsT:function(){return et.LsT},q5h:function(){return Ox},TKh:function(){return vP},tyg:function(){return HT},Ro5:function(){return Qy},dwk:function(){return et.dwk},FM8:function(){return et.FM8},Pa4:function(){return et.Pa4},Ltg:function(){return et.Ltg},yC1:function(){return et.yC1},lHq:function(){return R1},fO1:function(){return et.fO1},oMA:function(){return _g},JzW:function(){return $},QEt:function(){return UE},b5g:function(){return et.b5g},Ywn:function(){return et.Ywn},GVz:function(){return et.GVz},oAp:function(){return et.oAp},kFz:function(){return et.kFz},p7A:function(){return et.p7A},dd2:function(){return et.dd2},CP7:function(){return et.CP7},fQK:function(){return et.fQK},Wd$:function(){return sR},t1_:function(){return bD},Uk6:function(){return et.Uk6},_sL:function(){return et._sL},Pnf:function(){return et.Pnf},c8b:function(){return et.c8b},_lf:function(){return et._lf},ad5:function(){return et.ad5},sZV:function(){return mP},TfA:function(){return ls},sKX:function(){return Nx},UdM:function(){return ho},P0y:function(){return QA},L_r:function(){return et.L_r},Bve:function(){return GE},UeO:function(){return i_},$nx:function(){return FP},Bk6:function(){return zu},y4l:function(){return Rx},pQ0:function(){return Fx},wXW:function(){return hO},r5x:function(){return cO},MSI:function(){return gO},EUu:function(){return NF},jtH:function(){return iw},T0T:function(){return SC},gAb:function(){return lP},iwT:function(){return P1},je_:function(){return q3},wBP:function(){return v1},LU2:function(){return dC},wQL:function(){return FF},Zs7:function(){return bI},x7s:function(){return IO},Mnd:function(){return $F},A0_:function(){return jF},d73:function(){return _I},HCD:function(){return As},RG9:function(){return ps},G2P:function(){return e0},XLf:function(){return tE},CGN:function(){return CM},mvg:function(){return fS},Hiy:function(){return $w},XMc:function(){return dO},N7M:function(){return lO},iv:function(){return fO},n55:function(){return Su},IaC:function(){return Vv},h9t:function(){return TM},yDW:function(){return MM},gJv:function(){return a1},l$g:function(){return r3},vQi:function(){return U3},$MY:function(){return JT},wJl:function(){return WS},Z7Y:function(){return uC},X7D:function(){return cC},BnX:function(){return eE},uZ5:function(){return J0},zVI:function(){return oO},DpF:function(){return cw},nNb:function(){return K_},cqZ:function(){return u_},pKN:function(){return uI},d_$:function(){return oM},DdI:function(){return o2},rrX:function(){return cI},KlC:function(){return sM},KVn:function(){return Tn},oau:function(){return S2},aw9:function(){return Ol},Aap:function(){return po},Dxg:function(){return pr},MjT:function(){return _c},F7Q:function(){return EM},IFq:function(){return CD},IJl:function(){return Zx},O5A:function(){return D_},wCn:function(){return Ll},gGT:function(){return xM},pEc:function(){return YB},Bi6:function(){return CA},fi_:function(){return kO},TT:function(){return bN},q2Z:function(){return RF},NyK:function(){return Eo},bgu:function(){return Tx},kcS:function(){return Jv},rRN:function(){return j2},ivY:function(){return Zt},_s1:function(){return WF},_HO:function(){return On},tpL:function(){return $n},DMK:function(){return dE},LjN:function(){return VT},iFs:function(){return Tv},qTg:function(){return Ft},Wtl:function(){return Us},DmK:function(){return xs},Htt:function(){return X3},Hx7:function(){return In},imt:function(){return Js},US6:function(){return _S},vZs:function(){return aM},TE$:function(){return zF},lmu:function(){return Nu},SvO:function(){return _f},YQY:function(){return JA},mZN:function(){return lC},VvG:function(){return SM},omp:function(){return e3},utz:function(){return mS},TFV:function(){return Rv},hrz:function(){return or},JKM:function(){return w2},jZf:function(){return ED},RjL:function(){return dD},RRI:function(){return MO},RUq:function(){return t3},_t4:function(){return Yv},YHh:function(){return R_},R8g:function(){return nn},Bbl:function(){return RA},V9r:function(){return Ht},PZ2:function(){return er},w7A:function(){return rr},N6S:function(){return sn},Uxp:function(){return Rn},tAz:function(){return an},R$F:function(){return mr},N33:function(){return Jr},gw2:function(){return $x},KlU:function(){return yr},wo6:function(){return O_},H4P:function(){return Wt},swA:function(){return Vy},_Z3:function(){return Gy},ivc:function(){return K_},rZ1:function(){return u_},CpZ:function(){return BO},dyc:function(){return sr},MxZ:function(){return DN},btp:function(){return BN},mXy:function(){return F2},Ej0:function(){return Jo},ep4:function(){return su},DQP:function(){return ep},VNr:function(){return pp},V7q:function(){return k_},zEk:function(){return Fu},qfq:function(){return Sm},piB:function(){return Vr},IIc:function(){return LF},rrF:function(){return fm},naq:function(){return sp},sXR:function(){return cE},p5I:function(){return EC},wps:function(){return uP},wuo:function(){return TD},GpE:function(){return Yt},F4b:function(){return rw},t$v:function(){return zm},tdn:function(){return CE},Y9t:function(){return OC},GEo:function(){return o1},DH3:function(){return pO},uxM:function(){return tO},zH3:function(){return rO},MLs:function(){return YA},xXG:function(){return Bo},YM4:function(){return g1},B3r:function(){return SD},iAx:function(){return vT},lDn:function(){return jr},oaQ:function(){return Jx},CD7:function(){return t0},Rc0:function(){return aE},iPG:function(){return h_},TIc:function(){return Nw},xsC:function(){return vO},zOc:function(){return bo},r46:function(){return wO},z2C:function(){return vr},_X$:function(){return MA},_yn:function(){return Ro},Dyg:function(){return I0},cUc:function(){return Uw},zGw:function(){return uE},Ctq:function(){return b2},$ch:function(){return VF},k5b:function(){return gS},kZl:function(){return yI},OCg:function(){return E2},YjH:function(){return RO},Ui8:function(){return ID},YD2:function(){return Z0},vi9:function(){return K3},ij3:function(){return uO},YPW:function(){return aO},Bg1:function(){return DF},kon:function(){return ar},M3g:function(){return s1},F2z:function(){return Gv},pJF:function(){return ZO},knz:function(){return et.knz},Ejo:function(){return dr},BgY:function(){return Fs},qCG:function(){return Yr},HD9:function(){return rs},fEB:function(){return Cl},Udc:function(){return Uo},ZQg:function(){return oo},ofC:function(){return jn},yRy:function(){return hp},_NL:function(){return QE},LCA:function(){return Xo},j1w:function(){return U_},i8J:function(){return KF},p7C:function(){return Wl},ZAS:function(){return Fv},ipH:function(){return GF},$TF:function(){return Z3},uZI:function(){return QF},VWG:function(){return d2},pQ7:function(){return iA},STw:function(){return d_},jc8:function(){return Fw},BL_:function(){return mx},S6:function(){return YF},T8U:function(){return zS},TD6:function(){return W0},akS:function(){return h2},QKE:function(){return nO},dKx:function(){return tr},OvX:function(){return W3},VsW:function(){return mu},YMc:function(){return J3},aPg:function(){return qs},LFn:function(){return P0},wey:function(){return jm},MaE:function(){return Qo},s4x:function(){return vv},FJA:function(){return Pl},vIA:function(){return Mp},Spv:function(){return Ao},w8l:function(){return By},riG:function(){return yo},Kbh:function(){return Hm},t8K:function(){return gs},Q7n:function(){return ds},KGF:function(){return ou},e5:function(){return Ar},Rik:function(){return qT},GZo:function(){return Lx},Bds:function(){return Ww},HTu:function(){return Zm},cTq:function(){return B_},X_Y:function(){return YS},dA8:function(){return qS},bwS:function(){return A2},Lks:function(){return HF},Rvq:function(){return Y3},P4F:function(){return vN},Pd0:function(){return im},Pjo:function(){return y2},Tum:function(){return Mr},dRH:function(){return sm},RX0:function(){return wv},reQ:function(){return qF},cWm:function(){return mO},NC9:function(){return eO},$Re:function(){return gP},Xo9:function(){return QT},LNO:function(){return kx},iZP:function(){return qw}});var $,j={};__webpackgi_require__.r(j),__webpackgi_require__.d(j,{AsyncCompress:function(){return Er},AsyncDecompress:function(){return Zn},AsyncDeflate:function(){return Gt},AsyncGunzip:function(){return on},AsyncGzip:function(){return Er},AsyncInflate:function(){return ur},AsyncUnzipInflate:function(){return Rl},AsyncUnzlib:function(){return bn},AsyncZipDeflate:function(){return zs},AsyncZlib:function(){return Hn},Compress:function(){return wr},DecodeUTF8:function(){return rn},Decompress:function(){return kn},Deflate:function(){return Lt},EncodeUTF8:function(){return Ur},Gunzip:function(){return Gr},Gzip:function(){return wr},Inflate:function(){return lr},Unzip:function(){return KE},UnzipInflate:function(){return Ml},UnzipPassThrough:function(){return so},Unzlib:function(){return ts},Zip:function(){return Hs},ZipDeflate:function(){return lo},ZipPassThrough:function(){return Qs},Zlib:function(){return Bn},compress:function(){return Cr},compressSync:function(){return zr},decompress:function(){return Rs},decompressSync:function(){return wo},deflate:function(){return Xt},deflateSync:function(){return Qt},gunzip:function(){return ln},gunzipSync:function(){return Wr},gzip:function(){return Cr},gzipSync:function(){return zr},inflate:function(){return cr},inflateSync:function(){return gr},strFromU8:function(){return xn},strToU8:function(){return Zr},unzip:function(){return hs},unzipSync:function(){return AR},unzlib:function(){return Sn},unzlibSync:function(){return Kn},zip:function(){return _l},zipSync:function(){return Nm},zlib:function(){return Pn},zlibSync:function(){return es}}),function(tt){tt[tt.Error=-2]="Error",tt[tt.Destroyed=-1]="Destroyed",tt[tt.None=0]="None",tt[tt.Running=1]="Running",tt[tt.Paused=2]="Paused"}($||($={}));class it{constructor(){this._eventListeners={},this.dispatchEvent=this.dispatchEvent.bind(this),this.addEventListener=this.addEventListener.bind(this),this.removeEventListener=this.removeEventListener.bind(this),this.hasEventListener=this.hasEventListener.bind(this)}addEventListener(s,o){const a=this._eventListeners;a[s]===void 0&&(a[s]=[]),a[s].includes(o)||a[s].push(o)}hasEventListener(s,o){const a=this._eventListeners;return a[s]!==void 0&&a[s].includes(o)}removeEventListener(s,o){const a=this._eventListeners[s];if(a!==void 0){const _e=a.indexOf(o);_e!==-1&&a.splice(_e,1)}}dispatchEvent(s){const o=this._eventListeners[s.type];if(o!==void 0){s.target=this;const a=o.slice(0);for(let _e=0,rt=a.length;_e<rt;_e++)a[_e].call(this,s)}}}var et=__webpackgi_require__(988);const ut={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			gl_FragColor = texture2D( tDiffuse, vUv );
			gl_FragColor.a *= opacity;


		}`};class dt{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const mt=new et.iKG(-1,1,1,-1,0,1),yt=new et.u9r;yt.setAttribute("position",new et.a$l([-1,3,0,-1,-1,0,3,-1,0],3)),yt.setAttribute("uv",new et.a$l([0,2,0,0,2,0],2));class bt{constructor(s){this._mesh=new et.Kj0(yt,s)}dispose(){this._mesh.geometry.dispose()}render(s){s.render(this._mesh,mt)}get material(){return this._mesh.material}set material(s){this._mesh.material=s}}class Rt extends dt{constructor(s,o){super(),this.textureID=o!==void 0?o:"tDiffuse",s instanceof et.jyz?(this.uniforms=s.uniforms,this.material=s):s&&(this.uniforms=et.rDY.clone(s.uniforms),this.material=new et.jyz({defines:Object.assign({},s.defines),uniforms:this.uniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader})),this.fsQuad=new bt(this.material),this.useExistingRenderTarget=!1}render(s,o,a){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=a.texture),this.fsQuad.material=this.material,this.renderToScreen?(s.setRenderTarget(null),this.fsQuad.render(s)):(this.useExistingRenderTarget||s.setRenderTarget(o),this.clear&&s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil),this.fsQuad.render(s))}}class jt extends dt{constructor(s,o){super(),this.scene=s,this.camera=o,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(s,o,a){const _e=s.getContext(),rt=s.state;let nt,ot;rt.buffers.color.setMask(!1),rt.buffers.depth.setMask(!1),rt.buffers.color.setLocked(!0),rt.buffers.depth.setLocked(!0),this.inverse?(nt=0,ot=1):(nt=1,ot=0),rt.buffers.stencil.setTest(!0),rt.buffers.stencil.setOp(_e.REPLACE,_e.REPLACE,_e.REPLACE),rt.buffers.stencil.setFunc(_e.ALWAYS,nt,4294967295),rt.buffers.stencil.setClear(ot),rt.buffers.stencil.setLocked(!0),s.setRenderTarget(a),this.clear&&s.clear(),s.render(this.scene,this.camera),s.setRenderTarget(o),this.clear&&s.clear(),s.render(this.scene,this.camera),rt.buffers.color.setLocked(!1),rt.buffers.depth.setLocked(!1),rt.buffers.stencil.setLocked(!1),rt.buffers.stencil.setFunc(_e.EQUAL,1,4294967295),rt.buffers.stencil.setOp(_e.KEEP,_e.KEEP,_e.KEEP),rt.buffers.stencil.setLocked(!0)}}class Vt extends dt{constructor(){super(),this.needsSwap=!1}render(s){s.state.buffers.stencil.setLocked(!1),s.state.buffers.stencil.setTest(!1)}}new et.iKG(-1,1,1,-1,0,1);const zt=new et.u9r;zt.setAttribute("position",new et.a$l([-1,3,0,-1,-1,0,3,-1,0],3)),zt.setAttribute("uv",new et.a$l([0,2,0,0,2,0],2));class Jt extends class{constructor(s,o){if(this.renderer=s,o===void 0){const a=s.getSize(new et.FM8);this._pixelRatio=s.getPixelRatio(),this._width=a.width,this._height=a.height,(o=new et.dd2(this._width*this._pixelRatio,this._height*this._pixelRatio)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=o.width,this._height=o.height;this.renderTarget1=o,this.renderTarget2=o.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],ut===void 0&&console.error("THREE.EffectComposer relies on CopyShader"),Rt===void 0&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new Rt(ut),this.clock=new et.SUY}swapBuffers(){const s=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=s}addPass(s){this.passes.push(s),s.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(s,o){this.passes.splice(o,0,s),s.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(s){const o=this.passes.indexOf(s);o!==-1&&this.passes.splice(o,1)}isLastEnabledPass(s){for(let o=s+1;o<this.passes.length;o++)if(this.passes[o].enabled)return!1;return!0}render(s){s===void 0&&(s=this.clock.getDelta());const o=this.renderer.getRenderTarget();let a=!1;for(let _e=0,rt=this.passes.length;_e<rt;_e++){const nt=this.passes[_e];if(nt.enabled!==!1){if(nt.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(_e),nt.render(this.renderer,this.writeBuffer,this.readBuffer,s,a),nt.needsSwap){if(a){const ot=this.renderer.getContext(),ct=this.renderer.state.buffers.stencil;ct.setFunc(ot.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,s),ct.setFunc(ot.EQUAL,1,4294967295)}this.swapBuffers()}jt!==void 0&&(nt instanceof jt?a=!0:nt instanceof Vt&&(a=!1))}}this.renderer.setRenderTarget(o)}reset(s){if(s===void 0){const o=this.renderer.getSize(new et.FM8);this._pixelRatio=this.renderer.getPixelRatio(),this._width=o.width,this._height=o.height,(s=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=s,this.renderTarget2=s.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(s,o){this._width=s,this._height=o;const a=this._width*this._pixelRatio,_e=this._height*this._pixelRatio;this.renderTarget1.setSize(a,_e),this.renderTarget2.setSize(a,_e);for(let rt=0;rt<this.passes.length;rt++)this.passes[rt].setSize(a,_e)}setPixelRatio(s){this._pixelRatio=s,this.setSize(this._width,this._height)}}{constructor(s,o){super(s,o)}setPixelRatio(s,o=!0){const a=this.setSize;o||(this.setSize=()=>{}),super.setPixelRatio(s),o||(this.setSize=a)}}function rr(tt,s){let o;do o=Object.getOwnPropertyDescriptor(tt,s);while(!o&&(tt=Object.getPrototypeOf(tt)));return o}function Yt(tt,s,o=!1,a=!1){const _e=rr(tt,s);return!!(_e!=null&&_e.set)||o&&(_e==null?void 0:_e.writable)!==!1&&(_e==null?void 0:_e.get)===void 0||a&&!_e}function dr(tt,s,o,a=!1,_e=!1){return!(!tt||!Yt(tt,s,a,_e)||(tt[s]=o,0))}function Ft(tt,s){for(;tt.length>0;){if(!s)return;const o=tt.splice(0,1)[0];if(!(o.length<1)){if(!(o in s))return console.error("invalid access, check",o,s),s;s=s[o]}}return s}function Ht(tt,s){return Object.keys(tt).find(o=>tt[o]===s)}function er(tt,...s){return typeof tt=="function"&&(tt=tt(...s)),tt}function pr(tt,s,o){for(const a of o){const _e=tt[a];_e!==void 0&&dr(s,a,_e,!0)}}function or(tt){return tt.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")}function ar(tt,s,o){return tt.replace(new RegExp(or(s),"g"),o)}const Wt=(tt,...s)=>String.raw({raw:tt},...s),Zt=(tt,...s)=>String.raw({raw:tt},...s),sr=(tt,...s)=>String.raw({raw:tt},...s),tr=(tt,...s)=>{let o=String.raw({raw:tt},...s);return o=ar(o,"%","%25"),o=ar(o,"> <","><"),o=ar(o,"; }",";}"),o=ar(o,"<","%3c"),o=ar(o,">","%3e"),o=ar(o,'"',"'"),o=ar(o,"#","%23"),o=ar(o,"{","%7b"),o=ar(o,"}","%7d"),o=ar(o,"|","%7c"),o=ar(o,"^","%5e"),o=ar(o,"`","%60"),o=ar(o,"@","%40"),o=ar(o,"&","&amp;"),o=ar(o,`
`,"%0A"),"data:image/svg+xml;charset=UTF-8,"+o};function vr(tt){if(!tt)throw new Error("onChange: fnKey is undefined, make sure the function exists or provide a string");return(s,o)=>{let a=s[o];Object.defineProperty(s,o,{get:()=>a,set(_e){var rt;if(a===_e)return;a=_e;const nt=[o,_e];if(typeof tt=="string")(rt=this[tt])===null||rt===void 0||rt.call(this,...nt);else if(typeof tt=="function"){let ot=!1;if(tt.name){let ct=this;for(;ct;){if(ct[tt.name]===tt){tt.call(this,...nt),ot=!0;break}ct=Object.getPrototypeOf(ct)}}ot||(tt.name&&this[tt.name].name===`bound ${tt.name}`?this[tt.name](...nt):tt(...nt))}}})}}function Vr(tt,s){for(const o of s)if(!tt.includes(o))return!1;return!0}String.prototype.replaceAll||(String.prototype.replaceAll=function(tt,s){return Object.prototype.toString.call(tt).toLowerCase()==="[object regexp]"?this.replace(tt,s):this.replace(new RegExp(tt,"g"),s)});class hn{constructor(s=0,o=0){hn.prototype.isVector2=!0,this.x=s,this.y=o}get width(){return this.x}set width(s){this.x=s}get height(){return this.y}set height(s){this.y=s}set(s,o){return this.x=s,this.y=o,this}setScalar(s){return this.x=s,this.y=s,this}setX(s){return this.x=s,this}setY(s){return this.y=s,this}setComponent(s,o){switch(s){case 0:this.x=o;break;case 1:this.y=o;break;default:throw new Error("index is out of range: "+s)}return this}getComponent(s){switch(s){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+s)}}clone(){return new this.constructor(this.x,this.y)}copy(s){return this.x=s.x,this.y=s.y,this}add(s){return this.x+=s.x,this.y+=s.y,this}addScalar(s){return this.x+=s,this.y+=s,this}addVectors(s,o){return this.x=s.x+o.x,this.y=s.y+o.y,this}addScaledVector(s,o){return this.x+=s.x*o,this.y+=s.y*o,this}sub(s){return this.x-=s.x,this.y-=s.y,this}subScalar(s){return this.x-=s,this.y-=s,this}subVectors(s,o){return this.x=s.x-o.x,this.y=s.y-o.y,this}multiply(s){return this.x*=s.x,this.y*=s.y,this}multiplyScalar(s){return this.x*=s,this.y*=s,this}divide(s){return this.x/=s.x,this.y/=s.y,this}divideScalar(s){return this.multiplyScalar(1/s)}applyMatrix3(s){const o=this.x,a=this.y,_e=s.elements;return this.x=_e[0]*o+_e[3]*a+_e[6],this.y=_e[1]*o+_e[4]*a+_e[7],this}min(s){return this.x=Math.min(this.x,s.x),this.y=Math.min(this.y,s.y),this}max(s){return this.x=Math.max(this.x,s.x),this.y=Math.max(this.y,s.y),this}clamp(s,o){return this.x=Math.max(s.x,Math.min(o.x,this.x)),this.y=Math.max(s.y,Math.min(o.y,this.y)),this}clampScalar(s,o){return this.x=Math.max(s,Math.min(o,this.x)),this.y=Math.max(s,Math.min(o,this.y)),this}clampLength(s,o){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(s,Math.min(o,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(s){return this.x*s.x+this.y*s.y}cross(s){return this.x*s.y-this.y*s.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(s){return Math.sqrt(this.distanceToSquared(s))}distanceToSquared(s){const o=this.x-s.x,a=this.y-s.y;return o*o+a*a}manhattanDistanceTo(s){return Math.abs(this.x-s.x)+Math.abs(this.y-s.y)}setLength(s){return this.normalize().multiplyScalar(s)}lerp(s,o){return this.x+=(s.x-this.x)*o,this.y+=(s.y-this.y)*o,this}lerpVectors(s,o,a){return this.x=s.x+(o.x-s.x)*a,this.y=s.y+(o.y-s.y)*a,this}equals(s){return s.x===this.x&&s.y===this.y}fromArray(s,o=0){return this.x=s[o],this.y=s[o+1],this}toArray(s=[],o=0){return s[o]=this.x,s[o+1]=this.y,s}fromBufferAttribute(s,o){return this.x=s.getX(o),this.y=s.getY(o),this}rotateAround(s,o){const a=Math.cos(o),_e=Math.sin(o),rt=this.x-s.x,nt=this.y-s.y;return this.x=rt*a-nt*_e+s.x,this.y=rt*_e+nt*a+s.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class cn extends et.ZzF{expandByObject(s,o=!1,a=!1){var _e;if(((_e=s.userData)===null||_e===void 0?void 0:_e.bboxVisible)===!1)return this;if(!s.visible&&a)return this;s.updateWorldMatrix(!1,!1);const rt=s.geometry;if(rt!==void 0)if(o&&rt.attributes!=null&&rt.attributes.position!==void 0){const ot=rt.attributes.position;for(let ct=0,pt=ot.count;ct<pt;ct++)tn.fromBufferAttribute(ot,ct).applyMatrix4(s.matrixWorld),this.expandByPoint(tn)}else rt.boundingBox===null&&rt.computeBoundingBox(),gn.copy(rt.boundingBox),gn.applyMatrix4(s.matrixWorld),this.union(gn);const nt=s.children;for(let ot=0,ct=nt.length;ot<ct;ot++)this.expandByObject(nt[ot],o,a);return this}expandByObjects(s,o=!1,a=!1){for(let _e=0,rt=s.length;_e<rt;_e++)this.expandByObject(s[_e],o,a);return this}getPoints(){return[new et.Pa4(this.min.x,this.min.y,this.min.z),new et.Pa4(this.min.x,this.min.y,this.max.z),new et.Pa4(this.min.x,this.max.y,this.min.z),new et.Pa4(this.min.x,this.max.y,this.max.z),new et.Pa4(this.max.x,this.min.y,this.min.z),new et.Pa4(this.max.x,this.min.y,this.max.z),new et.Pa4(this.max.x,this.max.y,this.min.z),new et.Pa4(this.max.x,this.max.y,this.max.z)]}getScreenSpaceBounds(s){const o=this.getPoints(),a=new et.TUj;for(const _e of o){const rt=_e.project(s);a.min.min(rt),a.max.max(rt)}return a}}const gn=new cn,tn=new et.Pa4;function Tn(tt,s){let o,a;if(Array.isArray(tt))for(const rt of tt){const nt=Tn(rt,s);o===void 0||a===void 0?(o=nt.min.clone(),a=nt.max.clone()):(o.min(nt.min),a.max(nt.max))}const _e=tt;if(_e.geometry!==void 0){const rt=_e.geometry.vertices;if(rt===void 0&&_e.geometry.attributes!==void 0&&"position"in _e.geometry.attributes){const nt=new et.Pa4,ot=_e.geometry.attributes.position;for(let ct=0;ct<ot.count*ot.itemSize;ct+=ot.itemSize){nt.set(ot.array[ct],ot.array[ct+1],ot.array[3]);const pt=nt.applyMatrix4(tt.matrixWorld).project(s),ht=new hn(pt.x,pt.y);o===void 0||a===void 0?(o=ht.clone(),a=ht.clone()):(o.min(ht),a.max(ht))}}else for(const nt of rt){const ot=nt.clone().applyMatrix4(tt.matrixWorld).project(s),ct=new hn(ot.x,ot.y);o===void 0||a===void 0?(o=ct.clone(),a=ct.clone()):(o.min(ct),a.max(ct))}}if(tt.children!==void 0)for(const rt of tt.children){const nt=Tn(rt,s);o===void 0||a===void 0?(o=nt.min.clone(),a=nt.max.clone()):(o.min(nt.min),a.max(nt.max))}return new et.TUj(o,a)}const qr=3005;function nn(tt){switch(tt){case et.rnI:return["Linear","( value )"];case et.knz:return["sRGB","( value )"];case qr:return["RGBM","( value, 16.0 )"];default:return console.warn("utils: Unsupported encoding:",tt),["Linear","( value )"]}}function yr(tt,s){let o;return tt&&tt.isTexture?o=tt.encoding:tt&&tt.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),o=tt.texture.encoding):o=et.rnI,s&&tt&&tt.isTexture&&tt.format===et.wk1&&tt.type===et.ywz&&tt.encoding===et.knz&&(o=et.rnI),o}function an(tt,s){const o=nn(s);return"vec4 "+tt+"( vec4 value ) { return "+o[0]+"ToLinear"+o[1]+"; }"}function sn(tt,s,o){return an(tt+"TexelToLinear",yr(s,o))+`
`}function Rn(tt,s){return an(tt+"TexelToLinear",s)+`
`}function Jr(tt,s){const o=nn(s);return"vec4 "+tt+"( vec4 value ) { return LinearTo"+o[0]+o[1]+"; }"}function mr(tt,s,o){return Jr(tt,yr(s,o))}function Ar({uniforms:tt,propKey:s,thisTarget:o=!1}={}){const a=!!tt,_e=!!s,rt=o;return(nt,ot)=>{const ct=pt=>{const ht=rt?pt:a?tt:pt.uniforms||pt._uniforms;let _t=_e?s:ot;rt&&(_t="_"+_t);let Et=ht[_t];return Et||(Et={value:null},ht[_t]=Et),Et};Object.defineProperty(nt,ot,{get(){return ct(this).value},set(pt){ct(this).value=pt,dr(this,"uniformsNeedUpdate",!0,!0)}})}}function jr(tt,s,o=!1,a){const _e=!!s,rt=!!tt;return(nt,ot)=>{const ct=pt=>({t:_e?s:pt.defines||pt._defines,p:rt?tt:ot});Object.defineProperty(nt,ot,{get(){const{t:pt,p:ht}=ct(o?this:this.material);return pt[ht]},set(pt){const{t:ht,p:_t}=ct(o?this:this.material);if(dr(ht,_t,pt,!0),typeof a=="function"){const Et=[_t,pt];if(a.name){const St=this[a.name];St===a?a.call(this,...Et):St.name===`bound ${a.name}`?St(...Et):a(...Et)}else a(...Et)}else dr(o?this:this.material,"needsUpdate",!0,!0)}})}}function On(tt){const s=new et.IEO(new Uint8Array([Math.floor(255*tt.r),Math.floor(255*tt.g),Math.floor(255*tt.b),255]),1,1,et.wk1,et.ywz);return s.needsUpdate=!0,s.encoding=et.rnI,s}function $n(tt){const s=new et.IEO(new Uint8Array([Math.floor(255*tt.x),Math.floor(255*tt.y),Math.floor(255*tt.z),Math.floor(255*tt.w)]),1,1,et.wk1,et.ywz);return s.needsUpdate=!0,s}function jn(tt,s,o){const a=tt.userData,{backgroundRender:_e,transparentRender:rt,shadowMapRender:nt,mainRenderPass:ot,opaqueRender:ct,transmissionRender:pt,sceneRender:ht,screenSpaceRendering:_t}=a;s.backgroundRender!==void 0&&(a.backgroundRender=s.backgroundRender),s.transparentRender!==void 0&&(a.transparentRender=s.transparentRender),s.shadowMapRender!==void 0&&(a.shadowMapRender=s.shadowMapRender),s.mainRenderPass!==void 0&&(a.mainRenderPass=s.mainRenderPass),s.opaqueRender!==void 0&&(a.opaqueRender=s.opaqueRender),s.sceneRender!==void 0&&(a.sceneRender=s.sceneRender),s.transmissionRender!==void 0&&(a.transmissionRender=s.transmissionRender),s.screenSpaceRendering!==void 0&&(a.screenSpaceRendering=s.screenSpaceRendering),o(),a.backgroundRender=_e,a.transparentRender=rt,a.shadowMapRender=nt,a.mainRenderPass=ot,a.opaqueRender=ct,a.sceneRender=ht,a.transmissionRender=pt,a.screenSpaceRendering=_t}function As(tt){const s=new cn().expandByObject(tt,!0,!0).getCenter(new et.Pa4);tt.position.sub(s),tt.updateMatrix(),tt.userData.autoCentered=!0}function ps(tt,s){const o=.5*new cn().expandByObject(tt,!0,!0).getSize(new et.Pa4).length();s===void 0&&(s=tt.userData.autoScaleRadius||1);const a=s/o;return isFinite(a)&&(tt.userData.pseudoCentered?tt.children.forEach(_e=>{_e.scale.multiplyScalar(a)}):tt.scale.multiplyScalar(a)),tt.traverse(_e=>{var rt,nt;_e.isLight&&(!((nt=(rt=_e.shadow)===null||rt===void 0?void 0:rt.camera)===null||nt===void 0)&&nt.right)&&(_e.shadow.camera.right*=a,_e.shadow.camera.left*=a,_e.shadow.camera.top*=a,_e.shadow.camera.bottom*=a),_e.isCamera&&_e.right&&(_e.right*=a,_e.left*=a,_e.top*=a,_e.bottom*=a)}),tt.userData.autoScaled=!0,tt.userData.autoScaleRadius=s,tt.dispatchEvent({type:"objectUpdate"}),tt}function qs(tt,s=-1){return function(o,a=1e-4){const _e=a>0;a=Math.max(a,Number.EPSILON);const rt={},nt=o.getIndex(),ot=o.getAttribute("position"),ct=nt?nt.count:ot.count;let pt=0;const ht=Object.keys(o.attributes),_t={},Et={},St=[],Mt=["getX","getY","getZ","getW"];for(let kt=0,Pt=ht.length;kt<Pt;kt++){const qt=ht[kt];_t[qt]=[];const Kt=o.morphAttributes[qt];Kt&&(Et[qt]=new Array(Kt.length).fill().map(()=>[]))}const It=Math.log10(1/a),Nt=Math.pow(10,It);for(let kt=0;kt<ct;kt++){const Pt=nt?nt.getX(kt):kt;let qt="";for(let Kt=0,nr=ht.length;Kt<nr&&_e;Kt++){const ir=ht[Kt],fr=o.getAttribute(ir),br=fr.itemSize;for(let Tr=0;Tr<br;Tr++)qt+=~~(fr[Mt[Tr]](Pt)*Nt)+","}if(_e&&qt in rt)St.push(rt[qt]);else{for(let Kt=0,nr=ht.length;Kt<nr;Kt++){const ir=ht[Kt],fr=o.getAttribute(ir),br=o.morphAttributes[ir],Tr=fr.itemSize,Dr=_t[ir],Rr=Et[ir];for(let Nr=0;Nr<Tr;Nr++){const Ir=Mt[Nr];if(Dr.push(fr[Ir](Pt)),br)for(let kr=0,Hr=br.length;kr<Hr;kr++)Rr[kr].push(br[kr][Ir](Pt))}}_e&&(rt[qt]=pt),St.push(pt),pt++}}const Bt=o.clone();for(let kt=0,Pt=ht.length;kt<Pt;kt++){const qt=ht[kt],Kt=o.getAttribute(qt),nr=new Kt.array.constructor(_t[qt]),ir=new et.TlE(nr,Kt.itemSize,Kt.normalized);if(Bt.setAttribute(qt,ir),qt in Et)for(let fr=0;fr<Et[qt].length;fr++){const br=o.morphAttributes[qt][fr],Tr=new br.array.constructor(Et[qt][fr]),Dr=new et.TlE(Tr,br.itemSize,br.normalized);Bt.morphAttributes[qt][fr]=Dr}}return Bt.setIndex(St),Bt}(tt,s)}class Vs extends it{constructor({animationLoop:s,canvas:o,alpha:a=!0,targetOptions:_e}){super(),this._isWebGL2=!1,this._trackedTargets=[],this.dirty=!0,this._lastTime=0,this.frameWaitTime=0,this._passes=[],this._pipeline=[],this._passesNeedsUpdate=!0,this._displayCanvasScaling=1,this._renderSize=new et.FM8(512,512),this._frameCount=0,this._tempTargets={},this.maxTempPerKey=5,this._animationLoop=this._animationLoop.bind(this),this._processNewTarget=this._processNewTarget.bind(this),this._processNewTempTarget=this._processNewTempTarget.bind(this),this.trackTarget=this.trackTarget.bind(this),this.disposeTarget=this.disposeTarget.bind(this),this.createTarget=this.createTarget.bind(this),this.createTargetCustom=this.createTargetCustom.bind(this),this._renderer=new et.CP7({canvas:o,antialias:!0,alpha:a,premultipliedAlpha:!1,preserveDrawingBuffer:!0}),this._renderer.baseRenderer=this,this._renderer.setAnimationLoop(this._animationLoop),this._context=this._renderer.getContext(),this._isWebGL2=this._renderer.capabilities.isWebGL2,this._renderSize=new et.FM8(o.clientWidth,o.clientHeight),this._renderer.setSize(this._renderSize.width,this._renderSize.height,!1),this._renderer.setPixelRatio(this._displayCanvasScaling),this._renderer.toneMapping=et.uL9,this._renderer.toneMappingExposure=1,this._renderer.outputEncoding=et.rnI,this._renderer.shadowMap.enabled=!0,this._renderer.shadowMap.type=et._iA,this._renderer.shadowMap.autoUpdate=!1,this.resetShadows(),this._composerTarget=this.createTarget(_e,!1),this._composerTarget.texture.name="EffectComposer.rt1",this._composer=new Jt(this._renderer,this._composerTarget),s&&this.addEventListener("animationLoop",s)}get composer(){return this._composer}get passes(){return this._passes}get isWebGL2(){return this._isWebGL2}get composerTarget(){return this._composerTarget}get renderSize(){return this._renderSize}get displayCanvasScaling(){return this._displayCanvasScaling}set displayCanvasScaling(s){s!==this._displayCanvasScaling&&(this._displayCanvasScaling=s,this.setSize(void 0,void 0,!0))}get frameCount(){return this._frameCount}set pipeline(s){this._pipeline=s,this._passesNeedsUpdate=!0}get pipeline(){return this._pipeline}refreshPipeline(){var s,o,a;const _e=this._passes,rt=[],nt={};for(const ot of _e){if(ot.enabled===!1)continue;const ct={after:(s=ot.after)!==null&&s!==void 0?s:[],before:(o=ot.before)!==null&&o!==void 0?o:[],dependencies:new Set((a=ot.required)!==null&&a!==void 0?a:[])};nt[ot.passId]=ct}for(const[ot,ct]of Object.entries(nt)){const pt=new Set([...ct.after,...ct.before]);ct.dependencies.forEach(ht=>pt.has(ht)&&pt.delete(ht)),pt.forEach(ht=>{const _t=nt[ht];if(_t){if(_t.dependencies.has(ot))throw console.error("cyclic",ot,ht),"Cyclic dependency";ct.dependencies.add(ht)}})}for(;;){let ot=!1;const ct=[...Object.entries(nt)];for(const[pt,ht]of ct)if(!rt.includes(pt)&&Vr(rt,ht.dependencies.values())){const _t=Math.max(-1,...ht.after.map(St=>rt.indexOf(St))),Et=Math.min(rt.length,...ht.before.map(St=>{const Mt=rt.indexOf(St);return Mt<0?rt.length:Mt}));if(_t>=Et)throw console.error(ht,_e,rt,_t,Et),"Not possible";rt.splice(ht.after.length>0?_t+1:Et,0,pt),ot=!0,delete nt[pt]}if(Object.keys(nt).length<1)break;if(!ot)throw console.log(ct,nt,rt),"Not possible 2"}return this.pipeline=rt,this.pipeline}get context(){return this._context}get rendererObject(){return this._renderer}_animationLoop(s,o){const a=s-this._lastTime;this._lastTime=s,this.frameWaitTime-=a,this.frameWaitTime>0||(this.frameWaitTime=0,this.dispatchEvent({type:"animationLoop",deltaTime:a,time:s,renderer:this,xrFrame:o}))}get clock(){return this._composer.clock}registerPass(s,o=!0){var a;if(o)for(const _e of[...this._passes])s.passId===_e.passId&&this.unregisterPass(_e);this._passes.push(s),(a=s.onRegister)===null||a===void 0||a.call(s,this),this._passesNeedsUpdate=!0,this._updated()}unregisterPass(s){var o;const a=this._passes.indexOf(s);a>=0&&((o=s.onUnregister)===null||o===void 0||o.call(s,this),this._passes.splice(a,1),this._passesNeedsUpdate=!0,this._updated())}setSize(s,o,a=!1){!a&&(s?Math.abs(s-this._renderSize.width):0)+(o?Math.abs(o-this._renderSize.height):0)<.1||(s&&(this._renderSize.width=s),o&&(this._renderSize.height=o),this.rendererObject.xr.enabled||(this._renderer.setSize(this._renderSize.width,this._renderSize.height,!1),this._renderer.setPixelRatio(this._displayCanvasScaling)),this._composer.setPixelRatio(this._displayCanvasScaling,!1),this._composer.setSize(this._renderSize.width,this._renderSize.height),this._trackedTargets.forEach(_e=>{const rt=_e,nt=rt.sizeMultiplier;if(nt){const ot=this._renderSize.clone().multiplyScalar(this._displayCanvasScaling*nt);rt.setSize(ot.width,ot.height)}}),this.dispatchEvent({type:"resize"}),this._updated(),this.reset())}blit(s,o,{viewport:a,material:_e,shader:rt,pass:nt,clear:ot=!0}={}){const ct=this._composer.copyPass,{renderToScreen:pt,material:ht,uniforms:_t,clear:Et}=ct;_e&&(ct.material=_e);const St=this._renderer.getViewport(new et.Ltg),Mt=this._renderer.autoClear,It=this._renderer.getRenderTarget();a&&this._renderer.setViewport(new et.Ltg().fromArray(a)),this._renderer.autoClear=!1,ct.uniforms=ct.material.uniforms,ct.renderToScreen=!1,ct.clear=ot,jn(this._renderer,{sceneRender:!0,opaqueRender:!0,shadowMapRender:!1,backgroundRender:!1,transparentRender:!0,transmissionRender:!1},()=>{ct.render(this._renderer,o??null,{texture:s},0,!1)}),ct.renderToScreen=pt,ct.clear=Et,ct.material=ht,ct.uniforms=_t,this._renderer.autoClear=Mt,a&&this._renderer.setViewport(St),this._renderer.setRenderTarget(It)}clearColor({r:s,g:o,b:a,a:_e,target:rt,depth:nt=!0,stencil:ot=!0}){var ct;const pt=this._renderer.getClearColor(new et.Ilk),ht=this._renderer.getClearAlpha();this._renderer.setClearAlpha(_e??ht),this._renderer.setClearColor(new et.Ilk(s??pt.r,o??pt.g,a??pt.b));const _t=this._renderer.getRenderTarget(),Et=this._renderer.getActiveCubeFace(),St=this._renderer.getActiveMipmapLevel();this._renderer.setRenderTarget((ct=rt)!==null&&ct!==void 0?ct:null),this._renderer.clear(!0,nt,ot),this._renderer.setRenderTarget(_t,Et,St),this._renderer.setClearColor(pt),this._renderer.setClearAlpha(ht)}renderModel(s,o){this._renderer.render(s.modelObject,o.cameraObject)}renderScene(s){const o=s.activeCamera;o&&this.renderModel(s,o)}_updated(){this.dispatchEvent({type:"update"})}render(){var s;this._passesNeedsUpdate&&this.refreshPasses();for(const o of this._passes)o.passObject.enabled&&((s=o.update)===null||s===void 0||s.call(o));this._composer.render(),this._frameCount+=1,this.dirty=!1}updateDirty(){this.dirty=this.dirty||this._passes.findIndex(s=>s.dirty)>=0}reset(){this._frameCount=0,this.dirty=!0}resetShadows(){this._renderer.shadowMap.needsUpdate=!0}refreshPasses(){if(!this._passesNeedsUpdate)return;this._passesNeedsUpdate=!1;const s=[];for(const o of this._pipeline){const a=this._passes.find(_e=>_e.passId===o);a?s.push(a.passObject):console.warn("Unable to find pass: ",o)}[...this._composer.passes].forEach(o=>this._composer.removePass(o)),s.forEach(o=>this._composer.addPass(o)),this._updated()}dispose(){this._renderer.dispose()}trackTarget(s){this._trackedTargets.push(s)}removeTrackedTarget(s){const o=this._trackedTargets.indexOf(s);o>=0&&this._trackedTargets.splice(o,1)}createTarget({sizeMultiplier:s,samples:o=0,encoding:a=et.rnI,type:_e=et.ywz,format:rt=et.wk1,depthBuffer:nt=!0,depthTexture:ot=!1,size:ct,textureCount:pt=1,...ht}={},_t=!0){this.isWebGL2||(o=0),s!==void 0&&ct!==void 0&&console.error("Both sizeMultiplier and size are defined. sizeMultiplier will be ignored."),ct=ct||this._renderSize.clone().multiplyScalar(this._displayCanvasScaling*(s=s||1));const Et=ot?new et.$YQ(ct.width,ct.height,et.ywz):void 0,St=this.createTargetCustom(pt>1?{width:ct.width,height:ct.height,count:pt}:ct,{samples:o,encoding:a,type:_e,format:rt,depthBuffer:nt,depthTexture:Et},pt>1?et.kFz:et.dd2);return this._processNewTarget(St,s,_t),this._setTargetOptions(St,ht),St}_processNewTarget(s,o,a){return o!==void 0&&(s.sizeMultiplier=o),a&&this.trackTarget(s),s}disposeTarget(s){if(s){if(s.isTemporary)return this.releaseTempTarget(s);this.removeTrackedTarget(s),s.dispose()}}createTargetCustom({width:s,height:o,count:a},_e={},rt){var nt;const ot=this._processNewTarget;let ct=[s,o];if(a&&a>1&&ct.push(a),(rt==null?void 0:rt.prototype)===et.oAp.prototype){if(s!==o)throw"Width and height of cube render target must be equal";ct=[s]}_e={format:et.wk1,minFilter:et.wem,magFilter:et.wem,generateMipmaps:!1,type:et.ywz,encoding:et.rnI,..._e};const pt=[...ct,_e];return new class extends((nt=rt)!==null&&nt!==void 0?nt:et.dd2){constructor(...ht){super(...ht),Array.isArray(this.texture)?this.texture.forEach(_t=>{_t.encoding=_e.encoding,_t.toJSON=()=>({})}):this.texture.toJSON=()=>({})}clone(ht=!0){if(this.isTemporary)throw"Cloning temporary render targets not supported";if(Array.isArray(this.texture))throw"Cloning multiple render targets not supported";const _t=super.clone();return _t.texture.isRenderTargetTexture=!0,ot(_t,this.sizeMultiplier||1,ht)}}(...pt)}getTempTarget(s={}){var o;const a=Eo(s);let _e;return!((o=this._tempTargets[a])===null||o===void 0)&&o.length&&(_e=this._tempTargets[a].pop()),_e?this._setTargetOptions(_e,s):(_e=this.createTarget(s),this._processNewTempTarget(_e,a)),_e}_processNewTempTarget(s,o){return s.isTemporary=!0,s.targetKey=o,this._tempTargets[o]===void 0&&(this._tempTargets[o]=[]),s}releaseTempTarget(s){const o=s.targetKey;if(!o||!s.isTemporary)throw"Not a temp target";this._tempTargets[o].length>this.maxTempPerKey?s.dispose():this._tempTargets[o].push(s)}updateShaderProperties(s){return s.uniforms.frameCount?s.uniforms.frameCount.value=this.frameCount:console.warn("BaseRenderer: no uniform: frameCount"),this}_setTargetOptions(s,o){var a,_e,rt;s.texture.minFilter=(a=o.minFilter)!==null&&a!==void 0?a:et.wem,s.texture.magFilter=(_e=o.magFilter)!==null&&_e!==void 0?_e:et.wem,s.texture.generateMipmaps=(rt=o.generateMipmaps)!==null&&rt!==void 0&&rt,s.texture.generateMipmaps&&s.texture.minFilter===et.wem&&(s.texture.minFilter=et.FDw),s.texture.generateMipmaps||s.texture.minFilter!==et.FDw||(s.texture.minFilter=et.wem)}}function Eo(tt={}){var s,o;return[tt.sizeMultiplier,tt.samples,tt.encoding,tt.type,tt.format,tt.depthBuffer,tt.depthTexture,(s=tt.size)===null||s===void 0?void 0:s.width,(o=tt.size)===null||o===void 0?void 0:o.height].join(";")}const js=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function mn(){const tt=4294967295*Math.random()|0,s=4294967295*Math.random()|0,o=4294967295*Math.random()|0,a=4294967295*Math.random()|0;return(js[255&tt]+js[tt>>8&255]+js[tt>>16&255]+js[tt>>24&255]+"-"+js[255&s]+js[s>>8&255]+"-"+js[s>>16&15|64]+js[s>>24&255]+"-"+js[63&o|128]+js[o>>8&255]+"-"+js[o>>16&255]+js[o>>24&255]+js[255&a]+js[a>>8&255]+js[a>>16&255]+js[a>>24&255]).toLowerCase()}function uo(tt,s,o){return Math.max(s,Math.min(o,tt))}function _o(tt,s,o){return(1-o)*tt+o*s}const Vl=0,Vo=1,Oo=3,Lo=4,No=1006,eu="srgb",So="srgb-linear";function co(tt){return tt<.04045?.0773993808*tt:Math.pow(.9478672986*tt+.0521327014,2.4)}function Il(tt){return tt<.0031308?12.92*tt:1.055*Math.pow(tt,.41666)-.055}const ga={[eu]:{[So]:co},[So]:{[eu]:Il}},Go={legacyMode:!0,get workingColorSpace(){return So},set workingColorSpace(tt){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(tt,s,o){if(this.legacyMode||s===o||!s||!o)return tt;if(ga[s]&&ga[s][o]!==void 0){const a=ga[s][o];return tt.r=a(tt.r),tt.g=a(tt.g),tt.b=a(tt.b),tt}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(tt,s){return this.convert(tt,this.workingColorSpace,s)},toWorkingColorSpace:function(tt,s){return this.convert(tt,s,this.workingColorSpace)}},Up={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ba={r:0,g:0,b:0},bu={h:0,s:0,l:0},Ko={h:0,s:0,l:0};function Lu(tt,s,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?tt+6*(s-tt)*o:o<.5?s:o<2/3?tt+6*(s-tt)*(2/3-o):tt}function $p(tt,s){return s.r=tt.r,s.g=tt.g,s.b=tt.b,s}class ys{constructor(s,o,a){return this.isColor=!0,this.r=1,this.g=1,this.b=1,o===void 0&&a===void 0?this.set(s):this.setRGB(s,o,a)}set(s){return s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s),this}setScalar(s){return this.r=s,this.g=s,this.b=s,this}setHex(s,o="srgb"){return s=Math.floor(s),this.r=(s>>16&255)/255,this.g=(s>>8&255)/255,this.b=(255&s)/255,Go.toWorkingColorSpace(this,o),this}setRGB(s,o,a,_e="srgb-linear"){return this.r=s,this.g=o,this.b=a,Go.toWorkingColorSpace(this,_e),this}setHSL(s,o,a,_e="srgb-linear"){if(s=function(rt,nt){return(rt%nt+nt)%nt}(s,1),o=uo(o,0,1),a=uo(a,0,1),o===0)this.r=this.g=this.b=a;else{const rt=a<=.5?a*(1+o):a+o-a*o,nt=2*a-rt;this.r=Lu(nt,rt,s+1/3),this.g=Lu(nt,rt,s),this.b=Lu(nt,rt,s-1/3)}return Go.toWorkingColorSpace(this,_e),this}setStyle(s,o="srgb"){function a(rt){rt!==void 0&&parseFloat(rt)<1&&console.warn("THREE.Color: Alpha component of "+s+" will be ignored.")}let _e;if(_e=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(s)){let rt;const nt=_e[1],ot=_e[2];switch(nt){case"rgb":case"rgba":if(rt=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(ot))return this.r=Math.min(255,parseInt(rt[1],10))/255,this.g=Math.min(255,parseInt(rt[2],10))/255,this.b=Math.min(255,parseInt(rt[3],10))/255,Go.toWorkingColorSpace(this,o),a(rt[4]),this;if(rt=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(ot))return this.r=Math.min(100,parseInt(rt[1],10))/100,this.g=Math.min(100,parseInt(rt[2],10))/100,this.b=Math.min(100,parseInt(rt[3],10))/100,Go.toWorkingColorSpace(this,o),a(rt[4]),this;break;case"hsl":case"hsla":if(rt=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(ot)){const ct=parseFloat(rt[1])/360,pt=parseFloat(rt[2])/100,ht=parseFloat(rt[3])/100;return a(rt[4]),this.setHSL(ct,pt,ht,o)}}}else if(_e=/^\#([A-Fa-f\d]+)$/.exec(s)){const rt=_e[1],nt=rt.length;if(nt===3)return this.r=parseInt(rt.charAt(0)+rt.charAt(0),16)/255,this.g=parseInt(rt.charAt(1)+rt.charAt(1),16)/255,this.b=parseInt(rt.charAt(2)+rt.charAt(2),16)/255,Go.toWorkingColorSpace(this,o),this;if(nt===6)return this.r=parseInt(rt.charAt(0)+rt.charAt(1),16)/255,this.g=parseInt(rt.charAt(2)+rt.charAt(3),16)/255,this.b=parseInt(rt.charAt(4)+rt.charAt(5),16)/255,Go.toWorkingColorSpace(this,o),this}return s&&s.length>0?this.setColorName(s,o):this}setColorName(s,o="srgb"){const a=Up[s.toLowerCase()];return a!==void 0?this.setHex(a,o):console.warn("THREE.Color: Unknown color "+s),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(s){return this.r=s.r,this.g=s.g,this.b=s.b,this}copySRGBToLinear(s){return this.r=co(s.r),this.g=co(s.g),this.b=co(s.b),this}copyLinearToSRGB(s){return this.r=Il(s.r),this.g=Il(s.g),this.b=Il(s.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(s="srgb"){return Go.fromWorkingColorSpace($p(this,ba),s),uo(255*ba.r,0,255)<<16^uo(255*ba.g,0,255)<<8^uo(255*ba.b,0,255)<<0}getHexString(s="srgb"){return("000000"+this.getHex(s).toString(16)).slice(-6)}getHSL(s,o="srgb-linear"){Go.fromWorkingColorSpace($p(this,ba),o);const a=ba.r,_e=ba.g,rt=ba.b,nt=Math.max(a,_e,rt),ot=Math.min(a,_e,rt);let ct,pt;const ht=(ot+nt)/2;if(ot===nt)ct=0,pt=0;else{const _t=nt-ot;switch(pt=ht<=.5?_t/(nt+ot):_t/(2-nt-ot),nt){case a:ct=(_e-rt)/_t+(_e<rt?6:0);break;case _e:ct=(rt-a)/_t+2;break;case rt:ct=(a-_e)/_t+4}ct/=6}return s.h=ct,s.s=pt,s.l=ht,s}getRGB(s,o="srgb-linear"){return Go.fromWorkingColorSpace($p(this,ba),o),s.r=ba.r,s.g=ba.g,s.b=ba.b,s}getStyle(s="srgb"){return Go.fromWorkingColorSpace($p(this,ba),s),s!==eu?`color(${s} ${ba.r} ${ba.g} ${ba.b})`:`rgb(${255*ba.r|0},${255*ba.g|0},${255*ba.b|0})`}offsetHSL(s,o,a){return this.getHSL(bu),bu.h+=s,bu.s+=o,bu.l+=a,this.setHSL(bu.h,bu.s,bu.l),this}add(s){return this.r+=s.r,this.g+=s.g,this.b+=s.b,this}addColors(s,o){return this.r=s.r+o.r,this.g=s.g+o.g,this.b=s.b+o.b,this}addScalar(s){return this.r+=s,this.g+=s,this.b+=s,this}sub(s){return this.r=Math.max(0,this.r-s.r),this.g=Math.max(0,this.g-s.g),this.b=Math.max(0,this.b-s.b),this}multiply(s){return this.r*=s.r,this.g*=s.g,this.b*=s.b,this}multiplyScalar(s){return this.r*=s,this.g*=s,this.b*=s,this}lerp(s,o){return this.r+=(s.r-this.r)*o,this.g+=(s.g-this.g)*o,this.b+=(s.b-this.b)*o,this}lerpColors(s,o,a){return this.r=s.r+(o.r-s.r)*a,this.g=s.g+(o.g-s.g)*a,this.b=s.b+(o.b-s.b)*a,this}lerpHSL(s,o){this.getHSL(bu),s.getHSL(Ko);const a=_o(bu.h,Ko.h,o),_e=_o(bu.s,Ko.s,o),rt=_o(bu.l,Ko.l,o);return this.setHSL(a,_e,rt),this}equals(s){return s.r===this.r&&s.g===this.g&&s.b===this.b}fromArray(s,o=0){return this.r=s[o],this.g=s[o+1],this.b=s[o+2],this}toArray(s=[],o=0){return s[o]=this.r,s[o+1]=this.g,s[o+2]=this.b,s}fromBufferAttribute(s,o){return this.r=s.getX(o),this.g=s.getY(o),this.b=s.getZ(o),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}function Bo(tt,s){const o=s==="map";return{type:"folder",label:s+" Sampler",hidden:()=>!tt[s],children:[()=>({type:"vec2",label:"Repeat",hidden:()=>!o&&tt.map,bounds:[-100,100],stepSize:.001,property:[tt[s],"repeat"],onChange:tt==null?void 0:tt.setDirty}),()=>({type:"vec2",label:"Offset",hidden:()=>!o&&tt.map,bounds:[-2,2],property:[tt[s],"offset"],onChange:tt==null?void 0:tt.setDirty}),()=>({type:"vec2",label:"Center",hidden:()=>!o&&tt.map,bounds:[-2,2],property:[tt[s],"center"],onChange:tt==null?void 0:tt.setDirty}),()=>({type:"input",label:"Rotation",hidden:()=>!o&&tt.map,bounds:[-Math.PI,Math.PI],property:[tt[s],"rotation"],onChange:tt==null?void 0:tt.setDirty}),()=>({type:"dropdown",label:"Encoding",property:[tt[s],"encoding"],children:[["Linear",et.rnI],["sRGB",et.knz]].map(a=>({label:a[0],value:a[1]})),onChange:[()=>{const a=tt[s];a&&(a.needsUpdate=!0)},tt==null?void 0:tt.setDirty]}),()=>({type:"checkbox",label:"Flip Y",getValue:()=>{var a,_e;return(_e=(a=tt[s])===null||a===void 0?void 0:a.flipY)!==null&&_e!==void 0&&_e},setValue:a=>{var _e;const rt=tt[s];if(rt&&rt.flipY!==a)if(rt.image&&ImageBitmap&&rt.image instanceof ImageBitmap){const nt=rt,ot=rt.source.data;createImageBitmap(ot,{imageOrientation:"flipY"}).then(ct=>{var pt;ot.close&&ot.close(),nt.flipY=a,nt.source.data=ct,nt.source.needsUpdate=!0,nt.needsUpdate=!0,(pt=tt==null?void 0:tt.setDirty)===null||pt===void 0||pt.call(tt)})}else rt.flipY=a,rt.needsUpdate=!0,(_e=tt==null?void 0:tt.setDirty)===null||_e===void 0||_e.call(tt)}}),()=>({type:"dropdown",label:"Wrap S",property:[tt[s],"wrapS"],children:[["ClampToEdge",et.uWy],["MirroredRepeat",et.OoA],["Repeat",et.rpg]].map(a=>({label:a[0],value:a[1]})),onChange:[()=>{tt[s]&&(tt[s].needsUpdate=!0)},tt==null?void 0:tt.setDirty]}),()=>({type:"dropdown",label:"Wrap T",property:[tt[s],"wrapT"],children:[["ClampToEdge",et.uWy],["MirroredRepeat",et.OoA],["Repeat",et.rpg]].map(a=>({label:a[0],value:a[1]})),onChange:[()=>{tt[s]&&(tt[s].needsUpdate=!0)},tt==null?void 0:tt.setDirty]}),()=>({type:"input",label:"Anisotropy",bounds:[1,6],stepSize:1,property:[tt[s],"anisotropy"],onChange:[()=>{tt[s]&&(tt[s].needsUpdate=!0),tt.needsUpdate=!0},tt==null?void 0:tt.setDirty]}),()=>({type:"dropdown",label:"Min Filter",property:[tt[s],"minFilter"],children:[["Linear",No],["Nearest",et.TyD],["NearestMipmapNearest",et.YLQ],["NearestMipmapLinear",et.vZf],["LinearMipmapNearest",et.qyh],["LinearMipmapLinear",et.D1R]].map(a=>({label:a[0],value:a[1]})),onChange:[()=>{tt[s]&&(tt[s].needsUpdate=!0)},tt==null?void 0:tt.setDirty]}),()=>({type:"dropdown",label:"Mag Filter",property:[tt[s],"magFilter"],children:[["Linear",No],["Nearest",et.TyD]].map(a=>({label:a[0],value:a[1]})),onChange:[()=>{tt[s]&&(tt[s].needsUpdate=!0)},tt==null?void 0:tt.setDirty]})]}}ys.NAMES=Up;const su=["appliedMeshes","imageLoadAwaiter","inverseModelMatrix","uvTransform","uuid","iMaterial"];function Ol(tt,s){if(s)for(const o of Object.keys(s))su.includes(o)||o.startsWith("__")||typeof tt[o]!="function"&&typeof s[o]!="function"&&(tt[o]=s[o]);return tt}const pp=["appliedMaterials","uuid"];function _c(tt,s){if(s)for(const o of Object.keys(s))pp.includes(o)||o.startsWith("__")||typeof tt[o]!="function"&&typeof s[o]!="function"&&(tt[o]=s[o]);return tt}const Cp=new Map;function Yr(tt){return(s,o)=>{const a=s.constructor;if(a===Object)throw new Error("All properties in an object are serialized by default");Cp.has(a)||Cp.set(a,[]),Cp.get(a).push([tt||o,o])}}const Cl={obj:(tt,s)=>Object.fromEntries(Object.entries(tt).map(([o,a])=>[o,rs(a,!1,s)])),vec4:tt=>({x:tt.x,y:tt.y,z:tt.z,w:tt.w,isVector4:!0}),vec3:tt=>({x:tt.x,y:tt.y,z:tt.z,isVector3:!0}),vec2:tt=>({x:tt.x,y:tt.y,isVector2:!0}),color:tt=>({r:tt.r,g:tt.g,b:tt.b,isColor:!0}),quat:tt=>({x:tt.x,y:tt.y,z:tt.z,w:tt.w,isQuaternion:!0}),texture:(tt,s)=>{if(!(tt!=null&&tt.isTexture))throw new Error("Expected a texture");if(tt.isRenderTargetTexture)return;if(s!=null&&s.textures[tt.uuid])return{uuid:tt.uuid,resource:"textures"};const o=tt.source.data;tt.userData.rootPath&&(tt.source.data=null);const a=tt.userData;tt.userData={};let _e=tt.toJSON(s);return tt.userData=a,_e.userData=rs(_c({},a),!1,s),tt.userData.rootPath&&(delete s.images[tt.source.uuid],tt.source.data=o),s!=null&&s.textures&&(s.textures[_e.uuid]||(s.textures[_e.uuid]=_e),_e={uuid:_e.uuid,resource:"textures"}),_e},material:(tt,s)=>{var o;if(!(tt!=null&&tt.isMaterial))throw new Error("Expected a material");if(s!=null&&s.materials[tt.uuid])return{uuid:tt.uuid,resource:"materials"};tt.userData.rootPath&&console.error("TODO: handle material with root path with material inheritance/hierarchy");const a=s??{textures:{},images:{}},_e={},rt={};for(const[ot,ct]of Object.entries(tt))if(!((o=ct)===null||o===void 0)&&o.isTexture&&!ot.startsWith("__")){const pt=Cl.texture(ct,a);_e[ot]=pt,rt[ot]=ct,tt[ot]=pt?{isTexture:!0,toJSON:()=>pt}:null}let nt=tt.toJSON(s);for(const[ot,ct]of Object.entries(rt))tt[ot]=ct,delete rt[ot];if(s){for(const[ot,ct]of Object.entries(_e))ct&&(nt[ot]=ct);s!=null&&s.materials&&(s.materials[nt.uuid]||(s.materials[nt.uuid]=nt),nt={uuid:nt.uuid,resource:"materials"})}else{for(const[ot,ct]of Object.entries(_e))nt[ot]=ct.uuid;nt.textures=Object.values(a.textures),nt.images=Object.values(a.images)}return nt}},_d=tt=>(s,o)=>{var a,_e;return(_e=(a=o==null?void 0:o.copy)===null||a===void 0?void 0:a.call(o,s))!==null&&_e!==void 0?_e:new tt().copy(s)},Js={obj:(tt,s,o)=>Object.assign(s,Object.fromEntries(Object.entries(tt).map(([a,_e])=>[a,In(_e,s==null?void 0:s[a],!1,o)]))),vec4:_d(et.Ltg),vec3:_d(et.Pa4),vec2:_d(hn),color:_d(ys),quat:_d(et._fP)};function rs(tt,s,o){var a,_e;if(typeof tt=="function")return;if(Array.isArray(tt))return tt.map(ot=>rs(ot,!1,o));if(typeof tt!="object"){if(typeof tt=="number"){if(tt===1/0)return"Infinity";if(tt===-1/0)return"-Infinity";if(isNaN(tt))return"NaN"}return tt}if(!tt)return tt;let rt=(a=tt.constructor)!==null&&a!==void 0?a:Object;if(rt===Object)return Cl.obj(tt,o);if(tt.isVector2)return Cl.vec2(tt);if(tt.isVector3)return Cl.vec3(tt);if(tt.isVector4)return Cl.vec4(tt);if(tt.isColor)return Cl.color(tt);if(tt.isQuaternion)return Cl.quat(tt);if(tt.isTexture)return Cl.texture(tt,o);if(tt.isMaterial)return Cl.material(tt,o);if(!s&&typeof tt.toJSON=="function")return tt.toJSON(o);const nt={};for(;rt&&rt!==Object;)(_e=Cp.get(rt))===null||_e===void 0||_e.forEach(([ot,ct])=>{const pt=tt[ct];nt[ot]=rs(pt,!1,o)}),rt=Object.getPrototypeOf(rt);return tt.serializableClassId&&(nt.serializableClassId=tt.serializableClassId),nt}function In(tt,s,o,a){var _e,rt,nt;let ot=s;if(tt===void 0)return ot;if(typeof s=="number"){if(tt==="Infinity")return 1/0;if(tt==="-Infinity")return-1/0;if(tt==="NaN")return NaN;if(typeof tt=="number"||!tt)return tt}if(Array.isArray(tt)){const ht=tt.length;Array.isArray(ot)||(ot=[]);for(let _t=0;_t<ht;_t++){const Et=tt[_t],St=ot.length>_t?In(Et,ot[_t],!1,a):In(Et,void 0,!1,a);ot.length<=_t?ot.push(St):ot[_t]=St}return ot}let ct=!1;if(tt&&tt.resource&&typeof tt.resource=="string"&&(tt=(_e=a[tt.resource])===null||_e===void 0?void 0:_e[tt.uuid],ct=!0),!ot&&tt&&!ct)if(tt.serializableClassId){const ht=Ns.get(tt.serializableClassId);ht&&(ot=new ht)}else typeof tt!="object"||tt.constructor&&tt.constructor!==Object||(ot={});if(typeof ot=="function")return console.error("cannot deserialize over function",ot,tt),ot;if(tt&&typeof tt=="object"&&!ct){if(tt.isVector2)return Js.vec2(tt,ot);if(tt.isVector3)return Js.vec3(tt,ot);if(tt.isVector4)return Js.vec4(tt,ot);if(tt.isColor)return Js.color(tt,ot);if(tt.isQuaternion)return Js.quat(tt,ot)}if(tt==null||ot==null||typeof ot!="object"||ot.isTexture)return ct&&(tt?tt.__useCount=tt.__useCount?tt.__useCount+1:1:console.warn("probable error deserialize: resource not found.")),tt;let pt=(rt=ot.constructor)!==null&&rt!==void 0?rt:Object;if(pt===Object)return Js.obj(tt,ot,a);if(!o&&typeof ot.fromJSON=="function")return ot.isMaterial&&(Object.entries(tt).forEach(([ht,_t])=>{var Et;if(!_t||!_t.resource||typeof _t.resource!="string")return;const St=(Et=a[_t.resource])===null||Et===void 0?void 0:Et[_t.uuid];tt[ht]=St||null}),tt.userData&&(tt.userData=In(tt.userData,void 0,!1,a))),ot.fromJSON(tt,a),ot;for(;pt&&pt!==Object;)(nt=Cp.get(pt))===null||nt===void 0||nt.forEach(([ht,_t])=>{const Et=ot[_t],St=In(tt[ht],Et,!1,a);St!==Et&&dr(ot,_t,St,!0)}),pt=Object.getPrototypeOf(pt);return ot}const Ns=new Map;function Fs(tt){return s=>(s=class extends s{constructor(){super(...arguments),this.serializableClassId=tt}},Ns.set(tt,s),s)}function Ps(tt,s){if(tt.uiConfig)return tt.uiConfig;const o={type:"folder",label:tt.name||"unnamed",expanded:!0,limitedUi:!0,children:[{type:"checkbox",label:"Visible",property:[tt,"visible"],limitedUi:!0},{type:"button",label:"Pick/Focus",value:()=>{tt.dispatchEvent({type:"select",ui:!0,value:tt,focusCamera:!0})}},{type:"button",label:"Pick Parent",hidden:()=>!tt.parent,value:()=>{const _e=tt.parent;_e&&_e.dispatchEvent({type:"select",ui:!0,value:_e})}},{type:"input",label:"Name",property:[tt,"name"]},{type:"checkbox",label:"Casts Shadow",hidden:()=>!tt.isMesh,property:[tt,"castShadow"]},{type:"checkbox",label:"Receive Shadow",hidden:()=>!tt.isMesh,property:[tt,"receiveShadow"]},{type:"vec3",label:"Position",property:[tt,"position"],limitedUi:!0},{type:"vec3",label:"Rotation",property:[tt,"rotation"],limitedUi:!0},{type:"vec3",label:"Scale",property:[tt,"scale"]},{type:"button",label:"Auto Scale",prompt:["Auto Scale Radius: Object will be scaled to the given radius",tt.userData.autoScaleRadius||"2",!0],value:_e=>{if(!_e)return;const rt=parseFloat(_e);Math.abs(rt)>0&&ps(tt,rt)}},tt.userData.license!==void 0?{type:"input",label:"License/Credits",property:[tt.userData,"license"],limitedUi:!0}:{}]},a=tt;if(a!=null&&a.isMesh&&s!==!1){const _e=[()=>{var rt;return(rt=a.geometry)===null||rt===void 0?void 0:rt.uiConfig},()=>{var rt;return Array.isArray(a.material)?a.material.length<1?void 0:{label:"Materials",type:"folder",children:a.material.map(nt=>nt==null?void 0:nt.uiConfig).filter(nt=>nt)}:(rt=a.material)===null||rt===void 0?void 0:rt.uiConfig}];o.children.push(..._e)}if(tt!=null&&tt.isCamera){const _e=[{type:"button",label:"Set View",value:()=>{tt.dispatchEvent({type:"setView",ui:!0,camera:tt})}},{type:"button",label:"Activate main",hidden:()=>{var rt;return(rt=tt.userData.iCamera)===null||rt===void 0?void 0:rt.isActiveCamera},value:()=>{tt.dispatchEvent({type:"activateMain",ui:!0,camera:tt})}},{type:"button",label:"Deactivate main",hidden:()=>{var rt;return!(!((rt=tt.userData.iCamera)===null||rt===void 0)&&rt.isActiveCamera)},value:()=>{tt.dispatchEvent({type:"activateMain",ui:!0,camera:void 0})}}];o.children.push(..._e)}return tt.uiConfig=o,o}function Xo(tt,s,o){var a;if(!tt)return void console.warn("setupIModel: object is undefined");if(tt.__disposed&&(console.warn("re-init/re-add disposed object, things might not work as intended",tt),delete tt.__disposed),tt.userData||(tt.userData={}),tt.userData.__iModelSetup&&tt.modelObject)return tt;tt.userData.__iModelSetup=!0;let _e=[];_e.push(()=>{[...tt.children].forEach(Mt=>{var It;(It=Mt==null?void 0:Mt.dispose)===null||It===void 0||It.call(Mt)}),tt.children=[],tt.parent&&tt.removeFromParent()}),tt.isLight&&!tt.assetType?(tt.assetType="light",tt.lightObject=tt):tt.isCamera?(tt.assetType="camera",tt.cameraObject=tt):tt.assetType||(tt.assetType="model"),tt.modelObject||(tt.modelObject=tt),tt.setDirty||(tt.setDirty=(Mt={})=>{tt.dispatchEvent({...Mt,type:"objectUpdate",object:tt})},tt.userData.setDirty&&console.warn("userData.setDirty already defined",tt.userData.setDirty,tt),tt.userData.setDirty=Mt=>{var It;console.warn("userData.setDirty is deprecated, use setDirty directly"),(It=tt.setDirty)===null||It===void 0||It.call(tt,Mt)});const rt=Mt=>{var It,Nt,Bt;const kt=(Nt=(It=tt.parent)===null||It===void 0?void 0:It.userData.parentRoot)!==null&&Nt!==void 0?Nt:tt.parent;kt!==tt.userData.parentRoot&&tt.traverse(Pt=>{Pt.userData.parentRoot=kt}),(Bt=tt.setDirty)===null||Bt===void 0||Bt.call(tt,{change:"addedToParent"})},nt=()=>{var Mt;(Mt=tt.setDirty)===null||Mt===void 0||Mt.call(tt,{change:"removedFromParent"}),tt.userData.parentRoot!==void 0&&tt.traverse(It=>{It.userData.parentRoot=void 0})};tt.addEventListener("added",rt),tt.addEventListener("removed",nt),_e.push(()=>{tt.removeEventListener("added",rt),tt.removeEventListener("removed",nt)});const ot=tt.dispose;tt.dispose=()=>{tt.dispatchEvent({type:"dispose"}),ot==null||ot.call(tt)},tt.userData.dispose&&console.warn("userData.dispose already defined"),tt.userData.dispose=()=>{var Mt;console.warn("userData.dispose is deprecated, use dispose directly"),(Mt=tt.dispose)===null||Mt===void 0||Mt.call(tt)};const ct=tt;!ct.isMesh&&!ct.isLine||ct.userData.__meshSetup||(ct.userData.__meshSetup=!0,ct.setMaterial||(ct.setMaterial=Mt=>oo(ct,Mt)),ct.setGeometry||(ct.setGeometry=(Mt,It=!1)=>Uo(ct,Mt,It),ct.setGeometry(ct.geometry,!0)),tt.userData.setMaterial&&console.warn("userData.setMaterial already defined"),tt.userData.setMaterial=Mt=>{var It;console.warn("userData.setMaterial is deprecated, use setMaterial directly"),(It=tt.setMaterial)===null||It===void 0||It.call(tt,Mt)},tt.userData.setGeometry&&console.warn("userData.setGeometry already defined"),tt.userData.setGeometry=(Mt,...It)=>{var Nt;console.warn("userData.setGeometry is deprecated, use setGeometry directly"),(Nt=tt.setGeometry)===null||Nt===void 0||Nt.call(tt,Mt,...It)},tt.userData.__keepShadowDef||(tt.castShadow=!0,tt.receiveShadow=!0,tt.userData.__keepShadowDef=!0),_e.push(()=>{var Mt,It;const Nt=((Mt=ct.setMaterial)===null||Mt===void 0?void 0:Mt.call(ct,void 0))||[],Bt=(It=ct.setGeometry)===null||It===void 0?void 0:It.call(ct,void 0);for(const kt of Nt)kt&&kt.userData.__appliedMeshes.size===0&&kt.userData.disposeOnIdle!==!1&&kt.dispose();Bt&&Bt.userData.__appliedMeshes.size===0&&Bt.userData.disposeOnIdle!==!1&&Bt.dispose()})),tt.uiConfig||tt.assetType!=="model"&&tt.assetType!=="camera"||(Ps(tt),_e.push(()=>{tt.uiConfig=void 0}));const pt=()=>{var Mt,It;return(It=(Mt=tt.uiConfig)===null||Mt===void 0?void 0:Mt.uiRefresh)===null||It===void 0?void 0:It.call(Mt,"postFrame",!0,1)};tt.addEventListener("objectUpdate",pt),_e.push(()=>tt.removeEventListener("objectUpdate",pt)),tt.userData.__autoParentDispatchEvents?console.warn("object.userData.__autoParentDispatchEvents already set"):(tt.userData.__autoParentDispatchEvents=tt.userData.__autoParentDispatchEvents||["objectUpdate","materialUpdate","select"],tt.isCamera&&tt.userData.__autoParentDispatchEvents.push("activateMain","setView")),s&&(tt.userData.parentRoot=s),_e.push(()=>{delete tt.userData.parentRoot});const ht=tt.dispatchEvent;tt.dispatchEvent=Mt=>{var It;!((It=tt.userData.__autoParentDispatchEvents)===null||It===void 0)&&It.includes(Mt.type)&&(Mt.parentDispatch=!0),Mt.parentDispatch&&(Nt=>{var Bt;const kt=(Bt=tt.userData.parentRoot)!==null&&Bt!==void 0?Bt:tt.parent;kt!=null&&kt.modelObject&&kt.dispatchEvent(Nt)})(Mt),ht.call(tt,Mt)},_e.push(()=>{tt.dispatchEvent=ht});const _t=tt.clone;tt.clone=(...Mt)=>{const It=tt.userData;tt.userData={};let Nt=_t.call(tt,...Mt);tt.userData=It,po(Nt.userData,It);const Bt=tt.userData.parentRoot;return Bt&&Bt.assetType!=="model"&&console.warn("Cloning an object with a parent that is not an IModel is not supported"),Nt=Xo(Nt,Bt,o),Nt.userData.cloneParent=tt.uuid,Nt},_e.push(()=>{tt.clone=_t});const Et=tt.copy;tt.copy=(Mt,...It)=>{const Nt=Mt.userData;Mt.userData={};const Bt=Et.call(tt,Mt,...It);return Mt.userData=Nt,po(tt.userData,Mt),Bt},_e.push(()=>{tt.copy=Et});const St=tt.add;return tt.add=(...Mt)=>(Mt.forEach(It=>Xo(It,tt.userData.parentRoot||tt,o)),St.call(tt,...Mt)),_e.push(()=>{tt.add=St}),tt=(a=o==null?void 0:o(tt))!==null&&a!==void 0?a:tt,_e.push(()=>{dr(tt,"modelObject",void 0,!0),tt.userData={}}),tt.addEventListener("dispose",()=>{tt.__disposed?console.warn("Object already disposed",tt):(tt.__disposed=!0,_e.forEach(Mt=>Mt()),_e=[])}),[...tt.children].forEach(Mt=>Xo(Mt,tt,o)),tt}function oo(tt,s){var o,a,_e,rt,nt;const ot=(Array.isArray(s)?s:[s]).map(ht=>ht==null?void 0:ht.materialObject).filter(ht=>ht);if(tt.material==ot||ot.length===1&&tt.material===ot[0])return[];tt.userData.__materialUpdater||(tt.userData.__materialUpdater=()=>{tt.dispatchEvent({type:"materialUpdate"})});const ct=Array.isArray(tt.material)?[...tt.material]:[tt.material];for(const ht of ct)ht&&(ht.removeEventListener("materialUpdate",tt.userData.__materialUpdater),(a=(o=ht.userData)===null||o===void 0?void 0:o.__appliedMeshes)===null||a===void 0||a.delete(tt));const pt=[];for(const ht of ot)ht.userData.__appliedMeshes||(ht.userData.__appliedMeshes=new Set),pt.push(ht),ht&&(ht.addEventListener("materialUpdate",tt.userData.__materialUpdater),ht.userData.__appliedMeshes.add(tt));return tt.material=pt.length!==1?pt:(_e=pt[0])!==null&&_e!==void 0?_e:void 0,tt.traverseAncestors(ht=>{ht.isRootScene&&ht.refreshEnvMapIntensity(tt)}),tt.dispatchEvent({type:"materialChanged",material:s}),(nt=(rt=tt.uiConfig)===null||rt===void 0?void 0:rt.uiRefresh)===null||nt===void 0||nt.call(rt,"postFrame",!0),ct}function Uo(tt,s,o=!1){var a,_e,rt,nt,ot,ct,pt;tt.userData.__objectUpdater||(tt.userData.__objectUpdater=Et=>{tt.dispatchEvent({...Et,type:"objectUpdate"})});let ht=tt.geometry;const _t=ht;return(ht!==s||o)&&(ht&&(ht.removeEventListener("geometryUpdate",tt.userData.__objectUpdater),(_e=(a=ht.userData)===null||a===void 0?void 0:a.__appliedMeshes)===null||_e===void 0||_e.delete(tt)),ht=s,ht&&!ht.userData.__appliedMeshes&&(ht.userData.__appliedMeshes=new Set),tt.geometry=(rt=ht)!==null&&rt!==void 0?rt:void 0,ht&&(ht.addEventListener("geometryUpdate",tt.userData.__objectUpdater),(ot=(nt=ht.userData)===null||nt===void 0?void 0:nt.__appliedMeshes)===null||ot===void 0||ot.add(tt))),s&&!s.uiConfig&&(s.uiConfig=function(Et){return{label:"Geometry",type:"folder",children:[{type:"input",property:[Et,"uuid"],disabled:!0},{type:"button",label:"Create uv2 from uv",value:()=>{Et.hasAttribute("uv2")&&!confirm("uv2 already exists, replace with uv data?")||Et.setAttribute("uv2",Et.getAttribute("uv"))}},{type:"input",label:"Mesh count",get value(){var St,Mt,It;return(It=(Mt=(St=Et.userData)===null||St===void 0?void 0:St.__appliedMeshes)===null||Mt===void 0?void 0:Mt.size)!==null&&It!==void 0?It:0},set value(St){},disabled:!0}]}}(tt.geometry)),tt.dispatchEvent({type:"geometryChanged",geometry:s}),(pt=(ct=tt.uiConfig)===null||ct===void 0?void 0:ct.uiRefresh)===null||pt===void 0||pt.call(ct,"postFrame",!0),_t===ht?void 0:_t||void 0}const Jo=["appliedMeshes"],ep=["parentRoot","iCamera","iModel"];function po(tt,s){if(s)for(const o of Object.keys(s))ep.includes(o)||o.startsWith("__")||typeof tt[o]!="function"&&typeof s[o]!="function"&&(tt[o]=s[o]);return tt}var tu,Tp=new Uint8Array(16);function Zo(){if(!tu&&!(tu=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return tu(Tp)}for(var To=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,Al=function(tt){return typeof tt=="string"&&To.test(tt)},Co=[],wu=0;wu<256;++wu)Co.push((wu+256).toString(16).substr(1));var Mo=function(tt,s,o){var a=(tt=tt||{}).random||(tt.rng||Zo)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,s){o=o||0;for(var _e=0;_e<16;++_e)s[o+_e]=a[_e];return s}return function(rt){var nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,ot=(Co[rt[nt+0]]+Co[rt[nt+1]]+Co[rt[nt+2]]+Co[rt[nt+3]]+"-"+Co[rt[nt+4]]+Co[rt[nt+5]]+"-"+Co[rt[nt+6]]+Co[rt[nt+7]]+"-"+Co[rt[nt+8]]+Co[rt[nt+9]]+"-"+Co[rt[nt+10]]+Co[rt[nt+11]]+Co[rt[nt+12]]+Co[rt[nt+13]]+Co[rt[nt+14]]+Co[rt[nt+15]]).toLowerCase();if(!Al(ot))throw TypeError("Stringified UUID is invalid");return ot}(a)};const xl=new Map;function Pl(tt,s){return(o,a)=>{const _e=o.constructor;if(_e===Object)throw new Error("All properties in an object are serialized by default");xl.has(_e)||xl.set(_e,[]);const rt=xl.get(_e);if(!(rt.findIndex(nt=>nt.propKey===a)<0))throw new Error(`Property ${a} already has a uiConfig decorator`);rt.push({params:s||{},propKey:a,uiType:tt})}}function ds(tt,s){return Pl("checkbox",{label:tt,params:s})}function Hm(tt,s){return Pl("monitor",{label:tt,params:s})}function gs(tt,s,o,a){return Pl("slider",{label:tt,bounds:s,stepSize:o,params:a})}function ou(tt,s,o,a){return Pl("vec",{label:tt,bounds:s,stepSize:o,params:a})}function Mp(tt,s,o){return Pl("dropdown",{label:tt,children:s,params:o})}function Qo(tt,s){return Pl("button",{label:tt,params:s})}function yo(tt,s){return Pl("input",{label:tt,params:s})}function vv(tt,s){return Pl("color",{label:tt,params:s})}function By(tt,s){return Pl("image",{label:tt,params:s})}function Yv(tt){let s=tt==null?void 0:tt.constructor;if(!tt||!s)return[];const o=[],a=[];for(;s&&s!==Object;)a.push(s),s=Object.getPrototypeOf(s);return a.reverse().forEach(_e=>{var rt;(rt=xl.get(_e))===null||rt===void 0||rt.forEach(({params:nt,propKey:ot,uiType:ct})=>{var pt;let ht;if(ct||(ht=(pt=tt[ot])===null||pt===void 0?void 0:pt.uiConfig),ht||(ht={property:[tt,ot],type:ct||"input"}),nt){const _t=typeof nt.params=="function"?nt.params(tt):nt.params||{};delete nt.params,Object.assign(ht,{...nt,..._t})}o.push(ht)})}),o}function R_(tt,s,o={}){return{type:"folder",label:tt,children:Yv(s),uuid:Mo(),...o}}function Ao(tt,s){return o=>class extends o{constructor(){super(...arguments),this.uiConfig=R_(tt,this,s||{})}}}const EA={type:"change"},I_={type:"start"},Kv={type:"end"};class Xv extends et.pBf{constructor(s,o){super(),this.object=s,this.domElement=o,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new et.Pa4,this.minDistance=.01,this.maxDistance=1/0,this.autoPushTarget=!0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.maxZoomSpeed=1,this.dollyZoom=!1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:et.RsA.ROTATE,MIDDLE:et.RsA.DOLLY,RIGHT:et.RsA.PAN},this.touches={ONE:et.QmN.ROTATE,TWO:et.QmN.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return ot.phi},this.getAzimuthalAngle=function(){return ot.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(yn){yn.addEventListener("keydown",eo),this._domElementKeyEvents=yn},this.saveState=function(){a.target0.copy(a.target),a.position0.copy(a.object.position),a.zoom0=a.object.zoom},this.reset=function(){a.target.copy(a.target0),a.object.position.copy(a.position0),a.object.zoom=a.zoom0,a.object.updateProjectionMatrix(),a.dispatchEvent(EA),a.update(),rt=_e.NONE},this.update=function(){const yn=new et.Pa4,qn=new et._fP().setFromUnitVectors(s.up,new et.Pa4(0,1,0)),Wn=qn.clone().invert(),ro=new et.Pa4,yl=new et._fP,xr=2*Math.PI;return function(){const Qr=a.object.position;yn.copy(Qr).sub(a.target),yn.applyQuaternion(qn),ot.setFromVector3(yn),a.autoRotate&&rt===_e.NONE&&fr(2*Math.PI/60/60*a.autoRotateSpeed),a.enableDamping?(ot.theta+=ct.theta*a.dampingFactor,ot.phi+=ct.phi*a.dampingFactor):(ot.theta+=ct.theta,ot.phi+=ct.phi);let Sr=a.minAzimuthAngle,Xr=a.maxAzimuthAngle;isFinite(Sr)&&isFinite(Xr)&&(Sr<-Math.PI?Sr+=xr:Sr>Math.PI&&(Sr-=xr),Xr<-Math.PI?Xr+=xr:Xr>Math.PI&&(Xr-=xr),ot.theta=Sr<=Xr?Math.max(Sr,Math.min(Xr,ot.theta)):ot.theta>(Sr+Xr)/2?Math.max(Sr,ot.theta):Math.min(Xr,ot.theta)),ot.phi=Math.max(a.minPolarAngle,Math.min(a.maxPolarAngle,ot.phi)),ot.makeSafe(),Math.abs(ct.radius)>0&&(a.dollyZoom&&(a.object.zoom=Math.max(Math.max(a.minZoom,.1),Math.min(Math.min(a.maxZoom,20),a.object.zoom*(1+ct.radius*(a.enableDamping?a.dampingFactor:1)))),a.object.updateProjectionMatrix(),(a.object.zoom>=Math.min(a.maxZoom,20)||a.object.zoom<=Math.max(a.minZoom,.1))&&(ct.radius=0)),ot.radius*=1+ct.radius*(a.enableDamping?a.dampingFactor:1)),Math.abs(pt-1)>1e-5&&(a.dollyZoom&&(a.object.zoom=Math.max(Math.max(a.minZoom,.1),Math.min(Math.min(a.maxZoom,20),a.object.zoom*pt)),a.object.updateProjectionMatrix(),(a.object.zoom>=Math.min(a.maxZoom,20)||a.object.zoom<=Math.max(a.minZoom,.1))&&(pt=1)),ot.radius*=pt);let un=0;a.autoPushTarget&&ot.radius<a.minDistance&&(un=a.minDistance-ot.radius),ot.radius=Math.max(a.minDistance,Math.min(a.maxDistance,ot.radius)),a.enableDamping===!0?a.target.addScaledVector(ht,a.dampingFactor):a.target.add(ht),yn.setFromSpherical(ot),yn.applyQuaternion(Wn),Qr.copy(a.target).add(yn),a.target.add(yn.normalize().multiplyScalar(-un)),a.object.lookAt(a.target);let Kr=!1;return a.enableDamping===!0&&Math.abs(ct.theta)+Math.abs(ct.phi)+Math.abs(ct.radius)+ht.length()>.001?(ct.theta*=1-a.dampingFactor,ct.phi*=1-a.dampingFactor,ct.radius*=1-a.dampingFactor,ht.multiplyScalar(1-a.dampingFactor),Kr=!0):(ct.set(0,0,0),ht.set(0,0,0)),pt=1,!!(_t||Kr||ro.distanceToSquared(a.object.position)>nt||8*(1-yl.dot(a.object.quaternion))>nt)&&(a.dispatchEvent(EA),ro.copy(a.object.position),yl.copy(a.object.quaternion),_t=!1,!0)}}(),this.stopDamping=function(){ct.set(0,0,0),ht.set(0,0,0)},this.dispose=function(){a.domElement.removeEventListener("contextmenu",vo),a.domElement.removeEventListener("pointerdown",Gn),a.domElement.removeEventListener("pointercancel",bs),a.domElement.removeEventListener("wheel",Cn),a.domElement.removeEventListener("pointermove",Qn),a.domElement.removeEventListener("pointerup",Yn),a._domElementKeyEvents!==null&&a._domElementKeyEvents.removeEventListener("keydown",eo)};const a=this,_e={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let rt=_e.NONE;const nt=1e-6,ot=new et.$V,ct=new et.$V(0,0,0);let pt=1;const ht=new et.Pa4;let _t=!1;const Et=new et.FM8,St=new et.FM8,Mt=new et.FM8,It=new et.FM8,Nt=new et.FM8,Bt=new et.FM8,kt=new et.FM8,Pt=new et.FM8,qt=new et.FM8,Kt=[],nr={};function ir(){return a.enableDamping?1:Math.pow(.95,a.zoomSpeed)}function fr(yn){ct.theta-=yn}function br(yn){ct.phi-=yn}this.rotateUp=br,this.rotateLeft=fr;const Tr=function(){const yn=new et.Pa4;return function(qn,Wn){yn.setFromMatrixColumn(Wn,0),yn.multiplyScalar(-qn),ht.add(yn)}}(),Dr=function(){const yn=new et.Pa4;return function(qn,Wn){a.screenSpacePanning===!0?yn.setFromMatrixColumn(Wn,1):(yn.setFromMatrixColumn(Wn,0),yn.crossVectors(a.object.up,yn)),yn.multiplyScalar(qn),ht.add(yn)}}(),Rr=function(){const yn=new et.Pa4;return function(qn,Wn){const ro=a.domElement;if(a.object.isPerspectiveCamera){const yl=a.object.position;yn.copy(yl).sub(a.target);let xr=yn.length();xr*=Math.tan(a.object.fov/2*Math.PI/180),Tr(2*qn*xr/ro.clientHeight,a.object.matrix),Dr(2*Wn*xr/ro.clientHeight,a.object.matrix)}else a.object.isOrthographicCamera?(Tr(qn*(a.object.right-a.object.left)/a.object.zoom/ro.clientWidth,a.object.matrix),Dr(Wn*(a.object.top-a.object.bottom)/a.object.zoom/ro.clientHeight,a.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),a.enablePan=!1)}}();function Nr(yn,qn=0){a.object.isPerspectiveCamera?(pt/=yn,ct.radius=Math.max(-a.maxZoomSpeed,Math.min(a.maxZoomSpeed,ct.radius-qn))):a.object.isOrthographicCamera?(a.object.zoom=Math.max(a.minZoom,Math.min(a.maxZoom,a.object.zoom*yn)),a.object.updateProjectionMatrix(),_t=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),a.enableZoom=!1)}function Ir(yn,qn=0){a.object.isPerspectiveCamera?(pt*=yn,ct.radius=Math.max(-a.maxZoomSpeed,Math.min(a.maxZoomSpeed,ct.radius+qn))):a.object.isOrthographicCamera?(a.object.zoom=Math.max(a.minZoom,Math.min(a.maxZoom,a.object.zoom/yn)),a.object.updateProjectionMatrix(),_t=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),a.enableZoom=!1)}function kr(yn){Et.set(yn.clientX,yn.clientY)}function Hr(yn){It.set(yn.clientX,yn.clientY)}function Lr(){if(Kt.length===1)Et.set(Kt[0].pageX,Kt[0].pageY);else{const yn=.5*(Kt[0].pageX+Kt[1].pageX),qn=.5*(Kt[0].pageY+Kt[1].pageY);Et.set(yn,qn)}}function en(){if(Kt.length===1)It.set(Kt[0].pageX,Kt[0].pageY);else{const yn=.5*(Kt[0].pageX+Kt[1].pageX),qn=.5*(Kt[0].pageY+Kt[1].pageY);It.set(yn,qn)}}function vn(){const yn=Kt[0].pageX-Kt[1].pageX,qn=Kt[0].pageY-Kt[1].pageY,Wn=Math.sqrt(yn*yn+qn*qn);kt.set(0,Wn)}function wn(yn){if(Kt.length==1)St.set(yn.pageX,yn.pageY);else{const Wn=Sl(yn),ro=.5*(yn.pageX+Wn.x),yl=.5*(yn.pageY+Wn.y);St.set(ro,yl)}Mt.subVectors(St,Et).multiplyScalar(a.rotateSpeed);const qn=a.domElement;fr(2*Math.PI*Mt.x/qn.clientHeight),br(2*Math.PI*Mt.y/qn.clientHeight),Et.copy(St)}function pn(yn){if(Kt.length===1)Nt.set(yn.pageX,yn.pageY);else{const qn=Sl(yn),Wn=.5*(yn.pageX+qn.x),ro=.5*(yn.pageY+qn.y);Nt.set(Wn,ro)}Bt.subVectors(Nt,It).multiplyScalar(a.panSpeed),Rr(Bt.x,Bt.y),It.copy(Nt)}function Fn(yn){const qn=Sl(yn),Wn=yn.pageX-qn.x,ro=yn.pageY-qn.y,yl=Math.sqrt(Wn*Wn+ro*ro);Pt.set(0,yl),qt.set(0,Math.pow(Pt.y/kt.y,a.zoomSpeed)),Nr(qt.y),kt.copy(Pt)}function Gn(yn){a.enabled!==!1&&(Kt.length===0&&(a.domElement.setPointerCapture(yn.pointerId),a.domElement.addEventListener("pointermove",Qn),a.domElement.addEventListener("pointerup",Yn)),function(qn){Kt.push(qn)}(yn),yn.pointerType==="touch"?function(qn){switch(zo(qn),Kt.length){case 1:switch(a.touches.ONE){case et.QmN.ROTATE:if(a.enableRotate===!1)return;Lr(),rt=_e.TOUCH_ROTATE;break;case et.QmN.PAN:if(a.enablePan===!1)return;en(),rt=_e.TOUCH_PAN;break;default:rt=_e.NONE}break;case 2:switch(a.touches.TWO){case et.QmN.DOLLY_PAN:if(a.enableZoom===!1&&a.enablePan===!1)return;a.enableZoom&&vn(),a.enablePan&&en(),rt=_e.TOUCH_DOLLY_PAN;break;case et.QmN.DOLLY_ROTATE:if(a.enableZoom===!1&&a.enableRotate===!1)return;a.enableZoom&&vn(),a.enableRotate&&Lr(),rt=_e.TOUCH_DOLLY_ROTATE;break;default:rt=_e.NONE}break;default:rt=_e.NONE}rt!==_e.NONE&&a.dispatchEvent(I_)}(yn):function(qn){let Wn;switch(qn.button){case 0:Wn=a.mouseButtons.LEFT;break;case 1:Wn=a.mouseButtons.MIDDLE;break;case 2:Wn=a.mouseButtons.RIGHT;break;default:Wn=-1}switch(Wn){case et.RsA.DOLLY:if(a.enableZoom===!1)return;(function(ro){kt.set(ro.clientX,ro.clientY)})(qn),rt=_e.DOLLY;break;case et.RsA.ROTATE:if(qn.ctrlKey||qn.metaKey||qn.shiftKey){if(a.enablePan===!1)return;Hr(qn),rt=_e.PAN}else{if(a.enableRotate===!1)return;kr(qn),rt=_e.ROTATE}break;case et.RsA.PAN:if(qn.ctrlKey||qn.metaKey||qn.shiftKey){if(a.enableRotate===!1)return;kr(qn),rt=_e.ROTATE}else{if(a.enablePan===!1)return;Hr(qn),rt=_e.PAN}break;default:rt=_e.NONE}rt!==_e.NONE&&a.dispatchEvent(I_)}(yn))}function Qn(yn){a.enabled!==!1&&(yn.pointerType==="touch"?function(qn){switch(zo(qn),rt){case _e.TOUCH_ROTATE:if(a.enableRotate===!1)return;wn(qn),a.update();break;case _e.TOUCH_PAN:if(a.enablePan===!1)return;pn(qn),a.update();break;case _e.TOUCH_DOLLY_PAN:if(a.enableZoom===!1&&a.enablePan===!1)return;(function(Wn){a.enableZoom&&Fn(Wn),a.enablePan&&pn(Wn)})(qn),a.update();break;case _e.TOUCH_DOLLY_ROTATE:if(a.enableZoom===!1&&a.enableRotate===!1)return;(function(Wn){a.enableZoom&&Fn(Wn),a.enableRotate&&wn(Wn)})(qn),a.update();break;default:rt=_e.NONE}}(yn):function(qn){switch(rt){case _e.ROTATE:if(a.enableRotate===!1)return;(function(Wn){St.set(Wn.clientX,Wn.clientY),Mt.subVectors(St,Et).multiplyScalar(a.rotateSpeed);const ro=a.domElement;fr(2*Math.PI*Mt.x/ro.clientHeight),br(2*Math.PI*Mt.y/ro.clientHeight),Et.copy(St),a.update()})(qn);break;case _e.DOLLY:if(a.enableZoom===!1)return;(function(Wn){Pt.set(Wn.clientX,Wn.clientY),qt.subVectors(Pt,kt),qt.y>0?Nr(ir()):qt.y<0&&Ir(ir()),kt.copy(Pt),a.update()})(qn);break;case _e.PAN:if(a.enablePan===!1)return;(function(Wn){Nt.set(Wn.clientX,Wn.clientY),Bt.subVectors(Nt,It).multiplyScalar(a.panSpeed),Rr(Bt.x,Bt.y),It.copy(Nt),a.update()})(qn)}}(yn))}function Yn(yn){to(yn),Kt.length===0&&(a.domElement.releasePointerCapture(yn.pointerId),a.domElement.removeEventListener("pointermove",Qn),a.domElement.removeEventListener("pointerup",Yn)),a.dispatchEvent(Kv),rt=_e.NONE}function bs(yn){to(yn)}function Cn(yn){a.enabled!==!1&&a.enableZoom!==!1&&rt===_e.NONE&&(yn.preventDefault(),a.dispatchEvent(I_),function(qn){let Wn=0;switch(qn.deltaMode){case 2:Wn+=1*qn.deltaY;break;case 1:Wn+=.4*qn.deltaY;break;default:Wn+=.01*qn.deltaY}qn.deltaY<0?Ir(1,Wn*a.zoomSpeed):qn.deltaY>0&&Nr(1,-Wn*a.zoomSpeed),a.update()}(yn),a.dispatchEvent(Kv))}function eo(yn){a.enabled!==!1&&a.enablePan!==!1&&function(qn){let Wn=!1;switch(qn.code){case a.keys.UP:Rr(0,a.keyPanSpeed),Wn=!0;break;case a.keys.BOTTOM:Rr(0,-a.keyPanSpeed),Wn=!0;break;case a.keys.LEFT:Rr(a.keyPanSpeed,0),Wn=!0;break;case a.keys.RIGHT:Rr(-a.keyPanSpeed,0),Wn=!0}Wn&&(qn.preventDefault(),a.update())}(yn)}function vo(yn){a.enabled!==!1&&yn.preventDefault()}function to(yn){delete nr[yn.pointerId];for(let qn=0;qn<Kt.length;qn++)if(Kt[qn].pointerId==yn.pointerId)return void Kt.splice(qn,1)}function zo(yn){let qn=nr[yn.pointerId];qn===void 0&&(qn=new et.FM8,nr[yn.pointerId]=qn),qn.set(yn.pageX,yn.pageY)}function Sl(yn){const qn=yn.pointerId===Kt[0].pointerId?Kt[1]:Kt[0];return nr[qn.pointerId]}this.zoomIn=function(yn){Nr(1,yn*a.zoomSpeed)},this.zoomOut=function(yn){Ir(1,yn*a.zoomSpeed)},a.domElement.addEventListener("contextmenu",vo),a.domElement.addEventListener("pointerdown",Gn),a.domElement.addEventListener("pointercancel",bs),a.domElement.addEventListener("wheel",Cn,{passive:!1}),this.update()}}var xa=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let Ho=class extends Xv{constructor(){super(...arguments),this.type="OrbitControls",this.enabled=!0,this.dollyZoom=!1,this.enableDamping=!0,this.dampingFactor=.08,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableZoom=!0,this.zoomSpeed=.15,this.maxZoomSpeed=.2,this.enableRotate=!0,this.rotateSpeed=2,this.enablePan=!0,this.panSpeed=1,this.autoPushTarget=!1,this.minDistance=.35,this.maxDistance=1e3,this.minZoom=.01,this.maxZoom=1e3,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1e4,this.maxAzimuthAngle=1e4,this.screenSpacePanning=!0,this.keyPanSpeed=7}zoomIn(tt){super.zoomIn(tt)}zoomOut(tt){super.zoomOut(tt)}dispatchEvent(tt){super.dispatchEvent(tt)}};xa([Yr()],Ho.prototype,"type",void 0),xa([ds()],Ho.prototype,"enabled",void 0),xa([ds(),Yr()],Ho.prototype,"dollyZoom",void 0),xa([ds(),Yr()],Ho.prototype,"enableDamping",void 0),xa([yo(),Yr()],Ho.prototype,"dampingFactor",void 0),xa([ds(),Yr()],Ho.prototype,"autoRotate",void 0),xa([yo(),Yr()],Ho.prototype,"autoRotateSpeed",void 0),xa([ds(),Yr()],Ho.prototype,"enableZoom",void 0),xa([yo(),Yr()],Ho.prototype,"zoomSpeed",void 0),xa([yo(),Yr()],Ho.prototype,"maxZoomSpeed",void 0),xa([ds(),Yr()],Ho.prototype,"enableRotate",void 0),xa([yo(),Yr()],Ho.prototype,"rotateSpeed",void 0),xa([ds(),Yr()],Ho.prototype,"enablePan",void 0),xa([yo(),Yr()],Ho.prototype,"panSpeed",void 0),xa([yo(),Yr()],Ho.prototype,"autoPushTarget",void 0),xa([yo(),Yr()],Ho.prototype,"minDistance",void 0),xa([yo(),Yr()],Ho.prototype,"maxDistance",void 0),xa([yo(),Yr()],Ho.prototype,"minZoom",void 0),xa([yo(),Yr()],Ho.prototype,"maxZoom",void 0),xa([yo(),Yr()],Ho.prototype,"minPolarAngle",void 0),xa([yo(),Yr()],Ho.prototype,"maxPolarAngle",void 0),xa([yo(),Yr()],Ho.prototype,"minAzimuthAngle",void 0),xa([yo(),Yr()],Ho.prototype,"maxAzimuthAngle",void 0),xa([Yr()],Ho.prototype,"screenSpacePanning",void 0),xa([Yr()],Ho.prototype,"keyPanSpeed",void 0),Ho=xa([Ao("Orbit Controls")],Ho);var _v=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};class Rp extends it{constructor(s,o,a){super(),this._controlsMode="",this._isActiveCamera=!1,this.userData={},this._cameraObjectUpdate=nt=>{this.setDirty(nt)},this._interactionsEnabled=!0,this.autoLookAtTarget=!0,this.near=.01,this.far=50,this._options={type:"PerspectiveCamera",aspect:"auto",focus:10,fov:25,zoom:1,frustumSize:1,top:1,bottom:-1,left:-1,right:1,controlsMode:"orbit",controlsEnabled:!0},this._position=new et.Pa4(0,0,10),this._target=new et.Pa4(0,0,0),this._controlsCtors=new Map([["orbit",(nt,ot)=>{const ct=new Ho(nt,ot.ownerDocument?ot:ot.documentElement);return ct.screenSpacePanning=!0,ct}]]),this._camUi=[{type:"vec3",label:"Position",property:[this,"position"],onChange:()=>this.positionUpdated(!0)},{type:"vec3",label:"Target",property:[this,"target"],onChange:()=>this.targetUpdated(!0)},{type:"slider",bounds:[1,180],label:"Field Of View",hidden:()=>!this._camera.modelObject.isPerspectiveCamera,property:[this._options,"fov"],onChange:()=>{this.refreshCameraOptions()},limitedUi:!0},{type:"slider",bounds:[.001,20],label:"Zoom",property:[this._options,"zoom"],onChange:()=>{this.refreshCameraOptions()}},()=>({type:"dropdown",label:"Controls Mode",property:[this._options,"controlsMode"],children:["","orbit","firstPerson","pointerLock",...this._controlsCtors.keys()].map(nt=>({label:nt===""?"none":nt,value:nt})),onChange:()=>{this.refreshCameraOptions()}})],this.uiConfig={type:"folder",label:"Camera",limitedUi:!0,children:[...this._camUi,()=>{var nt;return(nt=this._controls)===null||nt===void 0?void 0:nt.uiConfig},()=>{var nt;return!((nt=this._controls)===null||nt===void 0)&&nt.zoomIn?{type:"button",label:"Zoom in",value:()=>{var ot;(ot=this._controls)===null||ot===void 0||ot.zoomIn(1)}}:{}},()=>{var nt;return!((nt=this._controls)===null||nt===void 0)&&nt.zoomOut?{type:"button",label:"Zoom out",value:()=>{var ot;(ot=this._controls)===null||ot===void 0||ot.zoomOut(1)}}:{}}]},this.assetType="model",this.uuid=mn(),this.setDirty=this.setDirty.bind(this),this.targetUpdated=this.targetUpdated.bind(this),this._refreshCameraOptions=this._refreshCameraOptions.bind(this),this._container=a??document.body;const _e=o??this._options;this._camera=this._setCameraObject(s??(_e.type==="OrthographicCamera"?new et.iKG(-1,1,1,-1):new et.cPb)),this._camera.modelObject.userData.iCamera=this;const rt=s;s&&(rt.isPerspectiveCamera?(_e.fov=rt.fov,_e.focus=rt.focus,_e.aspect=rt.aspect<=0||rt.userData.autoAspect?"auto":rt.aspect,_e.zoom=rt.zoom):rt.isOrthographicCamera&&(_e.left=rt.left,_e.right=rt.right,_e.top=rt.top,_e.bottom=rt.bottom,_e.zoom=rt.zoom),_e.near=rt.near,_e.far=rt.far,this._position.copy(s.position),this.refreshTarget()),this.positionUpdated(!1),s||this.targetUpdated(!1),this.setCameraOptions(_e)}get controls(){return this._controls}getControls(){return this._controls}get isActiveCamera(){return this._isActiveCamera}get target(){return this._target}set target(s){const o=this._target.sub(s).length()>1e-5;this._target.copy(s),o&&this.targetUpdated()}get position(){return this._position}set position(s){const o=this._position.sub(s).length()>1e-5;this._position.copy(s),o&&this.positionUpdated()}get name(){return this._camera.name}set name(s){this._camera.name=s}getCameraOptions(){return{...this._options,position:this._position.toArray(),target:this._target.toArray()}}setCameraOptions(s,o=!0){var a,_e;const rt={...s};!((a=rt.position)===null||a===void 0)&&a.isVector3&&(rt.position=[rt.position.x,rt.position.y,rt.position.z]),!((_e=rt.target)===null||_e===void 0)&&_e.isVector3&&(rt.target=[rt.target.x,rt.target.y,rt.target.z]),Object.keys(rt).forEach(nt=>nt!=="frustumSize"&&rt[nt]===void 0&&delete rt[nt]),Object.assign(this._options,rt),this._refreshCameraOptions(!1),this.refreshCameraControls(!1),o&&this.setDirty()}_refreshCameraOptions(s=!0){let o=this._camera.modelObject;if(this._options.type!==o.type){const _e=this._options.type==="PerspectiveCamera"?new et.cPb:new et.iKG;_e.name=this._camera.name,_e.near=this._camera.modelObject.near,_e.far=this._camera.modelObject.far,_e.zoom=this._camera.modelObject.zoom,_e.scale.copy(this._camera.modelObject.scale);const rt=this._isActiveCamera;rt&&this.deactivateMain(),this._camera=this._setCameraObject(_e),o=this._camera.modelObject,rt&&this.activateMain(),this._camera.modelObject.updateProjectionMatrix()}let a=this._options.aspect;if(a==="auto"&&(a=this._container.clientWidth/this._container.clientHeight),this._options.position&&(this.position.set(...this._options.position),delete this._options.position),this._options.target&&(this.target.set(...this._options.target),delete this._options.target),this.positionTargetUpdated(!1),this._options.type==="PerspectiveCamera"&&(o.fov=this._options.fov,o.focus=this._options.focus,o.aspect=a),this._options.type==="OrthographicCamera"){const _e=this._options.frustumSize;_e!==void 0?(o.top=_e/2,o.bottom=-_e/2,o.left=a*_e/2,o.right=-a*_e/2):(o.top=this._options.top,o.bottom=this._options.bottom,o.left=this._options.left,o.right=this._options.right)}o.zoom=this._options.zoom,this._nearFarChanged(),s&&this.setDirty()}_setCameraObject(s){return this._camera&&this._camera.removeEventListener("objectUpdate",this._cameraObjectUpdate),this._camera=Xo(s),this._camera.addEventListener("objectUpdate",this._cameraObjectUpdate),this._camera}get interactionsEnabled(){return this._interactionsEnabled&&this._isActiveCamera&&this._options.controlsEnabled}set interactionsEnabled(s){this._interactionsEnabled!==s&&(this._interactionsEnabled=s,this.refreshCameraControls(!0))}_nearFarChanged(){this._camera&&(this._camera.modelObject.near=this.near,this._camera.modelObject.far=this.far,this._camera.modelObject.updateProjectionMatrix())}refreshAspect(s=!0){this._options.aspect==="auto"&&this._refreshCameraOptions(s)}refreshTarget(){var s;!((s=this._controls)===null||s===void 0)&&s.enabled&&this._controls.target?this._target.copy(this._controls.target):this._target.set(0,0,-1).applyQuaternion(this._camera.modelObject.getWorldQuaternion(new et._fP))}setControlsCtor(s,o,a=!1){a||!this._controlsCtors.has(s)?this._controlsCtors.set(s,o):console.error(s+" already exists.")}removeControlsCtor(s){this._controlsCtors.delete(s)}_initCameraControls(){var s,o,a;const _e=this._options.controlsMode;this._controls=(o=(s=this._controlsCtors.get(_e))===null||s===void 0?void 0:s(this._camera.modelObject,this._container))!==null&&o!==void 0?o:void 0,this._controls||console.error("Unable to create controls with mode "+_e+". Are you missing a plugin?"),(a=this._controls)===null||a===void 0||a.addEventListener("change",this.setDirty),this._controlsMode=this._controls?_e:""}_disposeCameraControls(){var s,o;this._controlsMode,(s=this._controls)===null||s===void 0||s.removeEventListener("change",this.setDirty),(o=this._controls)===null||o===void 0||o.dispose(),this._controlsMode="",this._controls=void 0}refreshCameraControls(s=!0){var o,a;if(this._options.controlsEnabled){const _e=this._options.controlsMode;this._controls?this._controlsMode===_e&&this._camera.modelObject===this._controls.object||(this._disposeCameraControls(),this._initCameraControls()):this._initCameraControls(),this._controlsMode=_e}if(this._controls){const _e=this.interactionsEnabled;this._controls.enabled=_e,_e&&this._camera.modelObject.up.copy(et.Tme.DefaultUp)}s&&this.setDirty(),(a=(o=this.uiConfig).uiRefresh)===null||a===void 0||a.call(o,"postFrame",!0)}setDirty(s){this._position.copy(this._camera.modelObject.position),this._controls&&this._controls.enabled&&this._controls.target&&this._target.copy(this._controls.target),this._camera.modelObject.fov!==void 0&&(this._options.fov=this._camera.modelObject.fov),this._camera.modelObject.focus!==void 0&&(this._options.focus=this._camera.modelObject.focus),this._camera.modelObject.zoom!==void 0&&(this._options.zoom=this._camera.modelObject.zoom),this.dispatchEvent({...s,type:"update"}),this._camUi.forEach(o=>{var a;return(a=o==null?void 0:o.uiRefresh)===null||a===void 0?void 0:a.call(o,"postFrame",!1,1)})}activateMain(s=!0){var o,a;this._isActiveCamera||(this._isActiveCamera=!0,this._camera.modelObject.userData.__lastScale=this._camera.modelObject.scale.clone(),this._camera.modelObject.scale.divide(this._camera.modelObject.getWorldScale(new et.Pa4)),s&&(this.refreshCameraControls(!0),this.refreshAspect()),(a=(o=this._camera).setDirty)===null||a===void 0||a.call(o,{change:"activateMain"}))}deactivateMain(s=!0){this._isActiveCamera&&(this._isActiveCamera=!1,this._camera.modelObject.userData.__lastScale&&(this._camera.modelObject.scale.copy(this._camera.modelObject.userData.__lastScale),delete this._camera.modelObject.userData.__lastScale),s&&this.refreshCameraControls(!0))}get cameraObject(){return this._camera.modelObject}get modelObject(){return this._camera.modelObject}dispose(){this._disposeCameraControls()}targetUpdated(s=!0){var o,a;const _e=this.target;(a=(o=this._controls)===null||o===void 0?void 0:o.target)===null||a===void 0||a.set(_e.x,_e.y,_e.z),this._controls&&this._controls.enabled&&this._controls.target?s&&this.setDirty():this._camera&&(this.autoLookAtTarget&&this._camera.modelObject.lookAt(_e),s&&this.setDirty())}positionUpdated(s=!0){const o=this.position;this._camera.modelObject.position.set(o.x,o.y,o.z),s&&this.setDirty()}positionTargetUpdated(s=!0){this.positionUpdated(!1),this.targetUpdated(s)}copyFromCamera(s,o=4){s.getWorldPosition(this._position),s.getWorldDirection(this._target).multiplyScalar(o).add(this._position),this.positionTargetUpdated(!1),this.setCameraOptions({fov:s.fov,focus:s.focus,zoom:s.zoom,type:s.type},!0)}updateShaderProperties(s){var o;return!((o=s.uniforms.cameraPositionWorld)===null||o===void 0)&&o.value&&this._camera.modelObject.getWorldPosition(s.uniforms.cameraPositionWorld.value),s.uniforms.cameraNearFar?s.uniforms.cameraNearFar.value.set(this._camera.modelObject.near,this._camera.modelObject.far):console.warn("BaseRenderer: no uniform: cameraNearFar"),s.uniforms.projection&&(s.uniforms.projection.value=this._camera.modelObject.projectionMatrix),s.defines.PERSPECTIVE_CAMERA=this._camera.modelObject.type==="PerspectiveCamera"?"1":"0",s.defines.ORTHOGRAPHIC_CAMERA=this._camera.modelObject.type==="OrthographicCamera"?"1":"0",this}toJSON(s){return Object.assign({},rs(this,!0,s))}fromJSON(s,o){return In(s,this,!0,o),this.positionTargetUpdated(!1),this.refreshCameraOptions(),this.setDirty(),this}refreshCameraOptions(s=!0){this.setCameraOptions(this._options,s)}get visible(){return!0}set visible(s){console.error("Cannot set visible on camera",s)}}_v([Yr("camControls")],Rp.prototype,"_controls",void 0),_v([Yr()],Rp.prototype,"userData",void 0),_v([vr(Rp.prototype._nearFarChanged)],Rp.prototype,"near",void 0),_v([vr(Rp.prototype._nearFarChanged)],Rp.prototype,"far",void 0),_v([Yr("camOptions")],Rp.prototype,"_options",void 0),_v([Yr("position")],Rp.prototype,"_position",void 0),_v([Yr("target")],Rp.prototype,"_target",void 0);var SA=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};class P_ extends et.xsS{constructor(s){super(),this.isRootScene=!0,this.assetType="model",this._sceneBounds=new cn,this._sceneBoundingRadius=0,this._cameras=[],this._activeCamera=-1,this.envMapIntensity=1,this._dummyCam=new Rp(new et.cPb,{controlsMode:"",controlsEnabled:!1}),this.environment=null,this.background=null,this.minNearDistance=.2,this.setDirty=this.setDirty.bind(this),this.updateScene=this.updateScene.bind(this),this.refreshActiveCameraNearFar=this.refreshActiveCameraNearFar.bind(this),this._activeCameraUpdate=this._activeCameraUpdate.bind(this),this._onSceneMaterialUpdate=this._onSceneMaterialUpdate.bind(this),this._onSceneUpdate=this._onSceneUpdate.bind(this),this.addEventListener("materialUpdate",this._onSceneMaterialUpdate),this.addEventListener("objectUpdate",this._onSceneUpdate),this.defaultCamera=s,this.modelRoot=Xo(new et.ZAu,void 0),this.modelRoot.userData.rootSceneModelRoot=!0,this.modelRoot.name="Scene",this.modelRoot.addEventListener("update",this.setDirty),this.addSceneObject(this.modelRoot,{addToRoot:!0,autoScale:!1}),this.addSceneObject(this.defaultCamera,{addToRoot:!0}),this.activeCamera=this.defaultCamera,this.boxHelper=new et.GQ(this.getBounds())}refreshEnvMapIntensity(s){return s!=null&&s.isObject3D||(s=this),(s??this).traverse(o=>{(Array.isArray(o.material)?o.material:[o.material]).forEach(a=>{a&&a.envMapIntensity!==void 0&&!a.userData.separateEnvMapIntensity&&(a.envMapIntensity=this.envMapIntensity,a.needsUpdate=!0)})}),this.setDirty(),this}get activeCamera(){return this._activeCamera>=0?this._cameras[this._activeCamera]:this._dummyCam}set activeCamera(s){const o=this.activeCamera;if(s||(s=this.defaultCamera),o!==s){if(o&&(o.deactivateMain(),o.removeEventListener("update",this._activeCameraUpdate)),s){s.activateMain(),s.addEventListener("update",this._activeCameraUpdate);let a=this._cameras.indexOf(s);a<0&&(this._cameras.push(s),a=this._cameras.length-1),this._activeCamera=a}else this._activeCamera=-1;this.dispatchEvent({type:"activeCameraChange",lastCamera:o,camera:s}),this.setDirty()}}get modelObject(){return this}addModel(s,o={}){return s.assetType!=="model"&&console.error("Invalid asset type for ",s,", adding anyway"),this.addSceneObject(s,o)}addWidget(s,o={}){s.assetType!=="widget"&&console.warn("Invalid asset type for ",s,", adding anyway"),this.add(s.modelObject)}_addModel(s,o={}){return this._addObject3D(s==null?void 0:s.modelObject,o)}addSceneObject(s,o){if(!s)return s;const a=s.assetType;let _e=!1;switch(a){case"model":_e=s.modelObject.isCamera,_e&&(o={...o,autoScale:!1}),this._addModel(s,o);break;case"material":break;case"texture":this.dispatchEvent({type:"textureAdded",texture:s});break;case"light":this._addLight(s,o);break;default:console.warn("Unknown asset imported",s,a)}return this.dispatchEvent({type:"addSceneObject",object:s}),s}_addObject3D(s,{autoScale:o=!0,autoScaleRadius:a=2,addToRoot:_e=!1}={}){const rt=s;rt?(o&&!rt.userData.autoScaled&&ps(rt,rt.userData.autoScaleRadius||a),rt.traverse(nt=>{nt.isMesh&&!nt.userData.__keepShadowDef&&(nt.castShadow=!0,nt.receiveShadow=!0,nt.userData.__keepShadowDef=!0)}),this.refreshEnvMapIntensity(rt),_e?this.modelObject.add(rt):this.modelRoot.add(rt),this.setDirty()):console.error("Invalid Model, cannot add.")}removeSceneModels(){this.modelRoot.clear(),this.modelRoot.children=[],this.setDirty({sceneUpdate:!0})}disposeSceneModels(){this.modelRoot.children.forEach(s=>{var o,a;((o=s.dispose)!==null&&o!==void 0?o:(a=s.modelObject)===null||a===void 0?void 0:a.removeFromParent)()}),this.setDirty({sceneUpdate:!0})}_onEnvironmentChange(){this.dispatchEvent({type:"environmentChanged",environment:this.getEnvironment()}),this._onSceneUpdate()}add(...s){return super.add(...s.map(o=>Xo(o))),this._onSceneUpdate(),this}setEnvironment(s){if(!s)return this.environment=null,this.dispatchEvent({type:"environmentChanged"}),void this._onSceneUpdate();if((s==null?void 0:s.assetType)!=="texture")return void console.error("Unknown Environment type",s);s.mapping===et.xfE&&(s.mapping=et.dSO,s.needsUpdate=!0);const o=s.textureObject||s;this.environment=o,this._onEnvironmentChange()}getEnvironment(){return this.environment}setBackground(s){var o;let a;if(!s||s.assetType==="texture"||s.isColor||s.isVector4)a=((o=s)===null||o===void 0?void 0:o.assetType)==="texture"&&s.textureObject||s;else{if(typeof s!="string"&&typeof s!="number")return void console.error("Unknown Background type",s);a=new et.Ilk(s)}this.background=a,this._onSceneUpdate({geometryChanged:!1})}getBackground(){return this.background}setDirty(s){return s!=null&&s.sceneUpdate?this._onSceneUpdate(s):this.dispatchEvent({type:"update"}),this}updateScene(s){return this._onSceneUpdate(s)}_activeCameraUpdate(){this.setDirty(),this.refreshActiveCameraNearFar(),this.dispatchEvent({type:"activeCameraUpdate"})}_onSceneUpdate(s={}){var o,a,_e;return s.sceneUpdate===!1?this.setDirty(s):(this.refreshActiveCameraNearFar(),this._sceneBounds=this.getBounds(!1,!0),(_e=(a=(o=this.boxHelper)===null||o===void 0?void 0:o.box)===null||a===void 0?void 0:a.copy)===null||_e===void 0||_e.call(a,this._sceneBounds),this._sceneBoundingRadius=this._sceneBounds.getSize(new et.Pa4).length()/2,this.dispatchEvent({...s,type:"sceneUpdate",hierarchyChanged:["addedToParent","removedFromParent"].includes(s.change||"")}),this)}_onSceneMaterialUpdate(){this.dispatchEvent({type:"sceneMaterialUpdate"})}dispose(){this.clear()}findObjectsByName(s,o){const a=[];return(o??this.modelObject).traverse(_e=>{_e.name===s&&a.push(_e)}),a}addLight(s,o={}){this.addSceneObject(s,o)}_addLight(s,{addToRoot:o=!1}={}){var a;const _e=s.lightObject;_e&&((a=_e.children)===null||a===void 0||a.length,o?this.add(_e):this.modelRoot.add(_e))}getBounds(s=!1,o=!0){return new cn().expandByObject(this.modelObject,s,o)}refreshActiveCameraNearFar(){const s=this.activeCamera;if(!s)return;const o=this.getBounds(!1),a=s.cameraObject.getWorldPosition(new et.Pa4).sub(o.getCenter(new et.Pa4)),_e=1.5*o.getSize(new et.Pa4).length()/2,rt=a.length(),nt=Math.max(this.minNearDistance,rt-_e),ot=Math.max(nt+1,rt+_e);s.near=nt,s.far=ot}updateShaderProperties(s){return s.uniforms.sceneBoundingRadius?s.uniforms.sceneBoundingRadius.value=this._sceneBoundingRadius:console.warn("BaseRenderer: no uniform: frameCount"),this}toJSON(s){return rs(this,!0,s)}fromJSON(s,o){const a=s.environment;return a!==void 0&&(this.setEnvironment(In(a,this.getEnvironment(),!1,o)),delete s.environment),In(s,this,!0,o),s.environment=a,this}addEventListener(s,o){super.addEventListener(s,o)}removeEventListener(s,o){super.removeEventListener(s,o)}}function D_(){const tt=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return tt.style.display="block",tt}function I0(tt,s){const o=s||"/";return tt.join(o)}function Nu(tt,s){const o=window.URL.createObjectURL(tt),a=document.createElement("a");a.style.display="none",a.href=o,a.download=s,document.body.appendChild(a),a.click(),setTimeout(()=>{document.body.removeChild(a),window.URL.revokeObjectURL(o)},1e3)}async function Su(tt){return new Promise((s,o)=>{const a=new FileReader;a.onload=_e=>s(a.result),a.onerror=_e=>o(a.error),a.onabort=_e=>o(new Error("Read aborted")),a.readAsDataURL(tt)})}function _f(tt,s){return Nu(tt,s??tt.name)}async function B_(tt=!1,s=!1,o){const a=document.createElement("input");a.type="file",a.multiple=tt,a.accept=o||"*",a.webkitdirectory=s,a.style.display="none",document.body.appendChild(a),a.click();const _e=await new Promise(rt=>{a.onchange=nt=>{rt(Array.from(a.files||[]))}});return document.body.removeChild(a),_e}function Ll({innerHTML:tt="",id:s,classList:o,addToBody:a=!0,elementTag:_e="div"}){const rt=document.createElement(_e);return s&&(rt.id=s),rt.innerHTML=tt,o&&rt.classList.add(...o),a&&document.body.appendChild(rt),rt}async function CA(tt){return new Promise((s,o)=>{const a=new Image;a.onload=()=>s(a),a.onerror=o,a.crossOrigin="anonymous",a.decoding="sync",a.src=tt})}function Jv(tt){const s=document.createElement("style");return s.type="text/css",s.innerText=tt,document.head.appendChild(s),s}async function Tx(tt){return new Promise((s,o)=>{const a=document.createElement("script");a.setAttribute("src",tt),a.addEventListener("load",s),a.addEventListener("error",o),document.body.appendChild(a)})}function k_(tt,s=8192,o=!1){var a;if(!tt.width||!tt.height)return"";const _e=document.createElement("canvas");_e.width=Math.min(s,tt.width),_e.height=Math.floor(1+_e.width*tt.height/tt.width);const rt=tt instanceof ImageBitmap,nt=rt&&o&&Math.abs(_e.width-tt.width)<.5?_e.getContext("bitmaprenderer"):void 0;nt?nt.transferFromImageBitmap(tt):(a=_e.getContext("2d"))===null||a===void 0||a.drawImage(tt,0,0,_e.width,_e.height);const ot=_e.toDataURL("image/png");return _e.remove(),rt&&o&&tt.close(),ot}async function Sm(tt){return new Promise((s,o)=>{const a=new Image;a.addEventListener("load",()=>{const _e=document.createElement("canvas");_e.width=a.width,_e.height=a.height;const rt=_e.getContext("2d");if(!rt)return void o(new Error("Could not get 2d context"));rt.drawImage(a,0,0,_e.width,_e.height);const nt=rt.getImageData(0,0,_e.width,_e.height);s(nt),_e.remove(),a.remove()},!1),a.addEventListener("error",_e=>{a.remove(),o(_e)},!1),a.src=tt})}function bo(){return(typeof performance>"u"?Date:performance).now()}function Nw(){let tt=!1;return s=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(s)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(s.substr(0,4)))&&(tt=!0),tt;var s}function O_(tt,s=null){var o;return(o=new URL(window.location.href).searchParams.get(tt))!==null&&o!==void 0?o:s}function hp(tt,s,o=!1){const a=new URLSearchParams(location.search);s==null?a.has(tt)&&a.delete(tt):a.set(tt,s),o?window.location.search=a.toString():window.history.replaceState({},"","?"+a.toString())}function P0(tt){return tt.replace(/\w\S*/g,function(s){return s.charAt(0).toUpperCase()+s.substr(1).toLowerCase()})}function Fu(tt,{backgroundColor:s="",displayPixelRatio:o=1,width:a=512,height:_e=512}){const rt=document.createElement("canvas"),nt=rt.getContext("2d"),ot=o,ct=a,pt=_e;return rt.width=ct*ot,rt.height=pt*ot,rt.style.width=`${ct}`,rt.style.height=`${pt}`,(s==null?void 0:s.length)>0&&(nt.fillStyle=s,nt.fillRect(0,0,rt.width,rt.height)),nt.drawImage(tt,0,0,rt.width,rt.height),rt}SA([Yr()],P_.prototype,"defaultCamera",void 0),SA([vr(P_.prototype.refreshEnvMapIntensity),Yr()],P_.prototype,"envMapIntensity",void 0),SA([Yr()],P_.prototype,"environment",void 0),ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(tt,s){const o=new Uint8Array(this);s==null&&(s=o.length);const a=new ArrayBuffer(s-tt),_e=new Uint8Array(a);for(let rt=0;rt<_e.length;rt++)_e[rt]=o[rt+tt];return a});class Uu{static ApplyMaterialExtensions(s,o,a,_e){for(const rt of a)this.ApplyMaterialExtension(s,o,rt,_e)}static ApplyMaterialExtension(s,o,a,_e){var rt,nt;let ot=(rt=er(a.parsFragmentSnippet,_e,s))!==null&&rt!==void 0?rt:"";ot.length&&(o.fragmentShader=o.fragmentShader.replace(this.FragVoidMain,`
${ot}
${this.FragVoidMain}`)),ot=(nt=er(a.parsVertexSnippet,_e,s))!==null&&nt!==void 0?nt:"",ot.length&&(o.vertexShader=o.vertexShader.replace(this.VertVoidMain,`
${ot}
${this.VertVoidMain}`)),a.extraUniforms&&(o.uniforms=Object.assign(o.uniforms,a.extraUniforms)),a.shaderExtender&&a.shaderExtender(o,s,_e),s.lastShader=o}static CacheKeyForExtensions(s,o){let a="";for(const _e of o)a+=this.CacheKeyForExtension(s,_e);return a}static CacheKeyForExtension(s,o){let a="";return o.customCacheKey&&(a+=o.customCacheKey),o.computeCacheKey&&(a+=o.computeCacheKey(s)),a}static RegisterExtensions(s,o){const a=[];if(o)for(const _e of o)_e.isCompatible&&_e.isCompatible(s)&&(a.push(_e),_e.uuid||(_e.uuid=Mo()),_e.setDirty||(_e.setDirty=()=>{_e.updateVersion||(_e.updateVersion=0),_e.updateVersion++}));return s.materialExtensions=a,s.__ext_beforeRenderListen||(s.__ext_beforeRenderListen=!0,s.addEventListener("beforeRender",_e=>function(rt,{object:nt,renderer:ot}){var ct;(ct=rt.materialExtensions)===null||ct===void 0||ct.forEach(pt=>{var ht,_t;(ht=pt.onObjectRender)===null||ht===void 0||ht.call(pt,nt,rt,ot),rt.lastShader&&((_t=er(pt.updaters))===null||_t===void 0||_t.forEach(Et=>Et==null?void 0:Et.updateShaderProperties(rt.lastShader))),pt.updateVersion!==rt.materialObject.userData["_"+pt.uuid+"_version"]&&(rt.materialObject.userData["_"+pt.uuid+"_version"]=pt.updateVersion,rt.materialObject.needsUpdate=!0)})}(s,_e))),s.__ext_afterRenderListen||(s.__ext_afterRenderListen=!0,s.addEventListener("afterRender",_e=>function(rt,{object:nt,renderer:ot}){var ct;(ct=rt.materialExtensions)===null||ct===void 0||ct.forEach(pt=>{var ht;(ht=pt.onAfterRender)===null||ht===void 0||ht.call(pt,nt,rt,ot)})}(s,_e))),a}}Uu.FragVoidMain="void main() {",Uu.VertVoidMain="void main() {";class L_ extends et.jyz{constructor(s){var o;super(s),this.typeSlug="shaderMat",this.assetType="material",this.materialObject=this,this.materialExtensions=[],this.extraUniformsToUpload={},this.materialExtensions=Uu.RegisterExtensions(this,(o=s==null?void 0:s.customMaterialExtensions)!==null&&o!==void 0?o:[])}registerMaterialExtensions(s){this.materialExtensions=[...this.materialExtensions,...Uu.RegisterExtensions(this,s)]}unregisterMaterialExtensions(s){}onBeforeCompile(s,o){Uu.ApplyMaterialExtensions(this,s,this.materialExtensions,o),s.fragmentShader=s.fragmentShader.replaceAll("#glMarker","// "),this.dispatchEvent({type:"beforeCompile",shader:s,renderer:o}),super.onBeforeCompile(s,o)}customProgramCacheKey(){return super.customProgramCacheKey()+Uu.CacheKeyForExtensions(this,this.materialExtensions)+this.userData.inverseAlphaMap}onBeforeRender(s,o,a,_e,rt){super.onBeforeRender(s,o,a,_e,rt),this.dispatchEvent({type:"beforeRender",renderer:s,scene:o,camera:a,geometry:_e,object:rt})}onAfterRender(s,o,a,_e,rt){super.onAfterRender(s,o,a,_e,rt),this.dispatchEvent({type:"afterRender",renderer:s,scene:o,camera:a,geometry:_e,object:rt})}toJSON(s){throw new Error("Method not supported for this material.")}fromJSON(s,o){throw new Error("Method not supported for this material.")}copyProps(s){throw new Error("Method not supported for this material.")}setDirty(s){}}class $u extends L_{constructor(s,o){super(s),this.typeSlug="shaderMat",this.textures=[],this.setTextureIds(o)}setTextureIds(s){this.textures.map(o=>o.id).join(";")!==s.join(";")&&(this.textures=s.map(o=>({id:o,encoding:et.rnI})),this.setDirty())}_setUniformTexSize(s,o){var a,_e,rt,nt;if(!o||!s)return;const ot=(_e=(a=o.image)===null||a===void 0?void 0:a.width)!==null&&_e!==void 0?_e:512,ct=(nt=(rt=o.image)===null||rt===void 0?void 0:rt.height)!==null&&nt!==void 0?nt:512,pt=s.value;pt.isVector2||console.warn("uniform is not a Vector2"),pt&&Math.abs(pt.x-ot)+Math.abs(pt.y-ct)>.1&&(pt.x=ot,pt.y=ct,this.uniformsNeedUpdate=!0)}onBeforeRender(s,o,a,_e,rt){var nt,ot;this._setUniformTexSize(this.uniforms.screenSize,(nt=s.getRenderTarget())===null||nt===void 0?void 0:nt.texture);for(const ct of this.textures){const pt=ct.id,ht=(ot=this.uniforms[pt])===null||ot===void 0?void 0:ot.value;ht&&(this._setUniformTexSize(this.uniforms[pt+"Size"],ht),ht.encoding!==ct.encoding&&(ct.encoding=ht.encoding,this.needsUpdate=!0))}super.onBeforeRender(s,o,a,_e,rt)}onBeforeCompile(s,o){s.fragmentShader=this.textures.map(a=>{var _e,rt;return`uniform sampler2D ${a.id}; 
`+Rn((_e=a.id)!==null&&_e!==void 0?_e:"input",(rt=a.encoding)!==null&&rt!==void 0?rt:et.rnI)}).join(`
`)+s.fragmentShader,super.onBeforeCompile(s,o)}customProgramCacheKey(){return super.customProgramCacheKey()+this.textures.map(s=>s.id+s.encoding).join(";")}toJSON(s){throw new Error("Method not supported for this material.")}fromJSON(s,o){throw new Error("Method not supported for this material.")}copyProps(s){throw new Error("Method not supported for this material.")}setDirty(s){this.needsUpdate=!0,this.dispatchEvent({...s,type:"materialUpdate"})}}function Ro(tt,...s){const o=tt.fragmentShader;return new $u({defines:Object.assign({},tt.defines),uniforms:tt.uniforms,vertexShader:tt.vertexShader,fragmentShader:o},s)}class Ru extends Rt{constructor(s,...o){super(s.isMaterial?s:Ro(s,...o),o.length<1?Ru.DEFAULT_TEX_ID:o[0]),this.onDirty=[],this.isShaderPass2=!0,this.enabled=!0,this.setDirty=this.setDirty.bind(this)}dispose(){var s,o,a,_e;(o=(s=this.material)===null||s===void 0?void 0:s.dispose)===null||o===void 0||o.call(s),(_e=(a=this.fsQuad)===null||a===void 0?void 0:a.dispose)===null||_e===void 0||_e.call(a),this.onDirty=[]}setDirty(){this.onDirty.forEach(s=>s())}updateShaderProperties(s){s&&(Array.isArray(s)||(s=[s]),s.forEach(o=>o==null?void 0:o.updateShaderProperties(this.material)))}render(s,o,a,_e,rt){this.enabled&&super.render(s,o,a,_e,rt)}}Ru.DEFAULT_TEX_ID="tDiffuse",function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);rt>3&&nt&&Object.defineProperty(s,o,nt)}([ds("Enabled"),Yr()],Ru.prototype,"enabled",void 0);class na extends dt{constructor(s,o,a,_e,rt){super(),this.scene=s,this.camera=o,this.overrideMaterial=a,this.clearColor=_e,this.clearAlpha=rt!==void 0?rt:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new et.Ilk}render(s,o,a,_e,rt,nt){const ot=s.autoClear;let ct,pt;if(s.autoClear=!1,this.overrideMaterial!==void 0&&(pt=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(s.getClearColor(this._oldClearColor),ct=s.getClearAlpha(),s.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&s.clearDepth(),s.setRenderTarget(this.renderToScreen?null:a),nt){const ht=s.getContext();ht.framebufferRenderbuffer(ht.FRAMEBUFFER,ht.DEPTH_ATTACHMENT,ht.RENDERBUFFER,nt)}if(this.clear&&s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil),s.render(this.scene,this.camera),nt){const ht=s.getContext();ht.framebufferRenderbuffer(ht.FRAMEBUFFER,ht.DEPTH_ATTACHMENT,ht.RENDERBUFFER,null)}this.clearColor&&s.setClearColor(this._oldClearColor,ct),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=pt),s.autoClear=ot}}class TA extends Ru{constructor(s,o="c = a + b;",a="",_e){super({vertexShader:ut.vertexShader,fragmentShader:Wt`
                varying vec2 vUv;
                
                ${a}
                
                void blend(in vec4 a, in vec4 b, inout vec4 c){
                
                ${o}
                
                }
                void main() {
                    vec4 texel = vec4(0);
                    blend(tDiffuseTexelToLinear ( texture2D( tDiffuse, vUv ) ), tDiffuse2TexelToLinear ( texture2D( tDiffuse2, vUv ) ), texel);
                    texel = clamp(texel, vec4(0), vec4(8));
                    gl_FragColor = texel;
                    #include <encodings_fragment>
                }
            `,uniforms:{tDiffuse:{value:null},tDiffuse2:{value:_e},...s}},"tDiffuse","tDiffuse2"),this.clear=!1,this.needsSwap=!0}}class em extends et.jyz{constructor(s=!0){super({vertexShader:`#ifdef USE_ALPHAMAP
#define USE_UV 
#endif
#include <uv_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
out vec3 vViewPosition;void main(){
#include <uv_vertex>
#include <beginnormal_vertex>
#include <morphnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <defaultnormal_vertex>
#include <normal_vertex>
#include <begin_vertex>
#include <morphtarget_vertex>
#include <skinning_vertex>
#include <displacementmap_vertex>
#include <project_vertex>
#include <logdepthbuf_vertex>
#include <clipping_planes_vertex>
vViewPosition=-mvPosition.xyz;}`,fragmentShader:`#ifdef USE_ALPHAMAP
#define USE_UV 
#include <packing>
uniform float alphaTest;
#endif
#ifndef gl_FragColor 
layout(location=0)out vec4 A;layout(location=1)out vec4 B;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <alphamap_pars_fragment>
uniform vec2 cameraNearFar;uniform vec4 flags;in vec3 vViewPosition;vec2 pack16(float value){float sMax=65535.;int v=int(clamp(value,0.,1.)*sMax+0.5);int digit0=v/256;int digit1=v-digit0*256;return vec2(float(digit0)/255.,float(digit1)/255.);}vec2 packNormal(vec3 n){float p=sqrt(n.z*8.+8.);return vec2(n.xy/p+0.5);}float linstep(float edge0,float edge1,float value){return clamp((value-edge0)/(edge1-edge0),0.,1.);}void main(){
#ifdef USE_ALPHAMAP
#ifdef ALPHA_I_RGBA_PACKING
if(1.-unpackRGBAToDepth(texture2D(alphaMap,vUv))<alphaTest)
#else
if(texture2D(alphaMap,vUv).g<alphaTest)
#endif
discard;
#endif
#include <normal_fragment_begin>
#ifdef FORCED_LINEAR_DEPTH
float linearZ=float(FORCED_LINEAR_DEPTH);
#else
float linearZ=linstep(-cameraNearFar.x,-cameraNearFar.y,-vViewPosition.z);
#endif
vec2 packedZ=pack16(pow(linearZ,0.5));vec2 packedNormal=packNormal(normal);
#ifndef gl_FragColor 
A=vec4(packedZ.x,packedZ.y,packedNormal.x,packedNormal.y);B=flags;
#else
gl_FragColor=vec4(packedZ.x,packedZ.y,packedNormal.x,packedNormal.y);
#endif
}`,uniforms:{cameraNearFar:{value:new et.FM8(.1,1e3)},alphaMap:{value:null},alphaTest:{value:null},flags:{value:new et.Ltg(1,1,1,1)}},glslVersion:s?et.LSk:et.v9Y})}onBeforeRender(s,o,a,_e,rt){var nt,ot,ct;let pt=rt.material;Array.isArray(pt)&&(pt=pt[0]),this.uniforms.alphaMap.value=(nt=pt==null?void 0:pt.alphaMap)!==null&&nt!==void 0?nt:null,this.uniforms.alphaTest.value=!pt||!pt.alphaTest||pt.alphaTest<1e-7?.001:pt.alphaTest,this.uniforms.flags.value.x=(pt==null?void 0:pt.userData.postTonemap)===!1?0:1,this.uniforms.flags.value.y=pt!=null&&pt.userData._ssBevel?(pt==null?void 0:pt.userData._ssBevel.radius)/255:0,this.uniforms.flags.value.z=(pt!=null&&pt.userData.matId?pt==null?void 0:pt.userData.matId:0)/255,this.uniforms.flags.value.w=pt!=null&&pt.userData.enableLUT?pt==null?void 0:pt.userData.enableLUT:0,this.uniformsNeedUpdate=!0;let ht=this.uniforms.alphaMap.value?1:void 0;ht!==this.defines.USE_ALPHAMAP&&(ht===void 0?delete this.defines.USE_ALPHAMAP:this.defines.USE_ALPHAMAP=ht,this.needsUpdate=!0),ht=pt.userData.ALPHA_I_RGBA_PACKING?1:void 0,ht!==this.defines.ALPHA_I_RGBA_PACKING&&(ht===void 0?delete this.defines.ALPHA_I_RGBA_PACKING:this.defines.ALPHA_I_RGBA_PACKING=ht,this.needsUpdate=!0),ht=(ot=pt.userData.forcedLinearDepth)!==null&&ot!==void 0?ot:void 0,ht!==this.defines.FORCED_LINEAR_DEPTH&&(ht===void 0?delete this.defines.FORCED_LINEAR_DEPTH:this.defines.FORCED_LINEAR_DEPTH=ht,this.needsUpdate=!0),this.side=(ct=pt.side)!==null&&ct!==void 0?ct:et.ehD}}var Zv=`#ifndef UNPACK_GBUFFER_SNIPPET
#define UNPACK_GBUFFER_SNIPPET 
uniform sampler2D tNormalDepth;float unpack16(vec2 value){return(value.x*0.996108949416342426275150501169264316558837890625+value.y*0.00389105058365758760263730664519243873655796051025390625);}vec3 unpackNormal(vec2 enc){vec2 fenc=enc*4.-2.;float f=dot(fenc,fenc);float g=sqrt(1.-f/4.);return vec3(fenc*g,1.-f/2.);}float unpackDepth(vec2 uncodedDepth){float x=unpack16(uncodedDepth.xy);return x*x;}float getDepth(vec2 uv){vec4 uncodedDepth=texture2D(tNormalDepth,uv);return unpackDepth(uncodedDepth.xy);}void getDepthNormal(const in vec2 uv,out float depth,out vec3 normal){vec4 uncodedDepth=texture2D(tNormalDepth,uv);depth=unpackDepth(uncodedDepth.xy);normal=unpackNormal(uncodedDepth.zw);}vec3 getViewNormal(const in vec2 uv){return unpackNormal(texture2D(tNormalDepth,uv).zw);}
#if defined(GBUFFER_HAS_FLAGS) && GBUFFER_HAS_FLAGS == 1
uniform sampler2D tGBufferFlags;
#endif
vec4 getGBufferFlags(const in vec2 uv){
#if defined(GBUFFER_HAS_FLAGS) && GBUFFER_HAS_FLAGS == 1
return texture2D(tGBufferFlags,uv);
#else
return vec4(1.);
#endif
}
#endif
`;const N_={name:"",fog:!0,blending:et.bdR,side:et.Wl3,vertexColors:!1,opacity:1,transparent:!1,blendSrc:et.k74,blendDst:et.LgZ,blendEquation:et.bGH,blendSrcAlpha:null,blendDstAlpha:null,blendEquationAlpha:null,depthFunc:et.vCF,depthTest:!0,depthWrite:!0,stencilWriteMask:255,stencilFunc:et.cum,stencilRef:0,stencilFuncMask:255,stencilFail:et.x5V,stencilZFail:et.x5V,stencilZPass:et.x5V,stencilWrite:!1,clippingPlanes:null,clipIntersection:!1,clipShadows:!1,shadowSide:null,colorWrite:!0,precision:null,polygonOffset:!1,polygonOffsetFactor:0,polygonOffsetUnits:0,dithering:!1,alphaTest:0,alphaToCoverage:!1,premultipliedAlpha:!1,visible:!0,toneMapped:!0,userData:{},wireframeLinecap:"round",wireframeLinejoin:"round"};function Wl(tt,s,o,{replaceAll:a=!1,prepend:_e=!1,append:rt=!1}={}){if(!tt.includes(s))return console.error(`${s} not found in shader`),tt;let nt=o;return _e?nt=o+s:rt&&(nt=s+o),a?tt.replaceAll(s,nt):tt.replace(s,nt)}const Fw={...N_,color:"#000000",roughness:0,metalness:0,map:null,lightMap:null,lightMapIntensity:0,aoMap:null,aoMapIntensity:0,emissive:"#000000",emissiveIntensity:0,emissiveMap:null,bumpMap:null,bumpScale:0,normalMap:null,normalMapType:et.IOt,normalScale:new et.FM8(1,1),displacementMap:null,displacementScale:0,displacementBias:0,roughnessMap:null,metalnessMap:null,alphaMap:null,envMap:null,envMapIntensity:0,refractionRatio:0,wireframe:!1,wireframeLinewidth:0,skinning:!1,morphTargets:!1,morphNormals:!1,flatShading:!1,glossiness:0,glossinessMap:null,specularColor:new ys(0),specularColorMap:null},Uw={...Fw,clearcoat:0,clearcoatMap:null,clearcoatRoughness:0,clearcoatRoughnessMap:null,clearcoatNormalScale:new et.FM8(1,1),clearcoatNormalMap:null,reflectivity:.5,sheen:0,sheenColor:new ys(0),sheenColorMap:null,sheenRoughness:1,sheenRoughnessMap:null,specularIntensity:1,specularIntensityMap:null,specularColor:new ys(1,1,1),specularColorMap:null,transmission:0,transmissionMap:null,thickness:0,thicknessMap:null,attenuationDistance:0,attenuationColor:new ys(1,1,1),iridescenceMap:null,iridescenceIOR:1.3,iridescenceThicknessRange:[100,400],iridescenceThicknessMap:null};class tp extends et.EJi{constructor(s){var o;super(s),this.typeSlug=tp.TypeSlug,this.assetType="material",this.materialObject=this,this.isMeshStandardMaterial2=!0,this.extraUniformsToUpload={},this.setDirty=this.setDirty.bind(this),this.userData.setDirty=a=>{console.warn("userData.setDirty is deprecated. Use setDirty instead."),this.setDirty(a)},this.fog=!1,this.userData.enableLUT=!0,this.materialExtensions=Uu.RegisterExtensions(this,(o=s==null?void 0:s.customMaterialExtensions)!==null&&o!==void 0?o:[])}setDirty(s){var o,a;this.needsUpdate=!0,this.dispatchEvent({...s,type:"materialUpdate"}),(a=(o=this._uiConfig)===null||o===void 0?void 0:o.uiRefresh)===null||a===void 0||a.call(o,"postFrame",!0,1)}registerMaterialExtensions(s){this.materialExtensions=[...this.materialExtensions,...Uu.RegisterExtensions(this,s)]}unregisterMaterialExtensions(s){}get uiConfig(){return this._uiConfigChildren||(this._uiConfigChildren=[{type:"input",property:[this,"name"]},{type:"checkbox",property:[this,"wireframe"]},{type:"color",property:[this,"color"],limitedUi:!0},{type:"image",property:[this,"map"]},Bo(this,"map"),{type:"folder",label:"Rough/Metal",limitedUi:!0,children:[{type:"slider",bounds:[0,1],property:[this,"roughness"],limitedUi:!0},{type:"slider",bounds:[0,1],property:[this,"metalness"],limitedUi:!0},{type:"image",property:[this,"roughnessMap"]},Bo(this,"roughnessMap"),{type:"image",property:[this,"metalnessMap"]},Bo(this,"metalnessMap")]},{type:"folder",label:"Bump/Normal",limitedUi:!0,children:[{type:"slider",bounds:[0,.2],stepSize:.001,property:[this,"bumpScale"],hidden:()=>!this.bumpMap},{type:"image",property:[this,"bumpMap"]},Bo(this,"bumpMap"),{type:"image",property:[this,"normalMap"]},{type:"vec2",property:[this,"normalScale"],hidden:()=>!this.normalMap},{type:"dropdown",hidden:()=>!this.normalMap,property:[this,"normalMapType"],children:[["TangentSpace",et.IOt],["ObjectSpace",et.PA7]].map(s=>({label:s[0],value:s[1]}))},Bo(this,"normalMap"),{type:"input",property:[this,"displacementScale"],hidden:()=>!this.displacementMap},{type:"image",property:[this,"displacementMap"]},Bo(this,"displacementMap")]},{type:"folder",label:"Sheen",children:[{type:"slider",bounds:[0,1],property:[this,"sheen"]},{type:"color",hidden:()=>this.sheen<.001,property:[this,"sheenColor"]},{type:"image",property:[this,"sheenColorMap"]},Bo(this,"sheenColorMap"),{type:"slider",bounds:[0,1],property:[this,"sheenRoughness"]},{type:"image",property:[this,"sheenRoughnessMap"]},Bo(this,"sheenRoughnessMap")]},{type:"folder",label:"Clearcoat",children:[{type:"slider",bounds:[0,1],property:[this,"clearcoat"]},{type:"slider",bounds:[0,1],hidden:()=>this.clearcoat<.001,property:[this,"clearcoatRoughness"]},{type:"image",property:[this,"clearcoatMap"]},Bo(this,"clearcoatMap"),{type:"slider",bounds:[0,1],property:[this,"clearcoatRoughness"]},{type:"image",property:[this,"clearcoatRoughnessMap"]},Bo(this,"clearcoatRoughnessMap"),{type:"image",property:[this,"clearcoatNormalMap"]},{type:"vec2",property:[this,"clearcoatNormalScale"],hidden:()=>!this.clearcoatNormalMap},Bo(this,"clearcoatNormalMap")]},{type:"folder",label:"Emission",children:[{type:"color",property:[this,"emissive"]},{type:"slider",bounds:[0,10],property:[this,"emissiveIntensity"]},{type:"image",property:[this,"emissiveMap"]},Bo(this,"emissiveMap")]},{type:"folder",label:"Refraction",children:[{type:"slider",bounds:[0,1],property:[this,"reflectivity"]},{type:"slider",bounds:[0,1],property:[this,"transmission"],limitedUi:!0},{type:"slider",bounds:[0,1],stepSize:.001,property:[this,"thickness"]},{type:"image",property:[this,"transmissionMap"]},Bo(this,"transmissionMap"),{type:"image",property:[this,"thicknessMap"]},Bo(this,"thicknessMap")]},{type:"folder",label:"Blending",children:[{type:"slider",bounds:[0,1],property:[this,"opacity"]},{type:"checkbox",property:[this,"transparent"],onChange:this.setDirty},{type:"dropdown",property:[this,"depthFunc"],children:[["Never",et.BVF],["Always",et.Se2],["Less",et.Zr5],["LessEqual",et.vCF],["Equal",et.eD],["GreaterEqual",et.ksN],["Greater",et.w$m],["NotEqual",et.M6v]].map(s=>({label:s[0],value:s[1]}))},{type:"checkbox",property:[this,"depthTest"],onChange:this.setDirty},{type:"checkbox",property:[this,"depthWrite"],onChange:this.setDirty},{type:"slider",bounds:[0,1],property:[this,"alphaTest"]},{type:"checkbox",property:[this,"dithering"]},{type:"dropdown",label:"Blending",property:[this,"blending"],children:[["None",Vl],["Normal",Vo],["Additive",et.WMw],["Subtractive",Oo],["Multiply",Lo]].map(s=>({label:s[0],value:s[1]}))},{type:"image",property:[this,"alphaMap"]},Bo(this,"alphaMap"),{type:"checkbox",label:"Render to Depth",getValue:()=>this.userData.renderToDepth===!0,setValue:s=>{this.userData.renderToDepth=s||void 0,this.setDirty()}},{type:"checkbox",label:"Inverse AlphaMap",hidden:()=>!this.transparent,getValue:()=>this.userData.inverseAlphaMap===!0,setValue:s=>{this.userData.inverseAlphaMap=s||void 0,this.setDirty()}}]},{type:"folder",label:"AO/Lightmap",children:[{type:"slider",bounds:[0,2],property:[this,"aoMapIntensity"]},{type:"image",property:[this,"aoMap"]},Bo(this,"aoMap"),{type:"slider",bounds:[0,2],property:[this,"lightMapIntensity"]},{type:"image",property:[this,"lightMap"]},Bo(this,"lightMap")]},{type:"dropdown",label:"Side",property:[this,"side"],children:[["Front",et.Wl3],["Back",et._Li],["Double",et.ehD]].map(s=>({label:s[0],value:s[1]}))},{type:"checkbox",property:[this,"flatShading"]},{type:"checkbox",label:"Enable LUT",getValue:()=>this.userData.enableLUT===!0,setValue:s=>{this.userData.enableLUT=s||void 0,this.setDirty()}},{type:"input",label:"Mesh count",getValue:()=>{var s,o,a;return(a=(o=(s=this.userData)===null||s===void 0?void 0:s.__appliedMeshes)===null||o===void 0?void 0:o.size)!==null&&a!==void 0?a:0},setValue:s=>{},disabled:!0},{type:"button",label:`Download ${this.typeSlug}`,value:()=>{Nu(new Blob([JSON.stringify(this.toJSON(),null,2)],{type:"application/json"}),`physical-material.${this.typeSlug}`)}}]),this._uiConfig||(this._uiConfig={type:"folder",label:"Physical Material",expanded:!0,children:this._uiConfigChildren,uuid:"MSM2_"+this.uuid,limitedUi:!0}),this._uiConfig.children=[...this._uiConfigChildren,...this.materialExtensions.map(s=>{var o;return(o=s.getUiConfig)===null||o===void 0?void 0:o.call(s,this)})].filter(s=>s),this._uiConfig}onBeforeCompile(s,o){const a=[["vec3 totalDiffuse = ","afterModulation"],["#include <aomap_fragment>","beforeModulation"],["#include <lights_physical_fragment>","beforeAccumulation"],["#include <clipping_planes_fragment>","mainStart"]],_e=[["#include <uv_vertex>","mainStart"]];for(const rt of _e)s.vertexShader=Wl(s.vertexShader,rt[0],"#glMarker "+rt[1]+`
`+rt[0]);for(const rt of a)s.fragmentShader=Wl(s.fragmentShader,rt[0],"#glMarker "+rt[1]+`
`+rt[0]);Uu.ApplyMaterialExtensions(this,s,this.materialExtensions,o),s.fragmentShader=s.fragmentShader.replaceAll("#glMarker","// "),s.vertexShader=s.vertexShader.replaceAll("#glMarker","// "),s.defines.INVERSE_ALPHAMAP=this.userData.inverseAlphaMap?1:0,super.onBeforeCompile(s,o)}customProgramCacheKey(){return super.customProgramCacheKey()+Uu.CacheKeyForExtensions(this,this.materialExtensions)+this.userData.inverseAlphaMap}onBeforeRender(s,o,a,_e,rt){super.onBeforeRender(s,o,a,_e,rt),this.dispatchEvent({type:"beforeRender",renderer:s,scene:o,camera:a,geometry:_e,object:rt});const nt=this.userData.inverseAlphaMap?1:0;nt!==this.defines.INVERSE_ALPHAMAP&&(this.defines.INVERSE_ALPHAMAP=nt,this.needsUpdate=!0)}copyProps(s,o=!1){if(!o&&!["MeshStandardMaterial",tp.TYPE,"MeshPhysicalMaterial"].includes(s.type))return console.error("Material type is not supported:",s.type),this;const a={};pr(s,a,Array.from(Object.keys(Uw)));const _e=a.userData;delete a.userData;for(const rt of Object.keys(a))a[rt]===void 0&&delete a[rt];return this.setValues(a),_e&&Ol(this.userData,_e),this.setDirty(),this}toJSON(s){var o,a;const _e=this.userData;this.userData={};const rt=super.toJSON(s);this.userData=_e,rt.userData={},Ol(rt.userData,_e),rt.userData.uuid=this.userData.uuid;const nt=s||{textures:Object.fromEntries(((o=rt.textures)===null||o===void 0?void 0:o.map(ot=>[ot.uuid,ot]))||[]),images:Object.fromEntries(((a=rt.images)===null||a===void 0?void 0:a.map(ot=>[ot.uuid,ot]))||[])};rt.userData=rs(rt.userData,!1,nt),s||(Object.keys(nt.textures).length>0&&(rt.textures=Object.values(nt.textures)),Object.keys(nt.images).length>0&&(rt.images=Object.values(nt.images))),rt.type=tp.TYPE;for(const ot of Object.keys(rt))rt[ot]===void 0&&delete rt[ot];return rt}fromJSON(s,o,a=!1){return Array.isArray(s.normalScale)&&(s.normalScale=new et.FM8().fromArray(s.normalScale)),Array.isArray(s.clearcoatNormalScale)&&(s.clearcoatNormalScale=new et.FM8().fromArray(s.clearcoatNormalScale)),this.copyProps(s,a)}clone(){return super.clone()}}tp.TypeSlug="pmat",tp.TYPE="MeshStandardMaterial2";const $w={...N_,color:"#000000",map:null,lightMap:null,lightMapIntensity:1,aoMap:null,aoMapIntensity:1,alphaMap:null,envMap:null,combine:et.Ns1,reflectivity:1,refractionRatio:.98,wireframe:!1,wireframeLinewidth:0,skinning:!1};class tm extends et.vBJ{constructor(s){var o;super(s),this.typeSlug=tm.TypeSlug,this.assetType="material",this.materialObject=this,this.isMeshBasicMaterial2=!0,this.extraUniformsToUpload={},this.fog=!1,this.setDirty=this.setDirty.bind(this),this.userData.setDirty=a=>{console.warn("userData.setDirty is deprecated. Use setDirty instead."),this.setDirty(a)},this.materialExtensions=Uu.RegisterExtensions(this,(o=s==null?void 0:s.customMaterialExtensions)!==null&&o!==void 0?o:[])}setDirty(s){var o,a;this.needsUpdate=!0,this.dispatchEvent({...s,type:"materialUpdate"}),(a=(o=this._uiConfig)===null||o===void 0?void 0:o.uiRefresh)===null||a===void 0||a.call(o,"postFrame",!0,1)}registerMaterialExtensions(s){this.materialExtensions=[...this.materialExtensions,...Uu.RegisterExtensions(this,s)]}unregisterMaterialExtensions(s){}get uiConfig(){return this._uiConfigChildren||(this._uiConfigChildren=[{type:"input",property:[this,"name"]},{type:"checkbox",property:[this,"wireframe"]},{type:"color",property:[this,"color"],limitedUi:!0},{type:"image",property:[this,"map"]},Bo(this,"map"),{type:"folder",label:"Blending",children:[{type:"slider",bounds:[0,1],property:[this,"opacity"]},{type:"checkbox",property:[this,"transparent"],onChange:this.setDirty},{type:"checkbox",property:[this,"depthWrite"],onChange:this.setDirty},{type:"slider",bounds:[0,1],property:[this,"alphaTest"]},{type:"checkbox",property:[this,"dithering"]},{type:"dropdown",label:"Blending",property:[this,"blending"],children:[["None",Vl],["Normal",Vo],["Additive",et.WMw],["Subtractive",Oo],["Multiply",Lo]].map(s=>({label:s[0],value:s[1]}))},{type:"image",property:[this,"alphaMap"]},Bo(this,"alphaMap"),{type:"checkbox",label:"Render to Depth",getValue:()=>this.userData.renderToDepth===!0,setValue:s=>{this.userData.renderToDepth=s||void 0,this.setDirty()}}]},{type:"folder",label:"AO/Lightmap",children:[{type:"slider",bounds:[0,2],property:[this,"aoMapIntensity"]},{type:"image",property:[this,"aoMap"]},Bo(this,"aoMap"),{type:"slider",bounds:[0,2],property:[this,"lightMapIntensity"]},{type:"image",property:[this,"lightMap"]},Bo(this,"lightMap")]},{type:"dropdown",label:"Side",property:[this,"side"],children:[["Front",et.Wl3],["Back",et._Li],["Double",et.ehD]].map(s=>({label:s[0],value:s[1]}))},{type:"input",label:"Mesh count",getValue:()=>{var s,o,a;return(a=(o=(s=this.userData)===null||s===void 0?void 0:s.__appliedMeshes)===null||o===void 0?void 0:o.size)!==null&&a!==void 0?a:0},setValue:s=>{},disabled:!0},{type:"button",label:`Download ${this.typeSlug}`,value:()=>{Nu(new Blob([JSON.stringify(this.toJSON(),null,2)],{type:"application/json"}),`unlit-material.${this.typeSlug}`)}}]),this._uiConfig||(this._uiConfig={type:"folder",label:"Unlit Material",expanded:!0,children:this._uiConfigChildren,uuid:"MBM2_"+this.uuid,limitedUi:!0}),this._uiConfig.children=[...this._uiConfigChildren,...this.materialExtensions.map(s=>{var o;return(o=s.getUiConfig)===null||o===void 0?void 0:o.call(s,this)})].filter(s=>s),this._uiConfig}onBeforeCompile(s,o){const a=[["vec3 outgoingLight = ","afterModulation"],["#include <aomap_fragment>","beforeModulation"],["ReflectedLight reflectedLight = ","beforeAccumulation"],["#include <clipping_planes_fragment>","mainStart"]],_e=[["#include <uv_vertex>","mainStart"]];for(const rt of _e)s.vertexShader=Wl(s.vertexShader,rt[0],"#glMarker "+rt[1]+`
`+rt[0]);for(const rt of a)s.fragmentShader=Wl(s.fragmentShader,rt[0],"#glMarker "+rt[1]+`
`+rt[0]);Uu.ApplyMaterialExtensions(this,s,this.materialExtensions,o),s.fragmentShader=s.fragmentShader.replaceAll("#glMarker","// "),s.vertexShader=s.vertexShader.replaceAll("#glMarker","// "),super.onBeforeCompile(s,o)}customProgramCacheKey(){return super.customProgramCacheKey()+Uu.CacheKeyForExtensions(this,this.materialExtensions)+this.userData.inverseAlphaMap}onBeforeRender(s,o,a,_e,rt){super.onBeforeRender(s,o,a,_e,rt),this.dispatchEvent({type:"beforeRender",renderer:s,scene:o,camera:a,geometry:_e,object:rt})}copyProps(s,o=!1){if(!o&&!["MeshBasicMaterial",tm.TYPE].includes(s.type))return console.error("Material type is not supported:",s.type),this;const a={};pr(s,a,Array.from(Object.keys($w)));const _e=a.userData;delete a.userData;for(const rt of Object.keys(a))a[rt]===void 0&&delete a[rt];return this.setValues(a),_e&&Ol(this.userData,_e),this.setDirty(),this}toJSON(s){var o,a;const _e=this.userData;this.userData={};const rt=super.toJSON(s);this.userData=_e,rt.userData={},Ol(rt.userData,_e),rt.userData.uuid=this.userData.uuid;const nt=s||{textures:Object.fromEntries(((o=rt.textures)===null||o===void 0?void 0:o.map(ot=>[ot.uuid,ot]))||[]),images:Object.fromEntries(((a=rt.images)===null||a===void 0?void 0:a.map(ot=>[ot.uuid,ot]))||[])};rt.userData=rs(rt.userData,!1,nt),s||(Object.keys(nt.textures).length>0&&(rt.textures=Object.values(nt.textures)),Object.keys(nt.images).length>0&&(rt.images=Object.values(nt.images))),rt.type=tm.TYPE;for(const ot of Object.keys(rt))rt[ot]===void 0&&delete rt[ot];return rt}fromJSON(s,o,a=!1){return this.copyProps(s,a)}clone(){return super.clone()}}tm.TypeSlug="bmat",tm.TYPE="MeshBasicMaterial2";const e_={materialType:tp.TYPE,name:"standard",color:"#ffffff"},D0={materialType:tm.TYPE,name:"basic",color:"#ffffff"},Mx={[tp.TYPE]:e_.name,MeshStandardMaterial:e_.name,MeshPhysicalMaterial:e_.name,[tm.TYPE]:D0.name,MeshBasicMaterial:D0.name};class qm extends it{constructor(){super(),this._templates=[e_,D0],this._materials=[],this._disposeMaterial=s=>{const o=s.target;if(!o||o.assetType!=="material")return;this._refreshTextureRefs();const a=this._getMapsForMaterial(o),_e=[];a.forEach(rt=>{const nt=rt.userData.__appliedMaterials;nt==null||nt.delete(o),nt&&rt.userData.disposeOnIdle!==!1&&nt.size===0&&_e.push(rt)}),_e.forEach(rt=>{rt.dispose()}),this.unregisterMaterial(o)},this._materialExtensions=[],this.processModel=this.processModel.bind(this),this.processMaterial=this.processMaterial.bind(this)}findOrCreate(s,o){let a=this.findMaterial(s);return a||(a=this.generateFromTemplate(s,o)),a}generateFromTemplate(s,o){const a=this.findTemplate(s);if(a)return this._generateFromTemplate(a,o??{})}generateFromTemplateType(s,o){const a=this._templates.find(_e=>_e.materialType===s);if(a)return this._generateFromTemplate(a,o??{})}findTemplate(s){return this._templates.find(o=>o.name===s)}_refreshTextureRefs(){this.getAllMaterials().forEach(s=>{this._getMapsForMaterial(s).forEach(o=>{let a=o.userData.__appliedMaterials;a||(o.userData.__appliedMaterials=a=new Set),a.add(s)})})}_getMapsForMaterial(s){var o;const a=new Set;for(const _e of Object.values(s))_e&&_e.isTexture&&a.add(_e);for(const _e of Object.values((o=s.userData)!==null&&o!==void 0?o:{}))_e&&_e.isTexture&&a.add(_e);return a}registerMaterial(s){if(this._materials.includes(s))return;const o=this.findMaterial(s.uuid);o?console.warn("Material UUID already exists",s,o):(s.addEventListener("dispose",this._disposeMaterial),this._materials.push(s))}registerMaterialObject(s){const o=s.materialObject?s:Object.assign(s,{assetType:"material",materialObject:s});return this.registerMaterial(o),o}unregisterMaterial(s){this._materials=this._materials.filter(o=>o.uuid!==s.uuid),s.removeEventListener("dispose",this._disposeMaterial)}registerMaterialTemplate(s){s.templateUUID||(s.templateUUID=Mo());const o=this._templates.find(a=>a.templateUUID===s.templateUUID);o?console.warn("MaterialTemplate already exists",s,o):this._templates.push(s)}unregisterMaterialTemplate(s){this._templates=this._templates.filter(o=>o.templateUUID!==s.templateUUID)}dispose(){}findMaterial(s){return s?this._materials.find(o=>o.uuid===s):void 0}findMaterialsByName(s){return this._materials.filter(o=>o.name===s)}getMaterialsOfType(s){return s?this._materials.filter(o=>o.typeSlug===s):[]}getAllMaterials(){return[...this._materials]}processModel(s,o){return dr(s,"modelObject",this._processModel(s,o)),s}_processMaterial(s,o){var a,_e,rt;if(!s)return;if(!((a=s.materialObject)===null||a===void 0)&&a.isMaterial)return s;let nt=s.mmMaterial;if(!nt){const ot=((_e=s.userData)===null||_e===void 0?void 0:_e.uuid)||s.uuid;if(nt=this.findMaterial(ot),nt)nt.copyProps(s);else{const ct=o.useSourceMaterial===!1||!s.isMaterial,pt=(rt=o.materialTemplate)!==null&&rt!==void 0?rt:ct?"standard":Mx[s.type]||"standard";nt=this.generateFromTemplate(pt,ct?{}:s)}s.mmMaterial=nt}return nt}processMaterial(s,o){return o.register!==!1&&this.registerMaterial(s),s.materialObject||(s=this._processMaterial(s,{...o,register:!1})),s}registerMaterialExtension(s){this._materialExtensions.includes(s)||this._materialExtensions.push(s)}unregisterMaterialExtension(s){const o=this._materialExtensions.indexOf(s);o>=0&&this._materialExtensions.splice(o,1)}exportMaterial(s,o,a=!0,_e=!1){const rt=rs(s,!1),nt=JSON.stringify(rt,null,a?0:2),ot=(o||s.name||"physical_material")+"."+s.typeSlug,ct=new File([nt],ot,{type:"application/json"});return _e&&_f(ct),ct}}class F_ extends qm{_generateFromTemplate(s,o){var a,_e,rt,nt,ot,ct;let pt;const ht={...s};ht.customMaterialExtensions=[...(a=ht.customMaterialExtensions)!==null&&a!==void 0?a:[],...this._materialExtensions];let _t={};switch(s.materialType){case"MeshStandardMaterial2":case"standard":o&&pr(o,ht,Array.from(Object.keys(Uw))),(o==null?void 0:o.type)==="MeshBasicMaterial"&&(ht.roughness=.9,ht.metalness=0,!((_e=ht.userData)===null||_e===void 0)&&_e.uuid&&delete ht.userData.uuid),_t=(rt=ht.userData)===null||rt===void 0?void 0:rt.uuid,_t&&delete ht.userData.uuid,pt=new tp({customMaterialExtensions:ht.customMaterialExtensions}).fromJSON(ht,void 0,!0),_t&&(pt.uuid=_t),pt.userData.uuid=pt.uuid,pt.setDirty(),o!=null&&o.isMaterial&&o.userData!==void 0&&(o.userData.iMaterial=pt);break;case"MeshBasicMaterial2":case"basic":case"unlit":o&&pr(o,ht,Array.from(Object.keys($w))),_t=(nt=ht.userData)===null||nt===void 0?void 0:nt.uuid,_t&&delete ht.userData.uuid,pt=new tm({customMaterialExtensions:ht.customMaterialExtensions}).fromJSON(ht,void 0,!0),_t&&(pt.uuid=_t),pt.userData.uuid=pt.uuid,pt.setDirty();break;case"shadow":throw"TODO: Not implemented shadow material";default:_t=null,o&&o.userData&&(_t=o.userData,delete o.userData),pt=((ot=s.generator)===null||ot===void 0?void 0:ot.call(s,ht,o))||void 0,o&&_t&&(o.userData=_t),_t&&pt&&(Ol(pt.userData,_t),_t!=null&&_t.uuid&&(pt.uuid=_t.uuid),_t=null),pt&&(pt.userData.uuid=pt.uuid)}if(pt){o.runtimeMaterial&&(pt.userData.__runtimeMaterial=!0);const Et=pt;if(pt.clone=()=>{Et.userData.cloneId||(Et.userData.cloneId="0",Et.userData.cloneCount=0),Et.userData.cloneCount+=1;const St=this.generateFromTemplate(s.name);return St&&(St.copyProps(Et),St.userData.cloneId=St.userData.cloneId+"_"+Et.userData.cloneCount,St.userData.cloneCount=0,St.name=St.name+"_"+St.userData.cloneId),St==null?void 0:St.materialObject},o){let St=this.findMaterial(o==null?void 0:o.uuid);St&&this.unregisterMaterial(St),St=this.findMaterial((ct=o==null?void 0:o.materialObject)===null||ct===void 0?void 0:ct.uuid),St&&this.unregisterMaterial(St)}return this.registerMaterialObject(Et)}}_processModel(s,o){if(!s.modelObject)return console.error("MaterialManager: No modelObject found for ",s),s;let a=s.material;if(!a&&s.geometry&&(this._defaultMaterial||(this._defaultMaterial=this.generateFromTemplate("standard")),a=this._defaultMaterial,s.material=a),a){let _e=!0;Array.isArray(a)||(a=[a],_e=!1);const rt=[];for(const nt of a){const ot=this._processMaterial(nt,o);rt.push(ot==null?void 0:ot.materialObject)}s.setMaterial&&(s.modelObject.material=null,s.setMaterial(_e?rt:rt[0]))}if(o.recursive!==!1)for(let _e=0;_e<s.modelObject.children.length;_e++)s.modelObject.children[_e]=this._processModel(s.modelObject.children[_e],o);return s}}class Yl{constructor(s,o,a,_e){this.cls=s,this.ext=o,this.root=a,this.onCtor=_e}ctor(s){const o=this.cls&&new this.cls(s.loadingManager);return typeof this.onCtor=="function"?this.onCtor(o,s):o}}function MA(tt){var s;if(!tt||tt===""||tt.match(/__MACOSX\/.*\._/))return"";const o=(s=(tt=tt.replace(/\?.*$/,"")).split(/[\\/]/).pop())!==null&&s!==void 0?s:"",a=o.lastIndexOf(".");return o===""||a<1?"":o.slice(a+1)}function RA(tt){return tt.substring(tt.lastIndexOf("/")+1)}class yv{constructor(s,{pseudoCenter:o=!1,autoCenter:a=!1,autoScale:_e=!1,autoScaleRadius:rt=2,license:nt=""}={}){if(this.assetType="model",this._modelObject=Xo(new et.Tme),this.setDirty=this.setDirty.bind(this),this.updateBounds=this.updateBounds.bind(this),s||(s=this._modelObject),!o||s.userData.pseudoCentered||s.userData.isCentered)!a||s.userData.autoCentered||s.userData.isCentered||s.userData.pseudoCentered?o||a||(s.userData.isCentered=!0):As(s),this._modelObject=s;else{a&&console.error("cannot use pseudoCenter and autoCenter at the same time");const ot=new cn().expandByObject(s,!0,!0).getCenter(new et.Pa4);this._modelObject.position.copy(ot).negate(),this._modelObject.updateMatrix(),this._modelObject.add(s),this._modelObject.name=s.name+"-centered",this._modelObject.userData.pseudoCentered=!0,s.userData.iModel=this}_e&&!this._modelObject.userData.autoScaled?ps(this._modelObject,s.userData.autoScaleRadius||rt):this._modelObject.userData.autoScaled=!0,this._modelObject.addEventListener("dispose",()=>{this.__disposed=!0}),this._modelObject.userData.iModel=this,this.license=nt}get visible(){return this._modelObject.visible}set visible(s){this._modelObject.visible=s}get uuid(){return this._modelObject.uuid}get modelObject(){return this._modelObject}get name(){return this._modelObject.name}set name(s){this._modelObject.name=s}get license(){return this._modelObject.userData.license}set license(s){this._modelObject.userData.license=s}addEventListener(s,o){this._modelObject.addEventListener(s,o)}dispatchEvent(s){this._modelObject.dispatchEvent(s)}hasEventListener(s,o){return this._modelObject.hasEventListener(s,o)}removeEventListener(s,o){this._modelObject.removeEventListener(s,o)}traverse(s){this._modelObject.traverse(s)}dispose(){const s=this._modelObject.dispose;s&&typeof s=="function"?s():(console.warn("no dispose in modelObject"),this._modelObject.removeFromParent())}setDirty(s){var o,a,_e,rt;(a=(o=this._modelObject)===null||o===void 0?void 0:o.setDirty)===null||a===void 0||a.call(o,s),(rt=(_e=this._uiConfig)===null||_e===void 0?void 0:_e.uiRefresh)===null||rt===void 0||rt.call(_e,"postFrame",!0)}setMaterial(s){var o,a;return this._modelObject.isMesh?((a=(o=this._modelObject).setMaterial)===null||a===void 0?void 0:a.call(o,s))||[]:(console.error("setMaterial only works on meshes"),[])}get material(){return this._modelObject.material}get geometry(){return this._modelObject.geometry}setGeometry(s,o=!1){var a,_e;if(this._modelObject.isMesh)return(_e=(a=this._modelObject).setGeometry)===null||_e===void 0?void 0:_e.call(a,s,o);console.error("setGeometry only works on meshes")}get userData(){return this._modelObject.userData}set userData(s){this._modelObject.userData=s}updateBounds(){console.warn("updateBounds: NOT IMPLEMENTED"),this.setDirty()}get uiConfig(){return this._uiConfig||(this._uiConfig=Ps(this._modelObject,!1)),this._uiConfig}clone(){return new yv(this._modelObject.clone(),{pseudoCenter:!1,autoScale:!1,autoCenter:!1,license:this.license})}}function U_(tt,s){return[tt.modelObject,...tt.modelObject.children].forEach(o=>{Xo(o,o!==tt.modelObject?tt:void 0,s)}),tt}class B0{constructor(){this._processors=new Map}add(s,o){var a;this._processors.has(s)||this._processors.set(s,[]),(a=this._processors.get(s))===null||a===void 0||a.push(o)}remove(s,o){const a=this._processors.get(s),_e=(a==null?void 0:a.indexOf(o))||(a==null?void 0:a.findIndex(rt=>rt.process&&rt.process===o.process||rt.processAsync&&rt.processAsync===o.processAsync));!a||!_e||_e<0||a.splice(_e,1)}get(s){var o;return(o=this._processors.get(s))!==null&&o!==void 0?o:[]}async process(s,o,a){var _e,rt,nt,ot;const ct=this.get(s),pt=o.assetType;for(const ht of ct)ht.forAssetType===pt&&(o=(rt=(_e=ht.process)===null||_e===void 0?void 0:_e.call(ht,o,a))!==null&&rt!==void 0?rt:o,o=(ot=await((nt=ht.processAsync)===null||nt===void 0?void 0:nt.call(ht,o,a)))!==null&&ot!==void 0?ot:o);return o}dispose(){this._processors.clear()}}class IA extends et.hH6{load(s,o,a,_e){return super.load(s,rt=>{try{if(typeof rt!="string")throw new Error("Invalid JSON");o==null||o(JSON.parse(rt))}catch(nt){_e==null||_e(nt)}},a,_e)}}class US extends et.yxD{constructor(s){super(s),this.type=et.cLu}parse(s){const o=function(ct,pt){switch(ct){case 1:console.error("THREE.RGBELoader Read Error: "+(pt||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(pt||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(pt||""));break;default:console.error("THREE.RGBELoader: Error: "+(pt||""))}return-1},a=function(ct,pt,ht){pt=pt||1024;let _t=ct.pos,Et=-1,St=0,Mt="",It=String.fromCharCode.apply(null,new Uint16Array(ct.subarray(_t,_t+128)));for(;0>(Et=It.indexOf(`
`))&&St<pt&&_t<ct.byteLength;)Mt+=It,St+=It.length,_t+=128,It+=String.fromCharCode.apply(null,new Uint16Array(ct.subarray(_t,_t+128)));return-1<Et&&(ht!==!1&&(ct.pos+=St+Et+1),Mt+It.slice(0,Et))},_e=function(ct,pt,ht,_t){const Et=ct[pt+3],St=Math.pow(2,Et-128)/255;ht[_t+0]=ct[pt+0]*St,ht[_t+1]=ct[pt+1]*St,ht[_t+2]=ct[pt+2]*St,ht[_t+3]=1},rt=function(ct,pt,ht,_t){const Et=ct[pt+3],St=Math.pow(2,Et-128)/255;ht[_t+0]=et.A5E.toHalfFloat(Math.min(ct[pt+0]*St,65504)),ht[_t+1]=et.A5E.toHalfFloat(Math.min(ct[pt+1]*St,65504)),ht[_t+2]=et.A5E.toHalfFloat(Math.min(ct[pt+2]*St,65504)),ht[_t+3]=et.A5E.toHalfFloat(1)},nt=new Uint8Array(s);nt.pos=0;const ot=function(ct){const pt=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,ht=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,_t=/^\s*FORMAT=(\S+)\s*$/,Et=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,St={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let Mt,It;if(ct.pos>=ct.byteLength||!(Mt=a(ct)))return o(1,"no header found");if(!(It=Mt.match(/^#\?(\S+)/)))return o(3,"bad initial token");for(St.valid|=1,St.programtype=It[1],St.string+=Mt+`
`;Mt=a(ct),Mt!==!1;)if(St.string+=Mt+`
`,Mt.charAt(0)!=="#"){if((It=Mt.match(pt))&&(St.gamma=parseFloat(It[1])),(It=Mt.match(ht))&&(St.exposure=parseFloat(It[1])),(It=Mt.match(_t))&&(St.valid|=2,St.format=It[1]),(It=Mt.match(Et))&&(St.valid|=4,St.height=parseInt(It[1],10),St.width=parseInt(It[2],10)),2&St.valid&&4&St.valid)break}else St.comments+=Mt+`
`;return 2&St.valid?4&St.valid?St:o(3,"missing image size specifier"):o(3,"missing format specifier")}(nt);if(ot!==-1){const ct=ot.width,pt=ot.height,ht=function(_t,Et,St){const Mt=Et;if(Mt<8||Mt>32767||_t[0]!==2||_t[1]!==2||128&_t[2])return new Uint8Array(_t);if(Mt!==(_t[2]<<8|_t[3]))return o(3,"wrong scanline width");const It=new Uint8Array(4*Et*St);if(!It.length)return o(4,"unable to allocate buffer space");let Nt=0,Bt=0;const kt=4*Mt,Pt=new Uint8Array(4),qt=new Uint8Array(kt);let Kt=St;for(;Kt>0&&Bt<_t.byteLength;){if(Bt+4>_t.byteLength)return o(1);if(Pt[0]=_t[Bt++],Pt[1]=_t[Bt++],Pt[2]=_t[Bt++],Pt[3]=_t[Bt++],Pt[0]!=2||Pt[1]!=2||(Pt[2]<<8|Pt[3])!=Mt)return o(3,"bad rgbe scanline format");let nr,ir=0;for(;ir<kt&&Bt<_t.byteLength;){nr=_t[Bt++];const br=nr>128;if(br&&(nr-=128),nr===0||ir+nr>kt)return o(3,"bad scanline data");if(br){const Tr=_t[Bt++];for(let Dr=0;Dr<nr;Dr++)qt[ir++]=Tr}else qt.set(_t.subarray(Bt,Bt+nr),ir),ir+=nr,Bt+=nr}const fr=Mt;for(let br=0;br<fr;br++){let Tr=0;It[Nt]=qt[br+Tr],Tr+=Mt,It[Nt+1]=qt[br+Tr],Tr+=Mt,It[Nt+2]=qt[br+Tr],Tr+=Mt,It[Nt+3]=qt[br+Tr],Nt+=4}Kt--}return It}(nt.subarray(nt.pos),ct,pt);if(ht!==-1){let _t,Et,St;switch(this.type){case et.VzW:St=ht.length/4;const Mt=new Float32Array(4*St);for(let Nt=0;Nt<St;Nt++)_e(ht,4*Nt,Mt,4*Nt);_t=Mt,Et=et.VzW;break;case et.cLu:St=ht.length/4;const It=new Uint16Array(4*St);for(let Nt=0;Nt<St;Nt++)rt(ht,4*Nt,It,4*Nt);_t=It,Et=et.cLu;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:ct,height:pt,data:_t,header:ot.string,gamma:ot.gamma,exposure:ot.exposure,type:Et}}}return null}setDataType(s){return this.type=s,this}load(s,o,a,_e){return super.load(s,function(rt,nt){switch(rt.type){case et.VzW:case et.cLu:rt.encoding=et.rnI,rt.minFilter=et.wem,rt.magFilter=et.wem,rt.generateMipmaps=!1,rt.flipY=!0}o&&o(rt,nt)},a,_e)}}function Rx(tt){mo.Importers.push(new Yl(class extends US{constructor(s){super(s),this.setDataType($x(tt))}},["hdr"],!1))}class Av extends et.aNw{constructor(s){super(s),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(o){return new ky(o)}),this.register(function(o){return new fp(o)}),this.register(function(o){return new bv(o)}),this.register(function(o){return new Ls(o)}),this.register(function(o){return new Wm(o)}),this.register(function(o){return new Oy(o)}),this.register(function(o){return new Ly(o)}),this.register(function(o){return new $_(o)}),this.register(function(o){return new t_(o)}),this.register(function(o){return new rp(o)}),this.register(function(o){return new du(o)}),this.register(function(o){return new Tl(o)})}load(s,o,a,_e){const rt=this;let nt;nt=this.resourcePath!==""?this.resourcePath:this.path!==""?this.path:et.Zp0.extractUrlBase(s),this.manager.itemStart(s);const ot=function(pt){_e?_e(pt):console.error(pt),rt.manager.itemError(s),rt.manager.itemEnd(s)},ct=new et.hH6(this.manager);ct.setPath(this.path),ct.setResponseType("arraybuffer"),ct.setRequestHeader(this.requestHeader),ct.setWithCredentials(this.withCredentials),ct.load(s,function(pt){try{rt.parse(pt,nt,function(ht){o(ht),rt.manager.itemEnd(s)},ot)}catch(ht){ot(ht)}},a,ot)}setDRACOLoader(s){return this.dracoLoader=s,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(s){return this.ktx2Loader=s,this}setMeshoptDecoder(s){return this.meshoptDecoder=s,this}register(s){return this.pluginCallbacks.indexOf(s)===-1&&this.pluginCallbacks.push(s),this}unregister(s){return this.pluginCallbacks.indexOf(s)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(s),1),this}parse(s,o,a,_e){let rt;const nt={},ot={};if(typeof s=="string")rt=s;else if(et.Zp0.decodeText(new Uint8Array(s,0,4))===DA){try{nt[Ws.KHR_BINARY_GLTF]=new Vn(s)}catch(ht){return void(_e&&_e(ht))}rt=nt[Ws.KHR_BINARY_GLTF].content}else rt=et.Zp0.decodeText(new Uint8Array(s));const ct=JSON.parse(rt);if(ct.asset===void 0||ct.asset.version[0]<2)return void(_e&&_e(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const pt=new Cu(ct,{path:o||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});pt.fileLoader.setRequestHeader(this.requestHeader);for(let ht=0;ht<this.pluginCallbacks.length;ht++){const _t=this.pluginCallbacks[ht](pt);ot[_t.name]=_t,nt[_t.name]=!0}if(ct.extensionsUsed)for(let ht=0;ht<ct.extensionsUsed.length;++ht){const _t=ct.extensionsUsed[ht],Et=ct.extensionsRequired||[];switch(_t){case Ws.KHR_MATERIALS_UNLIT:nt[_t]=new jw;break;case Ws.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:nt[_t]=new j_;break;case Ws.KHR_DRACO_MESH_COMPRESSION:nt[_t]=new ju(ct,this.dracoLoader);break;case Ws.KHR_TEXTURE_TRANSFORM:nt[_t]=new Ix;break;case Ws.KHR_MESH_QUANTIZATION:nt[_t]=new z_;break;default:Et.indexOf(_t)>=0&&ot[_t]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+_t+'".')}}pt.setExtensions(nt),pt.setPlugins(ot),pt.parse(a,_e)}parseAsync(s,o){const a=this;return new Promise(function(_e,rt){a.parse(s,o,_e,rt)})}}function PA(){let tt={};return{get:function(s){return tt[s]},add:function(s,o){tt[s]=o},remove:function(s){delete tt[s]},removeAll:function(){tt={}}}}const Ws={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class du{constructor(s){this.parser=s,this.name=Ws.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const s=this.parser,o=this.parser.json.nodes||[];for(let a=0,_e=o.length;a<_e;a++){const rt=o[a];rt.extensions&&rt.extensions[this.name]&&rt.extensions[this.name].light!==void 0&&s._addNodeRef(this.cache,rt.extensions[this.name].light)}}_loadLight(s){const o=this.parser,a="light:"+s;let _e=o.cache.get(a);if(_e)return _e;const rt=o.json,nt=((rt.extensions&&rt.extensions[this.name]||{}).lights||[])[s];let ot;const ct=new et.Ilk(16777215);nt.color!==void 0&&ct.fromArray(nt.color);const pt=nt.range!==void 0?nt.range:0;switch(nt.type){case"directional":ot=new et.Ox3(ct),ot.target.position.set(0,0,-1),ot.add(ot.target);break;case"point":ot=new et.cek(ct),ot.distance=pt;break;case"spot":ot=new et.PMe(ct),ot.distance=pt,nt.spot=nt.spot||{},nt.spot.innerConeAngle=nt.spot.innerConeAngle!==void 0?nt.spot.innerConeAngle:0,nt.spot.outerConeAngle=nt.spot.outerConeAngle!==void 0?nt.spot.outerConeAngle:Math.PI/4,ot.angle=nt.spot.outerConeAngle,ot.penumbra=1-nt.spot.innerConeAngle/nt.spot.outerConeAngle,ot.target.position.set(0,0,-1),ot.add(ot.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+nt.type)}return ot.position.set(0,0,0),ot.decay=2,nt.intensity!==void 0&&(ot.intensity=nt.intensity),ot.name=o.createUniqueName(nt.name||"light_"+s),_e=Promise.resolve(ot),o.cache.add(a,_e),_e}createNodeAttachment(s){const o=this,a=this.parser,_e=a.json.nodes[s],rt=(_e.extensions&&_e.extensions[this.name]||{}).light;return rt===void 0?null:this._loadLight(rt).then(function(nt){return a._getNodeRef(o.cache,rt,nt)})}}class jw{constructor(){this.name=Ws.KHR_MATERIALS_UNLIT}getMaterialType(){return et.vBJ}extendParams(s,o,a){const _e=[];s.color=new et.Ilk(1,1,1),s.opacity=1;const rt=o.pbrMetallicRoughness;if(rt){if(Array.isArray(rt.baseColorFactor)){const nt=rt.baseColorFactor;s.color.fromArray(nt),s.opacity=nt[3]}rt.baseColorTexture!==void 0&&_e.push(a.assignTexture(s,"map",rt.baseColorTexture,et.knz))}return Promise.all(_e)}}class $_{constructor(s){this.parser=s,this.name=Ws.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(s,o){const a=this.parser.json.materials[s];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const _e=a.extensions[this.name].emissiveStrength;return _e!==void 0&&(o.emissiveIntensity=_e),Promise.resolve()}}class ky{constructor(s){this.parser=s,this.name=Ws.KHR_MATERIALS_CLEARCOAT}getMaterialType(s){const o=this.parser.json.materials[s];return o.extensions&&o.extensions[this.name]?et.EJi:null}extendMaterialParams(s,o){const a=this.parser,_e=a.json.materials[s];if(!_e.extensions||!_e.extensions[this.name])return Promise.resolve();const rt=[],nt=_e.extensions[this.name];if(nt.clearcoatFactor!==void 0&&(o.clearcoat=nt.clearcoatFactor),nt.clearcoatTexture!==void 0&&rt.push(a.assignTexture(o,"clearcoatMap",nt.clearcoatTexture)),nt.clearcoatRoughnessFactor!==void 0&&(o.clearcoatRoughness=nt.clearcoatRoughnessFactor),nt.clearcoatRoughnessTexture!==void 0&&rt.push(a.assignTexture(o,"clearcoatRoughnessMap",nt.clearcoatRoughnessTexture)),nt.clearcoatNormalTexture!==void 0&&(rt.push(a.assignTexture(o,"clearcoatNormalMap",nt.clearcoatNormalTexture)),nt.clearcoatNormalTexture.scale!==void 0)){const ot=nt.clearcoatNormalTexture.scale;o.clearcoatNormalScale=new et.FM8(ot,ot)}return Promise.all(rt)}}class rp{constructor(s){this.parser=s,this.name=Ws.KHR_MATERIALS_IRIDESCENCE}getMaterialType(s){const o=this.parser.json.materials[s];return o.extensions&&o.extensions[this.name]?et.EJi:null}extendMaterialParams(s,o){const a=this.parser,_e=a.json.materials[s];if(!_e.extensions||!_e.extensions[this.name])return Promise.resolve();const rt=[],nt=_e.extensions[this.name];return nt.iridescenceFactor!==void 0&&(o.iridescence=nt.iridescenceFactor),nt.iridescenceTexture!==void 0&&rt.push(a.assignTexture(o,"iridescenceMap",nt.iridescenceTexture)),nt.iridescenceIor!==void 0&&(o.iridescenceIOR=nt.iridescenceIor),o.iridescenceThicknessRange===void 0&&(o.iridescenceThicknessRange=[100,400]),nt.iridescenceThicknessMinimum!==void 0&&(o.iridescenceThicknessRange[0]=nt.iridescenceThicknessMinimum),nt.iridescenceThicknessMaximum!==void 0&&(o.iridescenceThicknessRange[1]=nt.iridescenceThicknessMaximum),nt.iridescenceThicknessTexture!==void 0&&rt.push(a.assignTexture(o,"iridescenceThicknessMap",nt.iridescenceThicknessTexture)),Promise.all(rt)}}class Ls{constructor(s){this.parser=s,this.name=Ws.KHR_MATERIALS_SHEEN}getMaterialType(s){const o=this.parser.json.materials[s];return o.extensions&&o.extensions[this.name]?et.EJi:null}extendMaterialParams(s,o){const a=this.parser,_e=a.json.materials[s];if(!_e.extensions||!_e.extensions[this.name])return Promise.resolve();const rt=[];o.sheenColor=new et.Ilk(0,0,0),o.sheenRoughness=0,o.sheen=1;const nt=_e.extensions[this.name];return nt.sheenColorFactor!==void 0&&o.sheenColor.fromArray(nt.sheenColorFactor),nt.sheenRoughnessFactor!==void 0&&(o.sheenRoughness=nt.sheenRoughnessFactor),nt.sheenColorTexture!==void 0&&rt.push(a.assignTexture(o,"sheenColorMap",nt.sheenColorTexture,et.knz)),nt.sheenRoughnessTexture!==void 0&&rt.push(a.assignTexture(o,"sheenRoughnessMap",nt.sheenRoughnessTexture)),_e.extras&&_e.extras.sheenFactor!==void 0&&(o.sheen=_e.extras.sheenFactor,delete _e.extras.sheenFactor),Promise.all(rt)}}class Wm{constructor(s){this.parser=s,this.name=Ws.KHR_MATERIALS_TRANSMISSION}getMaterialType(s){const o=this.parser.json.materials[s];return o.extensions&&o.extensions[this.name]?et.EJi:null}extendMaterialParams(s,o){const a=this.parser,_e=a.json.materials[s];if(!_e.extensions||!_e.extensions[this.name])return Promise.resolve();const rt=[],nt=_e.extensions[this.name];return nt.transmissionFactor!==void 0&&(o.transmission=nt.transmissionFactor),nt.transmissionTexture!==void 0&&rt.push(a.assignTexture(o,"transmissionMap",nt.transmissionTexture)),Promise.all(rt)}}class Oy{constructor(s){this.parser=s,this.name=Ws.KHR_MATERIALS_VOLUME}getMaterialType(s){const o=this.parser.json.materials[s];return o.extensions&&o.extensions[this.name]?et.EJi:null}extendMaterialParams(s,o){const a=this.parser,_e=a.json.materials[s];if(!_e.extensions||!_e.extensions[this.name])return Promise.resolve();const rt=[],nt=_e.extensions[this.name];o.thickness=nt.thicknessFactor!==void 0?nt.thicknessFactor:0,nt.thicknessTexture!==void 0&&rt.push(a.assignTexture(o,"thicknessMap",nt.thicknessTexture)),o.attenuationDistance=nt.attenuationDistance||0;const ot=nt.attenuationColor||[1,1,1];return o.attenuationColor=new et.Ilk(ot[0],ot[1],ot[2]),Promise.all(rt)}}class Ly{constructor(s){this.parser=s,this.name=Ws.KHR_MATERIALS_IOR}getMaterialType(s){const o=this.parser.json.materials[s];return o.extensions&&o.extensions[this.name]?et.EJi:null}extendMaterialParams(s,o){const a=this.parser.json.materials[s];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const _e=a.extensions[this.name];return o.ior=_e.ior!==void 0?_e.ior:1.5,Promise.resolve()}}class t_{constructor(s){this.parser=s,this.name=Ws.KHR_MATERIALS_SPECULAR}getMaterialType(s){const o=this.parser.json.materials[s];return o.extensions&&o.extensions[this.name]?et.EJi:null}extendMaterialParams(s,o){const a=this.parser,_e=a.json.materials[s];if(!_e.extensions||!_e.extensions[this.name])return Promise.resolve();const rt=[],nt=_e.extensions[this.name];o.specularIntensity=nt.specularFactor!==void 0?nt.specularFactor:1,nt.specularTexture!==void 0&&rt.push(a.assignTexture(o,"specularIntensityMap",nt.specularTexture));const ot=nt.specularColorFactor||[1,1,1];return o.specularColor=new et.Ilk(ot[0],ot[1],ot[2]),nt.specularColorTexture!==void 0&&rt.push(a.assignTexture(o,"specularColorMap",nt.specularColorTexture,et.knz)),Promise.all(rt)}}class fp{constructor(s){this.parser=s,this.name=Ws.KHR_TEXTURE_BASISU}loadTexture(s){const o=this.parser,a=o.json,_e=a.textures[s];if(!_e.extensions||!_e.extensions[this.name])return null;const rt=_e.extensions[this.name],nt=o.options.ktx2Loader;if(!nt){if(a.extensionsRequired&&a.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return o.loadTextureImage(s,rt.source,nt)}}class bv{constructor(s){this.parser=s,this.name=Ws.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(s){const o=this.name,a=this.parser,_e=a.json,rt=_e.textures[s];if(!rt.extensions||!rt.extensions[o])return null;const nt=rt.extensions[o],ot=_e.images[nt.source];let ct=a.textureLoader;if(ot.uri){const pt=a.options.manager.getHandler(ot.uri);pt!==null&&(ct=pt)}return this.detectSupport().then(function(pt){if(pt)return a.loadTextureImage(s,nt.source,ct);if(_e.extensionsRequired&&_e.extensionsRequired.indexOf(o)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return a.loadTexture(s)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(s){const o=new Image;o.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",o.onload=o.onerror=function(){s(o.height===1)}})),this.isSupported}}class Tl{constructor(s){this.name=Ws.EXT_MESHOPT_COMPRESSION,this.parser=s}loadBufferView(s){const o=this.parser.json,a=o.bufferViews[s];if(a.extensions&&a.extensions[this.name]){const _e=a.extensions[this.name],rt=this.parser.getDependency("buffer",_e.buffer),nt=this.parser.options.meshoptDecoder;if(!nt||!nt.supported){if(o.extensionsRequired&&o.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return rt.then(function(ot){const ct=_e.byteOffset||0,pt=_e.byteLength||0,ht=_e.count,_t=_e.byteStride,Et=new Uint8Array(ot,ct,pt);return nt.decodeGltfBufferAsync?nt.decodeGltfBufferAsync(ht,_t,Et,_e.mode,_e.filter).then(function(St){return St.buffer}):nt.ready.then(function(){const St=new ArrayBuffer(ht*_t);return nt.decodeGltfBuffer(new Uint8Array(St),ht,_t,Et,_e.mode,_e.filter),St})})}return null}}const DA="glTF";class Vn{constructor(s){this.name=Ws.KHR_BINARY_GLTF,this.content=null,this.body=null;const o=new DataView(s,0,12);if(this.header={magic:et.Zp0.decodeText(new Uint8Array(s.slice(0,4))),version:o.getUint32(4,!0),length:o.getUint32(8,!0)},this.header.magic!==DA)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const a=this.header.length-12,_e=new DataView(s,12);let rt=0;for(;rt<a;){const nt=_e.getUint32(rt,!0);rt+=4;const ot=_e.getUint32(rt,!0);if(rt+=4,ot===1313821514){const ct=new Uint8Array(s,12+rt,nt);this.content=et.Zp0.decodeText(ct)}else if(ot===5130562){const ct=12+rt;this.body=s.slice(ct,ct+nt)}rt+=nt}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class ju{constructor(s,o){if(!o)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ws.KHR_DRACO_MESH_COMPRESSION,this.json=s,this.dracoLoader=o,this.dracoLoader.preload()}decodePrimitive(s,o){const a=this.json,_e=this.dracoLoader,rt=s.extensions[this.name].bufferView,nt=s.extensions[this.name].attributes,ot={},ct={},pt={};for(const ht in nt){const _t=O0[ht]||ht.toLowerCase();ot[_t]=nt[ht]}for(const ht in s.attributes){const _t=O0[ht]||ht.toLowerCase();if(nt[ht]!==void 0){const Et=a.accessors[s.attributes[ht]],St=np[Et.componentType];pt[_t]=St.name,ct[_t]=Et.normalized===!0}}return o.getDependency("bufferView",rt).then(function(ht){return new Promise(function(_t){_e.decodeDracoFile(ht,function(Et){for(const St in Et.attributes){const Mt=Et.attributes[St],It=ct[St];It!==void 0&&(Mt.normalized=It)}_t(Et)},ot,pt)})})}}class Ix{constructor(){this.name=Ws.KHR_TEXTURE_TRANSFORM}extendTexture(s,o){return o.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),o.offset===void 0&&o.rotation===void 0&&o.scale===void 0||(s=s.clone(),o.offset!==void 0&&s.offset.fromArray(o.offset),o.rotation!==void 0&&(s.rotation=o.rotation),o.scale!==void 0&&s.repeat.fromArray(o.scale),s.needsUpdate=!0),s}}class zw extends et.Wid{constructor(s){super(),this.isGLTFSpecularGlossinessMaterial=!0;const o=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),a=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),_e=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),rt=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),nt=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),ot={specular:{value:new et.Ilk().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=ot,this.onBeforeCompile=function(ct){for(const pt in ot)ct.uniforms[pt]=ot[pt];ct.fragmentShader=ct.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",o).replace("#include <metalnessmap_pars_fragment>",a).replace("#include <roughnessmap_fragment>",_e).replace("#include <metalnessmap_fragment>",rt).replace("#include <lights_physical_fragment>",nt)},Object.defineProperties(this,{specular:{get:function(){return ot.specular.value},set:function(ct){ot.specular.value=ct}},specularMap:{get:function(){return ot.specularMap.value},set:function(ct){ot.specularMap.value=ct,ct?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return ot.glossiness.value},set:function(ct){ot.glossiness.value=ct}},glossinessMap:{get:function(){return ot.glossinessMap.value},set:function(ct){ot.glossinessMap.value=ct,ct?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(s)}copy(s){return super.copy(s),this.specularMap=s.specularMap,this.specular.copy(s.specular),this.glossinessMap=s.glossinessMap,this.glossiness=s.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class j_{constructor(){this.name=Ws.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity"]}getMaterialType(){return zw}extendParams(s,o,a){const _e=o.extensions[this.name];s.color=new et.Ilk(1,1,1),s.opacity=1;const rt=[];if(Array.isArray(_e.diffuseFactor)){const nt=_e.diffuseFactor;s.color.fromArray(nt),s.opacity=nt[3]}if(_e.diffuseTexture!==void 0&&rt.push(a.assignTexture(s,"map",_e.diffuseTexture,et.knz)),s.emissive=new et.Ilk(0,0,0),s.glossiness=_e.glossinessFactor!==void 0?_e.glossinessFactor:1,s.specular=new et.Ilk(1,1,1),Array.isArray(_e.specularFactor)&&s.specular.fromArray(_e.specularFactor),_e.specularGlossinessTexture!==void 0){const nt=_e.specularGlossinessTexture;rt.push(a.assignTexture(s,"glossinessMap",nt)),rt.push(a.assignTexture(s,"specularMap",nt,et.knz))}return Promise.all(rt)}createMaterial(s){const o=new zw(s);return o.fog=!0,o.color=s.color,o.map=s.map===void 0?null:s.map,o.lightMap=null,o.lightMapIntensity=1,o.aoMap=s.aoMap===void 0?null:s.aoMap,o.aoMapIntensity=1,o.emissive=s.emissive,o.emissiveIntensity=s.emissiveIntensity===void 0?1:s.emissiveIntensity,o.emissiveMap=s.emissiveMap===void 0?null:s.emissiveMap,o.bumpMap=s.bumpMap===void 0?null:s.bumpMap,o.bumpScale=1,o.normalMap=s.normalMap===void 0?null:s.normalMap,o.normalMapType=et.IOt,s.normalScale&&(o.normalScale=s.normalScale),o.displacementMap=null,o.displacementScale=1,o.displacementBias=0,o.specularMap=s.specularMap===void 0?null:s.specularMap,o.specular=s.specular,o.glossinessMap=s.glossinessMap===void 0?null:s.glossinessMap,o.glossiness=s.glossiness,o.alphaMap=null,o.envMap=s.envMap===void 0?null:s.envMap,o.envMapIntensity=1,o}}class z_{constructor(){this.name=Ws.KHR_MESH_QUANTIZATION}}class Cm extends et._C8{constructor(s,o,a,_e){super(s,o,a,_e)}copySampleValue_(s){const o=this.resultBuffer,a=this.sampleValues,_e=this.valueSize,rt=s*_e*3+_e;for(let nt=0;nt!==_e;nt++)o[nt]=a[rt+nt];return o}interpolate_(s,o,a,_e){const rt=this.resultBuffer,nt=this.sampleValues,ot=this.valueSize,ct=2*ot,pt=3*ot,ht=_e-o,_t=(a-o)/ht,Et=_t*_t,St=Et*_t,Mt=s*pt,It=Mt-pt,Nt=-2*St+3*Et,Bt=St-Et,kt=1-Nt,Pt=Bt-Et+_t;for(let qt=0;qt!==ot;qt++){const Kt=nt[It+qt+ot],nr=nt[It+qt+ct]*ht,ir=nt[Mt+qt+ot],fr=nt[Mt+qt]*ht;rt[qt]=kt*Kt+Pt*nr+Nt*ir+Bt*fr}return rt}}const Ny=new et._fP;class k0 extends Cm{interpolate_(s,o,a,_e){const rt=super.interpolate_(s,o,a,_e);return Ny.fromArray(rt).normalize().toArray(rt),rt}}const np={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},BA={9728:et.TyD,9729:et.wem,9984:et.YLQ,9985:et.qyh,9986:et.aH4,9987:et.D1R},Kl={33071:et.uWy,33648:et.OoA,10497:et.rpg},rm={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},O0={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},jp={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},kA={CUBICSPLINE:void 0,LINEAR:et.NMF,STEP:et.Syv};function ms(tt,s,o){for(const a in o.extensions)tt[a]===void 0&&(s.userData.gltfExtensions=s.userData.gltfExtensions||{},s.userData.gltfExtensions[a]=o.extensions[a])}function nm(tt,s){s.extras!==void 0&&(typeof s.extras=="object"?Object.assign(tt.userData,s.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+s.extras))}function Fy(tt,s){if(tt.updateMorphTargets(),s.weights!==void 0)for(let o=0,a=s.weights.length;o<a;o++)tt.morphTargetInfluences[o]=s.weights[o];if(s.extras&&Array.isArray(s.extras.targetNames)){const o=s.extras.targetNames;if(tt.morphTargetInfluences.length===o.length){tt.morphTargetDictionary={};for(let a=0,_e=o.length;a<_e;a++)tt.morphTargetDictionary[o[a]]=a}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function V_(tt){const s=tt.extensions&&tt.extensions[Ws.KHR_DRACO_MESH_COMPRESSION];let o;return o=s?"draco:"+s.bufferView+":"+s.indices+":"+L0(s.attributes):tt.indices+":"+L0(tt.attributes)+":"+tt.mode,o}function L0(tt){let s="";const o=Object.keys(tt).sort();for(let a=0,_e=o.length;a<_e;a++)s+=o[a]+":"+tt[o[a]]+";";return s}function Vw(tt){switch(tt){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class Cu{constructor(s={},o={}){this.json=s,this.extensions={},this.plugins={},this.options=o,this.cache=new PA,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};const a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,_e=navigator.userAgent.indexOf("Firefox")>-1,rt=_e?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1;typeof createImageBitmap>"u"||a||_e&&rt<98?this.textureLoader=new et.dpR(this.options.manager):this.textureLoader=new et.QRU(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new et.hH6(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(s){this.extensions=s}setPlugins(s){this.plugins=s}parse(s,o){const a=this,_e=this.json,rt=this.extensions;this.cache.removeAll(),this._invokeAll(function(nt){return nt._markDefs&&nt._markDefs()}),Promise.all(this._invokeAll(function(nt){return nt.beforeRoot&&nt.beforeRoot()})).then(function(){return Promise.all([a.getDependencies("scene"),a.getDependencies("animation"),a.getDependencies("camera")])}).then(function(nt){const ot={scene:nt[0][_e.scene||0],scenes:nt[0],animations:nt[1],cameras:nt[2],asset:_e.asset,parser:a,userData:{}};ms(rt,ot,_e),nm(ot,_e),Promise.all(a._invokeAll(function(ct){return ct.afterRoot&&ct.afterRoot(ot)})).then(function(){s(ot)})}).catch(o)}_markDefs(){const s=this.json.nodes||[],o=this.json.skins||[],a=this.json.meshes||[];for(let _e=0,rt=o.length;_e<rt;_e++){const nt=o[_e].joints;for(let ot=0,ct=nt.length;ot<ct;ot++)s[nt[ot]].isBone=!0}for(let _e=0,rt=s.length;_e<rt;_e++){const nt=s[_e];nt.mesh!==void 0&&(this._addNodeRef(this.meshCache,nt.mesh),nt.skin!==void 0&&(a[nt.mesh].isSkinnedMesh=!0)),nt.camera!==void 0&&this._addNodeRef(this.cameraCache,nt.camera)}}_addNodeRef(s,o){o!==void 0&&(s.refs[o]===void 0&&(s.refs[o]=s.uses[o]=0),s.refs[o]++)}_getNodeRef(s,o,a){if(s.refs[o]<=1)return a;const _e=a.clone(),rt=(nt,ot)=>{const ct=this.associations.get(nt);ct!=null&&this.associations.set(ot,ct);for(const[pt,ht]of nt.children.entries())rt(ht,ot.children[pt])};return rt(a,_e),_e.name+="_instance_"+s.uses[o]++,_e}_invokeOne(s){const o=Object.values(this.plugins);o.push(this);for(let a=0;a<o.length;a++){const _e=s(o[a]);if(_e)return _e}return null}_invokeAll(s){const o=Object.values(this.plugins);o.unshift(this);const a=[];for(let _e=0;_e<o.length;_e++){const rt=s(o[_e]);rt&&a.push(rt)}return a}getDependency(s,o){const a=s+":"+o;let _e=this.cache.get(a);if(!_e){switch(s){case"scene":_e=this.loadScene(o);break;case"node":_e=this.loadNode(o);break;case"mesh":_e=this._invokeOne(function(rt){return rt.loadMesh&&rt.loadMesh(o)});break;case"accessor":_e=this.loadAccessor(o);break;case"bufferView":_e=this._invokeOne(function(rt){return rt.loadBufferView&&rt.loadBufferView(o)});break;case"buffer":_e=this.loadBuffer(o);break;case"material":_e=this._invokeOne(function(rt){return rt.loadMaterial&&rt.loadMaterial(o)});break;case"texture":_e=this._invokeOne(function(rt){return rt.loadTexture&&rt.loadTexture(o)});break;case"skin":_e=this.loadSkin(o);break;case"animation":_e=this._invokeOne(function(rt){return rt.loadAnimation&&rt.loadAnimation(o)});break;case"camera":_e=this.loadCamera(o);break;default:throw new Error("Unknown type: "+s)}this.cache.add(a,_e)}return _e}getDependencies(s){let o=this.cache.get(s);if(!o){const a=this,_e=this.json[s+(s==="mesh"?"es":"s")]||[];o=Promise.all(_e.map(function(rt,nt){return a.getDependency(s,nt)})),this.cache.add(s,o)}return o}loadBuffer(s){const o=this.json.buffers[s],a=this.fileLoader;if(o.type&&o.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+o.type+" buffer type is not supported.");if(o.uri===void 0&&s===0)return Promise.resolve(this.extensions[Ws.KHR_BINARY_GLTF].body);const _e=this.options;return new Promise(function(rt,nt){a.load(et.Zp0.resolveURL(o.uri,_e.path),rt,void 0,function(){nt(new Error('THREE.GLTFLoader: Failed to load buffer "'+o.uri+'".'))})})}loadBufferView(s){const o=this.json.bufferViews[s];return this.getDependency("buffer",o.buffer).then(function(a){const _e=o.byteLength||0,rt=o.byteOffset||0;return a.slice(rt,rt+_e)})}loadAccessor(s){const o=this,a=this.json,_e=this.json.accessors[s];if(_e.bufferView===void 0&&_e.sparse===void 0)return Promise.resolve(null);const rt=[];return _e.bufferView!==void 0?rt.push(this.getDependency("bufferView",_e.bufferView)):rt.push(null),_e.sparse!==void 0&&(rt.push(this.getDependency("bufferView",_e.sparse.indices.bufferView)),rt.push(this.getDependency("bufferView",_e.sparse.values.bufferView))),Promise.all(rt).then(function(nt){const ot=nt[0],ct=rm[_e.type],pt=np[_e.componentType],ht=pt.BYTES_PER_ELEMENT,_t=ht*ct,Et=_e.byteOffset||0,St=_e.bufferView!==void 0?a.bufferViews[_e.bufferView].byteStride:void 0,Mt=_e.normalized===!0;let It,Nt;if(St&&St!==_t){const Bt=Math.floor(Et/St),kt="InterleavedBuffer:"+_e.bufferView+":"+_e.componentType+":"+Bt+":"+_e.count;let Pt=o.cache.get(kt);Pt||(It=new pt(ot,Bt*St,_e.count*St/ht),Pt=new et.vpT(It,St/ht),o.cache.add(kt,Pt)),Nt=new et.kB5(Pt,ct,Et%St/ht,Mt)}else It=ot===null?new pt(_e.count*ct):new pt(ot,Et,_e.count*ct),Nt=new et.TlE(It,ct,Mt);if(_e.sparse!==void 0){const Bt=rm.SCALAR,kt=np[_e.sparse.indices.componentType],Pt=_e.sparse.indices.byteOffset||0,qt=_e.sparse.values.byteOffset||0,Kt=new kt(nt[1],Pt,_e.sparse.count*Bt),nr=new pt(nt[2],qt,_e.sparse.count*ct);ot!==null&&(Nt=new et.TlE(Nt.array.slice(),Nt.itemSize,Nt.normalized));for(let ir=0,fr=Kt.length;ir<fr;ir++){const br=Kt[ir];if(Nt.setX(br,nr[ir*ct]),ct>=2&&Nt.setY(br,nr[ir*ct+1]),ct>=3&&Nt.setZ(br,nr[ir*ct+2]),ct>=4&&Nt.setW(br,nr[ir*ct+3]),ct>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return Nt})}loadTexture(s){const o=this.json,a=this.options,_e=o.textures[s].source,rt=o.images[_e];let nt=this.textureLoader;if(rt.uri){const ot=a.manager.getHandler(rt.uri);ot!==null&&(nt=ot)}return this.loadTextureImage(s,_e,nt)}loadTextureImage(s,o,a){const _e=this,rt=this.json,nt=rt.textures[s],ot=rt.images[o],ct=(ot.uri||ot.bufferView)+":"+nt.sampler;if(this.textureCache[ct])return this.textureCache[ct];const pt=this.loadImageSource(o,a).then(function(ht){nt.name&&(ht.name=nt.name);const _t=(rt.samplers||{})[nt.sampler]||{};return ht.magFilter=BA[_t.magFilter]||et.wem,ht.minFilter=BA[_t.minFilter]||et.D1R,ht.wrapS=Kl[_t.wrapS]||et.rpg,ht.wrapT=Kl[_t.wrapT]||et.rpg,_t.extras&&_t.extras.uuid!==void 0&&(ht.uuid=_t.extras.uuid),_e.associations.set(ht,{textures:s}),ht}).catch(function(){return null});return this.textureCache[ct]=pt,pt}loadImageSource(s,o){const a=this,_e=this.json,rt=this.options;if(this.sourceCache[s]!==void 0)return this.sourceCache[s].then(_t=>_t.clone());const nt=_e.images[s],ot=self.URL||self.webkitURL;let ct=nt.uri||"",pt=!1;if(nt.bufferView!==void 0)ct=a.getDependency("bufferView",nt.bufferView).then(function(_t){pt=!0;const Et=new Blob([_t],{type:nt.mimeType});return ct=ot.createObjectURL(Et),ct});else if(nt.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+s+" is missing URI and bufferView");const ht=Promise.resolve(ct).then(function(_t){return new Promise(function(Et,St){let Mt=Et;o.isImageBitmapLoader===!0&&(Mt=function(It){const Nt=new et.xEZ(It);Nt.needsUpdate=!0,Et(Nt)}),o.load(et.Zp0.resolveURL(_t,rt.path),Mt,void 0,function(It){o.isImageBitmapLoader===!0?(o=new et.dpR(a.options.manager),Mt=Et,o.setCrossOrigin(a.options.crossOrigin),o.setRequestHeader(a.options.requestHeader),o.load(et.Zp0.resolveURL(_t,rt.path),Mt,void 0,St)):St(It)})})}).then(function(_t){var Et;if(pt===!0&&ot.revokeObjectURL(ct),_t.userData.mimeType=nt.mimeType||((Et=nt.uri).search(/\.jpe?g($|\?)/i)>0||Et.search(/^data\:image\/jpeg/)===0?"image/jpeg":Et.search(/\.webp($|\?)/i)>0||Et.search(/^data\:image\/webp/)===0?"image/webp":"image/png"),_t.flipY=!1,nt.extras){if(nt.extras.flipY!==void 0){if(o.isImageBitmapLoader===!0&&typeof createImageBitmap!==void 0){const St=_t,Mt=nt.extras.flipY&&!St.flipY;createImageBitmap(St.source.data,{imageOrientation:Mt?"flipY":"none"}).then(function(It){St.source.data.close&&St.source.data.close(),St.source.data=It,St.source.needsUpdate=!0,St.needsUpdate=!0})}_t.flipY=nt.extras.flipY,_t.needsUpdate=!0,delete nt.extras.flipY}nt.extras.uuid!==void 0&&(_t.source.uuid=nt.extras.uuid),nt.extras.t_uuid!==void 0&&(_t.uuid=nt.extras.t_uuid)}return nt.uri&&typeof nt.uri=="string"&&(_t.userData.rootPath=nt.uri),_t}).catch(function(_t){throw console.error("THREE.GLTFLoader: Couldn't load texture",ct),_t});return this.sourceCache[s]=ht,ht}assignTexture(s,o,a,_e){const rt=this;return this.getDependency("texture",a.index).then(function(nt){if(a.texCoord===void 0||a.texCoord==0||o==="aoMap"&&a.texCoord==1||console.warn("THREE.GLTFLoader: Custom UV set "+a.texCoord+" for texture "+o+" not yet supported."),rt.extensions[Ws.KHR_TEXTURE_TRANSFORM]){const ot=a.extensions!==void 0?a.extensions[Ws.KHR_TEXTURE_TRANSFORM]:void 0;if(ot){const ct=rt.associations.get(nt);nt=rt.extensions[Ws.KHR_TEXTURE_TRANSFORM].extendTexture(nt,ot),rt.associations.set(nt,ct)}}return _e!==void 0&&(nt.encoding=_e),s[o]=nt,nt})}assignFinalMaterial(s){const o=s.geometry;let a=s.material;const _e=o.attributes.tangent===void 0,rt=o.attributes.color!==void 0,nt=o.attributes.normal===void 0;if(s.isPoints){const ot="PointsMaterial:"+a.uuid;let ct=this.cache.get(ot);ct||(ct=new et.UY4,et.F5T.prototype.copy.call(ct,a),ct.color.copy(a.color),ct.map=a.map,ct.sizeAttenuation=!1,this.cache.add(ot,ct)),a=ct}else if(s.isLine){const ot="LineBasicMaterial:"+a.uuid;let ct=this.cache.get(ot);ct||(ct=new et.nls,et.F5T.prototype.copy.call(ct,a),ct.color.copy(a.color),this.cache.add(ot,ct)),a=ct}if(_e||rt||nt){let ot="ClonedMaterial:"+a.uuid+":";a.isGLTFSpecularGlossinessMaterial&&(ot+="specular-glossiness:"),_e&&(ot+="derivative-tangents:"),rt&&(ot+="vertex-colors:"),nt&&(ot+="flat-shading:");let ct=this.cache.get(ot);ct||(ct=a.clone(),rt&&(ct.vertexColors=!0),nt&&(ct.flatShading=!0),_e&&(ct.normalScale&&(ct.normalScale.y*=-1),ct.clearcoatNormalScale&&(ct.clearcoatNormalScale.y*=-1)),this.cache.add(ot,ct),this.associations.set(ct,this.associations.get(a))),a=ct}a.aoMap&&o.attributes.uv2===void 0&&o.attributes.uv!==void 0&&o.setAttribute("uv2",o.attributes.uv),s.material=a}getMaterialType(){return et.Wid}loadMaterial(s){const o=this,a=this.json,_e=this.extensions,rt=a.materials[s];let nt;const ot={},ct=rt.extensions||{},pt=[];if(ct[Ws.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const _t=_e[Ws.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];nt=_t.getMaterialType(),pt.push(_t.extendParams(ot,rt,o))}else if(ct[Ws.KHR_MATERIALS_UNLIT]){const _t=_e[Ws.KHR_MATERIALS_UNLIT];nt=_t.getMaterialType(),pt.push(_t.extendParams(ot,rt,o))}else{const _t=rt.pbrMetallicRoughness||{};if(ot.color=new et.Ilk(1,1,1),ot.opacity=1,Array.isArray(_t.baseColorFactor)){const Et=_t.baseColorFactor;ot.color.fromArray(Et),ot.opacity=Et[3]}_t.baseColorTexture!==void 0&&pt.push(o.assignTexture(ot,"map",_t.baseColorTexture,et.knz)),ot.metalness=_t.metallicFactor!==void 0?_t.metallicFactor:1,ot.roughness=_t.roughnessFactor!==void 0?_t.roughnessFactor:1,_t.metallicRoughnessTexture!==void 0&&(pt.push(o.assignTexture(ot,"metalnessMap",_t.metallicRoughnessTexture)),pt.push(o.assignTexture(ot,"roughnessMap",_t.metallicRoughnessTexture))),nt=this._invokeOne(function(Et){return Et.getMaterialType&&Et.getMaterialType(s)}),pt.push(Promise.all(this._invokeAll(function(Et){return Et.extendMaterialParams&&Et.extendMaterialParams(s,ot)})))}rt.doubleSided===!0&&(ot.side=et.ehD);const ht=rt.alphaMode||"OPAQUE";if(ht==="BLEND"?(ot.transparent=!0,ot.depthWrite=!1):(ot.transparent=!1,ht==="MASK"&&(ot.alphaTest=rt.alphaCutoff!==void 0?rt.alphaCutoff:.5)),rt.normalTexture!==void 0&&nt!==et.vBJ&&(pt.push(o.assignTexture(ot,"normalMap",rt.normalTexture)),ot.normalScale=new et.FM8(1,1),rt.normalTexture.scale!==void 0)){const _t=rt.normalTexture.scale;ot.normalScale.set(_t,_t)}return rt.occlusionTexture!==void 0&&nt!==et.vBJ&&(pt.push(o.assignTexture(ot,"aoMap",rt.occlusionTexture)),rt.occlusionTexture.strength!==void 0&&(ot.aoMapIntensity=rt.occlusionTexture.strength)),rt.emissiveFactor!==void 0&&nt!==et.vBJ&&(ot.emissive=new et.Ilk().fromArray(rt.emissiveFactor)),rt.emissiveTexture!==void 0&&nt!==et.vBJ&&pt.push(o.assignTexture(ot,"emissiveMap",rt.emissiveTexture,et.knz)),Promise.all(pt).then(function(){let _t;return _t=nt===zw?_e[Ws.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(ot):new nt(ot),rt.name&&(_t.name=rt.name),nm(_t,rt),o.associations.set(_t,{materials:s}),rt.extensions&&ms(_e,_t,rt),_t})}createUniqueName(s){const o=et.iUV.sanitizeNodeName(s||"");let a=o;for(let _e=1;this.nodeNamesUsed[a];++_e)a=o+"_"+_e;return this.nodeNamesUsed[a]=!0,a}loadGeometries(s){const o=this,a=this.extensions,_e=this.primitiveCache;function rt(ot){return a[Ws.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(ot,o).then(function(ct){return Ip(ct,ot,o)})}const nt=[];for(let ot=0,ct=s.length;ot<ct;ot++){const pt=s[ot],ht=V_(pt),_t=_e[ht];if(_t)nt.push(_t.promise);else{let Et;Et=pt.extensions&&pt.extensions[Ws.KHR_DRACO_MESH_COMPRESSION]?rt(pt):Ip(new et.u9r,pt,o),_e[ht]={primitive:pt,promise:Et},nt.push(Et)}}return Promise.all(nt)}loadMesh(s){const o=this,a=this.json,_e=this.extensions,rt=a.meshes[s],nt=rt.primitives,ot=[];for(let pt=0,ht=nt.length;pt<ht;pt++){const _t=nt[pt].material===void 0?((ct=this.cache).DefaultMaterial===void 0&&(ct.DefaultMaterial=new et.Wid({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:et.Wl3})),ct.DefaultMaterial):this.getDependency("material",nt[pt].material);ot.push(_t)}var ct;return ot.push(o.loadGeometries(nt)),Promise.all(ot).then(function(pt){const ht=pt.slice(0,pt.length-1),_t=pt[pt.length-1],Et=[];for(let Mt=0,It=_t.length;Mt<It;Mt++){const Nt=_t[Mt],Bt=nt[Mt];let kt;const Pt=ht[Mt];if(Bt.mode===4||Bt.mode===5||Bt.mode===6||Bt.mode===void 0)kt=rt.isSkinnedMesh===!0?new et.TUv(Nt,Pt):new et.Kj0(Nt,Pt),kt.isSkinnedMesh!==!0||kt.geometry.attributes.skinWeight.normalized||kt.normalizeSkinWeights(),Bt.mode===5?kt.geometry=N0(kt.geometry,et.UlW):Bt.mode===6&&(kt.geometry=N0(kt.geometry,et.z$h));else if(Bt.mode===1)kt=new et.ejS(Nt,Pt);else if(Bt.mode===3)kt=new et.x12(Nt,Pt);else if(Bt.mode===2)kt=new et.blk(Nt,Pt);else{if(Bt.mode!==0)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+Bt.mode);kt=new et.woe(Nt,Pt)}Object.keys(kt.geometry.morphAttributes).length>0&&Fy(kt,rt),kt.name=o.createUniqueName(rt.name||"mesh_"+s),nm(kt,rt),Bt.extensions&&ms(_e,kt,Bt),o.assignFinalMaterial(kt),Et.push(kt)}rt.extensions&&Et.forEach(Mt=>ms(_e,Mt,rt));for(let Mt=0,It=Et.length;Mt<It;Mt++)o.associations.set(Et[Mt],{meshes:s,primitives:Mt});if(Et.length===1)return Et[0];const St=new et.ZAu;o.associations.set(St,{meshes:s});for(let Mt=0,It=Et.length;Mt<It;Mt++)St.add(Et[Mt]);return St})}loadCamera(s){let o;const a=this.json.cameras[s],_e=a[a.type];if(_e)return a.type==="perspective"?o=new et.cPb(et.M8C.radToDeg(_e.yfov),_e.aspectRatio||1,_e.znear||1,_e.zfar||2e6):a.type==="orthographic"&&(o=new et.iKG(-_e.xmag,_e.xmag,_e.ymag,-_e.ymag,_e.znear,_e.zfar)),a.name&&(o.name=this.createUniqueName(a.name)),nm(o,a),Promise.resolve(o);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(s){const o=this.json.skins[s],a={joints:o.joints};return o.inverseBindMatrices===void 0?Promise.resolve(a):this.getDependency("accessor",o.inverseBindMatrices).then(function(_e){return a.inverseBindMatrices=_e,a})}loadAnimation(s){const o=this.json.animations[s],a=[],_e=[],rt=[],nt=[],ot=[];for(let ct=0,pt=o.channels.length;ct<pt;ct++){const ht=o.channels[ct],_t=o.samplers[ht.sampler],Et=ht.target,St=Et.node,Mt=o.parameters!==void 0?o.parameters[_t.input]:_t.input,It=o.parameters!==void 0?o.parameters[_t.output]:_t.output;a.push(this.getDependency("node",St)),_e.push(this.getDependency("accessor",Mt)),rt.push(this.getDependency("accessor",It)),nt.push(_t),ot.push(Et)}return Promise.all([Promise.all(a),Promise.all(_e),Promise.all(rt),Promise.all(nt),Promise.all(ot)]).then(function(ct){const pt=ct[0],ht=ct[1],_t=ct[2],Et=ct[3],St=ct[4],Mt=[];for(let Nt=0,Bt=pt.length;Nt<Bt;Nt++){const kt=pt[Nt],Pt=ht[Nt],qt=_t[Nt],Kt=Et[Nt],nr=St[Nt];if(kt===void 0)continue;let ir;switch(kt.updateMatrix(),jp[nr.path]){case jp.weights:ir=et.dUE;break;case jp.rotation:ir=et.iLg;break;default:ir=et.yC1}const fr=kt.name?kt.name:kt.uuid,br=Kt.interpolation!==void 0?kA[Kt.interpolation]:et.NMF,Tr=[];jp[nr.path]===jp.weights?kt.traverse(function(Rr){Rr.morphTargetInfluences&&Tr.push(Rr.name?Rr.name:Rr.uuid)}):Tr.push(fr);let Dr=qt.array;if(qt.normalized){const Rr=Vw(Dr.constructor),Nr=new Float32Array(Dr.length);for(let Ir=0,kr=Dr.length;Ir<kr;Ir++)Nr[Ir]=Dr[Ir]*Rr;Dr=Nr}for(let Rr=0,Nr=Tr.length;Rr<Nr;Rr++){const Ir=new ir(Tr[Rr]+"."+jp[nr.path],Pt.array,Dr,br);Kt.interpolation==="CUBICSPLINE"&&(Ir.createInterpolant=function(kr){return new(this instanceof et.iLg?k0:Cm)(this.times,this.values,this.getValueSize()/3,kr)},Ir.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),Mt.push(Ir)}}const It=o.name?o.name:"animation_"+s;return new et.m7l(It,void 0,Mt)})}createNodeMesh(s){const o=this.json,a=this,_e=o.nodes[s];return _e.mesh===void 0?null:a.getDependency("mesh",_e.mesh).then(function(rt){const nt=a._getNodeRef(a.meshCache,_e.mesh,rt);return _e.weights!==void 0&&nt.traverse(function(ot){if(ot.isMesh)for(let ct=0,pt=_e.weights.length;ct<pt;ct++)ot.morphTargetInfluences[ct]=_e.weights[ct]}),nt})}loadNode(s){const o=this.json,a=this.extensions,_e=this,rt=o.nodes[s],nt=rt.name?_e.createUniqueName(rt.name):"";return function(){const ot=[],ct=_e._invokeOne(function(pt){return pt.createNodeMesh&&pt.createNodeMesh(s)});return ct&&ot.push(ct),rt.camera!==void 0&&ot.push(_e.getDependency("camera",rt.camera).then(function(pt){return _e._getNodeRef(_e.cameraCache,rt.camera,pt)})),_e._invokeAll(function(pt){return pt.createNodeAttachment&&pt.createNodeAttachment(s)}).forEach(function(pt){ot.push(pt)}),Promise.all(ot)}().then(function(ot){let ct;if(ct=rt.isBone===!0?new et.N$j:ot.length>1?new et.ZAu:ot.length===1?ot[0]:new et.Tme,ct!==ot[0])for(let pt=0,ht=ot.length;pt<ht;pt++)ct.add(ot[pt]);if(rt.name&&(ct.userData.name=rt.name,ct.name=nt),nm(ct,rt),rt.extensions&&ms(a,ct,rt),rt.matrix!==void 0){const pt=new et.yGw;pt.fromArray(rt.matrix),ct.applyMatrix4(pt)}else rt.translation!==void 0&&ct.position.fromArray(rt.translation),rt.rotation!==void 0&&ct.quaternion.fromArray(rt.rotation),rt.scale!==void 0&&ct.scale.fromArray(rt.scale);return _e.associations.has(ct)||_e.associations.set(ct,{}),_e.associations.get(ct).nodes=s,ct})}loadScene(s){const o=this.json,a=this.extensions,_e=this.json.scenes[s],rt=this,nt=new et.ZAu;_e.name&&(nt.name=rt.createUniqueName(_e.name)),nm(nt,_e),_e.extensions&&ms(a,nt,_e);const ot=_e.nodes||[],ct=[];for(let pt=0,ht=ot.length;pt<ht;pt++)ct.push(qo(ot[pt],nt,o,rt));return Promise.all(ct).then(function(){return rt.associations=(pt=>{const ht=new Map;for(const[_t,Et]of rt.associations)(_t instanceof et.F5T||_t instanceof et.xEZ)&&ht.set(_t,Et);return pt.traverse(_t=>{const Et=rt.associations.get(_t);Et!=null&&ht.set(_t,Et)}),ht})(nt),nt})}}function qo(tt,s,o,a){const _e=o.nodes[tt];return a.getDependency("node",tt).then(function(rt){if(_e.skin===void 0)return rt;let nt;return a.getDependency("skin",_e.skin).then(function(ot){nt=ot;const ct=[];for(let pt=0,ht=nt.joints.length;pt<ht;pt++)ct.push(a.getDependency("node",nt.joints[pt]));return Promise.all(ct)}).then(function(ot){return rt.traverse(function(ct){if(!ct.isMesh)return;const pt=[],ht=[];for(let _t=0,Et=ot.length;_t<Et;_t++){const St=ot[_t];if(St){pt.push(St);const Mt=new et.yGw;nt.inverseBindMatrices!==void 0&&Mt.fromArray(nt.inverseBindMatrices.array,16*_t),ht.push(Mt)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',nt.joints[_t])}ct.bind(new et.OdW(pt,ht),ct.matrixWorld)}),rt})}).then(function(rt){s.add(rt);const nt=[];if(_e.children){const ot=_e.children;for(let ct=0,pt=ot.length;ct<pt;ct++){const ht=ot[ct];nt.push(qo(ht,rt,o,a))}}return Promise.all(nt)})}function Ip(tt,s,o){const a=s.attributes,_e=[];function rt(nt,ot){return o.getDependency("accessor",nt).then(function(ct){tt.setAttribute(ot,ct)})}for(const nt in a){const ot=O0[nt]||nt.toLowerCase();ot in tt.attributes||_e.push(rt(a[nt],ot))}if(s.indices!==void 0&&!tt.index){const nt=o.getDependency("accessor",s.indices).then(function(ot){tt.setIndex(ot)});_e.push(nt)}return nm(tt,s),function(nt,ot,ct){const pt=ot.attributes,ht=new et.ZzF;if(pt.POSITION===void 0)return;{const St=ct.json.accessors[pt.POSITION],Mt=St.min,It=St.max;if(Mt===void 0||It===void 0)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(ht.set(new et.Pa4(Mt[0],Mt[1],Mt[2]),new et.Pa4(It[0],It[1],It[2])),St.normalized){const Nt=Vw(np[St.componentType]);ht.min.multiplyScalar(Nt),ht.max.multiplyScalar(Nt)}}const _t=ot.targets;if(_t!==void 0){const St=new et.Pa4,Mt=new et.Pa4;for(let It=0,Nt=_t.length;It<Nt;It++){const Bt=_t[It];if(Bt.POSITION!==void 0){const kt=ct.json.accessors[Bt.POSITION],Pt=kt.min,qt=kt.max;if(Pt!==void 0&&qt!==void 0){if(Mt.setX(Math.max(Math.abs(Pt[0]),Math.abs(qt[0]))),Mt.setY(Math.max(Math.abs(Pt[1]),Math.abs(qt[1]))),Mt.setZ(Math.max(Math.abs(Pt[2]),Math.abs(qt[2]))),kt.normalized){const Kt=Vw(np[kt.componentType]);Mt.multiplyScalar(Kt)}St.max(Mt)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}ht.expandByVector(St)}nt.boundingBox=ht;const Et=new et.aLr;ht.getCenter(Et.center),Et.radius=ht.min.distanceTo(ht.max)/2,nt.boundingSphere=Et}(tt,s,o),Promise.all(_e).then(function(){return s.targets!==void 0?function(nt,ot,ct){let pt=!1,ht=!1,_t=!1;for(let It=0,Nt=ot.length;It<Nt;It++){const Bt=ot[It];if(Bt.POSITION!==void 0&&(pt=!0),Bt.NORMAL!==void 0&&(ht=!0),Bt.COLOR_0!==void 0&&(_t=!0),pt&&ht&&_t)break}if(!pt&&!ht&&!_t)return Promise.resolve(nt);const Et=[],St=[],Mt=[];for(let It=0,Nt=ot.length;It<Nt;It++){const Bt=ot[It];if(pt){const kt=Bt.POSITION!==void 0?ct.getDependency("accessor",Bt.POSITION):nt.attributes.position;Et.push(kt)}if(ht){const kt=Bt.NORMAL!==void 0?ct.getDependency("accessor",Bt.NORMAL):nt.attributes.normal;St.push(kt)}if(_t){const kt=Bt.COLOR_0!==void 0?ct.getDependency("accessor",Bt.COLOR_0):nt.attributes.color;Mt.push(kt)}}return Promise.all([Promise.all(Et),Promise.all(St),Promise.all(Mt)]).then(function(It){const Nt=It[0],Bt=It[1],kt=It[2];return pt&&(nt.morphAttributes.position=Nt),ht&&(nt.morphAttributes.normal=Bt),_t&&(nt.morphAttributes.color=kt),nt.morphTargetsRelative=!0,nt})}(tt,s.targets,o):tt})}function N0(tt,s){let o=tt.getIndex();if(o===null){const nt=[],ot=tt.getAttribute("position");if(ot===void 0)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),tt;for(let ct=0;ct<ot.count;ct++)nt.push(ct);tt.setIndex(nt),o=tt.getIndex()}const a=o.count-2,_e=[];if(s===et.z$h)for(let nt=1;nt<=a;nt++)_e.push(o.getX(0)),_e.push(o.getX(nt)),_e.push(o.getX(nt+1));else for(let nt=0;nt<a;nt++)nt%2==0?(_e.push(o.getX(nt)),_e.push(o.getX(nt+1)),_e.push(o.getX(nt+2))):(_e.push(o.getX(nt+2)),_e.push(o.getX(nt+1)),_e.push(o.getX(nt)));_e.length/3!==a&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const rt=tt.clone();return rt.setIndex(_e),rt}class Px extends Av{constructor(s){super(s),this.isGLTFLoader2=!0}async loadAsync(s,o){const a=await super.loadAsync(s,o),_e=a?a.scene||a.scenes&&a.scenes.length>0&&a.scenes[0]:void 0;return _e&&a.animations.length>0&&(_e.animations=a.animations),_e.traverse(rt=>{rt.userData.gltfUUID&&(rt.uuid=rt.userData.gltfUUID,delete rt.userData.gltfUUID)}),_e}register(s){return super.register(s)}}class G_ extends et.hH6{constructor(s){super(s),this.type=et.cLu}async loadAsync(s,o){const a=await this.parseAsync(s,o,!1),_e=new et.IEO(a.data,a.width,a.height,et.wk1,this.type);return _e.needsUpdate=!0,_e.flipY=!0,_e.encoding=et.rnI,_e.minFilter=et.wem,_e.magFilter=et.wem,_e.source.data.complete=!0,_e}async parseAsync(s,o,a=!1){if(!s.startsWith("data:")){this.responseType="blob";const ot=await super.loadAsync(s,o);s=(s=await Su(ot)).replace("application/octet-stream","image/png")}const _e=await Sm(s);let rt=Uint8Array;return this.type===et.cLu?rt=Uint16Array:this.type===et.VzW&&(rt=Uint32Array),{data:function(ot,ct=3,pt=Uint16Array,ht=!1){let _t;const Et=ot.byteLength>>2,St=new pt(Et*ct);for(let Mt=0;Mt<Et;Mt++)_t=Math.pow(2,ot[4*Mt+3]-136),ht?(St[Mt*ct]=Math.min(ot[4*Mt]*_t,65504),St[Mt*ct+1]=Math.min(ot[4*Mt+1]*_t,65504),St[Mt*ct+2]=Math.min(ot[4*Mt+2]*_t,65504)):(St[Mt*ct]=et.A5E.toHalfFloat(Math.min(ot[4*Mt]*_t,65504)),St[Mt*ct+1]=et.A5E.toHalfFloat(Math.min(ot[4*Mt+1]*_t,65504)),St[Mt*ct+2]=et.A5E.toHalfFloat(Math.min(ot[4*Mt+2]*_t,65504))),ct===4&&(St[Mt*ct+3]=et.A5E.toHalfFloat(1));return St}(_e.data,4,rt,a),width:_e.width,height:_e.height}}setDataType(s){return this.type=s,this}}class OA extends et.Gql{constructor(s){super(s),this._imageLoader=new et.S3k(s)}parseTextures2(s,o,a){var _e;for(const rt of s){const nt=(_e=rt==null?void 0:rt.userData)===null||_e===void 0?void 0:_e.rootPath;if(nt&&(!rt.image||!o[rt.image])){const ot=new et.Hw6(this._imageLoader.load(nt,a));if(!ot)continue;rt.image&&(ot.uuid=rt.image),o[ot.uuid]=ot,rt.image=ot.uuid}rt.userData=In(rt.userData,void 0,!1,{images:o})}return super.parseTextures(s,o)}parseMaterials2(s,o,a){const _e={};return s.forEach(rt=>{if(!rt)return;const nt={...rt},ot=Object.keys(nt);for(const pt of ot)if(pt==="map"||pt.endsWith("Map")){const ht=nt[pt];typeof ht=="string"&&(o[ht]?nt[pt]=o[ht]:(console.warn(`Texture ${ht} not found`),delete nt[pt]))}nt.userData&&(nt.userData=In(nt.userData,void 0,!1,{textures:o}));const ct=a.generateFromTemplateType(nt.type,nt);ct&&(_e[rt.uuid]=ct)}),_e}}const im="WEBGI_viewer";function zu(tt){mo.Importers.push(new Yl(Px,["gltf","glb","data:model/gltf"],!0,(s,o)=>{if(!s)return s;const a=s,_e=new OA(o.loadingManager);return a.register(xv(_e,tt)),a.register(Q_()),a.register(H_(_e)),a.register(rt=>new n_(rt)),a.register(rt=>new Pp(rt)),a.register(rt=>new F0(rt)),a.register(rt=>new NA(rt)),a.register(rt=>{var nt,ot,ct,pt,ht,_t,Et,St,Mt;const It=Mo()+".drc",Nt=Mo()+".ktx2",Bt=(ct=(ot=(nt=rt.json)===null||nt===void 0?void 0:nt.extensionsRequired)===null||ot===void 0?void 0:ot.includes)===null||ct===void 0?void 0:ct.call(ot,"KHR_draco_mesh_compression");if(Bt){const Pt=o.registerFile(It);Pt&&a.setDRACOLoader(Pt)}!((_t=(ht=(pt=rt.json)===null||pt===void 0?void 0:pt.extensionsUsed)===null||ht===void 0?void 0:ht.includes)===null||_t===void 0)&&_t.call(ht,"EXT_meshopt_compression")&&(window.MeshoptDecoder?(a.setMeshoptDecoder(window.MeshoptDecoder),rt.options.meshoptDecoder=window.MeshoptDecoder):console.error("Add GLTFMeshOptPlugin to viewer to enable EXT_meshopt_compression decode"));const kt=(Mt=(St=(Et=rt.json)===null||Et===void 0?void 0:Et.extensionsUsed)===null||St===void 0?void 0:St.includes)===null||Mt===void 0?void 0:Mt.call(St,"KHR_texture_basisu");if(kt){const Pt=o.registerFile(Nt);Pt&&(a.setKTX2Loader(Pt),rt.options.ktx2Loader=Pt)}return{name:"GLTF2_HELPER_PLUGIN",afterRoot:async Pt=>{Bt&&o.unregisterFile(It),kt&&o.unregisterFile(Nt);const qt=await LA(rt,tt,_e);Pt.scene.__importedViewerConfig=qt}}}),a}))}const Mr="WEBGI_light_extras",wv="WEBGI_object3d_extras",sm="WEBGI_material_extras",Q_=tt=>s=>({name:"__"+wv,afterRoot:async o=>{(o.scenes||(o.scene?[o.scene]:[])).forEach(a=>{a.traverse(_e=>{var rt,nt;if(!_e.isObject3D)return;const ot=(nt=(rt=_e.userData)===null||rt===void 0?void 0:rt.gltfExtensions)===null||nt===void 0?void 0:nt[wv];if(!ot)return void(_e.isLight&&!_e.isAmbientLight&&(_e.castShadow=!0));const ct=ot.castShadow!==void 0||ot.receiveShadow!==void 0;ot.castShadow!==void 0&&(_e.castShadow=ot.castShadow),ot.receiveShadow!==void 0&&(_e.receiveShadow=ot.receiveShadow),ot.visible!==void 0&&(_e.visible=ot.visible),ot.frustumCulled!==void 0&&(_e.frustumCulled=ot.frustumCulled),ot.renderOrder!==void 0&&(_e.renderOrder=ot.renderOrder),ot.layers!==void 0&&(_e.layers.mask=ot.layers),ct&&(_e.userData.__keepShadowDef=!0),delete _e.userData.gltfExtensions[wv]})})}}),xv=(tt,s)=>o=>({name:"__"+sm,afterRoot:async a=>{var _e,rt,nt;const ot=a.scenes||(a.scene?[a.scene]:[]);for(const ct of ot){const pt=(rt=(_e=ct.userData)===null||_e===void 0?void 0:_e.gltfExtensions)===null||rt===void 0?void 0:rt[sm],ht=pt&&await((nt=s.getPlugin(os))===null||nt===void 0?void 0:nt.importConfigResources(pt.resources||{}))||{};ct.traverse(_t=>{var Et,St;const Mt=_t==null?void 0:_t.material;if(!(Mt!=null&&Mt.isMaterial))return;const It=(St=(Et=Mt.userData)===null||Et===void 0?void 0:Et.gltfExtensions)===null||St===void 0?void 0:St[sm];It&&(It.emissiveIntensity!==void 0&&(Mt.emissiveIntensity=It.emissiveIntensity),It.fog!==void 0&&(Mt.fog=It.fog),It.flatShading!==void 0&&(Mt.flatShading=It.flatShading),It.blending!==void 0&&(Mt.blending=It.blending),It.side!==void 0&&(Mt.side=It.side),It.shadowSide!==void 0&&(Mt.shadowSide=It.shadowSide),It.depthFunc!==void 0&&(Mt.depthFunc=It.depthFunc),It.depthTest!==void 0&&(Mt.depthTest=It.depthTest),It.depthWrite!==void 0&&(Mt.depthWrite=It.depthWrite),It.colorWrite!==void 0&&(Mt.colorWrite=It.colorWrite),It.wireframe!==void 0&&(Mt.wireframe=It.wireframe),It.wireframeLinewidth!==void 0&&(Mt.wireframeLinewidth=It.wireframeLinewidth),It.wireframeLinecap!==void 0&&(Mt.wireframeLinecap=It.wireframeLinecap),It.wireframeLinejoin!==void 0&&(Mt.wireframeLinejoin=It.wireframeLinejoin),It.rotation!==void 0&&(Mt.rotation=It.rotation),It.polygonOffset!==void 0&&(Mt.polygonOffset=It.polygonOffset),It.polygonOffsetFactor!==void 0&&(Mt.polygonOffsetFactor=It.polygonOffsetFactor),It.polygonOffsetUnits!==void 0&&(Mt.polygonOffsetUnits=It.polygonOffsetUnits),It.dithering!==void 0&&(Mt.dithering=It.dithering),It.alphaToCoverage!==void 0&&(Mt.alphaToCoverage=It.alphaToCoverage),It.premultipliedAlpha!==void 0&&(Mt.premultipliedAlpha=It.premultipliedAlpha),It.toneMapped!==void 0&&(Mt.toneMapped=It.toneMapped),It.reflectivity!==void 0&&(Mt.reflectivity=It.reflectivity),Object.entries(It).forEach(([Nt,Bt])=>{Nt.startsWith("_")||Bt&&Bt.resource&&typeof Bt.resource=="string"&&(Mt[Nt]=In(Bt,Mt[Nt],!1,ht))}),delete Mt.userData.gltfExtensions[sm])}),pt&&delete ct.userData.gltfExtensions[sm]}}}),H_=tt=>s=>({name:"__"+Mr,afterRoot:async o=>{(o.scenes||(o.scene?[o.scene]:[])).forEach(a=>{a.traverse(_e=>{var rt,nt;if(!_e.isLight)return;const ot=(nt=(rt=_e.userData)===null||rt===void 0?void 0:rt.gltfExtensions)===null||nt===void 0?void 0:nt[Mr];ot&&(!_e.shadow&&ot.shadow&&console.error("Light has no shadow, cannot import",_e,ot),ot.shadow&&_e.shadow&&(ot.shadow.bias!==void 0&&(_e.shadow.bias=ot.shadow.bias),ot.shadow.normalBias!==void 0&&(_e.shadow.normalBias=ot.shadow.normalBias),ot.shadow.radius!==void 0&&(_e.shadow.radius=ot.shadow.radius),ot.shadow.mapSize!==void 0&&_e.shadow.mapSize.fromArray(ot.shadow.mapSize),ot.shadow.camera!==void 0&&(_e.shadow.camera=tt.parseObject(ot.shadow.camera))),delete _e.userData.gltfExtensions[Mr])})})}});async function LA(tt,s,o,a){var _e;if(!a){const ct=tt.json.scenes||[];if(ct.length!==1){for(const pt of ct)await LA(tt,s,pt);return}a=ct[0]}const rt=(_e=a.extensions)===null||_e===void 0?void 0:_e[im];if(!rt)return;const nt=[];Object.values(rt.resources).forEach(ct=>{Object.values(ct).forEach(pt=>{pt.url&&(pt.url.type==="Uint16Array"&&pt.url.data&&nt.push(pt.url),pt.url.type==="Uint8Array"&&pt.url.data&&nt.push(pt.url))})});for(const ct of nt){const pt=ct.data.image,ht=tt.json.images[pt],_t=await tt.getDependency("bufferView",ht.bufferView);if(ht.mimeType.startsWith("image/")&&ct.type==="Uint16Array"&&ct.encoding==="rgbe"){const Et=new Blob([_t],{type:ht.mimeType}),St="data:image/png;base64,"+btoa(await Et.text());ct.data=(await new G_().parseAsync(St,void 0,!0)).data,delete ct.encoding}else ct.data=_t}const ot={textures:{}};if(rt.resources.textures&&tt.json.textures)for(const[ct,pt]of Object.entries(rt.resources.textures)){if(pt.uuid||!ct)continue;delete rt.resources.textures[ct];const ht=tt.json.textures.findIndex(_t=>{var Et,St,Mt,It,Nt,Bt,kt;return((Et=_t.extras)===null||Et===void 0?void 0:Et.uuid)===ct||((It=(Mt=(St=tt.json.samplers)===null||St===void 0?void 0:St[_t.sampler])===null||Mt===void 0?void 0:Mt.extras)===null||It===void 0?void 0:It.uuid)===ct||((kt=(Bt=(Nt=tt.json.images)===null||Nt===void 0?void 0:Nt[_t.source])===null||Bt===void 0?void 0:Bt.extras)===null||kt===void 0?void 0:kt.t_uuid)===ct});ht>=0&&(ot.textures[ct]=await tt.getDependency("texture",ht))}if(rt.resources.materials&&tt.json.materials)for(const[ct,pt]of Object.entries(rt.resources.materials)){if(pt.uuid||!ct)continue;delete rt.resources.materials[ct];const ht=tt.json.materials.findIndex(_t=>{var Et;return((Et=_t.extras)===null||Et===void 0?void 0:Et.uuid)===ct});ht>=0&&(ot.materials[ct]=await tt.getDependency("material",ht))}return rt.resources=await s.getPlugin(os).importConfigResources(rt.resources||{},o,ot),rt}const Tm="WEBGI_materials_bumpmap",r_="WEBGI_materials_displacementmap",Ev="WEBGI_materials_alphamap",Mm="WEBGI_materials_lightmap";class n_{constructor(s){this.parser=s,this.name=Tm}async extendMaterialParams(s,o){const a=this.parser,_e=a.json.materials[s];if(!_e.extensions||!_e.extensions[this.name])return Promise.resolve();const rt=[],nt=_e.extensions[this.name];return nt.bumpScale!==void 0&&(o.bumpScale=nt.bumpScale),nt.bumpTexture!==void 0&&rt.push(a.assignTexture(o,"bumpMap",nt.bumpTexture)),Promise.all(rt)}}class Pp{constructor(s){this.parser=s,this.name=r_}async extendMaterialParams(s,o){const a=this.parser,_e=a.json.materials[s];if(!_e.extensions||!_e.extensions[this.name])return Promise.resolve();const rt=[],nt=_e.extensions[this.name];return nt.displacementScale!==void 0&&(o.displacementScale=nt.displacementScale),nt.displacementBias!==void 0&&(o.displacementBias=nt.displacementBias),nt.displacementTexture!==void 0&&rt.push(a.assignTexture(o,"displacementMap",nt.displacementTexture)),Promise.all(rt)}}class F0{constructor(s){this.parser=s,this.name=Mm}async extendMaterialParams(s,o){const a=this.parser,_e=a.json.materials[s];if(!_e.extensions||!_e.extensions[this.name])return Promise.resolve();const rt=[],nt=_e.extensions[this.name];return nt.lightMapIntensity!==void 0&&(o.lightMapIntensity=nt.lightMapIntensity),nt.lightMapTexture!==void 0&&rt.push(a.assignTexture(o,"lightMap",nt.lightMapTexture)),Promise.all(rt)}}class NA{constructor(s){this.parser=s,this.name=Ev}async extendMaterialParams(s,o){const a=this.parser,_e=a.json.materials[s];if(!_e.extensions||!_e.extensions[this.name])return Promise.resolve();const rt=[],nt=_e.extensions[this.name];return nt.alphaTexture!==void 0&&rt.push(a.assignTexture(o,"alphaMap",nt.alphaTexture)),Promise.all(rt)}}var q_=__webpackgi_require__(23);function i_(){mo.Importers.push(new Yl(q_.Q,["drc"],!0))}var FA={},Io=Uint8Array,Nl=Uint16Array,om=Uint32Array,zp=new Io([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),am=new Io([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),xu=new Io([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),UA=function(tt,s){for(var o=new Nl(31),a=0;a<31;++a)o[a]=s+=1<<tt[a-1];var _e=new om(o[30]);for(a=1;a<30;++a)for(var rt=o[a];rt<o[a+1];++rt)_e[rt]=rt-o[a]<<5|a;return[o,_e]},U0=UA(zp,2),Ym=U0[0],$0=U0[1];Ym[28]=258,$0[258]=28;for(var Uy=UA(am,0),$A=Uy[0],s_=Uy[1],Ys=new Nl(32768),$a=0;$a<32768;++$a){var Iu=(43690&$a)>>>1|(21845&$a)<<1;Iu=(61680&(Iu=(52428&Iu)>>>2|(13107&Iu)<<2))>>>4|(3855&Iu)<<4,Ys[$a]=((65280&Iu)>>>8|(255&Iu)<<8)>>>1}var lm=function(tt,s,o){for(var a=tt.length,_e=0,rt=new Nl(s);_e<a;++_e)++rt[tt[_e]-1];var nt,ot=new Nl(s);for(_e=0;_e<s;++_e)ot[_e]=ot[_e-1]+rt[_e-1]<<1;if(o){nt=new Nl(1<<s);var ct=15-s;for(_e=0;_e<a;++_e)if(tt[_e])for(var pt=_e<<4|tt[_e],ht=s-tt[_e],_t=ot[tt[_e]-1]++<<ht,Et=_t|(1<<ht)-1;_t<=Et;++_t)nt[Ys[_t]>>>ct]=pt}else for(nt=new Nl(a),_e=0;_e<a;++_e)tt[_e]&&(nt[_e]=Ys[ot[tt[_e]-1]++]>>>15-tt[_e]);return nt},Sv=new Io(288);for($a=0;$a<144;++$a)Sv[$a]=8;for($a=144;$a<256;++$a)Sv[$a]=9;for($a=256;$a<280;++$a)Sv[$a]=7;for($a=280;$a<288;++$a)Sv[$a]=8;var Pu=new Io(32);for($a=0;$a<32;++$a)Pu[$a]=5;var j0=lm(Sv,9,0),Dp=lm(Sv,9,1),Gw=lm(Pu,5,0),$y=lm(Pu,5,1),Rm=function(tt){for(var s=tt[0],o=1;o<tt.length;++o)tt[o]>s&&(s=tt[o]);return s},mp=function(tt,s,o){var a=s/8|0;return(tt[a]|tt[a+1]<<8)>>(7&s)&o},Cv=function(tt,s){var o=s/8|0;return(tt[o]|tt[o+1]<<8|tt[o+2]<<16)>>(7&s)},W_=function(tt){return(tt/8|0)+(7&tt&&1)},Vu=function(tt,s,o){(s==null||s<0)&&(s=0),(o==null||o>tt.length)&&(o=tt.length);var a=new(tt instanceof Nl?Nl:tt instanceof om?om:Io)(o-s);return a.set(tt.subarray(s,o)),a},Vp=function(tt,s,o){var a=tt.length;if(!a||o&&!o.l&&a<5)return s||new Io(0);var _e=!s||o,rt=!o||o.i;o||(o={}),s||(s=new Io(3*a));var nt=function(bs){var Cn=s.length;if(bs>Cn){var eo=new Io(Math.max(2*Cn,bs));eo.set(s),s=eo}},ot=o.f||0,ct=o.p||0,pt=o.b||0,ht=o.l,_t=o.d,Et=o.m,St=o.n,Mt=8*a;do{if(!ht){o.f=ot=mp(tt,ct,1);var It=mp(tt,ct+1,3);if(ct+=3,!It){var Nt=tt[(Dr=W_(ct)+4)-4]|tt[Dr-3]<<8,Bt=Dr+Nt;if(Bt>a){if(rt)throw"unexpected EOF";break}_e&&nt(pt+Nt),s.set(tt.subarray(Dr,Bt),pt),o.b=pt+=Nt,o.p=ct=8*Bt;continue}if(It==1)ht=Dp,_t=$y,Et=9,St=5;else{if(It!=2)throw"invalid block type";var kt=mp(tt,ct,31)+257,Pt=mp(tt,ct+10,15)+4,qt=kt+mp(tt,ct+5,31)+1;ct+=14;for(var Kt=new Io(qt),nr=new Io(19),ir=0;ir<Pt;++ir)nr[xu[ir]]=mp(tt,ct+3*ir,7);ct+=3*Pt;var fr=Rm(nr),br=(1<<fr)-1,Tr=lm(nr,fr,1);for(ir=0;ir<qt;){var Dr,Rr=Tr[mp(tt,ct,br)];if(ct+=15&Rr,(Dr=Rr>>>4)<16)Kt[ir++]=Dr;else{var Nr=0,Ir=0;for(Dr==16?(Ir=3+mp(tt,ct,3),ct+=2,Nr=Kt[ir-1]):Dr==17?(Ir=3+mp(tt,ct,7),ct+=3):Dr==18&&(Ir=11+mp(tt,ct,127),ct+=7);Ir--;)Kt[ir++]=Nr}}var kr=Kt.subarray(0,kt),Hr=Kt.subarray(kt);Et=Rm(kr),St=Rm(Hr),ht=lm(kr,Et,1),_t=lm(Hr,St,1)}if(ct>Mt){if(rt)throw"unexpected EOF";break}}_e&&nt(pt+131072);for(var Lr=(1<<Et)-1,en=(1<<St)-1,vn=ct;;vn=ct){var wn=(Nr=ht[Cv(tt,ct)&Lr])>>>4;if((ct+=15&Nr)>Mt){if(rt)throw"unexpected EOF";break}if(!Nr)throw"invalid length/literal";if(wn<256)s[pt++]=wn;else{if(wn==256){vn=ct,ht=null;break}var pn=wn-254;if(wn>264){var Fn=zp[ir=wn-257];pn=mp(tt,ct,(1<<Fn)-1)+Ym[ir],ct+=Fn}var Gn=_t[Cv(tt,ct)&en],Qn=Gn>>>4;if(!Gn)throw"invalid distance";if(ct+=15&Gn,Hr=$A[Qn],Qn>3&&(Fn=am[Qn],Hr+=Cv(tt,ct)&(1<<Fn)-1,ct+=Fn),ct>Mt){if(rt)throw"unexpected EOF";break}_e&&nt(pt+131072);for(var Yn=pt+pn;pt<Yn;pt+=4)s[pt]=s[pt-Hr],s[pt+1]=s[pt+1-Hr],s[pt+2]=s[pt+2-Hr],s[pt+3]=s[pt+3-Hr];pt=Yn}}o.l=ht,o.p=vn,o.b=pt,ht&&(ot=1,o.m=Et,o.d=_t,o.n=St)}while(!ot);return pt==s.length?s:Vu(s,0,pt)},ip=function(tt,s,o){o<<=7&s;var a=s/8|0;tt[a]|=o,tt[a+1]|=o>>>8},Km=function(tt,s,o){o<<=7&s;var a=s/8|0;tt[a]|=o,tt[a+1]|=o>>>8,tt[a+2]|=o>>>16},jA=function(tt,s){for(var o=[],a=0;a<tt.length;++a)tt[a]&&o.push({s:a,f:tt[a]});var _e=o.length,rt=o.slice();if(!_e)return[ao,0];if(_e==1){var nt=new Io(o[0].s+1);return nt[o[0].s]=1,[nt,1]}o.sort(function(Kt,nr){return Kt.f-nr.f}),o.push({s:-1,f:25001});var ot=o[0],ct=o[1],pt=0,ht=1,_t=2;for(o[0]={s:-1,f:ot.f+ct.f,l:ot,r:ct};ht!=_e-1;)ot=o[o[pt].f<o[_t].f?pt++:_t++],ct=o[pt!=ht&&o[pt].f<o[_t].f?pt++:_t++],o[ht++]={s:-1,f:ot.f+ct.f,l:ot,r:ct};var Et=rt[0].s;for(a=1;a<_e;++a)rt[a].s>Et&&(Et=rt[a].s);var St=new Nl(Et+1),Mt=o_(o[ht-1],St,0);if(Mt>s){a=0;var It=0,Nt=Mt-s,Bt=1<<Nt;for(rt.sort(function(Kt,nr){return St[nr.s]-St[Kt.s]||Kt.f-nr.f});a<_e;++a){var kt=rt[a].s;if(!(St[kt]>s))break;It+=Bt-(1<<Mt-St[kt]),St[kt]=s}for(It>>>=Nt;It>0;){var Pt=rt[a].s;St[Pt]<s?It-=1<<s-St[Pt]++-1:++a}for(;a>=0&&It;--a){var qt=rt[a].s;St[qt]==s&&(--St[qt],++It)}Mt=s}return[new Io(St),Mt]},o_=function(tt,s,o){return tt.s==-1?Math.max(o_(tt.l,s,o+1),o_(tt.r,s,o+1)):s[tt.s]=o},jy=function(tt){for(var s=tt.length;s&&!tt[--s];);for(var o=new Nl(++s),a=0,_e=tt[0],rt=1,nt=function(ct){o[a++]=ct},ot=1;ot<=s;++ot)if(tt[ot]==_e&&ot!=s)++rt;else{if(!_e&&rt>2){for(;rt>138;rt-=138)nt(32754);rt>2&&(nt(rt>10?rt-11<<5|28690:rt-3<<5|12305),rt=0)}else if(rt>3){for(nt(_e),--rt;rt>6;rt-=6)nt(8304);rt>2&&(nt(rt-3<<5|8208),rt=0)}for(;rt--;)nt(_e);rt=1,_e=tt[ot]}return[o.subarray(0,a),s]},Y_=function(tt,s){for(var o=0,a=0;a<s.length;++a)o+=tt[a]*s[a];return o},a_=function(tt,s,o){var a=o.length,_e=W_(s+2);tt[_e]=255&a,tt[_e+1]=a>>>8,tt[_e+2]=255^tt[_e],tt[_e+3]=255^tt[_e+1];for(var rt=0;rt<a;++rt)tt[_e+rt+4]=o[rt];return 8*(_e+4+a)},zA=function(tt,s,o,a,_e,rt,nt,ot,ct,pt,ht){ip(s,ht++,o),++_e[256];for(var _t=jA(_e,15),Et=_t[0],St=_t[1],Mt=jA(rt,15),It=Mt[0],Nt=Mt[1],Bt=jy(Et),kt=Bt[0],Pt=Bt[1],qt=jy(It),Kt=qt[0],nr=qt[1],ir=new Nl(19),fr=0;fr<kt.length;++fr)ir[31&kt[fr]]++;for(fr=0;fr<Kt.length;++fr)ir[31&Kt[fr]]++;for(var br=jA(ir,7),Tr=br[0],Dr=br[1],Rr=19;Rr>4&&!Tr[xu[Rr-1]];--Rr);var Nr,Ir,kr,Hr,Lr=pt+5<<3,en=Y_(_e,Sv)+Y_(rt,Pu)+nt,vn=Y_(_e,Et)+Y_(rt,It)+nt+14+3*Rr+Y_(ir,Tr)+(2*ir[16]+3*ir[17]+7*ir[18]);if(Lr<=en&&Lr<=vn)return a_(s,ht,tt.subarray(ct,ct+pt));if(ip(s,ht,1+(vn<en)),ht+=2,vn<en){Nr=lm(Et,St,0),Ir=Et,kr=lm(It,Nt,0),Hr=It;var wn=lm(Tr,Dr,0);for(ip(s,ht,Pt-257),ip(s,ht+5,nr-1),ip(s,ht+10,Rr-4),ht+=14,fr=0;fr<Rr;++fr)ip(s,ht+3*fr,Tr[xu[fr]]);ht+=3*Rr;for(var pn=[kt,Kt],Fn=0;Fn<2;++Fn){var Gn=pn[Fn];for(fr=0;fr<Gn.length;++fr){var Qn=31&Gn[fr];ip(s,ht,wn[Qn]),ht+=Tr[Qn],Qn>15&&(ip(s,ht,Gn[fr]>>>5&127),ht+=Gn[fr]>>>12)}}}else Nr=j0,Ir=Sv,kr=Gw,Hr=Pu;for(fr=0;fr<ot;++fr)if(a[fr]>255){Qn=a[fr]>>>18&31,Km(s,ht,Nr[Qn+257]),ht+=Ir[Qn+257],Qn>7&&(ip(s,ht,a[fr]>>>23&31),ht+=zp[Qn]);var Yn=31&a[fr];Km(s,ht,kr[Yn]),ht+=Hr[Yn],Yn>3&&(Km(s,ht,a[fr]>>>5&8191),ht+=am[Yn])}else Km(s,ht,Nr[a[fr]]),ht+=Ir[a[fr]];return Km(s,ht,Nr[256]),ht+Ir[256]},Qw=new om([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ao=new Io(0),um=function(tt,s,o,a,_e,rt){var nt=tt.length,ot=new Io(a+nt+5*(1+Math.ceil(nt/7e3))+_e),ct=ot.subarray(a,ot.length-_e),pt=0;if(!s||nt<8)for(var ht=0;ht<=nt;ht+=65535){var _t=ht+65535;_t<nt?pt=a_(ct,pt,tt.subarray(ht,_t)):(ct[ht]=rt,pt=a_(ct,pt,tt.subarray(ht,nt)))}else{for(var Et=Qw[s-1],St=Et>>>13,Mt=8191&Et,It=(1<<o)-1,Nt=new Nl(32768),Bt=new Nl(It+1),kt=Math.ceil(o/3),Pt=2*kt,qt=function(Sl){return(tt[Sl]^tt[Sl+1]<<kt^tt[Sl+2]<<Pt)&It},Kt=new om(25e3),nr=new Nl(288),ir=new Nl(32),fr=0,br=0,Tr=(ht=0,0),Dr=0,Rr=0;ht<nt;++ht){var Nr=qt(ht),Ir=32767&ht,kr=Bt[Nr];if(Nt[Ir]=kr,Bt[Nr]=Ir,Dr<=ht){var Hr=nt-ht;if((fr>7e3||Tr>24576)&&Hr>423){pt=zA(tt,ct,0,Kt,nr,ir,br,Tr,Rr,ht-Rr,pt),Tr=fr=br=0,Rr=ht;for(var Lr=0;Lr<286;++Lr)nr[Lr]=0;for(Lr=0;Lr<30;++Lr)ir[Lr]=0}var en=2,vn=0,wn=Mt,pn=Ir-kr&32767;if(Hr>2&&Nr==qt(ht-pn))for(var Fn=Math.min(St,Hr)-1,Gn=Math.min(32767,ht),Qn=Math.min(258,Hr);pn<=Gn&&--wn&&Ir!=kr;){if(tt[ht+en]==tt[ht+en-pn]){for(var Yn=0;Yn<Qn&&tt[ht+Yn]==tt[ht+Yn-pn];++Yn);if(Yn>en){if(en=Yn,vn=pn,Yn>Fn)break;var bs=Math.min(pn,Yn-2),Cn=0;for(Lr=0;Lr<bs;++Lr){var eo=ht-pn+Lr+32768&32767,vo=eo-Nt[eo]+32768&32767;vo>Cn&&(Cn=vo,kr=eo)}}}pn+=(Ir=kr)-(kr=Nt[Ir])+32768&32767}if(vn){Kt[Tr++]=268435456|$0[en]<<18|s_[vn];var to=31&$0[en],zo=31&s_[vn];br+=zp[to]+am[zo],++nr[257+to],++ir[zo],Dr=ht+en,++fr}else Kt[Tr++]=tt[ht],++nr[tt[ht]]}}pt=zA(tt,ct,rt,Kt,nr,ir,br,Tr,Rr,ht-Rr,pt),!rt&&7&pt&&(pt=a_(ct,pt+1,ao))}return Vu(ot,0,a+W_(pt)+_e)},Xm=function(){for(var tt=new Int32Array(256),s=0;s<256;++s){for(var o=s,a=9;--a;)o=(1&o&&-306674912)^o>>>1;tt[s]=o}return tt}(),gp=function(){var tt=-1;return{p:function(s){for(var o=tt,a=0;a<s.length;++a)o=Xm[255&o^s[a]]^o>>>8;tt=o},d:function(){return~tt}}},Im=function(){var tt=1,s=0;return{p:function(o){for(var a=tt,_e=s,rt=o.length,nt=0;nt!=rt;){for(var ot=Math.min(nt+2655,rt);nt<ot;++nt)_e+=a+=o[nt];a=(65535&a)+15*(a>>16),_e=(65535&_e)+15*(_e>>16)}tt=a,s=_e},d:function(){return(255&(tt%=65521))<<24|tt>>>8<<16|(255&(s%=65521))<<8|s>>>8}}},cm=function(tt,s,o,a,_e){return um(tt,s.level==null?6:s.level,s.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(tt.length)))):12+s.mem,o,a,!_e)},dm=function(tt,s){var o={};for(var a in tt)o[a]=tt[a];for(var a in s)o[a]=s[a];return o},VA=function(tt,s,o){for(var a=tt(),_e=tt.toString(),rt=_e.slice(_e.indexOf("[")+1,_e.lastIndexOf("]")).replace(/ /g,"").split(","),nt=0;nt<a.length;++nt){var ot=a[nt],ct=rt[nt];if(typeof ot=="function"){s+=";"+ct+"=";var pt=ot.toString();if(ot.prototype)if(pt.indexOf("[native code]")!=-1){var ht=pt.indexOf(" ",8)+1;s+=pt.slice(ht,pt.indexOf("(",ht))}else for(var _t in s+=pt,ot.prototype)s+=";"+ct+".prototype."+_t+"="+ot.prototype[_t].toString();else s+=pt}else o[ct]=ot}return[s,o]},z0=[],GA=function(tt,s,o,a){var _e;if(!z0[o]){for(var rt="",nt={},ot=tt.length-1,ct=0;ct<ot;++ct)rt=(_e=VA(tt[ct],rt,nt))[0],nt=_e[1];z0[o]=VA(tt[ot],rt,nt)}var pt=dm({},z0[o][1]);return function(ht,_t,Et,St,Mt){var It=new Worker(FA[_t]||(FA[_t]=URL.createObjectURL(new Blob([ht],{type:"text/javascript"}))));return It.onerror=function(Nt){return Mt(Nt.error,null)},It.onmessage=function(Nt){return Mt(null,Nt.data)},It.postMessage(Et,St),It}(z0[o][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+s.toString()+"}",o,pt,function(ht){var _t=[];for(var Et in ht)(ht[Et]instanceof Io||ht[Et]instanceof Nl||ht[Et]instanceof om)&&_t.push((ht[Et]=new ht[Et].constructor(ht[Et])).buffer);return _t}(pt),a)},l_=function(){return[Io,Nl,om,zp,am,xu,Ym,$A,Dp,$y,Ys,lm,Rm,mp,Cv,W_,Vu,Vp,sp,pm,El]},Gu=function(){return[Io,Nl,om,zp,am,xu,$0,s_,j0,Sv,Gw,Pu,Ys,Qw,ao,lm,ip,Km,jA,o_,jy,Y_,a_,zA,W_,Vu,um,cm,xs,pm]},Dx=function(){return[gt,hr,Dt,gp,Xm]},Qu=function(){return[xt,$t]},Jm=function(){return[Pr,Dt,Im]},au=function(){return[$r]},pm=function(tt){return postMessage(tt,[tt.buffer])},El=function(tt){return tt&&tt.size&&new Io(tt.size)},V0=function(tt,s,o,a,_e,rt){var nt=GA(o,a,_e,function(ot,ct){nt.terminate(),rt(ot,ct)});return nt.postMessage([tt,s],s.consume?[tt.buffer]:[]),function(){nt.terminate()}},hm=function(tt){return tt.ondata=function(s,o){return postMessage([s,o],[s.buffer])},function(s){return tt.push(s.data[0],s.data[1])}},G0=function(tt,s,o,a,_e){var rt,nt=GA(tt,a,_e,function(ot,ct){ot?(nt.terminate(),s.ondata.call(s,ot)):(ct[1]&&nt.terminate(),s.ondata.call(s,ot,ct[0],ct[1]))});nt.postMessage(o),s.push=function(ot,ct){if(rt)throw"stream finished";if(!s.ondata)throw"no stream handler";nt.postMessage([ot,rt=ct],[ot.buffer])},s.terminate=function(){nt.terminate()}},vp=function(tt,s){return tt[s]|tt[s+1]<<8},Xl=function(tt,s){return(tt[s]|tt[s+1]<<8|tt[s+2]<<16|tt[s+3]<<24)>>>0},Hw=function(tt,s){return Xl(tt,s)+4294967296*Xl(tt,s+4)},Dt=function(tt,s,o){for(;o;++s)tt[s]=o,o>>>=8},gt=function(tt,s){var o=s.filename;if(tt[0]=31,tt[1]=139,tt[2]=8,tt[8]=s.level<2?4:s.level==9?2:0,tt[9]=3,s.mtime!=0&&Dt(tt,4,Math.floor(new Date(s.mtime||Date.now())/1e3)),o){tt[3]=8;for(var a=0;a<=o.length;++a)tt[a+10]=o.charCodeAt(a)}},xt=function(tt){if(tt[0]!=31||tt[1]!=139||tt[2]!=8)throw"invalid gzip data";var s=tt[3],o=10;4&s&&(o+=tt[10]|2+(tt[11]<<8));for(var a=(s>>3&1)+(s>>4&1);a>0;a-=!tt[o++]);return o+(2&s)},$t=function(tt){var s=tt.length;return(tt[s-4]|tt[s-3]<<8|tt[s-2]<<16|tt[s-1]<<24)>>>0},hr=function(tt){return 10+(tt.filename&&tt.filename.length+1||0)},Pr=function(tt,s){var o=s.level,a=o==0?0:o<6?1:o==9?3:2;tt[0]=120,tt[1]=a<<6|(a?32-2*a:1)},$r=function(tt){if((15&tt[0])!=8||tt[0]>>>4>7||(tt[0]<<8|tt[1])%31)throw"invalid zlib data";if(32&tt[1])throw"invalid zlib data: preset dictionaries not supported"};function An(tt,s){return s||typeof tt!="function"||(s=tt,tt={}),this.ondata=s,tt}var zn=function(){function tt(s,o){o||typeof s!="function"||(o=s,s={}),this.ondata=o,this.o=s||{}}return tt.prototype.p=function(s,o){this.ondata(cm(s,this.o,0,0,!o),o)},tt.prototype.push=function(s,o){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=o,this.p(s,o||!1)},tt}(),Ms=function(){return function(tt,s){G0([Gu,function(){return[hm,zn]}],this,An.call(this,tt,s),function(o){var a=new zn(o.data);onmessage=hm(a)},6)}}();function Us(tt,s,o){if(o||(o=s,s={}),typeof o!="function")throw"no callback";return V0(tt,s,[Gu],function(a){return pm(xs(a.data[0],a.data[1]))},0,o)}function xs(tt,s){return cm(tt,s||{},0,0)}var Fl=function(){function tt(s){this.s={},this.p=new Io(0),this.ondata=s}return tt.prototype.e=function(s){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var o=this.p.length,a=new Io(o+s.length);a.set(this.p),a.set(s,o),this.p=a},tt.prototype.c=function(s){this.d=this.s.i=s||!1;var o=this.s.b,a=Vp(this.p,this.o,this.s);this.ondata(Vu(a,o,this.s.b),this.d),this.o=Vu(a,this.s.b-32768),this.s.b=this.o.length,this.p=Vu(this.p,this.s.p/8|0),this.s.p&=7},tt.prototype.push=function(s,o){this.e(s),this.c(o)},tt}(),pu=function(){return function(tt){this.ondata=tt,G0([l_,function(){return[hm,Fl]}],this,0,function(){var s=new Fl;onmessage=hm(s)},7)}}();function fm(tt,s,o){if(o||(o=s,s={}),typeof o!="function")throw"no callback";return V0(tt,s,[l_],function(a){return pm(sp(a.data[0],El(a.data[1])))},1,o)}function sp(tt,s){return Vp(tt,s)}var Gp=function(){function tt(s,o){this.c=gp(),this.l=0,this.v=1,zn.call(this,s,o)}return tt.prototype.push=function(s,o){zn.prototype.push.call(this,s,o)},tt.prototype.p=function(s,o){this.c.p(s),this.l+=s.length;var a=cm(s,this.o,this.v&&hr(this.o),o&&8,!o);this.v&&(gt(a,this.o),this.v=0),o&&(Dt(a,a.length-8,this.c.d()),Dt(a,a.length-4,this.l)),this.ondata(a,o)},tt}(),Pm=function(){return function(tt,s){G0([Gu,Dx,function(){return[hm,zn,Gp]}],this,An.call(this,tt,s),function(o){var a=new Gp(o.data);onmessage=hm(a)},8)}}();function K_(tt,s,o){if(o||(o=s,s={}),typeof o!="function")throw"no callback";return V0(tt,s,[Gu,Dx,function(){return[u_]}],function(a){return pm(u_(a.data[0],a.data[1]))},2,o)}function u_(tt,s){s||(s={});var o=gp(),a=tt.length;o.p(tt);var _e=cm(tt,s,hr(s),8),rt=_e.length;return gt(_e,s),Dt(_e,rt-8,o.d()),Dt(_e,rt-4,a),_e}var Q0=function(){function tt(s){this.v=1,Fl.call(this,s)}return tt.prototype.push=function(s,o){if(Fl.prototype.e.call(this,s),this.v){var a=this.p.length>3?xt(this.p):4;if(a>=this.p.length&&!o)return;this.p=this.p.subarray(a),this.v=0}if(o){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}Fl.prototype.c.call(this,o)},tt}(),zy=function(){return function(tt){this.ondata=tt,G0([l_,Qu,function(){return[hm,Fl,Q0]}],this,0,function(){var s=new Q0;onmessage=hm(s)},9)}}();function Vy(tt,s,o){if(o||(o=s,s={}),typeof o!="function")throw"no callback";return V0(tt,s,[l_,Qu,function(){return[Gy]}],function(a){return pm(Gy(a.data[0]))},3,o)}function Gy(tt,s){return Vp(tt.subarray(xt(tt),-8),s||new Io($t(tt)))}var QA=function(){function tt(s,o){this.c=Im(),this.v=1,zn.call(this,s,o)}return tt.prototype.push=function(s,o){zn.prototype.push.call(this,s,o)},tt.prototype.p=function(s,o){this.c.p(s);var a=cm(s,this.o,this.v&&2,o&&4,!o);this.v&&(Pr(a,this.o),this.v=0),o&&Dt(a,a.length-4,this.c.d()),this.ondata(a,o)},tt}(),Bx=function(){return function(tt,s){G0([Gu,Jm,function(){return[hm,zn,QA]}],this,An.call(this,tt,s),function(o){var a=new QA(o.data);onmessage=hm(a)},10)}}();function kx(tt,s,o){if(o||(o=s,s={}),typeof o!="function")throw"no callback";return V0(tt,s,[Gu,Jm,function(){return[qw]}],function(a){return pm(qw(a.data[0],a.data[1]))},4,o)}function qw(tt,s){s||(s={});var o=Im();o.p(tt);var a=cm(tt,s,2,4);return Pr(a,s),Dt(a,a.length-4,o.d()),a}var Qy=function(){function tt(s){this.v=1,Fl.call(this,s)}return tt.prototype.push=function(s,o){if(Fl.prototype.e.call(this,s),this.v){if(this.p.length<2&&!o)return;this.p=this.p.subarray(2),this.v=0}if(o){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}Fl.prototype.c.call(this,o)},tt}(),Hu=function(){return function(tt){this.ondata=tt,G0([l_,au,function(){return[hm,Fl,Qy]}],this,0,function(){var s=new Qy;onmessage=hm(s)},11)}}();function Ww(tt,s,o){if(o||(o=s,s={}),typeof o!="function")throw"no callback";return V0(tt,s,[l_,au,function(){return[Zm]}],function(a){return pm(Zm(a.data[0],El(a.data[1])))},5,o)}function Zm(tt,s){return Vp(($r(tt),tt.subarray(2,-4)),s)}var H0=function(){function tt(s){this.G=Q0,this.I=Fl,this.Z=Qy,this.ondata=s}return tt.prototype.push=function(s,o){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(s,o);else{if(this.p&&this.p.length){var a=new Io(this.p.length+s.length);a.set(this.p),a.set(s,this.p.length)}else this.p=s;if(this.p.length>2){var _e=this,rt=function(){_e.ondata.apply(_e,arguments)};this.s=this.p[0]==31&&this.p[1]==139&&this.p[2]==8?new this.G(rt):(15&this.p[0])!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(rt):new this.Z(rt),this.s.push(this.p,o),this.p=null}}},tt}(),Bp=function(){function tt(s){this.G=zy,this.I=pu,this.Z=Hu,this.ondata=s}return tt.prototype.push=function(s,o){H0.prototype.push.call(this,s,o)},tt}();function VT(tt,s,o){if(o||(o=s,s={}),typeof o!="function")throw"no callback";return tt[0]==31&&tt[1]==139&&tt[2]==8?Vy(tt,s,o):(15&tt[0])!=8||tt[0]>>4>7||(tt[0]<<8|tt[1])%31?fm(tt,s,o):Ww(tt,s,o)}function Tv(tt,s){return tt[0]==31&&tt[1]==139&&tt[2]==8?Gy(tt,s):(15&tt[0])!=8||tt[0]>>4>7||(tt[0]<<8|tt[1])%31?sp(tt,s):Zm(tt,s)}var HA=function(tt,s,o,a){for(var _e in tt){var rt=tt[_e],nt=s+_e;rt instanceof Io?o[nt]=[rt,a]:Array.isArray(rt)?o[nt]=[rt[0],dm(a,rt[1])]:HA(rt,nt+"/",o,a)}},op=typeof TextEncoder<"u"&&new TextEncoder,q0=typeof TextDecoder<"u"&&new TextDecoder,$S=0;try{q0.decode(ao,{stream:!0}),$S=1}catch{}var qA=function(tt){for(var s="",o=0;;){var a=tt[o++],_e=(a>127)+(a>223)+(a>239);if(o+_e>tt.length)return[s,Vu(tt,o-1)];_e?_e==3?(a=((15&a)<<18|(63&tt[o++])<<12|(63&tt[o++])<<6|63&tt[o++])-65536,s+=String.fromCharCode(55296|a>>10,56320|1023&a)):s+=1&_e?String.fromCharCode((31&a)<<6|63&tt[o++]):String.fromCharCode((15&a)<<12|(63&tt[o++])<<6|63&tt[o++]):s+=String.fromCharCode(a)}},GT=function(){function tt(s){this.ondata=s,$S?this.t=new TextDecoder:this.p=ao}return tt.prototype.push=function(s,o){if(!this.ondata)throw"no callback";if(o=!!o,this.t){if(this.ondata(this.t.decode(s,{stream:!0}),o),o){if(this.t.decode().length)throw"invalid utf-8 data";this.t=null}}else{if(!this.p)throw"stream finished";var a=new Io(this.p.length+s.length);a.set(this.p),a.set(s,this.p.length);var _e=qA(a),rt=_e[0],nt=_e[1];if(o){if(nt.length)throw"invalid utf-8 data";this.p=null}else this.p=nt;this.ondata(rt,o)}},tt}(),jS=function(){function tt(s){this.ondata=s}return tt.prototype.push=function(s,o){if(!this.ondata)throw"no callback";if(this.d)throw"stream finished";this.ondata(W0(s),this.d=o||!1)},tt}();function W0(tt,s){if(s){for(var o=new Io(tt.length),a=0;a<tt.length;++a)o[a]=tt.charCodeAt(a);return o}if(op)return op.encode(tt);var _e=tt.length,rt=new Io(tt.length+(tt.length>>1)),nt=0,ot=function(ht){rt[nt++]=ht};for(a=0;a<_e;++a){if(nt+5>rt.length){var ct=new Io(nt+8+(_e-a<<1));ct.set(rt),rt=ct}var pt=tt.charCodeAt(a);pt<128||s?ot(pt):pt<2048?(ot(192|pt>>6),ot(128|63&pt)):pt>55295&&pt<57344?(ot(240|(pt=65536+(1047552&pt)|1023&tt.charCodeAt(++a))>>18),ot(128|pt>>12&63),ot(128|pt>>6&63),ot(128|63&pt)):(ot(224|pt>>12),ot(128|pt>>6&63),ot(128|63&pt))}return Vu(rt,0,nt)}function zS(tt,s){if(s){for(var o="",a=0;a<tt.length;a+=16384)o+=String.fromCharCode.apply(null,tt.subarray(a,a+16384));return o}if(q0)return q0.decode(tt);var _e=qA(tt),rt=_e[0];if(_e[1].length)throw"invalid utf-8 data";return rt}var X_=function(tt){return tt==1?3:tt<6?2:tt==9?1:0},Hy=function(tt,s){return s+30+vp(tt,s+26)+vp(tt,s+28)},Yw=function(tt,s,o){var a=vp(tt,s+28),_e=zS(tt.subarray(s+46,s+46+a),!(2048&vp(tt,s+8))),rt=s+46+a,nt=Xl(tt,s+20),ot=o&&nt==4294967295?Kw(tt,rt):[nt,Xl(tt,s+24),Xl(tt,s+42)],ct=ot[0],pt=ot[1],ht=ot[2];return[vp(tt,s+10),ct,pt,_e,rt+vp(tt,s+30)+vp(tt,s+32),ht]},Kw=function(tt,s){for(;vp(tt,s)!=1;s+=4+vp(tt,s+2));return[Hw(tt,s+12),Hw(tt,s+4),Hw(tt,s+20)]},J_=function(tt){var s=0;if(tt)for(var o in tt){var a=tt[o].length;if(a>65535)throw"extra field too long";s+=a+4}return s},WA=function(tt,s,o,a,_e,rt,nt,ot){var ct=a.length,pt=o.extra,ht=ot&&ot.length,_t=J_(pt);Dt(tt,s,nt!=null?33639248:67324752),s+=4,nt!=null&&(tt[s++]=20,tt[s++]=o.os),tt[s]=20,s+=2,tt[s++]=o.flag<<1|(rt==null&&8),tt[s++]=_e&&8,tt[s++]=255&o.compression,tt[s++]=o.compression>>8;var Et=new Date(o.mtime==null?Date.now():o.mtime),St=Et.getFullYear()-1980;if(St<0||St>119)throw"date not in range 1980-2099";if(Dt(tt,s,St<<25|Et.getMonth()+1<<21|Et.getDate()<<16|Et.getHours()<<11|Et.getMinutes()<<5|Et.getSeconds()>>>1),s+=4,rt!=null&&(Dt(tt,s,o.crc),Dt(tt,s+4,rt),Dt(tt,s+8,o.size)),Dt(tt,s+12,ct),Dt(tt,s+14,_t),s+=16,nt!=null&&(Dt(tt,s,ht),Dt(tt,s+6,o.attrs),Dt(tt,s+10,nt),s+=14),tt.set(a,s),s+=ct,_t)for(var Mt in pt){var It=pt[Mt],Nt=It.length;Dt(tt,s,+Mt),Dt(tt,s+2,Nt),tt.set(It,s+4),s+=4+Nt}return ht&&(tt.set(ot,s),s+=ht),s},Y0=function(tt,s,o,a,_e){Dt(tt,s,101010256),Dt(tt,s+8,o),Dt(tt,s+10,o),Dt(tt,s+12,a),Dt(tt,s+16,_e)},ho=function(){function tt(s){this.filename=s,this.c=gp(),this.size=0,this.compression=0}return tt.prototype.process=function(s,o){this.ondata(null,s,o)},tt.prototype.push=function(s,o){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(s),this.size+=s.length,o&&(this.crc=this.c.d()),this.process(s,o||!1)},tt}(),ls=function(){function tt(s,o){var a=this;o||(o={}),ho.call(this,s),this.d=new zn(o,function(_e,rt){a.ondata(null,_e,rt)}),this.compression=8,this.flag=X_(o.level)}return tt.prototype.process=function(s,o){try{this.d.push(s,o)}catch(a){this.ondata(a,null,o)}},tt.prototype.push=function(s,o){ho.prototype.push.call(this,s,o)},tt}(),mm=function(){function tt(s,o){var a=this;o||(o={}),ho.call(this,s),this.d=new Ms(o,function(_e,rt,nt){a.ondata(_e,rt,nt)}),this.compression=8,this.flag=X_(o.level),this.terminate=this.d.terminate}return tt.prototype.process=function(s,o){this.d.push(s,o)},tt.prototype.push=function(s,o){ho.prototype.push.call(this,s,o)},tt}(),mP=function(){function tt(s){this.ondata=s,this.u=[],this.d=1}return tt.prototype.add=function(s){var o=this;if(2&this.d)throw"stream finished";var a=W0(s.filename),_e=a.length,rt=s.comment,nt=rt&&W0(rt),ot=_e!=s.filename.length||nt&&rt.length!=nt.length,ct=_e+J_(s.extra)+30;if(_e>65535)throw"filename too long";var pt=new Io(ct);WA(pt,0,s,a,ot);var ht=[pt],_t=function(){for(var Nt=0,Bt=ht;Nt<Bt.length;Nt++){var kt=Bt[Nt];o.ondata(null,kt,!1)}ht=[]},Et=this.d;this.d=0;var St=this.u.length,Mt=dm(s,{f:a,u:ot,o:nt,t:function(){s.terminate&&s.terminate()},r:function(){if(_t(),Et){var Nt=o.u[St+1];Nt?Nt.r():o.d=1}Et=1}}),It=0;s.ondata=function(Nt,Bt,kt){if(Nt)o.ondata(Nt,Bt,kt),o.terminate();else if(It+=Bt.length,ht.push(Bt),kt){var Pt=new Io(16);Dt(Pt,0,134695760),Dt(Pt,4,s.crc),Dt(Pt,8,It),Dt(Pt,12,s.size),ht.push(Pt),Mt.c=It,Mt.b=ct+It+16,Mt.crc=s.crc,Mt.size=s.size,Et&&Mt.r(),Et=1}else Et&&_t()},this.u.push(Mt)},tt.prototype.end=function(){var s=this;if(2&this.d)throw 1&this.d?"stream finishing":"stream finished";this.d?this.e():this.u.push({r:function(){1&s.d&&(s.u.splice(-1,1),s.e())},t:function(){}}),this.d=3},tt.prototype.e=function(){for(var s=0,o=0,a=0,_e=0,rt=this.u;_e<rt.length;_e++)a+=46+(pt=rt[_e]).f.length+J_(pt.extra)+(pt.o?pt.o.length:0);for(var nt=new Io(a+22),ot=0,ct=this.u;ot<ct.length;ot++){var pt=ct[ot];WA(nt,s,pt,pt.f,pt.u,pt.c,o,pt.o),s+=46+pt.f.length+J_(pt.extra)+(pt.o?pt.o.length:0),o+=pt.b}Y0(nt,s,this.u.length,a,o),this.ondata(null,nt,!0),this.d=2},tt.prototype.terminate=function(){for(var s=0,o=this.u;s<o.length;s++)o[s].t();this.d=2},tt}();function gP(tt,s,o){if(o||(o=s,s={}),typeof o!="function")throw"no callback";var a={};HA(tt,"",a,s);var _e=Object.keys(a),rt=_e.length,nt=0,ot=0,ct=rt,pt=new Array(rt),ht=[],_t=function(){for(var It=0;It<ht.length;++It)ht[It]()},Et=function(){var It=new Io(ot+22),Nt=nt,Bt=ot-nt;ot=0;for(var kt=0;kt<ct;++kt){var Pt=pt[kt];try{var qt=Pt.c.length;WA(It,ot,Pt,Pt.f,Pt.u,qt);var Kt=30+Pt.f.length+J_(Pt.extra),nr=ot+Kt;It.set(Pt.c,nr),WA(It,nt,Pt,Pt.f,Pt.u,qt,ot,Pt.m),nt+=16+Kt+(Pt.m?Pt.m.length:0),ot=nr+qt}catch(ir){return o(ir,null)}}Y0(It,nt,pt.length,Bt,Nt),o(null,It)};rt||Et();for(var St=function(It){var Nt=_e[It],Bt=a[Nt],kt=Bt[0],Pt=Bt[1],qt=gp(),Kt=kt.length;qt.p(kt);var nr=W0(Nt),ir=nr.length,fr=Pt.comment,br=fr&&W0(fr),Tr=br&&br.length,Dr=J_(Pt.extra),Rr=Pt.level==0?0:8,Nr=function(Ir,kr){if(Ir)_t(),o(Ir,null);else{var Hr=kr.length;pt[It]=dm(Pt,{size:Kt,crc:qt.d(),c:kr,f:nr,m:br,u:ir!=Nt.length||br&&fr.length!=Tr,compression:Rr}),nt+=30+ir+Dr+Hr,ot+=76+2*(ir+Dr)+(Tr||0)+Hr,--rt||Et()}};if(ir>65535&&Nr("filename too long",null),Rr)if(Kt<16e4)try{Nr(null,xs(kt,Pt))}catch(Ir){Nr(Ir,null)}else ht.push(Us(kt,Pt,Nr));else Nr(null,kt)},Mt=0;Mt<ct;++Mt)St(Mt);return _t}function QT(tt,s){s||(s={});var o={},a=[];HA(tt,"",o,s);var _e=0,rt=0;for(var nt in o){var ot=o[nt],ct=ot[0],pt=ot[1],ht=pt.level==0?0:8,_t=(ir=W0(nt)).length,Et=pt.comment,St=Et&&W0(Et),Mt=St&&St.length,It=J_(pt.extra);if(_t>65535)throw"filename too long";var Nt=ht?xs(ct,pt):ct,Bt=Nt.length,kt=gp();kt.p(ct),a.push(dm(pt,{size:ct.length,crc:kt.d(),c:Nt,f:ir,m:St,u:_t!=nt.length||St&&Et.length!=Mt,o:_e,compression:ht})),_e+=30+_t+It+Bt,rt+=76+2*(_t+It)+(Mt||0)+Bt}for(var Pt=new Io(rt+22),qt=_e,Kt=rt-_e,nr=0;nr<a.length;++nr){var ir=a[nr];WA(Pt,ir.o,ir,ir.f,ir.u,ir.c.length);var fr=30+ir.f.length+J_(ir.extra);Pt.set(ir.c,ir.o+fr),WA(Pt,_e,ir,ir.f,ir.u,ir.c.length,ir.o,ir.m),_e+=16+fr+(ir.m?ir.m.length:0)}return Y0(Pt,_e,a.length,Kt,qt),Pt}var HT=function(){function tt(){}return tt.prototype.push=function(s,o){this.ondata(null,s,o)},tt.compression=0,tt}(),vP=function(){function tt(){var s=this;this.i=new Fl(function(o,a){s.ondata(null,o,a)})}return tt.prototype.push=function(s,o){try{this.i.push(s,o)}catch(a){this.ondata(a,s,o)}},tt.compression=8,tt}(),_P=function(){function tt(s,o){var a=this;o<32e4?this.i=new Fl(function(_e,rt){a.ondata(null,_e,rt)}):(this.i=new pu(function(_e,rt,nt){a.ondata(_e,rt,nt)}),this.terminate=this.i.terminate)}return tt.prototype.push=function(s,o){this.i.terminate&&(s=Vu(s,0)),this.i.push(s,o)},tt.compression=8,tt}(),Ox=function(){function tt(s){this.onfile=s,this.k=[],this.o={0:HT},this.p=ao}return tt.prototype.push=function(s,o){var a=this;if(!this.onfile)throw"no callback";if(!this.p)throw"stream finished";if(this.c>0){var _e=Math.min(this.c,s.length),rt=s.subarray(0,_e);if(this.c-=_e,this.d?this.d.push(rt,!this.c):this.k[0].push(rt),(s=s.subarray(_e)).length)return this.push(s,o)}else{var nt=0,ot=0,ct=void 0,pt=void 0;this.p.length?s.length?((pt=new Io(this.p.length+s.length)).set(this.p),pt.set(s,this.p.length)):pt=this.p:pt=s;for(var ht=pt.length,_t=this.c,Et=_t&&this.d,St=function(){var Nt,Bt=Xl(pt,ot);if(Bt==67324752){nt=1,ct=ot,Mt.d=null,Mt.c=0;var kt=vp(pt,ot+6),Pt=vp(pt,ot+8),qt=2048&kt,Kt=8&kt,nr=vp(pt,ot+26),ir=vp(pt,ot+28);if(ht>ot+30+nr+ir){var fr=[];Mt.k.unshift(fr),nt=2;var br,Tr=Xl(pt,ot+18),Dr=Xl(pt,ot+22),Rr=zS(pt.subarray(ot+30,ot+=30+nr),!qt);Tr==4294967295?(Nt=Kt?[-2]:Kw(pt,ot),Tr=Nt[0],Dr=Nt[1]):Kt&&(Tr=-1),ot+=ir,Mt.c=Tr;var Nr={name:Rr,compression:Pt,start:function(){if(!Nr.ondata)throw"no callback";if(Tr){var Ir=a.o[Pt];if(!Ir)throw"unknown compression type "+Pt;(br=Tr<0?new Ir(Rr):new Ir(Rr,Tr,Dr)).ondata=function(en,vn,wn){Nr.ondata(en,vn,wn)};for(var kr=0,Hr=fr;kr<Hr.length;kr++){var Lr=Hr[kr];br.push(Lr,!1)}a.k[0]==fr&&a.c?a.d=br:br.push(ao,!0)}else Nr.ondata(null,ao,!0)},terminate:function(){br&&br.terminate&&br.terminate()}};Tr>=0&&(Nr.size=Tr,Nr.originalSize=Dr),Mt.onfile(Nr)}return"break"}if(_t){if(Bt==134695760)return ct=ot+=12+(_t==-2&&8),nt=3,Mt.c=0,"break";if(Bt==33639248)return ct=ot-=4,nt=3,Mt.c=0,"break"}},Mt=this;ot<ht-4&&St()!=="break";++ot);if(this.p=ao,_t<0){var It=nt?pt.subarray(0,ct-12-(_t==-2&&8)-(Xl(pt,ct-16)==134695760&&4)):pt.subarray(0,ot);Et?Et.push(It,!!nt):this.k[+(nt==2)].push(It)}if(2&nt)return this.push(pt.subarray(ot),o);this.p=pt.subarray(ot)}if(o){if(this.c)throw"invalid zip file";this.p=null}},tt.prototype.register=function(s){this.o[s.compression]=s},tt}();function qT(tt,s){if(typeof s!="function")throw"no callback";for(var o=[],a=function(){for(var Et=0;Et<o.length;++Et)o[Et]()},_e={},rt=tt.length-22;Xl(tt,rt)!=101010256;--rt)if(!rt||tt.length-rt>65558)return void s("invalid zip file",null);var nt=vp(tt,rt+8);nt||s(null,{});var ot=nt,ct=Xl(tt,rt+16),pt=ct==4294967295;if(pt){if(rt=Xl(tt,rt-12),Xl(tt,rt)!=101075792)return void s("invalid zip file",null);ot=nt=Xl(tt,rt+32),ct=Xl(tt,rt+48)}for(var ht=function(Et){var St=Yw(tt,ct,pt),Mt=St[0],It=St[1],Nt=St[2],Bt=St[3],kt=St[4],Pt=St[5],qt=Hy(tt,Pt);ct=kt;var Kt=function(ir,fr){ir?(a(),s(ir,null)):(_e[Bt]=fr,--nt||s(null,_e))};if(Mt)if(Mt==8){var nr=tt.subarray(qt,qt+It);if(It<32e4)try{Kt(null,sp(nr,new Io(Nt)))}catch(ir){Kt(ir,null)}else o.push(fm(nr,{size:Nt},Kt))}else Kt("unknown compression type "+Mt,null);else Kt(null,Vu(tt,qt,qt+It))},_t=0;_t<ot;++_t)ht();return a}function Lx(tt){for(var s={},o=tt.length-22;Xl(tt,o)!=101010256;--o)if(!o||tt.length-o>65558)throw"invalid zip file";var a=vp(tt,o+8);if(!a)return{};var _e=Xl(tt,o+16),rt=_e==4294967295;if(rt){if(o=Xl(tt,o-12),Xl(tt,o)!=101075792)throw"invalid zip file";a=Xl(tt,o+32),_e=Xl(tt,o+48)}for(var nt=0;nt<a;++nt){var ot=Yw(tt,_e,rt),ct=ot[0],pt=ot[1],ht=ot[2],_t=ot[3],Et=ot[4],St=ot[5],Mt=Hy(tt,St);if(_e=Et,ct){if(ct!=8)throw"unknown compression type "+ct;s[_t]=sp(tt.subarray(Mt,Mt+pt),new Io(ht))}else s[_t]=Vu(tt,Mt,Mt+pt)}return s}class Nx extends et.hH6{load(s,o,a,_e){return this.setResponseType("arraybuffer"),super.load(s,rt=>{const nt=Lx(new Uint8Array(rt)),ot=new Map(Object.entries(nt).map(([ct,pt])=>[ct,new File([pt],ct)]));o==null||o(ot)},a,_e)}}function Fx(){mo.Importers.push(new Yl(Nx,["zip"],!0))}class c_ extends et.Ox3{constructor(s,o){super(),this.assetType="light",this.isDirectionalLight2=!0,this.color=new et.Ilk(s),this.intensity=o||1,this.target.position.set(0,0,-1),this.add(this.target)}get lightObject(){return this}get modelObject(){return this}copy(s,o){const a=this.target,_e=s.userData;return s.userData={},super.copy(s,o),po(this.userData,_e),a.position.copy(this.target.position),a.updateMatrixWorld(),this.target=a,this}get uiConfig(){return this._uiConfig?this._uiConfig:this._uiConfig={type:"folder",label:"Directional Light",children:[{type:"checkbox",label:"Enabled",property:[this,"visible"]},{type:"color",label:"Color",property:[this,"color"]},{type:"slider",label:"Intensity",bounds:[0,20],property:[this,"intensity"]},{type:"vec3",label:"Rotation",property:[this,"rotation"]},{type:"vec3",label:"Position",property:[this,"position"]},{type:"checkbox",label:"Shadow Enabled",property:[this,"castShadow"]},{type:"vec2",label:"Shadow Map Size",property:[this==null?void 0:this.shadow,"mapSize"],onChange:()=>{var s,o;(s=this.shadow.map)===null||s===void 0||s.dispose(),(o=this.shadow.mapPass)===null||o===void 0||o.dispose(),this.shadow.map=null,this.shadow.mapPass=null}},{type:"slider",bounds:[-.001,.001],stepSize:2e-5,label:"Shadow Bias",property:[this==null?void 0:this.shadow,"bias"],onChange:this.setDirty},{type:"slider",bounds:[-.1,.1],stepSize:.005,label:"Shadow Normal Bias",property:[this==null?void 0:this.shadow,"normalBias"],onChange:this.setDirty},{type:"slider",bounds:[0,5],label:"Shadow radius",property:[this==null?void 0:this.shadow,"radius"],onChange:this.setDirty},{type:"slider",bounds:[.1,50],label:"Shadow frustum",getValue:()=>2*this.shadow.camera.right,setValue:s=>{this.shadow.camera.left=-s/2,this.shadow.camera.right=s/2,this.shadow.camera.top=s/2,this.shadow.camera.bottom=-s/2},onChange:this.setDirty}]}}toJSON(s){const{userData:o,children:a}=this;this.userData={},this.children=[];const _e=super.toJSON(s);return _e.userData=rs(po({},o),!1),this.userData={},this.children=a,_e.type="DirectionalLight2",_e.target=this.target.position.toArray(),Object.assign(_e,rs(this,!0,s))}fromJSON(s,o){if(s.type!=="DirectionalLight2")return null;const a=s.target,_e=s.object;return s.target&&(this.target.position.fromArray(s.target),this.target.updateMatrixWorld(),delete s.target),s.object&&delete s.object,In(s,this,!0,o),a&&(s.target=a),_e&&(_e.color!==void 0&&this.color.set(_e.color),_e.intensity!==void 0&&(this.intensity=_e.intensity),s.object=_e),this}}class qy extends et.PMe{constructor(s,o,a,_e,rt,nt){super(s,o,a,_e,rt,nt),this.assetType="light",this.target.position.set(0,0,-1),this.add(this.target)}get lightObject(){return this}get modelObject(){return this}copy(s,o){const a=this.target,_e=s.userData;return s.userData={},super.copy(s,o),po(this.userData,_e),a.position.copy(this.target.position),a.updateMatrixWorld(),this.target=a,this}get uiConfig(){return this._uiConfig?this._uiConfig:this._uiConfig={type:"folder",label:"Spot Light",children:[{type:"checkbox",label:"Enabled",property:[this,"visible"]},{type:"color",label:"Color",property:[this,"color"]},{type:"slider",label:"Intensity",bounds:[0,30],property:[this,"intensity"]},{type:"slider",bounds:[0,2],property:[this,"angle"]},{type:"slider",bounds:[0,.9999],property:[this,"penumbra"]},{type:"vec3",label:"Rotation",property:[this,"rotation"]},{type:"vec3",label:"Position",property:[this,"position"]},{type:"checkbox",label:"Shadow Enabled",property:[this,"castShadow"]},{type:"vec2",label:"Shadow Map Size",property:[this==null?void 0:this.shadow,"mapSize"],onChange:()=>{var s,o;(s=this.shadow.map)===null||s===void 0||s.dispose(),(o=this.shadow.mapPass)===null||o===void 0||o.dispose(),this.shadow.map=null,this.shadow.mapPass=null}},{type:"slider",bounds:[-.001,.001],stepSize:2e-5,label:"Shadow Bias",property:[this==null?void 0:this.shadow,"bias"],onChange:this.setDirty},{type:"slider",bounds:[0,5],label:"Shadow radius",property:[this==null?void 0:this.shadow,"radius"],onChange:this.setDirty}]}}toJSON(s){const{userData:o,children:a}=this;this.userData={},this.children=[];const _e=super.toJSON(s);return _e.userData=rs(po({},o),!1),this.userData={},this.children=a,_e.type="SpotLight2",_e.target=this.target.position.toArray(),Object.assign(_e,rs(this,!0,s))}fromJSON(s,o){return s.type!=="SpotLight2"?null:(s.target&&(this.target.position.fromArray(s.target),this.target.updateMatrixWorld()),s.object?(s.object.color!==void 0&&this.color.set(s.object.color),s.object.intensity!==void 0&&(this.intensity=s.object.intensity),s.object.distance!==void 0&&(this.distance=s.object.distance),s.object.angle!==void 0&&(this.angle=s.object.angle),s.object.decay!==void 0&&(this.decay=s.object.decay),s.object.penumbra!==void 0&&(this.penumbra=s.object.penumbra),In(s,this,!0,o),this):this)}}class VS extends et.cek{constructor(s,o,a,_e){super(s,o,a,_e),this.assetType="light"}get lightObject(){return this}get modelObject(){return this}copy(s,o){const a=s.userData;return s.userData={},super.copy(s,o),po(this.userData,a),this}get uiConfig(){return this._uiConfig?this._uiConfig:this._uiConfig={type:"folder",label:"Point Light",children:[{type:"checkbox",label:"Enabled",property:[this,"visible"]},{type:"color",label:"Color",property:[this,"color"]},{type:"slider",label:"Intensity",bounds:[0,30],property:[this,"intensity"]},{type:"input",label:"Distance",property:[this,"distance"]},{type:"input",property:[this,"decay"]},{type:"vec3",label:"Position",property:[this,"position"]},{type:"checkbox",label:"Shadow Enabled",property:[this,"castShadow"]},{type:"vec2",label:"Shadow Map Size",property:[this==null?void 0:this.shadow,"mapSize"],onChange:()=>{var s,o;(s=this.shadow.map)===null||s===void 0||s.dispose(),(o=this.shadow.mapPass)===null||o===void 0||o.dispose(),this.shadow.map=null,this.shadow.mapPass=null}},{type:"slider",bounds:[-.001,.001],stepSize:2e-5,label:"Shadow Bias",property:[this==null?void 0:this.shadow,"bias"],onChange:this.setDirty},{type:"slider",bounds:[0,5],label:"Shadow radius",property:[this==null?void 0:this.shadow,"radius"],onChange:this.setDirty}]}}toJSON(s){const{userData:o}=this;this.userData={};const a=super.toJSON(s);return a.userData=rs(po({},o),!1),this.userData={},a.type="PointLight2",Object.assign(a,rs(this,!0,s))}fromJSON(s,o){return s.type!=="PointLight2"?null:s.object?(s.object.color!==void 0&&this.color.set(s.object.color),s.object.intensity!==void 0&&(this.intensity=s.object.intensity),s.object.distance!==void 0&&(this.distance=s.object.distance),s.object.decay!==void 0&&(this.decay=s.object.decay),In(s,this,!0,o),this):this}}class Ux extends et.Mig{constructor(s,o){super(s,o),this.assetType="light"}get lightObject(){return this}get modelObject(){return this}copy(s,o){const a=s.userData;return s.userData={},super.copy(s,o),po(this.userData,a),this}get uiConfig(){return this._uiConfig?this._uiConfig:this._uiConfig={type:"folder",label:"Ambient Light",children:[{type:"checkbox",label:"Enabled",property:[this,"visible"]},{type:"color",label:"Color",property:[this,"color"]},{type:"slider",label:"Intensity",bounds:[0,20],property:[this,"intensity"]}]}}toJSON(s){const{userData:o}=this;this.userData={};const a=super.toJSON(s);return a.userData=rs(po({},o),!1),this.userData={},a.type="AmbientLight2",Object.assign(a,rs(this,!0,s))}fromJSON(s,o){return s.type!=="AmbientLight2"?null:s.object?(s.object.color!==void 0&&this.color.set(s.object.color),s.object.intensity!==void 0&&(this.intensity=s.object.intensity),In(s,this,!0,o),this):this}}class WT extends et.aNw{load(s,o,a,_e){const rt=new et.hH6(this.manager);rt.setPath(this.path),rt.setResponseType("text"),rt.load(s,nt=>{try{o(this.parse(nt))}catch(ot){_e?_e(ot):console.error(ot),this.manager.itemError(s)}},a,_e)}parse(s){s=s.replace(/^#.*?(\n|\r)/gm,"").replace(/^\s*?(\n|\r)/gm,"").trim();let o=null,a=null;const _e=new et.Pa4(0,0,0),rt=new et.Pa4(1,1,1),nt=s.split(/[\n\r]+/g);let ot=null,ct=0;for(let _t=0,Et=nt.length;_t<Et;_t++){const St=nt[_t].trim(),Mt=St.split(/\s/g);switch(Mt[0]){case"TITLE":o=St.substring(7,St.length-1);break;case"LUT_3D_SIZE":const It=Mt[1];a=parseFloat(It),ot=new Uint8Array(a*a*a*4);break;case"DOMAIN_MIN":_e.x=parseFloat(Mt[1]),_e.y=parseFloat(Mt[2]),_e.z=parseFloat(Mt[3]);break;case"DOMAIN_MAX":rt.x=parseFloat(Mt[1]),rt.y=parseFloat(Mt[2]),rt.z=parseFloat(Mt[3]);break;default:const Nt=parseFloat(Mt[0]),Bt=parseFloat(Mt[1]),kt=parseFloat(Mt[2]);if(Nt>1||Nt<0||Bt>1||Bt<0||kt>1||kt<0)throw new Error("LUTCubeLoader : Non normalized values not supported.");ot[ct+0]=255*Nt,ot[ct+1]=255*Bt,ot[ct+2]=255*kt,ot[ct+3]=255,ct+=4}}const pt=new et.IEO;pt.image.data=ot,pt.image.width=a,pt.image.height=a*a,pt.type=et.ywz,pt.magFilter=et.wem,pt.minFilter=et.wem,pt.wrapS=et.uWy,pt.wrapT=et.uWy,pt.generateMipmaps=!1,pt.needsUpdate=!0;const ht=new et.JUT;return ht.image.data=ot,ht.image.width=a,ht.image.height=a,ht.image.depth=a,ht.type=et.ywz,ht.magFilter=et.wem,ht.minFilter=et.wem,ht.wrapS=et.uWy,ht.wrapT=et.uWy,ht.wrapR=et.uWy,ht.generateMipmaps=!1,ht.needsUpdate=!0,{title:o,size:a,domainMin:_e,domainMax:rt,texture:pt,texture3D:ht}}}class mo extends it{constructor(s,o=!1){super(),this._processors=new B0,this._logger=console.log,this._loaderCache=[],this._fileDatabase=new Map,this._cachedAssets=[],o||(this._logger=()=>{}),this._viewer=s,this._onLoad=this._onLoad.bind(this),this._onProgress=this._onProgress.bind(this),this._onError=this._onError.bind(this),this._onStart=this._onStart.bind(this),this._urlModifier=this._urlModifier.bind(this),this._loadingManager=new et.lLk(this._onLoad,this._onProgress,this._onError),this._loadingManager.onStart=this._onStart,this._loadingManager.setURLModifier(this._urlModifier),Fx(),Rx(s.renderer.rendererObject),zu(s),i_()}get processors(){return this._processors}get loadingManager(){return this._loadingManager}_onLoad(){this.dispatchEvent({type:"onLoad"})}_onProgress(s,o,a){this.dispatchEvent({type:"onProgress",url:s,loaded:o,total:a})}_onError(s){this.dispatchEvent({type:"onError",url:s})}_onStart(s,o,a){this.dispatchEvent({type:"onStart",url:s,loaded:o,total:a})}_urlModifier(s){var o;let a=decodeURI(s);const _e=(o=this._rootContext)===null||o===void 0?void 0:o.rootUrl;a.includes("://")||!_e||a.startsWith(_e)||(a=_e+a),a=a.replace("./",""),a=a.replace(/^(\/\/)/,"/"),a=a.replace(/\?.*$/,"");const rt=this._fileDatabase.get(a);return rt?rt.ext?(rt.objectUrl||(rt.objectUrl=URL.createObjectURL(rt)+"#"+a),rt.objectUrl):(console.error("Unable to determine file extension",rt),s):s}_createLoader(s){const o=this._getImporter(s),a=o==null?void 0:o.ctor(this);return a&&(o==null||o.ext.forEach(_e=>{const rt=new RegExp(_e.startsWith("data:")?"^"+_e+"\\/":"\\."+_e+"$","i");this._loadingManager.addHandler(rt,a)})),a&&(this._loaderCache.push({loader:a,files:[]}),this.dispatchEvent({type:"loaderCreate",loader:a})),a}async importFiles(s,o={}){const a=new Map;let{allowedExtensions:_e}=o;if(_e&&_e.length<1&&(_e=void 0),s.size===0)return a;this.dispatchEvent({type:"importFiles",files:Object.keys(s),state:"start"});const rt=[],nt=[];if(s.forEach((ot,ct)=>{var pt;this.registerFile(ct,ot);const ht=ot.ext;ht&&((pt=_e==null?void 0:_e.includes(ht.toLowerCase()))===null||pt===void 0||pt)&&(this._isRootFileExtension(ht)?rt.push(ct):nt.push(ct))}),rt.length>0)for(const ot of rt){let ct=await this._importFile(ot,void 0,o);ct&&(ct=await this.processImported(ct,o)),a.set(ot,ct)}else for(const ot of nt){let ct=await this._importFile(ot,void 0,o);ct&&(ct=await this.processImported(ct,o)),a.set(ot,ct)}return this.dispatchEvent({type:"importFiles",files:Object.keys(s),state:"end"}),s.forEach((ot,ct)=>{this.unregisterFile(ct)}),a}registerFile(s,o){var a,_e,rt;s=s.replace(/\?.*$/,"");const nt=(a=o==null?void 0:o.ext)!==null&&a!==void 0?a:(rt=MA((_e=o==null?void 0:o.name)!==null&&_e!==void 0?_e:s))===null||rt===void 0?void 0:rt.toLowerCase();o&&(o.ext||(o.ext=nt),this._fileDatabase.set(s,o));let ot=this._getLoader(s);if(ot||(ot=this._createLoader(o??{name:s,ext:nt})),ot){for(const ct of this._loaderCache)if(ct.loader===ot){ct.files.push(s);break}}return ot}unregisterFile(s){s=s.replace(/\?.*$/,"");const o=this._fileDatabase.get(s);o!=null&&o.objectUrl&&(URL.revokeObjectURL(o.objectUrl),o.objectUrl=void 0),o&&this._fileDatabase.delete(s)}_isRootFileExtension(s){return mo.Importers.find(o=>o.root&&o.ext.includes(s.toLowerCase()))!=null}resolveURL(s){return this._loadingManager.resolveURL(s)}async _importFile(s,o,a={},_e){var rt,nt;if(!((rt=o)===null||rt===void 0)&&rt.__imported)return o.__imported;let ot;this.dispatchEvent({type:"importFile",path:s,state:"downloading",progress:0});try{this.registerFile(s,o),a.rootPath=s;const ct=this.resolveURL(s),pt=s.replace(/\?.*$/,""),ht=(nt=a.fileHandler)!==null&&nt!==void 0?nt:await this._loadingManager.getHandler(pt)||(o?await this._loadingManager.getHandler(o.name||o.ext||""):void 0);if(!ht)throw new Error("AssetImporter: Unable to find loader for "+s);this._rootContext={path:s,url:ct,rootUrl:et.Zp0.extractUrlBase(s),baseUrl:et.Zp0.extractUrlBase(ct)},ot=await ht.loadAsync(s+(a.queryString?(s.includes("?")?"&":"?")+a.queryString:""),_t=>{_e&&_e(_t),this.dispatchEvent({type:"importFile",path:s,state:"downloading",progress:_t.loaded/_t.total})}),this._rootContext=void 0,this.dispatchEvent({type:"importFile",path:s,state:"downloading",progress:1}),this.dispatchEvent({type:"importFile",path:s,state:"adding"}),o?this._logger("AssetImporter: loaded",s):this._logger("AssetImporter: downloaded",s),o&&this.unregisterFile(s)}catch(ct){return console.error("AssetImporter: Unable to import file",s,o),console.error(ct),console.error(ct==null?void 0:ct.stack),this.dispatchEvent({type:"importFile",path:s,state:"error",error:ct}),[]}return this.dispatchEvent({type:"importFile",path:s,state:"done"}),o&&(o.__imported=ot),ot}_getImporter(s,o=!1){return mo.Importers.find(a=>{if(o&&!a.root)return!1;const _e=a.ext.find(rt=>{var nt,ot,ct;return s.ext&&rt===s.ext.toLowerCase()||((ot=(nt=s.name)===null||nt===void 0?void 0:nt.toLowerCase())===null||ot===void 0?void 0:ot.endsWith("."+rt.toLowerCase()))||(rt==null?void 0:rt.startsWith("data:"))&&((ct=s.name)===null||ct===void 0?void 0:ct.startsWith(rt))});return!!_e&&(s.ext=_e,!0)})}_getLoader(s){var o;return(o=this._loadingManager.getHandler(s))!==null&&o!==void 0?o:void 0}async importAsset(s,o={},a){var _e;if(!s)return[];if(!this._cachedAssets.includes(s)){if(Object.entries(s).length===1&&s.path){const ot=this._cachedAssets.find(ct=>ct.path===s.path);ot&&Object.assign(s,ot)}const nt=this._cachedAssets.findIndex(ot=>ot.path===s.path);nt>=0&&this._cachedAssets.splice(nt,1),this._cachedAssets.push(s)}let rt;if(s!=null&&s.preImported&&(rt=await s.preImported),!o.forceImport&&rt){const nt=await this.processImported(rt,o);let ot=!1;for(const ct of nt)if(ct.__disposed){ot=!0;break}if(!ot||o.reimportDisposed===!1)return nt}return s.preImported=this._importFile(o.pathOverride||s.path,typeof((_e=s.file)===null||_e===void 0?void 0:_e.arrayBuffer)=="function"?s.file:void 0,o,a),rt=await s.preImported,rt&&(rt=await this.processImported(rt,o)),rt}async importSingle(s,o={}){var a;return(a=await this.importAsset(s,o))===null||a===void 0?void 0:a[0]}async importSinglePath(s,o){var a;return(a=await this.importPath(s,o))===null||a===void 0?void 0:a[0]}async importPath(s,o={}){const a={...o};delete a.pathOverride,delete a.forceImport,delete a.reimportDisposed;const _e=JSON.stringify(a);let rt;return rt=this._cachedAssets.find(nt=>nt.path===s&&nt._options===_e)||{path:s},rt._options=_e,await this.importAsset(rt,o)}async processImportedSingle(s,o={}){return(await this.processImported(s,o))[0]}async processImported(s,o={}){var a,_e,rt,nt,ot,ct,pt,ht;let _t=s;if(!_t)return[];if(o.processImported===!1)return[_t];if(Array.isArray(_t)){const Et=[];for(const St of _t)Et.push(...await this.processImported(St,o));return Et}if(!((a=_t.userData)===null||a===void 0)&&a.rootSceneModelRoot){if(o._rootSceneImported=!0,_t.__processedChildren&&!o.forceImporterReprocess)return _t.__processedChildren;if(!(_t.children.length<1))return _t.animations&&(_t.children[0].animations||(_t.children[0].animations=[]),_t.children[0].animations.push(..._t.animations)),_t.__importedViewerConfig&&(_t.children[0].__importedViewerConfig=_t.__importedViewerConfig),_t.__processedChildren=await this.processImported([..._t.children],o),_t.__processedChildren;if(((_e=_t.animations)===null||_e===void 0?void 0:_e.length)>0&&console.error("AssetImporter: animations in empty scene not supported yet. animations will be ignored",_t.animations),!_t.__importedViewerConfig)return[];_t=_t.__importedViewerConfig}if(!((rt=_t.userData)===null||rt===void 0)&&rt.iModel&&(_t=_t.userData.iModel),!((nt=_t.userData)===null||nt===void 0)&&nt.iMaterial&&(_t=_t.userData.iMaterial),_t.assetImporterProcessed&&!o.forceImporterReprocess)return[_t];if(!_t.assetType){if(_t.isBufferGeometry&&(_t=new et.Kj0(_t,new et.Wid)),_t.isObject3D){if(_t.isLight)_t=GS(_t);else{const Et=[];_t.traverse(St=>{St!==_t&&St.isLight&&Et.push(St)});for(const St of Et)GS(St);_t=new yv(_t,o)}!o.rootPath||_t.modelObject.userData.rootPath||o.rootPath.startsWith("blob:")||o.rootPath.startsWith("/")||(_t.modelObject.userData.rootPath=o.rootPath)}_t.isTexture&&(_t.assetType="texture",o._testDataTextureComplete&&(_t.isDataTexture&&(!((ot=_t.image)===null||ot===void 0)&&ot.data)&&(_t.image.complete=!0),!((ct=_t.image)===null||ct===void 0)&&ct.complete&&(_t.needsUpdate=!0)),o.generateMipmaps!==void 0&&(_t.generateMipmaps=o.generateMipmaps),_t.generateMipmaps||_t.isRenderTargetTexture||(_t.minFilter=_t.minFilter===et.D1R?et.wem:_t.minFilter,_t.magFilter=_t.magFilter===et.D1R?et.wem:_t.magFilter),!o.rootPath||_t.userData.rootPath||o.rootPath.startsWith("blob:")||o.rootPath.startsWith("/")||(_t.userData.rootPath=o.rootPath)),_t.isMaterial&&(_t.assetType="material",!o.rootPath||_t.userData.rootPath||o.rootPath.startsWith("blob:")||o.rootPath.startsWith("/")||(_t.userData.rootPath=o.rootPath))}if(_t.assetType!=null)return _t=await this._processors.process(_t.assetType,_t,{}),_t.assetImporterProcessed=!0,[_t];if(_t instanceof Map)return[...(await this.importFiles(_t,o)).values()].flat();if(_t.type){const Et=this._viewer.getPluginByType(_t.type);if(Et){let St=_t._importedResources||{};return _t.resources&&(St=await((pt=this._viewer.getManager())===null||pt===void 0?void 0:pt.importConfigResources(_t.resources)),delete _t.resources,_t._importedResources=St),typeof Et.fromJSON=="function"&&(await Promise.resolve(Et.fromJSON(_t,St)),_t.assetImporterProcessed=!1),[]}}else if(_t.plugins)return _t.resources=await((ht=this._viewer.getManager())===null||ht===void 0?void 0:ht.importConfigResources(_t.resources)),await this._viewer.getManager().importViewerConfig(_t),_t.assetImporterProcessed=!1,[];return console.warn("unknown asset type: ",_t),[_t]}dispose(){var s;(s=this._processors)===null||s===void 0||s.dispose()}}function $x(tt){if(!tt)return et.ywz;const s=tt.extensions.has("EXT_color_buffer_half_float")||tt.capabilities.isWebGL2&&tt.extensions.has("EXT_color_buffer_float"),o=tt.capabilities.isWebGL2||tt.extensions.has("OES_texture_float")||tt.extensions.has("WEBGL_color_buffer_float");return s?et.cLu:o?et.VzW:et.ywz}function GS(tt){var s,o,a;if(!tt.isLight||tt.assetType==="light")return tt;if(tt.uiConfig)return console.warn("ui config already exists, not supported",tt),tt;let _e;if(tt.children.length,tt.isDirectionalLight&&(_e=new c_),tt.isAmbientLight&&(_e=new Ux),tt.isSpotLight&&(_e=new qy),tt.isPointLight&&(_e=new VS),_e){(o=(s=_e.lightObject).copy)===null||o===void 0||o.call(s,tt);const rt=tt.parent;!((a=rt)===null||a===void 0)&&a.isObject3D&&(rt.remove(tt),tt.dispose(),tt.userData.iModel=_e,rt.add(_e.lightObject),_e.uuid=tt.uuid),Xo(_e.lightObject,rt)}else console.warn("unknown light type: ",tt);return _e}mo.Importers=[new Yl(IA,["json"],!1),new Yl(et.hH6,["txt"],!1),new Yl(G_,["rgbe.png","hdr.png","hdrpng"],!1),new Yl(et.dpR,["webp","png","jpeg","jpg","svg","data:image"],!1),new Yl(WT,["CUBE"],!1)];class YT extends et.u7G{constructor(s){super(s)}async loadAsync(s,o){var a;const _e=new et.hH6(this.manager);_e.setPath(this.path),_e.setRequestHeader(this.requestHeader),_e.setWithCredentials(this.withCredentials);const rt=await _e.loadAsync(s,o);try{const nt=JSON.parse(rt);if(nt.images&&this.importer){const ot={};let ct=nt.images;Array.isArray(ct)||(ct=Object.values(ct));for(const pt of nt.images){if(!pt.url||!pt.uuid)continue;const ht=(a=await this.importer.importPath(pt.url,{processImported:!1}))===null||a===void 0?void 0:a[0],_t=ht==null?void 0:ht.source;if(!ht||!_t)continue;const Et=new et.Hw6(_t.data);Et.uuid=pt.uuid,ot[Et.uuid]=Et,ht.dispose()}return this.parse(nt,ot)}return this.parse(nt)}catch(nt){throw console.error(nt),this.manager.itemError(s),nt}}parse(s,o){var a,_e;let rt;const nt={p:new Promise(ht=>{rt=ht})};if(s.images||s.textures){const ht=new OA(this.manager);let _t={};const Et=Nt=>{rt(),nt.p=void 0,Object.values(_t).forEach(Bt=>{var kt;Bt.isTexture&&(!((kt=Bt.image)===null||kt===void 0)&&kt.complete)&&(Bt.needsUpdate=!0)})};let St=s.images||[];Array.isArray(St)||(St=Object.values(St));const Mt=o||ht.parseImages(St,Et);let It=s.textures;Array.isArray(It)||(It=Object.values(It)),_t=ht.parseTextures2(It,Mt,Et),this.setTextures(_t)}this.materials||console.warn("A Material Manager is not set to import three materials, trying standard materials");const ot={...s};if(Object.entries(ot).forEach(([ht,_t])=>{_t&&typeof _t=="string"&&this.textures[_t]&&(ot[ht]=this.textures[_t])}),s.vertexColors!==void 0&&(typeof s.vertexColors=="number"?ot.vertexColors=s.vertexColors>0:ot.vertexColors=s.vertexColors),s.normalScale!==void 0){let ht=s.normalScale;Array.isArray(ht)===!1&&(ht=[ht,ht]),ot.normalScale=new et.FM8().fromArray(ht)}let ct=s.type;ct!=="MeshPhysicalMaterial"&&ct!=="MeshStandardMaterial"||(ct=tp.TYPE),ot.userData=In(ot.userData,void 0,!1,this);const pt=(_e=(a=this.materials)===null||a===void 0?void 0:a.generateFromTemplateType(ct,ot))!==null&&_e!==void 0?_e:super.parse(s);return this.setTextures({}),pt.userData.imageLoadAwaiter=nt,pt}}class os extends it{constructor(s,o,{simpleCache:a=!1,storage:_e}={}){if(super(),this._sceneUpdated=this._sceneUpdated.bind(this),this.addAsset=this.addAsset.bind(this),this.addProcessedAssets=this.addProcessedAssets.bind(this),this.addImported=this.addImported.bind(this),(a||_e)&&(a&&(et.CtF.enabled=!0),_e&&window.Cache&&typeof window.Cache=="function"&&_e instanceof window.Cache)){const rt={...et.CtF};et.CtF.get=(nt,ot,ct)=>ot?nt.startsWith("data:")||nt.startsWith("blob")||nt.startsWith("chrome-extension")?Promise.resolve(void 0):_e.match(nt).then(pt=>{if(pt)switch(ot){case"arraybuffer":return pt.arrayBuffer();case"blob":return pt.blob();case"document":return pt.text().then(ht=>new DOMParser().parseFromString(ht,ct??"text/html"));case"json":return pt.json();default:if(ct===void 0)return pt.text();{const ht=/charset="?([^;"\s]*)"?/i.exec(ct),_t=ht&&ht[1]?ht[1].toLowerCase():void 0,Et=new TextDecoder(_t);return pt.arrayBuffer().then(St=>Et.decode(St))}}}):rt.get(nt),et.CtF.add=(nt,ot,ct)=>{ct||rt.add(nt,ot),nt.startsWith("data:")||nt.startsWith("blob")||nt.startsWith("chrome-extension")||_e.put(nt,new Response(ot,{status:200}))},et.CtF.remove=(nt,ot)=>{ot||rt.remove(nt),_e.delete(nt)}}this._importer=s,this._materials=o}async addAsset(s,o={}){if(!this._importer||!this._viewer)return[];const a=await this._importer.importAsset(s,o);return a?(this.addProcessedAssets(a,o),a):(console.warn("Unable to import",s,a),[])}async addFromPath(s,o={}){if(!this._importer||!this._viewer)return[];const a=await this._importer.importPath(s,o);return a?(this.addProcessedAssets(a,o),a):(console.warn("Unable to import",s,a),[])}addProcessedAssets(s,o){return s.map(a=>{var _e;return(_e=this._viewer)===null||_e===void 0?void 0:_e.scene.addSceneObject(a,o)})}async addAssetSingle(s,o={}){var a;return s?(a=await(typeof s=="string"?this.addFromPath:this.addAsset)(s,o))===null||a===void 0?void 0:a[0]:void 0}async addImported(s,o={}){var a;return(a=this._importer)===null||a===void 0?void 0:a.processImported(s,o).then(_e=>(this.addProcessedAssets(_e,o),_e))}async addImportedSingle(s,o={}){return this.addImported(s,o).then(a=>a==null?void 0:a[0])}_sceneUpdated(s){var o;if(s.type==="addSceneObject"){const a=s.object;a.assetType==="material"&&((o=this._materials)===null||o===void 0||o.processMaterial(a,{}))}else console.error("Unexpected")}async onAdded(s){this._viewer=s,this._materials||(this._materials=new F_,this._viewer.scene.addEventListener("addSceneObject",this._sceneUpdated)),this._importer||(this._importer=new mo(s,!!s.getPluginByType("debug")),this._importer.processors.add("model",{forAssetType:"model",process:(a,_e)=>(U_(a,rt=>{var nt;return(nt=this._materials)===null||nt===void 0?void 0:nt.processModel(rt,{recursive:!1})}),a)}),this._importer.processors.add("model",{forAssetType:"model",process:this._materials.processModel}),this._importer.processors.add("material",{forAssetType:"material",process:(a,_e)=>{var rt;return!((rt=this.materials)===null||rt===void 0)&&rt.findMaterial(a.uuid)&&(console.warn("imported material uuid already exists, creating new uuid"),a.uuid=mn(),a.userData.uuid&&(a.userData.uuid=a.uuid)),this._materials.processMaterial(a,_e)}})),mo.Importers.push(new Yl(YT,[tp.TypeSlug],!1,a=>(a&&(a.materials=this._materials),a&&(a.importer=this._importer),a)));const o=this.importViewerConfig.bind(this);mo.Importers.push(new Yl(class extends IA{async loadAsync(a,_e){return o(await super.loadAsync(a,_e))}},[os.ViewerTypeSlug],!0))}async onDispose(s){}async onRemove(s){var o,a;s===this._viewer&&((o=this._importer)===null||o===void 0||o.dispose(),this._importer=void 0,this._viewer.scene.removeEventListener("addSceneObject",this._sceneUpdated),(a=this._materials)===null||a===void 0||a.dispose(),this._materials=void 0)}get importer(){return this._importer}get exporter(){var s,o;return(o=(s=this._viewer)===null||s===void 0?void 0:s.getPluginByType("AssetExporterPlugin"))===null||o===void 0?void 0:o.exporter}get materials(){return this._materials}exportViewerConfig(s){if(!this._viewer)return{};const o={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},...s},a=this._viewer.toJSON(o);return a.resources=o,a}exportPluginPresets(s){var o;const a={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}};return{plugins:(o=this._viewer)===null||o===void 0?void 0:o.serializePlugins(a,s),resources:a}}exportPluginPreset(s){if(!s.toJSON)return;const o={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},a=s.toJSON(o);return a.resources=o,a}async importPluginPreset(s,o){var a;const _e=s.type;if(!(o=o||((a=this._viewer)===null||a===void 0?void 0:a.getPluginByType(_e))))return void console.warn(`No plugin found for type ${_e} to import preset`);if(!o.fromJSON)return void console.warn(`Plugin ${_e} does not support importing presets`);const rt=s.resources||{};return s.resources&&delete s.resources,await o.fromJSON(s,rt),rt&&(s.resources=rt),o}async importViewerConfig(s,o){if(!this._viewer||!this._importer)return void console.warn("No viewer or importer");const a=await this.importConfigResources(s.resources||{},o);this.applyViewerConfig(s,a)}applyViewerConfig(s,o){var a;if(this._viewer&&this._importer)if((o=o||s.resources).__isLoadedResources){this._viewer.fromJSON(s,o);for(const _e of Object.values(o.materials))_e.__useCount?delete _e.__useCount:(a=this._materials)===null||a===void 0||a.unregisterMaterial(_e);for(const _e of Object.values(o.textures))_e.__useCount&&delete _e.__useCount}else console.error("Cannot load viewer config: resources not loaded",s);else console.warn("No viewer or importer")}async importConfigResources(s,o,a){var _e,rt,nt;if(!this._importer)throw"Importer not initialized yet.";if(s.__isLoadedResources)return s;const ot={};o=o??new OA(this._importer.loadingManager),ot.animations=s.animations?o.parseAnimations(s.animations):{},a&&a.animations&&(ot.animations={...ot.animations,...a.animations}),ot.shapes=s.shapes?o.parseShapes(s.shapes):{},a&&a.shapes&&(ot.shapes={...ot.shapes,...a.shapes}),ot.geometries=s.geometries?o.parseGeometries(s.geometries,ot.shapes):{},a&&a.geometries&&(ot.geometries={...ot.geometries,...a.geometries}),ot.images=s.images?await o.parseImagesAsync(Object.values(s.images)):{},a&&a.images&&(ot.images={...ot.images,...a.images});for(const pt of Object.values(s.textures)){const ht=(_e=pt==null?void 0:pt.userData)===null||_e===void 0?void 0:_e.rootPath;if(ht&&(!pt.image||!ot.images[pt.image])){const _t=(rt=await this._importer.importPath(ht,{processImported:!1}))===null||rt===void 0?void 0:rt[0],Et=_t==null?void 0:_t.source;if(!_t||!Et)continue;const St=new et.Hw6(Et.data);pt.image&&(St.uuid=pt.image),ot.images[St.uuid]=St,pt.image=St.uuid,_t.dispose()}}ot.textures=s.textures?o.parseTextures2(Object.values(s.textures),ot.images,()=>{Object.values(ot.textures).forEach(pt=>{var ht;pt.isTexture&&(!((ht=pt.image)===null||ht===void 0)&&ht.complete)&&(pt.needsUpdate=!0)})}):{};for(const pt of Object.entries(ot.textures))pt[1]=(nt=await this._importer.processImported(pt[1],{}))===null||nt===void 0?void 0:nt[0],pt[1]?ot.textures[pt[0]]=pt[1]:delete ot.textures[pt[0]];a&&a.textures&&(ot.textures={...ot.textures,...a.textures});const ct=s.materials?Object.values(s.materials):[];for(const pt of ct)Object.entries(pt).forEach(([ht,_t])=>{_t&&_t.resource&&_t.uuid&&_t.resource==="textures"&&(pt[ht]=_t.uuid)});return ot.materials=o.parseMaterials2(ct,ot.textures,this._materials),a&&a.materials&&(ot.materials={...ot.materials,...a.materials}),s.object&&(ot.object=o.parseObject(s.object,ot.geometries,ot.materials,ot.textures,ot.animations),s.skeletons&&(ot.skeletons=o.parseSkeletons(s.skeletons,ot.object),o.bindSkeletons(ot.object,ot.skeletons))),ot.__isLoadedResources=!0,ot}}os.PluginType="AssetManager",os.ViewerTypeSlug="vjson";class io extends it{constructor(){super(...arguments),this._dirty=!1}get dirty(){return this._dirty}set dirty(s){this._dirty=s}async onAdded(s){this._viewer=s}async onDispose(s){}async onRemove(s){this._viewer!==s&&console.error("Wrong viewer"),this._viewer=void 0}toJSON(s){const o=rs(this,!0,s);return o.type=this.constructor.PluginType,this.dispatchEvent({type:"serialize",data:o}),o}fromJSON(s,o){return s.type!==this.constructor.PluginType?null:(In(s,this,!0,o),this.dispatchEvent({type:"deserialize",data:s}),this)}}function YA(tt,s,o){return{...s,get dirty(){return s.dirty||!1},set dirty(a){dr(s,"dirty",a,!0)},update(){var a,_e,rt;this.passObject.enabled&&((_e=(a=this.passObject).updateShaderProperties)===null||_e===void 0||_e.call(a,er(o)),(rt=s.update)===null||rt===void 0||rt.call(this))},onRegister(a){var _e,rt,nt;this.passObject.materialExtension&&((rt=(_e=tt.getPlugin(os))===null||_e===void 0?void 0:_e.materials)===null||rt===void 0||rt.registerMaterialExtension(this.passObject.materialExtension)),(nt=s.onRegister)===null||nt===void 0||nt.call(this,a)},onUnregister(a){var _e,rt,nt;this.passObject.materialExtension&&((rt=(_e=tt.getPlugin(os))===null||_e===void 0?void 0:_e.materials)===null||rt===void 0||rt.unregisterMaterialExtension(this.passObject.materialExtension)),(nt=s.onUnregister)===null||nt===void 0||nt.call(this,a)},dispose(){var a,_e,rt;(_e=(a=this.passObject).dispose)===null||_e===void 0||_e.call(a),(rt=s.dispose)===null||rt===void 0||rt.call(this)}}}class Mv extends io{constructor(){super(),this._enabledTemp=!0}_update(s){var o;return((o=this._pass)===null||o===void 0?void 0:o.enabled)&&this.enabled||!1}get enabled(){var s,o;return((o=(s=this._pass)===null||s===void 0?void 0:s.passObject)===null||o===void 0?void 0:o.enabled)||this._enabledTemp}set enabled(s){var o;!((o=this._pass)===null||o===void 0)&&o.passObject&&(this._pass.passObject.enabled=s),this._enabledTemp=s}async onAdded(s){await super.onAdded(s);const o={enabled:!0,passId:this.passId,passObject:this.passCtor(s),after:this._afterFilters,before:this._beforeFilters,required:this._requiredFilters,set dirty(a){a&&s.setDirty()},get dirty(){return!1},update:()=>this._update(s)};this._pass=YA(s,o),o.passObject.onDirty!==void 0&&o.passObject.onDirty.push(()=>o.dirty=!0),s.renderer.registerPass(this._pass),this.enabled=this._enabledTemp}async onRemove(s){var o,a;this._pass&&s.renderer.unregisterPass(this._pass),(a=(o=this._pass)===null||o===void 0?void 0:o.dispose)===null||a===void 0||a.call(o),this._pass=void 0,await super.onRemove(s)}get pass(){return this._pass}toJSON(s){var o,a;const _e=super.toJSON(s);if(!_e.type)return _e;const rt=this.pass;return rt&&(_e.pass=rs((a=(o=rt)===null||o===void 0?void 0:o.passObject)!==null&&a!==void 0?a:rt,!1,s)),_e}fromJSON(s,o){var a,_e;if(!super.fromJSON(s,o))return null;if(s.pass){const rt=this.pass;rt&&In(s.pass,(_e=(a=rt)===null||a===void 0?void 0:a.passObject)!==null&&_e!==void 0?_e:rt,!1,o)}return this}}(function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);rt>3&&nt&&Object.defineProperty(s,o,nt)})([Yr()],Mv.prototype,"enabled",null);const QS=new Set,HS=new Set;class KT extends na{constructor(s,o,a,_e){super(void 0,void 0,o,new ys(1,1,1),1),this.target=s}render(s,o,a,_e,rt){const nt=s.getRenderTarget(),ot=s.getActiveCubeFace(),ct=s.getActiveMipmapLevel();this.scene.traverse(({material:pt})=>{pt&&((pt.transparent&&pt.userData.renderToDepth||!pt.transparent&&pt.transmission===0&&pt.userData.renderToDepth===!1)&&(QS.add(pt),pt.transparent=!pt.transparent),Math.abs(pt.transmission||0)>0&&pt.userData.renderToDepth&&(HS.add([pt,pt.transmission]),pt.transmission=0))}),jn(s,{shadowMapRender:!1,backgroundRender:!1,opaqueRender:!0,transparentRender:!1,transmissionRender:!1,mainRenderPass:!1},()=>super.render(s,o,this.target,_e,rt)),QS.forEach(pt=>pt.transparent=!pt.transparent),QS.clear(),HS.forEach(([pt,ht])=>pt.transmission=ht),HS.clear(),s.setRenderTarget(nt,ot,ct)}}class Dl extends Mv{constructor(s=!0){super(),this.renderFlagsBuffer=s,this.passId="gbuffer",this._beforeFilters=["render"],this._afterFilters=[],this._requiredFilters=["render"],this._gbufferTextures=[]}passCtor(s){var o,a;const _e=((o=this._viewer)===null||o===void 0?void 0:o.renderer.isWebGL2)&&this.renderFlagsBuffer,rt=s.renderer.createTarget({depthBuffer:!0,type:et.ywz,textureCount:_e?2:1});Array.isArray(rt.texture)?(rt.texture[0].name="gbufferDepthNormal",rt.texture[1].name="gbufferFlags",this._gbufferTextures=rt.texture):(rt.texture.name="gbufferDepthNormal",this._gbufferTextures.push(rt.texture)),this._gbufferTarget=rt;const nt=(a=this._viewer)===null||a===void 0?void 0:a.getPluginByType("debug");return nt&&(nt.addTexture("gbuffer depth normal",()=>this.getDepthNormal(),[40,110,300,200]),this._gbufferTextures.length>1&&nt.addTexture("gbuffer flags",()=>this.getFlagsTexture(),[40,310,200,100])),new KT(rt,new em(_e))}_update(s){if(!super._update(s))return!1;const o=this.pass.passObject;return o.scene=s.scene.modelObject,s.scene.activeCamera.updateShaderProperties(o.overrideMaterial),o.camera=s.scene.activeCamera.cameraObject,!0}getDepthNormal(){return this._gbufferTextures.length>0?this._gbufferTextures[0]:void 0}getFlagsTexture(){return this._gbufferTextures.length>1?this._gbufferTextures[1]:void 0}async onDispose(s){}async onRemove(s){return this._gbufferTarget&&(s.renderer.disposeTarget(this._gbufferTarget),this._gbufferTarget=void 0),super.onRemove(s)}getTarget(){return this._gbufferTarget}getUnpackSnippet(){return Zv}updateShaderProperties(s){var o,a;if(s.uniforms.tNormalDepth?s.uniforms.tNormalDepth.value=(o=this.getDepthNormal())!==null&&o!==void 0?o:void 0:console.warn("BaseRenderer: no uniform: tNormalDepth"),s.uniforms.tGBufferFlags){s.uniforms.tGBufferFlags.value=(a=this.getFlagsTexture())!==null&&a!==void 0?a:void 0;const _e=s.uniforms.tGBufferFlags.value?1:0;_e!==s.defines.GBUFFER_HAS_FLAGS&&(s.defines.GBUFFER_HAS_FLAGS=_e,s.needsUpdate=!0)}return this}}Dl.PluginType="GBuffer";class XT extends na{constructor(s,o=!0){super(),this.blurTransmissionTarget=!1,this._viewer=s,this._doTransmissionFix=o,this.clear=!0,this.clearColor=new ys(0,0,0),this.clearAlpha=0,this.clearDepth=!1,this._blendPass=new TA({},"c = vec4(a.rgb * (1. - b.a) + b.rgb * b.a, 1.);")}get transparentTarget(){return this._transparentTarget||(this._transparentTarget=this._viewer.renderer.getTempTarget({sizeMultiplier:1,samples:this._viewer.renderer.composerTarget.samples||0,encoding:et.rnI,type:et.cLu,format:et.wk1,minFilter:et.wem,magFilter:et.wem,depthBuffer:!1})),this._transparentTarget}_releaseTransparentTarget(){this._transparentTarget&&this._viewer.renderer.releaseTempTarget(this._transparentTarget),this._transparentTarget=void 0}render(s,o,a,_e,rt){var nt;let ot=!1;if(s.userData.mainRenderPass=!0,!this._doTransmissionFix)return super.render(s,o,a,_e,rt),this.needsSwap=ot,void(s.userData.mainRenderPass=void 0);const ct=s.userData;ct||console.error("threejs is not patched?");const pt=this._viewer.useGBufferDepth;let ht;if(pt){const Et=(nt=this._viewer.getPlugin(Dl))===null||nt===void 0?void 0:nt.getTarget();if(Et){const St=s.properties.get(Et);ht=St.__webglDepthRenderbuffer||St.__webglDepthbuffer}else console.warn("No Gbuffer present for depth prepass.")}let _t=()=>{super.render(s,void 0,a,_e,rt,ht)};if(this._viewer.useRgbm){if(this._viewer.useRgbm){if(ot=!1,!s.info.autoReset)throw"renderer.info.autoReset must be true";{const Et=s.autoClearDepth;s.autoClearDepth=!pt,jn(s,{shadowMapRender:!0,backgroundRender:!0,opaqueRender:!0,transparentRender:!1,transmissionRender:!1},_t),s.autoClearDepth=Et}if(!pt){const Et=s.properties.get(a);ht=Et.__webglDepthRenderbuffer||Et.__webglDepthbuffer}_t=()=>{super.render(s,void 0,this.transparentTarget,_e,rt,ht)};{const Et=this.clear,St=s.autoClearDepth;s.autoClearDepth=!1,this.clear=!0,jn(s,{shadowMapRender:!1,backgroundRender:!1,opaqueRender:!1,transparentRender:!0,transmissionRender:!1},_t),this.clear=Et,s.autoClearDepth=St}s.info.render.calls>0&&(this._blendPass.uniforms.tDiffuse2.value=this.transparentTarget.texture,this._blendPass.render(s,o,a,_e,rt),ot=!0);{const Et=this.clear;this.clear=!1,ct.transmissionRenderTarget=ot?o:a,ct.blurTransmissionTarget=this.blurTransmissionTarget,jn(s,{shadowMapRender:!1,backgroundRender:!1,opaqueRender:!1,transparentRender:!1,transmissionRender:!0},_t),ct.blurTransmissionTarget=void 0,ct.transmissionRenderTarget=void 0,this.clear=Et}s.info.render.calls>0&&(this._blendPass.uniforms.tDiffuse2.value=this.transparentTarget.texture,this._blendPass.render(s,o,a,_e,rt),ot=!0)}}else{{const Et=this.clear,St=s.autoClearDepth;s.autoClearDepth=!pt,this.clear=!0,jn(s,{shadowMapRender:!0,backgroundRender:!0,opaqueRender:!0,transparentRender:!0,transmissionRender:!1},_t),this.clear=Et,s.autoClearDepth=St}{this._viewer.renderer.blit(a.texture,o,{clear:!0});const Et=this.clear;this.clear=!1,ct.transmissionRenderTarget=o,ct.blurTransmissionTarget=this.blurTransmissionTarget,jn(s,{shadowMapRender:!1,backgroundRender:!1,opaqueRender:!1,transparentRender:!1,transmissionRender:!0},_t),ct.blurTransmissionTarget=void 0,ct.transmissionRenderTarget=void 0,this.clear=Et}ot=!1}this._releaseTransparentTarget(),this.needsSwap=ot,s.userData.mainRenderPass=void 0}}function qS(tt,s){return tt.multiplyScalar(tt.w*s),tt.w=1,tt}function WS(tt,s){return qS(tt,s),new ys(tt.x,tt.y,tt.z)}function YS(tt,s){const o=Math.max(tt.x,Math.max(tt.y,tt.z));let a=Math.max(Math.min(o/s,1),0);return a=Math.ceil(255*a)/255,tt.divideScalar(a*s),tt.w=a,tt}function JT(tt,s){return YS(new et.Ltg(tt.r,tt.g,tt.b,1),s)}var jx=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};function KS(tt){return Object.getPrototypeOf(tt).constructor.PluginType}et.Vj0.background.fragmentShader=et.Vj0.background.fragmentShader.replace("uniform sampler2D t2D;",`uniform sampler2D t2D;
uniform float intensity;`),et.Vj0.background.fragmentShader=et.Vj0.background.fragmentShader.replace("texture2D( t2D, vUv )","texture2D( t2D, vUv )*intensity");class _g extends it{constructor({isAntialiased:s=!1,useRgbm:o=!0,useGBufferDepth:a=!1,screenShader:_e="",...rt}){var nt;super(),this.console=console,this._state=$.None,this.plugins={},this._needsResize=!1,this.resizeObserver=window.ResizeObserver?new window.ResizeObserver(Et=>this.resize()):void 0,this._lastSize=new et.FM8,this._onContextRestore=Et=>{this.enabled=!0,this._canvas.width=this._lastSize.width,this._canvas.height=this._lastSize.height,this.resize(),this.scene.setDirty({sceneUpdate:!0,frameFade:!1})},this._onContextLost=Et=>{this._lastSize.set(this._canvas.width,this._canvas.height),this._canvas.width=2,this._canvas.height=2,this.resize(),this.enabled=!1},this.resize=()=>{this._needsResize=!0,this.setDirty()},this._needsReset=!0,this.enabled=!0,this.renderEnabled=!0,this._isRenderingFrame=!1,this.maxFramePerLoop=1,this._rawBackground=null,this.backgroundIntensity=1,this._sceneEnvironmentChanged=()=>{this._rawBackground===Rv&&this.scene.setBackground(this.scene.getEnvironment())},this._addSceneObject=Et=>{var St;if(!Et||!Et.object)return;const Mt=Et.object.__importedViewerConfig||((St=Et.object.modelObject)===null||St===void 0?void 0:St.__importedViewerConfig);if(!Mt)return;const It=this.getManager();It?It.applyViewerConfig(Mt,Mt.resources):this.fromJSON(Mt,Mt.resources)},this.alert=async Et=>alert(Et),this.confirm=async Et=>confirm(Et),this.prompt=async(Et,St,Mt=!0)=>prompt(Et,St),this._useRgbm=o,this._useGBufferDepth=a,this._screenShader=_e,this._canvas=rt.canvas||D_();let ot=rt.container;if(ot&&!rt.canvas&&ot.appendChild(this._canvas),ot||(ot=(nt=this._canvas.parentElement)!==null&&nt!==void 0?nt:void 0),!ot)throw new Error("No container.");this._container=ot,this._animationLoop=this._animationLoop.bind(this),this.setDirty=this.setDirty.bind(this),this._setActiveCameraView=this._setActiveCameraView.bind(this),window.webGiViewers||(window.webGiViewers=[]),window.webGiViewers.push(this),async function(){try{const Et=window.location.href;if(Et.startsWith("http://localhost:8062")||Et.startsWith("https://localhost:8062"))return!0;await fetch("https://europe-west1-pixotronics-320918.cloudfunctions.net/viewer-hit-test"+"/?u="+encodeURIComponent(Et),{mode:"no-cors",method:"POST",credentials:"omit",cache:"no-store",keepalive:!1,referrer:"about:client",referrerPolicy:"unsafe-url"})}catch{return!1}}(),async function(){var Et;const St=window.location.href,Mt="https://dev-sandbox.pixotronics.com/webgi/";if(!St.startsWith(Mt)||O_("noUpdate")!==null)return!0;const It=(Et=St.match(/\/webgi\/([0-9.a-zA-Z]+)/))===null||Et===void 0?void 0:Et[1],Nt=(await(await fetch(Mt+"version.txt")).text()).split(`
`)[0];if(It&&It!==Nt){if(confirm(`New version ${Nt} is available, do you want to open?`)){const Bt=window.location.href.replace(It,Nt);return window.location.href=Bt,!1}window.location.href.includes("noUpdate")||(window.location.href+=(window.location.href.includes("?")?"&":"?")+"noUpdate")}}();const ct=new Rp(void 0,void 0,this._canvas);this.addEventListener("postFrame",()=>{var Et,St;const Mt=ht.scene.activeCamera;if(Mt&&Mt.interactionsEnabled){if(((Et=this.getPluginByType("Progressive"))===null||Et===void 0?void 0:Et.postFrameConvergedRecordingDelta())===0)return;(St=Mt.controls)===null||St===void 0||St.update()}}),this.scene=new P_(ct),this.scene.addEventListener("environmentChanged",this._sceneEnvironmentChanged),this.scene.addEventListener("addSceneObject",this._addSceneObject),this.scene.addEventListener("setView",this._setActiveCameraView),this.scene.addEventListener("activateMain",this._setActiveCameraView),this._renderer=new Vs({canvas:this._canvas,animationLoop:this._animationLoop,targetOptions:{samples:s?4:0,encoding:o?qr:et.rnI,type:o?et.ywz:et.cLu,depthBuffer:!a}}),this._isAntialiased=s&&this._renderer.isWebGL2;let pt=!0;this._renderer.rendererObject.userData||(pt=!1,this._renderer.rendererObject.userData={}),this._renderer.rendererObject.userData.renderTransmissionPass=!pt;const ht=this;this.renderFilter={passId:"render",passObject:new XT(this,pt),update(){const Et=this.passObject;Et.scene=ht.scene.modelObject,Et.camera=ht.scene.activeCamera.cameraObject}};const _t={passId:"screen",after:["render"],required:["render"],passObject:KA(_e)};[this.renderFilter,_t].forEach(Et=>this._renderer.registerPass(Et)),this._renderer.pipeline=["render","screen"],this.scene.addEventListener("sceneMaterialUpdate",Et=>this.setDirty(this.scene,Et)),this.scene.addEventListener("sceneUpdate",Et=>{this.setDirty(this.scene,Et),Et.geometryChanged!==!1&&this.renderer.resetShadows()}),this.scene.addEventListener("update",Et=>this.setDirty(this.scene,Et)),this._renderer.addEventListener("update",Et=>this.setDirty(this._renderer,Et)),this.resizeObserver&&this.resizeObserver.observe(this._canvas),window&&window.addEventListener("resize",this.resize),this._canvas.addEventListener("webglcontextrestored",this._onContextRestore,!1),this._canvas.addEventListener("webglcontextlost",this._onContextLost,!1),this.renderer.addEventListener("resize",()=>{this.scene.activeCamera.refreshAspect()}),this.setBackground("#ffffff"),this.console.log("WebGi Viewer instance initialized, version: ",_g.VERSION)}get useRgbm(){return this._useRgbm}get screenShader(){return this._screenShader}get useGBufferDepth(){return this._useGBufferDepth}get isAntialiased(){return this._isAntialiased}setDirty(s,o){this._needsReset=!0,s=s??this,this.dispatchEvent({...o??{},type:"update",source:s})}get renderer(){return this._renderer}dispose(){var s;this._canvas.removeEventListener("webglcontextrestored",this._onContextRestore,!1),this._canvas.removeEventListener("webglcontextlost",this._onContextLost,!1),(s=window.webGiViewers)===null||s===void 0||s.splice(window.webGiViewers.indexOf(this),1),this.resizeObserver?this.resizeObserver.unobserve(this._canvas):window.removeEventListener("resize",this.resize),this.dispatchEvent({type:"dispose"})}_animationLoop({time:s,deltaTime:o,xrFrame:a}){var _e,rt;if(this.enabled&&this.renderEnabled)if(this._isRenderingFrame)this.console.warn("animation loop: frame skip");else{this._isRenderingFrame=!0;for(let nt=0;nt<this.maxFramePerLoop;nt++){if(this._needsReset&&(this._renderer.reset(),this._needsReset=!1),this._needsResize){const pt=[this._canvas.clientWidth,this._canvas.clientHeight];if(a){const ht=(rt=(_e=this._renderer.rendererObject.xr.getCamera())===null||_e===void 0?void 0:_e.cameras[0])===null||rt===void 0?void 0:rt.viewport;ht?(ht.x===0&&ht.y===0||this.console.warn("x and y must be 0?"),pt[0]=ht.width,pt[1]=ht.height,this.console.log("resize for xr",pt)):this._needsResize=!1}this._needsResize&&(this._renderer.setSize(...pt),this._needsResize=!1)}this.dispatchEvent({type:"preFrame",target:this,time:s,deltaTime:o,xrFrame:a});const ot=Object.values(this.plugins).filter(pt=>pt.dirty);ot.length>0&&this.setDirty(ot),this._needsReset&&(this._renderer.reset(),this._needsReset=!1),this._renderer.updateDirty();const ct=this._renderer.dirty;if(ct){this.dispatchEvent({type:"preRender",target:this});try{this._renderer.render()}catch(pt){this.console.error(pt),this.enabled=!1}this.dispatchEvent({type:"postRender",target:this})}if(this.dispatchEvent({type:"postFrame",target:this}),!ct)break}this._isRenderingFrame=!1}}get state(){return this._state}get container(){return this._container}get canvas(){return this._canvas}getPlugin(s){return this.plugins[s.PluginType]}getPluginByType(s){return this.plugins[s]}async addPlugin(s,...o){var a;let _e;_e=s.prototype?new s(...o):s;const rt=KS(_e);return rt?((a=_e.dependencies)===null||a===void 0||a.forEach(nt=>{this.getPlugin(nt)||(this.console.log("Adding plugin dependency",nt.name,"for",rt),this.addPlugin(nt))}),this.plugins[rt]&&this.console.error(`Plugin of type ${rt} already exists`,this.plugins[rt],_e),this.plugins[rt]=_e,await _e.onAdded(this),this.dispatchEvent({type:"addPlugin",target:this,plugin:_e}),this.setDirty(_e),_e):(this.console.error("PluginType is not defined for",_e),_e)}async removePlugin(s,o=!0){const a=KS(s);this.plugins[a]&&(await s.onRemove(this),delete this.plugins[a],o&&await s.onDispose(this),this.setDirty(s))}createCamera(s){var o;const a=(o=s.userData.iCamera)!==null&&o!==void 0?o:new Rp(s,{controlsMode:"",controlsEnabled:!1},this._canvas);return a.autoLookAtTarget=!1,a}setSize(s){this._canvas.style.width=s!=null&&s.width?s.width+"px":"100%",this._canvas.style.height=s!=null&&s.height?s.height+"px":"100%",this.resize()}_backgroundIntensityChanged(){var s,o,a,_e;const rt=(_e=(a=(o=(s=this._renderer)===null||s===void 0?void 0:s.rendererObject)===null||o===void 0?void 0:o.background.getPlaneMesh())===null||a===void 0?void 0:a.material.uniforms)!==null&&_e!==void 0?_e:et.Vj0.background.uniforms;rt.intensity||(rt.intensity={value:1}),rt.intensity.value=this.backgroundIntensity,this.setDirty()}setBackgroundColor(s){const o=new ys().set(s).convertSRGBToLinear();return this.setBackground(o)}setBackground(s){if(this._rawBackground=s,s!=null&&(typeof s=="string"||typeof s=="number"||s.isVector4||s.isColor)){if(s===Rv)return this._sceneEnvironmentChanged();const o=s.isVector4?$n(s):On(s.isColor?s:new ys(s));return o.assetType="texture",this.scene.setBackground(o)}return!s&&this.useRgbm&&this.console.error("Transparent background not supported with HDR RGBM rendering mode"),this.scene.setBackground(s)}getBackground(s=!1){var o,a,_e;if(s)return this._rawBackground;let rt=(o=this._rawBackground)!==null&&o!==void 0?o:this.scene.getBackground();return rt?(!((a=rt)===null||a===void 0)&&a.isVector4&&(rt=WS(rt,7).getHexString()),!((_e=rt)===null||_e===void 0)&&_e.isColor?rt.getHexString():this._rawBackground===Rv?this.scene.getEnvironment():rt):null}getManager(){return this.getPluginByType("AssetManager")}resetCamera({rootObject:s,centerOffset:o=new et.Pa4(1,1,1),targetOffset:a=new et.Pa4(0,0,0),..._e}={}){if(this.scene.activeCamera){this.scene.matrixWorldNeedsUpdate=!0,this.scene.updateMatrixWorld(!0);const rt=s?new cn().expandByObject(s,!0,!0):this.scene.getBounds(!0),nt=rt.getCenter(new et.Pa4),ot=.5*rt.getSize(new et.Pa4).length();nt.add(a.clone().multiplyScalar(ot)),this.scene.activeCamera.position=new et.Pa4(nt.x+o.x*ot,nt.y+o.y*ot,nt.z+o.z*ot),this.scene.activeCamera.target=nt,this.setDirty()}}async createObject3D(s){var o;return(o=this.getManager())===null||o===void 0?void 0:o.addImportedSingle(s||new et.Tme,{autoScale:!1,pseudoCenter:!1})}createPhysicalMaterial(s){return this.createMaterial("standard",s)}createMaterial(s,o){var a,_e,rt,nt,ot;if(!((a=o)===null||a===void 0)&&a.isMaterial){const ct=(rt=(_e=this.getManager())===null||_e===void 0?void 0:_e.materials)===null||rt===void 0?void 0:rt.findMaterial(o.uuid);if(ct)return ct}return(ot=(nt=this.getManager())===null||nt===void 0?void 0:nt.materials)===null||ot===void 0?void 0:ot.generateFromTemplate(s,o)}serializePlugins(s,o){return Object.entries(this.plugins).map(a=>{var _e,rt;if(!o||o.includes(a[1].constructor.PluginType))return a[1].serializeWithViewer!==!1?(rt=(_e=a[1]).toJSON)===null||rt===void 0?void 0:rt.call(_e,s):void 0}).filter(a=>!!a)}deserializePlugins(s,o){return s.forEach(a=>{var _e;if(!a.type)return void this.console.warn("Invalid plugin to import ",a);const rt=this.getPluginByType(a.type);rt&&((_e=rt.fromJSON)===null||_e===void 0||_e.call(rt,a,o))}),this}traverseSceneObjects(s){this.scene.modelRoot.modelObject.traverse(s)}toJSON(s,o){return Object.assign({version:_g.VERSION,plugins:this.serializePlugins(s,o)},rs(this,!0,s))}fromJSON(s,o){return In(s,this,!0,o),Array.isArray(s.plugins)&&this.deserializePlugins(s.plugins,o),this.setBackground(this._rawBackground),this}_setActiveCameraView(s={}){if(s.type==="setView"){if(!s.camera)return void console.warn("Cannot find camera",s);this.scene.activeCamera.copyFromCamera(s.camera)}else s.type==="activateMain"&&(this.scene.activeCamera=s.camera?this.createCamera(s.camera):void 0)}}_g.VERSION="0.5.5",jx([Yr()],_g.prototype,"scene",void 0),jx([Yr("background")],_g.prototype,"_rawBackground",void 0),jx([Yr(),vr(_g.prototype._backgroundIntensityChanged)],_g.prototype,"backgroundIntensity",void 0);const Rv="envMapBackground";function KA(tt){var s,o,a;return!((s=tt)===null||s===void 0)&&s.isShaderPass2?tt:new Ru({...ut,fragmentShader:`
                       varying vec2 vUv;
                       
                       ${Array.isArray(tt)?tt[0]:((o=tt)===null||o===void 0?void 0:o.pars)||""}
                       
                       void main() {

                            gl_FragColor = tDiffuseTexelToLinear (texture2D(tDiffuse, vUv));
                            
                            ${Array.isArray(tt)?tt[1]:typeof tt=="string"?tt:((a=tt)===null||a===void 0?void 0:a.main)||""}
                            
                        }`,uniforms:{tDiffuse:{value:null}}},"tDiffuse")}var ap=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let hu=class extends io{constructor(){super(),this.toJSON=void 0,this.enabled=!0,this._lastSize=["100%","100%"],this._lastFsElement=null,this._fsChangeHandler=tt=>{var s;if(this.isFullScreen())this.dispatchEvent({type:"enter"});else{const o=this._lastFsElement||((s=this._viewer)===null||s===void 0?void 0:s.canvas);o&&(o.style.width=this._lastSize[0],o.style.height=this._lastSize[1]),document.removeEventListener("webkitfullscreenchange",this._fsChangeHandler,!1),document.removeEventListener("mozfullscreenchange",this._fsChangeHandler,!1),document.removeEventListener("fullscreenchange",this._fsChangeHandler,!1),document.removeEventListener("MSFullscreenChange",this._fsChangeHandler,!1),this.dispatchEvent({type:"exit"})}},this.enter=this.enter.bind(this),this.exit=this.exit.bind(this)}async enter(tt){var s;if(this.isFullScreen())return;const o=tt||((s=this._viewer)===null||s===void 0?void 0:s.canvas);return o?(this._lastFsElement=o,document.addEventListener&&(document.addEventListener("webkitfullscreenchange",this._fsChangeHandler,!1),document.addEventListener("mozfullscreenchange",this._fsChangeHandler,!1),document.addEventListener("fullscreenchange",this._fsChangeHandler,!1),document.addEventListener("MSFullscreenChange",this._fsChangeHandler,!1)),this._lastSize=[o.style.width,o.style.height],o.style.width="100%",o.style.height="100%",o.requestFullscreen?o.requestFullscreen():o.mozRequestFullScreen?o.mozRequestFullScreen():o.webkitRequestFullscreen?o.webkitRequestFullscreen():o.msRequestFullscreen?o.msRequestFullscreen():void 0):void 0}async exit(){return document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():void 0}async toggle(tt){return this.isFullScreen()?this.exit():this.enter(tt)}isFullScreen(){return document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement!==void 0}};hu.PluginType="FullScreenPlugin",ap([Qo("Enter FullScreen")],hu.prototype,"enter",null),ap([Qo("Exit FullScreen")],hu.prototype,"exit",null),ap([Qo("Toggle FullScreen")],hu.prototype,"toggle",null),hu=ap([Ao("Full Screen")],hu);class Xw{constructor(s,o,a){this._el=s,this._inputEl=o,this._listeners={drop:[],dropstart:[],droperror:[]},this._onDragover=this._onDragover.bind(this),this._onDrop=this._onDrop.bind(this),this._onSelect=this._onSelect.bind(this),s==null||s.addEventListener("dragover",this._onDragover,!1),s==null||s.addEventListener("drop",this._onDrop,!1),o==null||o.addEventListener("change",this._onSelect),a&&Object.entries(a).forEach(([_e,rt])=>rt&&this.on(_e,rt))}get inputEl(){return this._inputEl}get el(){return this._el}on(s,o){return this._listeners[s].push(o),this}_emit(s,o){return this._listeners[s].forEach(a=>a(o)),this}destroy(){const s=this._el,o=this._inputEl;s==null||s.removeEventListener("dragover",this._onDragover),s==null||s.removeEventListener("drop",this._onDrop),o==null||o.removeEventListener("change",this._onSelect)}_onDrop(s){var o,a;s.stopPropagation(),s.preventDefault(),this._emit("dropstart");const _e=Array.from(((o=s.dataTransfer)===null||o===void 0?void 0:o.files)||[]),rt=Array.from(((a=s.dataTransfer)===null||a===void 0?void 0:a.items)||[]);if(_e.length!==0||rt.length!==0)if(rt.length>0){const nt=rt.map(ot=>ot.webkitGetAsEntry());this._loadNextEntry(new Map,nt)}else this._emit("drop",{files:new Map(_e.map(nt=>(nt.filePath=nt.name,[nt.filePath,nt])))});else this._fail("Required drag-and-drop APIs are not supported in this browser.")}_onDragover(s){s.stopPropagation(),s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect="copy")}_onSelect(s){var o;if(!this._inputEl)return void console.warn("Invalid Dropzone event ",s);this._emit("dropstart");const a=[].slice.call((o=this._inputEl.files)!==null&&o!==void 0?o:new FileList),_e=new Map;a.forEach(rt=>{rt.filePath=rt.webkitRelativePath||rt.name,_e.set(rt.filePath,rt)}),this._emit("drop",{files:_e})}_loadNextEntry(s,o){const a=o.pop();if(a)if(a.isFile)a.file(_e=>{_e.filePath=a.fullPath,s.set(a.fullPath,_e),this._loadNextEntry(s,o)},()=>console.error("Could not load file: %s",a.fullPath));else if(a.isDirectory){const _e=a.createReader(),rt=nt=>{nt.length?(o=o.concat(nt),_e.readEntries(rt)):this._loadNextEntry(s,o)};_e.readEntries(rt)}else console.warn("Unknown asset type: "+a.fullPath),this._loadNextEntry(s,o);else this._emit("drop",{files:s})}_fail(s){this._emit("droperror",{message:s})}}class Jw extends it{constructor(s){super(),this._domElement=s,this._allowedExtensions=void 0,this.importerParams={autoScale:!0,autoScaleRadius:2,pseudoCenter:!0,autoCenter:!1,autoImport:!0,autoAdd:!0,centerOffset:new et.Pa4(.5,.5,3)},this.dependencies=[os],this.uiConfig={type:"folder",label:"Drop Options",children:[{label:"Auto Center",type:"checkbox",property:[this.importerParams,"pseudoCenter"],limitedUi:!0},{label:"Auto Scale",type:"checkbox",property:[this.importerParams,"autoScale"],limitedUi:!0},{label:"Auto scale radius",type:"slider",bounds:[.5,100],property:[this.importerParams,"autoScaleRadius"]}]}}async onAdded(s){this._inputEl=document.createElement("input"),this._viewer=s,this._inputEl.type="file",this._dropzone=new Xw(this._domElement||s.canvas,this._inputEl,{drop:this._onFileDrop.bind(this)})}async _onFileDrop({files:s}){var o,a,_e,rt,nt,ot;if(!s)return;const ct=this._viewer;if(!ct)return;if(this._allowedExtensions!==void 0)for(const _t of s.keys())this._allowedExtensions.includes((a=(o=_t.split(".").pop())===null||o===void 0?void 0:o.toLowerCase())!==null&&a!==void 0?a:"")||s.delete(_t);if(s.size<1)return;const pt=ct.getPlugin(os),ht={type:"drop",files:s};if(this.importerParams.autoImport){const _t={allowedExtensions:this.allowedExtensions,...this.importerParams};if(ht.imported=await((_e=pt.importer)===null||_e===void 0?void 0:_e.importFiles(s,_t)),this.importerParams.autoAdd){const Et=(ot=[...(nt=(rt=ht.imported)===null||rt===void 0?void 0:rt.values())!==null&&nt!==void 0?nt:[]].flat(2).filter(St=>!!St))!==null&&ot!==void 0?ot:[];if(ht.assets=pt.addProcessedAssets(Et,{...this.importerParams}),!_t._rootSceneImported)for(const St of ht.assets)St.modelObject&&St.modelObject.dispatchEvent({type:"select",value:St.modelObject})}}this.dispatchEvent(ht)}promptForFile(){var s;(s=this._inputEl)===null||s===void 0||s.click()}async onDispose(s){}async onRemove(s){var o;(o=this._dropzone)===null||o===void 0||o.destroy(),this._dropzone=void 0,this._viewer=void 0}get allowedExtensions(){return this._allowedExtensions}set allowedExtensions(s){this._allowedExtensions=s,this._inputEl&&(this._inputEl.accept=s?s.map(o=>"."+o).join(", "):"")}}Jw.PluginType="Dropzone";class XS extends Ru{constructor(s){super({vertexShader:ut.vertexShader,fragmentShader:Wt`
                uniform vec4 weight;
                uniform vec4 weight2;
                varying vec2 vUv;
                void main() {
                    vec4 texel = clamp(weight * tDiffuseTexelToLinear ( texture2D( tDiffuse, vUv ) ) + weight2 * tDiffuse2TexelToLinear ( texture2D( tDiffuse2, vUv ) ), vec4(0), vec4(8));
                    gl_FragColor = texel;
                    #include <encodings_fragment>
                }
            `,uniforms:{tDiffuse:{value:null},tDiffuse2:{value:s},weight:{value:new et.Ltg(1,1,1,1)},weight2:{value:new et.Ltg(1,1,1,1)}}},"tDiffuse","tDiffuse2"),this.clear=!1,this.needsSwap=!0}set weights2(s){this.uniforms.weight2.value.copy(s)}get weights2(){return this.uniforms.weight2.value}set weights1(s){this.uniforms.weight.value.copy(s)}get weights1(){return this.uniforms.weight.value}set blendTexture(s){this.uniforms.tDiffuse2.value=s}}class Zw extends io{constructor(){super(),this._pipeline=[]}get passes(){if(!this._passes)throw"Plugin not yet added to the viewer";return this._passes}get pipeline(){return this._pipeline}set pipeline(s){this._pipeline=s}async onAdded(s){await super.onAdded(s);const o=this.createPasses(s);this._passes=Object.fromEntries(o.map(a=>(a.passId||(console.warn("no id found for pass",a),a.passId=Mo()),s.renderer.registerPass(a,!0),[a.passId,a])))}async onRemove(s){var o;if(this._passes){for(const a of[...Object.values(this._passes)]){const _e=a;s.renderer.unregisterPass(_e),(o=_e==null?void 0:_e.dispose)===null||o===void 0||o.call(_e)}this._passes=void 0}await super.onRemove(s)}toJSON(s){var o,a;const _e=super.toJSON(s);if(!_e.type)return _e;const rt=Object.entries(this.passes);_e.passes={};for(const[nt,ot]of rt)_e.passes[nt]=rs((a=(o=ot)===null||o===void 0?void 0:o.passObject)!==null&&a!==void 0?a:ot,!1,s);return _e}fromJSON(s,o){var a,_e;if(!super.fromJSON(s,o))return null;if(s.passes){const rt=Object.entries(this.passes);for(const[nt,ot]of rt)In(s.passes[nt],(_e=(a=ot)===null||a===void 0?void 0:a.passObject)!==null&&_e!==void 0?_e:ot,!1,o)}return this}}var ZT=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};const JS=[{x:0,y:0},{x:-.5,y:0},{x:-.375,y:-.25},{x:-.1875,y:-.125},{x:-.125,y:-.375},{x:.0625,y:-.0625},{x:.125,y:-.3125},{x:.375,y:-.4375},{x:.3125,y:-.1875},{x:.25,y:.0625},{x:.4375,y:.25},{x:.1875,y:.3125},{x:0,y:.4375},{x:-.0625,y:.1875},{x:-.25,y:.375},{x:-.4375,y:.5},{x:-.3125,y:.125}];class _p extends Zw{constructor(s=2*JS.length){super(),this.enabled=!0,this.jitter=!0,this._hasSetOffset=!1,this.trackedJitterCameras=new Set,this._addSceneObject=o=>{const a=o.object;(a.modelObject||a.lightObject)&&(a.modelObject||a.lightObject).traverse(_e=>{var rt;!((rt=_e==null?void 0:_e.shadow)===null||rt===void 0)&&rt.camera&&_e.shadow.mapSize&&this.trackedJitterCameras.add([_e.shadow.camera,_e.shadow.mapSize])})},this._jitterCamera=o=>{var a;const _e=o.target;if(this.jitter&&_e.renderer.frameCount>2){const rt=(ot,ct)=>{const pt={...JS[_e.renderer.frameCount%JS.length]};ot.setViewOffset(ct.width,ct.height,pt.x,pt.y,ct.width,ct.height)},nt=_e.scene.activeCamera.cameraObject;rt(nt,{width:_e.canvas.clientWidth*_e.renderer.displayCanvasScaling,height:_e.canvas.clientHeight*_e.renderer.displayCanvasScaling}),this.trackedJitterCameras.forEach(ot=>rt(...ot)),this._hasSetOffset=!0,(a=this._viewer)===null||a===void 0||a.renderer.resetShadows()}},this._resetCameraJitter=o=>{const a=o.target;this._hasSetOffset&&(a.scene.activeCamera.cameraObject.clearViewOffset(),this._hasSetOffset=!1)},this.uiConfig=R_("Progressive",this),this.maxFrameCount=s}async onAdded(s){return this._lastFrame=s.renderer.composerTarget.clone(!0),await super.onAdded(s)}async onRemove(s){s.removeEventListener("preRender",this._jitterCamera),s.removeEventListener("postRender",this._resetCameraJitter),s.scene.removeEventListener("addSceneObject",this._addSceneObject),this._lastFrame&&s.renderer.disposeTarget(this._lastFrame),this._lastFrame=void 0,await super.onRemove(s)}get lastFrame(){return this._lastFrame}createPasses(s){s.addEventListener("preRender",this._jitterCamera),s.addEventListener("postRender",this._resetCameraJitter),s.scene.addEventListener("addSceneObject",this._addSceneObject);const o=this;return[YA(s,{passId:"progressive",get dirty(){var _e;return o.jitter&&(((_e=o._viewer)===null||_e===void 0?void 0:_e.renderer.frameCount)||0)<o.maxFrameCount},after:["render"],before:["combinedPost","screen"],required:["render"],passObject:new class extends XS{render(_e,rt,nt,ot,ct){if(s.renderer.frameCount<1)return this.needsSwap=!1,void((nt==null?void 0:nt.texture)&&s.renderer.blit(nt.texture,o.lastFrame,{}));this.needsSwap=!0,super.render(_e,rt,nt,ot,ct),s.renderer.blit(rt.texture,o.lastFrame,{})}},update(){if(!o.lastFrame)return void console.error("lastFrame render target undefined");let _e=1/(Math.max(s.renderer.frameCount,0)+1);this.passObject.weights1.set(_e,_e,_e,_e),_e=1-_e,this.passObject.weights2.set(_e,_e,_e,_e),this.passObject.blendTexture=o.lastFrame.texture,this.passObject.material.uniformsNeedUpdate=!0}})]}isConverged(s=!1){var o;return(((o=this._viewer)===null||o===void 0?void 0:o.renderer.frameCount)||0)>=this.maxFrameCount-1+(s?1:0)}updateShaderProperties(s){var o,a;return s.uniforms.tLastFrame&&(s.uniforms.tLastFrame.value=(a=(o=this.lastFrame)===null||o===void 0?void 0:o.texture)!==null&&a!==void 0?a:void 0),this}postFrameConvergedRecordingDelta(s="CanvasRecorder"){const o=this._viewer.getPluginByType(s);return o&&o.isRecording()&&o.convergeMode?this.isConverged(!0)?1/o.videoFrameRate:0:-1}}_p.PluginType="Progressive",ZT([Yr(),yo("Frame count")],_p.prototype,"maxFrameCount",void 0),ZT([Yr(),ds("Jitter")],_p.prototype,"jitter",void 0);var Iv="varying vec2 vUv;void main(){vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}",e1=`#ifndef BASIC_CAMERA_HELPERS
#define BASIC_CAMERA_HELPERS 
uniform vec2 cameraNearFar;uniform vec3 cameraPositionWorld;uniform mat4 projection;
#ifndef THREE_PACKING_INCLUDED
#define THREE_PACKING_INCLUDED 
#include <packing>
#endif
float linstep(float edge0,float edge1,float value){return clamp((value-edge0)/(edge1-edge0),0.,1.);}float depthToViewZ(const in float depth){return(depth>0.999)?-cameraNearFar.y*1000.:-mix(cameraNearFar.x,cameraNearFar.y,depth);}float viewZToDepth(const in float viewZ){return linstep(-cameraNearFar.x,-cameraNearFar.y,viewZ);}vec4 viewToScreen3(const in vec3 pos){vec4 projected=projection*vec4(pos,1.);projected.z=pos.z;projected.w=1./projected.w;projected.xyz*=projected.w;projected.xy=0.5+0.5*projected.xy;return projected;}vec3 screenToView(const in vec2 uv,const in float viewZ){vec2 uv_=2.*uv-1.;float xe=-(uv_.x+projection[2][0])*viewZ/projection[0][0];float ye=-(uv_.y+projection[2][1])*viewZ/projection[1][1];return vec3(xe,ye,viewZ);}
#endif
`,zx=`#ifndef BASIC_HELPERS
#define BASIC_HELPERS 
float saturate2(float v,float mx){return max(0.,min(mx,v));}vec3 saturate2(vec3 v){return max(vec3(0.),min(vec3(1.),v));}
#endif
`,Pv=`#ifndef BASIC_RANDOM_HELPERS
#define BASIC_RANDOM_HELPERS 
uniform float frameCount;float random(float n){return fract(sin(n)*43758.5453123);}float random2(vec2 n,float x){n+=x;return fract(sin(dot(n.xy,vec2(12.9898,78.233)))*43758.5453);}float random3(vec3 v){v=fract(v*443.8975);v+=dot(v,v.yzx+19.19);return fract((v.x+v.y)*v.z);}float interleavedGradientNoise(const in vec2 fragCoord,const in float seed){vec3 magic=vec3(0.06711056,0.00583715,52.9829189);return fract(magic.z*fract(dot(fragCoord.xy+seed*vec2(2.083,4.867),magic.xy)));}vec3 hash3(vec2 p){vec3 q=vec3(dot(p,vec2(127.1,311.7)),dot(p,vec2(269.5,183.3)),dot(p,vec2(419.2,371.9)));return fract(sin(q)*43758.5453);}
#endif
`,ZS=`#define PI  3.141592653589793
mat3 GetTangentBasis(vec3 TangentZ){vec3 up=vec3(0.,0.,1.);vec3 TangentX=normalize(cross(dot(TangentZ,up)<0.8?up:vec3(1.,0.,0.),TangentZ));vec3 TangentY=cross(TangentZ,TangentX);return mat3(TangentX,TangentY,TangentZ);}vec4 CosineSampleHemisphere(vec2 E){float Phi=2.*PI*E.x;float CosTheta=sqrt(E.y);float SinTheta=sqrt(1.-CosTheta*CosTheta);vec3 H;H.x=SinTheta*cos(Phi);H.y=SinTheta*sin(Phi);H.z=CosTheta;float PDF=CosTheta*(1./PI);return vec4(H,PDF);}vec4 UniformSampleHemisphere(vec2 E){float Phi=2.*PI*E.x;float CosTheta=E.y;float SinTheta=sqrt(1.-CosTheta*CosTheta);vec3 H;H.x=SinTheta*cos(Phi);H.y=SinTheta*sin(Phi);H.z=CosTheta;float PDF=1./(2.*PI);return vec4(H,PDF);}vec2 UniformSampleDiskConcentric(vec2 E){vec2 p=2.*E-1.;float Radius;float Phi;if(abs(p.x)>abs(p.y)){Radius=p.x;Phi=(PI/4.)*(p.y/p.x);}else{Radius=p.y;Phi=(PI/2.)-(PI/4.)*(p.x/p.y);}return vec2(Radius*cos(Phi),Radius*sin(Phi));}vec2 UniformSampleDiskConcentricApprox(vec2 E){vec2 sf=E*sqrt(2.)-sqrt(0.5);vec2 sq=sf*sf;float root=sqrt(2.*max(sq.x,sq.y)-min(sq.x,sq.y));if(sq.x>sq.y){sf.x=sf.x>0.?root:-root;}else{sf.y=sf.y>0.?root:-root;}return sf;}`,Vx=`#ifndef SSRT_PARS_SNIP
#define SSRT_PARS_SNIP 
#define pow2(a)a*a
float getDepth2(const in vec2 uv,const in float lod){float viewDepth=getDepth(uv);return depthToViewZ(viewDepth);}
#define LOD_DEPTH  1.0
#define LOD_COLOR  5.0
void _traceRay(in vec4 ray_origin,in vec4 ray_dir,in float tolerance,inout vec3 state,in int loopMax,in float iStepCount){vec4 sample_uv;float d,hit;float dLod=0.;
#pragma unroll_loop_start
for(int i=0;i<8;i++){if(UNROLLED_LOOP_INDEX<loopMax){sample_uv=ray_origin+ray_dir*state.y;d=getDepth2(sample_uv.xy,dLod);d=sample_uv.z/sample_uv.w-d;if(abs(d+tolerance)<tolerance){hit=clamp(state.x/(state.x-d),0.,1.)-1.;hit=(state.y+hit*iStepCount);state.z=min(state.z,hit);}state.x=d;state.y+=1.*iStepCount;}}
#pragma unroll_loop_end
}vec3 traceRay(in vec3 ray_origin_view,in vec3 ray_dir_view,in float tolerance,inout vec3 state,in int _STEP_COUNT){vec4 sample_uv;vec4 ray_origin=viewToScreen3(ray_origin_view);vec3 ray_end_view=ray_origin_view+ray_dir_view;vec4 ray_dir=viewToScreen3(ray_end_view);vec2 clamp_end=clamp(ray_dir.xy,vec2(0.),vec2(1.));vec2 correction=abs(ray_dir.xy-clamp_end);correction=(step(0.01,correction)*correction/(abs(clamp_end-ray_origin.xy)+0.01))+1.;correction.x=1./min(max(correction.y,correction.x),10.);ray_dir=ray_dir-ray_origin;ray_dir.xyw*=correction.x;float iStepCount=1./float(_STEP_COUNT);tolerance*=0.125;_traceRay(ray_origin,ray_dir,tolerance,state,_STEP_COUNT,iStepCount);if(_STEP_COUNT>8&&state.z>0.98)_traceRay(ray_origin,ray_dir,tolerance,state,_STEP_COUNT-8,iStepCount);if(_STEP_COUNT>15&&state.z>0.98)_traceRay(ray_origin,ray_dir,tolerance,state,_STEP_COUNT-16,iStepCount);if(_STEP_COUNT>23&&state.z>0.98)_traceRay(ray_origin,ray_dir,tolerance,state,_STEP_COUNT-16,iStepCount);sample_uv=ray_origin+ray_dir*state.z;sample_uv.z/=sample_uv.w;state.z=state.z<0.999?state.z:9999999.;return sample_uv.xyz;}
#endif
`,eM=`uniform float objectRadius;uniform float radius;uniform float tolerance;uniform bool autoRadius;
#ifndef D_sceneBoundingRadius
#define D_sceneBoundingRadius 
uniform float sceneBoundingRadius;
#endif
vec3 ComputeReflectionL(vec3 N,vec2 E,vec3 V,float rough){float rough4=rough*rough*rough*rough;float phi=2.*PI*E.x;float cos_theta=pow(max(E.y,0.000001),rough4/(2.-rough4));float sin_theta=sqrt(max(0.,1.-cos_theta*cos_theta));vec3 half_vec=vec3(sin_theta*cos(phi),sin_theta*sin(phi),cos_theta);vec3 tangentX=normalize(cross(abs(N.z)<0.999?vec3(0.,0.,1.):vec3(1.,0.,0.),N));vec3 tangentY=cross(N,tangentX);half_vec=half_vec.x*tangentX+half_vec.y*tangentY+half_vec.z*N;vec3 ray_dir=(2.*dot(V,half_vec))*half_vec-V;return ray_dir;}vec2 GetRandomE(float seed){vec2 rand_e;rand_e.x=interleavedGradientNoise(gl_FragCoord.xy,frameCount*117.);rand_e.y=fract(rand_e.x*38.65435);rand_e.y=mix(rand_e.y,1.,0.7);return rand_e;}vec4 calculateSSR(in float seed,in vec3 screenPos,in vec3 normal,in float radiusFactor,in float roughness){vec3 viewPos=screenToView(screenPos.xy,screenPos.z);normal=normalize(normal);vec2 E=GetRandomE(seed);vec3 L=ComputeReflectionL(normal,E,-normalize(viewPos),roughness);L=normalize(L);float cameraDist=length(cameraPositionWorld);float rayLen=autoRadius?mix((cameraDist+objectRadius*sceneBoundingRadius)+viewPos.z,-viewPos.z-max(0.,cameraDist-objectRadius*sceneBoundingRadius),L.z*0.5+0.5):objectRadius*sceneBoundingRadius;rayLen*=radiusFactor;float r=interleavedGradientNoise(gl_FragCoord.xy,frameCount+seed);rayLen=max(rayLen,0.001);int steps=SSR_STEP_COUNT/(frameCount<float(SSR_LOW_QUALITY_FRAMES)?2:1);vec3 state=vec3(0.,(r+0.5)/float(steps),2.);viewPos+=normal*max(-0.0001*viewPos.z,0.001);vec3 screenHitP=traceRay(viewPos,L*rayLen,tolerance*rayLen,state,steps);if(state.z<0.99){vec3 hitColor=(tLastFrameTexelToLinear(texture2D(tLastFrame,screenHitP.xy))).rgb;float ssrWeight=1.;return vec4(hitColor*ssrWeight,1.);}return vec4(0.);}`,Gx=`#ifndef SIMPLE_CAMERA_HELPERS
#define SIMPLE_CAMERA_HELPERS 
#ifndef USE_TRANSMISSION
uniform mat4 projectionMatrix;
#endif
vec3 viewToScreen(const in vec3 pos){vec4 projected=projectionMatrix*vec4(pos,1.);return vec3(0.5+0.5*projected.xy/projected.w,projected.w);}
#endif
`,Dv=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let Dm=class extends Ru{constructor(tt,s,o,a=!0){super({vertexShader:Iv,fragmentShader:`

varying vec2 vUv;

${zx}
${e1}
${Pv}
${ZS}
${o}

${Vx}

${eM}

uniform sampler2D tLastThis;void main(){vec4 texel=tDiffuseTexelToLinear(texture2D(tDiffuse,vUv));vec4 lastAO=tLastThisTexelToLinear(texture2D(tLastThis,vUv));float depth;vec3 normal;getDepthNormal(vUv,depth,normal);if(depth>=0.999){discard;}float viewZ=depthToViewZ(depth);vec3 screenPos=vec3(vUv.x,vUv.y,viewZ);vec3 viewPos=screenToView(screenPos.xy,screenPos.z);viewPos.z=viewZ/viewPos.z;vec4 ao=vec4(0.);ao+=calculateSSR(8.,screenPos,normal,1.,0.1);ao.rgb=min(vec3(3.),ao.rgb);ao.rgb=max(vec3(0.),ao.rgb);if(frameCount<1.){gl_FragColor=ao;return;}if(ao.a<0.01){gl_FragColor.rgb=lastAO.rgb;gl_FragColor.a=(((lastAO.a)*frameCount)/(frameCount+1.));}else{gl_FragColor=((ao+(lastAO)*frameCount)/(frameCount+1.));}
#include <encodings_fragment>
}


            `,uniforms:{tLastThis:{value:null},tDiffuse:{value:null},tNormalDepth:{value:null},tLastFrame:{value:null},opacity:{value:1},intensity:{value:0},boost:{value:new et.Pa4(0,0,0)},objectRadius:{value:0},autoRadius:{value:!1},power:{value:0},maskFrontFactor:{value:-.1},tolerance:{value:0},frameCount:{value:0},projection:{value:new et.yGw},cameraPositionWorld:{value:new et.Pa4},cameraNearFar:{value:new et.FM8(.1,1e3)},sceneBoundingRadius:{value:0}},defines:{PERSPECTIVE_CAMERA:1,SSR_STEP_COUNT:16,SSR_LOW_QUALITY_FRAMES:2,SSR_MASK_FRONT_RAYS:!0,SSR_INLINE:a?"1":"0",SSR_NON_PHYSICAL:"0"}},"tDiffuse","tLastThis","tLastFrame"),this.uiConfig=void 0,this.materialExtension={shaderExtender:(_e,rt,nt)=>{if(!_e.defines.SSR_ENABLED)return;const ot="#glMarker beforeModulation";_e.fragmentShader=_e.fragmentShader.replace(ot,`

            
            #if defined(SSR_ENABLED) && SSR_ENABLED > 0
vec3 screenPos=viewToScreen(geometry.position);vec4 ssrColor=vec4(0,0,0,0);float alphaModifier=1.-clamp(material.roughness*.3,0.,1.);alphaModifier*=ssrIntensity;
#if defined(SSR_MASK_FRONT_RAYS) && SSR_MASK_FRONT_RAYS > 0
alphaModifier*=clamp(-4.*dot(geometry.viewDir,normal)+(4.+ssrMaskFrontFactor),0.,1.);
#endif
#ifdef USE_TRANSMISSION
alphaModifier*=1.-transmission;
#endif
float vignette=1.;if(true){float fadeStrength=0.1;float dist=min(min(1.-screenPos.x,1.-screenPos.y),min(screenPos.x,screenPos.y));float fade=dist*dist/(fadeStrength+0.001);fade=clamp(fade,0.,1.);fade=pow(fade,0.3);vignette=fade;}alphaModifier*=vignette;vec3 specularColor=EnvironmentBRDF(geometry.normal,geometry.viewDir,material.specularColor.rgb,material.specularF90,material.roughness);if(length(specularColor.rgb)*alphaModifier>0.01&&roughnessFactor<0.9){
#if defined(SSR_INLINE) && SSR_INLINE > 0
ssrColor=calculateSSR(8.,vec3(screenPos.xy,geometry.position.z),geometry.normal,1.,material.roughness);
#else
ssrColor=tSSRMapTexelToLinear(texture2D(tSSRMap,screenPos.xy));
#endif 
}ssrColor.rgb*=ssrBoost;ssrColor.a*=alphaModifier;ssrColor.a=min(ssrColor.a,1.);
#if defined(SSR_NON_PHYSICAL) && SSR_NON_PHYSICAL > 0
diffuseColor.a=max(ssrColor.a,diffuseColor.a*diffuseColor.a);reflectedLight.indirectSpecular=mix(reflectedLight.indirectSpecular,saturate(diffuseColor.rgb*ssrColor.rgb),1.);reflectedLight.indirectDiffuse=diffuseColor.rgb*(1.-ssrColor.a);reflectedLight.directDiffuse=vec3(0.);reflectedLight.directSpecular=vec3(0.);
#else
reflectedLight.indirectSpecular=mix(reflectedLight.indirectSpecular,saturate(specularColor.rgb*ssrColor.rgb),ssrColor.a);
#endif
#endif

            
            // reflectedLight.directDiffuse = vec3(0.);
            // reflectedLight.indirectDiffuse = vec3(0.);
            // reflectedLight.directSpecular = vec3(0.);
            // reflectedLight.indirectSpecular = vec3(0.);
            
            
${ot}`)},onObjectRender:(_e,rt,nt)=>{var ot,ct,pt,ht;let _t=this.enabled&&nt.userData.screenSpaceRendering!==!1&&!(!((ot=rt.materialObject.userData)===null||ot===void 0)&&ot.ssreflDisabled)?1:0;rt.materialObject.defines.SSR_ENABLED!==_t&&(rt.materialObject.defines.SSR_ENABLED=_t,rt.materialObject.needsUpdate=!0),_t=this.material.defines.SSR_STEP_COUNT,rt.materialObject.defines.SSR_STEP_COUNT!==_t&&(rt.materialObject.defines.SSR_STEP_COUNT=_t,rt.materialObject.needsUpdate=!0),_t=this.material.defines.SSR_LOW_QUALITY_FRAMES,rt.materialObject.defines.SSR_LOW_QUALITY_FRAMES!==_t&&(rt.materialObject.defines.SSR_LOW_QUALITY_FRAMES=_t,rt.materialObject.needsUpdate=!0),_t=this.material.defines.PERSPECTIVE_CAMERA,rt.materialObject.defines.PERSPECTIVE_CAMERA!==_t&&(rt.materialObject.defines.PERSPECTIVE_CAMERA=_t,rt.materialObject.needsUpdate=!0),_t=this.material.defines.SSR_INLINE,rt.materialObject.defines.SSR_INLINE!==_t&&(rt.materialObject.defines.SSR_INLINE=_t,rt.materialObject.needsUpdate=!0),_t=this.material.defines.SSR_MASK_FRONT_RAYS?1:0,rt.materialObject.defines.SSR_MASK_FRONT_RAYS!==_t&&(rt.materialObject.defines.SSR_MASK_FRONT_RAYS=_t,rt.materialObject.needsUpdate=!0),_t=!((ct=rt.materialObject.userData)===null||ct===void 0)&&ct.ssreflNonPhysical?"1":"0",rt.materialObject.defines.SSR_NON_PHYSICAL!==_t&&(rt.materialObject.defines.SSR_NON_PHYSICAL=_t,rt.materialObject.needsUpdate=!0),_t=(ht=(pt=this._target)===null||pt===void 0?void 0:pt.texture)!==null&&ht!==void 0?ht:null,this.materialExtension.extraUniforms.tSSRMap.value!==_t&&(this.materialExtension.extraUniforms.tSSRMap.value=_t,rt.materialObject.needsUpdate=!0)},parsFragmentSnippet:_e=>{var rt;return`
uniform float ssrPower;
uniform float ssrIntensity;
uniform float ssrMaskFrontFactor;
uniform vec3 ssrBoost;
uniform sampler2D tSSRMap;
uniform sampler2D tLastFrame;
`+sn("tSSRMap",(rt=this._target)===null||rt===void 0?void 0:rt.texture,_e.capabilities.isWebGL2)+sn("tLastFrame",this.materialExtension.extraUniforms.tLastFrame.value,_e.capabilities.isWebGL2)+(this._inline?`
#if 1
// #if SSR_INLINE
    ${zx}
    
    #define THREE_PACKING_INCLUDED
    ${e1}
    
    ${Pv}
    ${ZS}
    ${Zv}
    
    ${Vx}
    
    ${eM}
// #endif // SSR_INLINE
#endif
`:"")+`

${Gx}

        `},extraUniforms:{tSSRMap:{value:null},ssrPower:this.material.uniforms.power,ssrIntensity:this.material.uniforms.intensity,ssrMaskFrontFactor:this.material.uniforms.maskFrontFactor,ssrBoost:this.material.uniforms.boost,tNormalDepth:this.material.uniforms.tNormalDepth,tLastFrame:this.material.uniforms.tLastFrame,objectRadius:this.material.uniforms.objectRadius,autoRadius:this.material.uniforms.autoRadius,tolerance:this.material.uniforms.tolerance,frameCount:this.material.uniforms.frameCount,projection:this.material.uniforms.projection,cameraPositionWorld:this.material.uniforms.cameraPositionWorld,cameraNearFar:this.material.uniforms.cameraNearFar,sceneBoundingRadius:this.material.uniforms.sceneBoundingRadius},computeCacheKey:_e=>{var rt,nt;return this.enabled?"1":"0"+((nt=(rt=this._target)===null||rt===void 0?void 0:rt.texture)===null||nt===void 0?void 0:nt.encoding)},isCompatible:_e=>{var rt;return!(!((rt=_e.materialObject.userData)===null||rt===void 0)&&rt.ssreflDisabled)&&_e.isMeshStandardMaterial2}},this.intensity=1,this.boost=new et.Pa4(1,1,1),this.objectRadius=1,this.autoRadius=!0,this.power=1.1,this.tolerance=.5,this.stepCount=16,this.lowQualityFrames=0,this.maskFrontRays=!0,this.maskFrontFactor=-.2,this._renderer=tt,this._target=s,this.needsSwap=!1,this._inline=a}render(tt,s,o,a,_e){if(this._inline)this.needsSwap=!1;else{if(!this._target)throw"Target must be set when inline = false";this._renderer.blit(this._target.texture,s,{}),this.uniforms.tLastThis.value=s.texture,super.render(tt,this._target,o,a,_e),this.needsSwap=!1}}};Dv([gs("Intensity",[0,4]),Yr(),Ar()],Dm.prototype,"intensity",void 0),Dv([ou("Boost"),Yr(),Ar()],Dm.prototype,"boost",void 0),Dv([gs("Object Radius",[.01,2]),Yr(),Ar()],Dm.prototype,"objectRadius",void 0),Dv([ds("Auto radius"),Yr(),Ar()],Dm.prototype,"autoRadius",void 0),Dv([gs("Power",[0,3]),Yr(),Ar()],Dm.prototype,"power",void 0),Dv([gs("Tolerance",[.1,5]),Yr(),Ar()],Dm.prototype,"tolerance",void 0),Dv([gs("Step count",[1,32],1),Yr(),jr("SSR_STEP_COUNT")],Dm.prototype,"stepCount",void 0),Dv([gs("Low Quality Frames",[0,4],1),Yr(),jr("SSR_LOW_QUALITY_FRAMES")],Dm.prototype,"lowQualityFrames",void 0),Dv([ds("Ignore front rays"),Yr(),jr("SSR_MASK_FRONT_RAYS")],Dm.prototype,"maskFrontRays",void 0),Dv([gs("Mask front rays factor",[-1,1],.01,tt=>({hidden:()=>!tt.maskFrontRays})),Yr(),Ar()],Dm.prototype,"maskFrontFactor",void 0),Dm=Dv([Ao("Screen Space Reflections")],Dm);class Qx extends Zw{constructor(){super(),this.dependencies=[os,Dl,_p],this.inlineSSR=!0,this.setDirty=this.setDirty.bind(this)}get ssrTarget(){return this._ssrTarget}get enabled(){var s,o;return((o=(s=this.passes.ssr)===null||s===void 0?void 0:s.passObject)===null||o===void 0?void 0:o.enabled)||!1}set enabled(s){var o;!((o=this.passes.ssr)===null||o===void 0)&&o.passObject&&(this.passes.ssr.passObject.enabled=s)}async onAdded(s){var o,a;s.getPluginByType("Ground")&&console.error("GroundPlugin must be added after SSRPlugin"),await super.onAdded(s),(a=(o=this.uiConfig).uiRefresh)===null||a===void 0||a.call(o,"postFrame",!0)}createPasses(s){var o,a;return this._ssrTarget=this.inlineSSR?void 0:s.renderer.createTarget({sizeMultiplier:1}),[YA(s,{passId:"ssr",after:["gbuffer"],before:["render"],required:["render","gbuffer","progressive"],passObject:new Dm(s.renderer,this._ssrTarget,(a=(o=s.getPlugin(Dl))===null||o===void 0?void 0:o.getUnpackSnippet())!==null&&a!==void 0?a:"",this.inlineSSR)},()=>[s.getPlugin(Dl),s.getPlugin(_p),s.scene.activeCamera,s.renderer,s.scene])]}async onRemove(s){return this._ssrTarget&&s.renderer.disposeTarget(this._ssrTarget),super.onRemove(s)}setDirty(){var s;(s=this._viewer)===null||s===void 0||s.setDirty()}get uiConfig(){var s,o,a,_e,rt;const nt=(a=(o=(s=this.passes.ssr)===null||s===void 0?void 0:s.passObject)===null||o===void 0?void 0:o.uiConfig)!==null&&a!==void 0?a:{};return(rt=(_e=nt.children)===null||_e===void 0?void 0:_e.map(ot=>er(ot)))===null||rt===void 0||rt.flat(2).forEach(ot=>ot&&(ot.onChange=this.setDirty)),nt}}Qx.PluginType="SSReflection";var tM=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};class Hx extends Ru{constructor(s,o,a="rgba"){super({vertexShader:ut.vertexShader,fragmentShader:o+`uniform vec2 tDiffuseSize;uniform vec2 bilDirection;varying vec2 vUv;uniform bool smoothEnabled;uniform float edgeSharpness;vec4 bilaterialAO(){vec4 color=clamp((texture2D(tDiffuse,vUv.xy)).B_SRC_ACCESSOR,0.,5.);if(!smoothEnabled)return color;float depth;vec3 normal;getDepthNormal(vUv.xy,depth,normal);float gaussianWeights[4];gaussianWeights[0]=0.153170;gaussianWeights[1]=0.144893;gaussianWeights[2]=0.122649;gaussianWeights[3]=0.092902;float Z=gaussianWeights[0]+0.03;vec4 final_colour=Z*color;vec2 nuv;vec4 cc;float dp;vec3 nor;vec2 direction=bilDirection/tDiffuseSize.xy;
#pragma unroll_loop_start
for(int i=0;i<6;i++){direction*=-1.;nuv=vUv+2.*direction*float(UNROLLED_LOOP_INDEX/2+1);getDepthNormal(nuv,dp,nor);if(dp<0.999){float normalCloseness=dot(normal,nor);normalCloseness*=normalCloseness;float normalError=(1.-normalCloseness)*8.;float normalWeight=max((1.-normalError*edgeSharpness),0.00);float depthWeight=max(0.,1.-edgeSharpness*4000.*abs(depth-dp));float kernelWeight=gaussianWeights[UNROLLED_LOOP_INDEX/2]+0.03;float bilateralWeight=kernelWeight*depthWeight*normalWeight;Z+=bilateralWeight;cc=clamp((texture2D(tDiffuse,nuv)).B_SRC_ACCESSOR,0.,5.);final_colour+=bilateralWeight*cc;}}
#pragma unroll_loop_end
final_colour/=Z;return final_colour;}void main(){vec4 ao=clamp(bilaterialAO(),vec4(0.),vec4(1.));gl_FragColor=ao;}`,uniforms:{bilDirection:{value:new et.FM8(1,0)},tNormalDepth:{value:null},tDiffuse:{value:s.texture},tDiffuseSize:{value:new et.FM8}},defines:{B_SRC_ACCESSOR:a}},"tDiffuse"),this.smoothEnabled=!0,this.edgeSharpness=.1,this._target=s,this.clear=!1,this.needsSwap=!1}render(s,o,a,_e,rt){var nt,ot,ct,pt;this.enabled&&(this.uniforms.bilDirection.value.set(1,0),this.uniforms.tDiffuse.value=this._target.texture,this.uniforms.tDiffuseSize.value.set(((nt=this.uniforms.tDiffuse.value)===null||nt===void 0?void 0:nt.image.width)||0,((ot=this.uniforms.tDiffuse.value)===null||ot===void 0?void 0:ot.image.height)||0),super.render(s,o,this._target,_e,rt),this.uniforms.bilDirection.value.set(0,1),this.uniforms.tDiffuse.value=o.texture,this.uniforms.tDiffuseSize.value.set(((ct=this.uniforms.tDiffuse.value)===null||ct===void 0?void 0:ct.image.width)||0,((pt=this.uniforms.tDiffuse.value)===null||pt===void 0?void 0:pt.image.height)||0),super.render(s,this._target,o,_e,rt))}}tM([Yr(),Ar()],Hx.prototype,"smoothEnabled",void 0),tM([Yr(),Ar()],Hx.prototype,"edgeSharpness",void 0);var rM=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};class eC extends Ru{constructor(s,o,a){super({defines:{LINEAR_DEPTH:1,NUM_SAMPLES:11,NUM_SPIRAL_TURNS:3,DEPTH_NORMAL_TEXTURE:1,DEPTH_PACKING_MODE:2,PERSPECTIVE_CAMERA:1},uniforms:{tLastThis:{value:null},tNormalDepth:{value:null},screenSize:{value:new et.FM8(512,512)},saoData:{value:new et.Ltg},frameCount:{value:0},cameraNearFar:{value:new et.FM8(.1,1e3)},projection:{value:new et.yGw},saoBiasEpsilon:{value:new et.Pa4(1,1,1)}},vertexShader:Iv,fragmentShader:`

${Pv}

${a}

#include <common>
#include <packing>
varying vec2 vUv;uniform vec2 cameraNearFar;uniform mat4 projection;uniform sampler2D tLastThis;uniform vec4 saoData;uniform vec3 saoBiasEpsilon;uniform vec2 screenSize;const float INV_NUM_SAMPLES=1./float(NUM_SAMPLES);float getViewZFromNDCZ(const in float depth){
#if PERSPECTIVE_CAMERA == 1
return perspectiveDepthToViewZ(depth,cameraNearFar.x,cameraNearFar.y);
#else
return orthographicDepthToViewZ(depth,cameraNearFar.x,cameraNearFar.y);
#endif
}vec3 packFloatToRGB(const in float x){const vec3 code=vec3(1.,255.,65025.);vec3 pack=vec3(code*x);pack.gb=fract(pack.gb);pack.rg-=pack.gb*(1./256.);return pack;}vec3 getViewPositionFromViewZ(const in vec2 uv,const in float viewDepth){vec2 uv_=2.*uv-1.;float xe=-(uv_.x+projection[2][0])*viewDepth/projection[0][0];float ye=-(uv_.y+projection[2][1])*viewDepth/projection[1][1];return vec3(xe,ye,viewDepth);}float decodeDepth(const in vec2 uv){vec4 uncodedDepth;
#if DEPTH_PACKING_MODE == 2
uncodedDepth=texture2D(tNormalDepth,uv);
#else
uncodedDepth=texture2D(tDepth,uv);
#endif
#if DEPTH_PACKING_MODE == 0
return uncodedDepth.x;
#elif DEPTH_PACKING_MODE == 1
#if LINEAR_DEPTH == 1
return pow2(unpackRGBAToDepth(uncodedDepth));
#else
return unpackRGBAToDepth(uncodedDepth);
#endif
#else
return pow2(unpack16(uncodedDepth.xy));
#endif
}vec3 getPositionFromOffset(const in vec2 uv,const in vec2 offset,const in float screenSpaceRadius){vec2 uvOffset=uv+floor(screenSpaceRadius*offset)/screenSize;float d=decodeDepth(uvOffset);
#if LINEAR_DEPTH == 0
float centerViewZ=getViewZFromNDCZ(d);return getViewPositionFromViewZ(uvOffset,centerViewZ);
#else
d=mix(-cameraNearFar.x,-cameraNearFar.y,d);return getViewPositionFromViewZ(uvOffset,d);
#endif
}float getOcclusion(const in vec2 uv,const in int id,const in float randomAngle,const in float occlusionSphereRadius,const in vec3 centerPosition,const in vec3 centerNormal){float screenSpaceRadius=(float(id)+mod(randomAngle,1.)+0.5)*INV_NUM_SAMPLES;float angle=screenSpaceRadius*(float(NUM_SPIRAL_TURNS)*6.28)+randomAngle;screenSpaceRadius=(screenSpaceRadius*occlusionSphereRadius);vec2 offset=vec2(cos(angle),sin(angle));vec3 samplePosition=getPositionFromOffset(uv,offset,screenSpaceRadius);vec3 direction=samplePosition-centerPosition;float d2=dot(direction,direction);float ao=max((dot(centerNormal,direction)+centerPosition.z*saoBiasEpsilon.x)/(saoBiasEpsilon.z*d2+saoBiasEpsilon.y),0.);return ao;}void main(){float centerDepth;vec3 centerNormal;getDepthNormal(vUv,centerDepth,centerNormal);
#if LINEAR_DEPTH == 0
float centerViewZ=getViewZFromNDCZ(centerDepth);
#else
float centerViewZ=mix(-cameraNearFar.x,-cameraNearFar.y,centerDepth);
#endif
vec3 centerPosition=getViewPositionFromViewZ(vUv,centerViewZ);float occlusionSphereScreenRadius=200.*saoData.z/(-centerPosition.z);float randomAngle=6.2*random3(vec3(vUv,frameCount*0.1));float sum=0.;sum+=getOcclusion(vUv,0,randomAngle,occlusionSphereScreenRadius,centerPosition,centerNormal);
#if NUM_SAMPLES > 1
sum+=getOcclusion(vUv,1,randomAngle,occlusionSphereScreenRadius,centerPosition,centerNormal);
#endif
#if NUM_SAMPLES > 2
sum+=getOcclusion(vUv,2,randomAngle,occlusionSphereScreenRadius,centerPosition,centerNormal);
#endif
#if NUM_SAMPLES > 3
sum+=getOcclusion(vUv,3,randomAngle,occlusionSphereScreenRadius,centerPosition,centerNormal);
#endif
#if NUM_SAMPLES > 4
sum+=getOcclusion(vUv,4,randomAngle,occlusionSphereScreenRadius,centerPosition,centerNormal);
#endif
#if NUM_SAMPLES > 5
sum+=getOcclusion(vUv,5,randomAngle,occlusionSphereScreenRadius,centerPosition,centerNormal);
#endif
#if NUM_SAMPLES > 6
sum+=getOcclusion(vUv,6,randomAngle,occlusionSphereScreenRadius,centerPosition,centerNormal);
#endif
#if NUM_SAMPLES > 7
sum+=getOcclusion(vUv,7,randomAngle,occlusionSphereScreenRadius,centerPosition,centerNormal);
#endif
#if NUM_SAMPLES > 8
sum+=getOcclusion(vUv,8,randomAngle,occlusionSphereScreenRadius,centerPosition,centerNormal);
#endif
#if NUM_SAMPLES > 9
sum+=getOcclusion(vUv,9,randomAngle,occlusionSphereScreenRadius,centerPosition,centerNormal);
#endif
#if NUM_SAMPLES > 10
sum+=getOcclusion(vUv,10,randomAngle,occlusionSphereScreenRadius,centerPosition,centerNormal);
#endif
float aoValue=sum*saoData.y*INV_NUM_SAMPLES;aoValue=clamp(1.-max(aoValue,0.),0.,1.);gl_FragColor.gba=packFloatToRGB(centerDepth);gl_FragColor.r=(vec4(aoValue)).r;}

            `},"tDiffuse"),this.parameters={intensity:.25,occlusionWorldRadius:1,bias:.001,falloff:1,edgeSharpness:.3,blurEnabled:!0},this._smoothEnabled=!0,this.materialExtension={shaderExtender:(_e,rt,nt)=>{_e.defines.SSAO_ENABLED&&(_e.fragmentShader=_e.fragmentShader.replace("#include <aomap_fragment>",`#ifndef USE_TRANSMISSION
#if defined(SSAO_ENABLED) && SSAO_ENABLED > 0
float ambientOcclusion=tSSAOMapTexelToLinear(texture2D(tSSAOMap,viewToScreen(vViewPosition.xyz).xy)).r;reflectedLight.indirectDiffuse*=ambientOcclusion;
#if defined( USE_ENVMAP )
float dotNV=saturate(dot(geometry.normal,geometry.viewDir));reflectedLight.indirectSpecular*=computeSpecularOcclusion(dotNV,ambientOcclusion,material.roughness);
#endif
#endif
#endif
`))},onObjectRender:(_e,rt,nt)=>{var ot,ct;this.materialExtension.extraUniforms.tSSAOMap.value=(ot=this._target)===null||ot===void 0?void 0:ot.texture;const pt=rt.materialObject,ht=!pt.transparent&&pt.transmission<.001;let _t=this.enabled&&ht&&nt.userData.screenSpaceRendering!==!1&&!(!((ct=rt.materialObject.userData)===null||ct===void 0)&&ct.ssaoDisabled)?1:0;pt.defines.SSAO_ENABLED!==_t&&(pt.defines.SSAO_ENABLED=_t,pt.needsUpdate=!0),_t=this._target.texture,this.materialExtension.extraUniforms.tSSAOMap.value!==_t&&(this.materialExtension.extraUniforms.tSSAOMap.value=_t,pt.needsUpdate=!0)},parsFragmentSnippet:_e=>{var rt;return Wt`
             uniform sampler2D tSSAOMap;
             ${sn("tSSAOMap",(rt=this._target)===null||rt===void 0?void 0:rt.texture,_e.capabilities.isWebGL2)}
            ${Gx}
        `},extraUniforms:{tSSAOMap:{value:null}},computeCacheKey:_e=>{var rt,nt;return this.enabled?"1":"0"+((nt=(rt=this._target)===null||rt===void 0?void 0:rt.texture)===null||nt===void 0?void 0:nt.encoding)},isCompatible:_e=>{var rt;return!(!((rt=_e.materialObject.userData)===null||rt===void 0)&&rt.ssaoDisabled)&&_e.isMeshStandardMaterial2}},this._renderer=s,this._target=o,this.needsSwap=!1,this.clear=!0,this.bilateralPass=new Hx(this._target,a,"rrrr")}get smoothEnabled(){return this._smoothEnabled}set smoothEnabled(s){this._smoothEnabled=s,this.bilateralPass.enabled=s,this.bilateralPass.uniforms.smoothEnabled.value=s}render(s,o,a,_e,rt){this.enabled&&(this._updateParameters(),this._renderer.blit(this._target.texture,o,{}),this.uniforms.tLastThis.value=o.texture,super.render(s,this._target,a,_e,rt),this._smoothEnabled&&this.bilateralPass.render(s,o,a,_e,rt))}_updateParameters(){const s=this.material.uniforms.saoData.value;s.y=this.parameters.intensity,s.z=this.parameters.occlusionWorldRadius;const o=this.material.uniforms.saoBiasEpsilon.value;o.x=this.parameters.bias,o.y=.001,o.z=this.parameters.falloff}}rM([Yr()],eC.prototype,"bilateralPass",void 0),rM([Yr()],eC.prototype,"parameters",void 0);class qx extends Zw{constructor(){super(),this.dependencies=[os,Dl],this.setDirty=this.setDirty.bind(this)}get aoTarget(){return this._aoTarget}async onAdded(s){return s.getPluginByType("Ground")&&console.error("GroundPlugin must be added after SSAOPlugin"),super.onAdded(s)}createPasses(s){var o,a;return this._aoTarget=s.renderer.createTarget({sizeMultiplier:1}),[YA(s,{passId:"ssao",after:["gbuffer"],before:["render"],required:["render","gbuffer"],passObject:new eC(s.renderer,this._aoTarget,(a=(o=s.getPlugin(Dl))===null||o===void 0?void 0:o.getUnpackSnippet())!==null&&a!==void 0?a:""),update(){this.passObject.bilateralPass.updateShaderProperties([s.getPlugin(Dl)])}},()=>[s.getPlugin(Dl),s.scene.activeCamera,s.renderer])]}async onRemove(s){return s.renderer.disposeTarget(this._aoTarget),super.onRemove(s)}setDirty(){var s;(s=this._viewer)===null||s===void 0||s.setDirty()}get enabled(){var s,o;return((o=(s=this.passes.ssao)===null||s===void 0?void 0:s.passObject)===null||o===void 0?void 0:o.enabled)||!1}set enabled(s){var o;!((o=this.passes.ssao)===null||o===void 0)&&o.passObject&&(this.passes.ssao.passObject.enabled=s)}get uiConfig(){var s;if(this._uiConfig)return this._uiConfig;const o=this,a=o.passes.ssao.passObject;return this._uiConfig={type:"folder",label:"SS Ambient Occlusion",children:[{type:"checkbox",label:"Enabled",property:[a,"enabled"],onChange:o.setDirty},{type:"slider",label:"Intensity",bounds:[0,4],property:[a.parameters,"intensity"],onChange:o.setDirty},{type:"slider",label:"Radius",bounds:[.1,8],property:[a.parameters,"occlusionWorldRadius"],onChange:o.setDirty},{type:"slider",label:"Bias",bounds:[1e-5,.01],property:[a.parameters,"bias"],onChange:o.setDirty},{type:"slider",label:"Falloff",bounds:[.01,3],property:[a.parameters,"falloff"],onChange:o.setDirty},{type:"slider",label:"Num samples",stepSize:1,bounds:[1,11],property:[(s=a.material)===null||s===void 0?void 0:s.defines,"NUM_SAMPLES"],onChange:[()=>a.material.needsUpdate=!0,o.setDirty]},{type:"checkbox",property:[a.bilateralPass,"smoothEnabled"],onChange:o.setDirty},{type:"vec4",property:[a.bilateralPass,"edgeSharpness"],onChange:o.setDirty}]}}}qx.PluginType="SSAO";class nM{constructor(s){this._normalsCache={},this._renderer=s,this._scene=new et.xsS,this._mesh=new et.Kj0,this._mesh.frustumCulled=!1,this._scene.add(this._mesh),this._mesh.position.set(0,0,0),this._mesh.material=new iM}dispose(){this._mesh.material.dispose()}captureNormalMap(s,o,a=512){if(!s)throw"No geometry";if(s.userData._normalsCaptureMap)return!1;const _e=o==null?void 0:o.split(";").find(ct=>this._normalsCache[ct]);if(_e){const ct=this._normalsCache[_e];return o==null||o.split(";").forEach(pt=>pt!==_e&&(this._normalsCache[pt]=ct)),ct.width!==a&&console.warn("last cacheKey normalMapRes mismatch, check model",a),s.userData._normalsCaptureMap=ct,!1}const rt=this._renderer.createTargetCustom({width:a,height:a},{minFilter:et.TyD,magFilter:et.TyD,generateMipmaps:!1,type:et.cLu},et.oAp);if(!rt)throw"Unable to create render target";o==null||o.split(";").forEach(ct=>this._normalsCache[ct]=rt),rt.addEventListener("dispose",()=>delete this._normalsCache[o]);const nt=new et._am(1e-4,100,rt);this._scene.add(nt);const ot=s.userData._normalsCaptureOffsets;return ot.center!==void 0&&this._mesh.material.uniforms.offsetCenter.value.copy(ot.center),ot.offsetMatrixInv!==void 0&&this._mesh.material.uniforms.offsetMatrixInv.value.copy(ot.offsetMatrixInv),ot.radius!==void 0&&(this._mesh.material.uniforms.radius.value=ot.radius),this._mesh.geometry=s,nt.update(this._renderer.rendererObject,this._scene),this._scene.remove(nt),this._mesh.geometry=void 0,s.userData._normalsCaptureMap=rt,!0}}class iM extends et.jyz{constructor(){super({vertexShader:"varying vec3 vNormal;varying vec3 vecPosition;uniform mat4 offsetMatrixInv;uniform vec3 offsetCenter;void main(){vNormal=normalize((offsetMatrixInv*vec4(normal,0.)).xyz);vecPosition=(modelMatrix*offsetMatrixInv*vec4(position-offsetCenter,1.)).xyz;gl_Position=projectionMatrix*modelViewMatrix*offsetMatrixInv*vec4(position-offsetCenter,1.);}",fragmentShader:"varying vec3 vNormal;varying vec3 vecPosition;uniform float radius;void main(){vec3 color=normalize(vNormal);color=color*0.5+0.5;gl_FragColor=vec4(color.x,color.y,color.z,length(vecPosition)/radius);}",side:et.ehD,clipping:!1,uniforms:{radius:{value:1},offsetMatrixInv:{value:new et.yGw().identity()},offsetCenter:{value:new et.Pa4}}})}}var yP=__webpackgi_require__(654);function sM(tt){const s=new et.Pa4(0,0,0),o=new et.Pa4(0,0,0),a=new et.Pa4(0,0,0),_e=new et.Pa4(0,0,0),rt=tt.getAttribute("position"),nt=tt.index;if(nt)for(let Et=Math.max(0,tt.drawRange.start),St=Math.min(nt.count,tt.drawRange.start+tt.drawRange.count)-1;Et<St/3;Et+=3){const Mt=nt.getX(Et),It=nt.getX(Et+1),Nt=nt.getX(Et+2);o.set(rt.getX(Mt),rt.getY(Mt),rt.getZ(Mt)),a.set(rt.getX(It),rt.getY(It),rt.getZ(It)),_e.set(rt.getX(Nt),rt.getY(Nt),rt.getZ(Nt)),a.sub(o),_e.sub(o),_e.cross(a),_e.normalize(),s.add(_e)}else for(let Et=0;Et<rt.count;Et+=3)o.set(rt.getX(Et),rt.getY(Et),rt.getZ(Et)),a.set(rt.getX(Et+1),rt.getY(Et+1),rt.getZ(Et+1)),_e.set(rt.getX(Et+2),rt.getY(Et+2),rt.getZ(Et+2)),a.sub(o),_e.sub(o),_e.cross(a),_e.normalize(),s.add(_e);s.normalize();let ot=!1,ct=0;for(;!ot;){const Et=ct/3,St=nt?nt.getX(Et):Et,Mt=nt?nt.getX(Et+1):Et+1;o.set(rt.getX(St),rt.getY(St),rt.getZ(St)),a.set(rt.getX(Mt),rt.getY(Mt),rt.getZ(Mt)),o.sub(a),o.normalize();const It=s.dot(o);Math.abs(It-1)>.001&&o.length()>.5&&(ot=!0),ct+=3}a.crossVectors(o,s),a.normalize(),o.crossVectors(s,a),o.normalize();const pt=new et.yGw;pt.elements[0]=o.x,pt.elements[1]=o.y,pt.elements[2]=o.z,pt.elements[3]=0,pt.elements[4]=s.x,pt.elements[5]=s.y,pt.elements[6]=s.z,pt.elements[7]=0,pt.elements[8]=a.x,pt.elements[9]=a.y,pt.elements[10]=a.z,pt.elements[11]=0,pt.elements[12]=0,pt.elements[13]=0,pt.elements[14]=0,pt.elements[15]=1,tt.computeBoundingSphere();const ht=tt.boundingSphere.radius,_t=new et.yGw().makeScale(ht,ht,ht);return pt.multiply(_t),pt}function oM(tt){const s=tt.getAttribute("position");if(s.count>0)return sM(tt);const o=new et.Pa4(0,0,0),a=new et.Pa4(0,0,0),_e=new et.Pa4(0,0,0),rt=tt.index,nt=[];if(rt)for(let _t=Math.max(0,tt.drawRange.start),Et=Math.min(rt.count,tt.drawRange.start+tt.drawRange.count)-1;_t<Et/3;_t+=3){const St=rt.getX(_t),Mt=rt.getX(_t+1),It=rt.getX(_t+2);o.set(s.getX(St),s.getY(St),s.getZ(St)),a.set(s.getX(Mt),s.getY(Mt),s.getZ(Mt)),_e.set(s.getX(It),s.getY(It),s.getZ(It)),nt.push(o.toArray(),a.toArray(),_e.toArray())}else for(let _t=0;_t<s.count;_t++)o.set(s.getX(_t),s.getY(_t),s.getZ(_t)),nt.push(o.toArray());const ot=(0,yP.getEigenVectors)(nt),ct=new et.yGw;ct.elements[0]=ot[0].vector[0],ct.elements[1]=ot[0].vector[1],ct.elements[2]=ot[0].vector[2],ct.elements[3]=0,ct.elements[4]=ot[1].vector[0],ct.elements[5]=ot[1].vector[1],ct.elements[6]=ot[1].vector[2],ct.elements[7]=0,ct.elements[8]=ot[2].vector[0],ct.elements[9]=ot[2].vector[1],ct.elements[10]=ot[2].vector[2],ct.elements[11]=0,ct.elements[12]=0,ct.elements[13]=0,ct.elements[14]=0,ct.elements[15]=1,console.log(ct.determinant()),tt.computeBoundingSphere();const pt=tt.boundingSphere.radius,ht=new et.yGw().makeScale(pt,pt,pt);return ct.multiply(ht),ct}const aM={...N_,color:new ys(1,1,1),envMapIntensity:1,envMapRotation:0,dispersion:.012,squashFactor:.98,geometryFactor:.5,gammaFactor:1,absorptionFactor:1,reflectivity:.5,refractiveIndex:2.4,boostFactors:new et.Pa4(.892,.892,.98595025),envMap:null,wireframe:!1,wireframeLinewidth:0,skinning:!1,transmission:0,morphTargets:!1,morphNormals:!1,rayBounces:1,diamondOrientedEnvMap:0};var gm=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};class Ul extends et.jyz{constructor(s){super({side:et.ehD,defines:{DIA_ORIENT_ENVMAP:0,RAY_BOUNCES:5,ENV_MAP_TYPE:0,PI:3.1428},vertexShader:`#ifndef USE_ENVMAP
#define USE_ENVMAP  
#endif
varying vec3 vWorldPosition;varying vec3 vWorldNormal;void main(){vWorldNormal=(modelMatrix*vec4(normal,0.)).xyz;
#include <begin_vertex>
#include <project_vertex>
#include <worldpos_vertex>
vWorldPosition=worldPosition.xyz;}`,fragmentShader:`varying vec3 vWorldNormal;varying vec3 vWorldPosition;uniform samplerCube tCubeMapNormals;
#if ENV_MAP_TYPE == 0
uniform samplerCube envMap;
#elif ENV_MAP_TYPE == 1
uniform sampler2D envMap;
#endif
uniform float envMapIntensity;uniform mat4 modelMatrix;uniform mat4 inverseModelMatrix;uniform mat4 offsetMatrixInv;uniform mat4 offsetMatrix;uniform float transmission;uniform vec2 transmissionSamplerSize;uniform sampler2D transmissionSamplerMap;uniform float refractiveIndex;uniform float radius;uniform float rIndexDelta;uniform float squashFactor;uniform float geometryFactor;uniform vec3 color;uniform vec3 colorCorrection;uniform vec3 boostFactors;uniform vec3 centerOffset;uniform float gammaFactor;uniform float absorptionFactor;uniform float envMapRotation;uniform float reflectivity;vec3 BRDF_Specular_GGX_Environment(const in vec3 viewDir,const in vec3 normal,const in vec3 specularColor,const in float roughness){float dotNV=abs(dot(normal,viewDir));const vec4 c0=vec4(-1,-0.0275,-0.572,0.022);const vec4 c1=vec4(1,0.0425,1.04,-0.04);vec4 r=roughness*c0+c1;float a004=min(r.x*r.x,exp2(-9.28*dotNV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec2 cartesianToPolar(vec3 n){vec2 uv;uv.x=atan(n.z,n.x)/(PI*2.)+0.5;uv.y=asin(n.y)/PI+0.5;return uv;}vec4 sampleEnvMap(vec3 direction){
#if !defined(USE_ENVMAP)
return vec4(direction,1);
#else
float cs=cos(envMapRotation);float sn=sin(envMapRotation);float temp=cs*direction.x+sn*direction.z;direction.z=-sn*direction.x+cs*direction.z;direction.x=temp;direction.x*=-1.;direction.z*=-1.;
#if ENV_MAP_TYPE == 0
return(textureCube(envMap,direction));
#elif ENV_MAP_TYPE == 1
return(texture2D(envMap,cartesianToPolar(direction)));
#endif
return vec4(1,0,1,1);
#endif
}vec4 SampleSpecularReflection(vec3 direction){return envMapIntensity*(sampleEnvMap(direction));}uniform mat4 projectionMatrix;vec4 SampleSpecularContribution(vec3 direction){direction=normalize(direction);direction.x*=-1.;direction.z*=-1.;return envMapIntensity*(sampleEnvMap(direction));}vec4 SampleSpecularContributionRef(vec3 origin,int i){vec4 ndcPos=projectionMatrix*viewMatrix*vec4(origin,1.);vec2 refractionCoords=ndcPos.xy/ndcPos.w;refractionCoords+=1.;refractionCoords/=2.;return transmissionSamplerMapTexelToLinear(texture2D(transmissionSamplerMap,refractionCoords));}vec3 intersectSphere(vec3 origin,vec3 direction){origin-=centerOffset;direction.y/=squashFactor;float A=dot(direction,direction);float B=2.*dot(origin,direction);float C=dot(origin,origin)-radius*radius;float disc=B*B-4.*A*C;if(disc>0.){disc=sqrt(disc);float t1=(-B+disc)*geometryFactor/A;float t2=(-B-disc)*geometryFactor/A;float t=(t1>t2)?t1:t2;direction.y*=squashFactor;return vec3(origin+centerOffset+direction*t);}return vec3(0.);}vec3 linePlaneIntersect(in vec3 pointOnLine,in vec3 lineDirection,in vec3 pointOnPlane,in vec3 planeNormal){return lineDirection*(dot(planeNormal,pointOnPlane-pointOnLine)/dot(planeNormal,lineDirection))+pointOnLine;}vec4 getNormalDistance(vec3 d){return textureCube(tCubeMapNormals,d);}vec3 getSurfaceNormal(vec4 surfaceInfos){vec3 surfaceNormal=surfaceInfos.rgb;surfaceNormal=surfaceNormal*2.-1.;return-normalize(surfaceNormal);}vec3 intersect(vec3 rayOrigin,vec3 rayDirection){vec3 sphereHitPoint=intersectSphere(rayOrigin,rayDirection);vec3 direction1=normalize(sphereHitPoint-centerOffset);vec4 normalDistanceData1=getNormalDistance(direction1);float distance1=normalDistanceData1.a*radius;vec3 pointOnPlane1=centerOffset+direction1*distance1;vec3 planeNormal1=getSurfaceNormal(normalDistanceData1);vec3 hitPoint1=linePlaneIntersect(rayOrigin,rayDirection,pointOnPlane1,planeNormal1);vec3 direction2=normalize(hitPoint1-centerOffset);vec4 normalDistanceData2=getNormalDistance(direction2);float distance2=normalDistanceData2.a*radius;vec3 pointOnPlane2=centerOffset+direction2*distance2;vec3 hitPoint=hitPoint1;vec3 planeNormal2=getSurfaceNormal(normalDistanceData2);hitPoint=linePlaneIntersect(rayOrigin,rayDirection,pointOnPlane2,planeNormal2);return hitPoint;}vec3 debugBounces(int count){vec3 color=vec3(1.,1.,1.);if(count==1)color=vec3(0.,1.,0.);else if(count==2)color=vec3(0.,0.,1.);else if(count==3)color=vec3(1.,1.,0.);else if(count==4)color=vec3(0.,1.,1.);else color=vec3(0.,1.,0.);if(count==0)color=vec3(1.,0.,0.);return color;}vec3 traceRay(vec3 origin,vec3 direction,vec3 normal){vec3 outColor=vec3(0.);const float n1=1.;const float epsilon=1e-4;float f0=(2.4-n1)/(2.4+n1);f0*=f0;vec3 attenuationFactor=vec3(1.);vec3 newDirection=refract(direction,normal,n1/refractiveIndex);vec3 reflectedDirection=reflect(direction,normal);vec3 brdfReflected=BRDF_Specular_GGX_Environment(reflectedDirection,normal,vec3(f0),0.);vec3 brdfRefracted=BRDF_Specular_GGX_Environment(newDirection,-normal,vec3(f0),0.);attenuationFactor*=(vec3(1.)-brdfRefracted);outColor+=SampleSpecularReflection(reflectedDirection).rgb*brdfReflected*reflectivity*2.;int count=0;newDirection=(offsetMatrixInv*inverseModelMatrix*vec4(newDirection,0.)).xyz;newDirection=normalize(newDirection);origin=(offsetMatrixInv*inverseModelMatrix*vec4(origin,1.)).xyz;vec3 origin2=origin;origin2=(modelMatrix*offsetMatrix*vec4(origin2,1.)).xyz;for(int i=0;i<RAY_BOUNCES;i++){vec3 intersectedPos=intersect(origin,newDirection);vec3 dist=intersectedPos-origin;vec3 d=normalize(intersectedPos-centerOffset);vec3 mappedNormal=getNormalDistance(d).rgb;mappedNormal=2.*mappedNormal-1.;mappedNormal=-normalize(mappedNormal);float r=length(dist)/radius*absorptionFactor;attenuationFactor*=exp(-r*(1.-color));origin=intersectedPos;origin2=(modelMatrix*offsetMatrix*vec4(intersectedPos,1.)).xyz;vec3 oldDir=newDirection;newDirection=refract(newDirection,mappedNormal,refractiveIndex/n1);if(dot(newDirection,newDirection)<epsilon){newDirection=reflect(oldDir,mappedNormal);if(i==RAY_BOUNCES-1){vec3 brdfReflected=BRDF_Specular_GGX_Environment(-oldDir,mappedNormal,vec3(f0),0.);vec3 d1=(modelMatrix*offsetMatrix*vec4(oldDir,0.)).xyz;d1=normalize(d1);float cosT=1.-dot(direction,d1);outColor+=((transmission>0.&&cosT<transmission)?SampleSpecularContributionRef(origin2+0.5*d1*cosT,i).rgb:SampleSpecularContribution(DIA_ORIENT_ENVMAP<1?d1:newDirection).rgb)*attenuationFactor*colorCorrection*boostFactors*(vec3(1.)-brdfReflected);}}else{vec3 brdfRefracted=vec3(1.)-BRDF_Specular_GGX_Environment(newDirection,-mappedNormal,vec3(f0),0.);vec3 d1=(modelMatrix*offsetMatrix*vec4(newDirection,0.)).xyz;d1=normalize(d1);float cosT=1.-dot(direction,d1);if(transmission>0.&&cosT<transmission){outColor+=SampleSpecularContributionRef(origin2+0.5*d1*cosT,i).rgb*brdfRefracted*attenuationFactor*colorCorrection*boostFactors;}else{vec3 dir0=newDirection;vec3 dir1=refract(oldDir,mappedNormal,(refractiveIndex+rIndexDelta)/n1);vec3 dir2=refract(oldDir,mappedNormal,(refractiveIndex-rIndexDelta)/n1);
#if DIA_ORIENT_ENVMAP < 1
dir0=d1;dir1=(modelMatrix*offsetMatrix*vec4(dir1,0.)).xyz;dir2=(modelMatrix*offsetMatrix*vec4(dir2,0.)).xyz;
#endif
outColor+=vec3(SampleSpecularContribution(dir1).r,SampleSpecularContribution(dir0).g,SampleSpecularContribution(dir2).b)*brdfRefracted*attenuationFactor*colorCorrection*boostFactors;}newDirection=reflect(oldDir,mappedNormal);vec3 brdfReflected=BRDF_Specular_GGX_Environment(newDirection,mappedNormal,vec3(f0),0.);attenuationFactor*=brdfReflected*boostFactors;count++;}}return outColor;}void main(){vec3 normalizedNormal=normalize(vWorldNormal);vec3 viewVector=normalize(vWorldPosition-cameraPosition);vec3 color=traceRay(vWorldPosition,viewVector,normalizedNormal);gl_FragColor=vec4(color.rgb,1.);
#include <encodings_fragment>
}`,uniforms:{envMap:{value:s.envMap||null},envMapRotation:{value:0},transmission:{value:0},transmissionSamplerMap:{value:null},transmissionSamplerSize:{value:new et.FM8},normalOffset:{value:0},distanceOffset:{value:0},colorCorrection:{value:new et.Pa4(1,1,1)}}}),this.typeSlug=Ul.TypeSlug,this.assetType="material",this.__envMap=null,this.isDiamondMaterial=!0,this.color=new ys(1,1,1),this.envMapIntensity=1,this.dispersion=.012,this.absorptionFactor=1,this.refractiveIndex=2.4,this.squashFactor=.98,this.geometryFactor=.5,this.gammaFactor=1,this.boostFactors=new et.Pa4(.892,.892,.98595025),this.transmission=0,this.reflectivity=.5,this.rayBounces=5,this.diamondOrientedEnvMap=0,this.normalsCaptureMap=null,this.extraUniformsToUpload={inverseModelMatrix:{value:new et.yGw().identity()},radius:{value:1},centerOffset:{value:new et.Pa4(0,0,0)},offsetMatrix:{value:new et.yGw().identity()},offsetMatrixInv:{value:new et.yGw().identity()}},this.setDirty=this.setDirty.bind(this),this.userData.setDirty=o=>{console.warn("userData.setDirty is deprecated. Use setDirty instead."),this.setDirty(o)},this.userData.separateEnvMapIntensity=!0,this.userData.enableLUT=!0,this.setValues(s)}get mmMaterial(){return this}get materialObject(){return this}onBeforeRender(s,o,a,_e,rt){var nt,ot;super.onBeforeRender(s,o,a,_e,rt),this.uniforms.envMapRotation.value=((nt=this.envMap)===null||nt===void 0?void 0:nt.rotation)||0,this.extraUniformsToUpload.inverseModelMatrix.value.copy(rt.matrixWorld).invert();const ct=_e.userData._normalsCaptureOffsets;ct&&(this.extraUniformsToUpload.centerOffset.value.copy(ct.centerOffset),this.extraUniformsToUpload.offsetMatrix.value.copy(ct.offsetMatrix),this.extraUniformsToUpload.offsetMatrixInv.value.copy(ct.offsetMatrixInv),this.extraUniformsToUpload.radius.value=ct.radius);const pt=(ot=_e.userData._normalsCaptureMap)===null||ot===void 0?void 0:ot.texture;this.normalsCaptureMap!==pt&&(this.normalsCaptureMap=pt)}setDirty(s){var o,a;this.needsUpdate=!0,this.dispatchEvent({...s,type:"materialUpdate"}),(a=(o=this._uiConfig)===null||o===void 0?void 0:o.uiRefresh)===null||a===void 0||a.call(o,"postFrame",!0,1)}set envMap(s){var o;this.__envMap=s,this.uniforms.envMap.value=this.__envMap,!((o=this.__envMap)===null||o===void 0)&&o.isCubeTexture?(this.defines.ENV_MAP_TYPE=0,this.needsUpdate=!0):(this.defines.ENV_MAP_TYPE=1,this.needsUpdate=!0)}get envMap(){return this.__envMap}clone(){return super.clone()}toJSON(s){const o={};return o.name=this.name,o.uuid=this.uuid,o.color=this.color.getHex(),o.envMapIntensity=this.envMapIntensity,o.dispersion=this.dispersion,o.squashFactor=this.squashFactor,o.geometryFactor=this.geometryFactor,o.gammaFactor=this.gammaFactor,o.absorptionFactor=this.absorptionFactor,o.reflectivity=this.reflectivity,o.refractiveIndex=this.refractiveIndex,o.rayBounces=this.rayBounces,o.diamondOrientedEnvMap=this.diamondOrientedEnvMap,o.boostFactors={x:this.boostFactors.x,y:this.boostFactors.y,z:this.boostFactors.z,isVector3:!0},o.transmission=this.transmission,o.isDiamondMaterialParameters=!0,o.type=Ul.TYPE,o.userData={},Ol(o.userData,this.userData),o.userData.uuid=this.userData.uuid,o}get uiConfig(){const s=this;return this._uiConfigChildren||(this._uiConfigChildren=[{type:"input",property:[this,"name"]},{type:"checkbox",property:[this,"wireframe"]},...Yv(this),{type:"input",label:"Mesh count",get value(){var o,a,_e;return(_e=(a=(o=s.userData)===null||o===void 0?void 0:o.__appliedMeshes)===null||a===void 0?void 0:a.size)!==null&&_e!==void 0?_e:0},set value(o){},disabled:!0},{type:"checkbox",label:"Enable LUT",getValue:()=>this.userData.enableLUT===!0,setValue:o=>{this.userData.enableLUT=o||void 0,this.setDirty()}},{type:"input",label:"uuid",get value(){return s.uuid},set value(o){},disabled:!0},{type:"checkbox",label:"Render to Depth",hidden:()=>this.transmission===0,get value(){return s.userData.renderToDepth===!0},set value(o){s.userData.renderToDepth=o||void 0}},{type:"button",label:"Download .dmat",value:()=>{Nu(new Blob([JSON.stringify(s.toJSON(),null,2)],{type:"application/json"}),"diamond-material.dmat")}}]),this._uiConfig||(this._uiConfig={type:"folder",label:"Diamond Material",expanded:!0,children:this._uiConfigChildren,limitedUi:!0}),this._uiConfig}copyProps(s){if(!s.isDiamondMaterialParameters&&!s.isDiamondMaterial&&!s.isDiamond&&s.type!==Ul.TYPE)return console.warn("Material type is not supported",s),this;const o={};pr(s,o,Array.from(Object.keys(aM)));const a=o.userData;return delete o.userData,this.setValues(o),Ol(this.userData,a),this.setDirty(),this}fromJSON(s,o){return this.copyProps(s)}}Ul.TypeSlug="dmat",Ul.TYPE="DiamondMaterial",gm([vv("Color",{limitedUi:!0}),Ar()],Ul.prototype,"color",void 0),gm([gs("Env Intensity",[0,5],.01,{limitedUi:!0}),Ar()],Ul.prototype,"envMapIntensity",void 0),gm([gs("Dispersion",[0,.1],1e-4,{limitedUi:!0}),Ar({propKey:"rIndexDelta"})],Ul.prototype,"dispersion",void 0),gm([gs("Absorption",[0,15],.01,{limitedUi:!0}),Ar()],Ul.prototype,"absorptionFactor",void 0),gm([gs("Refractive Index",[0,4],.01,{limitedUi:!0}),Ar()],Ul.prototype,"refractiveIndex",void 0),gm([Ar()],Ul.prototype,"squashFactor",void 0),gm([Ar()],Ul.prototype,"geometryFactor",void 0),gm([Ar()],Ul.prototype,"gammaFactor",void 0),gm([ou("RGB Boost",void 0,void 0,{limitedUi:!0}),Ar()],Ul.prototype,"boostFactors",void 0),gm([gs("Transmission",[0,1],.01,{limitedUi:!0}),Ar()],Ul.prototype,"transmission",void 0),gm([gs("Reflectivity",[0,2],.01,{limitedUi:!0}),Ar()],Ul.prototype,"reflectivity",void 0),gm([jr("RAY_BOUNCES",void 0,!0),gs("Ray Bounces",[1,16],1)],Ul.prototype,"rayBounces",void 0),gm([jr("DIA_ORIENT_ENVMAP",void 0,!0),gs("Diamond Oriented Lighting",[0,1],1)],Ul.prototype,"diamondOrientedEnvMap",void 0),gm([Ar({propKey:"tCubeMapNormals"})],Ul.prototype,"normalsCaptureMap",void 0);class lM extends it{constructor(s,o,a,_e){super(),this._scene=s,this._camera=a??this._scene.activeCamera,this.domElement=o,this._time=this.time,this._mouseDownTime=0,this._mouseUpTime=1,this.selectionCondition=_e??(rt=>rt.userData.userSelectable!==!1&&rt.userData.bboxVisible!==!1&&rt.material!=null&&rt.material.type!=="ShadowMaterial"),this.raycaster=new et.iMs,this.mouse=new et.FM8,this._selected=[],this._hovering=[],this.cursorStyles={default:"grab",down:"grabbing"},this._activeCameraChange=this._activeCameraChange.bind(this),this._scene.addEventListener("activeCameraChange",this._activeCameraChange),this.domElement.style.touchAction="none",this.domElement.style.cursor=this.cursorStyles.default,this.domElement.addEventListener("pointermove",rt=>this.onPointerMove(rt)),this.domElement.addEventListener("pointerleave",rt=>this.onPointerLeave(rt)),this.domElement.addEventListener("pointerout",rt=>this.onPointerLeave(rt)),this.domElement.addEventListener("pointercancel",rt=>this.onPointerCancel(rt)),this.domElement.addEventListener("pointerenter",rt=>this.onPointerEnter(rt)),this.domElement.addEventListener("pointerdown",rt=>this.onPointerDown(rt)),this.domElement.addEventListener("pointerup",rt=>this.onPointerUp(rt))}get scene(){return this._scene}set scene(s){var o;(o=this._scene)===null||o===void 0||o.removeEventListener("activeCameraChange",this._activeCameraChange),this._scene=s,this._scene.addEventListener("activeCameraChange",this._activeCameraChange)}_activeCameraChange(){this.camera=this._scene.activeCamera}get camera(){return this._camera}set camera(s){this._camera=s}get selectedObject(){return this._selected.length>0?this._selected[0]:null}set selectedObject(s){this._selected.length===1&&this._selected[0]===s||(this._selected=s?Array.isArray(s)?[...s]:[s]:[],this.refreshOutlinePass(),this.dispatchEvent({type:"selectedObjectChanged",object:this.selectedObject}))}get hoverObject(){return this._hovering.length>0?this._hovering[0]:null}set hoverObject(s){this._hovering=s?Array.isArray(s)?[...s]:[s]:[],this.refreshOutlinePass(),this.dispatchEvent({type:"hoverObjectChanged",object:this.hoverObject})}get time(){return this._time=bo(),this._time}get isMouseDown(){return this.mouseDownDeltaTime<0}get mouseDownDeltaTime(){return this._mouseUpTime-this._mouseDownTime}onPointerMove(s){s.isPrimary!==!1&&this.updateMouseFromEvent(s)}onPointerLeave(s){s.isPrimary!==!1&&(this.domElement.style.cursor=this.cursorStyles.default,this.hoverObject=null)}onPointerEnter(s){}onPointerCancel(s){}updateMouseFromEvent(s){const o=this.domElement.getBoundingClientRect();this.mouse.x=(s.clientX-o.x)/o.width*2-1,this.mouse.y=-(s.clientY-o.y)/o.height*2+1}onPointerDown(s){s.isPrimary!==!1&&(this.domElement.style.cursor=this.cursorStyles.down,this._mouseDownTime=this.time)}onPointerUp(s){s.isPrimary!==!1&&(this.domElement.style.cursor=this.cursorStyles.default,this._mouseUpTime=this.time,this.mouseDownDeltaTime<200&&this.onPointerClick(s))}onPointerClick(s){if(s.isPrimary===!1)return;this.updateMouseFromEvent(s);const o=this.checkIntersection();o&&this.dispatchEvent({type:"hitObject",time:this._mouseUpTime,intersects:o}),this.selectedObject=(o==null?void 0:o.selectedObject)||null}addPasses(){}checkIntersection(){var s;const o=(s=this._camera)===null||s===void 0?void 0:s.cameraObject;if(!o)return null;this.raycaster.setFromCamera(this.mouse,o);const a=this.raycaster.intersectObject(this._scene.modelRoot.modelObject,!0),_e=this.selectedObject;if(_e){const rt=a.length-1-[...a].reverse().findIndex(nt=>{let ot=nt.object;for(;ot;){if(nt.object===_e)return!0;ot=ot.parent}return!1});rt>=0&&a.splice(0,rt+1)}if(a.length>0){for(const rt of a){let nt=rt.object;for(;!(nt==null||nt.visible&&this.selectionCondition(nt));)nt=nt.parent;if(nt)return{selectedObject:nt,intersect:rt,intersects:a,mouse:this.mouse.toArray()}}return null}return null}refreshOutlinePass(){var s;(s=this.hoverObject)!==null&&s!==void 0||this.selectedObject}isHovering(){return this.hoverObject!=null}isSelected(){return this.selectedObject!=null}}const Wy=new et.iMs,vm=new et.Pa4,K0=new et.Pa4,lu=new et._fP,uM={X:new et.Pa4(1,0,0),Y:new et.Pa4(0,1,0),Z:new et.Pa4(0,0,1)},tC={type:"change"},cM={type:"mouseDown"},dM={type:"mouseUp",mode:null},pM={type:"objectChange"};class AP extends et.Tme{constructor(s,o){super(),o===void 0&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),o=document),this.isTransformControls=!0,this.visible=!1,this.domElement=o,this.domElement.style.touchAction="none";const a=new vM;this._gizmo=a,this.add(a);const _e=new wP;this._plane=_e,this.add(_e);const rt=this;function nt(Bt,kt){let Pt=kt;Object.defineProperty(rt,Bt,{get:function(){return Pt!==void 0?Pt:kt},set:function(qt){Pt!==qt&&(Pt=qt,_e[Bt]=qt,a[Bt]=qt,rt.dispatchEvent({type:Bt+"-changed",value:qt}),rt.dispatchEvent(tC))}}),rt[Bt]=kt,_e[Bt]=kt,a[Bt]=kt}nt("camera",s),nt("object",void 0),nt("enabled",!0),nt("axis",null),nt("mode","translate"),nt("translationSnap",null),nt("rotationSnap",null),nt("scaleSnap",null),nt("space","world"),nt("size",1),nt("dragging",!1),nt("showX",!0),nt("showY",!0),nt("showZ",!0);const ot=new et.Pa4,ct=new et.Pa4,pt=new et._fP,ht=new et._fP,_t=new et.Pa4,Et=new et._fP,St=new et.Pa4,Mt=new et.Pa4,It=new et.Pa4,Nt=new et.Pa4;nt("worldPosition",ot),nt("worldPositionStart",ct),nt("worldQuaternion",pt),nt("worldQuaternionStart",ht),nt("cameraPosition",_t),nt("cameraQuaternion",Et),nt("pointStart",St),nt("pointEnd",Mt),nt("rotationAxis",It),nt("rotationAngle",0),nt("eye",Nt),this._offset=new et.Pa4,this._startNorm=new et.Pa4,this._endNorm=new et.Pa4,this._cameraScale=new et.Pa4,this._parentPosition=new et.Pa4,this._parentQuaternion=new et._fP,this._parentQuaternionInv=new et._fP,this._parentScale=new et.Pa4,this._worldScaleStart=new et.Pa4,this._worldQuaternionInv=new et._fP,this._worldScale=new et.Pa4,this._positionStart=new et.Pa4,this._quaternionStart=new et._fP,this._scaleStart=new et.Pa4,this._getPointer=rC.bind(this),this._onPointerDown=bP.bind(this),this._onPointerHover=hM.bind(this),this._onPointerMove=Wx.bind(this),this._onPointerUp=fM.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){this.object!==void 0&&(this.object.updateMatrixWorld(),this.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye):this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(s){if(this.object===void 0||this.dragging===!0)return;Wy.setFromCamera(s,this.camera);const o=nC(this._gizmo.picker[this.mode],Wy);this.axis=o?o.object.name:null}pointerDown(s){if(this.object!==void 0&&this.dragging!==!0&&s.button===0&&this.axis!==null){Wy.setFromCamera(s,this.camera);const o=nC(this._plane,Wy,!0);o&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(o.point).sub(this.worldPositionStart)),this.dragging=!0,cM.mode=this.mode,this.dispatchEvent(cM)}}pointerMove(s){const o=this.axis,a=this.mode,_e=this.object;let rt=this.space;if(a==="scale"?rt="local":o!=="E"&&o!=="XYZE"&&o!=="XYZ"||(rt="world"),_e===void 0||o===null||this.dragging===!1||s.button!==-1)return;Wy.setFromCamera(s,this.camera);const nt=nC(this._plane,Wy,!0);if(nt){if(this.pointEnd.copy(nt.point).sub(this.worldPositionStart),a==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),rt==="local"&&o!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),o.indexOf("X")===-1&&(this._offset.x=0),o.indexOf("Y")===-1&&(this._offset.y=0),o.indexOf("Z")===-1&&(this._offset.z=0),rt==="local"&&o!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),_e.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(rt==="local"&&(_e.position.applyQuaternion(lu.copy(this._quaternionStart).invert()),o.search("X")!==-1&&(_e.position.x=Math.round(_e.position.x/this.translationSnap)*this.translationSnap),o.search("Y")!==-1&&(_e.position.y=Math.round(_e.position.y/this.translationSnap)*this.translationSnap),o.search("Z")!==-1&&(_e.position.z=Math.round(_e.position.z/this.translationSnap)*this.translationSnap),_e.position.applyQuaternion(this._quaternionStart)),rt==="world"&&(_e.parent&&_e.position.add(vm.setFromMatrixPosition(_e.parent.matrixWorld)),o.search("X")!==-1&&(_e.position.x=Math.round(_e.position.x/this.translationSnap)*this.translationSnap),o.search("Y")!==-1&&(_e.position.y=Math.round(_e.position.y/this.translationSnap)*this.translationSnap),o.search("Z")!==-1&&(_e.position.z=Math.round(_e.position.z/this.translationSnap)*this.translationSnap),_e.parent&&_e.position.sub(vm.setFromMatrixPosition(_e.parent.matrixWorld))));else if(a==="scale"){if(o.search("XYZ")!==-1){let ot=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(ot*=-1),K0.set(ot,ot,ot)}else vm.copy(this.pointStart),K0.copy(this.pointEnd),vm.applyQuaternion(this._worldQuaternionInv),K0.applyQuaternion(this._worldQuaternionInv),K0.divide(vm),o.search("X")===-1&&(K0.x=1),o.search("Y")===-1&&(K0.y=1),o.search("Z")===-1&&(K0.z=1);_e.scale.copy(this._scaleStart).multiply(K0),this.scaleSnap&&(o.search("X")!==-1&&(_e.scale.x=Math.round(_e.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),o.search("Y")!==-1&&(_e.scale.y=Math.round(_e.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),o.search("Z")!==-1&&(_e.scale.z=Math.round(_e.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(a==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const ot=20/this.worldPosition.distanceTo(vm.setFromMatrixPosition(this.camera.matrixWorld));o==="E"?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):o==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(vm.copy(this.rotationAxis).cross(this.eye))*ot):o!=="X"&&o!=="Y"&&o!=="Z"||(this.rotationAxis.copy(uM[o]),vm.copy(uM[o]),rt==="local"&&vm.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(vm.cross(this.eye).normalize())*ot),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),rt==="local"&&o!=="E"&&o!=="XYZE"?(_e.quaternion.copy(this._quaternionStart),_e.quaternion.multiply(lu.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),_e.quaternion.copy(lu.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),_e.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(tC),this.dispatchEvent(pM)}}pointerUp(s){s.button===0&&(this.dragging&&this.axis!==null&&(dM.mode=this.mode,this.dispatchEvent(dM)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(s){s.geometry&&s.geometry.dispose(),s.material&&s.material.dispose()})}attach(s){return this.object=s,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(tC),this.dispatchEvent(pM),this.pointStart.copy(this.pointEnd))}getRaycaster(){return Wy}getMode(){return this.mode}setMode(s){this.mode=s}setTranslationSnap(s){this.translationSnap=s}setRotationSnap(s){this.rotationSnap=s}setScaleSnap(s){this.scaleSnap=s}setSize(s){this.size=s}setSpace(s){this.space=s}}function rC(tt){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:tt.button};{const s=this.domElement.getBoundingClientRect();return{x:(tt.clientX-s.left)/s.width*2-1,y:-(tt.clientY-s.top)/s.height*2+1,button:tt.button}}}function hM(tt){if(this.enabled)switch(tt.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(tt))}}function bP(tt){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(tt.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(tt)),this.pointerDown(this._getPointer(tt)))}function Wx(tt){this.enabled&&this.pointerMove(this._getPointer(tt))}function fM(tt){this.enabled&&(this.domElement.releasePointerCapture(tt.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(tt)))}function nC(tt,s,o){const a=s.intersectObject(tt,!0);for(let _e=0;_e<a.length;_e++)if(a[_e].object.visible||o)return a[_e];return!1}const t1=new et.USm,$l=new et.Pa4(0,1,0),mM=new et.Pa4(0,0,0),gM=new et.yGw,Yx=new et._fP,X0=new et._fP,Bv=new et.Pa4,iC=new et.yGw,r1=new et.Pa4(1,0,0),Z_=new et.Pa4(0,1,0),n1=new et.Pa4(0,0,1),Kx=new et.Pa4,XA=new et.Pa4,i1=new et.Pa4;class vM extends et.Tme{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const s=new et.vBJ({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),o=new et.nls({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),a=s.clone();a.opacity=.15;const _e=o.clone();_e.opacity=.5;const rt=s.clone();rt.color.setHex(16711680);const nt=s.clone();nt.color.setHex(65280);const ot=s.clone();ot.color.setHex(255);const ct=s.clone();ct.color.setHex(16711680),ct.opacity=.5;const pt=s.clone();pt.color.setHex(65280),pt.opacity=.5;const ht=s.clone();ht.color.setHex(255),ht.opacity=.5;const _t=s.clone();_t.opacity=.25;const Et=s.clone();Et.color.setHex(16776960),Et.opacity=.25,s.clone().color.setHex(16776960);const St=s.clone();St.color.setHex(7895160);const Mt=new et.fHI(0,.04,.1,12);Mt.translate(0,.05,0);const It=new et.DvJ(.08,.08,.08);It.translate(0,.04,0);const Nt=new et.u9r;Nt.setAttribute("position",new et.a$l([0,0,0,1,0,0],3));const Bt=new et.fHI(.0075,.0075,.5,3);function kt(Nr,Ir){const kr=new et.XvJ(Nr,.0075,3,64,Ir*Math.PI*2);return kr.rotateY(Math.PI/2),kr.rotateX(Math.PI/2),kr}Bt.translate(0,.25,0);const Pt={X:[[new et.Kj0(Mt,rt),[.5,0,0],[0,0,-Math.PI/2]],[new et.Kj0(Mt,rt),[-.5,0,0],[0,0,Math.PI/2]],[new et.Kj0(Bt,rt),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new et.Kj0(Mt,nt),[0,.5,0]],[new et.Kj0(Mt,nt),[0,-.5,0],[Math.PI,0,0]],[new et.Kj0(Bt,nt)]],Z:[[new et.Kj0(Mt,ot),[0,0,.5],[Math.PI/2,0,0]],[new et.Kj0(Mt,ot),[0,0,-.5],[-Math.PI/2,0,0]],[new et.Kj0(Bt,ot),null,[Math.PI/2,0,0]]],XYZ:[[new et.Kj0(new et.pQR(.1,0),_t.clone()),[0,0,0]]],XY:[[new et.Kj0(new et.DvJ(.15,.15,.01),ht.clone()),[.15,.15,0]]],YZ:[[new et.Kj0(new et.DvJ(.15,.15,.01),ct.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new et.Kj0(new et.DvJ(.15,.15,.01),pt.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},qt={X:[[new et.Kj0(new et.fHI(.2,0,.6,4),a),[.3,0,0],[0,0,-Math.PI/2]],[new et.Kj0(new et.fHI(.2,0,.6,4),a),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new et.Kj0(new et.fHI(.2,0,.6,4),a),[0,.3,0]],[new et.Kj0(new et.fHI(.2,0,.6,4),a),[0,-.3,0],[0,0,Math.PI]]],Z:[[new et.Kj0(new et.fHI(.2,0,.6,4),a),[0,0,.3],[Math.PI/2,0,0]],[new et.Kj0(new et.fHI(.2,0,.6,4),a),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new et.Kj0(new et.pQR(.2,0),a)]],XY:[[new et.Kj0(new et.DvJ(.2,.2,.01),a),[.15,.15,0]]],YZ:[[new et.Kj0(new et.DvJ(.2,.2,.01),a),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new et.Kj0(new et.DvJ(.2,.2,.01),a),[.15,0,.15],[-Math.PI/2,0,0]]]},Kt={START:[[new et.Kj0(new et.pQR(.01,2),_e),null,null,null,"helper"]],END:[[new et.Kj0(new et.pQR(.01,2),_e),null,null,null,"helper"]],DELTA:[[new et.x12(function(){const Nr=new et.u9r;return Nr.setAttribute("position",new et.a$l([0,0,0,1,1,1],3)),Nr}(),_e),null,null,null,"helper"]],X:[[new et.x12(Nt,_e.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new et.x12(Nt,_e.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new et.x12(Nt,_e.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},nr={XYZE:[[new et.Kj0(kt(.5,1),St),null,[0,Math.PI/2,0]]],X:[[new et.Kj0(kt(.5,.5),rt)]],Y:[[new et.Kj0(kt(.5,.5),nt),null,[0,0,-Math.PI/2]]],Z:[[new et.Kj0(kt(.5,.5),ot),null,[0,Math.PI/2,0]]],E:[[new et.Kj0(kt(.75,1),Et),null,[0,Math.PI/2,0]]]},ir={AXIS:[[new et.x12(Nt,_e.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},fr={XYZE:[[new et.Kj0(new et.xo$(.25,10,8),a)]],X:[[new et.Kj0(new et.XvJ(.5,.1,4,24),a),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new et.Kj0(new et.XvJ(.5,.1,4,24),a),[0,0,0],[Math.PI/2,0,0]]],Z:[[new et.Kj0(new et.XvJ(.5,.1,4,24),a),[0,0,0],[0,0,-Math.PI/2]]],E:[[new et.Kj0(new et.XvJ(.75,.1,2,24),a)]]},br={X:[[new et.Kj0(It,rt),[.5,0,0],[0,0,-Math.PI/2]],[new et.Kj0(Bt,rt),[0,0,0],[0,0,-Math.PI/2]],[new et.Kj0(It,rt),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new et.Kj0(It,nt),[0,.5,0]],[new et.Kj0(Bt,nt)],[new et.Kj0(It,nt),[0,-.5,0],[0,0,Math.PI]]],Z:[[new et.Kj0(It,ot),[0,0,.5],[Math.PI/2,0,0]],[new et.Kj0(Bt,ot),[0,0,0],[Math.PI/2,0,0]],[new et.Kj0(It,ot),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new et.Kj0(new et.DvJ(.15,.15,.01),ht),[.15,.15,0]]],YZ:[[new et.Kj0(new et.DvJ(.15,.15,.01),ct),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new et.Kj0(new et.DvJ(.15,.15,.01),pt),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new et.Kj0(new et.DvJ(.1,.1,.1),_t.clone())]]},Tr={X:[[new et.Kj0(new et.fHI(.2,0,.6,4),a),[.3,0,0],[0,0,-Math.PI/2]],[new et.Kj0(new et.fHI(.2,0,.6,4),a),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new et.Kj0(new et.fHI(.2,0,.6,4),a),[0,.3,0]],[new et.Kj0(new et.fHI(.2,0,.6,4),a),[0,-.3,0],[0,0,Math.PI]]],Z:[[new et.Kj0(new et.fHI(.2,0,.6,4),a),[0,0,.3],[Math.PI/2,0,0]],[new et.Kj0(new et.fHI(.2,0,.6,4),a),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new et.Kj0(new et.DvJ(.2,.2,.01),a),[.15,.15,0]]],YZ:[[new et.Kj0(new et.DvJ(.2,.2,.01),a),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new et.Kj0(new et.DvJ(.2,.2,.01),a),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new et.Kj0(new et.DvJ(.2,.2,.2),a),[0,0,0]]]},Dr={X:[[new et.x12(Nt,_e.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new et.x12(Nt,_e.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new et.x12(Nt,_e.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function Rr(Nr){const Ir=new et.Tme;for(const kr in Nr)for(let Hr=Nr[kr].length;Hr--;){const Lr=Nr[kr][Hr][0].clone(),en=Nr[kr][Hr][1],vn=Nr[kr][Hr][2],wn=Nr[kr][Hr][3],pn=Nr[kr][Hr][4];Lr.name=kr,Lr.tag=pn,en&&Lr.position.set(en[0],en[1],en[2]),vn&&Lr.rotation.set(vn[0],vn[1],vn[2]),wn&&Lr.scale.set(wn[0],wn[1],wn[2]),Lr.updateMatrix();const Fn=Lr.geometry.clone();Fn.applyMatrix4(Lr.matrix),Lr.geometry=Fn,Lr.renderOrder=1/0,Lr.position.set(0,0,0),Lr.rotation.set(0,0,0),Lr.scale.set(1,1,1),Ir.add(Lr)}return Ir}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=Rr(Pt)),this.add(this.gizmo.rotate=Rr(nr)),this.add(this.gizmo.scale=Rr(br)),this.add(this.picker.translate=Rr(qt)),this.add(this.picker.rotate=Rr(fr)),this.add(this.picker.scale=Rr(Tr)),this.add(this.helper.translate=Rr(Kt)),this.add(this.helper.rotate=Rr(ir)),this.add(this.helper.scale=Rr(Dr)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(s){const o=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:X0;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let a=[];a=a.concat(this.picker[this.mode].children),a=a.concat(this.gizmo[this.mode].children),a=a.concat(this.helper[this.mode].children);for(let _e=0;_e<a.length;_e++){const rt=a[_e];let nt;rt.visible=!0,rt.rotation.set(0,0,0),rt.position.copy(this.worldPosition),nt=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),rt.scale.set(1,1,1).multiplyScalar(nt*this.size/4),rt.tag!=="helper"?(rt.quaternion.copy(o),this.mode==="translate"||this.mode==="scale"?(rt.name==="X"&&Math.abs($l.copy(r1).applyQuaternion(o).dot(this.eye))>.99&&(rt.scale.set(1e-10,1e-10,1e-10),rt.visible=!1),rt.name==="Y"&&Math.abs($l.copy(Z_).applyQuaternion(o).dot(this.eye))>.99&&(rt.scale.set(1e-10,1e-10,1e-10),rt.visible=!1),rt.name==="Z"&&Math.abs($l.copy(n1).applyQuaternion(o).dot(this.eye))>.99&&(rt.scale.set(1e-10,1e-10,1e-10),rt.visible=!1),rt.name==="XY"&&Math.abs($l.copy(n1).applyQuaternion(o).dot(this.eye))<.2&&(rt.scale.set(1e-10,1e-10,1e-10),rt.visible=!1),rt.name==="YZ"&&Math.abs($l.copy(r1).applyQuaternion(o).dot(this.eye))<.2&&(rt.scale.set(1e-10,1e-10,1e-10),rt.visible=!1),rt.name==="XZ"&&Math.abs($l.copy(Z_).applyQuaternion(o).dot(this.eye))<.2&&(rt.scale.set(1e-10,1e-10,1e-10),rt.visible=!1)):this.mode==="rotate"&&(Yx.copy(o),$l.copy(this.eye).applyQuaternion(lu.copy(o).invert()),rt.name.search("E")!==-1&&rt.quaternion.setFromRotationMatrix(gM.lookAt(this.eye,mM,Z_)),rt.name==="X"&&(lu.setFromAxisAngle(r1,Math.atan2(-$l.y,$l.z)),lu.multiplyQuaternions(Yx,lu),rt.quaternion.copy(lu)),rt.name==="Y"&&(lu.setFromAxisAngle(Z_,Math.atan2($l.x,$l.z)),lu.multiplyQuaternions(Yx,lu),rt.quaternion.copy(lu)),rt.name==="Z"&&(lu.setFromAxisAngle(n1,Math.atan2($l.y,$l.x)),lu.multiplyQuaternions(Yx,lu),rt.quaternion.copy(lu))),rt.visible=rt.visible&&(rt.name.indexOf("X")===-1||this.showX),rt.visible=rt.visible&&(rt.name.indexOf("Y")===-1||this.showY),rt.visible=rt.visible&&(rt.name.indexOf("Z")===-1||this.showZ),rt.visible=rt.visible&&(rt.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),rt.material._color=rt.material._color||rt.material.color.clone(),rt.material._opacity=rt.material._opacity||rt.material.opacity,rt.material.color.copy(rt.material._color),rt.material.opacity=rt.material._opacity,this.enabled&&this.axis&&(rt.name===this.axis||this.axis.split("").some(function(ot){return rt.name===ot}))&&(rt.material.color.setHex(16776960),rt.material.opacity=1)):(rt.visible=!1,rt.name==="AXIS"?(rt.position.copy(this.worldPositionStart),rt.visible=!!this.axis,this.axis==="X"&&(lu.setFromEuler(t1.set(0,0,0)),rt.quaternion.copy(o).multiply(lu),Math.abs($l.copy(r1).applyQuaternion(o).dot(this.eye))>.9&&(rt.visible=!1)),this.axis==="Y"&&(lu.setFromEuler(t1.set(0,0,Math.PI/2)),rt.quaternion.copy(o).multiply(lu),Math.abs($l.copy(Z_).applyQuaternion(o).dot(this.eye))>.9&&(rt.visible=!1)),this.axis==="Z"&&(lu.setFromEuler(t1.set(0,Math.PI/2,0)),rt.quaternion.copy(o).multiply(lu),Math.abs($l.copy(n1).applyQuaternion(o).dot(this.eye))>.9&&(rt.visible=!1)),this.axis==="XYZE"&&(lu.setFromEuler(t1.set(0,Math.PI/2,0)),$l.copy(this.rotationAxis),rt.quaternion.setFromRotationMatrix(gM.lookAt(mM,$l,Z_)),rt.quaternion.multiply(lu),rt.visible=this.dragging),this.axis==="E"&&(rt.visible=!1)):rt.name==="START"?(rt.position.copy(this.worldPositionStart),rt.visible=this.dragging):rt.name==="END"?(rt.position.copy(this.worldPosition),rt.visible=this.dragging):rt.name==="DELTA"?(rt.position.copy(this.worldPositionStart),rt.quaternion.copy(this.worldQuaternionStart),vm.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),vm.applyQuaternion(this.worldQuaternionStart.clone().invert()),rt.scale.copy(vm),rt.visible=this.dragging):(rt.quaternion.copy(o),this.dragging?rt.position.copy(this.worldPositionStart):rt.position.copy(this.worldPosition),this.axis&&(rt.visible=this.axis.search(rt.name)!==-1)))}super.updateMatrixWorld(s)}}class wP extends et.Kj0{constructor(){super(new et._12(1e5,1e5,2,2),new et.vBJ({visible:!1,wireframe:!0,side:et.ehD,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(s){let o=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(o="local"),Kx.copy(r1).applyQuaternion(o==="local"?this.worldQuaternion:X0),XA.copy(Z_).applyQuaternion(o==="local"?this.worldQuaternion:X0),i1.copy(n1).applyQuaternion(o==="local"?this.worldQuaternion:X0),$l.copy(XA),this.mode){case"translate":case"scale":switch(this.axis){case"X":$l.copy(this.eye).cross(Kx),Bv.copy(Kx).cross($l);break;case"Y":$l.copy(this.eye).cross(XA),Bv.copy(XA).cross($l);break;case"Z":$l.copy(this.eye).cross(i1),Bv.copy(i1).cross($l);break;case"XY":Bv.copy(i1);break;case"YZ":Bv.copy(Kx);break;case"XZ":$l.copy(i1),Bv.copy(XA);break;case"XYZ":case"E":Bv.set(0,0,0)}break;default:Bv.set(0,0,0)}Bv.length()===0?this.quaternion.copy(this.cameraQuaternion):(iC.lookAt(vm.set(0,0,0),Bv,$l),this.quaternion.setFromRotationMatrix(iC)),super.updateMatrixWorld(s)}}const _M=new et.ZzF,Xx=new et.Pa4;class yM extends et.L5s{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry",this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new et.a$l([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new et.a$l([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}applyMatrix4(s){const o=this.attributes.instanceStart,a=this.attributes.instanceEnd;return o!==void 0&&(o.applyMatrix4(s),a.applyMatrix4(s),o.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(s){let o;s instanceof Float32Array?o=s:Array.isArray(s)&&(o=new Float32Array(s));const a=new et.$TI(o,6,1);return this.setAttribute("instanceStart",new et.kB5(a,3,0)),this.setAttribute("instanceEnd",new et.kB5(a,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(s){let o;s instanceof Float32Array?o=s:Array.isArray(s)&&(o=new Float32Array(s));const a=new et.$TI(o,6,1);return this.setAttribute("instanceColorStart",new et.kB5(a,3,0)),this.setAttribute("instanceColorEnd",new et.kB5(a,3,3)),this}fromWireframeGeometry(s){return this.setPositions(s.attributes.position.array),this}fromEdgesGeometry(s){return this.setPositions(s.attributes.position.array),this}fromMesh(s){return this.fromWireframeGeometry(new et.Uk6(s.geometry)),this}fromLineSegments(s){const o=s.geometry;return this.setPositions(o.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new et.ZzF);const s=this.attributes.instanceStart,o=this.attributes.instanceEnd;s!==void 0&&o!==void 0&&(this.boundingBox.setFromBufferAttribute(s),_M.setFromBufferAttribute(o),this.boundingBox.union(_M))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new et.aLr),this.boundingBox===null&&this.computeBoundingBox();const s=this.attributes.instanceStart,o=this.attributes.instanceEnd;if(s!==void 0&&o!==void 0){const a=this.boundingSphere.center;this.boundingBox.getCenter(a);let _e=0;for(let rt=0,nt=s.count;rt<nt;rt++)Xx.fromBufferAttribute(s,rt),_e=Math.max(_e,a.distanceToSquared(Xx)),Xx.fromBufferAttribute(o,rt),_e=Math.max(_e,a.distanceToSquared(Xx));this.boundingSphere.radius=Math.sqrt(_e),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(s){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(s)}}class xP extends yM{constructor(s){super(),this.isWireframeGeometry2=!0,this.type="WireframeGeometry2",this.fromWireframeGeometry(new et.Uk6(s))}}et.rBU.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new et.FM8(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},et.Vj0.line={uniforms:et.rDY.merge([et.rBU.common,et.rBU.fog,et.rBU.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				// get the offset direction as perpendicular to the view vector
				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 offset;
				if ( position.y < 0.5 ) {

					offset = normalize( cross( start.xyz, worldDir ) );

				} else {

					offset = normalize( cross( end.xyz, worldDir ) );

				}

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// extend the line bounds to encompass  endcaps
					start.xyz += - worldDir * linewidth * 0.5;
					end.xyz += worldDir * linewidth * 0.5;

					// shift the position of the quad so it hugs the forward edge of the line
					offset.xy -= dir * forwardOffset;
					offset.z += 0.5;

				#endif

				// endcaps
				if ( position.y > 1.0 || position.y < 0.0 ) {

					offset.xy += dir * 2.0 * forwardOffset;

				}

				// adjust for linewidth
				offset *= linewidth * 0.5;

				// set the world position
				worldPos = ( position.y < 0.5 ) ? start : end;
				worldPos.xyz += offset;

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <encodings_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};class AM extends et.jyz{constructor(s){super({type:"LineMaterial",uniforms:et.rDY.clone(et.Vj0.line.uniforms),vertexShader:et.Vj0.line.vertexShader,fragmentShader:et.Vj0.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(o){this.uniforms.diffuse.value=o}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(o){o===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(o){this.uniforms.linewidth.value=o}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(o){!!o!="USE_DASH"in this.defines&&(this.needsUpdate=!0),o===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(o){this.uniforms.dashScale.value=o}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(o){this.uniforms.dashSize.value=o}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(o){this.uniforms.dashOffset.value=o}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(o){this.uniforms.gapSize.value=o}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(o){this.uniforms.opacity.value=o}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(o){this.uniforms.resolution.value.copy(o)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(o){!!o!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),o===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(s)}}const bM=new et.Pa4,sC=new et.Pa4;class wM extends et.Kj0{constructor(s=new yM,o=new AM({color:16777215*Math.random()})){super(s,o),this.isWireframe=!0,this.type="Wireframe"}computeLineDistances(){const s=this.geometry,o=s.attributes.instanceStart,a=s.attributes.instanceEnd,_e=new Float32Array(2*o.count);for(let nt=0,ot=0,ct=o.count;nt<ct;nt++,ot+=2)bM.fromBufferAttribute(o,nt),sC.fromBufferAttribute(a,nt),_e[ot]=ot===0?0:_e[ot-1],_e[ot+1]=_e[ot]+bM.distanceTo(sC);const rt=new et.$TI(_e,2,1);return s.setAttribute("instanceDistanceStart",new et.kB5(rt,1,0)),s.setAttribute("instanceDistanceEnd",new et.kB5(rt,1,1)),this}}class oC extends et.ZAu{constructor(){super(),this.assetType="widget",this.modelObject=this,this._object=null,this.boundingScaleMultiplier=1,this.position.set(0,0,0),this.visible=!1,this.renderOrder=1,this.userData.bboxVisible=!1,this._updater=this._updater.bind(this)}_updater(){const s=this._object;if(s){const o=new cn().expandByObject(s,!1);o.getCenter(this.position);const a=o.getBoundingSphere(new et.aLr).radius;this.scale.setScalar(a*this.boundingScaleMultiplier),this.setVisible(!0)}else this.setVisible(!1)}_initGeometry(s){if(this._geometry)return;const o=new xP(s);this._geometry=o;const a=new AM({color:"#ff2222",transparent:!0,opacity:.9,linewidth:5,resolution:new et.FM8(1024,1024),dashed:!1,toneMapped:!1}),_e=new wM(o,a);_e.computeLineDistances(),_e.scale.set(1,1,1),_e.visible=!0,this.add(_e)}setVisible(s){var o;s!==this.visible&&(this.visible=s,(o=this.setDirty)===null||o===void 0||o.call(this,{sceneUpdate:!1}))}attach(s){return this.detach(),s?(this._object=s,this._object.addEventListener("objectUpdate",this._updater),this._updater(),this):this}detach(){var s;return this._object?((s=this._object)===null||s===void 0||s.removeEventListener("objectUpdate",this._updater),this._object=null,this._updater(),this):this}get object(){return this._object}}class aC extends oC{constructor(){super(),this.boundingScaleMultiplier=1/1.7,this._initGeometry(new et.DvJ(2,2,2,1,1,1))}_updater(){super._updater();const s=this.object;s&&(new cn().expandByObject(s,!1).getSize(this.scale).multiplyScalar(this.boundingScaleMultiplier).clampScalar(.1,100),this.setVisible(!0))}}var s1=function(tt){return function(s){return 1-tt(1-s)}},Jx=function(tt){return function(s){return s<=.5?tt(2*s)/2:(2-tt(2*(1-s)))/2}},xM=function(tt){return function(s){return Math.pow(s,tt)}},Zx=function(tt){return function(s){return s*s*((tt+1)*s-tt)}},EM=function(tt){var s=Zx(tt);return function(o){return(o*=2)<1?.5*s(o):.5*(2-Math.pow(2,-10*(o-1)))}},o1=function(tt){return tt},JA=xM(2),SM=s1(JA),lC=Jx(JA),uC=function(tt){return 1-Math.sin(Math.acos(tt))},eE=s1(uC),cC=Jx(eE),e0=Zx(1.525),CM=s1(e0),tE=Jx(e0),dC=EM(1.525),a1=function(tt){if(tt===1||tt===0)return tt;var s=tt*tt;return tt<.36363636363636365?7.5625*s:tt<.7272727272727273?9.075*s-9.9*tt+3.4:tt<.9?12.066481994459833*s-19.63545706371191*tt+8.898060941828255:10.8*tt*tt-20.52*tt+10.72},TM=s1(a1),MM=function(tt){return tt<.5?.5*(1-a1(1-2*tt)):.5*a1(2*tt-1)+.5},fu=function(){return fu=Object.assign||function(tt){for(var s,o=1,a=arguments.length;o<a;o++)for(var _e in s=arguments[o])Object.prototype.hasOwnProperty.call(s,_e)&&(tt[_e]=s[_e]);return tt},fu.apply(this,arguments)};function pC(tt,s){var o={};for(var a in tt)Object.prototype.hasOwnProperty.call(tt,a)&&s.indexOf(a)<0&&(o[a]=tt[a]);if(tt!=null&&typeof Object.getOwnPropertySymbols=="function"){var _e=0;for(a=Object.getOwnPropertySymbols(tt);_e<a.length;_e++)s.indexOf(a[_e])<0&&Object.prototype.propertyIsEnumerable.call(tt,a[_e])&&(o[a[_e]]=tt[a[_e]])}return o}var J0=function(tt,s,o){return Math.min(Math.max(o,tt),s)};function ZA(tt,s){return tt*Math.sqrt(1-s*s)}var RM=["duration","bounce"],rE=["stiffness","damping","mass"];function kp(tt,s){return s.some(function(o){return tt[o]!==void 0})}function d_(tt){var s=tt.from,o=s===void 0?0:s,a=tt.to,_e=a===void 0?1:a,rt=tt.restSpeed,nt=rt===void 0?2:rt,ot=tt.restDelta,ct=pC(tt,["from","to","restSpeed","restDelta"]),pt={done:!1,value:o},ht=function(qt){var Kt=fu({velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1},qt);if(!kp(qt,rE)&&kp(qt,RM)){var nr=function(ir){var fr,br,Tr=ir.duration,Dr=Tr===void 0?800:Tr,Rr=ir.bounce,Nr=Rr===void 0?.25:Rr,Ir=ir.velocity,kr=Ir===void 0?0:Ir,Hr=ir.mass,Lr=Hr===void 0?1:Hr,en=1-Nr;en=J0(.05,1,en),Dr=J0(.01,10,Dr/1e3),en<1?(fr=function(pn){var Fn=pn*en,Gn=Fn*Dr;return .001-(Fn-kr)/ZA(pn,en)*Math.exp(-Gn)},br=function(pn){var Fn=pn*en*Dr,Gn=Fn*kr+kr,Qn=Math.pow(en,2)*Math.pow(pn,2)*Dr,Yn=Math.exp(-Fn),bs=ZA(Math.pow(pn,2),en);return(.001-fr(pn)>0?-1:1)*((Gn-Qn)*Yn)/bs}):(fr=function(pn){return Math.exp(-pn*Dr)*((pn-kr)*Dr+1)-.001},br=function(pn){return Math.exp(-pn*Dr)*(Dr*Dr*(kr-pn))});var vn=function(pn,Fn,Gn){for(var Qn=Gn,Yn=1;Yn<12;Yn++)Qn-=pn(Qn)/Fn(Qn);return Qn}(fr,br,5/Dr);if(Dr*=1e3,isNaN(vn))return{stiffness:100,damping:10,duration:Dr};var wn=Math.pow(vn,2)*Lr;return{stiffness:wn,damping:2*en*Math.sqrt(Lr*wn),duration:Dr}}(qt);(Kt=fu(fu(fu({},Kt),nr),{velocity:0,mass:1})).isResolvedFromDuration=!0}return Kt}(ct),_t=ht.stiffness,Et=ht.damping,St=ht.mass,Mt=ht.velocity,It=ht.duration,Nt=ht.isResolvedFromDuration,Bt=nE,kt=nE;function Pt(){var qt=Mt?-Mt/1e3:0,Kt=_e-o,nr=Et/(2*Math.sqrt(_t*St)),ir=Math.sqrt(_t/St)/1e3;if(ot!=null||(ot=Math.abs(_e-o)<=1?.01:.4),nr<1){var fr=ZA(ir,nr);Bt=function(Tr){var Dr=Math.exp(-nr*ir*Tr);return _e-Dr*((qt+nr*ir*Kt)/fr*Math.sin(fr*Tr)+Kt*Math.cos(fr*Tr))},kt=function(Tr){var Dr=Math.exp(-nr*ir*Tr);return nr*ir*Dr*(Math.sin(fr*Tr)*(qt+nr*ir*Kt)/fr+Kt*Math.cos(fr*Tr))-Dr*(Math.cos(fr*Tr)*(qt+nr*ir*Kt)-fr*Kt*Math.sin(fr*Tr))}}else if(nr===1)Bt=function(Tr){return _e-Math.exp(-ir*Tr)*(Kt+(qt+ir*Kt)*Tr)};else{var br=ir*Math.sqrt(nr*nr-1);Bt=function(Tr){var Dr=Math.exp(-nr*ir*Tr),Rr=Math.min(br*Tr,300);return _e-Dr*((qt+nr*ir*Kt)*Math.sinh(Rr)+br*Kt*Math.cosh(Rr))/br}}}return Pt(),{next:function(qt){var Kt=Bt(qt);if(Nt)pt.done=qt>=It;else{var nr=1e3*kt(qt),ir=Math.abs(nr)<=nt,fr=Math.abs(_e-Kt)<=ot;pt.done=ir&&fr}return pt.value=pt.done?_e:Kt,pt},flipTarget:function(){var qt;Mt=-Mt,o=(qt=[_e,o])[0],_e=qt[1],Pt()}}}d_.needsInterpolation=function(tt,s){return typeof tt=="string"||typeof s=="string"};var nE=function(tt){return 0},Z0=function(tt,s,o){var a=s-tt;return a===0?1:(o-tt)/a},t0=function(tt,s,o){return-o*tt+o*s+tt},Yy=function(tt,s){return function(o){return Math.max(Math.min(o,s),tt)}},p_=function(tt){return tt%1?Number(tt.toFixed(5)):tt},r0=/(-)?([\d]*\.?[\d])+/g,Ky=/(#[0-9a-f]{6}|#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))/gi,IM=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))$/i;function ey(tt){return typeof tt=="string"}var ty={test:function(tt){return typeof tt=="number"},parse:parseFloat,transform:function(tt){return tt}},l1=fu(fu({},ty),{transform:Yy(0,1)}),iE=(fu(fu({},ty),{default:1}),function(tt,s){return function(o){return!!(ey(o)&&IM.test(o)&&o.startsWith(tt)||s&&Object.prototype.hasOwnProperty.call(o,s))}}),sE=function(tt,s,o){return function(a){var _e;if(!ey(a))return a;var rt=a.match(r0),nt=rt[0],ot=rt[1],ct=rt[2],pt=rt[3];return(_e={})[tt]=parseFloat(nt),_e[s]=parseFloat(ot),_e[o]=parseFloat(ct),_e.alpha=pt!==void 0?parseFloat(pt):1,_e}},PM=Yy(0,255),oE=fu(fu({},ty),{transform:function(tt){return Math.round(PM(tt))}}),n0={test:iE("rgb","red"),parse:sE("red","green","blue"),transform:function(tt){var s=tt.red,o=tt.green,a=tt.blue,_e=tt.alpha,rt=_e===void 0?1:_e;return"rgba("+oE.transform(s)+", "+oE.transform(o)+", "+oE.transform(a)+", "+p_(l1.transform(rt))+")"}},_b={test:iE("#"),parse:function(tt){var s="",o="",a="",_e="";return tt.length>5?(s=tt.substr(1,2),o=tt.substr(3,2),a=tt.substr(5,2),_e=tt.substr(7,2)):(s=tt.substr(1,1),o=tt.substr(2,1),a=tt.substr(3,1),_e=tt.substr(4,1),s+=s,o+=o,a+=a,_e+=_e),{red:parseInt(s,16),green:parseInt(o,16),blue:parseInt(a,16),alpha:_e?parseInt(_e,16)/255:1}},transform:n0.transform},DM=function(tt){return{test:function(s){return ey(s)&&s.endsWith(tt)&&s.split(" ").length===1},parse:parseFloat,transform:function(s){return""+s+tt}}},ew=DM("%"),Xy=(fu(fu({},ew),{parse:function(tt){return ew.parse(tt)/100},transform:function(tt){return ew.transform(100*tt)}}),{test:iE("hsl","hue"),parse:sE("hue","saturation","lightness"),transform:function(tt){var s=tt.hue,o=tt.saturation,a=tt.lightness,_e=tt.alpha,rt=_e===void 0?1:_e;return"hsla("+Math.round(s)+", "+ew.transform(p_(o))+", "+ew.transform(p_(a))+", "+p_(l1.transform(rt))+")"}}),BM=function(tt,s,o){var a=tt*tt,_e=s*s;return Math.sqrt(Math.max(0,o*(_e-a)+a))},kM=[_b,n0,Xy],OM=function(tt){return kM.find(function(s){return s.test(tt)})},aE=function(tt,s){var o=OM(tt),a=OM(s);o.transform,a.transform;var _e=o.parse(tt),rt=a.parse(s),nt=fu({},_e),ot=o===Xy?t0:BM;return function(ct){for(var pt in nt)pt!=="alpha"&&(nt[pt]=ot(_e[pt],rt[pt],ct));return nt.alpha=t0(_e.alpha,rt.alpha,ct),o.transform(nt)}},hC=function(tt){return n0.test(tt)||_b.test(tt)||Xy.test(tt)},fC=function(tt){return n0.test(tt)?n0.parse(tt):Xy.test(tt)?Xy.parse(tt):_b.parse(tt)},tw=function(tt){return ey(tt)?tt:tt.hasOwnProperty("red")?n0.transform(tt):Xy.transform(tt)},mC="${c}",LM="${n}";function u1(tt){var s=[],o=0,a=tt.match(Ky);a&&(o=a.length,tt=tt.replace(Ky,mC),s.push.apply(s,a.map(fC)));var _e=tt.match(r0);return _e&&(tt=tt.replace(r0,LM),s.push.apply(s,_e.map(ty.parse))),{values:s,numColors:o,tokenised:tt}}function Jy(tt){return u1(tt).values}function gC(tt){var s=u1(tt),o=s.values,a=s.numColors,_e=s.tokenised,rt=o.length;return function(nt){for(var ot=_e,ct=0;ct<rt;ct++)ot=ot.replace(ct<a?mC:LM,ct<a?tw(nt[ct]):p_(nt[ct]));return ot}}var NM=function(tt){return typeof tt=="number"?0:tt},c1={test:function(tt){var s,o,a,_e;return isNaN(tt)&&ey(tt)&&((o=(s=tt.match(r0))===null||s===void 0?void 0:s.length)!==null&&o!==void 0?o:0)+((_e=(a=tt.match(Ky))===null||a===void 0?void 0:a.length)!==null&&_e!==void 0?_e:0)>0},parse:Jy,createTransformer:gC,getAnimatableNone:function(tt){var s=Jy(tt);return gC(tt)(s.map(NM))}},d1={x:0,y:0,z:0},lE=function(tt){return typeof tt=="number"},Qp=function(tt,s){return function(o){return s(tt(o))}},uE=function(){for(var tt=[],s=0;s<arguments.length;s++)tt[s]=arguments[s];return tt.reduce(Qp)};function vC(tt,s){return lE(tt)?function(o){return t0(tt,s,o)}:hC(tt)?aE(tt,s):h_(tt,s)}var _C=function(tt,s){var o=function(rt,nt){for(var ot=0,ct=nt.length,pt=rt.length;ot<ct;ot++,pt++)rt[pt]=nt[ot];return rt}([],tt),a=o.length,_e=tt.map(function(rt,nt){return vC(rt,s[nt])});return function(rt){for(var nt=0;nt<a;nt++)o[nt]=_e[nt](rt);return o}},yC=function(tt,s){var o=fu(fu({},tt),s),a={};for(var _e in o)tt[_e]!==void 0&&s[_e]!==void 0&&(a[_e]=vC(tt[_e],s[_e]));return function(rt){for(var nt in a)o[nt]=a[nt](rt);return o}};function p1(tt){for(var s=c1.parse(tt),o=s.length,a=0,_e=0,rt=0,nt=0;nt<o;nt++)a||typeof s[nt]=="number"?a++:s[nt].hue!==void 0?rt++:_e++;return{parsed:s,numNumbers:a,numRGB:_e,numHSL:rt}}var h_=function(tt,s){var o=c1.createTransformer(s),a=p1(tt),_e=p1(s);return uE(_C(a.parsed,_e.parsed),o)},FM=function(tt,s){return function(o){return t0(tt,s,o)}};function cE(tt,s,o){var a=o===void 0?{}:o,_e=a.clamp,rt=_e===void 0||_e,nt=a.ease,ot=a.mixer,ct=tt.length;s.length,!nt||!Array.isArray(nt)||nt.length,tt[0]>tt[ct-1]&&(tt=[].concat(tt),s=[].concat(s),tt.reverse(),s.reverse());var pt=function(_t,Et,St){for(var Mt=[],It=St||(typeof(qt=_t[0])=="number"?FM:typeof qt=="string"?hC(qt)?aE:h_:Array.isArray(qt)?_C:typeof qt=="object"?yC:void 0),Nt=_t.length-1,Bt=0;Bt<Nt;Bt++){var kt=It(_t[Bt],_t[Bt+1]);if(Et){var Pt=Array.isArray(Et)?Et[Bt]:Et;kt=uE(Pt,kt)}Mt.push(kt)}var qt;return Mt}(s,nt,ot),ht=ct===2?function(_t,Et){var St=_t[0],Mt=_t[1],It=Et[0];return function(Nt){return It(Z0(St,Mt,Nt))}}(tt,pt):function(_t,Et){var St=_t.length,Mt=St-1;return function(It){var Nt=0,Bt=!1;if(It<=_t[0]?Bt=!0:It>=_t[Mt]&&(Nt=Mt-1,Bt=!0),!Bt){for(var kt=1;kt<St&&!(_t[kt]>It||kt===Mt);kt++);Nt=kt-1}var Pt=Z0(_t[Nt],_t[Nt+1],It);return Et[Nt](Pt)}}(tt,pt);return rt?function(_t){return ht(J0(tt[0],tt[ct-1],_t))}:ht}function f_(tt,s){return tt.map(function(){return s||lC}).splice(0,tt.length-1)}function rw(tt){var s=tt.from,o=s===void 0?0:s,a=tt.to,_e=a===void 0?1:a,rt=tt.ease,nt=tt.offset,ot=tt.duration,ct=ot===void 0?300:ot,pt={done:!1,value:o},ht=Array.isArray(_e)?_e:[o,_e],_t=function(Mt,It){return Mt.map(function(Nt){return Nt*It})}(nt&&nt.length===ht.length?nt:function(Mt){var It=Mt.length;return Mt.map(function(Nt,Bt){return Bt!==0?Bt/(It-1):0})}(ht),ct);function Et(){return cE(_t,ht,{ease:Array.isArray(rt)?rt:f_(ht,rt)})}var St=Et();return{next:function(Mt){return pt.value=St(Mt),pt.done=Mt>=ct,pt},flipTarget:function(){ht.reverse(),St=Et()}}}function dE(tt){var s=tt.velocity,o=s===void 0?0:s,a=tt.from,_e=a===void 0?0:a,rt=tt.power,nt=rt===void 0?.8:rt,ot=tt.timeConstant,ct=ot===void 0?350:ot,pt=tt.restDelta,ht=pt===void 0?.5:pt,_t=tt.modifyTarget,Et={done:!1,value:_e},St=nt*o,Mt=_e+St,It=_t===void 0?Mt:_t(Mt);return It!==Mt&&(St=It-_e),{next:function(Nt){var Bt=-St*Math.exp(-Nt/ct);return Et.done=!(Bt>ht||Bt<-ht),Et.value=Et.done?It:It+Bt,Et},flipTarget:function(){}}}var AC={keyframes:rw,spring:d_,decay:dE},pE=1/60*1e3,hE=typeof performance<"u"?function(){return performance.now()}:function(){return Date.now()},h1=typeof window<"u"?function(tt){return window.requestAnimationFrame(tt)}:function(tt){return setTimeout(function(){return tt(hE())},pE)},fE=!0,nw=!1,bC=!1,f1={delta:0,timestamp:0},m1=["read","update","preRender","render","postRender"],wC=m1.reduce(function(tt,s){return tt[s]=function(o){var a=[],_e=[],rt=0,nt=!1,ot=new WeakSet,ct={schedule:function(pt,ht,_t){ht===void 0&&(ht=!1),_t===void 0&&(_t=!1);var Et=_t&&nt,St=Et?a:_e;return ht&&ot.add(pt),St.indexOf(pt)===-1&&(St.push(pt),Et&&nt&&(rt=a.length)),pt},cancel:function(pt){var ht=_e.indexOf(pt);ht!==-1&&_e.splice(ht,1),ot.delete(pt)},process:function(pt){var ht;if(nt=!0,a=(ht=[_e,a])[0],(_e=ht[1]).length=0,rt=a.length)for(var _t=0;_t<rt;_t++){var Et=a[_t];Et(pt),ot.has(Et)&&(ct.schedule(Et),o())}nt=!1}};return ct}(function(){return nw=!0}),tt},{}),kv=m1.reduce(function(tt,s){var o=wC[s];return tt[s]=function(a,_e,rt){return _e===void 0&&(_e=!1),rt===void 0&&(rt=!1),nw||vE(),o.schedule(a,_e,rt)},tt},{}),mE=m1.reduce(function(tt,s){return tt[s]=wC[s].cancel,tt},{}),UM=function(tt){return wC[tt].process(f1)},gE=function(tt){nw=!1,f1.delta=fE?pE:Math.max(Math.min(tt-f1.timestamp,40),1),f1.timestamp=tt,bC=!0,m1.forEach(UM),bC=!1,nw&&(fE=!1,h1(gE))},vE=function(){nw=!0,fE=!0,bC||h1(gE)},_E=function(){return f1},xC=kv;function yE(tt,s,o){return o===void 0&&(o=0),tt-s-o}var $M=function(tt){var s=function(o){var a=o.delta;return tt(a)};return{start:function(){return xC.update(s,!0)},stop:function(){return mE.update(s)}}};function iw(tt){var s,o,a,_e,rt,nt=tt.from,ot=tt.autoplay,ct=ot===void 0||ot,pt=tt.driver,ht=pt===void 0?$M:pt,_t=tt.elapsed,Et=_t===void 0?0:_t,St=tt.repeat,Mt=St===void 0?0:St,It=tt.repeatType,Nt=It===void 0?"loop":It,Bt=tt.repeatDelay,kt=Bt===void 0?0:Bt,Pt=tt.onPlay,qt=tt.onStop,Kt=tt.onComplete,nr=tt.onRepeat,ir=tt.onUpdate,fr=pC(tt,["from","autoplay","driver","elapsed","repeat","repeatType","repeatDelay","onPlay","onStop","onComplete","onRepeat","onUpdate"]),br=fr.to,Tr=0,Dr=fr.duration,Rr=!1,Nr=!0,Ir=function(Hr){if(Array.isArray(Hr.to))return rw;if(AC[Hr.type])return AC[Hr.type];var Lr=new Set(Object.keys(Hr));return Lr.has("ease")||Lr.has("duration")&&!Lr.has("dampingRatio")?rw:Lr.has("dampingRatio")||Lr.has("stiffness")||Lr.has("mass")||Lr.has("damping")||Lr.has("restSpeed")||Lr.has("restDelta")?d_:rw}(fr);!((o=(s=Ir).needsInterpolation)===null||o===void 0)&&o.call(s,nt,br)&&(rt=cE([0,100],[nt,br],{clamp:!1}),nt=0,br=100);var kr=Ir(fu(fu({},fr),{from:nt,to:br}));return ct&&(Pt==null||Pt(),(a=ht(function(Hr){if(Nr||(Hr=-Hr),Et+=Hr,!Rr){var Lr=kr.next(Math.max(0,Et));_e=Lr.value,rt&&(_e=rt(_e)),Rr=Nr?Lr.done:Et<=0}ir==null||ir(_e),Rr&&(Tr===0&&(Dr!=null||(Dr=Et)),Tr<Mt?function(en,vn,wn,pn){return pn?en>=vn+wn:en<=-wn}(Et,Dr,kt,Nr)&&(Tr++,Nt==="reverse"?Et=function(en,vn,wn,pn){return wn===void 0&&(wn=0),pn===void 0&&(pn=!0),pn?yE(vn+-en,vn,wn):vn-(en-vn)+wn}(Et,Dr,kt,Nr=Tr%2==0):(Et=yE(Et,Dr,kt),Nt==="mirror"&&kr.flipTarget()),Rr=!1,nr&&nr()):(a.stop(),Kt&&Kt()))})).start()),{stop:function(){qt==null||qt(),a.stop()}}}const Zy={linear:o1,easeIn:JA,easeOut:SM,easeInOut:lC,circIn:uC,circOut:eE,circInOut:cC,backIn:e0,backOut:CM,backInOut:tE,anticipate:dC,bounceOut:a1,bounceIn:TM,bounceInOut:MM,easeInOutSine:function(tt){return-(Math.cos(Math.PI*tt)-1)/2}};async function mu(tt){return new Promise(s=>setTimeout(s,Math.max(0,tt)))}function g1(tt,s,o){const a=tt[s],_e=()=>{typeof(tt==null?void 0:tt.setDirty)=="function"&&tt.setDirty(),o==null||o()};return a.isVector3||a.isVector2||a.isVector4?rt=>{a.copy(rt),_e()}:rt=>{tt[s]=rt,_e()}}function EC(tt){return typeof tt!="boolean"}async function v1(tt,s,o){s in tt||console.error("invalid key",s,tt);const a=g1(tt,s),_e=tt[s],rt=nt=>{var ot;a(nt),(ot=o.onUpdate)===null||ot===void 0||ot.call(o,nt)};if(EC(_e))return typeof o.to=="function"&&(o={...o,to:o.to(_e,tt)}),SC({...o,from:_e,onUpdate:rt});{const{duration:nt}=o;return mu(nt??0).then(()=>rt(o.to))}}async function SC(tt){return new Promise((s,o)=>{iw({onComplete:()=>{var a;(a=tt.onComplete)===null||a===void 0||a.call(tt),s()},onStop:()=>{var a;(a=tt.onStop)===null||a===void 0||a.call(tt),s()},...tt})})}class i0 extends Mv{constructor(){super(),this.passId="frameFade",this._fadeTime=0,this._fadeTimeState=0,this._toSaveFrame=!1,this._beforeFilters=["progressive","taa"],this._afterFilters=["render"],this._requiredFilters=["render","progressive"],this.dependencies=[_p],this.fadeOnActiveCameraChange=!0,this.fadeOnMaterialUpdate=!0,this.fadeOnSceneUpdate=!0,this.pointerEnabled=!0,this._fadeCam=s=>s.frameFade!==!1&&this.fadeOnActiveCameraChange&&this.startTransition(1e3),this._fadeMat=s=>{s.frameFade!==!1&&this.fadeOnMaterialUpdate&&this.startTransition(200)},this._fadeScene=s=>{s.frameFade!==!1&&this.fadeOnSceneUpdate&&this.startTransition(500)},this._onPointerMove=s=>{var o;const a=(o=this._viewer)===null||o===void 0?void 0:o.canvas;if(!a)return void(this.pointerEnabled=!1);if(!s.buttons||s.target!==a)return void(this.pointerEnabled=!0);const _e=a.getBoundingClientRect(),rt=(s.clientX-_e.left)/_e.width,nt=(s.clientY-_e.top)/_e.height;this.pointerEnabled=rt<0||rt>1||nt<0||nt>1},this._disabledBy=[],this.startTransition=this.startTransition.bind(this),this.stopTransition=this.stopTransition.bind(this),this._fadeCam=this._fadeCam.bind(this),this._fadeMat=this._fadeMat.bind(this)}async startTransition(s){this._viewer&&this._pass&&!this.isDisabled()&&(this._target||(this._target=this._viewer.renderer.getTempTarget({sizeMultiplier:1,minFilter:et.wem,magFilter:et.wem,encoding:this._viewer.renderer.composerTarget.texture.encoding})),this._fadeTimeState=Math.max(s,this._fadeTimeState),this._fadeTime=this._fadeTimeState,this._toSaveFrame=!0,this.setDirty(),await mu(s))}stopTransition(){this._fadeTimeState=0}async onAdded(s){await super.onAdded(s),s.scene.addEventListener("activeCameraChange",this._fadeCam),s.scene.addEventListener("activeCameraUpdate",this.stopTransition),s.scene.addEventListener("sceneMaterialUpdate",this._fadeMat),s.scene.addEventListener("sceneUpdate",this._fadeScene),window.addEventListener("pointermove",this._onPointerMove)}async onRemove(s){return s.scene.removeEventListener("activeCameraChange",this._fadeCam),s.scene.removeEventListener("activeCameraUpdate",this.stopTransition),s.scene.removeEventListener("sceneMaterialUpdate",this._fadeMat),s.scene.removeEventListener("sceneUpdate",this._fadeScene),window.removeEventListener("pointermove",this._onPointerMove),super.onRemove(s)}passCtor(s){const o=this,a=s.getPlugin(_p),_e=new class extends XS{constructor(){super(...arguments),this._lastTime=0,this.uiConfig=R_("Frame Fade",this)}render(rt,nt,ot,ct,pt){this.needsSwap=!1;const ht=o._target;if(!ht||!o.pointerEnabled||!this.enabled||!o.dirty||o._fadeTimeState<.001)return;o._toSaveFrame&&a.lastFrame&&(s.renderer.blit(a.lastFrame.texture,ht),this._lastTime=0,o._toSaveFrame=!1),this.blendTexture=ht==null?void 0:ht.texture;const _t=o._fadeTimeState/o._fadeTime;this.weights2.setScalar(_t),this.weights2.w=1,this.weights1.setScalar(1-_t),this.weights1.w=1,super.render(rt,nt,ot,ct,pt),this.needsSwap=!0;const Et=bo();this._lastTime<10&&(this._lastTime=Et-10);const St=Et-this._lastTime;this._lastTime=Et,o._fadeTimeState-=St}};return _e.enabled=!0,_e}setDirty(){var s;this.enabled&&((s=this._viewer)===null||s===void 0||s.setDirty())}get dirty(){return this.enabled&&this._fadeTimeState>0}set dirty(s){console.warn("FrameFadePlugin.dirty is readonly")}_update(s){return!!super._update(s)&&(this.isDisabled()&&this.stopTransition(),this._fadeTimeState<.001&&(this._toSaveFrame=!1,this._target&&this._viewer&&(this._viewer.renderer.releaseTempTarget(this._target),this._target=void 0)),!0)}get uiConfig(){var s,o;return(o=(s=this.pass)===null||s===void 0?void 0:s.passObject)===null||o===void 0?void 0:o.uiConfig}disable(s){this._disabledBy.includes(s)||this._disabledBy.push(s)}enable(s){const o=this._disabledBy.indexOf(s);o>=0&&this._disabledBy.splice(o,1)}isDisabled(){return!this.pointerEnabled||this._disabledBy.length>0||!this.enabled}}i0.PluginType="FrameFade";var AE=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt},CC=et.M8C.degToRad;class Wo extends io{constructor(s=aC,o=!1,a=!0,_e=!1){super(),this.enabled=!0,this.autoFocus=!1,this._onObjectHit=rt=>{this._viewer&&(this.enabled?this.dispatchEvent(rt):rt.intersects.selectedObject=null)},this._uiConfigChildren=[{label:"AutoFocus",type:"checkbox",property:[this,"autoFocus"],onChange:()=>{const rt=this.getSelectedObject();this.autoFocus&&rt&&this.setSelectedObject(rt,!0)}}],s&&(this._widget=new s),this._controls=o,this._pickUi=a,this.autoFocus=_e}get picker(){return this._picker}setDirty(){var s;(s=this._viewer)===null||s===void 0||s.setDirty()}getSelectedObject(){var s;if(this.enabled)return((s=this._picker)===null||s===void 0?void 0:s.selectedObject)||void 0}setSelectedObject(s,o=!1){if(!this.enabled||!this._picker)return;const a=this.autoFocus;this.autoFocus=!1,this._picker.selectedObject=s||null,this.autoFocus=a,(a||o)&&this.focusObject(s)}async onAdded(s){await super.onAdded(s),this._picker=new lM(s.scene,s.canvas,void 0,o=>{var a,_e;if(!o.material)return!1;let rt=o,nt=!1;for(;rt;){if(!rt.visible||(((a=rt.userData.iModel)!==null&&a!==void 0?a:rt).assetType==="model"&&(nt=!0),((_e=rt.userData.iModel)!==null&&_e!==void 0?_e:rt).assetType==="widget")||rt.userData.userSelectable===!1||rt.userData.bboxVisible===!1)return!1;rt=rt.parent}return nt}),this._widget&&s.scene.addWidget(this._widget),this._transformControls=new TC(s),this._transformControls.enabled=this._controls,this._picker.addEventListener("selectedObjectChanged",o=>{var a,_e,rt,nt;this.dispatchEvent(o);const ot=((a=this._picker)===null||a===void 0?void 0:a.selectedObject)||void 0;if(this._pickUi){const ht=(_e=ot)===null||_e===void 0?void 0:_e.uiConfig,_t=this.uiConfig;_t.children=[...this._uiConfigChildren],ht&&_t.children.push(ht),(rt=_t.uiRefresh)===null||rt===void 0||rt.call(_t)}const ct=this._widget;ct&&(ot?ct.attach(ot):ct.detach());const pt=this._transformControls;pt&&(!((nt=this._viewer)===null||nt===void 0)&&nt.scene.activeCamera.controls)&&(ot&&pt.enabled?pt.attach(ot):pt.detach()),s.setDirty(),this.autoFocus&&this.focusObject(ot)}),this._picker.addEventListener("hoverObjectChanged",this.dispatchEvent),this._picker.addEventListener("hitObject",this._onObjectHit),s.scene.addEventListener("select",o=>{o.value?this.setSelectedObject(o.value,this.autoFocus||o.focusCamera):console.warn("e.value must be set for picking")}),s.scene.addEventListener("addSceneObject",async o=>{var a,_e,rt;const nt=o.object,ot=this.getSelectedObject();if(ot&&(nt==null?void 0:nt.assetType)==="material"&&typeof(ot==null?void 0:ot.setMaterial)=="function"&&(!((a=ot==null?void 0:ot.modelObject)===null||a===void 0)&&a.isMesh)&&await s.confirm("Applying material: Apply material to the selected object?")){const ct=ot.material;if(Array.isArray(ct))console.warn("Dropping on material array not yet fully supported."),ot.setMaterial(nt);else{let pt=Array.from((_e=ct==null?void 0:ct.userData.__appliedMeshes)!==null&&_e!==void 0?_e:[]);(pt.length>1?!await s.confirm("Applying material: Apply to all objects using this material?"):pt.length<1)&&(pt=[ot]);for(const ht of pt)ht&&((rt=ht.setMaterial)===null||rt===void 0||rt.call(ht,nt))}}}),s.scene.addEventListener("sceneUpdate",o=>{if(!o.hierarchyChanged)return;const a=this.getSelectedObject();let _e=!1;a==null||a.traverseAncestors(rt=>{rt===s.scene.modelObject&&(_e=!0)}),_e||this.setSelectedObject(void 0)})}async focusObject(s){var o,a,_e,rt;const nt=(o=this._viewer)===null||o===void 0?void 0:o.getPluginByType("CameraViews");await(nt==null?void 0:nt.animateToObject(s,4,1e3,"easeOut",{min:((rt=(_e=(a=this._viewer)===null||a===void 0?void 0:a.scene.activeCamera.getControls())===null||_e===void 0?void 0:_e.minDistance)!==null&&rt!==void 0?rt:.5)+.5,max:5}))}get uiConfig(){return this._pickUi?this._uiConfig?this._uiConfig:this._uiConfig={type:"folder",label:"Picker",expanded:!0,children:[...this._uiConfigChildren]}:{}}get transformControls(){return this._transformControls}get widget(){return this._widget}}Wo.PluginType="Picking",AE([Yr(),ds()],Wo.prototype,"enabled",void 0),AE([Yr()],Wo.prototype,"autoFocus",void 0);class TC extends AP{constructor(s){super(s.scene.activeCamera.cameraObject,s.canvas),this.modelObject=this,this.assetType="widget",this._activeCameraChange=this._activeCameraChange.bind(this),this._scene=s.scene,this._scene.addEventListener("activeCameraChange",this._activeCameraChange),this.visible=!1,this.userData.bboxVisible=!1,this.addEventListener("objectChange",()=>{var o;(o=this==null?void 0:this.object)===null||o===void 0||o.dispatchEvent({type:"objectUpdate",fadeFrame:!1})}),this.addEventListener("dragging-changed",o=>{const a=s==null?void 0:s.getPlugin(i0);a&&(a.enabled=!o.value),this._scene.activeCamera.interactionsEnabled=!o.value}),this._keyDownListener=this._keyDownListener.bind(this),window.addEventListener("keydown",this._keyDownListener),window.addEventListener("keyup",this._keyUpListener),this._scene.addWidget(this)}_keyDownListener(s){if(this.enabled&&this.object){switch(s.keyCode){case 81:this.setSpace(this.space==="local"?"world":"local");break;case 16:this.setTranslationSnap(100),this.setRotationSnap(CC(15)),this.setScaleSnap(.25);break;case 87:this.setMode("translate");break;case 69:this.setMode("rotate");break;case 82:this.setMode("scale");break;case 187:case 107:this.setSize(this.size+.1);break;case 189:case 109:this.setSize(Math.max(this.size-.1,.1));break;case 88:this.showX=!this.showX;break;case 89:this.showY=!this.showY;break;case 90:this.showZ=!this.showZ;break;case 32:this.enabled=!this.enabled;break;default:return}this._scene.setDirty({sceneUpdate:!0,frameFade:!0})}}_keyUpListener(s){this.enabled&&(s.keyCode===16&&(this.setTranslationSnap(null),this.setRotationSnap(null),this.setScaleSnap(null)),this.object&&s.keyCode)}_activeCameraChange(){this.camera=this._scene.activeCamera.cameraObject}dispose(){window.removeEventListener("keydown",this._keyDownListener),window.removeEventListener("keyup",this._keyUpListener),this._scene.removeEventListener("activeCameraChange",this._activeCameraChange),this._scene.modelObject.remove(this),super.dispose()}}var sw=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};class ru extends io{constructor(){super(),this.offsetCache={},this.enabled=!0,this.envMap=null,this.forceSceneEnvMap=!1,this.getEnvMap=()=>{var s;return!this.forceSceneEnvMap&&this.envMap?this.envMap:((s=this._viewer)===null||s===void 0?void 0:s.scene.getEnvironment())||null},this._modelProcessor={forAssetType:"model",processAsync:async(s,o)=>{const a=[];return s.modelObject.traverse(_e=>{var rt,nt,ot,ct;const pt=(nt=(rt=_e.userData)===null||rt===void 0?void 0:rt.gltfExtensions)===null||nt===void 0?void 0:nt[ru.DIAMOND_GLTF_EXTENSION];pt&&_e.geometry&&(this.prepareDiamondMesh(_e,pt),delete _e.userData.gltfExtensions[ru.DIAMOND_GLTF_EXTENSION]),_e.material&&!a.includes(_e.material)&&(!((ct=(ot=_e.material.userData)===null||ot===void 0?void 0:ot.gltfExtensions)===null||ct===void 0)&&ct[ru.DIAMOND_GLTF_EXTENSION])&&(_e.material.materialObject||console.warn("material not processed",_e.material),a.push(_e.material))}),a.forEach(_e=>{const rt=_e.userData.gltfExtensions[ru.DIAMOND_GLTF_EXTENSION];rt&&this._convertToDiamondMaterial(_e,rt)}),s}},this.uiConfig={type:"folder",label:"Diamonds",children:[{type:"toggle",label:"Use Scene Environment",property:[this,"forceSceneEnvironment"],limitedUi:!0},{type:"image",label:"Environment",hidden:()=>this.forceSceneEnvMap,property:[this,"envMap"],limitedUi:!0},{type:"slider",bounds:[0,2*Math.PI],hidden:()=>this.forceSceneEnvMap,label:"Env Rotation",property:[this,"envMapRotation"],limitedUi:!0},{type:"button",label:"Make Diamond",hidden:()=>{var s,o,a;const _e=(a=(o=(s=this._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0?void 0:o.getSelectedObject())===null||a===void 0?void 0:a.material;return!!Array.isArray(_e)||(_e==null?void 0:_e.typeSlug)!==tp.TypeSlug},value:async()=>{var s,o,a,_e,rt,nt;const ot=(o=(s=this._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0?void 0:o.getSelectedObject();if(!(ot!=null&&ot.material))return;const ct=await((a=this._viewer)===null||a===void 0?void 0:a.prompt("Cache key: Enter optional cache key unique to the diamond shape.","",!1));let pt=parseInt(await((_e=this._viewer)===null||_e===void 0?void 0:_e.prompt("Cache size: Enter size of the cache [64-1024]","512",!1))||"512");isFinite(pt)||(pt=512),pt<64&&(pt=64),((rt=ot.material.userData)===null||rt===void 0?void 0:rt.__appliedMeshes.size)>1&&await((nt=this._viewer)===null||nt===void 0?void 0:nt.confirm("Convert all: Apply diamond material to all the meshes with the same material?"))?this.makeDiamond(ot.material,{cacheKey:ct||void 0,normalMapRes:pt},{}):this.makeDiamondMesh(ot,{cacheKey:ct||void 0,normalMapRes:pt},{}),this.refreshUi()},limitedUi:!0},{type:"button",label:"Make Standard",hidden:()=>{var s,o,a;const _e=(a=(o=(s=this._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0?void 0:o.getSelectedObject())===null||a===void 0?void 0:a.material;return!!Array.isArray(_e)||(_e==null?void 0:_e.typeSlug)!==Ul.TypeSlug},value:async()=>{var s,o,a,_e,rt,nt,ot,ct;const pt=(o=(s=this._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0?void 0:o.getSelectedObject(),ht=pt==null?void 0:pt.material;if(!ht)return;const _t=ht.userData._baseMaterial;let Et=(rt=(_e=(a=this._viewer)===null||a===void 0?void 0:a.getManager())===null||_e===void 0?void 0:_e.materials)===null||rt===void 0?void 0:rt.findMaterial(_t);if(Et&&!Et.isDiamondMaterial||(Et=(nt=this._viewer)===null||nt===void 0?void 0:nt.createPhysicalMaterial({color:ht.color})),Et){const St=ht.userData.__appliedMeshes.size>1&&await((ot=this._viewer)===null||ot===void 0?void 0:ot.confirm("Convert all with this material?"))?Array.from(ht.userData.__appliedMeshes):[pt];for(const Mt of St)(ct=Mt==null?void 0:Mt.setMaterial)===null||ct===void 0||ct.call(Mt,Et)}this.refreshUi()},limitedUi:!0}]},this.refreshEnvMaps=this.refreshEnvMaps.bind(this),this.refreshUi=this.refreshUi.bind(this)}get envMapRotation(){var s,o;return(o=(s=this.envMap)===null||s===void 0?void 0:s.rotation)!==null&&o!==void 0?o:0}set envMapRotation(s){var o;const a=this.envMap;a&&(a.rotation=s,(o=this._viewer)===null||o===void 0||o.scene.setDirty())}refreshEnvMaps(){var s,o,a;if(!this._viewer)return;const _e=this.getEnvMap(),rt=((o=(s=this._viewer.getPlugin(os))===null||s===void 0?void 0:s.materials)===null||o===void 0?void 0:o.getMaterialsOfType(Ul.TypeSlug))||[];for(const nt of rt)nt&&nt.envMap!==_e&&(nt.envMap=_e,nt.needsUpdate=!0);(a=this._viewer)===null||a===void 0||a.scene.setDirty()}refreshUi(){var s,o,a;(s=this._viewer)===null||s===void 0||s.setDirty(),(a=(o=this.uiConfig)===null||o===void 0?void 0:o.uiRefresh)===null||a===void 0||a.call(o,"postFrame",!0)}async onAdded(s){var o,a,_e,rt,nt,ot;this._normalCapture=new nM(s.renderer),this.offsetCache={},s.scene.addEventListener("environmentChanged",this.refreshEnvMaps);const ct=s.getPlugin(os);(o=ct==null?void 0:ct.importer)===null||o===void 0||o.processors.add("model",this._modelProcessor),(a=s.getPlugin(Wo))===null||a===void 0||a.addEventListener("selectedObjectChanged",this.refreshUi);const pt=this.getEnvMap,ht=new Yl(class extends IA{async loadAsync(_t,Et){var St;const Mt=await super.loadAsync(_t,Et);return Mt.type===Ul.TYPE||Mt.isDiamondMaterialParameters?(Mt.envMap=pt(),(St=ct==null?void 0:ct.materials)===null||St===void 0?void 0:St.generateFromTemplate("diamond",Mt)):(console.error("Invalid material type for Diamond Material.",Mt),null)}},[Ul.TypeSlug],!1);return mo.Importers.push(ht),(nt=(rt=(_e=ct==null?void 0:ct.exporter)===null||_e===void 0?void 0:_e.getExporter("gltf","glb"))===null||rt===void 0?void 0:rt.extensions)===null||nt===void 0||nt.push(_1),(ot=ct==null?void 0:ct.materials)===null||ot===void 0||ot.registerMaterialTemplate({name:"diamond",materialType:Ul.TYPE,isDiamondMaterialParameters:!0,generator:(_t,Et)=>{const St=new Ul(_t);return St.envMap=pt(),Et&&Et!=={}&&St.copyProps(Et),St}}),super.onAdded(s)}async onRemove(s){var o,a,_e,rt;return(o=this._normalCapture)===null||o===void 0||o.dispose(),this._normalCapture=void 0,this.offsetCache={},(_e=(a=s.getPlugin(os))===null||a===void 0?void 0:a.importer)===null||_e===void 0||_e.processors.remove("model",this._modelProcessor),(rt=s.getPlugin(Wo))===null||rt===void 0||rt.removeEventListener("selectedObjectChanged",this.refreshUi),super.onRemove(s)}prepareDiamondMesh(s,{cacheKey:o,normalMapRes:a}){var _e,rt,nt;s.userData._diamondCacheKey=o??s.userData._diamondCacheKey,s.userData._diamondNormalMapRes=a??s.userData._diamondNormalMapRes,o=o&&o.length>0?o.includes(";"+s.geometry.uuid)?o:o+";"+s.geometry.uuid:s.geometry.uuid,this._computeOffsets(s.geometry,s.geometry.uuid);const ot=(rt=(_e=this._normalCapture)===null||_e===void 0?void 0:_e.captureNormalMap(s.geometry,o,a))!==null&&rt!==void 0?rt:[void 0,!1],ct=(nt=this._viewer)===null||nt===void 0?void 0:nt.getPluginByType("debug");ct&&ot&&(ct.counters.normalsCapture||(ct.counters.normalsCapture=0),ct.counters.normalsCapture++,console.log("DEBUG: new normal map captured",ct.counters.normalsCapture,o),ct.addTexture("normal"+ct.counters.normalsCapture,()=>{var pt;return(pt=s.geometry.userData._normalsCaptureMap)===null||pt===void 0?void 0:pt.texture},[40,110*ct.counters.normalsCapture-100,200,100],void 0,void 0,"postRender",!0))}makeDiamond(s,o,a){var _e,rt;Array.from((_e=s==null?void 0:s.userData.__appliedMeshes)!==null&&_e!==void 0?_e:[]).forEach(nt=>{nt!=null&&nt.isMesh&&nt.geometry&&this.prepareDiamondMesh(nt,o)}),this._convertToDiamondMaterial(s,a),(rt=this._viewer)===null||rt===void 0||rt.setDirty()}makeDiamondMesh(s,o,a){if(!s.modelObject.isMesh||!s.geometry||!s.setMaterial)return;this.prepareDiamondMesh(s.modelObject,o);const _e=Array.isArray(s.material)?s.material[0]:s.material,rt=this._convertToDiamondMaterial(_e,a,!1);s.setMaterial(rt)}_convertToDiamondMaterial(s,o={isDiamond:!0},a=!0){var _e,rt,nt,ot,ct,pt,ht;let _t={...o??{}};_t.isDiamond||_t.isDiamondMaterialParameters?Array.isArray(_t.boostFactors)&&(_t.boostFactors=new et.Pa4().fromArray(_t.boostFactors)):_t={isDiamondMaterialParameters:!0},_t.color=(nt=(_e=_t.color)!==null&&_e!==void 0?_e:(rt=s==null?void 0:s.materialObject)===null||rt===void 0?void 0:rt.color)!==null&&nt!==void 0?nt:new ys(1,1,1);const Et=(pt=(ct=(ot=this._viewer)===null||ot===void 0?void 0:ot.getManager())===null||ct===void 0?void 0:ct.materials)===null||pt===void 0?void 0:pt.generateFromTemplate("diamond",_t);if(Et&&s&&!s.isDiamondMaterial&&(Et.userData._baseMaterial=s.uuid),a){const St=Mt=>{var It;return(It=Mt.setMaterial)!==null&&It!==void 0?It:Nt=>{Mt.material=Nt.materialObject}};Array.from((ht=s==null?void 0:s.userData.__appliedMeshes)!==null&&ht!==void 0?ht:[]).forEach(Mt=>{St(Mt)(Et),this.prepareDiamondMesh(Mt,o)})}return Et}_computeOffsets(s,o,a=!1){const _e=o.split(";").find(pt=>this.offsetCache[pt]);if(_e&&!a){const pt=this.offsetCache[_e];return o.split(";").forEach(ht=>ht!==_e&&(this.offsetCache[ht]=pt)),s.userData._normalsCaptureOffsets=pt,pt}s.computeBoundingBox();const rt=s.boundingBox.getCenter(new et.Pa4),nt=oM(s),ot=nt.clone().invert(),ct={center:rt,offsetMatrix:nt,offsetMatrixInv:ot,radius:1,centerOffset:new et.Pa4().copy(rt).applyMatrix4(ot)};return o.split(";").forEach(pt=>this.offsetCache[pt]=ct),s.userData._normalsCaptureOffsets=ct,ct}}ru.PluginType="Diamond",ru.DIAMOND_GLTF_EXTENSION="WEBGI_materials_diamond",sw([vr(ru.prototype.refreshEnvMaps),Yr()],ru.prototype,"envMap",void 0),sw([vr(ru.prototype.refreshEnvMaps),Yr()],ru.prototype,"forceSceneEnvMap",void 0);const _1=tt=>({writeMaterial:(s,o)=>{s.isDiamondMaterial&&(o.extensions=o.extensions||{},o.extensions[ru.DIAMOND_GLTF_EXTENSION]=s.toJSON(),tt.extensionsUsed[ru.DIAMOND_GLTF_EXTENSION]=!0)},writeMesh:(s,o)=>{var a,_e;if(!(s!=null&&s.material.isDiamondMaterial))return;o.extensions=o.extensions||{};const rt={};(_e=(a=s.userData)===null||a===void 0?void 0:a.gltfExtensions)===null||_e===void 0||delete _e[ru.DIAMOND_GLTF_EXTENSION],s.userData._diamondNormalMapRes&&(rt.normalMapRes=s.userData._diamondNormalMapRes),s.userData._diamondCacheKey&&(rt.cacheKey=s.userData._diamondCacheKey),o.extensions[ru.DIAMOND_GLTF_EXTENSION]=rt,tt.extensionsUsed[ru.DIAMOND_GLTF_EXTENSION]=!0}});var Bm,qu=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let Gl=Bm=class extends io{constructor(){super(),this.enabled=!0,this.animations=[],this.loopAnimations=!0,this.loopRepetitions=1/0,this.timeScale=0,this.animateOnScroll=!1,this.animationSpeed=1,this._scrollAnimationState=0,this.scrollAnimationDamping=.1,this.dependencies=[os],this._lastFrameTime=0,this._fadeDisabled=!1,this._objectAdded=tt=>{const s=tt.object;s.assetType==="model"&&s.modelObject&&this._viewer&&s.modelObject.traverse(o=>{const a=o.animations;if(a.length<1)return;const _e=Math.max(...a.map(ot=>ot.duration));a.forEach(ot=>ot.duration=_e);const rt=new et.Xcj(this._viewer.scene.modelRoot.modelObject),nt=a.map(ot=>rt.clipAction(ot).setLoop(this.loopAnimations?et.YKA:et.jAl,this.loopRepetitions));this.animations.push({mixer:rt,clips:a,actions:nt,duration:_e}),this.onPropertyChange()})},this._animationTime=0,this._animationDuration=0,this._animationState="none",this.uiConfig=void 0,this._lastAnimId="",this.timelineMarkers=[],this._postFrame=this._postFrame.bind(this),this._wheel=this._wheel.bind(this),this.playClips=this.playClips.bind(this),this.playClip=this.playClip.bind(this),this.playAnimation=this.playAnimation.bind(this),this.playPauseAnimation=this.playPauseAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.stopAnimation=this.stopAnimation.bind(this),this.resetAnimation=this.resetAnimation.bind(this),this.onPropertyChange=this.onPropertyChange.bind(this),this._loaderCreate=this._loaderCreate.bind(this)}get animationState(){return this._animationState}get animationTime(){return this._animationTime}get animationDuration(){return this._animationDuration}_wheel({deltaY:tt}){this.enabled&&Math.abs(tt)>.001&&(this._scrollAnimationState=-1*Math.sign(tt))}_postFrame(){var tt,s;if(!this._viewer)return;const o=this._viewer,a=this.animateOnScroll;if(!this.enabled||this.animations.length<1||this._animationState!=="playing"&&!a)return this._lastFrameTime=0,void(this._fadeDisabled&&((tt=this._viewer.getPluginByType("FrameFade"))===null||tt===void 0||tt.enable(Bm.PluginType),this._fadeDisabled=!1));const _e=bo()/1e3;this._lastFrameTime<1&&(this._lastFrameTime=_e-1/30);let rt=_e-this._lastFrameTime;if(rt*=this.animationSpeed,this._lastFrameTime=_e,a&&(rt*=this._scrollAnimationState),Math.abs(rt)<1e-4)return;const nt=(s=this._viewer.getPluginByType("Progressive"))===null||s===void 0?void 0:s.postFrameConvergedRecordingDelta();if(nt&&nt>0&&(rt=nt),nt!==0&&(this.animations.map(ot=>ot.mixer.update(rt)),this._animationTime+=rt,this._animationTime>this._animationDuration&&(this._animationTime-=this._animationDuration),this._animationTime<0&&(this._animationTime+=this._animationDuration),this._scrollAnimationState<.001?this._scrollAnimationState=0:this._scrollAnimationState*=1-this.scrollAnimationDamping,o.scene.activeCamera.cameraObject.userData.__animatingCamera&&o.scene.activeCamera.setDirty(),o.renderer.resetShadows(),o.setDirty(),!this._fadeDisabled)){const ot=this._viewer.getPluginByType("FrameFade");ot&&(ot.disable(Bm.PluginType),this._fadeDisabled=!0)}}_loaderCreate({loader:tt}){tt.isGLTFLoader2&&tt.register(s=>new s0(s,this))}async onAdded(tt){var s,o,a,_e,rt,nt;(o=(s=tt.getPlugin(os))===null||s===void 0?void 0:s.importer)===null||o===void 0||o.addEventListener("loaderCreate",this._loaderCreate),tt.scene.addEventListener("addSceneObject",this._objectAdded),(nt=(rt=(_e=(a=tt.getPlugin(os))===null||a===void 0?void 0:a.exporter)===null||_e===void 0?void 0:_e.getExporter("gltf","glb"))===null||rt===void 0?void 0:rt.extensions)===null||nt===void 0||nt.push(y1),tt.addEventListener("postFrame",this._postFrame),window.addEventListener("wheel",this._wheel);let ot=-1;return Object.defineProperty(tt.scene.modelRoot,"currentTimelineMarker",{get:()=>ot,set:ct=>tt.scene.modelRoot.dispatchEvent({type:"animationTimelineMarker",marker:this.timelineMarkers[ot=ct]})}),tt.scene.modelRoot.addEventListener("animationTimelineMarker",({marker:ct})=>{var pt;if(!this._viewer)return;if(!ct)return this._viewer.scene.activeCamera=(pt=this._viewer)===null||pt===void 0?void 0:pt.scene.defaultCamera,void this._viewer.setDirty();const ht=ct.camera;ht&&(ht.userData.__animatingCamera=!0,this._viewer.scene.activeCamera=this._viewer.createCamera(ht))}),super.onAdded(tt)}async onRemove(tt){var s,o;return tt.scene.removeEventListener("addSceneObject",this._objectAdded),(o=(s=tt.getPlugin(os))===null||s===void 0?void 0:s.importer)===null||o===void 0||o.addEventListener("loaderCreate",this._loaderCreate),tt.removeEventListener("postFrame",this._postFrame),window.removeEventListener("wheel",this._wheel),super.onRemove(tt)}onPropertyChange(){this._animationState==="playing"&&this.playAnimation(),this._animationDuration=Math.max(...this.animations.map(({duration:tt})=>tt))}onStateChange(){var tt,s;(s=(tt=this.uiConfig)===null||tt===void 0?void 0:tt.children)===null||s===void 0||s.map(o=>o&&er(o)).flat(2).forEach(o=>{var a;return(a=o==null?void 0:o.uiRefresh)===null||a===void 0?void 0:a.call(o)})}playPauseAnimation(){this._animationState==="playing"?this.pauseAnimation():this.playAnimation()}async playClip(tt,s=!1){return this.playClips([tt],s)}async playClips(tt,s=!1){const o=[];return this.animations.forEach(({actions:a})=>{a.forEach(_e=>{tt.includes(_e.getClip().name)&&o.push(_e)})}),this.playAnimation(s,o)}async playAnimation(tt=!1,s){var o,a,_e;if(!this.enabled)return;this._animationState==="playing"&&this.stopAnimation(!1),dr((a=(o=this._viewer)===null||o===void 0?void 0:o.getPluginByType("Picking"))===null||a===void 0?void 0:a.transformControls,"enabled",!1);let rt=0;s||(s=[],this.animations.forEach(({mixer:ct,actions:pt,clips:ht})=>{s.push(...pt)}));const nt=Mo();this._lastAnimId=nt,this._animationState!=="paused"&&this.resetAnimation();for(const ct of s)this.timeScale>0&&(ct.timeScale=this.timeScale),ct.setLoop(this.loopAnimations?et.YKA:et.jAl,this.loopRepetitions),ct.play(),rt=Math.max(rt,ct.getClip().duration/ct.timeScale);if(this._animationState="playing",(_e=this._viewer)===null||_e===void 0||_e.setDirty(),rt*=this.loopAnimations?this.loopRepetitions:1,rt/=this.animationSpeed,!isFinite(rt))return;const ot=1e3*rt-this._animationTime/this.animationSpeed+.01;ot>0&&await mu(ot),nt===this._lastAnimId&&this.stopAnimation(tt)}pauseAnimation(){var tt,s,o;this._animationState="paused",dr((s=(tt=this._viewer)===null||tt===void 0?void 0:tt.getPluginByType("Picking"))===null||s===void 0?void 0:s.transformControls,"enabled",!0),(o=this._viewer)===null||o===void 0||o.setDirty(),this._lastAnimId=""}stopAnimation(tt=!1){var s,o,a;this._animationState="stopped",dr((s=this._viewer)===null||s===void 0?void 0:s.getPluginByType("Picking"),"enabled",!0),tt?this.resetAnimation():(o=this._viewer)===null||o===void 0||o.setDirty(),this._lastAnimId="",this._viewer&&this._fadeDisabled&&((a=this._viewer.getPluginByType("FrameFade"))===null||a===void 0||a.enable(Bm.PluginType),this._fadeDisabled=!1)}resetAnimation(){var tt;this._animationState==="stopped"?(this.animations.forEach(({mixer:s,actions:o,clips:a})=>{s.stopAllAction(),s.setTime(0)}),this._animationTime=0,(tt=this._viewer)===null||tt===void 0||tt.setDirty()):this.stopAnimation(!0)}};Gl.PluginType="GLTFAnimation",Gl.AnimationMarkersExtension="WEBGI_animation_markers",qu([Hm()],Gl.prototype,"animationState",null),qu([Hm()],Gl.prototype,"animationTime",null),qu([Hm()],Gl.prototype,"animationDuration",null),qu([vr(Bm.prototype.onPropertyChange),ds("Loop",{limitedUi:!0})],Gl.prototype,"loopAnimations",void 0),qu([vr(Bm.prototype.onPropertyChange)],Gl.prototype,"loopRepetitions",void 0),qu([vr(Bm.prototype.onPropertyChange)],Gl.prototype,"timeScale",void 0),qu([ds(),Yr()],Gl.prototype,"animateOnScroll",void 0),qu([gs("Speed",[.1,4],.1,{limitedUi:!0}),Yr()],Gl.prototype,"animationSpeed",void 0),qu([vr(Bm.prototype.onStateChange)],Gl.prototype,"_animationState",void 0),qu([Qo("Play/Pause",tt=>({label:()=>tt.animationState==="playing"?"Pause":"Play",limitedUi:!0}))],Gl.prototype,"playPauseAnimation",null),qu([Qo("Stop",{limitedUi:!0})],Gl.prototype,"stopAnimation",null),qu([Qo("Reset",{limitedUi:!0})],Gl.prototype,"resetAnimation",null),Gl=Bm=qu([Ao("GLTF Animations")],Gl);class s0{constructor(s,o){this.parser=s,this.name=Gl.AnimationMarkersExtension,this.plugin=o}async afterRoot(s){var o;let a=[];for(const Et of this.parser.json.scenes){if(!Et.extensions)continue;const St=Et.extensions[this.name];for(const Mt of(St==null?void 0:St.markers)||[]){const It=Mt.camera!==void 0?await this.parser.getDependency("camera",Mt.camera):void 0;Mt.time===void 0&&(Mt.time=Mt.frame/30,console.error("Update timeline markers plugin for correct times.")),a.push({name:Mt.name,frame:Mt.frame,time:Mt.time,camera:It})}}if(a.length<1)return;a=a.sort((Et,St)=>Et.frame-St.frame);const _e=(o=s.scene)!==null&&o!==void 0?o:s.scenes[0];if(!_e)return;_e.userData.__markers=a;const rt=this.plugin.timelineMarkers,nt=a.map(Et=>Et.time);let ot=rt.length;const ct=a.map(Et=>ot++),pt=Math.max(...nt)+.01;rt.push(...a);const ht=new et.dUE(".currentTimelineMarker",nt,ct,2300),_t=new et.m7l("animationTimelineMarker",pt,[ht]);_t.__gltfExport=!1,s.animations.push(_t)}}const y1=tt=>({afterParse(s){const o=tt.json.scenes[tt.json.scene||0];o.extensions=o.extensions||{};const a={markers:[]},_e=[];if((Array.isArray(s)?s:[s]).forEach(rt=>rt.traverse(nt=>{nt.userData.__markers&&_e.push(...nt.userData.__markers)})),_e.sort((rt,nt)=>rt.frame-nt.frame),!(_e.length<1)){for(const rt of _e){const nt=rt.camera;if(nt){const ot=tt.nodeMap.get(nt);if(ot===void 0){console.warn("Camera not found in gltf export",nt,tt.nodeMap);continue}const ct=tt.json.nodes[ot].camera;rt.camera=ct,a.markers.push(rt)}}o.extensions[Gl.AnimationMarkersExtension]=a,tt.extensionsUsed[Gl.AnimationMarkersExtension]=!0}}});class Ov extends it{constructor(){super(...arguments),this.dirty=!1,this.counters={},this._generators=new Map,this._preRender=()=>this._showDebug("preRender"),this._postRender=()=>this._showDebug("postRender")}async onAdded(s){this._viewer=s,s.addEventListener("preRender",this._preRender),s.addEventListener("postRender",this._postRender)}addTexture(s,o,a,_e,rt,nt="postRender",ot=!1){var ct;this._generators.has(nt)||this._generators.set(nt,[]),(ct=this._generators.get(nt))===null||ct===void 0||ct.push({key:s,fn:o,rect:a?[...a]:void 0,frag:rt||_e||ot?new et.jyz({vertexShader:ut.vertexShader,uniforms:{tDiffuse:{value:null},opacity:{value:1}},fragmentShader:rt??`
        #include <common>
        #include <packing>
        uniform float opacity;
		uniform ${ot?"samplerCube":"sampler2D"} tDiffuse;
		varying vec2 vUv;
		void main() {
			vec4 texel = ${ot?"textureCube( tDiffuse, vec3(cos(vUv.y * PI2) * cos(vUv.x * PI2), sin(vUv.y * PI2), cos(vUv.y * PI2) * sin(vUv.x * PI2)) )":"texture2D( tDiffuse, vUv )"};
			${_e??""}
			gl_FragColor = opacity * texel;
		}
            `}):void 0})}removeTexture(s,o="postRender"){var a,_e;this._generators.set(o,(_e=(a=this._generators.get(o))===null||a===void 0?void 0:a.filter(rt=>rt.key!==s))!==null&&_e!==void 0?_e:[])}async onDispose(s){return Promise.resolve(void 0)}async onRemove(s){return s.removeEventListener("preRender",this._preRender),s.removeEventListener("postRender",this._postRender),this._viewer=void 0,Promise.resolve(void 0)}_showDebug(s){var o;const a=this._viewer,_e=a==null?void 0:a.renderer;_e&&a&&((o=this._generators.get(s))===null||o===void 0||o.forEach(({key:rt,fn:nt,rect:ot,frag:ct})=>{const pt=nt(a);if(pt){if(pt.image&&ot){const ht=pt.image.width/pt.image.height;ot[2]<1&&ot[3]<1&&(ot[2]=200),ot[2]<1&&(ot[2]=ot[3]*ht),ot[3]<1&&(ot[3]=ot[2]/ht)}_e.blit(pt,void 0,{viewport:ot,clear:!1,material:ct})}}))}}Ov.PluginType="debug";var ow=function(tt,s){return ow=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,a){o.__proto__=a}||function(o,a){for(var _e in a)Object.prototype.hasOwnProperty.call(a,_e)&&(o[_e]=a[_e])},ow(tt,s)};function A1(tt,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");function o(){this.constructor=tt}ow(tt,s),tt.prototype=s===null?Object.create(s):(o.prototype=s.prototype,new o)}var aw,bE=function(){function tt(){}return tt._xfnv1a=function(s){for(var o=2166136261,a=0;a<s.length;a++)o=Math.imul(o^s.charCodeAt(a),16777619);return function(){return o+=o<<13,o^=o>>>7,o+=o<<3,o^=o>>>17,(o+=o<<5)>>>0}},tt}(),eA=function(tt){function s(o){var a=tt.call(this)||this;return a.a=s._xfnv1a(o)(),a}return A1(s,tt),s.prototype.next=function(){var o=this.a+=1831565813;return o=Math.imul(o^o>>>15,1|o),(((o^=o+Math.imul(o^o>>>7,61|o))^o>>>14)>>>0)/4294967296},s}(bE),jM=function(tt){function s(o){var a=tt.call(this)||this,_e=s._xfnv1a(o);return a.a=_e(),a.b=_e(),a.c=_e(),a.d=_e(),a}return A1(s,tt),s.prototype.next=function(){this.a>>>=0,this.b>>>=0,this.c>>>=0,this.d>>>=0;var o=this.a+this.b|0;return this.a=this.b^this.b>>>9,this.b=this.c+(this.c<<3)|0,this.c=this.c<<21|this.c>>>11,this.d=this.d+1|0,o=o+this.d|0,this.c=this.c+o|0,(o>>>0)/4294967296},s}(bE),ry=function(tt){function s(o){var a=tt.call(this)||this,_e=s._xfnv1a(o);return a.a=_e(),a.b=_e(),a.c=_e(),a.d=_e(),a}return A1(s,tt),s.prototype.next=function(){var o=this.b<<9,a=5*this.a;return a=a<<7|9*(a>>>25),this.c^=this.a,this.d^=this.b,this.b^=this.c,this.a^=this.d,this.c^=o,this.d=this.d<<11|this.d>>>21,(a>>>0)/4294967296},s}(bE);(function(tt){tt.sfc32="sfc32",tt.mulberry32="mulberry32",tt.xoshiro128ss="xoshiro128ss"})(aw||(aw={}));var b1=function(){function tt(s,o){o===void 0&&(o=aw.sfc32),this.str=s,this.prng=o,this.generator=this._initializeGenerator()}return tt.prototype.next=function(){return this.generator.next()},tt.prototype._initializeGenerator=function(){if(function(o){return o===null}(s=this.str)||function(o){return o===void 0}(s))return this.wrap();var s;switch(this.prng){case"sfc32":return new jM(this.str);case"mulberry32":return new eA(this.str);case"xoshiro128ss":return new ry(this.str);default:return this.wrap()}},tt.prototype.wrap=function(){return{next:function(){return Math.random()}}},tt}(),zM=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};class w1 extends c_{constructor(s,o,a,_e){super(s,o),this._shadowParams={enabled:!0,radius:2,width:1024,height:1024,bias:-.001,normalBias:0,near:1.5,far:4,frustumSize:4},this._randomParams={focus:1,spread:.01,distanceScale:50,minDistanceScale:new et.Pa4(10,10,10),normalDirection:new et.Pa4(.01,.98,.01).normalize(),direction:new et.Pa4(-.9,.5,-1)},this.isRandomizedDirectionalLight=!0,this.shadowParams=a??{},this.randomParams=_e??{},this.updateShadowParams=this.updateShadowParams.bind(this)}get shadowParams(){return this._shadowParams}set shadowParams(s){Object.keys(s).forEach(o=>s[o]===void 0&&delete s[o]),this._shadowParams={...this._shadowParams,...s},this.updateShadowParams()}get randomParams(){return this._randomParams}set randomParams(s){Object.keys(s).forEach(o=>s[o]===void 0&&delete s[o]),Object.assign(this._randomParams,s)}updateShadowParams(){this.castShadow=this._shadowParams.enabled,this.shadow.mapSize.x=this._shadowParams.width,this.shadow.mapSize.y=this._shadowParams.height,this.shadow.bias=this._shadowParams.bias,this.shadow.normalBias=this._shadowParams.normalBias,this.refreshShadowCamNearFar(),this.shadow.radius=this._shadowParams.radius,this.shadow.camera.right=this._shadowParams.frustumSize/2,this.shadow.camera.left=-this._shadowParams.frustumSize/2,this.shadow.camera.top=this._shadowParams.frustumSize/2,this.shadow.camera.bottom=-this._shadowParams.frustumSize/2,this.shadow.camera.updateProjectionMatrix(),this.matrixWorldNeedsUpdate=!0}randomizePosition(s,o=null,a=null){const _e=new b1(s.toString()),rt=new et.FM8(_e.next()*Math.PI*2,Math.asin(2*_e.next()-1));let nt=new et.Pa4(Math.cos(rt.x)*Math.cos(rt.y),Math.sin(rt.y),Math.sin(rt.x)*Math.cos(rt.y));const ot=new et.FM8;for(let ct=0;ct<5;ct++){ot.set(_e.next(),_e.next()),nt=VM(ot,this._randomParams.normalDirection,.4),_e.next()<Math.sqrt(o??this._randomParams.focus)&&(ot.set(_e.next(),_e.next()),nt=VM(ot,this._randomParams.direction,Math.pow((a??this._randomParams.spread)/2,2)));const pt=nt.dot(this._randomParams.normalDirection);if(pt>0&&pt<.4)break}nt.normalize(),nt.multiplyScalar(this._randomParams.distanceScale),this.position.set(0,0,0),this.target.position.copy(nt.normalize().negate()),this.target.updateMatrixWorld(),this.refreshShadowCamNearFar(),this.updateMatrixWorld()}refreshShadowCamNearFar(){const s=new et.Pa4().subVectors(this.target.position,this.shadow.camera.position).length();this.shadow.camera.near=s-this._shadowParams.near*this._shadowParams.frustumSize/2,this.shadow.camera.far=s+this._shadowParams.far*this._shadowParams.frustumSize/2}dispose(){}get uiConfig(){if(this._uiConfig)return this._uiConfig}fromJSON(s,o){return super.fromJSON(s,o)?(this.updateShadowParams(),this):null}}function VM(tt,s,o){s=s.clone().normalize();const a=new et.Pa4(0,-s.z,s.y).normalize(),_e=new et.Pa4().crossVectors(s,a).normalize(),rt=tt;rt.x=2*rt.x*Math.PI,rt.y=1-rt.y*o;const nt=Math.sqrt(1-rt.y*rt.y);return a.multiplyScalar(Math.cos(rt.x)*nt).add(_e.multiplyScalar(Math.sin(rt.x)*nt)).add(s.multiplyScalar(rt.y))}zM([Yr("shadowParams")],w1.prototype,"_shadowParams",void 0),zM([Yr("randomParams")],w1.prototype,"_randomParams",void 0);class MC extends et.Tn7{constructor(){super(...arguments),this.typeSlug="fsShadow",this.assetType="material",this._uniforms={},this.lastFrameTexture=null}get materialObject(){return this}onBeforeCompile(s,o){s.vertexShader=s.vertexShader.replace("#include <project_vertex>",`
#include <project_vertex>
gl_Position = vec4(uv*2.-1., 0, 1.); 
        `),s.vertexShader=s.vertexShader.replace("void main() {",`
varying vec2 vUv;
void main() {
    vUv = uv;
        `),s.fragmentShader=s.fragmentShader.replace("void main() {",`
varying vec2 vUv;
uniform sampler2D tLastThis;
void main() {
        `),s.fragmentShader=s.fragmentShader.replace("gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );",Wt`
float shadow = getShadowMask();

//shift the color by dither_shift
shadow = clamp(shadow + mix(-1./512., 1./512., rand( gl_FragCoord.xy )), 0., 1.);

float last = unpackRGBAToDepth(texture2D(tLastThis, vUv));
gl_FragColor = packDepthToRGBA(mix(last, shadow, opacity));
//if not useMovingAverage:
//gl_FragColor = packDepthToRGBA(shadow * opacity + last);
        `),Object.assign(s.uniforms,this._uniforms),super.onBeforeCompile(s,o)}customProgramCacheKey(){return super.customProgramCacheKey()}toJSON(s){throw new Error("Method not supported for this material.")}fromJSON(s,o){throw new Error("Method not supported for this material.")}copyProps(s){throw new Error("Method not supported for this material.")}setDirty(s){this.needsUpdate=!0,this.dispatchEvent({...s,type:"materialUpdate"})}}(function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);rt>3&&nt&&Object.defineProperty(s,o,nt)})([Ar({propKey:"tLastThis"})],MC.prototype,"lastFrameTexture",void 0);var x1=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};class Lv{constructor(s){this.enabled=!0,this._lightLayer=5,this._frameNumber=0,this.maxFrameNumber=400,this.groundMapMode="aoMap",this.alphaVignette=!0,this.alphaVignetteAxis="xy",this.shadowAutoUpdate=!0,this.materialExtension={shaderExtender:(a,_e,rt)=>{this.groundMapMode==="aoMap"?a.fragmentShader=Wl(a.fragmentShader,"#include <aomap_fragment>",Wl(et.WdD.aomap_fragment,"float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;","float ambientOcclusion = ( unpackRGBAToDepth(texture2D( aoMap, vUv2 ) ) - 1.0) * aoMapIntensity + 1.0;")):this.groundMapMode==="map"?a.fragmentShader=Wl(a.fragmentShader,"#include <map_fragment>",Wl(et.WdD.map_fragment,"diffuseColor *= sampledDiffuseColor;","float groundShadow = unpackRGBAToDepth(sampledDiffuseColor); diffuseColor.rgb *= groundShadow; diffuseColor.a *= max(0., 1.-groundShadow);")):this.groundMapMode==="alphaMap"&&(a.fragmentShader=Wl(a.fragmentShader,"#include <alphamap_fragment>",Wl(et.WdD.alphamap_fragment,"texture2D( alphaMap, vUv ).g","1. - unpackRGBAToDepth( texture2D( alphaMap, vUv ) )",{replaceAll:!0}))),this.alphaVignette&&rt.capabilities.isWebGL2&&(a.fragmentShader=Wl(a.fragmentShader,"#include <output_fragment>",Wt`#include <output_fragment>
                    #ifndef OPAQUE
                    float weight = 0.;
                    #ifdef USE_UV
                    weight = 2.*abs(length(0.5 - vUv.${this.alphaVignetteAxis}));
                    #endif
                    #if defined(USE_LIGHTMAP) || defined(USE_AOMAP)
                    weight = 2.*abs(length(0.5 - vUv2.${this.alphaVignetteAxis}));
                    #endif
                    weight = min(1., max(0., weight))-0.5;
                    weight = min(1., max(0., 1.0-2.*weight));
                    weight = pow(weight, 1.5);
                    gl_FragColor.a *= weight;
                    //gl_FragColor.rgb /= max(0.01, weight);
                    gl_FragColor = saturate(gl_FragColor);
                    //gl_FragColor.a = 0.5;
                    #endif
                    `))},computeCacheKey:()=>this.groundMapMode+"."+this.alphaVignette+"."+this.alphaVignetteAxis,onObjectRender:(a,_e)=>{_e.materialObject.userData.gMapMode!==this.groundMapMode&&(_e.materialObject.userData.gMapMode=this.groundMapMode,_e.materialObject.needsUpdate=!0)},isCompatible:a=>a.isMeshStandardMaterial2},this._viewer=s;const o=new w1(16777215,10,{near:1.5,far:20,bias:0,frustumSize:4,width:1024,height:1024,enabled:!0,radius:10,normalBias:0},{direction:new et.Pa4(.2,1,.2).normalize(),spread:.9,focus:1,distanceScale:20,minDistanceScale:new et.Pa4(10,10,10),normalDirection:new et.Pa4(0,1,0)});o.shadow.camera.updateProjectionMatrix(),o.layers.disableAll(),o.layers.set(this._lightLayer),this._light=o,s.scene.addLight(this._light,{addToRoot:!0}),this._shadowMat=new MC({color:"#ffffff",toneMapped:!1,depthWrite:!1,depthTest:!1,premultipliedAlpha:!1,opacity:1,transparent:!1,blending:et.jFi})}get attachedMesh(){return this._attachedMesh}set attachedMesh(s){this._attachedMesh!==s&&(this._attachedMesh&&this.cleanupMaterial(),this._attachedMesh=s,this._attachedMesh&&this._updateMaterial())}get target(){return this._target}get light(){return this._light}dispose(){this._shadowMat.dispose(),this._target=void 0,this.reset()}cleanupMaterial(){this._updateMaterial(!0)}_groundMapModeChanged(){this._attachedMesh&&(this.cleanupMaterial(),this._updateMaterial(),this.groundMapMode==="alphaMap"?this._attachedMesh.material.transparent=!0:this._attachedMesh.material.transparent=!1),this.reset()}_alphaVignetteChanged(){var s,o,a;(o=(s=this.materialExtension)===null||s===void 0?void 0:s.setDirty)===null||o===void 0||o.call(s),(a=this._viewer)===null||a===void 0||a.setDirty()}fromJSON(s,o){return In(s,this,!0,o),this.reset(),this}reset(){this._frameNumber=0}autoUpdateShadow(){this.shadowAutoUpdate&&this.updateShadow()}updateShadow(){if(!this.enabled)return!1;const s=this._attachedMesh;if(++this._frameNumber>this.maxFrameNumber||!s)return!1;const o=1024;this._target||(this._target=this._viewer.renderer.createTarget({type:et.ywz,depthBuffer:!1,size:new et.FM8(o,o),sizeMultiplier:void 0,encoding:et.rnI,format:et.wk1})),this._frameNumber<3?this._light.randomizePosition(0,1,0):this._light.randomizePosition(this._frameNumber),s.castShadow=!1;const a=this._viewer.renderer.rendererObject,_e=a.shadowMap,rt=_e.type,nt=_e.needsUpdate,ot=_e.autoUpdate;_e.type=et._MY,_e.needsUpdate=!0,_e.autoUpdate=!1;const ct=this._viewer.scene,pt=new et.S9g;pt.disableAll(),ct.modelObject.traverse(Mt=>{Mt.isLight&&Mt!==this._light.lightObject&&(Mt.userData.__gp_layers=Mt.layers,Mt.layers=pt)});const ht=ct.activeCamera.cameraObject;if(ht.layers.mask&1<<this._lightLayer)throw"Camera can render pseudo directional light, check layers";ht.layers.enable(this._lightLayer),s.layers.disable(this._lightLayer),jn(a,{shadowMapRender:!0,backgroundRender:!1,sceneRender:!1},()=>this._viewer.renderer.renderScene(ct)),ht.layers.disable(this._lightLayer);const _t=ht.layers.mask;ht.layers.set(this._lightLayer),s.layers.enable(this._lightLayer);const Et=this._viewer.renderer.getTempTarget({type:et.ywz,depthBuffer:!1,size:new et.FM8(o,o),encoding:et.rnI,format:et.wk1}),St=Et.texture.encoding;Et.texture.encoding=et.rnI,this._viewer.renderer.blit(this._target.texture,Et,{clear:!0});{const Mt=ct.modelObject.environment,It=ct.modelObject.background,Nt=s.material,Bt=s.frustumCulled,kt=a.getRenderTarget(),Pt=a.getActiveCubeFace(),qt=a.getActiveMipmapLevel();ct.modelObject.background=null,ct.modelObject.environment=null,s.material=this._shadowMat,s.frustumCulled=!1,a.setRenderTarget(this._target),this._shadowMat.opacity=Math.max(1/this.maxFrameNumber,1/this._frameNumber),this._shadowMat.lastFrameTexture=Et.texture,this._shadowMat.needsUpdate=!0,jn(a,{shadowMapRender:!1,backgroundRender:!1,opaqueRender:!0,transparentRender:!1,transmissionRender:!1},()=>this._viewer.renderer.renderScene(ct)),a.setRenderTarget(kt,Pt,qt),s.frustumCulled=Bt,s.material=Nt,ct.modelObject.environment=Mt,ct.modelObject.background=It}return Et.texture.encoding=St,this._viewer.renderer.releaseTempTarget(Et),s.layers.disable(this._lightLayer),ht.layers.mask=_t,ct.modelObject.traverse(Mt=>{Mt.isLight&&Mt!==this._light.lightObject&&(Mt.layers=Mt.userData.__gp_layers,delete Mt.userData.__gp_layers)}),_e.type=rt,_e.needsUpdate=nt,_e.autoUpdate=ot,s.castShadow=!0,(this._frameNumber<2||this._frameNumber>Math.min(30,this.maxFrameNumber)&&this._frameNumber%150==0)&&(this._updateMaterial(),this._viewer.setDirty(),s.dispatchEvent({type:"materialUpdate"})),!0}_updateMaterial(s=!1){var o,a,_e;this._attachedMesh&&(s?(this._attachedMesh.material.alphaMap===((o=this._target)===null||o===void 0?void 0:o.texture)&&(this._attachedMesh.material.alphaMap=null),this._attachedMesh.material.aoMap===((a=this._target)===null||a===void 0?void 0:a.texture)&&(this._attachedMesh.material.aoMap=null),this._attachedMesh.material.map===((_e=this._target)===null||_e===void 0?void 0:_e.texture)&&(this._attachedMesh.material.map=null)):this._target&&(this.groundMapMode==="alphaMap"&&(this._attachedMesh.material.alphaMap=this._target.texture),this.groundMapMode==="aoMap"&&(this._attachedMesh.material.aoMap=this._target.texture),this.groundMapMode==="map"&&(this._attachedMesh.material.map=this._target.texture)),this._attachedMesh.material&&(this._attachedMesh.material.userData.ALPHA_I_RGBA_PACKING=!s&&this.groundMapMode==="alphaMap",this._attachedMesh.material.alphaTest=s||this.groundMapMode!=="alphaMap"?0:.001,this._attachedMesh.material.needsUpdate=!0))}}x1([Yr("randomizedLight")],Lv.prototype,"_light",void 0),x1([vr(Lv.prototype.reset),Yr()],Lv.prototype,"maxFrameNumber",void 0),x1([vr(Lv.prototype._groundMapModeChanged),Yr()],Lv.prototype,"groundMapMode",void 0),x1([Yr(),vr(Lv.prototype._alphaVignetteChanged)],Lv.prototype,"alphaVignette",void 0),x1([Yr(),vr(Lv.prototype._alphaVignetteChanged)],Lv.prototype,"alphaVignetteAxis",void 0);var GM="vec2 poisson_disk_samples[16];void setPds(){poisson_disk_samples[0]=vec2(-0.399691779231,0.728591545584);poisson_disk_samples[1]=vec2(-0.48622557676,-0.84016533712);poisson_disk_samples[2]=vec2(0.770309468987,-0.24906070432);poisson_disk_samples[3]=vec2(0.556596796154,0.820359876432);poisson_disk_samples[4]=vec2(-0.933902004071,0.0600539051593);poisson_disk_samples[5]=vec2(0.330144964342,0.207477293384);poisson_disk_samples[6]=vec2(0.289013230975,-0.686749271417);poisson_disk_samples[7]=vec2(-0.0832470893559,-0.187351643125);poisson_disk_samples[8]=vec2(-0.296314525615,0.254474834305);poisson_disk_samples[9]=vec2(-0.850977666059,0.484642744689);poisson_disk_samples[10]=vec2(0.829287915319,0.2345063545);poisson_disk_samples[11]=vec2(-0.773042143899,-0.543741521254);poisson_disk_samples[12]=vec2(0.0561133030864,0.928419742597);poisson_disk_samples[13]=vec2(-0.205799249508,-0.562072714492);poisson_disk_samples[14]=vec2(-0.526991665882,-0.193690188118);poisson_disk_samples[15]=vec2(-0.051789270667,-0.935374050821);}",wE=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};class tA extends et.Kj0{constructor(s,o,a=0){super(s),this.type="Reflector",this.isReflector2=!0,this.enabled=!0,this.reflectorModePhysical=!0,this.reflectionTargetNeedsUpdate=!0,this.transparentReflectionBackground=!0,this.materialExtension={extraUniforms:{tRefDiffuse:{value:null},tRefDiffuseSize:{value:new et.FM8},refTextureMatrix:{value:null},frameCount:{value:0},sceneBoundingRadius:{value:0}},updaters:[],shaderExtender:(Nt,Bt,kt)=>{if(this.enabled){Nt.vertexShader=Nt.vertexShader.replace("void main() {",`void main() {
vRefUv = refTextureMatrix * vec4( position, 1.0 );`);const Pt="#glMarker beforeModulation";Nt.fragmentShader=Nt.fragmentShader.replace(Pt,`
                    if(roughnessFactor < 0.95) {
                        float d = 0.;//textureProj(tRefDepth, vRefUv).r;
                        // d = min(2., max(0., (d-0.06) * ((7./3.-ior)) * sceneBoundingRadius));
                        vec4 refBaseColor = getReflectionColor(material.roughness, material.roughness * d);
                        // refBaseColor.rgb = vec3(refBaseColor.a);
                        // refBaseColor.a *= 1.0 - clamp(material.roughness * .3, 0., 1.);
                        `+(this.reflectorModePhysical?`
                        #if !defined(SSR_ENABLED) || SSR_ENABLED < 1 
                        vec3 specularColor = EnvironmentBRDF(geometry.normal, geometry.viewDir, material.specularColor.rgb, material.specularF90, material.roughness);
                        #endif
                        reflectedLight.indirectSpecular = mix(vec3(reflectedLight.indirectSpecular), saturate(specularColor.rgb * refBaseColor.rgb), refBaseColor.a);
                        `:`
                        reflectedLight.indirectSpecular = saturate(diffuseColor.rgb * refBaseColor.rgb);
                        diffuseColor.a *= refBaseColor.a;
                        `)+`}
`+Pt),Nt.vertexUvs=!0}},parsVertexSnippet:()=>this.enabled?`
		uniform mat4 refTextureMatrix;
		varying vec4 vRefUv;
`:"",parsFragmentSnippet:()=>this.enabled?GM+`
`+Pv+`
#ifndef D_sceneBoundingRadius
#define D_sceneBoundingRadius 
uniform float sceneBoundingRadius;
#endif
varying vec4 vRefUv;uniform sampler2D tRefDiffuse;uniform vec2 tRefDiffuseSize;float getSpecularMIPLevel(const in float roughness,const in float maxMIPLevel){float sigma=PI*roughness*roughness/(1.+roughness);float desiredMIPLevel=maxMIPLevel+log2(sigma);return clamp(desiredMIPLevel,0.,maxMIPLevel);}vec4 getReflectionColor(const in float roughness,const in float depthModifier){float mip=getSpecularMIPLevel(roughness+depthModifier,5.);vec4 color=texture2D(tRefDiffuse,vRefUv.xy/vRefUv.w,mip);float blurDist=saturate(2./(1.+pow(abs(vViewPosition.z),0.25)))*mip*32.*color.a;float rnd=PI2*interleavedGradientNoise(vUv.xy,frameCount);vec4 rotationMatrix=vec4(cos(rnd),-sin(rnd),0.,0.);rotationMatrix.z=-rotationMatrix.y;rotationMatrix.w=rotationMatrix.x;vec3 colorSum=color.rgb*color.a;float weightSum=0.001+color.a;vec2 ofs;setPds();
#pragma unroll_loop_start
for(int i=0;i<16;i++){ofs=poisson_disk_samples[UNROLLED_LOOP_INDEX];ofs=vec2(dot(ofs,rotationMatrix.xy),dot(ofs,rotationMatrix.zw));ofs=vRefUv.xy+vRefUv.w*blurDist*ofs/tRefDiffuseSize.xy;color=texture2D(tRefDiffuse,ofs/vRefUv.w,mip);colorSum+=color.rgb*color.a;weightSum+=color.a;}
#pragma unroll_loop_end
return vec4(colorSum/weightSum,1.);}`:"",computeCacheKey:Nt=>this.enabled+" "+Nt.materialObject.transparent+" "+this.reflectorModePhysical+" ",onObjectRender:(Nt,{materialObject:Bt})=>{Bt.userData.__lastTransparent!==Bt.transparent&&(Bt.needsUpdate=!0,Bt.userData.__lastTransparent=Bt.transparent)},isCompatible:Nt=>Nt.isMeshStandardMaterial2},this.material=void 0,this._renderTarget=o;const _e=new et.JOQ,rt=new et.Pa4,nt=new et.Pa4,ot=new et.Pa4,ct=new et.yGw,pt=new et.Pa4(0,0,-1),ht=new et.Ltg,_t=new et.Pa4,Et=new et.Pa4,St=new et.Ltg,Mt=new et.yGw,It=new et.cPb;et.M8C.isPowerOfTwo(o.texture.image.width)&&et.M8C.isPowerOfTwo(o.texture.image.height)||(this._renderTarget.texture.generateMipmaps=!1),this.onBeforeRender=(Nt,Bt,kt)=>{if(!this.enabled||!Nt.userData.mainRenderPass||!this.reflectionTargetNeedsUpdate)return;const Pt=kt.view?Object.assign({},kt.view):null;if(Pt&&kt.clearViewOffset&&kt.clearViewOffset(),nt.setFromMatrixPosition(this.matrixWorld),ot.setFromMatrixPosition(kt.matrixWorld),ct.extractRotation(this.matrixWorld),rt.set(0,0,1),rt.applyMatrix4(ct),_t.subVectors(nt,ot),_t.dot(rt)>0)return;_t.reflect(rt).negate(),_t.add(nt),ct.extractRotation(kt.matrixWorld),pt.set(0,0,-1),pt.applyMatrix4(ct),pt.add(ot),Et.subVectors(nt,pt),Et.reflect(rt).negate(),Et.add(nt),It.position.copy(_t),It.up.set(0,1,0),It.up.applyMatrix4(ct),It.up.reflect(rt),It.lookAt(Et),It.far=2,It.near=0,It.updateMatrixWorld(),It.projectionMatrix.copy(kt.projectionMatrix),Mt.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),Mt.multiply(It.projectionMatrix),Mt.multiply(It.matrixWorldInverse),Mt.multiply(this.matrixWorld),_e.setFromNormalAndCoplanarPoint(rt,nt),_e.applyMatrix4(It.matrixWorldInverse),ht.set(_e.normal.x,_e.normal.y,_e.normal.z,_e.constant);const qt=It.projectionMatrix;St.x=(Math.sign(ht.x)+qt.elements[8])/qt.elements[0],St.y=(Math.sign(ht.y)+qt.elements[9])/qt.elements[5],St.z=-1,St.w=(1+qt.elements[10])/qt.elements[14],ht.multiplyScalar(2/ht.dot(St)),qt.elements[2]=ht.x,qt.elements[6]=ht.y,qt.elements[10]=ht.z+1-a,qt.elements[14]=ht.w,this.visible=!1;const Kt=Nt.getRenderTarget(),nr=Nt.xr.enabled,ir=Nt.shadowMap.autoUpdate;Nt.xr.enabled=!1,Nt.shadowMap.autoUpdate=!1,Nt.setRenderTarget(this._renderTarget),Nt.state.buffers.depth.setMask(!0),Nt.autoClear===!1&&Nt.clear();const fr=Bt.background;this.transparentReflectionBackground&&(Bt.background=null);const br=!this.transparentReflectionBackground;fr&&br&&(fr.userData.flipX=!fr.userData.flipX),jn(Nt,{shadowMapRender:!1,backgroundRender:br,opaqueRender:!0,transparentRender:!0,transmissionRender:!1,screenSpaceRendering:!1},()=>Nt.render(Bt,It)),fr&&br&&(fr.userData.flipX=!fr.userData.flipX||void 0),this.transparentReflectionBackground&&(Bt.background=fr),Nt.xr.enabled=nr,Nt.shadowMap.autoUpdate=ir,Nt.setRenderTarget(Kt),Pt!=null&&Pt.enabled&&kt.setViewOffset&&kt.setViewOffset(Pt.fullWidth,Pt.fullHeight,Pt.offsetX,Pt.offsetY,Pt.width,Pt.height);const Tr=kt.viewport;Tr!==void 0&&Nt.state.viewport(Tr),this.visible=!0,this.reflectionTargetNeedsUpdate=!1},this.textureMatrix=Mt,this.materialExtension.extraUniforms.tRefDiffuse.value=this._renderTarget.texture,this.materialExtension.extraUniforms.tRefDiffuseSize.value=new et.FM8(this._renderTarget.width,this._renderTarget.height),this.materialExtension.extraUniforms.refTextureMatrix.value=Mt}_updateExtension(){var s,o;this.transparentReflectionBackground=this.reflectorModePhysical,(o=(s=this.materialExtension)===null||s===void 0?void 0:s.setDirty)===null||o===void 0||o.call(s)}getRenderTarget(){return this._renderTarget}}wE([vr(tA.prototype._updateExtension)],tA.prototype,"enabled",void 0),wE([vr(tA.prototype._updateExtension)],tA.prototype,"reflectorModePhysical",void 0),tA.prototype.isReflector=!0;var ev=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};class Op extends io{constructor(s={}){super(),this._transformNeedRefresh=!0,this.dependencies=[os],this.visible=!0,this.size=8,this.yOffset=0,this.renderToDepth=!0,this.tonemapGround=!0,this.limitCameraAboveGround=!1,this._cameraLimitsSet=!1,this._cameraLastMaxPolarAngle=Math.PI,this._refreshMaterial=this._refreshMaterial.bind(this),this._refreshTransform=this._refreshTransform.bind(this),this._refreshCameraLimits=this._refreshCameraLimits.bind(this),this.refreshOptions=this.refreshOptions.bind(this),this._refreshOptions2=this._refreshOptions2.bind(this),this._onSceneUpdate=this._onSceneUpdate.bind(this),this._preRender=this._preRender.bind(this),this._postFrame=this._postFrame.bind(this),this._geometry=new et._12(1,1,1,1),this._geometry.attributes.uv2=this._geometry.attributes.uv.clone(),this._geometry.attributes.uv2.needsUpdate=!0,this._options={shape:"",up:[0,100,0],autoAdjustTransform:!0},this.setOptions(s)}get enabled(){return this.visible}set enabled(s){this.visible=s}get material(){return this._material}get mesh(){return this._iMesh}_createMesh(){return new et.Kj0(this._geometry)}async onAdded(s){var o,a;await super.onAdded(s),s.getPluginByType("TweakpaneUi")&&console.error("TweakpaneUiPlugin must be added after Ground Plugin"),this._manager=s.getPlugin(os);const _e=this._createMesh();_e.userData.physicsMass=0,this._iMesh=await((o=this._manager)===null||o===void 0?void 0:o.addImportedSingle(_e,{pseudoCenter:!1,autoScale:!1,addToRoot:!0})),this._mesh=(a=this._iMesh)===null||a===void 0?void 0:a.modelObject,this._mesh&&(this._mesh.userData.userSelectable=!1,this._mesh.castShadow=!0,this._mesh.receiveShadow=!0,this._mesh.name="Ground Plane"),s.scene.addEventListener("sceneUpdate",this._onSceneUpdate),s.scene.addEventListener("addSceneObject",this._onSceneUpdate),s.addEventListener("preRender",this._preRender),s.addEventListener("postFrame",this._postFrame),this.refreshOptions()}_postFrame(){this._transformNeedRefresh&&this._refreshTransform(),this._viewer}_preRender(){this._viewer}async onDispose(s){var o,a;return this._geometry.dispose(),(a=(o=this._iMesh)===null||o===void 0?void 0:o.dispose)===null||a===void 0||a.call(o),super.onDispose(s)}async onRemove(s){return this._removeMaterial(),s.scene.removeEventListener("sceneUpdate",this._onSceneUpdate),s.scene.removeEventListener("addSceneObject",this._onSceneUpdate),s.removeEventListener("postFrame",this._postFrame),s.removeEventListener("preRender",this._preRender),this._manager=void 0,super.onRemove(s)}_removeMaterial(){var s,o;this._material&&((o=(s=this._manager)===null||s===void 0?void 0:s.materials)===null||o===void 0||o.unregisterMaterial(this._material),this._material.userData.renderToDepth=this._material.userData.__renderToDepth,this._material.userData.__renderToDepth=void 0,this._material=void 0)}_onSceneUpdate(s){s.geometryChanged!==!1&&s.updateGround!==!1&&this.refreshTransform()}refreshTransform(){this._transformNeedRefresh=!0}_refreshOptions2(){this.refreshOptions()}refreshOptions(){this._viewer&&(this._refreshMaterial(),this.refreshTransform(),this._refreshCameraLimits())}_refreshCameraLimits(){var s;const o=(s=this._viewer)===null||s===void 0?void 0:s.scene.activeCamera.controls;o&&(o.maxPolarAngle!==void 0?this.limitCameraAboveGround?(this._cameraLimitsSet||(this._cameraLastMaxPolarAngle=o.maxPolarAngle),o.maxPolarAngle=Math.PI/2,this._cameraLimitsSet=!0):this._cameraLimitsSet&&(o.maxPolarAngle=this._cameraLastMaxPolarAngle,this._cameraLimitsSet=!1):console.warn("refreshCameraLimits only available with orbit controls."))}_refreshTransform(){var s,o,a;if(!this._mesh||!this._viewer)return;let _e=!1;if(this.visible!==this._mesh.visible&&(this._mesh.visible=this.visible,_e=!0),this.enabled){if(this._options.autoAdjustTransform){this._mesh.userData.bboxVisible=!1;const rt=this._viewer.scene.getBounds(!0);this._mesh.userData.bboxVisible=!0;const nt=rt.getCenter(new et.Pa4).sub(new et.Pa4(0,rt.getSize(new et.Pa4).y/2+this.yOffset,0));_e=_e||nt.clone().sub(this._mesh.position).length()>1e-4,_e&&this._mesh.position.copy(nt)}_e=_e||Math.abs(this._mesh.scale.x-this.size)>1e-4,_e&&(this._mesh.scale.setScalar(this.size),this._mesh.setRotationFromEuler(new et.USm(-Math.PI/2,0,0)),this._mesh.matrixWorldNeedsUpdate=!0,(a=(o=this._mesh).setDirty)===null||a===void 0||a.call(o)),this._transformNeedRefresh=!1}else _e&&((s=this._viewer)===null||s===void 0||s.scene.setDirty())}_refreshMaterial(){var s,o,a,_e,rt,nt,ot,ct;if(!this._viewer||!this.enabled)return!1;this._manager||console.error("GroundPlugin requires asset manager");const pt=(o=(s=this._manager)===null||s===void 0?void 0:s.materials)===null||o===void 0?void 0:o.findOrCreate((_e=(a=this._material)===null||a===void 0?void 0:a.uuid)!==null&&_e!==void 0?_e:"standard",{name:"BaseGroundMaterial",runtimeMaterial:!0,color:16777215});let ht=!1;return(pt==null?void 0:pt.uuid)!==((rt=this._material)===null||rt===void 0?void 0:rt.uuid)&&(this._removeMaterial(),pt&&(this._material=pt),!((nt=this._material)===null||nt===void 0)&&nt.uuid||console.warn("No material found for ground"),this._viewer.scene.setDirty(),this._mesh&&this._material&&(this._material.roughness=.2,this._material.metalness=.5,((ct=(ot=this._mesh)===null||ot===void 0?void 0:ot.setMaterial)!==null&&ct!==void 0?ct:_t=>{this._mesh&&(this._mesh.material=_t.materialObject)})(this._material)),ht=!0),this._material&&(this._material.userData.__renderToDepth===void 0&&(this._material.userData.__renderToDepth=this._material.userData.renderToDepth),this._material.userData.renderToDepth!==this.renderToDepth&&(this._material.userData.renderToDepth=this.renderToDepth),this._material.userData.__postTonemap===void 0&&(this._material.userData.__postTonemap=this._material.userData.postTonemap),this._material.userData.postTonemap!==this.tonemapGround&&(this._material.userData.postTonemap=this.tonemapGround),this._material.materialObject.userData.ssaoDisabled=!0,this._material.materialObject.userData.sscsDisabled=!0),this._viewer.setDirty(this),ht}setOptions(s){Object.assign(this._options,s),this.refreshOptions()}fromJSON(s,o){return super.fromJSON(s,o)?(this.refreshOptions(),this):null}_extraUiConfig(){return[()=>{var s;return(s=this._material)===null||s===void 0?void 0:s.uiConfig}]}get uiConfig(){return this._uiConfig?this._uiConfig:this._uiConfig={type:"folder",label:"Ground",children:[{label:"Visible",type:"checkbox",property:[this,"visible"],limitedUi:!0},{label:"Size",type:"input",property:[this,"size"],limitedUi:!0},{label:"Render to Depth",type:"checkbox",property:[this,"renderToDepth"]},{label:"Limit Camera",type:"checkbox",property:[this,"limitCameraAboveGround"]},{label:"Tonemap",type:"checkbox",property:[this,"tonemapGround"]},{label:"Height",type:"slider",bounds:[-2,2],property:[this,"yOffset"]},...this._extraUiConfig()]}}}ev([Yr("material")],Op.prototype,"_material",void 0),ev([vr(Op.prototype.refreshTransform),Yr()],Op.prototype,"visible",void 0),ev([vr(Op.prototype._onSceneUpdate),Yr()],Op.prototype,"size",void 0),ev([vr(Op.prototype._onSceneUpdate),Yr()],Op.prototype,"yOffset",void 0),ev([vr(Op.prototype._refreshOptions2),Yr()],Op.prototype,"renderToDepth",void 0),ev([vr(Op.prototype._refreshOptions2),Yr()],Op.prototype,"tonemapGround",void 0),ev([vr(Op.prototype._refreshCameraLimits),Yr()],Op.prototype,"limitCameraAboveGround",void 0);var Jl=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};class _m extends Op{constructor(s={},o=!1){super(s),this.bakedShadows=!0,this.groundReflection=!1,this.physicalReflections=!1,this._showDebug=o,o&&this.dependencies.push(Ov),this._onSceneUpdate=this._onSceneUpdate.bind(this)}get shadowBaker(){return this._shadowBaker}_createMesh(){const s=new tA(this._geometry,this._viewer.renderer.createTarget({type:et.ywz,format:et.wk1,encoding:et.rnI,size:{width:1024,height:1024},generateMipmaps:!0,depthBuffer:!0,minFilter:et.D1R,magFilter:et.wem})),o=s.onBeforeRender;return s.onBeforeRender=(...a)=>{var _e,rt,nt,ot,ct;let pt=(rt=(_e=this._viewer)===null||_e===void 0?void 0:_e.getPluginByType("SSReflection"))===null||rt===void 0?void 0:rt.passes.ssr.passObject;pt&&!pt.enabled&&(pt=void 0),pt&&(pt.enabled=!1);let ht=(ct=(ot=(nt=this._viewer)===null||nt===void 0?void 0:nt.getPluginByType("SSBevelPlugin"))===null||ot===void 0?void 0:ot.pass)===null||ct===void 0?void 0:ct.passObject;ht&&!ht.enabled&&(ht=void 0),ht&&(ht.enabled=!1),o(...a),pt&&(pt.enabled=!0),ht&&(ht.enabled=!0)},s}async onAdded(s){var o,a;await super.onAdded(s),this._showDebug&&((o=s.getPlugin(Ov))===null||o===void 0||o.addTexture("bake_ground_1",()=>{var _e,rt;return(rt=(_e=this._shadowBaker)===null||_e===void 0?void 0:_e.light.shadow.map)===null||rt===void 0?void 0:rt.texture},[100,100,200,200]),(a=s.getPlugin(Ov))===null||a===void 0||a.addTexture("bake_ground_2",()=>{var _e,rt;return(rt=(_e=this._shadowBaker)===null||_e===void 0?void 0:_e.target)===null||rt===void 0?void 0:rt.texture},[100,400,400,400],"texel = vec4(vec3(unpackRGBAToDepth(texel)), 1.0);"))}_postFrame(){var s;super._postFrame(),this._viewer&&this.enabled&&this.bakedShadows&&((s=this._shadowBaker)===null||s===void 0||s.autoUpdateShadow())}_preRender(){super._preRender(),this._viewer&&(this._mesh.reflectionTargetNeedsUpdate=this._viewer.renderer.frameCount<1)}async onDispose(s){return super.onDispose(s)}async onRemove(s){return super.onRemove(s)}_removeMaterial(){var s,o,a,_e;if(this._material){if(this._shadowBaker&&this._material.groundMatExtension&&((o=(s=this._material).unregisterMaterialExtensions)===null||o===void 0||o.call(s,[this._shadowBaker.materialExtension]),delete this._material.groundMatExtension),this._material.reflectorMatExtension){const rt=this._mesh.materialExtension;rt||console.warn("unable to find the extension to unregister"),(_e=(a=this._material).unregisterMaterialExtensions)===null||_e===void 0||_e.call(a,[rt]),delete this._material.reflectorMatExtension}super._removeMaterial()}}_onSceneUpdate(s){var o;super._onSceneUpdate(s),s.geometryChanged!==!1&&((o=this._shadowBaker)===null||o===void 0||o.reset())}refreshOptions(){if(!this._viewer)return;this.bakedShadows&&!this._shadowBaker?(this._shadowBaker=new Lv(this._viewer),this._shadowBaker.attachedMesh=this._mesh):!this.bakedShadows&&this._shadowBaker&&(this._shadowBaker.reset(),this._shadowBaker.cleanupMaterial());const s=this._mesh;s.isReflector2&&(s.enabled=this.groundReflection,s.reflectorModePhysical=this.physicalReflections),super.refreshOptions(),this._viewer.setDirty(this)}_refreshMaterial(){var s,o,a,_e;if(!this._viewer)return!1;const rt=super._refreshMaterial();if(!this._material)return rt;if(this.groundReflection&&this._mesh.isReflector2&&!this._material.reflectorMatExtension){const nt=this._mesh.materialExtension;nt.updaters=[this._viewer.scene,this._viewer.renderer],(o=(s=this._material).registerMaterialExtensions)===null||o===void 0||o.call(s,[nt]),this._material.reflectorMatExtension=!0}return this.bakedShadows&&this._shadowBaker&&!this._material.groundMatExtension&&((_e=(a=this._material).registerMaterialExtensions)===null||_e===void 0||_e.call(a,[this._shadowBaker.materialExtension]),this._material.groundMatExtension=!0),this._material.materialObject.userData.ssreflDisabled=this.groundReflection,this._material.materialObject.userData.ssreflNonPhysical=!this.physicalReflections,this._viewer.setDirty(this),rt}_extraUiConfig(){var s,o,a,_e,rt,nt,ot,ct,pt,ht,_t,Et,St,Mt,It,Nt,Bt,kt,Pt,qt,Kt,nr,ir,fr,br,Tr,Dr,Rr,Nr,Ir;return[{label:"Baked Shadows",type:"checkbox",property:[this,"bakedShadows"]},{label:"Shadow Frames",type:"input",hidden:()=>!this._shadowBaker,stepSize:1,bounds:[1,1e3],property:[this._shadowBaker,"maxFrameNumber"]},{label:"Alpha Vignette",type:"checkbox",hidden:()=>!this._material||this._material.transmission<1e-4&&!this._material.transparent,property:[this._shadowBaker,"alphaVignette"],limitedUi:!0,onChange:()=>{var kr,Hr;return(Hr=(kr=this._uiConfig)===null||kr===void 0?void 0:kr.uiRefresh)===null||Hr===void 0?void 0:Hr.call(kr,"postFrame",!0)}},{label:"Alpha Vignette Axis",type:"dropdown",hidden:()=>{var kr;return!(!((kr=this._shadowBaker)===null||kr===void 0)&&kr.alphaVignette)||!this._material||this._material.transmission<1e-4&&!this._material.transparent},property:[this._shadowBaker,"alphaVignetteAxis"],children:["x","y","xy"].map(kr=>({label:kr,value:kr})),limitedUi:!0},{label:"Planar Reflections",type:"checkbox",property:[this,"groundReflection"],limitedUi:!0},{label:"Physical Reflections",type:"checkbox",property:[this,"physicalReflections"],limitedUi:!0},{label:"Shadow type",type:"dropdown",hidden:()=>!this._shadowBaker,property:[this._shadowBaker,"groundMapMode"],children:[{label:"aoMap"},{label:"map"},{label:"alphaMap"}],limitedUi:!0},{type:"folder",label:"Randomized Light",hidden:()=>!this._shadowBaker,limitedUi:!0,children:[{type:"color",label:"Color",property:[(s=this._shadowBaker)===null||s===void 0?void 0:s.light,"color"]},{type:"slider",label:"Intensity",bounds:[0,100],property:[(o=this._shadowBaker)===null||o===void 0?void 0:o.light,"intensity"]},{type:"checkbox",label:"Shadow Enabled",property:[(_e=(a=this._shadowBaker)===null||a===void 0?void 0:a.light)===null||_e===void 0?void 0:_e.shadowParams,"enabled"],onChange:[(nt=(rt=this._shadowBaker)===null||rt===void 0?void 0:rt.light)===null||nt===void 0?void 0:nt.updateShadowParams,this._onSceneUpdate]},{type:"slider",bounds:[0,1],property:[(ct=(ot=this._shadowBaker)===null||ot===void 0?void 0:ot.light)===null||ct===void 0?void 0:ct.randomParams,"focus"],onChange:[this._onSceneUpdate]},{type:"slider",bounds:[0,1],property:[(ht=(pt=this._shadowBaker)===null||pt===void 0?void 0:pt.light)===null||ht===void 0?void 0:ht.randomParams,"spread"],onChange:[this._onSceneUpdate],limitedUi:!0},{type:"slider",bounds:[.01,60],property:[(Et=(_t=this._shadowBaker)===null||_t===void 0?void 0:_t.light)===null||Et===void 0?void 0:Et.randomParams,"distanceScale"],onChange:[(Mt=(St=this._shadowBaker)===null||St===void 0?void 0:St.light)===null||Mt===void 0?void 0:Mt.updateShadowParams,this._onSceneUpdate]},{type:"vec3",bounds:[-1,1],property:[(Nt=(It=this._shadowBaker)===null||It===void 0?void 0:It.light)===null||Nt===void 0?void 0:Nt.randomParams,"direction"],onChange:[this._onSceneUpdate],limitedUi:!0},{type:"vec3",bounds:[-1,1],property:[(kt=(Bt=this._shadowBaker)===null||Bt===void 0?void 0:Bt.light)===null||kt===void 0?void 0:kt.randomParams,"normalDirection"],onChange:[this._onSceneUpdate],limitedUi:!0},{type:"slider",bounds:[.01,10],property:[(qt=(Pt=this._shadowBaker)===null||Pt===void 0?void 0:Pt.light)===null||qt===void 0?void 0:qt.shadowParams,"radius"],onChange:[(nr=(Kt=this._shadowBaker)===null||Kt===void 0?void 0:Kt.light)===null||nr===void 0?void 0:nr.updateShadowParams,this._onSceneUpdate]},{type:"input",property:[(fr=(ir=this._shadowBaker)===null||ir===void 0?void 0:ir.light)===null||fr===void 0?void 0:fr.shadowParams,"frustumSize"],onChange:[(Tr=(br=this._shadowBaker)===null||br===void 0?void 0:br.light)===null||Tr===void 0?void 0:Tr.updateShadowParams,this._onSceneUpdate]},{type:"slider",bounds:[-.1,.1],property:[(Rr=(Dr=this._shadowBaker)===null||Dr===void 0?void 0:Dr.light)===null||Rr===void 0?void 0:Rr.shadowParams,"bias"],onChange:[(Ir=(Nr=this._shadowBaker)===null||Nr===void 0?void 0:Nr.light)===null||Ir===void 0?void 0:Ir.updateShadowParams,this._onSceneUpdate]}]},...super._extraUiConfig()]}}_m.PluginType="Ground",Jl([vr(_m.prototype.refreshOptions),Yr()],_m.prototype,"bakedShadows",void 0),Jl([vr(_m.prototype.refreshOptions),Yr()],_m.prototype,"groundReflection",void 0),Jl([vr(_m.prototype.refreshOptions),Yr()],_m.prototype,"physicalReflections",void 0),Jl([Yr("shadowBaker")],_m.prototype,"_shadowBaker",void 0);var ny,tv=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let ym=ny=class extends Ru{constructor(){super({vertexShader:ut.vertexShader,defines:{PASS_STEP:1},uniforms:{tSource:{value:null},tDiffuse:{value:null},opacity:{value:1},tDiffuseSize:{value:new et.FM8},weight:{value:1},tNormalDepth:{value:null}},fragmentShader:Zv+`
uniform float intensity;uniform float opacity;uniform vec2 tDiffuseSize;varying vec2 vUv;uniform float weight;
#if PASS_STEP == 0
uniform vec4 prefilter;vec4 Prefilter(vec4 c){if(getDepth(vUv)>0.999){return vec4(0.);}float brightness=max(c.r,max(c.g,c.b));float soft=brightness+prefilter.x*(prefilter.y-1.);soft=clamp(soft,0.,prefilter.z);soft=soft*soft*prefilter.w;float contribution=max(soft,brightness-prefilter.x);contribution/=max(brightness,0.001);return vec4(c.rgb*contribution,c.a);}
#endif
vec4 Sample(vec2 uv){return tDiffuseTexelToLinear(texture2D(tDiffuse,uv));}vec4 SampleBox(vec2 uv,float delta){vec4 o=vec2(-delta,delta).xxyy/tDiffuseSize.xyxy;vec4 s=Sample(uv+o.xy)+Sample(uv+o.zy)+Sample(uv+o.xw)+Sample(uv+o.zw);return s*0.25;}void main(){
#if PASS_STEP == 0 
gl_FragColor=weight*Prefilter(SampleBox(vUv,1.));gl_FragColor.a=1.;
#elif PASS_STEP == 1 
gl_FragColor=weight*(SampleBox(vUv,1.));gl_FragColor.a=1.;
#elif PASS_STEP == 2 
gl_FragColor=(SampleBox(vUv,0.5));gl_FragColor.a=1.;
#elif PASS_STEP == 3 
vec4 texel=tSourceTexelToLinear(texture2D(tSource,vUv));vec4 bloom=intensity*SampleBox(vUv,0.5).rgba;float brightness=max(bloom.r,max(bloom.g,bloom.b));texel.rgb+=bloom.rgb;texel.a=min(1.,texel.a+brightness);gl_FragColor=texel;
#elif PASS_STEP == 4 
vec4 texel=vec4(0.);texel.rgb+=intensity*SampleBox(vUv,0.5).rgb;texel.a=1.;gl_FragColor=texel;
#endif
#include <encodings_fragment>
}`},"tDiffuse","tSource"),this.uiConfig=void 0,this.prefilter=new et.Ltg(2,.5,0,0),this.threshold=2,this.softThreshold=.5,this.intensity=.5,this.bloomIterations=4,this.radius=.6,this.power=1,this.bloomDebug=!1,this._weights=[],this._updateWeights=this._updateWeights.bind(this),this._thresholdsUpdated=this._thresholdsUpdated.bind(this),this._updateWeights(),this._thresholdsUpdated(),this.clear=!0,this.userData={setDirty:()=>{this.setDirty()}}}_thresholdsUpdated(){this.prefilter.x=this.threshold,this.prefilter.y=this.softThreshold,this.prefilter.z=2*this.prefilter.x*this.prefilter.y,this.prefilter.w=.125/(this.uniforms.prefilter.value.z+1e-5)}render(tt,s,o,a,_e){const rt=tt.baseRenderer;this.material.defines.PASS_STEP=0,this.clear=!0;const nt=o;let ot=.5,ct=nt.width*ot,pt=nt.height*ot;const ht=[];let _t=rt.getTempTarget({sizeMultiplier:.5,type:et.cLu});ht.push(_t);let Et=nt;this.material.needsUpdate=!0,this.material.uniforms.weight.value=this._weights[0],super.render(tt,_t,Et,a,_e),Et=_t;let St=1;for(;St<this.bloomIterations&&(ct/=2,pt/=2,ot/=2,!(pt<2||ct<2));St++){_t=rt.getTempTarget({sizeMultiplier:ot,type:et.cLu}),ht.push(_t),this.material.defines.PASS_STEP=1;let It=this._weights[St];It=this._weights[St-1]!==0?this._weights[St]/this._weights[St-1]:this._weights[St],this.material.uniforms.weight.value=It,this.material.needsUpdate=!0,super.render(tt,_t,Et,a,_e),Et=_t}this.clear=!1;const Mt=tt.autoClear;for(tt.autoClear=!1,St-=2;St>=0;St--)_t=ht[St],ht[St]=void 0,this.material.defines.PASS_STEP=2,this.material.transparent=!0,this.material.blending=et.WMw,this.material.needsUpdate=!0,tt.autoClear=!1,super.render(tt,_t,Et,a,_e),this.material.blending=et.jFi,rt.releaseTempTarget(Et),Et=_t;this.clear=!0,tt.autoClear=Mt,tt.autoClear=!0,this.bloomDebug?(this.material.defines.PASS_STEP=4,this.material.needsUpdate=!0,super.render(tt,s,Et,a,_e)):(this.uniforms.tSource.value=nt.texture,this.material.defines.PASS_STEP=3,this.material.needsUpdate=!0,super.render(tt,s,Et,a,_e),this.uniforms.tSource.value=null),rt.releaseTempTarget(Et)}_updateWeights(){if(!this._weights)return;const tt=Math.max(Math.min(this.radius,1),0),s=1/(this.bloomIterations-1);for(let o=0;o<this.bloomIterations;o++){let a=o*s+.1,_e=1.2-a;a=Math.pow(a,this.power),_e=Math.pow(_e,this.power),this._weights[o]=_e*(1-tt)+a*tt}this.setDirty()}};tv([Ar()],ym.prototype,"prefilter",void 0),tv([gs("Threshold",[0,2]),vr(ny.prototype._thresholdsUpdated),Yr()],ym.prototype,"threshold",void 0),tv([gs("Soft Threshold",[0,1]),vr(ny.prototype._thresholdsUpdated),Yr()],ym.prototype,"softThreshold",void 0),tv([gs("Intensity",[0,3]),Yr(),Ar()],ym.prototype,"intensity",void 0),tv([gs("Iterations",[0,7],1),vr(ny.prototype._updateWeights),Yr()],ym.prototype,"bloomIterations",void 0),tv([gs("Radius",[0,1],.01),vr(ny.prototype._updateWeights),Yr()],ym.prototype,"radius",void 0),tv([gs("Power",[.2,10],.01),vr(ny.prototype._updateWeights),Yr()],ym.prototype,"power",void 0),tv([ds("Debug")],ym.prototype,"bloomDebug",void 0),ym=ny=tv([Ao("Bloom")],ym);class iy extends Mv{constructor(){super(...arguments),this.passId="bloom",this._beforeFilters=["combinedPost","screen"],this._afterFilters=["render","progressive"],this._requiredFilters=["render"]}passCtor(s){return new ym}_update(s){var o,a;return(o=s.getPlugin(Dl))===null||o===void 0||o.updateShaderProperties((a=this.pass)===null||a===void 0?void 0:a.passObject.material),super._update(s)}get uiConfig(){var s;return(s=this.pass)===null||s===void 0?void 0:s.passObject.uiConfig}}iy.PluginType="Bloom";var xE=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let Am=class extends io{constructor(){super(),this.enabled=!0,this.dependencies=[os],this._defines={ANISOTROPY_DEBUG:!1},this._uniforms={anisotropyFactor:{value:1},anisotropyNoise:{value:1},anisotropyDirection:{value:1},anisotropyDirectionMap:{value:null},frameCount:{value:0}},this.materialExtension={shaderExtender:(tt,s,o)=>{var a;if(!this.enabled||!s.materialObject.userData._isAnisotropic)return;const _e=(a=s.materialObject.userData)===null||a===void 0?void 0:a._anisotropyDirectionMap,rt=Wt`
                #include <bsdfs>
                //#if ANISOTROPY_ENABLED
                ${Pv}
                ${`uniform float anisotropyFactor;uniform float anisotropyNoise;
#if ANISOTROPY_TEX_MODE == 0
uniform float anisotropyDirection;
#else
uniform sampler2D anisotropyDirectionMap;
#endif
const float MIN_ROUGHNESS=0.05;float D_GGX_Anisotropy(float at,float ab,float ToH,float BoH,float NoH){float a2=at*ab;highp vec3 d=vec3(ab*ToH,at*BoH,a2*NoH);highp float d2=dot(d,d);float b2=a2/d2;return a2*b2*b2*(1./PI);}float V_GGX_SmithCorrelated_Anisotropy(float at,float ab,float ToV,float BoV,float ToL,float BoL,float NoV,float NoL){float lambdaV=NoL*length(vec3(at*ToV,ab*BoV,NoV));float lambdaL=NoV*length(vec3(at*ToL,ab*BoL,NoL));float v=0.5/(lambdaV+lambdaL);return saturate(v);}vec3 indirectAnisotropyBentNormal(const in vec3 normal,const in vec3 viewDir,const in float roughness,const in vec3 anisotropicT,const in vec3 anisotropicB){vec3 aDirection=anisotropyFactor>=0.?anisotropicB:anisotropicT;vec3 aTangent=cross(aDirection,viewDir);vec3 aNormal=cross(aTangent,aDirection);float bendFactor=abs(anisotropyFactor)*saturate(5.*max(roughness,MIN_ROUGHNESS));return normalize(mix(normal,aNormal,bendFactor));}vec3 BRDF_GGX_Anisotropy(const in vec3 lightDir,const in vec3 viewDir,const in vec3 normal,const in vec3 f0,const in float f90,const in float roughness,const in vec3 anisotropicT,const in vec3 anisotropicB){float alpha=pow2(roughness);vec3 halfDir=normalize(lightDir+viewDir);float dotNL=saturate(dot(normal,lightDir));float dotNV=saturate(dot(normal,viewDir));float dotNH=saturate(dot(normal,halfDir));float dotVH=saturate(dot(viewDir,halfDir));float dotTV=dot(anisotropicT,viewDir);float dotBV=dot(anisotropicB,viewDir);float dotTL=dot(anisotropicT,lightDir);float dotBL=dot(anisotropicB,lightDir);float dotTH=dot(anisotropicT,halfDir);float dotBH=dot(anisotropicB,halfDir);float aspect=sqrt(1.-min(1.-MIN_ROUGHNESS,abs(anisotropyFactor)*0.9));if(anisotropyFactor>0.)aspect=1./aspect;float at=roughness*aspect;float ab=roughness/aspect;vec3 F=F_Schlick(f0,f90,dotVH);float V=V_GGX_SmithCorrelated_Anisotropy(at,ab,dotTV,dotBV,dotTL,dotBL,dotNV,dotNL);float D=D_GGX_Anisotropy(at,ab,dotTH,dotBH,dotNH);return F*(V*D);}`}
            `+(_e?sn("anisotropyDirectionMap",_e,o.capabilities.isWebGL2):"");tt.fragmentShader=tt.fragmentShader.replace("#include <bsdfs>",rt),tt.fragmentShader=tt.fragmentShader.replace("#include <lights_fragment_begin>",et.WdD.lights_fragment_begin),tt.fragmentShader=tt.fragmentShader.replace("IncidentLight directLight;",`float rnd=(random2(vUv.xy,frameCount)-0.5)*anisotropyNoise*material.roughness;
#if ANISOTROPY_TEX_MODE < 2
#if ANISOTROPY_TEX_MODE == 0 
float rot=saturate(anisotropyDirection);
#else 
float rot=(anisotropyDirectionMapTexelToLinear(texture2D(anisotropyDirectionMap,vUv)).r);
#endif
rot=rot*2.*PI+rnd;vec2 rot2=vec2(sin(rot),cos(rot));
#else 
vec2 rot2=(anisotropyDirectionMapTexelToLinear(texture2D(anisotropyDirectionMap,vUv)).rg*2.-1.)+vec2(rnd,rnd);rot2=normalize(rot2);const float anisoSpecMultiplier=0.25;float matSpecAniso=(length(material.specularColor.rgb))*2.*PI;rot2=mix(rot2,vec2(sin(matSpecAniso),cos(matSpecAniso)),anisoSpecMultiplier);rot2=normalize(rot2);
#endif
vec3 anisotropicT=(tangent*rot2.x+bitangent*rot2.y);anisotropicT=normalize(anisotropicT-normal*dot(anisotropicT,normal));vec3 anisotropicB=normalize(cross(normal,anisotropicT));IncidentLight directLight;`).replaceAll("RE_Direct( directLight, geometry, material, reflectedLight )","RE_Direct( directLight, geometry, material, reflectedLight, anisotropicT, anisotropicB )");const nt=et.WdD.lights_physical_pars_fragment.replace("void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {","void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight, const in vec3 anisotropicT, const in vec3 anisotropicB ) {").replace("BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness )","BRDF_GGX_Anisotropy( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness, anisotropicT, anisotropicB )");tt.fragmentShader=tt.fragmentShader.replace("#include <lights_physical_pars_fragment>",nt);const ot=Wt`
                #if defined( USE_ENVMAP )
                vec3 anisotropyBentNormal = indirectAnisotropyBentNormal(geometry.normal, geometry.viewDir, material.roughness, anisotropicT, anisotropicB);
                #endif
            `+et.WdD.lights_fragment_maps.replace("getIBLIrradiance( geometry.normal )","getIBLIrradiance( anisotropyBentNormal )").replace("getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness )","getIBLRadiance( geometry.viewDir, anisotropyBentNormal, material.roughness )");tt.fragmentShader=tt.fragmentShader.replace("#include <lights_fragment_maps>",ot),tt.vertexUvs=!0,tt.vertexTangents=!0},onObjectRender:(tt,s)=>{var o;const a=s.materialObject.userData;if(!(a!=null&&a._isAnisotropic))return;const _e=tt;if(!_e.isMesh||!_e.geometry)return;if(!_e.geometry.attributes.tangent)throw new Error("No tangents on the geometry");this._uniforms.anisotropyFactor.value=a._anisotropyFactor,this._uniforms.anisotropyNoise.value=a._anisotropyNoise,this._uniforms.anisotropyDirectionMap.value=!((o=a._anisotropyDirectionMap)===null||o===void 0)&&o.isTexture?a._anisotropyDirectionMap:null,this._uniforms.anisotropyDirection.value=a._anisotropyDirection;let rt=this.enabled?1:0;s.materialObject.defines.ANISOTROPY_ENABLED!==rt&&(s.materialObject.defines.ANISOTROPY_ENABLED=rt,s.materialObject.needsUpdate=!0),rt=+this._defines.ANISOTROPY_DEBUG,s.materialObject.defines.ANISOTROPY_DEBUG!==rt&&(s.materialObject.defines.ANISOTROPY_DEBUG=rt,s.materialObject.needsUpdate=!0),rt=a._anisotropyDirectionMode,this._uniforms.anisotropyDirectionMap.value||(rt="CONSTANT"),rt=rt==="DIRECTION"?2:rt==="ROTATION"?1:0,s.materialObject.defines.ANISOTROPY_TEX_MODE!==rt&&(s.materialObject.defines.ANISOTROPY_TEX_MODE=rt,s.materialObject.needsUpdate=!0)},extraUniforms:{...this._uniforms},computeCacheKey:tt=>{var s,o,a;return(this.enabled?"1":"0")+(!((s=tt.materialObject.userData)===null||s===void 0)&&s._isAnisotropic?"1":"0")+((a=(o=tt.materialObject.userData)===null||o===void 0?void 0:o._anisotropyDirectionMap)===null||a===void 0?void 0:a.uuid)},isCompatible:tt=>tt.isMeshStandardMaterial2,updaters:()=>{var tt;return[(tt=this._viewer)===null||tt===void 0?void 0:tt.renderer]},getUiConfig:tt=>{const s=this._viewer,o=this.makeAnisotropic,a={type:"folder",label:"Anisotropy",children:[{type:"checkbox",label:"Enabled",get value(){return tt.materialObject.userData._isAnisotropic||!1},set value(_e){var rt;_e!==tt.materialObject.userData._isAnisotropic&&(_e?o(tt)||s.alert("One or more geometries cannot be made anisotropic."):(tt.materialObject.userData._isAnisotropic=!1,tt.materialObject.needsUpdate=!0),(rt=a.uiRefresh)===null||rt===void 0||rt.call(a,"postFrame",!0))},onChange:this.setDirty},{type:"slider",label:"Factor",bounds:[-2,2],hidden:()=>!tt.materialObject.userData._isAnisotropic,property:[tt.materialObject.userData,"_anisotropyFactor"],onChange:this.setDirty},{type:"slider",label:"Noise",bounds:[0,2],hidden:()=>!tt.materialObject.userData._isAnisotropic,property:[tt.materialObject.userData,"_anisotropyNoise"],onChange:this.setDirty},{type:"image",label:"Texture",hidden:()=>!tt.materialObject.userData._isAnisotropic,property:[tt.materialObject.userData,"_anisotropyDirectionMap"],onChange:()=>{tt.materialObject.needsUpdate=!0,this.setDirty()}},{type:"dropdown",label:"Mode",hidden:()=>!tt.materialObject.userData._isAnisotropic,property:[tt.materialObject.userData,"_anisotropyDirectionMode"],children:["CONSTANT","ROTATION","DIRECTION"].map(_e=>({label:_e})),onChange:()=>{tt.materialObject.needsUpdate=!0,this.setDirty()}}]};return a}},this.setDirty=()=>{var tt;(tt=this._viewer)===null||tt===void 0||tt.setDirty()},this.makeSelectedAnisotropic=()=>{var tt,s,o;const a=(o=(s=(tt=this._viewer)===null||tt===void 0?void 0:tt.getPlugin(Wo))===null||s===void 0?void 0:s.getSelectedObject())===null||o===void 0?void 0:o.material;return(a==null?void 0:a.assetType)==="material"&&this.makeAnisotropic(a)},this._loaderCreate=this._loaderCreate.bind(this)}makeAnisotropic(tt){var s;const o=(s=tt.materialObject)===null||s===void 0?void 0:s.userData;if(!o)return!1;if(o._isAnisotropic===void 0){const a=o.__appliedMeshes;let _e=!0;if(a)for(const{geometry:rt}of a)!rt||rt.index&&rt.attributes.position&&rt.attributes.normal&&rt.attributes.uv||(_e=!1),_e&&!rt.attributes.tangent&&rt.computeTangents();if(!_e)return!1}return o._isAnisotropic=!0,o._anisotropyFactor===void 0&&(o._anisotropyFactor=1),o._anisotropyNoise===void 0&&(o._anisotropyNoise=0),o._anisotropyDirectionMode===void 0&&(o._anisotropyDirectionMode="DIRECTION"),tt.materialObject.needsUpdate=!0,!0}_loaderCreate({loader:tt}){tt.isGLTFLoader2&&tt.register(s=>new E1(s))}async onAdded(tt){var s,o,a,_e,rt;await super.onAdded(tt);const nt=tt.getPlugin(os);(s=nt==null?void 0:nt.materials)===null||s===void 0||s.registerMaterialExtension(this.materialExtension),(o=nt==null?void 0:nt.importer)===null||o===void 0||o.addEventListener("loaderCreate",this._loaderCreate),(rt=(_e=(a=nt==null?void 0:nt.exporter)===null||a===void 0?void 0:a.getExporter("gltf","glb"))===null||_e===void 0?void 0:_e.extensions)===null||rt===void 0||rt.push(RC)}async onRemove(tt){var s,o,a,_e;return(o=(s=tt.getPlugin(os))===null||s===void 0?void 0:s.materials)===null||o===void 0||o.unregisterMaterialExtension(this.materialExtension),(_e=(a=tt.getPlugin(os))===null||a===void 0?void 0:a.importer)===null||_e===void 0||_e.removeEventListener("loaderCreate",this._loaderCreate),super.onRemove(tt)}};Am.PluginType="AnisotropyPlugin",Am.ANISOTROPY_GLTF_EXTENSION="WEBGI_materials_anisotropy",xE([ds("Enabled",tt=>({onChange:tt.setDirty})),Yr()],Am.prototype,"enabled",void 0),xE([Qo("Make Anisotropy",tt=>({hidden:()=>{var s;return!(!((s=tt._viewer)===null||s===void 0)&&s.getPlugin(Wo))}}))],Am.prototype,"makeSelectedAnisotropic",void 0),Am=xE([Ao("Anisotropy Materials")],Am);class E1{constructor(s){this.parser=s,this.name=Am.ANISOTROPY_GLTF_EXTENSION}async extendMaterialParams(s,o){var a,_e,rt;const nt=this.parser,ot=nt.json.materials[s];if(!ot.extensions||!ot.extensions[this.name])return Promise.resolve();const ct=[],pt=ot.extensions[this.name];o.userData||(o.userData={}),o.userData._isAnisotropic=!0,o.userData._anisotropyFactor=(a=pt.anisotropyFactor)!==null&&a!==void 0?a:0,o.userData._anisotropyNoise=(rt=(_e=pt.anisotropyNoiseFactor)!==null&&_e!==void 0?_e:pt.anisotropyNoise)!==null&&rt!==void 0?rt:0;let{anisotropyDirectionMode:ht,anisotropyDirection:_t}=pt;return ht||(ht=pt.anisotropyTextureMode),_t||(_t=pt.anisotropyRotation),o.userData._anisotropyDirectionMode=ht&&typeof(_t==null?void 0:_t.index)=="number"?ht:"CONSTANT",ht==="ROTATION"||ht==="DIRECTION"?ct.push(nt.assignTexture(o.userData,"_anisotropyDirectionMap",_t).then(Et=>{Et.encoding=et.knz})):o.userData._anisotropyDirection=_t??0,Promise.all(ct)}afterRoot(s){return s.scene.traverse(o=>{var a,_e;if(!(!((_e=(a=o.material)===null||a===void 0?void 0:a.userData)===null||_e===void 0)&&_e._isAnisotropic))return;const rt=o.geometry;rt.attributes.tangent||(rt.computeTangents(),rt.attributes.tangent.needsUpdate=!0)}),null}}const RC=tt=>({writeMaterial:(s,o)=>{if(!s.isMeshStandardMaterial||!s.userData._isAnisotropic||(s.userData._anisotropyFactor||0)<.001)return;o.extensions=o.extensions||{};const a={};if(a.anisotropyFactor=s.userData._anisotropyFactor||1,a.anisotropyNoiseFactor=s.userData._anisotropyNoise||0,a.anisotropyDirectionMode=s.userData._anisotropyDirectionMode||"CONSTANT",s.userData._anisotropyDirectionMap&&a.anisotropyDirectionMode!=="CONSTANT"){const _e={index:tt.processTexture(s.userData._anisotropyDirectionMap)};tt.applyTextureTransform(_e,s.userData._anisotropyDirectionMap),a.anisotropyDirection=_e}else a.anisotropyDirectionMode="CONSTANT",a.anisotropyDirection=s.userData._anisotropyDirection||0;o.extensions[Am.ANISOTROPY_GLTF_EXTENSION]=a,tt.extensionsUsed[Am.ANISOTROPY_GLTF_EXTENSION]=!0}});var Nv=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let km=class extends io{constructor(){super(),this.enabled=!0,this.dependencies=[os],this._defines={},this._uniforms={thinBaseLayerFactors:{value:new et.Ltg},thinNoiseLayerFactors:{value:new et.Ltg},thinColorNoiseParams:{value:new et.Ltg},thinFilmFactor:{value:.8}},this.materialExtension={parsFragmentSnippet:(tt,s)=>{var o;return this.enabled&&(!((o=s==null?void 0:s.materialObject.userData._thinFilmLayer)===null||o===void 0)&&o.hasThinFilm)?Pv+`
#ifndef VORONOISE_HELPER
#define VORONOISE_HELPER 
float voronoise(in vec2 p,float u,float v){float k=1.+63.*pow(1.-v,6.);vec2 i=floor(p);vec2 f=fract(p);vec2 a=vec2(0.,0.);for(int y=-2;y<=2;y++)for(int x=-2;x<=2;x++){vec2 g=vec2(x,y);vec3 o=hash3(i+g)*vec3(u,u,1.);vec2 d=g-f+o.xy;float w=pow(1.-smoothstep(0.,1.414,length(d)),k);a+=vec2(o.z*w,w);}return a.x/a.y;}vec3 voronoise3(vec2 p,float u,float v){return vec3(voronoise(p,u,v),voronoise(p+vec2(0.435,0.23),u,v),voronoise(p-vec2(0.83,0.45),u,v));}vec3 voronoiseNormal(vec2 p,float u,float v){return vec3(voronoise(p,u,v),voronoise(p+vec2(0.435,0.23),u,v),1.);}
#endif

#ifndef HSV_HELPERS
#define HSV_HELPERS 
vec3 hsv2rgb(vec3 c){vec4 K=vec4(1.,2./3.,1./3.,3.);vec3 p=abs(fract(c.xxx+K.xyz)*6.-K.www);return c.z*mix(K.xxx,clamp(p-K.xxx,0.,1.),c.y);}vec3 rgb2hsv(vec3 c){vec4 K=vec4(0.,-1./3.,2./3.,-1.);vec4 p=c.g<c.b?vec4(c.bg,K.wz):vec4(c.gb,K.xy);vec4 q=c.r<p.x?vec4(p.xyw,c.r):vec4(c.r,p.yzx);float d=q.x-min(q.w,q.y);float e=1.0e-10;return vec3(abs(q.z+(q.w-q.y)/(6.*d+e)),d/(q.x+e),q.x);}
#endif 

uniform vec4 thinBaseLayerFactors;
uniform vec4 thinNoiseLayerFactors;
uniform vec4 thinColorNoiseParams;
uniform float thinFilmFactor;
        `:""},shaderExtender:(tt,s,o)=>{var a;if(!this.enabled||!(!((a=s.materialObject.userData._thinFilmLayer)===null||a===void 0)&&a.hasThinFilm))return;const _e="#glMarker beforeAccumulation";tt.fragmentShader=tt.fragmentShader.replace(_e,"vec3 incident=normalize(vViewPosition.xyz);float hWeight=1.-dot(normal,incident);vec3 noiseV=voronoise3(vUv.xy*thinColorNoiseParams.xy*60.,thinColorNoiseParams.z,thinColorNoiseParams.w);float hWeight2=1.-dot(normalize(noiseV),incident);vec3 film=hsv2rgb(vec3(fract(hWeight+thinBaseLayerFactors.x),thinBaseLayerFactors.y,thinBaseLayerFactors.z))*thinBaseLayerFactors.a;vec3 film2=hsv2rgb(vec3(fract(hWeight2+thinNoiseLayerFactors.x),thinNoiseLayerFactors.y,thinNoiseLayerFactors.z))*thinNoiseLayerFactors.a;film=(film+film2)/(thinBaseLayerFactors.a+thinNoiseLayerFactors.a);diffuseColor.rgb=mix(diffuseColor.rgb,film,thinFilmFactor);"+_e),tt.vertexUvs=!0},onObjectRender:(tt,s)=>{var o;const a=(o=s.materialObject.userData)===null||o===void 0?void 0:o._thinFilmLayer;if(!(a!=null&&a.hasThinFilm))return;this._uniforms.thinBaseLayerFactors.value.fromArray(a.baseLayerFactors),this._uniforms.thinNoiseLayerFactors.value.fromArray(a.noiseLayerFactors),this._uniforms.thinColorNoiseParams.value.fromArray(a.colorNoiseParams),this._uniforms.thinFilmFactor.value=a.filmFactor;const _e=this.enabled?1:0;s.materialObject.defines.THIN_FILM_LAYER_ENABLED!==_e&&(s.materialObject.defines.THIN_FILM_LAYER_ENABLED=_e,s.materialObject.needsUpdate=!0)},extraUniforms:{...this._uniforms},computeCacheKey:tt=>{var s,o;return(this.enabled?"1":"0")+(!((o=(s=tt.materialObject.userData)===null||s===void 0?void 0:s._thinFilmLayer)===null||o===void 0)&&o.hasThinFilm?"1":"0")},isCompatible:tt=>tt.isMeshStandardMaterial2,updaters:()=>[],getUiConfig:tt=>{const s=this._viewer,o={type:"folder",label:"ThinFilmLayer",children:[{type:"checkbox",label:"Enabled",get value(){var a;return((a=tt.materialObject.userData._thinFilmLayer)===null||a===void 0?void 0:a.hasThinFilm)||!1},set value(a){var _e,rt;a!==((_e=tt.materialObject.userData._thinFilmLayer)===null||_e===void 0?void 0:_e.hasThinFilm)&&(a?EE(tt.materialObject)||s.alert("Cannot add thin film."):(tt.materialObject.userData._thinFilmLayer.hasThinFilm=!1,tt.materialObject.needsUpdate=!0),(rt=o.uiRefresh)===null||rt===void 0||rt.call(o,"postFrame",!0))},onChange:this.setDirty},()=>({type:"slider",bounds:[0,1],label:"Intensity",hidden:()=>{var a;return!(!((a=tt.materialObject.userData._thinFilmLayer)===null||a===void 0)&&a.hasThinFilm)},property:[tt.materialObject.userData._thinFilmLayer,"filmFactor"],onChange:this.setDirty}),()=>({type:"vec4",label:"Base Layer",bounds:[0,1],hidden:()=>{var a;return!(!((a=tt.materialObject.userData._thinFilmLayer)===null||a===void 0)&&a.hasThinFilm)},property:[tt.materialObject.userData._thinFilmLayer,"baseLayerFactors"],onChange:this.setDirty}),()=>({type:"vec4",label:"Noise Layer",bounds:[0,1],hidden:()=>{var a;return!(!((a=tt.materialObject.userData._thinFilmLayer)===null||a===void 0)&&a.hasThinFilm)},property:[tt.materialObject.userData._thinFilmLayer,"noiseLayerFactors"],onChange:this.setDirty}),()=>({type:"vec4",label:"Noise Params",bounds:[0,1],hidden:()=>{var a;return!(!((a=tt.materialObject.userData._thinFilmLayer)===null||a===void 0)&&a.hasThinFilm)},property:[tt.materialObject.userData._thinFilmLayer,"colorNoiseParams"],onChange:this.setDirty})]};return o}},this.setDirty=()=>{var tt;(tt=this._viewer)===null||tt===void 0||tt.setDirty()},this._loaderCreate=this._loaderCreate.bind(this)}addThinFilmLayer(tt){return EE(tt.materialObject)}_loaderCreate({loader:tt}){tt.isGLTFLoader2&&tt.register(s=>new S1(s))}async onAdded(tt){var s,o,a,_e,rt;await super.onAdded(tt);const nt=tt.getPlugin(os);(s=nt==null?void 0:nt.materials)===null||s===void 0||s.registerMaterialExtension(this.materialExtension),(o=nt==null?void 0:nt.importer)===null||o===void 0||o.addEventListener("loaderCreate",this._loaderCreate),(rt=(_e=(a=nt==null?void 0:nt.exporter)===null||a===void 0?void 0:a.getExporter("gltf","glb"))===null||_e===void 0?void 0:_e.extensions)===null||rt===void 0||rt.push(EP)}async onRemove(tt){var s,o,a,_e;return(o=(s=tt.getPlugin(os))===null||s===void 0?void 0:s.materials)===null||o===void 0||o.unregisterMaterialExtension(this.materialExtension),(_e=(a=tt.getPlugin(os))===null||a===void 0?void 0:a.importer)===null||_e===void 0||_e.removeEventListener("loaderCreate",this._loaderCreate),super.onRemove(tt)}};function EE(tt){const s=tt==null?void 0:tt.userData;if(!s)return!1;s._thinFilmLayer||(s._thinFilmLayer={});const o=s._thinFilmLayer;return o.hasThinFilm=!0,o.baseLayerFactors===void 0&&(o.baseLayerFactors=[.3,.6,1,.9]),o.noiseLayerFactors===void 0&&(o.noiseLayerFactors=[.7,.5,.9,.7]),o.colorNoiseParams===void 0&&(o.colorNoiseParams=[.5,.5,.5,.7]),o.filmFactor===void 0&&(o.filmFactor=.3),tt.isMaterial&&(tt.needsUpdate=!0),!0}km.PluginType="ThinFilmLayerPlugin",km.THIN_FILM_LAYER_GLTF_EXTENSION="WEBGI_materials_thin_film_layer",Nv([ds("Enabled",tt=>({onChange:tt.setDirty})),Yr()],km.prototype,"enabled",void 0),km=Nv([Ao("ThinFilmLayer Materials")],km);class S1{constructor(s){this.parser=s,this.name=km.THIN_FILM_LAYER_GLTF_EXTENSION}async extendMaterialParams(s,o){const a=this.parser.json.materials[s];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const _e=a.extensions[this.name];return o.userData||(o.userData={}),EE(o),o.userData._thinFilmLayer=In(_e,o.userData._thinFilmLayer,!1,{}),Promise.resolve()}}const EP=tt=>({writeMaterial:(s,o)=>{if(!s.isMeshStandardMaterial||!s.userData._thinFilmLayer||!s.userData._thinFilmLayer.hasThinFilm)return;o.extensions=o.extensions||{};const a=rs(s.userData._thinFilmLayer,!1);o.extensions[km.THIN_FILM_LAYER_GLTF_EXTENSION]=a,tt.extensionsUsed[km.THIN_FILM_LAYER_GLTF_EXTENSION]=!0}});var lw=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let yp=class extends io{constructor(){super(),this.enabled=!0,this.dependencies=[os],this._defines={},this._uniforms={noiseBumpParams:{value:new et.FM8},noiseBumpScale:{value:.05},noiseBumpFlakeScale:{value:1e3},noiseFlakeClamp:{value:1},noiseFlakeRadius:{value:.5},noiseFlakeRoughnessMod:{value:1}},this.materialExtension={parsFragmentSnippet:(tt,s)=>{var o;return this.enabled&&(!((o=s==null?void 0:s.materialObject.userData._noiseBumpMat)===null||o===void 0)&&o.hasBump)?Pv+`
#ifndef VORONOI_HELPER
#define VORONOI_HELPER 
float voronoi_distance(vec2 a,vec2 b,float metric){return distance(a,b);}float voronoi_f1_2d(in vec2 coord,in float randomness,in float flakeClamp,in float flakeRadius,inout vec3 outColor){vec2 cellPosition=floor(coord);vec2 localPosition=coord-cellPosition;float minDistance=8.;vec2 targetOffset,targetPosition;for(int j=-1;j<=1;j++){for(int i=-1;i<=1;i++){vec2 cellOffset=vec2(i,j);vec2 pointPosition=cellOffset+hash3(cellPosition+cellOffset).xy*randomness;float distanceToPoint=voronoi_distance(pointPosition,localPosition,1.);if(distanceToPoint<minDistance){targetOffset=cellOffset;minDistance=distanceToPoint;targetPosition=pointPosition;}}}float outDistance=minDistance;float dist=step(flakeRadius,outDistance);outColor=hash3(cellPosition+hash3(cellPosition+targetOffset).xy*randomness+targetOffset);vec3 outColor1=minDistance<flakeRadius?outColor:vec3(0.5,0.5,1.);outDistance=mix(dist,minDistance,flakeClamp);outColor=mix(outColor1,outColor,flakeClamp);return outDistance;}
#endif

uniform vec2 noiseBumpParams;uniform float noiseBumpScale;uniform float noiseBumpFlakeScale;uniform float noiseFlakeClamp;uniform float noiseFlakeRadius;uniform float noiseFlakeRoughnessMod;vec3 perturbNormalArb_nb(vec3 surf_pos,vec3 surf_norm,vec2 dHdxy,float faceDirection){vec3 vSigmaX=dFdx(surf_pos.xyz);vec3 vSigmaY=dFdy(surf_pos.xyz);vec3 vN=surf_norm;vec3 R1=cross(vSigmaY,vN);vec3 R2=cross(vN,vSigmaX);float fDet=dot(vSigmaX,R1)*faceDirection;vec3 vGrad=sign(fDet)*(dHdxy.x*R1+dHdxy.y*R2);return normalize(abs(fDet)*surf_norm-vGrad);}
`:""},shaderExtender:(tt,s,o)=>{var a;if(!this.enabled||!(!((a=s.materialObject.userData._noiseBumpMat)===null||a===void 0)&&a.hasBump))return;const _e="#glMarker beforeAccumulation";tt.fragmentShader=tt.fragmentShader.replace(_e,`
            vec3 outColor; 
            float voronoiDist = clamp(voronoi_f1_2d( noiseBumpFlakeScale * noiseBumpParams.xy * vUv, 1., noiseFlakeClamp, noiseFlakeRadius, outColor ), 0.0, 1.0);
            normal = perturbNormalArb_nb( - vViewPosition, normal, (2. * outColor.xy - 1.) * noiseBumpScale, faceDirection ); 
            float avg = (outColor.r + outColor.g)*0.5; 
            diffuseColor *= (clamp(avg+0.5, 0.3, 1.));
            float roughnessModifier = mix(1. - avg, 1., noiseFlakeRoughnessMod);
            roughnessFactor *= roughnessModifier;
            
`+_e),tt.vertexUvs=!0,tt.extensionDerivatives=!0},onObjectRender:(tt,s)=>{var o;const a=(o=s.materialObject.userData)===null||o===void 0?void 0:o._noiseBumpMat;if(!(a!=null&&a.hasBump))return;this._uniforms.noiseBumpParams.value.fromArray(a.bumpNoiseParams),this._uniforms.noiseBumpScale.value=a.bumpScale,this._uniforms.noiseBumpFlakeScale.value=a.flakeScale,this._uniforms.noiseFlakeClamp.value=a.flakeClamp,this._uniforms.noiseFlakeRadius.value=a.flakeRadius,this._uniforms.noiseFlakeRoughnessMod.value=a.flakeRoughnessMod;const _e=this.enabled?1:0;s.materialObject.defines.NOISE_BUMP_MATERIAL_ENABLED!==_e&&(s.materialObject.defines.NOISE_BUMP_MATERIAL_ENABLED=_e,s.materialObject.needsUpdate=!0)},extraUniforms:{...this._uniforms},computeCacheKey:tt=>{var s,o;return(this.enabled?"1":"0")+(!((o=(s=tt.materialObject.userData)===null||s===void 0?void 0:s._noiseBumpMat)===null||o===void 0)&&o.hasBump?"1":"0")},isCompatible:tt=>tt.isMeshStandardMaterial2,updaters:()=>[],getUiConfig:tt=>{const s=this._viewer,o={type:"folder",label:"NoiseBumpMaterial",children:[{type:"checkbox",label:"Enabled",get value(){var a;return((a=tt.materialObject.userData._noiseBumpMat)===null||a===void 0?void 0:a.hasBump)||!1},set value(a){var _e,rt;a!==((_e=tt.materialObject.userData._noiseBumpMat)===null||_e===void 0?void 0:_e.hasBump)&&(a?rA(tt.materialObject)||s.alert("Cannot add noise bump."):(tt.materialObject.userData._noiseBumpMat.hasBump=!1,tt.materialObject.needsUpdate=!0),(rt=o.uiRefresh)===null||rt===void 0||rt.call(o,"postFrame",!0))},onChange:this.setDirty},()=>({type:"vec4",label:"Bump Noise Params",bounds:[0,1],hidden:()=>{var a;return!(!((a=tt.materialObject.userData._noiseBumpMat)===null||a===void 0)&&a.hasBump)},property:[tt.materialObject.userData._noiseBumpMat,"bumpNoiseParams"],onChange:this.setDirty}),()=>({type:"slider",label:"Bump Scale",bounds:[0,.01],stepSize:1e-5,hidden:()=>{var a;return!(!((a=tt.materialObject.userData._noiseBumpMat)===null||a===void 0)&&a.hasBump)},property:[tt.materialObject.userData._noiseBumpMat,"bumpScale"],onChange:this.setDirty}),()=>({type:"slider",label:"Flake Scale",bounds:[100,1e4],stepSize:1e-4,hidden:()=>{var a;return!(!((a=tt.materialObject.userData._noiseBumpMat)===null||a===void 0)&&a.hasBump)},property:[tt.materialObject.userData._noiseBumpMat,"flakeScale"],onChange:this.setDirty}),()=>({type:"slider",label:"Flake Clamp",bounds:[0,1],stepSize:1,hidden:()=>{var a;return!(!((a=tt.materialObject.userData._noiseBumpMat)===null||a===void 0)&&a.hasBump)},property:[tt.materialObject.userData._noiseBumpMat,"flakeClamp"],onChange:this.setDirty}),()=>({type:"slider",label:"Flake Radius",bounds:[.1,1],stepSize:.01,hidden:()=>{var a;return!(!((a=tt.materialObject.userData._noiseBumpMat)===null||a===void 0)&&a.hasBump)},property:[tt.materialObject.userData._noiseBumpMat,"flakeRadius"],onChange:this.setDirty}),()=>({type:"slider",label:"Flake Roughness Modifier",bounds:[0,1],stepSize:1,hidden:()=>{var a;return!(!((a=tt.materialObject.userData._noiseBumpMat)===null||a===void 0)&&a.hasBump)},property:[tt.materialObject.userData._noiseBumpMat,"flakeRoughnessMod"],onChange:this.setDirty})]};return o}},this.setDirty=()=>{var tt;(tt=this._viewer)===null||tt===void 0||tt.setDirty()},this._loaderCreate=this._loaderCreate.bind(this)}addNoiseBumpMaterial(tt){return rA(tt.materialObject)}_loaderCreate({loader:tt}){tt.isGLTFLoader2&&tt.register(s=>new C1(s))}async onAdded(tt){var s,o,a,_e,rt;await super.onAdded(tt);const nt=tt.getPlugin(os);(s=nt==null?void 0:nt.materials)===null||s===void 0||s.registerMaterialExtension(this.materialExtension),(o=nt==null?void 0:nt.importer)===null||o===void 0||o.addEventListener("loaderCreate",this._loaderCreate),(rt=(_e=(a=nt==null?void 0:nt.exporter)===null||a===void 0?void 0:a.getExporter("gltf","glb"))===null||_e===void 0?void 0:_e.extensions)===null||rt===void 0||rt.push(uw)}async onRemove(tt){var s,o,a,_e;return(o=(s=tt.getPlugin(os))===null||s===void 0?void 0:s.materials)===null||o===void 0||o.unregisterMaterialExtension(this.materialExtension),(_e=(a=tt.getPlugin(os))===null||a===void 0?void 0:a.importer)===null||_e===void 0||_e.removeEventListener("loaderCreate",this._loaderCreate),super.onRemove(tt)}};function rA(tt){const s=tt==null?void 0:tt.userData;if(!s)return!1;s._noiseBumpMat||(s._noiseBumpMat={});const o=s._noiseBumpMat;return o.hasBump=!0,o.bumpNoiseParams===void 0&&(o.bumpNoiseParams=[.5,.5]),o.bumpScale===void 0&&(o.bumpScale=.05),o.flakeScale===void 0&&(o.flakeScale=.05),o.flakeClamp===void 0&&(o.flakeClamp=1),o.flakeRadius===void 0&&(o.flakeRadius=.3),o.flakeRoughnessMod===void 0&&(o.flakeRoughnessMod=1),tt.isMaterial&&(tt.needsUpdate=!0),!0}yp.PluginType="NoiseBumpMaterialPlugin",yp.NOISE_BUMP_MATERIAL_GLTF_EXTENSION="WEBGI_materials_noise_bump",lw([ds("Enabled",tt=>({onChange:tt.setDirty})),Yr()],yp.prototype,"enabled",void 0),yp=lw([Ao("NoiseBumpMaterial Materials")],yp);class C1{constructor(s){this.parser=s,this.name=yp.NOISE_BUMP_MATERIAL_GLTF_EXTENSION}async extendMaterialParams(s,o){const a=this.parser.json.materials[s];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const _e=a.extensions[this.name];return o.userData||(o.userData={}),rA(o),o.userData._noiseBumpMat=In(_e,o.userData._noiseBumpMat,!1,{}),Promise.resolve()}}const uw=tt=>({writeMaterial:(s,o)=>{if(!s.isMeshStandardMaterial||!s.userData._noiseBumpMat||!s.userData._noiseBumpMat.hasBump)return;o.extensions=o.extensions||{};const a=rs(s.userData._noiseBumpMat,!1);o.extensions[yp.NOISE_BUMP_MATERIAL_GLTF_EXTENSION]=a,tt.extensionsUsed[yp.NOISE_BUMP_MATERIAL_GLTF_EXTENSION]=!0}});var nA,sy=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let lp=nA=class extends io{constructor(){super(),this.enabled=!0,this.dependencies=[os],this.bicubicFiltering=!0,this._defines={CUSTOM_BUMP_MAP_DEBUG:!1,CUSTOM_BUMP_MAP_BICUBIC:!0},this._uniforms={customBumpUvTransform:{value:new et.Vkp},customBumpScale:{value:.001},customBumpMap:{value:null}},this.materialExtension={parsFragmentSnippet:(tt,s)=>this.enabled&&(s!=null&&s.materialObject.userData._hasCustomBump)?`#if defined(CUSTOM_BUMP_MAP_ENABLED) && CUSTOM_BUMP_MAP_ENABLED > 0
#if CUSTOM_BUMP_MAP_BICUBIC > 0  
vec4 cubic(float v){vec4 n=vec4(1.,2.,3.,4.)-v;vec4 s=n*n*n;float x=s.x;float y=s.y-4.*s.x;float z=s.z-4.*s.y+6.*s.x;float w=6.-x-y-z;return vec4(x,y,z,w)*(1./6.);}vec4 textureBicubic(sampler2D sampler,vec2 texCoords){vec2 texSize=vec2(textureSize(sampler,0));vec2 invTexSize=1./texSize;texCoords=texCoords*texSize-0.5;vec2 fxy=fract(texCoords);texCoords-=fxy;vec4 xcubic=cubic(fxy.x);vec4 ycubic=cubic(fxy.y);vec4 c=texCoords.xxyy+vec2(-0.5,+1.5).xyxy;vec4 s=vec4(xcubic.xz+xcubic.yw,ycubic.xz+ycubic.yw);vec4 offset=c+vec4(xcubic.yw,ycubic.yw)/s;offset*=invTexSize.xxyy;vec4 sample0=texture(sampler,offset.xz);vec4 sample1=texture(sampler,offset.yz);vec4 sample2=texture(sampler,offset.xw);vec4 sample3=texture(sampler,offset.yw);float sx=s.x/(s.x+s.y);float sy=s.z/(s.z+s.w);return mix(mix(sample3,sample2,sx),mix(sample1,sample0,sx),sy);}
#endif
varying vec2 vCustomBumpUv;uniform sampler2D customBumpMap;uniform float customBumpScale;vec2 dHdxy_fwd_cb(){vec2 dSTdx=dFdx(vCustomBumpUv);vec2 dSTdy=dFdy(vCustomBumpUv);
#if CUSTOM_BUMP_MAP_BICUBIC > 0
float Hll=customBumpScale*textureBicubic(customBumpMap,vCustomBumpUv).x;float dBx=customBumpScale*textureBicubic(customBumpMap,vCustomBumpUv+dSTdx).x-Hll;float dBy=customBumpScale*textureBicubic(customBumpMap,vCustomBumpUv+dSTdy).x-Hll;
#else
float Hll=customBumpScale*texture2D(customBumpMap,vCustomBumpUv).x;float dBx=customBumpScale*texture2D(customBumpMap,vCustomBumpUv+dSTdx).x-Hll;float dBy=customBumpScale*texture2D(customBumpMap,vCustomBumpUv+dSTdy).x-Hll;
#endif
return vec2(dBx,dBy);}
#ifndef USE_BUMPMAP
vec3 perturbNormalArb(vec3 surf_pos,vec3 surf_norm,vec2 dHdxy,float faceDirection){vec3 vSigmaX=dFdx(surf_pos.xyz);vec3 vSigmaY=dFdy(surf_pos.xyz);vec3 vN=surf_norm;vec3 R1=cross(vSigmaY,vN);vec3 R2=cross(vN,vSigmaX);float fDet=dot(vSigmaX,R1)*faceDirection;vec3 vGrad=sign(fDet)*(dHdxy.x*R1+dHdxy.y*R2);return normalize(abs(fDet)*surf_norm-vGrad);}
#endif
#endif
`:"",shaderExtender:(tt,s,o)=>{var a;this.enabled&&s.materialObject.userData._hasCustomBump&&(!((a=s.materialObject.userData)===null||a===void 0)&&a._customBumpMap)&&(tt.fragmentShader=Wl(tt.fragmentShader,"#glMarker beforeAccumulation",`
#if defined(CUSTOM_BUMP_MAP_ENABLED) && CUSTOM_BUMP_MAP_ENABLED > 0
    normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd_cb(), faceDirection );
#endif
                `,{prepend:!0}),tt.vertexShader=Wl(tt.vertexShader,"#include <uv_pars_vertex>",`
#if defined(CUSTOM_BUMP_MAP_ENABLED) && CUSTOM_BUMP_MAP_ENABLED > 0
                varying vec2 vCustomBumpUv;
                uniform mat3 customBumpUvTransform;
#endif
                `,{prepend:!0}),tt.vertexShader=Wl(tt.vertexShader,"#include <uv_vertex>",`
#if defined(CUSTOM_BUMP_MAP_ENABLED) && CUSTOM_BUMP_MAP_ENABLED > 0
                vCustomBumpUv = ( customBumpUvTransform * vec3( uv, 1 ) ).xy;
#endif
                `,{prepend:!0}),tt.vertexUvs=!0)},onObjectRender:(tt,s)=>{var o;const a=s.materialObject.userData;if(!(a!=null&&a._hasCustomBump))return;const _e=tt;if(!_e.isMesh||!_e.geometry)return;const rt=!((o=a._customBumpMap)===null||o===void 0)&&o.isTexture?a._customBumpMap:null;this._uniforms.customBumpMap.value=rt,this._uniforms.customBumpScale.value=rt?a._customBumpScale:0,rt&&(rt.updateMatrix(),this._uniforms.customBumpUvTransform.value.copy(rt.matrix));let nt=this.enabled&&rt?1:0;s.materialObject.defines.CUSTOM_BUMP_MAP_ENABLED!==nt&&(s.materialObject.defines.CUSTOM_BUMP_MAP_ENABLED=nt,s.materialObject.needsUpdate=!0),nt=+this._defines.CUSTOM_BUMP_MAP_DEBUG,s.materialObject.defines.CUSTOM_BUMP_MAP_DEBUG!==nt&&(s.materialObject.defines.CUSTOM_BUMP_MAP_DEBUG=nt,s.materialObject.needsUpdate=!0),nt=+this._defines.CUSTOM_BUMP_MAP_BICUBIC,s.materialObject.defines.CUSTOM_BUMP_MAP_BICUBIC!==nt&&(s.materialObject.defines.CUSTOM_BUMP_MAP_BICUBIC=nt,s.materialObject.needsUpdate=!0)},extraUniforms:{...this._uniforms},computeCacheKey:tt=>{var s,o,a;return(this.enabled?"1":"0")+(!((s=tt.materialObject.userData)===null||s===void 0)&&s._hasCustomBump?"1":"0")+((a=(o=tt.materialObject.userData)===null||o===void 0?void 0:o._customBumpMap)===null||a===void 0?void 0:a.uuid)},isCompatible:tt=>tt.isMeshStandardMaterial2,updaters:()=>[],getUiConfig:tt=>{const s=this._viewer,o=this.enableCustomBump,a={type:"folder",label:"CustomBumpMap",children:[{type:"checkbox",label:"Enabled",get value(){return tt.materialObject.userData._hasCustomBump||!1},set value(_e){var rt;_e!==tt.materialObject.userData._hasCustomBump&&(_e?o(tt)||s.alert("One or more geometries cannot be made anisotropic."):(tt.materialObject.userData._hasCustomBump=!1,tt.materialObject.needsUpdate=!0),(rt=a.uiRefresh)===null||rt===void 0||rt.call(a,"postFrame",!0))},onChange:this.setDirty},{type:"slider",label:"Bump Scale",hidden:()=>!tt.materialObject.userData._hasCustomBump,property:[tt.materialObject.userData,"_customBumpScale"],onChange:this.setDirty},{type:"image",label:"Bump Map",hidden:()=>!tt.materialObject.userData._hasCustomBump,property:[tt.materialObject.userData,"_customBumpMap"],onChange:()=>{tt.materialObject.needsUpdate=!0,this.setDirty()}},Bo(tt.materialObject.userData,"_customBumpMap")]};return a}},this.setDirty=()=>{var tt,s,o;(s=(tt=this.materialExtension).setDirty)===null||s===void 0||s.call(tt),(o=this._viewer)===null||o===void 0||o.setDirty()},this.enableCustomBumpSelected=()=>{var tt,s,o;const a=(o=(s=(tt=this._viewer)===null||tt===void 0?void 0:tt.getPlugin(Wo))===null||s===void 0?void 0:s.getSelectedObject())===null||o===void 0?void 0:o.material;return(a==null?void 0:a.assetType)==="material"&&this.enableCustomBump(a)},this._loaderCreate=this._loaderCreate.bind(this)}enableCustomBump(tt,s,o){var a,_e;const rt=(a=tt.materialObject)===null||a===void 0?void 0:a.userData;if(!rt)return!1;if(rt._hasCustomBump===void 0){const nt=rt.__appliedMeshes;let ot=!0;if(nt)for(const{geometry:ct}of nt)!ct||ct.attributes.position&&ct.attributes.normal&&ct.attributes.uv||(ot=!1);if(!ot)return!1}return rt._hasCustomBump=!0,rt._customBumpScale=(_e=o??rt._customBumpScale)!==null&&_e!==void 0?_e:.001,rt._customBumpMap=s??rt._customBumpMap,tt.materialObject.needsUpdate=!0,!0}_loaderCreate({loader:tt}){tt.isGLTFLoader2&&tt.register(s=>new T1(s))}async onAdded(tt){var s,o,a,_e,rt;await super.onAdded(tt);const nt=tt.getPlugin(os);(s=nt==null?void 0:nt.materials)===null||s===void 0||s.registerMaterialExtension(this.materialExtension),(o=nt==null?void 0:nt.importer)===null||o===void 0||o.addEventListener("loaderCreate",this._loaderCreate),(rt=(_e=(a=nt==null?void 0:nt.exporter)===null||a===void 0?void 0:a.getExporter("gltf","glb"))===null||_e===void 0?void 0:_e.extensions)===null||rt===void 0||rt.push(QM)}async onRemove(tt){var s,o,a,_e;return(o=(s=tt.getPlugin(os))===null||s===void 0?void 0:s.materials)===null||o===void 0||o.unregisterMaterialExtension(this.materialExtension),(_e=(a=tt.getPlugin(os))===null||a===void 0?void 0:a.importer)===null||_e===void 0||_e.removeEventListener("loaderCreate",this._loaderCreate),super.onRemove(tt)}};lp.PluginType="CustomBumpMapPlugin",lp.CUSTOM_BUMP_MAP_GLTF_EXTENSION="WEBGI_materials_custom_bump_map",sy([ds("Enabled",tt=>({onChange:tt.setDirty})),Yr()],lp.prototype,"enabled",void 0),sy([ds("Bicubic",tt=>({onChange:tt.setDirty})),jr("CUSTOM_BUMP_MAP_BICUBIC",void 0,!0,nA.prototype.setDirty),Yr()],lp.prototype,"bicubicFiltering",void 0),sy([Qo("Enable CustomBumpMap",tt=>({hidden:()=>{var s;return!(!((s=tt._viewer)===null||s===void 0)&&s.getPlugin(Wo))}}))],lp.prototype,"enableCustomBumpSelected",void 0),lp=nA=sy([Ao("CustomBumpMap Materials")],lp);class T1{constructor(s){this.parser=s,this.name=lp.CUSTOM_BUMP_MAP_GLTF_EXTENSION}async extendMaterialParams(s,o){var a;const _e=this.parser,rt=_e.json.materials[s];if(!rt.extensions||!rt.extensions[this.name])return Promise.resolve();const nt=[],ot=rt.extensions[this.name];o.userData||(o.userData={}),o.userData._hasCustomBump=!0,o.userData._customBumpScale=(a=ot.customBumpScale)!==null&&a!==void 0?a:0;const ct=ot.customBumpMap;return ct&&nt.push(_e.assignTexture(o.userData,"_customBumpMap",ct).then(pt=>{pt.encoding=et.knz})),Promise.all(nt)}}const QM=tt=>({writeMaterial:(s,o)=>{if(!s.isMeshStandardMaterial||!s.userData._hasCustomBump||(s.userData._customBumpScale||0)<.001)return;o.extensions=o.extensions||{};const a={};if(a.customBumpScale=s.userData._customBumpScale||1,s.userData._customBumpMap){const _e={index:tt.processTexture(s.userData._customBumpMap)};tt.applyTextureTransform(_e,s.userData._customBumpMap),a.customBumpMap=_e}o.extensions[lp.CUSTOM_BUMP_MAP_GLTF_EXTENSION]=a,tt.extensionsUsed[lp.CUSTOM_BUMP_MAP_GLTF_EXTENSION]=!0}});var IC=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let rv=class extends io{constructor(){super(),this.enabled=!0,this.dependencies=[os],this._defines={},this._uniforms={ccTintColor:{value:new ys},ccThickness:{value:0},ccIor:{value:0}},this.materialExtension={parsFragmentSnippet:(tt,s)=>{var o;return this.enabled&&(!((o=s==null?void 0:s.materialObject.userData._clearcoatTint)===null||o===void 0)&&o.enableTint)&&s.materialObject.clearcoat>0?`
uniform vec3 ccTintColor;
uniform float ccThickness;
uniform float ccIor;
vec3 clearcoatTint(const in float dotNV, const in float dotNL, const in float clearcoat) {
    vec3 tint = ( ccThickness > 0. ? 1. - ccTintColor : ccTintColor); // Set thickness < 0 for glow.
    tint = exp(tint * -(ccThickness * ((dotNL + dotNV) / max(dotNL * dotNV, 1e-3)))); // beer's law
    return mix(vec3(1.0), tint, clearcoat);
}
        `:""},shaderExtender:(tt,s,o)=>{var a;if(!(this.enabled&&(!((a=s==null?void 0:s.materialObject.userData._clearcoatTint)===null||a===void 0)&&a.enableTint)&&s.materialObject.clearcoat>0))return;const _e="outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;",rt="float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );";tt.fragmentShader.includes(rt)&&tt.fragmentShader.includes(_e)||console.error("ClearcoatTintPlugin: shaderExtender cannot patch shader, version changed?"),tt.fragmentShader=tt.fragmentShader.replace(rt,`
            float dotNVcc = saturate( dot( geometry.clearcoatNormal, -refract(geometry.viewDir, geometry.clearcoatNormal, 1./ccIor) ) );
            `),tt.fragmentShader=tt.fragmentShader.replace(_e,`
            outgoingLight *= clearcoatTint(dotNVcc, dotNVcc, material.clearcoat);
            `+_e),tt.vertexUvs=!0},onObjectRender:(tt,s)=>{var o;const a=(o=s.materialObject.userData)===null||o===void 0?void 0:o._clearcoatTint;if(!(a!=null&&a.enableTint))return;this._uniforms.ccTintColor.value.set(a.tintColor),this._uniforms.ccThickness.value=a.thickness,this._uniforms.ccIor.value=a.ior;const _e=this.enabled?1:0;s.materialObject.defines.CLEARCOAT_TINT_ENABLED!==_e&&(s.materialObject.defines.CLEARCOAT_TINT_ENABLED=_e,s.materialObject.needsUpdate=!0)},extraUniforms:{...this._uniforms},computeCacheKey:tt=>{var s,o;return(this.enabled?"1":"0")+(!((o=(s=tt.materialObject.userData)===null||s===void 0?void 0:s._clearcoatTint)===null||o===void 0)&&o.enableTint?"1":"0")+(tt.materialObject.clearcoat>0?"1":"0")},isCompatible:tt=>tt.isMeshStandardMaterial2,updaters:()=>[],getUiConfig:tt=>{const s=this._viewer,o={type:"folder",label:"ClearcoatTint",children:[{type:"checkbox",label:"Enabled",get value(){var a;return((a=tt.materialObject.userData._clearcoatTint)===null||a===void 0?void 0:a.enableTint)||!1},set value(a){var _e,rt;a!==((_e=tt.materialObject.userData._clearcoatTint)===null||_e===void 0?void 0:_e.enableTint)&&(a?SE(tt.materialObject)||s.alert("Cannot add clearcoat tint."):(tt.materialObject.userData._clearcoatTint.enableTint=!1,tt.materialObject.needsUpdate=!0),(rt=o.uiRefresh)===null||rt===void 0||rt.call(o,"postFrame",!0))},onChange:this.setDirty},()=>({type:"color",label:"Tint color",hidden:()=>{var a;return!(!((a=tt.materialObject.userData._clearcoatTint)===null||a===void 0)&&a.enableTint)},property:[tt.materialObject.userData._clearcoatTint,"tintColor"],onChange:this.setDirty}),()=>({type:"input",label:"Thickness",hidden:()=>{var a;return!(!((a=tt.materialObject.userData._clearcoatTint)===null||a===void 0)&&a.enableTint)},property:[tt.materialObject.userData._clearcoatTint,"thickness"],onChange:this.setDirty}),()=>({type:"slider",bounds:[.8,2.5],label:"IOR",hidden:()=>{var a;return!(!((a=tt.materialObject.userData._clearcoatTint)===null||a===void 0)&&a.enableTint)},property:[tt.materialObject.userData._clearcoatTint,"ior"],onChange:this.setDirty})]};return o}},this.setDirty=()=>{var tt;(tt=this._viewer)===null||tt===void 0||tt.setDirty()},this._loaderCreate=this._loaderCreate.bind(this)}addClearcoatTint(tt){return SE(tt.materialObject)}_loaderCreate({loader:tt}){tt.isGLTFLoader2&&tt.register(s=>new HM(s))}async onAdded(tt){var s,o,a,_e,rt;await super.onAdded(tt);const nt=tt.getPlugin(os);(s=nt==null?void 0:nt.materials)===null||s===void 0||s.registerMaterialExtension(this.materialExtension),(o=nt==null?void 0:nt.importer)===null||o===void 0||o.addEventListener("loaderCreate",this._loaderCreate),(rt=(_e=(a=nt==null?void 0:nt.exporter)===null||a===void 0?void 0:a.getExporter("gltf","glb"))===null||_e===void 0?void 0:_e.extensions)===null||rt===void 0||rt.push(PC)}async onRemove(tt){var s,o,a,_e;return(o=(s=tt.getPlugin(os))===null||s===void 0?void 0:s.materials)===null||o===void 0||o.unregisterMaterialExtension(this.materialExtension),(_e=(a=tt.getPlugin(os))===null||a===void 0?void 0:a.importer)===null||_e===void 0||_e.removeEventListener("loaderCreate",this._loaderCreate),super.onRemove(tt)}};function SE(tt){const s=tt==null?void 0:tt.userData;if(!s)return!1;s._clearcoatTint||(s._clearcoatTint={});const o=s._clearcoatTint;return o.enableTint=!0,o.tintColor===void 0&&(o.tintColor=16777215),o.thickness===void 0&&(o.thickness=.1),o.ior===void 0&&(o.ior=1.5),tt.isMaterial&&(tt.needsUpdate=!0),!0}rv.PluginType="ClearcoatTintPlugin",rv.CLEARCOAT_TINT_GLTF_EXTENSION="WEBGI_materials_clearcoat_tint",IC([ds("Enabled",tt=>({onChange:tt.setDirty})),Yr()],rv.prototype,"enabled",void 0),rv=IC([Ao("ClearcoatTint Materials")],rv);class HM{constructor(s){this.parser=s,this.name=rv.CLEARCOAT_TINT_GLTF_EXTENSION}async extendMaterialParams(s,o){const a=this.parser.json.materials[s];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const _e=a.extensions[this.name];return o.userData||(o.userData={}),SE(o),o.userData._clearcoatTint=In(_e,o.userData._clearcoatTint,!1,{}),Promise.resolve()}}const PC=tt=>({writeMaterial:(s,o)=>{if(!s.isMeshStandardMaterial||!s.userData._clearcoatTint||!s.userData._clearcoatTint.enableTint)return;o.extensions=o.extensions||{};const a=rs(s.userData._clearcoatTint,!1);o.extensions[rv.CLEARCOAT_TINT_GLTF_EXTENSION]=a,tt.extensionsUsed[rv.CLEARCOAT_TINT_GLTF_EXTENSION]=!0}});var DC=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let M1=class extends na{constructor(tt,s,o){super(tt,s,o??new qM,new ys(0,0,0),1),this.enabled=!0,this._firstCall=!0}render(tt,s,o,a,_e){if(!this.enabled)return;const rt=this.overrideMaterial;rt.uniforms.currentProjectionViewMatrix.value.copy(this.camera.projectionMatrix).multiply(this.camera.matrixWorldInverse),this._firstCall&&(rt.uniforms.lastProjectionViewMatrix.value.copy(rt.uniforms.currentProjectionViewMatrix.value),this._firstCall=!1),super.render(tt,s,o,a,_e),rt.uniforms.lastProjectionViewMatrix.value.copy(rt.uniforms.currentProjectionViewMatrix.value)}};DC([ds("Enabled")],M1.prototype,"enabled",void 0),M1=DC([Ao("Velocity Buffer (TAA)")],M1);class qM extends et.jyz{constructor(){super({vertexShader:`#ifdef USE_ALPHAMAP
#define USE_UV 
#endif
#include <uv_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec3 vWorldPosition;varying vec3 vWorldPositionPrevious;uniform mat4 modelMatrixPrevious;void main(){
#include <uv_vertex>
#include <skinbase_vertex>
#include <begin_vertex>
#include <morphtarget_vertex>
#include <skinning_vertex>
#include <displacementmap_vertex>
vec4 mvPosition=vec4(transformed,1.);
#ifdef USE_INSTANCING
mvPosition=instanceMatrix*mvPosition;
#endif
vWorldPosition=(modelMatrix*mvPosition).xyz;vWorldPositionPrevious=(modelMatrixPrevious*mvPosition).xyz;mvPosition=modelViewMatrix*mvPosition;gl_Position=projectionMatrix*mvPosition;
#include <logdepthbuf_vertex>
#include <clipping_planes_vertex>
}`,fragmentShader:"varying vec3 vWorldPosition;varying vec3 vWorldPositionPrevious;uniform mat4 currentProjectionViewMatrix;uniform mat4 lastProjectionViewMatrix;vec2 computeScreenSpaceVelocity2(){vec4 currentPositionClip=currentProjectionViewMatrix*vec4(vWorldPosition,1.);vec4 prevPositionClip=lastProjectionViewMatrix*vec4(vWorldPositionPrevious,1.);vec2 currentPositionNDC=currentPositionClip.xy/currentPositionClip.w;vec2 prevPositionNDC=prevPositionClip.xy/prevPositionClip.w;if(prevPositionNDC.x>=1.||prevPositionNDC.x<=-1.||prevPositionNDC.x>=1.||prevPositionNDC.y<=-1.){return vec2(0.);}return 0.5*(currentPositionNDC-prevPositionNDC);}void main(){vec2 velocity=clamp(computeScreenSpaceVelocity2(),-1.,1.);velocity=sign(velocity)*pow(abs(velocity),vec2(1./4.));velocity=velocity*0.5+0.5;gl_FragColor=vec4(velocity.x,velocity.y,1.,1.);}",uniforms:{cameraNearFar:{value:new et.FM8(.1,1e3)},alphaMap:{value:null},alphaTest:{value:null},currentProjectionViewMatrix:{value:new et.yGw},lastProjectionViewMatrix:{value:new et.yGw}}}),this.extraUniformsToUpload={modelMatrixPrevious:{value:new et.yGw().identity()}},this._previousWorldMatrices={}}onBeforeRender(s,o,a,_e,rt){var nt,ot;const ct=this._previousWorldMatrices[rt.uuid];this.extraUniformsToUpload.modelMatrixPrevious.value.copy(ct??rt.matrixWorld),ct?ct.copy(rt.matrixWorld):this._previousWorldMatrices[rt.uuid]=rt.matrixWorld.clone();let pt=rt.material;Array.isArray(pt)&&(pt=pt[0]),this.uniforms.alphaMap.value=(nt=pt==null?void 0:pt.alphaMap)!==null&&nt!==void 0?nt:null,this.uniforms.alphaTest.value=!pt||!pt.alphaTest||pt.alphaTest<1e-7?.001:pt.alphaTest;let ht=this.uniforms.alphaMap.value?1:void 0;ht!==this.defines.USE_ALPHAMAP&&(ht===void 0?delete this.defines.USE_ALPHAMAP:this.defines.USE_ALPHAMAP=ht,this.needsUpdate=!0),ht=pt.userData.ALPHA_I_RGBA_PACKING?1:void 0,ht!==this.defines.ALPHA_I_RGBA_PACKING&&(ht===void 0?delete this.defines.ALPHA_I_RGBA_PACKING:this.defines.ALPHA_I_RGBA_PACKING=ht,this.needsUpdate=!0),this.side=(ot=pt.side)!==null&&ot!==void 0?ot:et.ehD}}class R1 extends Mv{constructor(s=!0){super(),this.passId="velocityBuffer",this._beforeFilters=["render"],this._afterFilters=[],this._requiredFilters=["render"],this._velocityBuffers=[],this.enabled=s}passCtor(s){const o=s.renderer.createTarget({depthBuffer:!0,type:et.ywz});o.texture.name="velocityBuffer",this._velocityBuffers.push(o),s.getPluginByType("debug");const a=new Set,_e=new Set;return new class extends M1{render(rt,nt,ot,ct,pt){if(s.renderer.frameCount>0)return;const ht=rt.getRenderTarget(),_t=rt.getActiveCubeFace(),Et=rt.getActiveMipmapLevel();this.scene.traverse(({material:St})=>{St&&((St.transparent&&St.userData.renderToDepth||!St.transparent&&St.transmission===0&&St.userData.renderToDepth===!1)&&(a.add(St),St.transparent=!St.transparent),Math.abs(St.transmission||0)>0&&St.userData.renderToDepth&&(_e.add([St,St.transmission]),St.transmission=0))}),jn(rt,{shadowMapRender:!1,backgroundRender:!1,opaqueRender:!0,transparentRender:!1,transmissionRender:!1,mainRenderPass:!1},()=>super.render(rt,nt,o,ct,pt)),a.forEach(St=>St.transparent=!St.transparent),a.clear(),_e.forEach(([St,Mt])=>St.transmission=Mt),_e.clear(),rt.setRenderTarget(ht,_t,Et)}}}_update(s){if(!super._update(s)||s.renderer.frameCount>0)return!1;const o=this.pass.passObject;return o.scene=s.scene.modelObject,s.scene.activeCamera.updateShaderProperties(o.overrideMaterial),o.camera=s.scene.activeCamera.cameraObject,!0}getVelocityBuffer(){return this._velocityBuffers.length>0?this._velocityBuffers[0]:void 0}async onDispose(s){}async onRemove(s){return this._velocityBuffers.forEach(o=>{var a;return s.renderer.disposeTarget((a=o==null?void 0:o.dispose)===null||a===void 0?void 0:a.call(o))}),super.onRemove(s)}updateShaderProperties(s){var o,a;return s.uniforms.tVelocity?s.uniforms.tVelocity.value=this.enabled&&(a=(o=this.getVelocityBuffer())===null||o===void 0?void 0:o.texture)!==null&&a!==void 0?a:null:console.warn("BaseRenderer: no uniform: tVelocity"),this}get uiConfig(){var s;return(s=this.pass)===null||s===void 0?void 0:s.passObject.uiConfig}}R1.PluginType="VelocityBuffer";class BC extends Ru{constructor(s,o){super({vertexShader:ut.vertexShader,fragmentShader:o+`
`+e1+`
#include <common>
varying vec2 vUv;uniform vec2 previousRTSize;uniform mat4 lastProjectionViewMatrix;uniform mat4 currentProjectionViewMatrix;uniform mat4 inverseViewMatrix;uniform vec2 jitterSample;uniform vec2 feedBack;uniform bool firstFrame;
#if HAS_VELOCITY_BUFFER == 1
uniform sampler2D tVelocity;
#endif
vec3 find_closest_fragment_3x3(const in vec2 uv){const vec3 offset=vec3(-1.,1.,0.);vec2 texelSize=1./previousRTSize;vec3 dtr=vec3(-1,1,getDepth(uv+offset.yx*texelSize));vec3 dtc=vec3(0,1,getDepth(uv+offset.zx*texelSize));vec3 dtl=vec3(1,1,getDepth(uv+offset.xx*texelSize));vec3 dml=vec3(-1,0,getDepth(uv+offset.yz*texelSize));vec3 dmc=vec3(0,0,getDepth(uv));vec3 dmr=vec3(1,0,getDepth(uv+offset.xz*texelSize));vec3 dbl=vec3(-1,-1,getDepth(uv+offset.yy*texelSize));vec3 dbc=vec3(0,-1,getDepth(uv+offset.zy*texelSize));vec3 dbr=vec3(1,-1,getDepth(uv+offset.xy*texelSize));vec3 dmin=dtl;if(dmin.z>dtc.z)dmin=dtc;if(dmin.z>dtr.z)dmin=dtr;if(dmin.z>dml.z)dmin=dml;if(dmin.z>dmc.z)dmin=dmc;if(dmin.z>dmr.z)dmin=dmr;if(dmin.z>dbl.z)dmin=dbl;if(dmin.z>dbc.z)dmin=dbc;if(dmin.z>dbr.z)dmin=dbr;return vec3(uv+texelSize.xy*dmin.xy,dmin.z);}vec3 find_closest_fragment_5tap(const in vec2 uv){vec2 texelSize=1./previousRTSize;vec2 offset=vec2(1.,-1.);vec3 dtl=vec3(-1,1,getDepth(uv+offset.yx*texelSize));vec3 dtr=vec3(1,1,getDepth(uv+offset.xx*texelSize));vec3 dmc=vec3(0,0,getDepth(uv));vec3 dbl=vec3(-1,-1,getDepth(uv+offset.yy*texelSize));vec3 dbr=vec3(1,-1,getDepth(uv+offset.xy*texelSize));vec3 dmin=dtl;if(dmin.z>dtr.z)dmin=dtr;if(dmin.z>dmc.z)dmin=dmc;if(dmin.z>dbl.z)dmin=dbl;if(dmin.z>dbr.z)dmin=dbr;return vec3(uv+dmin.xy*texelSize,dmin.z);}vec4 clip_aabb(const in vec4 aabb_min,const in vec4 aabb_max,vec4 p){const float FLT_EPS=1e-8;vec4 p_clip=0.5*(aabb_max+aabb_min);vec4 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=p-p_clip;vec4 v_unit=abs(v_clip/e_clip);float ma_unit=max(v_unit.x,max(v_unit.y,v_unit.z));if(ma_unit>1.)return p_clip+v_clip/ma_unit;else return p;}
#if HAS_VELOCITY_BUFFER == 0
vec2 computeScreenSpaceVelocity(const in vec3 worldPosition){vec4 currentPositionClip=currentProjectionViewMatrix*vec4(worldPosition,1.);vec4 prevPositionClip=lastProjectionViewMatrix*vec4(worldPosition,1.);vec2 currentPositionNDC=currentPositionClip.xy/currentPositionClip.w;vec2 prevPositionNDC=prevPositionClip.xy/prevPositionClip.w;if(prevPositionNDC.x>=1.||prevPositionNDC.x<=-1.||prevPositionNDC.x>=1.||prevPositionNDC.y<=-1.){return vec2(0.);}return 0.5*(currentPositionNDC-prevPositionNDC);}
#endif
vec4 computeTAA(const in vec2 uv,const in vec2 screenSpaceVelocity){vec2 jitterOffset=jitterSample/previousRTSize;vec2 uvUnJitter=uv;vec4 currentColor=currentRTTexelToLinear(texture2D(currentRT,uvUnJitter));vec4 previousColor=previousRTTexelToLinear(texture2D(previousRT,uv-screenSpaceVelocity));const vec3 offset=vec3(1.,-1.,0.);vec2 texelSize=1./previousRTSize;float texelSpeed=length(screenSpaceVelocity);vec4 tl=currentRTTexelToLinear(texture2D(currentRT,uvUnJitter+offset.yx*texelSize));vec4 tc=currentRTTexelToLinear(texture2D(currentRT,uvUnJitter+offset.zx*texelSize));vec4 tr=currentRTTexelToLinear(texture2D(currentRT,uvUnJitter+offset.xx*texelSize));vec4 ml=currentRTTexelToLinear(texture2D(currentRT,uvUnJitter+offset.yz*texelSize));vec4 mc=currentColor;vec4 mr=currentRTTexelToLinear(texture2D(currentRT,uvUnJitter+offset.xz*texelSize));vec4 bl=currentRTTexelToLinear(texture2D(currentRT,uvUnJitter+offset.yy*texelSize));vec4 bc=currentRTTexelToLinear(texture2D(currentRT,uvUnJitter+offset.zy*texelSize));vec4 br=currentRTTexelToLinear(texture2D(currentRT,uvUnJitter+offset.xy*texelSize));vec4 corners=2.*(tr+bl+br+tl)-2.*mc;mc+=(mc-(corners*0.166667))*2.718282*0.3;mc=max(vec4(0.),mc);vec4 min5=min(tc,min(ml,min(mc,min(mr,bc))));vec4 max5=max(tc,max(ml,max(mc,max(mr,bc))));vec4 cmin=min(min5,min(tl,min(tr,min(bl,br))));vec4 cmax=max(min5,max(tl,max(tr,max(bl,br))));;cmin=0.5*(cmin+min5);cmax=0.5*(cmax+max5);previousColor=clip_aabb(cmin,cmax,previousColor);float lum0=luminance(currentColor.rgb);float lum1=luminance(previousColor.rgb);float unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedBack.x,feedBack.y,unbiased_weight_sqr);return mix(currentColor,previousColor,k_feedback);}vec3 getWorldPositionFromViewZ(const in vec2 uv,const in float viewDepth){vec2 uv_=2.*uv-1.;float xe=-(uv_.x+projection[2][0])*viewDepth/projection[0][0];float ye=-(uv_.y+projection[2][1])*viewDepth/projection[1][1];return(inverseViewMatrix*vec4(xe,ye,viewDepth,1.)).xyz;}void main(){vec2 jitterOffset=jitterSample/previousRTSize;
#if QUALITY == 1
vec3 c_frag=find_closest_fragment_3x3(vUv);
#else
vec3 c_frag=find_closest_fragment_5tap(vUv);
#endif
if(c_frag.z>=0.999){gl_FragColor=currentRTTexelToLinear(texture2D(currentRT,vUv-jitterOffset));}else{float sampleViewZ=mix(-cameraNearFar.x,-cameraNearFar.y,c_frag.z);vec3 worldPosition=getWorldPositionFromViewZ(c_frag.xy,sampleViewZ);
#if HAS_VELOCITY_BUFFER == 0
vec2 screenSpaceVelocity=computeScreenSpaceVelocity(worldPosition);
#else
vec2 screenSpaceVelocity=(texture2D(tVelocity,vUv).xy*2.-1.);screenSpaceVelocity=sign(screenSpaceVelocity)*pow(abs(screenSpaceVelocity),vec2(4.));
#endif
gl_FragColor=firstFrame?currentRTTexelToLinear(texture2D(currentRT,vUv)):computeTAA(vUv,screenSpaceVelocity);}
#include <encodings_fragment>
}`,uniforms:{currentRT:{value:null},previousRT:{value:null},previousRTSize:{value:new et.FM8},cameraNearFar:{value:new et.FM8},lastProjectionViewMatrix:{value:new et.yGw},currentProjectionViewMatrix:{value:new et.yGw},projection:{value:new et.yGw},inverseViewMatrix:{value:new et.yGw},jitterSample:{value:new et.FM8},firstFrame:{value:!0},tNormalDepth:{value:null},tVelocity:{value:null}},defines:{HAS_VELOCITY_BUFFER:0,QUALITY:1,UNJITTER:0}},"currentRT","previousRT"),this.taaEnabled=!0,this.feedBack=new et.FM8(.88,.97),this.uiConfig={type:"folder",label:"Temporal AA",children:[{type:"checkbox",label:"Enabled",property:[this,"enabled"],onChange:()=>this.onSizeUpdate()},{type:"input",label:"Feedback",property:[this,"feedBack"],onChange:this.setDirty}]},this.onSizeUpdate=this.onSizeUpdate.bind(this),this.target=s,this.clear=!1,this.needsSwap=!0}render(s,o,a,_e,rt){if(!this.taaEnabled||!this.enabled)return void(this.needsSwap=!1);this.needsSwap=!0;const nt=this.uniforms.tVelocity.value?1:0;nt!==this.material.defines.HAS_VELOCITY_BUFFER&&(this.material.defines.HAS_VELOCITY_BUFFER=nt,this.material.needsUpdate=!0),this.uniforms.previousRT.value=this.target.texture,super.render(s,o,a,_e,rt),this.uniforms.lastProjectionViewMatrix.value.copy(this.uniforms.currentProjectionViewMatrix.value),this.uniforms.firstFrame.value=!1}updateCameraProperties(s){s&&(this.uniforms.currentProjectionViewMatrix.value.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),this.uniforms.inverseViewMatrix.value.copy(s.matrixWorld))}onSizeUpdate(){this.uniforms.firstFrame.value=!0,this.setDirty()}setSize(s,o){super.setSize(s,o),this.onSizeUpdate()}}(function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);rt>3&&nt&&Object.defineProperty(s,o,nt)})([Yr(),Ar()],BC.prototype,"feedBack",void 0);class I1 extends Mv{constructor(){super(...arguments),this.passId="taa",this._beforeFilters=["progressive"],this._afterFilters=[],this._requiredFilters=["render","progressive"],this.dependencies=[Dl]}passCtor(s){if(!s.getPlugin(_p))throw"Add ProgressivePlugin before TAA";const o=new BC(s.getPlugin(_p).lastFrame,s.getPlugin(Dl).getUnpackSnippet());return s.renderer.addEventListener("resize",o.onSizeUpdate),o}setDirty(){var s;(s=this._viewer)===null||s===void 0||s.setDirty()}async onDispose(s){return this.pass&&s.renderer.removeEventListener("resize",this.pass.passObject.onSizeUpdate),super.onDispose(s)}_update(s){if(!super._update(s))return!1;const o=s.renderer.frameCount,a=this._pass.passObject;if(a.taaEnabled=o<1,!a.taaEnabled)return!1;const _e=s.scene.activeCamera;return a.updateShaderProperties([s.getPlugin(Dl),_e,s.getPluginByType("VelocityBuffer")]),a.target=s.getPlugin(_p).lastFrame,a.updateCameraProperties(_e==null?void 0:_e.cameraObject),!0}get uiConfig(){var s;return(s=this.pass)===null||s===void 0?void 0:s.passObject.uiConfig}}I1.PluginType="TAA";class kC{static async GetDataUrl(s,{mimeType:o="image/png",rect:a={x:0,y:0,width:s.width,height:s.height,assumeClientRect:!1},displayPixelRatio:_e=1,scale:rt=1}){var nt,ot,ct;const pt=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");pt.width=a.width*rt*_e,pt.height=a.height*rt*_e,a.assumeClientRect&&(a.x*=s.width/(_e*s.clientWidth),a.y*=s.height/(_e*s.clientHeight),a.width*=s.width/(_e*s.clientWidth),a.height*=s.height/(_e*s.clientHeight));const ht=pt.getContext("2d");if(!ht)return console.error("snapshot: cannot create context"),"";const _t=s.style.background||((nt=s.parentElement)===null||nt===void 0?void 0:nt.style.background)||"";if(_t.includes("url")){const St=(ot=/url\("(.*)"\)/gi.exec(_t))===null||ot===void 0?void 0:ot[1];if(St){const Mt=new Image;Mt.src=St,await new Promise((It,Nt)=>{Mt.onload=()=>It(),Mt.onerror=()=>Nt(),Mt.complete&&It()}),ht.drawImage(Mt,Mt.width*a.x*_e/s.width,Mt.height*a.y*_e/s.height,Mt.width*a.width*_e/s.width,Mt.height*a.height*_e/s.height,0,0,pt.width,pt.height)}}else ht.fillStyle=s.style.background||((ct=s.parentElement)===null||ct===void 0?void 0:ct.style.backgroundColor)||"#00000000",ht.fillRect(0,0,pt.width,pt.height);ht==null||ht.drawImage(s,a.x*_e,a.y*_e,a.width*_e,a.height*_e,0,0,pt.width,pt.height);const Et=ht.canvas.toDataURL(o);return pt.remove(),Et}static async GetImage(s,o={}){const a=await this.GetDataUrl(s,o);return new Promise((_e,rt)=>{const nt=new Image;nt.onload=()=>{_e(nt)},nt.src=a})}static async GetBlob(s,o={}){return await(await fetch(await this.GetDataUrl(s,o))).blob()}static async GetFile(s,o="image.png",a={}){var _e;return a.getDataUrl?await this.GetDataUrl(s,a):new File([await this.GetBlob(s,a)],o,{type:(_e=a.mimeType)!==null&&_e!==void 0?_e:"image/png",lastModified:bo()})}}var Om=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let bm=class extends io{constructor(){super(),this.enabled=!0,this.downloadSnapshot=this.downloadSnapshot.bind(this)}async getFile(tt,s={}){return s.getDataUrl=!1,await this._getFile(tt,s)}async getDataUrl(tt={}){var s;return tt.getDataUrl=!0,(s=await this._getFile("",tt))!==null&&s!==void 0?s:""}async _getFile(tt,s={}){var o,a,_e;const rt=(o=this._viewer)===null||o===void 0?void 0:o.canvas;if(rt){const nt=this._viewer.renderer.displayCanvasScaling;s.displayPixelRatio!==void 0&&s.displayPixelRatio!==nt&&(this._viewer.renderer.displayCanvasScaling=s.displayPixelRatio);const ot=(a=this._viewer)===null||a===void 0?void 0:a.getPlugin(_p);if(s.waitForProgressive&&ot&&s.timeout===void 0)for(;!ot.isConverged(!0);)await mu(64);else await mu((_e=s.timeout)!==null&&_e!==void 0?_e:200);s.displayPixelRatio=1;const ct=await kC.GetFile(rt,tt,s);return s.displayPixelRatio=this._viewer.renderer.displayCanvasScaling,this._viewer.renderer.displayCanvasScaling=nt,ct}}async downloadSnapshot(tt="snapshot.png",s={}){const o=await this.getFile(tt,s);o&&_f(o)}};bm.PluginType="CanvasSnipper",Om([Qo("Download .png",{limitedUi:!0})],bm.prototype,"downloadSnapshot",null),bm=Om([Ao("Image Export")],bm);var uu=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let WM=1,Hp=class{constructor(tt,s,o,a,_e){this.position=new et.Pa4,this.target=new et.Pa4,this.quaternion=new et._fP,this.up=new et.Pa4,this.name="Camera View",this.snap="",this.focusView=()=>{},this.deleteView=()=>{},this.uiConfig=R_(this.name,this),tt&&(this.position=tt),s&&(this.target=s),o&&(this.up=o),a&&(this.quaternion=a),_e&&(this.snap=_e),this.name="Camera View"+WM++}_nameChanged(){var tt,s;this.uiConfig&&(this.uiConfig.label=this.name,(s=(tt=this.uiConfig).uiRefresh)===null||s===void 0||s.call(tt))}};uu([Yr(),ou()],Hp.prototype,"position",void 0),uu([Yr(),ou()],Hp.prototype,"target",void 0),uu([Yr(),ou()],Hp.prototype,"quaternion",void 0),uu([Yr(),ou()],Hp.prototype,"up",void 0),uu([Yr(),yo()],Hp.prototype,"name",void 0),uu([By()],Hp.prototype,"snap",void 0),uu([Qo()],Hp.prototype,"focusView",void 0),uu([Qo()],Hp.prototype,"deleteView",void 0),Hp=uu([Fs("CameraView")],Hp);class gu extends io{constructor(){super(),this.enabled=!0,this._cameraViews=[],this.viewLooping=!1,this.viewPauseTime=200,this.animEase="easeInOutSine",this.animDuration=1e3,this.rotationOffset=.25,this.interpolateMode="spherical",this.animateOnScroll=!1,this.seekOnScroll=!1,this._animating=!1,this.dependencies=[],this._scrollAnimationState=0,this.scrollAnimationDamping=.1,this._updaters=[],this._lastFrameTime=0,this._fadeDisabled=!1,this._viewQueue=[],this._animationLooping=!1,this._infiniteLooping=!0,this._driver=s=>({start:()=>this._updaters.push({u:s,time:0}),stop:()=>this._updaters.splice(this._updaters.findIndex(o=>o.u===s),1)}),this.focusNext=(s=!0)=>{if(this._animating||this._cameraViews.length<2)return;let o=this._cameraViews.findIndex(a=>a===this._currentView);o<0&&(o=-1),o+=1,s?o%=this._cameraViews.length:o=Math.min(o,this._cameraViews.length-1),this.focusView(this._cameraViews[o])},this.focusPrevious=(s=!0)=>{if(this._animating||this._cameraViews.length<2||!this._currentView)return;let o=this._cameraViews.findIndex(a=>a===this._currentView);o<0&&(o=0),o-=1,o=s?(o+this._cameraViews.length)%this._cameraViews.length:Math.max(o,0),this.focusView(this._cameraViews[o])},this._popAnimations=[],this.uiConfig={type:"folder",label:"Camera Views",children:[()=>[...this._cameraViews.map(s=>s.uiConfig)],...Yv(this)]},this.addCurrentView=this.addCurrentView.bind(this),this.animateAllViews=this.animateAllViews.bind(this),this.recordAllViews=this.recordAllViews.bind(this),this.resetToFirstView=this.resetToFirstView.bind(this),this._wheel=this._wheel.bind(this),this._pointerMove=this._pointerMove.bind(this),this._postFrame=this._postFrame.bind(this)}get animationLooping(){return this._animationLooping}get animating(){return this._animating}get camViews(){return this._cameraViews}_wheel(s){this.enabled&&(this.seekOnScroll&&!this._animating||Math.abs(s.deltaY)>.001&&(this._scrollAnimationState=-1*Math.sign(s.deltaY)))}_pointerMove(s){var o;if(this.enabled&&!this._animating&&this.seekOnScroll){const a=(o=this._viewer)===null||o===void 0?void 0:o.scene.activeCamera;if(!a)return;const _e=new et.$V,rt=a.position,nt=a.target,ot=new et._fP().setFromUnitVectors(a.cameraObject.up,new et.Pa4(0,1,0)),ct=ot.clone().invert(),pt=rt.clone().sub(nt);pt.applyQuaternion(ot),_e.setFromVector3(pt),_e.theta+=this.rotationOffset*s.movementX/this._viewer.canvas.clientWidth,_e.phi+=this.rotationOffset*s.movementY/this._viewer.canvas.clientHeight,_e.makeSafe(),pt.setFromSpherical(_e),pt.applyQuaternion(ct),rt.copy(nt).add(pt),a.positionUpdated(!1),a.targetUpdated()}}async onAdded(s){await super.onAdded(s);let o=!1;s.addEventListener("preFrame",a=>{this.seekOnScroll||this._animating?this._viewer.scene.activeCamera.interactionsEnabled&&(this._viewer.scene.activeCamera.interactionsEnabled=!1,o=!0):o&&(this._viewer.scene.activeCamera.interactionsEnabled=!0,o=!1)}),s.addEventListener("postFrame",this._postFrame),window.addEventListener("wheel",this._wheel),window.addEventListener("pointermove",this._pointerMove)}_postFrame(){var s,o;if(!this._viewer)return;if(!this.enabled||!this._animating)return this._lastFrameTime=0,void(this._fadeDisabled&&((s=this._viewer.getPluginByType("FrameFade"))===null||s===void 0||s.enable(gu.PluginType),this._fadeDisabled=!1));const a=bo()/1e3;this._lastFrameTime<1&&(this._lastFrameTime=a-1/60);let _e=a-this._lastFrameTime;this._lastFrameTime=a,_e*=this.animateOnScroll?this._scrollAnimationState:1;const rt=(o=this._viewer.getPluginByType("Progressive"))===null||o===void 0?void 0:o.postFrameConvergedRecordingDelta();if(rt&&rt>0&&(_e=rt),rt!==0&&(_e*=1e3,!(_e<=0||(this._updaters.forEach(nt=>{let ot=_e;nt.time+ot<0&&(ot=-nt.time),nt.time+=ot,Math.abs(ot)>.001&&nt.u(ot)}),this._scrollAnimationState<.001?this._scrollAnimationState=0:this._scrollAnimationState*=1-this.scrollAnimationDamping,this._fadeDisabled)))){const nt=this._viewer.getPluginByType("FrameFade");nt&&(nt.disable(gu.PluginType),this._fadeDisabled=!0)}}async onRemove(s){return s.removeEventListener("postFrame",this._postFrame),window.removeEventListener("wheel",this._wheel),window.removeEventListener("pointermove",this._pointerMove),super.onRemove(s)}async _animationLoop(){if(!this._animationLooping){for(this._animationLooping=!0;(this.viewLooping||!this._infiniteLooping)&&this.enabled&&!(this._cameraViews.length<1);){if(this._viewQueue.length===0){if(!this._infiniteLooping)break;this._viewQueue.push(...this._cameraViews)}await this.animateToView(this._viewQueue.shift()),await mu(2+this.viewPauseTime)}this._animationLooping=!1}}async animateAllViews(){if(this.enabled&&!(this.viewLooping||this._cameraViews.length<2)){for(;this._viewQueue.length>0;)this._viewQueue.pop();this._viewQueue.push(...this._cameraViews),this._viewQueue.push(this._viewQueue.shift()),this._infiniteLooping=!1,await this._animationLoop(),this._infiniteLooping=!0}}async resetToFirstView(s=100){this.enabled&&(this._currentView=void 0,await this.animateToView(this._cameraViews[0],s),await mu(2))}async recordAllViews(s){var o;if(!this.enabled)return;const a=(o=this._viewer)===null||o===void 0?void 0:o.getPluginByType("CanvasRecorder");return a&&a.enabled&&(await this.resetToFirstView(),a.startRecording())?new Promise((_e,rt)=>{const nt=()=>{a.removeEventListener("start",ot),a.removeEventListener("stop",nt),a.removeEventListener("error",ct)},ot=async()=>{nt(),s==null||s(),await this.animateAllViews();const pt=await a.stopRecording();pt&&Nu(pt,"recording.mp4"),_e()},ct=async()=>{nt(),rt()};a.addEventListener("start",ot),a.addEventListener("stop",nt),a.addEventListener("error",ct)}):void 0}async addCurrentView(){var s,o,a,_e,rt;if(!this.enabled)return;const nt=(s=this._viewer)===null||s===void 0?void 0:s.scene.activeCamera;if(!nt)return;const ot=this.getCurrentCameraView(nt);ot.snap=await((a=(o=this._viewer)===null||o===void 0?void 0:o.getPlugin(bm))===null||a===void 0?void 0:a.getDataUrl({displayPixelRatio:.25,mimeType:"image/jpg"}))||"",this._cameraViews.push(ot),(rt=(_e=this.uiConfig).uiRefresh)===null||rt===void 0||rt.call(_e)}getCurrentCameraView(s){var o;if(s||(s=(o=this._viewer)===null||o===void 0?void 0:o.scene.activeCamera),!s)return new Hp;const a=new et.Pa4,_e=s.cameraObject.matrixWorld;a.x=_e.elements[4],a.y=_e.elements[5],a.z=_e.elements[6];const rt=new Hp(s.position.clone(),s.target.clone(),a.normalize(),s.cameraObject.quaternion.clone(),"");return rt.focusView=async()=>this.focusView(rt),rt.deleteView=()=>this.deleteView(rt),rt}async focusView(s){return this.animateToView(s)}deleteView(s){var o,a;const _e=this._cameraViews.indexOf(s);_e>=0&&this._cameraViews.splice(_e,1),(a=(o=this.uiConfig).uiRefresh)===null||a===void 0||a.call(o)}async stopAllAnimations(){for(this.viewLooping=!1,this._popAnimations.forEach(s=>{var o;return(o=s==null?void 0:s.stop)===null||o===void 0?void 0:o.call(s)}),this._popAnimations=[];this._animating||this._animationLooping;)await mu(100)}async animateToView(s,o,a){var _e;const rt=(_e=this._viewer)===null||_e===void 0?void 0:_e.scene.activeCamera;if(!rt)return;if(this._animating&&(this._popAnimations.forEach(ht=>{var _t;return(_t=ht==null?void 0:ht.stop)===null||_t===void 0?void 0:_t.call(ht)}),await mu(100),this._animating))return void console.warn("todo: still animating?");this._currentView=s,this._animating=!0,this.dispatchEvent({type:"startViewChange",view:s}),o===void 0&&(o=this.animDuration);const nt=typeof a=="function"?a:Zy[a||this.animEase],ot=this._driver,ct=[];this._popAnimations=[];const pt=this._popAnimations;if(this.interpolateMode==="spherical")ct.push(async function(ht,_t,Et,St,Mt,It){const Nt=ht.target.clone(),Bt=new et.Pa4,kt=new et.Pa4,Pt=iA(ht.cameraObject,Nt),qt=iA(_t,_t.target),Kt=new et.$V;return P1({from:0,to:1,duration:Et,ease:St,driver:Mt,onUpdate:nr=>{Kt.phi=CE(Pt.phi,qt.phi,nr),Kt.theta=CE(Pt.theta,qt.theta,nr),Kt.radius=_o(Pt.radius,qt.radius,nr),Bt.copy(Nt).lerp(_t.target,nr),kt.setFromSpherical(Kt),kt.add(Bt),ht.position=kt,ht.target=Bt,ht.positionUpdated(!1),ht.targetUpdated()},onComplete:()=>{ht.position=_t.position,ht.target=_t.target,ht.positionUpdated(!1),ht.targetUpdated()}},It)}(rt,s,o,nt,ot,pt));else if(this.interpolateMode==="linear"){ct.push(P1({from:rt.position.clone(),to:s.position.clone(),duration:o,ease:nt,driver:ot,onUpdate:Et=>rt.position=Et,onComplete:()=>rt.position=s.position},pt)),ct.push(P1({from:rt.target.clone(),to:s.target.clone(),duration:o,ease:nt,driver:ot,onUpdate:Et=>{rt.target=Et,rt.targetUpdated()},onComplete:()=>{rt.target=s.target,rt.targetUpdated()}},pt));const ht=rt.cameraObject.quaternion.clone(),_t=new et._fP;ct.push(P1({from:0,to:1,duration:o,ease:nt,driver:ot,onUpdate:Et=>{_t.copy(ht).slerp(s.quaternion,Et),rt.cameraObject.quaternion.copy(_t),rt.cameraObject.updateProjectionMatrix()},onComplete:()=>{rt.cameraObject.quaternion.copy(s.quaternion),rt.cameraObject.updateProjectionMatrix()}},pt))}await Promise.all(ct),this._animating=!1,this.dispatchEvent({type:"viewChange",view:s}),await mu(10)}fromJSON(s,o){var a,_e;return this._cameraViews.forEach(rt=>this.deleteView(rt)),super.fromJSON(s,o)?(this._cameraViews.forEach(rt=>rt.focusView=async()=>this.focusView(rt)),this._cameraViews.forEach(rt=>rt.deleteView=()=>this.deleteView(rt)),(_e=(a=this.uiConfig).uiRefresh)===null||_e===void 0||_e.call(a),this):null}async animateToObject(s,o=4,a,_e,rt={min:.5,max:5}){if(!this._viewer)return;const nt=new cn().expandByObject(s||this._viewer.scene.modelRoot.modelObject,!1,!0),ot=nt.getCenter(new et.Pa4),ct=nt.getSize(new et.Pa4).length()/2;await this.animateToTarget(Math.min(rt.max,Math.max(rt.min,ct*o)),ot,a,_e)}async animateToTarget(s,o,a,_e){const rt=this.getCurrentCameraView();rt.target.copy(o);const nt=new et.Pa4().subVectors(rt.target,rt.position).normalize();rt.position.copy(nt.multiplyScalar(-s).add(rt.target)),await this.animateToView(rt,a,_e)}}async function P1(tt,s){const o=tt.onComplete,a=tt.onStop;return tt={...tt},new Promise((_e,rt)=>{tt.onComplete=()=>{o==null||o(),_e()},tt.onStop=()=>{a==null||a(),_e()};const nt=iw(tt);s.push(nt)})}function iA(tt,s){const o=tt.position.clone();o.sub(s);const a=new et.$V().setFromVector3(o);return a.makeSafe(),a}function CE(tt,s,o){const a=s-tt;return a>=Math.PI?tt+(a-2*Math.PI)*o:a<=-Math.PI?tt+(a+2*Math.PI)*o:tt+a*o}function OC(tt,s,o){const a=(1-o)*Math.cos(tt)+o*Math.cos(s),_e=(1-o)*Math.sin(tt)+o*Math.sin(s);return Math.atan2(_e,a)}gu.PluginType="CameraViews",uu([Yr("cameraViews")],gu.prototype,"_cameraViews",void 0),uu([vr(gu.prototype._animationLoop),Yr(),ds("Loop All Views",{limitedUi:!0})],gu.prototype,"viewLooping",void 0),uu([Yr(),yo("View Pause Time")],gu.prototype,"viewPauseTime",void 0),uu([Yr(),Mp("Ease",Object.keys(Zy).map(tt=>({label:tt})))],gu.prototype,"animEase",void 0),uu([Yr(),gs("Duration",[10,1e4],10,{limitedUi:!0})],gu.prototype,"animDuration",void 0),uu([Yr(),gs("RotationOffset",[.2,.75],.01)],gu.prototype,"rotationOffset",void 0),uu([Yr(),Mp("Interpolation",["spherical","linear"].map(tt=>({label:tt})))],gu.prototype,"interpolateMode",void 0),uu([ds(),Yr()],gu.prototype,"seekOnScroll",void 0),uu([Qo("Animate All Views",{limitedUi:!0})],gu.prototype,"animateAllViews",null),uu([Qo("Record All Views")],gu.prototype,"recordAllViews",null),uu([Qo("Add Current View")],gu.prototype,"addCurrentView",null),uu([Qo("Focus Next")],gu.prototype,"focusNext",void 0),uu([Qo("Focus Previous")],gu.prototype,"focusPrevious",void 0);const LC=new et.Pa4;function Fv(tt,s,o){let a=tt.dot(s);a=Math.min(Math.max(a,-1),1);const _e=Math.acos(a)*o;return LC.copy(tt).multiplyScalar(a).sub(s).negate().normalize(),tt.multiplyScalar(Math.cos(_e)).add(LC.multiplyScalar(Math.sin(_e)))}var o0=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};class a0 extends io{constructor(s=!0){super(),this.enabled=!0,this.light=new w1("#cceeff",1),this.lightLayers=1,this._preRender=()=>{var o,a,_e;if(!this.enabled)return void(this.light.layers.mask=0);const rt=(a=(o=this._viewer)===null||o===void 0?void 0:o.renderer.frameCount)!==null&&a!==void 0?a:0;(rt<1||rt>5)&&this.light.randomizePosition(rt<5?0:rt),this.light.layers.mask=this.lightLayers,this.light.updateShadowParams(),(_e=this._cameraHelper)===null||_e===void 0||_e.update()},this._setDirty=this._setDirty.bind(this),this.enabled=s}get cameraHelper(){return this._cameraHelper}async onAdded(s){await super.onAdded(s),this._cameraHelper=new et.Rki(this.light.shadow.camera),this._cameraHelper.visible=!1,this._cameraHelper.userData.bboxVisible=!1,s.scene.add(this._cameraHelper),s.scene.addLight(this.light,{addToRoot:!0}),s.addEventListener("preRender",this._preRender)}async onRemove(s){return s.removeEventListener("preRender",this._preRender),this.light.removeFromParent(),super.onRemove(s)}_setDirty(s=!1){var o,a;s?(o=this._viewer)===null||o===void 0||o.scene.setDirty():(a=this._viewer)===null||a===void 0||a.setDirty()}get uiConfig(){return this._uiConfig?this._uiConfig:this._uiConfig={type:"folder",label:"Progressive Shadow",children:[{type:"checkbox",label:"Enabled",property:[this,"enabled"],onChange:this._setDirty},{type:"folder",label:"Directional Light",children:[{type:"checkbox",label:"Visible",property:[this.light,"visible"],onChange:this._setDirty},{type:"slider",label:"Intensity",bounds:[0,10],property:[this.light,"intensity"],onChange:this._setDirty},{type:"color",label:"Color",property:[this.light,"color"],onChange:this._setDirty},{type:"checkbox",label:"Shadow Enabled",property:[this.light.shadowParams,"enabled"],onChange:[this.light.updateShadowParams,this._setDirty]},{type:"slider",bounds:[0,1],property:[this.light.randomParams,"focus"],onChange:this._setDirty},{type:"slider",bounds:[0,1],property:[this.light.randomParams,"spread"],onChange:this._setDirty},{type:"slider",bounds:[.01,60],property:[this.light.randomParams,"distanceScale"],onChange:this._setDirty},{type:"vec3",bounds:[-5,5],property:[this.light.randomParams,"direction"],onChange:this._setDirty},{type:"slider",bounds:[.01,10],property:[this.light.shadowParams,"radius"],onChange:[this.light.updateShadowParams,this._setDirty]},{type:"slider",bounds:[.01,30],property:[this.light.shadowParams,"frustumSize"],onChange:[this.light.updateShadowParams,this._setDirty]},{type:"slider",bounds:[-.01,.01],property:[this.light.shadowParams,"bias"],onChange:[this.light.updateShadowParams,this._setDirty]}]}]}}}a0.PluginType="RandomizedDirectionalLight",o0([Yr()],a0.prototype,"enabled",void 0),o0([Yr("rdLight")],a0.prototype,"light",void 0),o0([Yr()],a0.prototype,"lightLayers",void 0);var l0,D1=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let wm=l0=class extends io{constructor(tt=!1){super(),this.enabled=!1,this.worldRadius=100,this.tripodHeight=10,this._paramsChanged=this._paramsChanged.bind(this),this.enabled=tt}_paramsChanged(){var tt,s,o,a,_e,rt,nt,ot,ct,pt,ht;const _t=(tt=this._viewer)===null||tt===void 0?void 0:tt.getBackground(!0);if(this.enabled&&_t&&_t!==Rv)if(_t.isDataTexture)_t.mapping=et.dSO;else if(confirm("Background must be same as environment, do you want to change it?")){const Mt=(s=this._viewer)===null||s===void 0?void 0:s.getPluginByType("SimpleBackgroundEnvUiPlugin1");Mt?(Mt.envmapBg=!0,(a=(o=Mt.uiConfig).uiRefresh)===null||a===void 0||a.call(o,"postFrame",!0)):(_e=this._viewer)===null||_e===void 0||_e.setBackground(Rv)}else this.enabled=!1;const Et=(ct=(ot=(nt=(rt=this._viewer)===null||rt===void 0?void 0:rt.renderer)===null||nt===void 0?void 0:nt.rendererObject)===null||ot===void 0?void 0:ot.background.getBoxMesh2())===null||ct===void 0?void 0:ct.material,St=(pt=Et==null?void 0:Et.uniforms)!==null&&pt!==void 0?pt:et.Vj0.cube.uniforms;St.tripodHeight||(St.tripodHeight={value:1}),St.worldRadius||(St.worldRadius={value:1}),St.tripodHeight.value=this.tripodHeight,St.worldRadius.value=this.worldRadius,Et&&(!this.enabled&&Et.defines.HDRi_GROUND_PROJ?delete Et.defines.HDRi_GROUND_PROJ:this.enabled&&(Et.defines.HDRi_GROUND_PROJ="1"),Et.needsUpdate=!0),(ht=this._viewer)===null||ht===void 0||ht.setDirty()}async onAdded(tt){var s,o,a;await super.onAdded(tt),!((a=(o=(s=this._viewer)===null||s===void 0?void 0:s.renderer)===null||o===void 0?void 0:o.rendererObject)===null||a===void 0)&&a.background.getBoxMesh()&&console.error("HDRi Ground Plugin must be added before setting any cube or env map"),et.Vj0.cube.fragmentShader=et.Vj0.cube.fragmentShader.replace("void main() {",`
#ifdef HDRi_GROUND_PROJ
float intersectPlane1(const in vec3 r0,const in vec3 rd,const in vec3 n,const in vec3 p0){float t=dot(p0-r0,n)/(dot(n,rd)+1e-6);return t<0.?1000.:t;}float intersectSphere1(in vec3 ro,in vec3 rd,in vec3 sph,in float rad){vec3 oc=ro-sph;float b=dot(oc,rd);float c=dot(oc,oc)-rad*rad;float t=b*b-c;return t<0.?t:-b+sqrt(t);}
#define PI_HALF  1.5707963267948966
uniform float worldRadius;uniform float tripodHeight;vec3 hdriProject(){vec3 p=normalize(vWorldDirection);vec3 camPos=cameraPosition;camPos.y-=tripodHeight;float t=intersectSphere1(camPos,p,vec3(0.,0.,0.),worldRadius);if(t>0.){float t2=intersectPlane1(camPos,p,vec3(0,-1,0),vec3(0.,-tripodHeight,0.));p=(camPos+min(t,t2)*p)/worldRadius;}else p=vec3(0.,1.,0.);return p;}
#endif

void main() {`),et.Vj0.cube.fragmentShader=et.Vj0.cube.fragmentShader.replace("vec3 vReflect = vWorldDirection;",`
vec3 vReflect = 
#ifdef HDRi_GROUND_PROJ
hdriProject()
#else
vWorldDirection
#endif
;
`),tt.scene.addEventListener("environmentChanged",this._paramsChanged)}};wm.PluginType="HDRiGroundPlugin",D1([Yr(),vr(l0.prototype._paramsChanged),ds("Enabled")],wm.prototype,"enabled",void 0),D1([Yr(),vr(l0.prototype._paramsChanged),gs("World Radius",[1,1e3])],wm.prototype,"worldRadius",void 0),D1([Yr(),vr(l0.prototype._paramsChanged),gs("Tripod height",[0,50])],wm.prototype,"tripodHeight",void 0),wm=l0=D1([Ao("HDRi Ground")],wm);var nv=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};const cw={uniforms:{colorTexture:{value:null},tNormalDepth:{value:null},blurTexture:{value:null},cocTexture:{value:null},cocTextureSize:{value:new et.FM8},cameraNearFar:{value:new et.FM8}},vertexShader:Iv,fragmentShader:Zv+`
#include <common>
#include <packing>
varying vec2 vUv;uniform vec2 cocTextureSize;uniform vec2 nearFarBlurScale;uniform vec2 cameraNearFar;uniform vec2 focalDepthRange;uniform vec2 crossCenter;uniform float crossRadius;uniform float crossAlpha;uniform vec3 crossColor;float smoothBoundary(float d,float smooothFactor){smooothFactor*=0.5;float value=smoothstep(-smooothFactor,smooothFactor,d);return value;}float circle(vec2 p,float r){return min((length(p)-r),-(length(p)-r-0.01));}float computeCoc(){float depth=getDepth(vUv);if(depth>1.-0.01)return max(nearFarBlurScale.x,nearFarBlurScale.y);depth=mix(cameraNearFar.x,cameraNearFar.y,depth);float coc=(depth-focalDepthRange.x)/focalDepthRange.y;coc=clamp(coc,-1.,1.);return(coc>0.?coc*nearFarBlurScale.y:coc*nearFarBlurScale.x);}void main(){vec4 blur=blurTextureTexelToLinear(texture2D(blurTexture,vUv));float scale=0.5;blur+=blurTextureTexelToLinear(texture2D(blurTexture,vUv+scale*vec2(1.,1.)/cocTextureSize));blur+=blurTextureTexelToLinear(texture2D(blurTexture,vUv+scale*vec2(-1.,1.)/cocTextureSize));blur+=blurTextureTexelToLinear(texture2D(blurTexture,vUv+scale*vec2(-1.,-1.)/cocTextureSize));blur+=blurTextureTexelToLinear(texture2D(blurTexture,vUv+scale*vec2(1.,-1.)/cocTextureSize));blur/=5.;vec2 uvNearest=(floor(vUv*cocTextureSize)+0.5)/cocTextureSize;float coc=abs(min(2.*cocTextureTexelToLinear(texture2D(cocTexture,uvNearest)).a-1.,computeCoc()));float cocLower=0.005;float cocHigher=0.3;vec4 outColor=vec4(mix(colorTextureTexelToLinear(texture2D(colorTexture,vUv)).rgb,blur.rgb,smoothstep(cocLower,cocHigher,coc)),1.);vec2 d=vUv-crossCenter;if(length(d)>crossRadius+0.05){float dist=circle(d,crossRadius);gl_FragColor=outColor;}else{d.x*=cocTextureSize.x/cocTextureSize.y;float dist=circle(d,crossRadius);dist=smoothBoundary(dist,2.*fwidth(dist));vec4 color=outColor;vec3 dofCircleColor=mix(crossColor,color.rgb,1.-crossAlpha);gl_FragColor=vec4(mix(color.rgb,dofCircleColor,dist),color.a);}
#include <encodings_fragment>
}`},B1=(Ro({uniforms:{cocTexture:{value:null},colorTexture:{value:null},colorTextureSize:{value:new et.FM8},direction:{value:new et.FM8}},vertexShader:Iv,fragmentShader:`#include <common>
varying vec2 vUv;uniform vec2 colorTextureSize;uniform vec2 direction;const float MAXIMUM_BLUR_SIZE=16.;const float SIGMA=5.;const int NUM_SAMPLES=4;float normpdf(in float x,in float sigma){return 0.39894*exp(-0.5*x*x/(sigma*sigma))/sigma;}vec3 weightedBlur(){float cocIn=2.*cocTextureTexelToLinear(texture2D(cocTexture,vUv)).a-1.;float kernelRadius=MAXIMUM_BLUR_SIZE*cocIn;vec2 invSize=1./colorTextureSize;cocIn*=cocIn*cocIn;float centreSpaceWeight=normpdf(0.,SIGMA)*abs(cocIn);float weightSum=centreSpaceWeight;vec3 centreSample=colorTextureTexelToLinear(texture2D(colorTexture,vUv)).rgb;vec3 diffuseSum=centreSample*weightSum;vec2 delta=invSize*kernelRadius/float(NUM_SAMPLES);for(int i=1;i<=NUM_SAMPLES;i++){float spaceWeight=normpdf(float(i),SIGMA);vec2 texcoord=direction*delta*float(i);vec4 rightSample=colorTextureTexelToLinear(texture2D(colorTexture,vUv+texcoord));vec4 leftSample=colorTextureTexelToLinear(texture2D(colorTexture,vUv-texcoord));float leftCocWeight=abs(2.*cocTextureTexelToLinear(texture2D(cocTexture,vUv-texcoord)).a-1.);float rightCocWeight=abs(2.*cocTextureTexelToLinear(texture2D(cocTexture,vUv+texcoord)).a-1.);leftCocWeight*=leftCocWeight*leftCocWeight;rightCocWeight*=rightCocWeight*rightCocWeight;diffuseSum+=((leftSample.rgb*leftCocWeight)+(rightSample.rgb*rightCocWeight))*spaceWeight;weightSum+=(spaceWeight*(leftCocWeight+rightCocWeight));}return diffuseSum/weightSum;}void main(){gl_FragColor=vec4(weightedBlur(),1.);
#include <encodings_fragment>
}`},"colorTexture","cocTexture"),Ro({uniforms:{colorTexture:{value:null},colorTextureSize:{value:new et.FM8},direction:{value:new et.FM8},frameCount:{value:0},blurRadius:{value:16}},vertexShader:Iv,fragmentShader:Pv+`
`+GM+`
#include <common>
varying vec2 vUv;uniform vec2 colorTextureSize;uniform float blurRadius;vec4 CircularBlur(){vec4 color=colorTextureTexelToLinear(texture2D(colorTexture,vUv));
#ifdef DOF_MODE
float blurDist=blurRadius*(2.*color.a-1.);
#else
float blurDist=blurRadius*color.a;
#endif
float rnd=PI2*random3(vec3(vUv,frameCount*0.1));float costheta=cos(rnd);float sintheta=sin(rnd);vec4 rotationMatrix=vec4(costheta,-sintheta,sintheta,costheta);vec3 colorSum=vec3(0.);float weightSum=0.001;vec2 ofs;vec4 sampleColor;setPds();
#pragma unroll_loop_start
for(int i=0;i<16;i++){ofs=poisson_disk_samples[UNROLLED_LOOP_INDEX];ofs=vec2(dot(ofs,rotationMatrix.xy),dot(ofs,rotationMatrix.zw));sampleColor=colorTextureTexelToLinear(texture2D(colorTexture,vUv+blurDist*ofs/colorTextureSize.xy));
#ifdef DOF_MODE
sampleColor.a=abs(sampleColor.a*2.-1.);sampleColor.a*=sampleColor.a*sampleColor.a;
#endif
colorSum+=sampleColor.rgb*sampleColor.a;weightSum+=sampleColor.a;}
#pragma unroll_loop_end
colorSum/=weightSum;return vec4(saturate(colorSum),1.);}void main(){gl_FragColor=CircularBlur();
#include <encodings_fragment>
}`,defines:{DOF_MODE:1}},"colorTexture"));class oy extends Ru{constructor(){super(cw,"colorTexture","cocTexture","blurTexture"),this.dofBlurMaterial=B1,this.nearFarBlurScale=new et.FM8(.25,.25),this.focalDepthRange=new et.FM8(.5,1.5),this.crossCenter=new et.FM8(.5,.5),this.crossRadius=.04,this.crossAlpha=1,this.crossColor=new ys(16750848),this.uiConfig={type:"folder",label:"Depth of Field",children:[{type:"checkbox",label:"Enabled",limitedUi:!0,property:[this,"enabled"]},{type:"slider",label:"Depth Range",bounds:[.5,3],property:[this.focalDepthRange,"y"]},{type:"slider",label:"Near Blur scale",bounds:[0,1],property:[this.nearFarBlurScale,"x"]},{type:"slider",label:"Far Blur scale",bounds:[0,1],property:[this.nearFarBlurScale,"y"]}]},this.material.extensions.derivatives=!0,this.computeCocMaterial=Ro({uniforms:{colorTexture:{value:null},tNormalDepth:this.uniforms.tNormalDepth,cameraNearFar:this.uniforms.cameraNearFar,nearFarBlurScale:this.uniforms.nearFarBlurScale,focalDepthRange:this.uniforms.focalDepthRange},vertexShader:Iv,fragmentShader:Zv+`
#include <common>
#include <packing>
varying vec2 vUv;uniform vec2 nearFarBlurScale;uniform vec2 cameraNearFar;uniform vec2 focalDepthRange;float computeCoc(){float depth=getDepth(vUv);if(depth==1.)return max(nearFarBlurScale.x,nearFarBlurScale.y);depth=mix(cameraNearFar.x,cameraNearFar.y,depth);float coc=(depth-focalDepthRange.x)/focalDepthRange.y;coc=clamp(coc,-1.,1.);return(coc>0.?coc*nearFarBlurScale.y:coc*nearFarBlurScale.x);}void main(){gl_FragColor=vec4(colorTextureTexelToLinear(texture2D(colorTexture,vUv)).rgb,0.5*computeCoc()+0.5);
#include <encodings_fragment>
}`},"colorTexture"),this.expandCocMaterial=Ro({uniforms:{colorTexture:{value:null},colorTextureSize:{value:new et.FM8},direction:{value:new et.FM8},tNormalDepth:this.uniforms.tNormalDepth,nearFarBlurScale:this.uniforms.nearFarBlurScale},vertexShader:Iv,fragmentShader:Zv+`
#include <common>
varying vec2 vUv;uniform vec2 colorTextureSize;uniform vec2 direction;uniform vec2 nearFarBlurScale;const float MAXIMUM_BLUR_SIZE=4.;float expandNear(const in vec2 offset,const in bool isBackground){float coc=0.;vec2 sampleOffsets=MAXIMUM_BLUR_SIZE*offset/5.;float coc0=2.*colorTextureTexelToLinear(texture2D(colorTexture,vUv)).a-1.;float coc1=2.*colorTextureTexelToLinear(texture2D(colorTexture,vUv-5.*sampleOffsets)).a-1.;float coc2=2.*colorTextureTexelToLinear(texture2D(colorTexture,vUv-4.*sampleOffsets)).a-1.;float coc3=2.*colorTextureTexelToLinear(texture2D(colorTexture,vUv-3.*sampleOffsets)).a-1.;float coc4=2.*colorTextureTexelToLinear(texture2D(colorTexture,vUv-2.*sampleOffsets)).a-1.;float coc5=2.*colorTextureTexelToLinear(texture2D(colorTexture,vUv-1.*sampleOffsets)).a-1.;float coc6=2.*colorTextureTexelToLinear(texture2D(colorTexture,vUv+1.*sampleOffsets)).a-1.;float coc7=2.*colorTextureTexelToLinear(texture2D(colorTexture,vUv+2.*sampleOffsets)).a-1.;float coc8=2.*colorTextureTexelToLinear(texture2D(colorTexture,vUv+3.*sampleOffsets)).a-1.;float coc9=2.*colorTextureTexelToLinear(texture2D(colorTexture,vUv+4.*sampleOffsets)).a-1.;float coc10=2.*colorTextureTexelToLinear(texture2D(colorTexture,vUv+5.*sampleOffsets)).a-1.;if(isBackground){coc=abs(coc0)*0.095474+(abs(coc1)+abs(coc10))*0.084264+(abs(coc2)+abs(coc9))*0.088139+(abs(coc3)+abs(coc8))*0.091276+(abs(coc4)+abs(coc7))*0.093585+(abs(coc5)+abs(coc6))*0.094998;}else{coc=min(coc0,0.);coc=min(coc1*0.3,coc);coc=min(coc2*0.5,coc);coc=min(coc3*0.75,coc);coc=min(coc4*0.8,coc);coc=min(coc5*0.95,coc);coc=min(coc6*0.95,coc);coc=min(coc7*0.8,coc);coc=min(coc8*0.75,coc);coc=min(coc9*0.5,coc);coc=min(coc10*0.3,coc);if(abs(coc0)>abs(coc))coc=coc0;}return coc;}void main(){vec2 offset=2.*direction/colorTextureSize;bool isBackground=getDepth(vUv)>1.-0.001;float coc=expandNear(offset,isBackground);gl_FragColor=vec4(colorTextureTexelToLinear(texture2D(colorTexture,vUv)).rgb,0.5*coc+0.5);
#include <encodings_fragment>
}`},"colorTexture")}render(s,o,a,_e,rt){if(!this.enabled)return;const nt=s.baseRenderer,ot={minFilter:et.TyD,magFilter:et.TyD,type:et.cLu,encoding:et.rnI,sizeMultiplier:.5,isAntialiased:!1,format:et.wk1,depthBuffer:!1,generateMipmaps:!1},ct=nt.getTempTarget(ot),pt=nt.getTempTarget(ot);if(this.computeCocMaterial.uniforms.colorTexture.value=a.texture,nt.blit(void 0,ct,{material:this.computeCocMaterial}),this.expandCocMaterial.uniforms.colorTexture.value=ct.texture,this.expandCocMaterial.uniforms.direction.value.set(1,0),nt.blit(void 0,pt,{material:this.expandCocMaterial}),this.expandCocMaterial.uniforms.colorTexture.value=pt.texture,this.expandCocMaterial.uniforms.direction.value.set(0,1),nt.blit(void 0,ct,{material:this.expandCocMaterial}),this.dofBlurMaterial.uniforms.frameCount)this.dofBlurMaterial.uniforms.colorTexture.value=ct.texture,nt.blit(void 0,pt,{material:this.dofBlurMaterial});else{const ht=nt.getTempTarget(ot);this.dofBlurMaterial.uniforms.cocTexture.value=ct.texture,this.dofBlurMaterial.uniforms.colorTexture.value=ct.texture,this.dofBlurMaterial.uniforms.direction.value.set(1,0),nt.blit(void 0,ht,{material:this.dofBlurMaterial}),this.dofBlurMaterial.uniforms.colorTexture.value=ht.texture,this.dofBlurMaterial.uniforms.direction.value.set(0,1),nt.blit(void 0,pt,{material:this.dofBlurMaterial}),nt.releaseTempTarget(ht)}this.material.uniforms.blurTexture.value=pt.texture,this.material.uniforms.cocTexture.value=ct.texture,super.render(s,o,a,_e,rt),nt.releaseTempTarget(ct),nt.releaseTempTarget(pt)}}nv([Yr(),Ar()],oy.prototype,"nearFarBlurScale",void 0),nv([Yr(),Ar()],oy.prototype,"focalDepthRange",void 0),nv([Ar()],oy.prototype,"crossCenter",void 0),nv([Ar()],oy.prototype,"crossRadius",void 0),nv([Ar()],oy.prototype,"crossAlpha",void 0),nv([Ar()],oy.prototype,"crossColor",void 0);var u0=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};class c0 extends Mv{constructor(s=!0,o=!1){super(),this.passId="depthOfField",this._beforeFilters=["progressive","tonemap","screen"],this._afterFilters=["render"],this._requiredFilters=["render"],this.dependencies=[Dl],this.enableEdit=!1,this._focalPointHit=new et.Pa4(0,0,0),this.crossFadeTime=200,this._focalPointHitTime=0,this._tempVec=new et.Pa4,this.enabled=s,this.enableEdit=o,this._onObjectHit=this._onObjectHit.bind(this),this.setDirty=this.setDirty.bind(this)}passCtor(s){return new oy}setFocalPoint(s,o=!0,a=!1){var _e,rt;this._focalPointHit.copy(s),o&&((rt=(_e=this._viewer)===null||_e===void 0?void 0:_e.getPlugin(i0))===null||rt===void 0||rt.startTransition(this._frameFadeTime)),a&&(this._focalPointHitTime=bo()),this.setDirty()}getFocalPoint(){return this._focalPointHit}get depthRange(){var s,o;return(o=(s=this.pass)===null||s===void 0?void 0:s.passObject.focalDepthRange.y)!==null&&o!==void 0?o:0}set depthRange(s){this.pass&&(this.pass.passObject.focalDepthRange.y=s),this.setDirty()}get nearBlurScale(){var s,o;return(o=(s=this.pass)===null||s===void 0?void 0:s.passObject.nearFarBlurScale.x)!==null&&o!==void 0?o:0}set nearBlurScale(s){this.pass&&(this.pass.passObject.nearFarBlurScale.x=s),this.setDirty()}get farBlurScale(){var s,o;return(o=(s=this.pass)===null||s===void 0?void 0:s.passObject.nearFarBlurScale.y)!==null&&o!==void 0?o:0}set farBlurScale(s){this.pass&&(this.pass.passObject.nearFarBlurScale.y=s),this.setDirty()}get _frameFadeTime(){return 2.5*this.crossFadeTime}_onObjectHit(s){var o,a;this._pass&&s.intersects.intersect&&this.enabled&&this.enableEdit&&(this._focalPointHit.copy(s.intersects.intersect.point),this._focalPointHitTime=s.time,s.intersects.selectedObject=null,(a=(o=this._viewer)===null||o===void 0?void 0:o.getPlugin(i0))===null||a===void 0||a.startTransition(this._frameFadeTime),this.setDirty())}async onAdded(s){var o;await super.onAdded(s),(o=s.getPluginByType("Picking"))===null||o===void 0||o.addEventListener("hitObject",this._onObjectHit)}async onRemove(s){var o;return(o=s.getPluginByType("Picking"))===null||o===void 0||o.removeEventListener("hitObject",this._onObjectHit),super.onRemove(s)}setDirty(){var s;(s=this._viewer)===null||s===void 0||s.setDirty()}_update(s){var o,a;if(!super._update(s))return!1;const _e=(o=this.pass)===null||o===void 0?void 0:o.passObject;if(!_e)return!1;const rt=s.getPlugin(Dl);rt==null||rt.updateShaderProperties(_e.material),_e.dofBlurMaterial.uniforms.frameCount&&((a=s.renderer)===null||a===void 0||a.updateShaderProperties(_e.dofBlurMaterial));const nt=s.scene.activeCamera;if(!nt)return!1;nt.cameraObject.updateMatrixWorld(!0),nt.updateShaderProperties(_e.material),this._tempVec.subVectors(this._focalPointHit,nt.cameraObject.position),_e.focalDepthRange.x=this._tempVec.length(),_e.focalDepthRange.x*=nt.cameraObject.getWorldDirection(new et.Pa4).dot(this._tempVec.normalize());let ot=(bo()-this._focalPointHitTime)/this.crossFadeTime;if(ot=1-Math.min(1,Math.max(0,ot)),Math.abs(ot-_e.crossAlpha)>.01&&(_e.crossAlpha=ot,this.setDirty()),ot>0){const ct=this._tempVec.copy(this._focalPointHit).project(nt.cameraObject).addScalar(1).divideScalar(2);_e.crossCenter.set(ct.x,ct.y),_e.computeCocMaterial.uniformsNeedUpdate=!0,_e.expandCocMaterial.uniformsNeedUpdate=!0}return!0}get uiConfig(){var s,o,a,_e,rt;if(this._uiConfig)return this._uiConfig;const nt=(o=(s=this._pass)===null||s===void 0?void 0:s.passObject)===null||o===void 0?void 0:o.uiConfig;return nt?((_e=(a=nt.children)===null||a===void 0?void 0:a.map(ot=>er(ot)))===null||_e===void 0||_e.flat(2).forEach(ot=>ot&&(ot.onChange=this.setDirty)),(rt=nt.children)===null||rt===void 0||rt.push({type:"checkbox",label:"Enable Edit",limitedUi:!0,property:[this,"enableEdit"]}),this._uiConfig=nt,nt):{}}}c0.PluginType="DepthOfField",u0([Yr()],c0.prototype,"enableEdit",void 0),u0([Yr("focalPoint")],c0.prototype,"_focalPointHit",void 0),u0([Yr()],c0.prototype,"crossFadeTime",void 0);var sA,Wu=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let Du=sA=class extends io{constructor(tt=!0){super(),this.enabled=!0,this.radius=.015,this.intensity=1,this.tolerance=1.5,this._defines={},this.onlySSCSDebug=!1,this.stepCount=2,this.dependencies=[Dl,os],this.materialExtension={shaderExtender:(s,o,a)=>{if(!s.defines.SSCS_ENABLED)return;const _e=Wt`
                #ifndef D_sceneBoundingRadius
                #define D_sceneBoundingRadius
                uniform float sceneBoundingRadius;
                #endif
                float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, vec3 lightDirection ) {
                    vec3 ray_origin_view = -vViewPosition;
                    float rnd = interleavedGradientNoise(gl_FragCoord.xy, frameCount+34.);
                    float cameraDist = length(cameraPositionWorld);
//                    float radius = mix((cameraNearFar.y) + ray_origin_view.z, -ray_origin_view.z - cameraNearFar.x, rnd * 0.5 + 0.5)*sscsRadius;
                    float radius = mix((cameraDist + sceneBoundingRadius) + ray_origin_view.z, -ray_origin_view.z - max(0.0, cameraDist - sceneBoundingRadius), rnd * 0.5 + 0.5)*sscsRadius;
                    vec3 state = vec3(1.,(rnd+0.5)/float(SSCS_STEP_COUNT),2.);
                    traceRay(ray_origin_view, normalize(lightDirection) * radius, sscsTolerance * radius * 2., state, SSCS_STEP_COUNT);
                    state.z = state.z > 0.99 ? 1. : max(0.,min(state.z * state.z * (1.-sscsIntensity), 1.));
                    
                #if defined(SSCS_DEBUG) && SSCS_DEBUG > 0
                    return state.z;
                #endif
            `,rt=`
#if SSCS_ENABLED

    uniform float sscsIntensity;
    uniform float sscsRadius;
    uniform float sscsTolerance;

    ${zx}
    
    #define THREE_PACKING_INCLUDED
    ${e1}
    
    ${Zv}
    ${Pv}
    
    ${Vx}

#endif
            
            `+et.WdD.shadowmap_pars_fragment.replace("float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {",`${_e}
`).replace("return shadow;","return min(shadow, state.z);");s.fragmentShader=s.fragmentShader.replace("#include <shadowmap_pars_fragment>",rt),s.fragmentShader=s.fragmentShader.replace("#include <lights_fragment_begin>",et.WdD.lights_fragment_begin),s.fragmentShader=s.fragmentShader.replace("directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;","directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ], directLight.direction ) : 1.0;").replace("directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;","directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ], directLight.direction ) : 1.0;")},onObjectRender:(s,o,a)=>{var _e;const rt=o.materialObject;let nt=this.enabled&&a.userData.screenSpaceRendering!==!1&&!(!((_e=rt.userData)===null||_e===void 0)&&_e.sscsDisabled)?1:0;rt.defines.SSCS_ENABLED!==nt&&(rt.defines.SSCS_ENABLED=nt,rt.needsUpdate=!0),nt=this._defines.SSCS_STEP_COUNT,rt.defines.SSCS_STEP_COUNT!==nt&&(rt.defines.SSCS_STEP_COUNT=nt,rt.needsUpdate=!0),nt=+this._defines.SSCS_DEBUG,rt.defines.SSCS_DEBUG!==nt&&(rt.defines.SSCS_DEBUG=nt,rt.needsUpdate=!0)},parsFragmentSnippet:()=>`
`,extraUniforms:{...sA._uniforms},computeCacheKey:s=>this.enabled?"1":"0",isCompatible:s=>s.isMeshStandardMaterial2,updaters:()=>{var s,o,a,_e,rt;return[(s=this._viewer)===null||s===void 0?void 0:s.getPlugin(Dl),(o=this._viewer)===null||o===void 0?void 0:o.getPlugin(_p),(a=this._viewer)===null||a===void 0?void 0:a.scene.activeCamera,(_e=this._viewer)===null||_e===void 0?void 0:_e.renderer,(rt=this._viewer)===null||rt===void 0?void 0:rt.scene]}},this.enabled=tt,this.userData={setDirty:()=>{var s;(s=this._viewer)===null||s===void 0||s.setDirty()}}}async onAdded(tt){var s,o;await super.onAdded(tt),(o=(s=tt.getPlugin(os))===null||s===void 0?void 0:s.materials)===null||o===void 0||o.registerMaterialExtension(this.materialExtension)}async onRemove(tt){var s,o;return(o=(s=tt.getPlugin(os))===null||s===void 0?void 0:s.materials)===null||o===void 0||o.unregisterMaterialExtension(this.materialExtension),super.onRemove(tt)}};Du.PluginType="SSContactShadows",Du._uniforms={tNormalDepth:{value:null},frameCount:{value:0},projection:{value:new et.yGw},cameraPositionWorld:{value:new et.Pa4},cameraNearFar:{value:new et.FM8(.1,1e3)},sceneBoundingRadius:{value:0}},Wu([ds("Enabled"),Yr()],Du.prototype,"enabled",void 0),Wu([Ar({uniforms:sA._uniforms,propKey:"sscsRadius"}),gs("Radius",[1e-4,.1],1e-4),Yr()],Du.prototype,"radius",void 0),Wu([Ar({uniforms:sA._uniforms,propKey:"sscsIntensity"}),gs("Intensity",[1e-4,1],1e-4),Yr()],Du.prototype,"intensity",void 0),Wu([Ar({uniforms:sA._uniforms,propKey:"sscsTolerance"}),gs("Tolerance",[.1,5]),Yr()],Du.prototype,"tolerance",void 0),Wu([jr("SSCS_DEBUG",void 0,!0),ds("Debug only SSCS"),Yr()],Du.prototype,"onlySSCSDebug",void 0),Wu([jr("SSCS_STEP_COUNT",void 0,!0),gs("Step count",[1,8],1),Yr()],Du.prototype,"stepCount",void 0),Du=sA=Wu([Ao("Screen Space Contact Shadows")],Du);class SP{constructor(s=4){this.pool=s,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(s){if(!this.workers[s]){const o=this.workerCreator();o.addEventListener("message",this._onMessage.bind(this,s)),this.workers[s]=o}}_getIdleWorker(){for(let s=0;s<this.pool;s++)if(!(this.workerStatus&1<<s))return s;return-1}_onMessage(s,o){const a=this.workersResolve[s];if(a&&a(o),this.queue.length){const{resolve:_e,msg:rt,transfer:nt}=this.queue.shift();this.workersResolve[s]=_e,this.workers[s].postMessage(rt,nt)}else this.workerStatus^=1<<s}setWorkerCreator(s){this.workerCreator=s}setWorkerLimit(s){this.pool=s}postMessage(s,o){return new Promise(a=>{const _e=this._getIdleWorker();_e!==-1?(this._initWorker(_e),this.workerStatus|=1<<_e,this.workersResolve[_e]=a,this.workers[_e].postMessage(s,o)):this.queue.push({resolve:a,msg:s,transfer:o})})}dispose(){this.workers.forEach(s=>s.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}class d0{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class k1{constructor(s,o,a,_e){this._dataView=new DataView(s.buffer,s.byteOffset+o,a),this._littleEndian=_e,this._offset=0}_nextUint8(){const s=this._dataView.getUint8(this._offset);return this._offset+=1,s}_nextUint16(){const s=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,s}_nextUint32(){const s=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,s}_nextUint64(){const s=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,s}_nextInt32(){const s=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,s}_skip(s){return this._offset+=s,this}_scan(s,o=0){const a=this._offset;let _e=0;for(;this._dataView.getUint8(this._offset)!==o&&_e<s;)_e++,this._offset++;return _e<s&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+a,_e)}}const qp=[171,75,84,88,32,50,48,187,13,10,26,10];function dw(tt){return typeof TextDecoder<"u"?new TextDecoder().decode(tt):Buffer.from(tt).toString("utf8")}let NC,p0,FC;const m_={env:{emscripten_notify_memory_growth:function(tt){FC=new Uint8Array(p0.exports.memory.buffer)}}};class YM{init(){return NC||(NC=typeof fetch<"u"?fetch("data:application/wasm;base64,"+UC).then(s=>s.arrayBuffer()).then(s=>WebAssembly.instantiate(s,m_)).then(this._init):WebAssembly.instantiate(Buffer.from(UC,"base64"),m_).then(this._init),NC)}_init(s){p0=s.instance,m_.env.emscripten_notify_memory_growth(0)}decode(s,o=0){if(!p0)throw new Error("ZSTDDecoder: Await .init() before decoding.");const a=s.byteLength,_e=p0.exports.malloc(a);FC.set(s,_e),o=o||Number(p0.exports.ZSTD_findDecompressedSize(_e,a));const rt=p0.exports.malloc(o),nt=p0.exports.ZSTD_decompress(rt,o,_e,a),ot=FC.slice(rt,rt+nt);return p0.exports.free(_e),p0.exports.free(rt),ot}}const UC="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ",TE=new WeakMap;let ME,O1=0;class g_ extends et.aNw{constructor(s){super(s),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new SP,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(s){return this.transcoderPath=s,this}setWorkerLimit(s){return this.workerPool.setWorkerLimit(s),this}detectSupport(s){return this.workerConfig={astcSupported:s.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:s.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:s.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:s.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:s.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:s.extensions.has("WEBGL_compressed_texture_pvrtc")||s.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},s.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1),this}init(){if(!this.transcoderPending){const s=new et.hH6(this.manager);s.setPath(this.transcoderPath),s.setWithCredentials(this.withCredentials);const o=s.loadAsync("basis_transcoder.js"),a=new et.hH6(this.manager);a.setPath(this.transcoderPath),a.setResponseType("arraybuffer"),a.setWithCredentials(this.withCredentials);const _e=a.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([o,_e]).then(([rt,nt])=>{const ot=g_.BasisWorker.toString(),ct=["/* constants */","let _EngineFormat = "+JSON.stringify(g_.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(g_.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(g_.BasisFormat),"/* basis_transcoder.js */",rt,"/* worker */",ot.substring(ot.indexOf("{")+1,ot.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([ct])),this.transcoderBinary=nt,this.workerPool.setWorkerCreator(()=>{const pt=new Worker(this.workerSourceURL),ht=this.transcoderBinary.slice(0);return pt.postMessage({type:"init",config:this.workerConfig,transcoderBinary:ht},[ht]),pt})}),O1>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),O1++}return this.transcoderPending}load(s,o,a,_e){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const rt=new et.hH6(this.manager);rt.setResponseType("arraybuffer"),rt.setWithCredentials(this.withCredentials),rt.load(s,nt=>{if(TE.has(nt))return TE.get(nt).promise.then(o).catch(_e);this.createTexture(nt).then(ot=>o?o(ot):null).catch(_e)},a,_e)}_createTextureFrom(s){const{mipmaps:o,width:a,height:_e,format:rt,type:nt,error:ot,dfdTransferFn:ct,dfdFlags:pt}=s;if(nt==="error")return Promise.reject(ot);const ht=new et.EB7(o,a,_e,rt,et.ywz);return ht.minFilter=o.length===1?et.wem:et.D1R,ht.magFilter=et.wem,ht.generateMipmaps=!1,ht.needsUpdate=!0,ht.encoding=ct===2?et.knz:et.rnI,ht.premultiplyAlpha=!!(1&pt),ht}createTexture(s,o={}){const a=function(nt){const ot=new Uint8Array(nt.buffer,nt.byteOffset,qp.length);if(ot[0]!==qp[0]||ot[1]!==qp[1]||ot[2]!==qp[2]||ot[3]!==qp[3]||ot[4]!==qp[4]||ot[5]!==qp[5]||ot[6]!==qp[6]||ot[7]!==qp[7]||ot[8]!==qp[8]||ot[9]!==qp[9]||ot[10]!==qp[10]||ot[11]!==qp[11])throw new Error("Missing KTX 2.0 identifier.");const ct=new d0,pt=17*Uint32Array.BYTES_PER_ELEMENT,ht=new k1(nt,qp.length,pt,!0);ct.vkFormat=ht._nextUint32(),ct.typeSize=ht._nextUint32(),ct.pixelWidth=ht._nextUint32(),ct.pixelHeight=ht._nextUint32(),ct.pixelDepth=ht._nextUint32(),ct.layerCount=ht._nextUint32(),ct.faceCount=ht._nextUint32();const _t=ht._nextUint32();ct.supercompressionScheme=ht._nextUint32();const Et=ht._nextUint32(),St=ht._nextUint32(),Mt=ht._nextUint32(),It=ht._nextUint32(),Nt=ht._nextUint64(),Bt=ht._nextUint64(),kt=new k1(nt,qp.length+pt,3*_t*8,!0);for(let Gn=0;Gn<_t;Gn++)ct.levels.push({levelData:new Uint8Array(nt.buffer,nt.byteOffset+kt._nextUint64(),kt._nextUint64()),uncompressedByteLength:kt._nextUint64()});const Pt=new k1(nt,Et,St,!0),qt={vendorId:Pt._skip(4)._nextUint16(),descriptorType:Pt._nextUint16(),versionNumber:Pt._nextUint16(),descriptorBlockSize:Pt._nextUint16(),colorModel:Pt._nextUint8(),colorPrimaries:Pt._nextUint8(),transferFunction:Pt._nextUint8(),flags:Pt._nextUint8(),texelBlockDimension:[Pt._nextUint8(),Pt._nextUint8(),Pt._nextUint8(),Pt._nextUint8()],bytesPlane:[Pt._nextUint8(),Pt._nextUint8(),Pt._nextUint8(),Pt._nextUint8(),Pt._nextUint8(),Pt._nextUint8(),Pt._nextUint8(),Pt._nextUint8()],samples:[]},Kt=(qt.descriptorBlockSize/4-6)/4;for(let Gn=0;Gn<Kt;Gn++){const Qn={bitOffset:Pt._nextUint16(),bitLength:Pt._nextUint8(),channelType:Pt._nextUint8(),samplePosition:[Pt._nextUint8(),Pt._nextUint8(),Pt._nextUint8(),Pt._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&Qn.channelType?(Qn.sampleLower=Pt._nextInt32(),Qn.sampleUpper=Pt._nextInt32()):(Qn.sampleLower=Pt._nextUint32(),Qn.sampleUpper=Pt._nextUint32()),qt.samples[Gn]=Qn}ct.dataFormatDescriptor.length=0,ct.dataFormatDescriptor.push(qt);const nr=new k1(nt,Mt,It,!0);for(;nr._offset<It;){const Gn=nr._nextUint32(),Qn=nr._scan(Gn),Yn=dw(Qn),bs=nr._scan(Gn-Qn.byteLength);ct.keyValue[Yn]=Yn.match(/^ktx/i)?dw(bs):bs,nr._offset%4&&nr._skip(4-nr._offset%4)}if(Bt<=0)return ct;const ir=new k1(nt,Nt,Bt,!0),fr=ir._nextUint16(),br=ir._nextUint16(),Tr=ir._nextUint32(),Dr=ir._nextUint32(),Rr=ir._nextUint32(),Nr=ir._nextUint32(),Ir=[];for(let Gn=0;Gn<_t;Gn++)Ir.push({imageFlags:ir._nextUint32(),rgbSliceByteOffset:ir._nextUint32(),rgbSliceByteLength:ir._nextUint32(),alphaSliceByteOffset:ir._nextUint32(),alphaSliceByteLength:ir._nextUint32()});const kr=Nt+ir._offset,Hr=kr+Tr,Lr=Hr+Dr,en=Lr+Rr,vn=new Uint8Array(nt.buffer,nt.byteOffset+kr,Tr),wn=new Uint8Array(nt.buffer,nt.byteOffset+Hr,Dr),pn=new Uint8Array(nt.buffer,nt.byteOffset+Lr,Rr),Fn=new Uint8Array(nt.buffer,nt.byteOffset+en,Nr);return ct.globalData={endpointCount:fr,selectorCount:br,imageDescs:Ir,endpointsData:vn,selectorsData:wn,tablesData:pn,extendedData:Fn},ct}(new Uint8Array(s));if(a.vkFormat!==0)return async function(nt){const{vkFormat:ot,pixelWidth:ct,pixelHeight:pt,pixelDepth:ht}=nt;if($C[ot]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");const _t=nt.levels[0];let Et,St;if(nt.supercompressionScheme===0)Et=_t.levelData;else{if(nt.supercompressionScheme!==2)throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");ME||(ME=new Promise(async It=>{const Nt=new YM;await Nt.init(),It(Nt)})),Et=(await ME).decode(_t.levelData,_t.uncompressedByteLength)}St=RE[ot]===et.VzW?new Float32Array(Et.buffer,Et.byteOffset,Et.byteLength/Float32Array.BYTES_PER_ELEMENT):RE[ot]===et.cLu?new Uint16Array(Et.buffer,Et.byteOffset,Et.byteLength/Uint16Array.BYTES_PER_ELEMENT):Et;const Mt=ht===0?new et.IEO(St,ct,pt):new et.JUT(St,ct,pt,ht);return Mt.type=RE[ot],Mt.format=$C[ot],Mt.encoding=L1[ot]||et.rnI,Mt.needsUpdate=!0,Promise.resolve(Mt)}(a);const _e=o,rt=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:s,taskConfig:_e},[s])).then(nt=>this._createTextureFrom(nt.data));return TE.set(s,{promise:rt}),rt}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),O1--,this}}g_.BasisFormat={ETC1S:0,UASTC_4x4:1},g_.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16},g_.EngineFormat={RGBAFormat:et.wk1,RGBA_ASTC_4x4_Format:et.ptH,RGBA_BPTC_Format:et.bsb,RGBA_ETC2_EAC_Format:et.ekQ,RGBA_PVRTC_4BPPV1_Format:et.eaV,RGBA_S3TC_DXT5_Format:et.ILR,RGB_ETC1_Format:et.fto,RGB_ETC2_Format:et.l0P,RGB_PVRTC_4BPPV1_Format:et._AM,RGB_S3TC_DXT1_Format:et.wuA},g_.BasisWorker=function(){let tt,s,o;const a=_EngineFormat,_e=_TranscoderFormat,rt=_BasisFormat;self.addEventListener("message",function(ht){const _t=ht.data;switch(_t.type){case"init":tt=_t.config,Et=_t.transcoderBinary,s=new Promise(St=>{o={wasmBinary:Et,onRuntimeInitialized:St},BASIS(o)}).then(()=>{o.initializeBasis(),o.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")});break;case"transcode":s.then(()=>{try{const{width:St,height:Mt,hasAlpha:It,mipmaps:Nt,format:Bt,dfdTransferFn:kt,dfdFlags:Pt}=function(Kt){const nr=new o.KTX2File(new Uint8Array(Kt));function ir(){nr.close(),nr.delete()}if(!nr.isValid())throw ir(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");const fr=nr.isUASTC()?rt.UASTC_4x4:rt.ETC1S,br=nr.getWidth(),Tr=nr.getHeight(),Dr=nr.getLevels(),Rr=nr.getHasAlpha(),Nr=nr.getDFDTransferFunc(),Ir=nr.getDFDFlags(),{transcoderFormat:kr,engineFormat:Hr}=function(en,vn,wn,pn){let Fn,Gn;const Qn=en===rt.ETC1S?ot:ct;for(let Yn=0;Yn<Qn.length;Yn++){const bs=Qn[Yn];if(tt[bs.if]&&bs.basisFormat.includes(en)&&!(pn&&bs.transcoderFormat.length<2)&&(!bs.needsPowerOfTwo||pt(vn)&&pt(wn)))return Fn=bs.transcoderFormat[pn?1:0],Gn=bs.engineFormat[pn?1:0],{transcoderFormat:Fn,engineFormat:Gn}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),Fn=_e.RGBA32,Gn=a.RGBAFormat,{transcoderFormat:Fn,engineFormat:Gn}}(fr,br,Tr,Rr);if(!br||!Tr||!Dr)throw ir(),new Error("THREE.KTX2Loader:	Invalid texture");if(!nr.startTranscoding())throw ir(),new Error("THREE.KTX2Loader: .startTranscoding failed");const Lr=[];for(let en=0;en<Dr;en++){const vn=nr.getImageLevelInfo(en,0,0),wn=vn.origWidth,pn=vn.origHeight,Fn=new Uint8Array(nr.getImageTranscodedSizeInBytes(en,0,0,kr));if(!nr.transcodeImage(Fn,en,0,0,kr,0,-1,-1))throw ir(),new Error("THREE.KTX2Loader: .transcodeImage failed.");Lr.push({data:Fn,width:wn,height:pn})}return ir(),{width:br,height:Tr,hasAlpha:Rr,mipmaps:Lr,format:Hr,dfdTransferFn:Nr,dfdFlags:Ir}}(_t.buffer),qt=[];for(let Kt=0;Kt<Nt.length;++Kt)qt.push(Nt[Kt].data.buffer);self.postMessage({type:"transcode",id:_t.id,width:St,height:Mt,hasAlpha:It,mipmaps:Nt,format:Bt,dfdTransferFn:kt,dfdFlags:Pt},qt)}catch(St){console.error(St),self.postMessage({type:"error",id:_t.id,error:St.message})}})}var Et});const nt=[{if:"astcSupported",basisFormat:[rt.UASTC_4x4],transcoderFormat:[_e.ASTC_4x4,_e.ASTC_4x4],engineFormat:[a.RGBA_ASTC_4x4_Format,a.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[rt.ETC1S,rt.UASTC_4x4],transcoderFormat:[_e.BC7_M5,_e.BC7_M5],engineFormat:[a.RGBA_BPTC_Format,a.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[rt.ETC1S,rt.UASTC_4x4],transcoderFormat:[_e.BC1,_e.BC3],engineFormat:[a.RGB_S3TC_DXT1_Format,a.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[rt.ETC1S,rt.UASTC_4x4],transcoderFormat:[_e.ETC1,_e.ETC2],engineFormat:[a.RGB_ETC2_Format,a.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[rt.ETC1S,rt.UASTC_4x4],transcoderFormat:[_e.ETC1],engineFormat:[a.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[rt.ETC1S,rt.UASTC_4x4],transcoderFormat:[_e.PVRTC1_4_RGB,_e.PVRTC1_4_RGBA],engineFormat:[a.RGB_PVRTC_4BPPV1_Format,a.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],ot=nt.sort(function(ht,_t){return ht.priorityETC1S-_t.priorityETC1S}),ct=nt.sort(function(ht,_t){return ht.priorityUASTC-_t.priorityUASTC});function pt(ht){return ht<=2||(ht&ht-1)==0&&ht!==0}};const $C={109:et.wk1,97:et.wk1,37:et.wk1,43:et.wk1,103:et.av9,83:et.av9,16:et.av9,22:et.av9,100:et.hEm,76:et.hEm,15:et.hEm,9:et.hEm},RE={109:et.VzW,97:et.cLu,37:et.ywz,43:et.ywz,103:et.VzW,83:et.cLu,16:et.ywz,22:et.ywz,100:et.VzW,76:et.cLu,15:et.ywz,9:et.ywz},L1={43:et.knz,22:et.knz,15:et.knz},N1="KHR_texture_basisu";class jC extends it{constructor(){super(...arguments),this.dependencies=[os]}async onAdded(s){var o,a,_e,rt;this._importer||(this._importer=new Yl(class extends g_{constructor(nt){super(nt),this.setTranscoderPath("https://cdn.jsdelivr.net/gh/BinomialLLC/basis_universal@master/webgl/transcoder/build/").detectSupport(s.renderer.rendererObject)}async createTexture(nt,ot){const ct=nt.map(ht=>new Uint8Array(ht.slice(0))),pt=await super.createTexture(nt,ot);return pt.source._sourceImgBuffer=ct,pt.userData.mimeType="image/ktx2",pt}},["ktx2"],!1)),mo.Importers.push(this._importer),(rt=(_e=(a=(o=s.getManager())===null||o===void 0?void 0:o.exporter)===null||a===void 0?void 0:a.getExporter("gltf","glb"))===null||_e===void 0?void 0:_e.extensions)===null||rt===void 0||rt.push(KM)}async onDispose(s){this._importer=void 0}async onRemove(s){this._importer&&mo.Importers.splice(mo.Importers.indexOf(this._importer),1),this._importer=void 0}}jC.PluginType="KTX2LoadPlugin";const KM=tt=>({writeTexture:(s,o)=>{if(s.userData.mimeType!=="image/ktx2")return;if(o.source!==void 0)return void console.warn("ktx2 export: source already set");const a=s.source._sourceImgBuffer;if(!a||!a.length)return void console.warn("ktx2 export: no source buffer for ktx2");o.extensions=o.extensions||{};const _e={},rt=new Blob(Array.isArray(a)?a:[a],{type:"image/ktx2"});_e.source=tt.processImageBlob(rt,s),o.extensions[N1]=_e,tt.extensionsUsed[N1]=!0}});class IE{constructor(s){this.presets=[],this.name="",this.selected=void 0,s&&(this.name=s)}async apply(s,o,a){var _e,rt;if(!o)return void(this.selected=void 0);let nt=this.presets.find(ot=>ot.path===o.path);return nt||(this.presets.push(o),nt=o),this.selected=nt,(rt=(_e=s.getManager())===null||_e===void 0?void 0:_e.importer)===null||rt===void 0?void 0:rt.importAsset(nt,a)}}class XM extends IE{constructor(){super(...arguments),this.name="Background"}async apply(s,o){const a=await super.apply(s,o),_e=a==null?void 0:a[0];return _e&&(_e.encoding=et.knz,await s.setBackground(_e)),_e}}class JM extends IE{constructor(){super(...arguments),this.name="Environment"}async apply(s,o){const a=await super.apply(s,o),_e=a==null?void 0:a[0];return _e&&await s.scene.setEnvironment(_e),_e}}class ZM extends IE{constructor(){super(...arguments),this.name="GemEnvironment"}async apply(s,o){const a=await super.apply(s,o),_e=a==null?void 0:a[0];return dr(s.getPluginByType("Diamond"),"envMap",_e),_e}}class F1 extends IE{async apply(s,o){var a,_e;const rt=await super.apply(s,o,{processImported:!1});return rt?(_e=(a=s.getManager())===null||a===void 0?void 0:a.importer)===null||_e===void 0?void 0:_e.processImported(rt):void 0}}class PE extends F1{constructor(){super(...arguments),this.name="MaterialLibraries"}async apply(s,o){const a=await super.apply(s,o);return a&&await s.alert("Material Library successfully imported."),a}}class h0 extends io{constructor(){super(...arguments),this.toJSON=null,this.enabled=!0,this.presetGroups=[],this.uiConfig={type:"folder",label:"Presets",expanded:!0,limitedUi:!0,children:[()=>this.presetGroups.map(s=>({type:"dropdown",label:s.name,limitedUi:!0,children:[{value:"",label:"none"},...s.presets.map(o=>({label:o.path.split("/").pop(),value:o.path}))],getValue:()=>{var o;return((o=s.selected)===null||o===void 0?void 0:o.path)||""},setValue:o=>{s.apply(this._viewer,s.presets.find(a=>a.path===o))}})),{type:"button",label:"Download Selection",limitedUi:!0,value:()=>{const s=this.exportPresets();_f(new File([JSON.stringify(s,null,2)],"preset.template.json",{type:"application/json"}))}},{type:"button",label:"Export Preset Groups",hidden:!0,limitedUi:!1,value:()=>{const s=this.exportPresetGroups();_f(new File([JSON.stringify(s,null,2)],"presetGroups.json",{type:"application/json"}))}}]}}async onAdded(s){var o,a;await super.onAdded(s),this.presetGroups.push(new XM),this.presetGroups.push(new JM),this.presetGroups.push(new ZM),this.presetGroups.push(new F1("Ground")),this.presetGroups.push(new F1("CameraViews")),this.presetGroups.push(new F1("MaterialConfiguration")),this.presetGroups.push(new PE),(a=(o=this.uiConfig).uiRefresh)===null||a===void 0||a.call(o,"postFrame",!0)}exportPresets(){const s=Object.fromEntries(this.presetGroups.map(o=>{var a;return[o.name,((a=o.selected)===null||a===void 0?void 0:a.path)||void 0]}).filter(([,o])=>o));return s.type=h0.PluginType,s}async fromJSON(s,o){var a,_e;if(!super.fromJSON(s,o))return null;const rt={...s};delete rt.type;const nt=[];for(const[ot,ct]of Object.entries(rt)){const pt=this.presetGroups.find(Et=>Et.name===ot),ht=pt==null?void 0:pt.presets;if(!pt||!ht)continue;const _t=typeof ct=="string"?{path:ct}:ct;nt.push(pt.apply(this._viewer,_t))}return await Promise.all(nt),(_e=(a=this.uiConfig).uiRefresh)===null||_e===void 0||_e.call(a,"postFrame",!0),this}loadPresetGroups(s){var o;for(const[a,_e]of Object.entries(s)){const rt=(o=this.presetGroups.find(nt=>nt.name===a))===null||o===void 0?void 0:o.presets;rt==null||rt.push(..._e)}}exportPresetGroups(){return Object.fromEntries(this.presetGroups.map(s=>[s.name,s.presets.map(o=>o.path)]).filter(([,s])=>s.length>0))}}h0.PluginType="PresetLibraryPlugin";var v_=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let xm=class extends io{constructor(){super(),this.enabled=!0,this.dependencies=[os],this.scenes=[],this.assets={},this.toJSON=void 0,this._isPlaying=!1,this._isPlayingLoop=!1,this._options={},this.minSceneTime=2e3,this.loadScenes=this.loadScenes.bind(this),this.play=this.play.bind(this),this.stop=this.stop.bind(this),this.downloadScenes=this.downloadScenes.bind(this),this.promptLoadScenes=this.promptLoadScenes.bind(this)}get loadedScenes(){return this.scenes.length}async promptLoadScenes(){const tt=await B_(!0,!1,"model/gltf");await this.loadScenes(tt)}async loadScenes(tt){var s,o;const a=await Promise.all(tt.map(async _e=>await _e.arrayBuffer()));for(let _e=0;_e<tt.length;_e++){const rt=tt[_e];this.scenes.push({[rt.name]:new Uint8Array(a[_e])}),this.assets[rt.name]={path:rt.name,file:rt}}(o=(s=this.uiConfig)===null||s===void 0?void 0:s.uiRefresh)===null||o===void 0||o.call(s)}async play(){var tt;if(!this._viewer||this._isPlaying||this._isPlayingLoop)return;this._isPlaying=!0,this._isPlayingLoop=!0;const s=this._viewer.getPluginByType("AssetManagerBasicPopupPlugin");s==null||s.enabled,s&&(s.enabled=!1);const o=this._viewer.getPluginByType("FrameFade"),a=this._viewer.getPluginByType("GLTFAnimation"),_e=this._viewer.getPluginByType("CameraViews");for(;this._isPlaying;)for(const rt of this.scenes){if(!this._isPlaying)break;const nt=Object.keys(rt);a==null||a.stopAnimation(!1),await(_e==null?void 0:_e.stopAllAnimations()),this._viewer.scene.removeSceneModels(),this._viewer.renderEnabled=!1;for(const ct of nt){let pt=this.assets[ct];pt||(pt={path:ct,file:new File([rt[ct]],ct)},this.assets[ct]=pt),await((tt=this._viewer.getManager())===null||tt===void 0?void 0:tt.addAssetSingle(pt,this._options))}if(!this._isPlaying)break;this._viewer.renderEnabled=!0,s&&(s.enabled=!1),o&&(o.enabled=!0,await o.startTransition(1e3));const ot=[mu(this.minSceneTime)];a&&ot.push(a.playAnimation()),_e&&ot.push(_e.animateAllViews()),await Promise.all(ot)}this._isPlayingLoop=!1}stop(){this._isPlaying=!1}async downloadScenes(){const tt={};for(const o of this.scenes)for(const a of Object.keys(o)){const _e=tt[a]?a+"_":a;tt[_e]=o[_e]}const s=QT(tt);Nu(new Blob([s],{type:"application/zip"}),"scenes.glbloop")}async onAdded(tt){await super.onAdded(tt);const s=this;mo.Importers.push(new Yl(class extends Nx{load(o,a,_e,rt){super.load(o,nt=>{s.loadScenes([...nt.values()]),a==null||a(null),mu(100).then(s.play)},_e,rt)}},["glbloop"],!0))}};xm.PluginType="SceneLoopPlugin",v_([Hm("Loaded scenes")],xm.prototype,"loadedScenes",null),v_([Qo("Load Scenes")],xm.prototype,"promptLoadScenes",null),v_([Hm("Playing")],xm.prototype,"_isPlaying",void 0),v_([yo("Min Scene Time")],xm.prototype,"minSceneTime",void 0),v_([Qo("Play")],xm.prototype,"play",null),v_([Qo("Stop")],xm.prototype,"stop",null),v_([Qo("Download Scenes")],xm.prototype,"downloadScenes",null),xm=v_([Ao("Scene Loop")],xm);var eR=__webpackgi_require__(701),zC=__webpackgi_require__.n(eR),CP=__webpackgi_require__(236),DE=__webpackgi_require__.n(CP),tR=__webpackgi_require__(850),VC=__webpackgi_require__.n(tR),BE=__webpackgi_require__(182),U1=__webpackgi_require__.n(BE),TP=__webpackgi_require__(213),GC=__webpackgi_require__.n(TP),kE=__webpackgi_require__(798),pw={};kE.Z&&kE.Z.locals&&(pw.locals=kE.Z.locals);var OE,f0=0,oA={};oA.styleTagTransform=GC(),oA.setAttributes=VC(),oA.insert=function(tt,s){(s.target||document.head).appendChild(tt)},oA.domAPI=DE(),oA.insertStyleElement=U1(),pw.use=function(tt){return oA.options=tt||{},f0++||(OE=zC()(kE.Z,oA)),pw},pw.unuse=function(){f0>0&&!--f0&&(OE(),OE=null)};var LE,rR=pw,ay=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let m0=LE=class extends io{constructor(){super(),this.enabled=!0,this.dependencies=[os],this._popupDiv=Ll({id:"assetManagerPopup",addToBody:!1,innerHTML:""});const tt=Ll({id:"assetManagerPopupClose",addToBody:!1,innerHTML:"&#10005"});tt.addEventListener("click",()=>{this._popupDiv.style.display="none"}),this._popupContent=Ll({id:"assetManagerPopupContent",addToBody:!1,innerHTML:""}),this.enabled||(this._popupDiv.style.display="none"),this._popupDiv.appendChild(tt),this._popupDiv.appendChild(this._popupContent)}_onEnabledChange(){this.enabled||(this._popupDiv.style.display="none")}_updatePopupDiv(tt){if(!this._popupContent)return;if(!this.enabled)return void(this._popupDiv.style.display="none");let s="";tt.forEach((o,a)=>{s+=`<span class="processState">${o.state}</span>: ${a.split("/").pop()} ${o.progress?" - "+o.progress:""}<br>`}),this._popupContent.innerHTML=s,tt.size===0?this._popupDiv.style.display="none":this._popupDiv.style.display="block"}async onAdded(tt){var s,o,a,_e;await super.onAdded(tt),rR.use({target:tt.container}),tt.container.appendChild(this._popupDiv);const rt=new Map;(o=(s=tt.getManager())===null||s===void 0?void 0:s.importer)===null||o===void 0||o.addEventListener("importFile",nt=>{nt.state!=="done"?rt.set(nt.path,{state:nt.state,progress:nt.progress?(100*nt.progress).toFixed(0)+"%":void 0}):rt.delete(nt.path),this._updatePopupDiv(rt)}),(_e=(a=tt.getManager())===null||a===void 0?void 0:a.exporter)===null||_e===void 0||_e.addEventListener("exportFile",nt=>{nt.state!=="done"?rt.set(nt.obj.name,{state:nt.state,progress:nt.progress?(100*nt.progress).toFixed(0)+"%":void 0}):rt.delete(nt.obj.name),this._updatePopupDiv(rt)})}};m0.PluginType="AssetManagerBasicPopupPlugin",ay([ds("Enabled"),vr(LE.prototype._onEnabledChange),Yr()],m0.prototype,"enabled",void 0),m0=LE=ay([Ao("Asset manager popup")],m0);class MP extends Ru{constructor(s){super({vertexShader:ut.vertexShader,uniforms:{tDiffuse:{value:null}},defines:{},fragmentShader:`
                varying vec2 vUv;
                ${s[0]}
                void main() {
                    gl_FragColor = tDiffuseTexelToLinear (texture2D(tDiffuse, vUv));
                    #glMarker
                    ${s[1]}
                }
                `},"tDiffuse"),this.uiConfig=void 0,this.customMaterial=new L_}render(s,o,a,_e,rt){super.render(s,o,a,_e,rt),this.needsSwap=!0}}class Lp extends Mv{constructor(s=!0,o=!0){super(),this.depthTonemap=s,this.passId="combinedPost",this.dependencies=[Dl],this.toJSON=void 0,this._beforeFilters=[],this._afterFilters=["render"],this._requiredFilters=["render"],this._renderToScreen=!0,this._setDirty=this._setDirty.bind(this),this._renderToScreen=o}get renderToScreen(){return this._renderToScreen}async onAdded(s){var o,a;return!((a=(o=this._viewer)===null||o===void 0?void 0:o.screenShader)===null||a===void 0)&&a.isShaderPass2&&(this._renderToScreen=!1),this._renderToScreen&&dr(s.renderer.passes.find(_e=>_e.passId==="screen"),"enabled",!1,!0,!0),super.onAdded(s)}passCtor(s){var o,a,_e,rt;const nt=s.screenShader,ot=["",""];this._renderToScreen&&!nt.isShaderPass2&&(ot[0]=Array.isArray(nt)?nt[0]:((o=nt)===null||o===void 0?void 0:o.pars)||"",ot[1]=Array.isArray(nt)?nt[1]:typeof nt=="string"?nt:((a=nt)===null||a===void 0?void 0:a.main)||"");const ct=new MP(ot);return dr((rt=(_e=ct.uiConfig)===null||_e===void 0?void 0:_e.children)===null||rt===void 0?void 0:rt.find(pt=>{var ht;return((ht=pt)===null||ht===void 0?void 0:ht.label)==="Enabled"}),"hidden",!0,!0),ct}_update(s){var o;return!!super._update(s)&&(this._pass.passObject.updateShaderProperties((o=this._viewer)===null||o===void 0?void 0:o.getPlugin(Dl)),!0)}_setDirty(){this.pass&&(this.pass.dirty=!0)}get uiConfig(){var s,o,a;return(a=(o=(s=this.pass)===null||s===void 0?void 0:s.passObject)===null||o===void 0?void 0:o.uiConfig)!==null&&a!==void 0?a:{}}addExtension(s){this.pass.passObject.material.registerMaterialExtensions([s])}}Lp.PluginType="CombinedPostPlugin";var nR=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};class g0 extends io{constructor(){super(...arguments),this.enabled=!0,this.dependencies=[Lp]}get uiConfig(){var s;return(s=this._extension)===null||s===void 0?void 0:s.uiConfig}get config(){return this._extension}disposeExtension(){}async onAdded(s){var o;await super.onAdded(s),this._extension=this.generateExtension(s),(o=s.getPlugin(Lp))===null||o===void 0||o.addExtension(this._extension)}async onRemove(s){this.disposeExtension(),this._extension=void 0,await super.onRemove(s)}}nR([Yr("extension")],g0.prototype,"_extension",void 0),nR([Yr()],g0.prototype,"enabled",void 0);class ly{constructor(){this.uiConfig=void 0,this.enabled=!0}shaderExtender(s,o,a){this.enabled&&(s.fragmentShader=Wl(s.fragmentShader,"#glMarker",` 
            gl_FragColor = LinearTosRGB(gl_FragColor);
            #glMarker
        `))}computeCacheKey(s){return this.enabled?"1":"0"}isCompatible(s){return!0}}class NE extends g0{generateExtension(s){return new ly}}NE.PluginType="GammaCorrection";var $1,Uv=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};const iR=et.dZ3;let uy=$1=class{constructor(tt,s=!0,o=!0){this.depthTonemap=s,this.toneMapping=et.LY2,this.tonemapBackground=!0,this.clipBackground=!1,this.exposure=1,this._renderToScreen=!0,this.enabled=!0,this._rendererState={},this.extraUniforms={tNormalDepth:{value:null},tGBufferFlags:{value:null},opacity:{value:1}},this.parsFragmentSnippet=(a,_e)=>this.enabled?Wt`
            ${this.depthTonemap?Zv:""}
            #define USE_DEPTH_TONEMAP ${this.depthTonemap?"1":"0"}
            uniform float opacity;
            ${`vec4 ToneMapping(in vec4 color){vec4 outColor=opacity*color;
#if USE_DEPTH_TONEMAP > 0
bool doTonemap=getGBufferFlags(vUv).x>0.5;float depth=getDepth(vUv);
#if TONEMAP_BACKGROUND < 1 || TRANSPARENT_BACKGROUND > 0
bool isBackground=depth>0.9999;if(isBackground)doTonemap=false;
#endif
if(doTonemap){
#endif
#if defined( TONE_MAPPING )
outColor.rgb=toneMapping(outColor.rgb);
#endif
#if USE_DEPTH_TONEMAP > 0
}else{
#if TRANSPARENT_BACKGROUND > 0
if(isBackground)outColor.a=0.;
#endif
}if(depth<0.00001)outColor.a=0.;
#endif
return outColor;}`}
        `:"",this._combinedPostPlugin=tt.getPlugin(Lp),this._setDirty=this._setDirty.bind(this),this._renderToScreen=o,this.depthTonemap=s}shaderExtender(tt,s,o){this.enabled&&(tt.fragmentShader=Wl(tt.fragmentShader,"#glMarker",` 
            gl_FragColor = ToneMapping(gl_FragColor);
            #glMarker
        `))}onObjectRender(tt,s,o){if(!this.enabled)return;const{toneMapping:a,toneMappingExposure:_e,outputEncoding:rt}=o;this._rendererState.toneMapping=a,this._rendererState.toneMappingExposure=_e,this._rendererState.outputEncoding=rt;let nt=this.tonemapBackground?"1":"0";s.materialObject.defines.TONEMAP_BACKGROUND!==nt&&(s.materialObject.defines.TONEMAP_BACKGROUND=nt,s.materialObject.needsUpdate=!0),nt=this.clipBackground?"1":"0",s.materialObject.defines.TRANSPARENT_BACKGROUND!==nt&&(s.materialObject.defines.TRANSPARENT_BACKGROUND=nt,s.materialObject.needsUpdate=!0),o.toneMapping=this.toneMapping,o.toneMappingExposure=this.exposure,o.outputEncoding=et.knz,s.materialObject.toneMapped=!0,s.materialObject.needsUpdate=!0}onAfterRender(tt,s,o){o.toneMapping=this._rendererState.toneMapping,o.toneMappingExposure=this._rendererState.toneMappingExposure,o.outputEncoding=this._rendererState.outputEncoding}getUiConfig(){return this.uiConfig}computeCacheKey(tt){return this.enabled?"1":"0"}isCompatible(tt){return!0}_setDirty(){this._combinedPostPlugin&&(this._combinedPostPlugin.pass.dirty=!0)}setDirty(){this._setDirty()}};uy.PluginType="Tonemap",Uv([Mp("Mode",[["Linear",et.EoG],["Reinhard",et.CdI],["Cineon",et.YGz],["ACESFilmic",et.LY2],["Uncharted2",iR]].map(tt=>({label:tt[0],value:tt[1]})),{limitedUi:!0}),vr($1.prototype._setDirty),Yr()],uy.prototype,"toneMapping",void 0),Uv([ds("Tonemap Background",{limitedUi:!0}),Yr()],uy.prototype,"tonemapBackground",void 0),Uv([vr($1.prototype._setDirty),ds("Clip Background"),Yr()],uy.prototype,"clipBackground",void 0),Uv([vr($1.prototype._setDirty),gs("Exposure",[0,2*Math.PI],.01,{limitedUi:!0}),Yr()],uy.prototype,"exposure",void 0),uy=$1=Uv([Ao("Tonemapping")],uy);class j1 extends g0{constructor(s=!0){super(),this.depthTonemap=s,this.depthTonemap=s}fromJSON(s,o){return s.pass&&((s={...s}).extension={...s.pass},delete s.extension.enabled,delete s.pass),super.fromJSON(s,o)}generateExtension(s){return new uy(s,this.depthTonemap)}get exposure(){var s,o;return(o=(s=this._extension)===null||s===void 0?void 0:s.exposure)!==null&&o!==void 0?o:1}set exposure(s){this._extension&&(this._extension.exposure=s,this._extension.setDirty())}get toneMapping(){var s,o;return(o=(s=this._extension)===null||s===void 0?void 0:s.toneMapping)!==null&&o!==void 0?o:et.EoG}set toneMapping(s){this._extension&&(this._extension.toneMapping=s,this._extension.setDirty())}}j1.PluginType="Tonemap",et.WdD.tonemapping_pars_fragment=et.WdD.tonemapping_pars_fragment.replace("vec3 CustomToneMapping( vec3 color ) { return color; }",`

// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {

	// John Hable's filmic operator from Uncharted 2 video game
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( 1.0 ) ) );

}

vec3 CustomToneMapping( vec3 color ) { return Uncharted2ToneMapping( color ); }

`);var z1,hw=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let fw=z1=class{constructor(tt){this.enabled=!1,this.intensity=1,this.lutMap=void 0,this.extraUniforms={intensity:{value:1},lutSize:{value:1}},this.parsFragmentSnippet=(s,o)=>this.enabled?`#if USE_LUT == 1
uniform float lutSize;uniform float intensity;
#if USE_3DTEXTURE == 1
precision highp sampler3D;uniform sampler3D lut3d;
#else
uniform sampler2D lut;vec3 lutLookup(sampler2D tex,float size,vec3 rgb){float sliceHeight=1./size;float yPixelHeight=1./(size*size);float slice=rgb.b*size;float interp=fract(slice);float slice0=slice-interp;float centeredInterp=interp-0.5;float slice1=slice0+sign(centeredInterp);float greenOffset=clamp(rgb.g*sliceHeight,yPixelHeight*0.5,sliceHeight-yPixelHeight*0.5);vec2 uv0=vec2(rgb.r,slice0*sliceHeight+greenOffset);vec2 uv1=vec2(rgb.r,slice1*sliceHeight+greenOffset);vec3 sample0=texture2D(tex,uv0).rgb;vec3 sample1=texture2D(tex,uv1).rgb;return mix(sample0,sample1,abs(centeredInterp));}
#endif
vec4 colorLookUp(in vec4 color){vec4 outColor;float pixelWidth=1./lutSize;float halfPixelWidth=0.5/lutSize;vec3 uvw=vec3(halfPixelWidth)+color.rgb*(1.-pixelWidth);float lutFac=step(0.0001,getGBufferFlags(vUv).a);
#if USE_3DTEXTURE == 1
outColor=vec4(texture(lut3d,uvw).rgb,color.a);
#else
outColor=vec4(lutLookup(lut,lutSize,uvw),color.a);
#endif
outColor=mix(color,outColor,lutFac);return vec4(mix(color,outColor,intensity));}
#endif
`:"",this._combinedPostPlugin=tt.getPlugin(Lp),this._setDirty=this._setDirty.bind(this)}shaderExtender(tt,s,o){this.enabled&&(tt.fragmentShader=Wl(tt.fragmentShader,"#glMarker",` 
            #if USE_LUT == 1
                gl_FragColor = colorLookUp(gl_FragColor);
            #endif
            #glMarker
        `))}onObjectRender(tt,s,o){if(this.enabled)if(this.lutMap){const a=this.lutMap.texture3D?1:0;s.materialObject.defines.USE_3DTEXTURE!==a&&(s.materialObject.defines.USE_3DTEXTURE=a,s.materialObject.needsUpdate=!0);let _e=1;this.lutMap.texture3D?(s.materialObject.uniforms.lut3d={value:this.lutMap.texture3D},s.materialObject.uniforms.lut3d.value.needsUpdate=!0,_e=this.lutMap.texture3D.image.width):this.lutMap.texture&&(s.materialObject.uniforms.lut={value:this.lutMap.texture},s.materialObject.uniforms.lut.value.needsUpdate=!0,_e=this.lutMap.texture.image.width),s.materialObject.uniforms.lutSize.value=_e,s.materialObject.uniforms.intensity.value=this.intensity,s.materialObject.defines.USE_LUT=1}else s.materialObject.defines.USE_3DTEXTURE=0,s.materialObject.defines.USE_LUT=0,s.materialObject.needsUpdate=!0}getUiConfig(){return this.uiConfig}computeCacheKey(tt){return this.enabled?"1":"0"}isCompatible(tt){return!0}_setDirty(){this._combinedPostPlugin&&(this._combinedPostPlugin.pass.dirty=!0)}};hw([Yr(),vr(z1.prototype._setDirty),ds("Enable")],fw.prototype,"enabled",void 0),hw([Yr(),vr(z1.prototype._setDirty),gs("Intensity")],fw.prototype,"intensity",void 0),hw([vr(z1.prototype._setDirty),By("LUT"),Yr()],fw.prototype,"lutMap",void 0),fw=z1=hw([Ao("LUT")],fw);class FE extends g0{generateExtension(s){return new fw(s)}}FE.PluginType="LUT";var V1,Fo=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let aA=V1=class{constructor(tt){this.enabled=!1,this.power=.5,this.bgcolor=new et.Ilk(0),this.extraUniforms={power:{value:1},bgcolor:{value:new et.Ilk}},this.parsFragmentSnippet=(s,o)=>this.enabled?Wt`
            uniform float power;
            uniform vec3 bgcolor;
            ${"vec4 Vignette(in vec4 color){vec2 uv=vUv*(1.-vUv);float vig=uv.x*uv.y*16.;vig=pow(vig,power);return vec4(mix(color.rgb,vec3(bgcolor),1.-vig),color.a);}"}
        `:"",this._combinedPostPlugin=tt.getPlugin(Lp),this._setDirty=this._setDirty.bind(this)}shaderExtender(tt,s,o){this.enabled&&(tt.fragmentShader=Wl(tt.fragmentShader,"#glMarker",` 
            gl_FragColor = Vignette(gl_FragColor);
            #glMarker
        `))}onObjectRender(tt,s,o){this.enabled&&(s.materialObject.uniforms.power.value=this.power,s.materialObject.uniforms.bgcolor.value.copy(this.bgcolor))}getUiConfig(){return this.uiConfig}computeCacheKey(tt){return this.enabled?"1":"0"}isCompatible(tt){return!0}_setDirty(){this._combinedPostPlugin&&(this._combinedPostPlugin.pass.dirty=!0)}setDirty(){this._setDirty()}};aA.PluginType="Vignette",Fo([vr(V1.prototype._setDirty),ds("Enable"),Yr()],aA.prototype,"enabled",void 0),Fo([vr(V1.prototype._setDirty),gs("Power",[.1,4],.01,{limitedUi:!0}),Yr()],aA.prototype,"power",void 0),Fo([vr(V1.prototype._setDirty),vv("Color"),Yr()],aA.prototype,"bgcolor",void 0),aA=V1=Fo([Ao("Vignette")],aA);class UE extends g0{constructor(){super()}generateExtension(s){return new aA(s)}get power(){var s,o;return(o=(s=this._extension)===null||s===void 0?void 0:s.power)!==null&&o!==void 0?o:1}set power(s){this._extension&&(this._extension.power=s,this._extension.setDirty())}get color(){var s,o;return(o=(s=this._extension)===null||s===void 0?void 0:s.bgcolor)!==null&&o!==void 0?o:new et.Ilk}set color(s){this._extension&&(this._extension.bgcolor.copy(s),this._extension.setDirty())}}UE.PluginType="Vignette";var $E,QC=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let cy=$E=class{constructor(tt){this.enabled=!1,this.aberrationIntensity=.01,this.extraUniforms={aberrationIntensity:{value:1}},this.parsFragmentSnippet=(s,o)=>this.enabled?Wt`
            uniform float aberrationIntensity;
            ${"vec4 chromaticAberration(){vec2 distFromCenter=vUv-0.5;vec2 aberrated=aberrationIntensity*pow(distFromCenter,vec2(2.));vec4 color=tDiffuseTexelToLinear(texture2D(tDiffuse,vUv));vec4 outColor=vec4(tDiffuseTexelToLinear(texture2D(tDiffuse,vUv+aberrated)).r,color.g,tDiffuseTexelToLinear(texture2D(tDiffuse,vUv-aberrated)).b,color.a);return outColor;}"}
        `:"",this._combinedPostPlugin=tt.getPlugin(Lp),this._setDirty=this._setDirty.bind(this)}shaderExtender(tt,s,o){this.enabled&&(tt.fragmentShader=Wl(tt.fragmentShader,"#glMarker",` 
            gl_FragColor = chromaticAberration();
            #glMarker
        `))}onObjectRender(tt,s,o){this.enabled&&(s.materialObject.uniforms.aberrationIntensity.value=this.aberrationIntensity)}getUiConfig(){return this.uiConfig}computeCacheKey(tt){return this.enabled?"1":"0"}isCompatible(tt){return!0}_setDirty(){this._combinedPostPlugin&&(this._combinedPostPlugin.pass.dirty=!0)}setDirty(){this._setDirty()}};cy.PluginType="ChromaticAberration",QC([vr($E.prototype._setDirty),ds("Enable"),Yr()],cy.prototype,"enabled",void 0),QC([vr($E.prototype._setDirty),gs("Intensity",[0,.1],.001,{limitedUi:!0}),Yr()],cy.prototype,"aberrationIntensity",void 0),cy=$E=QC([Ao("ChromaticAberration")],cy);class jE extends g0{constructor(){super()}generateExtension(s){return new cy(s)}get intensity(){var s,o;return(o=(s=this._extension)===null||s===void 0?void 0:s.aberrationIntensity)!==null&&o!==void 0?o:1}set intensity(s){this._extension&&(this._extension.aberrationIntensity=s,this._extension.setDirty())}}jE.PluginType="ChromaticAberration";var G1,zE=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let mw=G1=class{constructor(tt){this.enabled=!1,this.grainMultiply=!1,this.grainIntensity=10,this.extraUniforms={grainIntensity:{value:1},grainMultiply:{value:1}},this.parsFragmentSnippet=(s,o)=>this.enabled?Wt`
            uniform float grainIntensity;
            uniform bool grainMultiply;
            ${"vec4 grain(in vec4 color){float x=(vUv.x+4.)*(vUv.y+4.)*(10.);vec4 grain=vec4(mod((mod(x,13.)+1.)*(mod(x,123.)+1.),0.01)-0.005)*grainIntensity;vec4 outColor=color;if(grainMultiply){grain=1.-grain;outColor.rgb=color.rgb*vec3(grain);}else{outColor.rgb=color.rgb+vec3(grain);}return outColor;}"}
        `:"",this._combinedPostPlugin=tt.getPlugin(Lp),this._setDirty=this._setDirty.bind(this)}shaderExtender(tt,s,o){this.enabled&&(tt.fragmentShader=Wl(tt.fragmentShader,"#glMarker",` 
            gl_FragColor = grain(gl_FragColor);
            #glMarker
        `))}onObjectRender(tt,s,o){this.enabled&&(s.materialObject.uniforms.grainIntensity.value=this.grainIntensity,s.materialObject.uniforms.grainMultiply.value=this.grainMultiply)}getUiConfig(){return this.uiConfig}computeCacheKey(tt){return this.enabled?"1":"0"}isCompatible(tt){return!0}_setDirty(){this._combinedPostPlugin&&(this._combinedPostPlugin.pass.dirty=!0)}setDirty(){this._setDirty()}};zE([vr(G1.prototype._setDirty),ds("Enable"),Yr()],mw.prototype,"enabled",void 0),zE([vr(G1.prototype._setDirty),ds("Multiply"),Yr()],mw.prototype,"grainMultiply",void 0),zE([vr(G1.prototype._setDirty),gs("Intensity",[0,20],.01,{limitedUi:!0}),Yr()],mw.prototype,"grainIntensity",void 0),mw=G1=zE([Ao("FilmicGrain")],mw);class VE extends g0{constructor(){super()}generateExtension(s){return new mw(s)}get intensity(){var s,o;return(o=(s=this._extension)===null||s===void 0?void 0:s.grainIntensity)!==null&&o!==void 0?o:1}set intensity(s){this._extension&&(this._extension.grainIntensity=s,this._extension.setDirty())}get multiply(){var s,o;return(o=(s=this._extension)===null||s===void 0?void 0:s.grainMultiply)!==null&&o!==void 0&&o}set multiply(s){this._extension&&(this._extension.grainMultiply=s,this._extension.setDirty())}}async function GE(tt,{ground:s=!0,bloom:o=!0,depthTonemap:a=!0,enableDrop:_e=!1}={}){await tt.addPlugin(Dl),await tt.addPlugin(hu),_e&&await tt.addPlugin(Jw),await tt.addPlugin(new _p(32)),await tt.addPlugin(new Lp),await tt.addPlugin(new jE),await tt.addPlugin(new j1(a||!tt.useRgbm)),await tt.addPlugin(new FE),await tt.addPlugin(new UE),await tt.addPlugin(new VE),await tt.addPlugin(new NE),await tt.addPlugin(Qx),await tt.addPlugin(qx),await tt.addPlugin(ru),await tt.addPlugin(i0),await tt.addPlugin(Gl),s&&await tt.addPlugin(_m),o&&await tt.addPlugin(iy),await tt.addPlugin(Am),await tt.addPlugin(km),await tt.addPlugin(yp),await tt.addPlugin(lp),await tt.addPlugin(rv),await tt.addPlugin(R1,!1),await tt.addPlugin(I1),await tt.addPlugin(gu),await tt.addPlugin(a0,!1),await tt.addPlugin(wm,!1),await tt.addPlugin(c0,!1),await tt.addPlugin(Du,!1),await tt.addPlugin(jC),await tt.addPlugin(h0),await tt.addPlugin(xm)}async function QE(tt,{debug:s=!1,ground:o=!0,bloom:a=!0,depthTonemap:_e=!1,importPopup:rt=!0,enableDrop:nt=!1}={}){var ot;const ct=new _g(tt);s&&await ct.addPlugin(Ov);const pt=await ct.addPlugin(os,void 0,void 0,{storage:caches?await caches.open("webgi-cache-storage"):void 0});return rt&&await ct.addPlugin(m0),await GE(ct,{ground:o,bloom:a,depthTonemap:_e,enableDrop:nt}),ct.renderer.refreshPipeline(),(ot=pt.importer)===null||ot===void 0||ot.processors.add("model",{forAssetType:"model",process:(ht,_t)=>ht}),ct}VE.PluginType="FilmicGrain";let RP=0;class sR extends HTMLElement{constructor(){super(),this._initialized=!1,this._state={src:"",environment:""},this._models={},this._refreshingModels=!1,this._refreshingEnvironment=!1,this.viewerIndex=RP++,this.canvasId="webgi-viewer-"+this.viewerIndex,this.attachShadow({mode:"open"}),this.wrapper=document.createElement("div"),this.wrapper.style.width="100%",this.wrapper.style.height="100%",this.wrapper.style.display="block",this.canvas=D_(),this.canvas.setAttribute("id",this.canvasId);const s=document.createElement("style");s.textContent=Zt`
            #${this.canvasId}{
              width: 100%; height: 100%; z-index: 1;
              display: block;
            }
        `,this.wrapper.append(this.canvas),this.shadowRoot.append(s,this.wrapper),this._initialize().then(async()=>this.refreshAll())}async refreshAll(){await Promise.all([this.refreshModelSource(),this.refreshEnvironment()])}async _initialize(){this._initialized||(this.viewer=await QE({canvas:this.canvas,useRgbm:this._getAttr("rgbm","true")==="true",useGBufferDepth:this._getAttr("depth-prepass","true")==="true"},{debug:this._getAttr("debug","false")==="true",ground:this._getAttr("ground","baked")==="baked",bloom:this._getAttr("bloom","true")==="true",depthTonemap:!0}),this._initialized=!0,this.dispatchEvent(new Event("initialized")))}connectedCallback(){console.log("WebGiViewerElement added to page."),this.viewer&&(this.viewer.resize(),this.viewer.enabled=!0)}disconnectedCallback(){console.log("WebGiViewerElement removed from page."),this.viewer&&(this.viewer.enabled=!1)}adoptedCallback(){console.log("WebGiViewerElement moved to new page."),this.viewer&&(this.viewer.resize(),this.viewer.enabled=!0)}static get observedAttributes(){return["src","environment"]}attributeChangedCallback(s,o,a){console.log("WebGiViewerElement attributes changed.",s,o,a),this.refreshAll()}clearModels(){}async refreshModelSource(){if(!this.viewer)return;const s=this._getAttr("src","");if(s===this._state.src||this._refreshingModels)return;this._refreshingModels=!0;const o=[s],a=[],_e=[];for(const rt of o)!this._models[rt]&&rt&&(this._models[rt]=this.viewer.getManager().importer.importPath(rt,{autoScale:this._getAttr("auto-scale","true")==="true",autoCenter:this._getAttr("auto-center","true")==="true",processImported:!1}));for(const[rt,nt]of Object.entries(this._models))o.includes(rt)?a.push(nt):_e.push(nt);await Promise.all([Promise.all(a).then(async rt=>Promise.all(rt.map(async nt=>this.viewer.getManager().importer.processImported(nt)))).then(rt=>{for(const nt of rt)for(const ot of nt)ot&&ot.assetType==="model"&&this.viewer.scene.addSceneObject(ot)}),Promise.all(_e).then(rt=>{for(const nt of rt)for(const ot of nt)ot&&ot.assetType==="model"&&ot.modelObject.removeFromParent()})]),this._state.src=s,this._refreshingModels=!1}async refreshEnvironment(){if(!this.viewer)return;if(!this.hasAttribute("environment"))return void(this._state.environment=null);const s=this._getAttr("environment","");if(s===this._state.src||this._refreshingEnvironment)return;this._refreshingEnvironment=!0;const o=this.viewer.scene.getEnvironment(),a=s?await this.viewer.getManager().importer.importSinglePath(s):void 0;a&&a.assetType!=="texture"||await this.viewer.scene.setEnvironment(a),o==null||o.dispose(),this._state.environment=s,this._refreshingEnvironment=!1}_getAttr(s,o){return this.hasAttribute(s)?this.getAttribute(s):o}}window&&window.customElements&&!window.customElements.get("webgi-viewer")&&window.customElements.define("webgi-viewer",sR);class oR{constructor(s){var o,a,_e;this._basePath=(o=s==null?void 0:s.basePath)!==null&&o!==void 0?o:"",this._assets=(_e=(a=s==null?void 0:s.assets)===null||a===void 0?void 0:a.map(rt=>this._resolveAsset(rt)))!==null&&_e!==void 0?_e:[]}get basePath(){return this._basePath}get assets(){return this._assets}find(s){const o=this._assets.find(s);return o??void 0}_resolveAsset(s){return{...s,path:I0([this._basePath,s.path])}}}class IP extends it{constructor(...s){super(),this._assets=s}addAssetList(s){this._assets.push(s)}removeAssetList(s){const o=this._assets.indexOf(s);o>=0&&this._assets.splice(o,1)}async findAssetRegex(s){for(const o of this._assets){const a=o.find(_e=>{var rt,nt;return _e&&(s.test(_e.path)||s.test((nt=(rt=_e.file)===null||rt===void 0?void 0:rt.name)!==null&&nt!==void 0?nt:""))});if(a)return a}console.warn("Asset not found:",s)}async findAsset(s){return this.findAssetRegex(s.query)}async findAssetSimple(s,o=!1){return this.findAssetRegex(new RegExp(s,o?"i":""))}}var HC={},gw=function(tt){return URL.createObjectURL(new Blob([tt],{type:"text/javascript"}))},aR=function(tt){return new Worker(tt)};try{URL.revokeObjectURL(gw(""))}catch{gw=function(s){return"data:application/javascript;charset=UTF-8,"+encodeURI(s)},aR=function(s){return new Worker(s,{type:"module"})}}var ko=Uint8Array,up=Uint16Array,Np=Uint32Array,v0=new ko([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),dy=new ko([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Q1=new ko([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),qC=function(tt,s){for(var o=new up(31),a=0;a<31;++a)o[a]=s+=1<<tt[a-1];var _e=new Np(o[30]);for(a=1;a<30;++a)for(var rt=o[a];rt<o[a+1];++rt)_e[rt]=rt-o[a]<<5|a;return[o,_e]},lR=qC(v0,2),WC=lR[0],H1=lR[1];WC[28]=258,H1[258]=28;for(var YC=qC(dy,0),uR=YC[0],KC=YC[1],q1=new up(32768),Zl=0;Zl<32768;++Zl){var __=(43690&Zl)>>>1|(21845&Zl)<<1;__=(61680&(__=(52428&__)>>>2|(13107&__)<<2))>>>4|(3855&__)<<4,q1[Zl]=((65280&__)>>>8|(255&__)<<8)>>>1}var Lm=function(tt,s,o){for(var a=tt.length,_e=0,rt=new up(s);_e<a;++_e)++rt[tt[_e]-1];var nt,ot=new up(s);for(_e=0;_e<s;++_e)ot[_e]=ot[_e-1]+rt[_e-1]<<1;if(o){nt=new up(1<<s);var ct=15-s;for(_e=0;_e<a;++_e)if(tt[_e])for(var pt=_e<<4|tt[_e],ht=s-tt[_e],_t=ot[tt[_e]-1]++<<ht,Et=_t|(1<<ht)-1;_t<=Et;++_t)nt[q1[_t]>>>ct]=pt}else for(nt=new up(a),_e=0;_e<a;++_e)tt[_e]&&(nt[_e]=q1[ot[tt[_e]-1]++]>>>15-tt[_e]);return nt},_0=new ko(288);for(Zl=0;Zl<144;++Zl)_0[Zl]=8;for(Zl=144;Zl<256;++Zl)_0[Zl]=9;for(Zl=256;Zl<280;++Zl)_0[Zl]=7;for(Zl=280;Zl<288;++Zl)_0[Zl]=8;var y0=new ko(32);for(Zl=0;Zl<32;++Zl)y0[Zl]=5;var vu=Lm(_0,9,0),cR=Lm(_0,9,1),Eu=Lm(y0,5,0),W1=Lm(y0,5,1),HE=function(tt){for(var s=tt[0],o=1;o<tt.length;++o)tt[o]>s&&(s=tt[o]);return s},iv=function(tt,s,o){var a=s/8|0;return(tt[a]|tt[a+1]<<8)>>(7&s)&o},qE=function(tt,s){var o=s/8|0;return(tt[o]|tt[o+1]<<8|tt[o+2]<<16)>>(7&s)},vw=function(tt){return(tt/8|0)+(7&tt&&1)},Wp=function(tt,s,o){(s==null||s<0)&&(s=0),(o==null||o>tt.length)&&(o=tt.length);var a=new(tt instanceof up?up:tt instanceof Np?Np:ko)(o-s);return a.set(tt.subarray(s,o)),a},lA=function(tt,s,o){var a=tt.length;if(!a||o&&!o.l&&a<5)return s||new ko(0);var _e=!s||o,rt=!o||o.i;o||(o={}),s||(s=new ko(3*a));var nt=function(bs){var Cn=s.length;if(bs>Cn){var eo=new ko(Math.max(2*Cn,bs));eo.set(s),s=eo}},ot=o.f||0,ct=o.p||0,pt=o.b||0,ht=o.l,_t=o.d,Et=o.m,St=o.n,Mt=8*a;do{if(!ht){o.f=ot=iv(tt,ct,1);var It=iv(tt,ct+1,3);if(ct+=3,!It){var Nt=tt[(Dr=vw(ct)+4)-4]|tt[Dr-3]<<8,Bt=Dr+Nt;if(Bt>a){if(rt)throw"unexpected EOF";break}_e&&nt(pt+Nt),s.set(tt.subarray(Dr,Bt),pt),o.b=pt+=Nt,o.p=ct=8*Bt;continue}if(It==1)ht=cR,_t=W1,Et=9,St=5;else{if(It!=2)throw"invalid block type";var kt=iv(tt,ct,31)+257,Pt=iv(tt,ct+10,15)+4,qt=kt+iv(tt,ct+5,31)+1;ct+=14;for(var Kt=new ko(qt),nr=new ko(19),ir=0;ir<Pt;++ir)nr[Q1[ir]]=iv(tt,ct+3*ir,7);ct+=3*Pt;var fr=HE(nr),br=(1<<fr)-1,Tr=Lm(nr,fr,1);for(ir=0;ir<qt;){var Dr,Rr=Tr[iv(tt,ct,br)];if(ct+=15&Rr,(Dr=Rr>>>4)<16)Kt[ir++]=Dr;else{var Nr=0,Ir=0;for(Dr==16?(Ir=3+iv(tt,ct,3),ct+=2,Nr=Kt[ir-1]):Dr==17?(Ir=3+iv(tt,ct,7),ct+=3):Dr==18&&(Ir=11+iv(tt,ct,127),ct+=7);Ir--;)Kt[ir++]=Nr}}var kr=Kt.subarray(0,kt),Hr=Kt.subarray(kt);Et=HE(kr),St=HE(Hr),ht=Lm(kr,Et,1),_t=Lm(Hr,St,1)}if(ct>Mt){if(rt)throw"unexpected EOF";break}}_e&&nt(pt+131072);for(var Lr=(1<<Et)-1,en=(1<<St)-1,vn=ct;;vn=ct){var wn=(Nr=ht[qE(tt,ct)&Lr])>>>4;if((ct+=15&Nr)>Mt){if(rt)throw"unexpected EOF";break}if(!Nr)throw"invalid length/literal";if(wn<256)s[pt++]=wn;else{if(wn==256){vn=ct,ht=null;break}var pn=wn-254;if(wn>264){var Fn=v0[ir=wn-257];pn=iv(tt,ct,(1<<Fn)-1)+WC[ir],ct+=Fn}var Gn=_t[qE(tt,ct)&en],Qn=Gn>>>4;if(!Gn)throw"invalid distance";if(ct+=15&Gn,Hr=uR[Qn],Qn>3&&(Fn=dy[Qn],Hr+=qE(tt,ct)&(1<<Fn)-1,ct+=Fn),ct>Mt){if(rt)throw"unexpected EOF";break}_e&&nt(pt+131072);for(var Yn=pt+pn;pt<Yn;pt+=4)s[pt]=s[pt-Hr],s[pt+1]=s[pt+1-Hr],s[pt+2]=s[pt+2-Hr],s[pt+3]=s[pt+3-Hr];pt=Yn}}o.l=ht,o.p=vn,o.b=pt,ht&&(ot=1,o.m=Et,o.d=_t,o.n=St)}while(!ot);return pt==s.length?s:Wp(s,0,pt)},y_=function(tt,s,o){o<<=7&s;var a=s/8|0;tt[a]|=o,tt[a+1]|=o>>>8},_w=function(tt,s,o){o<<=7&s;var a=s/8|0;tt[a]|=o,tt[a+1]|=o>>>8,tt[a+2]|=o>>>16},WE=function(tt,s){for(var o=[],a=0;a<tt.length;++a)tt[a]&&o.push({s:a,f:tt[a]});var _e=o.length,rt=o.slice();if(!_e)return[A0,0];if(_e==1){var nt=new ko(o[0].s+1);return nt[o[0].s]=1,[nt,1]}o.sort(function(Kt,nr){return Kt.f-nr.f}),o.push({s:-1,f:25001});var ot=o[0],ct=o[1],pt=0,ht=1,_t=2;for(o[0]={s:-1,f:ot.f+ct.f,l:ot,r:ct};ht!=_e-1;)ot=o[o[pt].f<o[_t].f?pt++:_t++],ct=o[pt!=ht&&o[pt].f<o[_t].f?pt++:_t++],o[ht++]={s:-1,f:ot.f+ct.f,l:ot,r:ct};var Et=rt[0].s;for(a=1;a<_e;++a)rt[a].s>Et&&(Et=rt[a].s);var St=new up(Et+1),Mt=sv(o[ht-1],St,0);if(Mt>s){a=0;var It=0,Nt=Mt-s,Bt=1<<Nt;for(rt.sort(function(Kt,nr){return St[nr.s]-St[Kt.s]||Kt.f-nr.f});a<_e;++a){var kt=rt[a].s;if(!(St[kt]>s))break;It+=Bt-(1<<Mt-St[kt]),St[kt]=s}for(It>>>=Nt;It>0;){var Pt=rt[a].s;St[Pt]<s?It-=1<<s-St[Pt]++-1:++a}for(;a>=0&&It;--a){var qt=rt[a].s;St[qt]==s&&(--St[qt],++It)}Mt=s}return[new ko(St),Mt]},sv=function(tt,s,o){return tt.s==-1?Math.max(sv(tt.l,s,o+1),sv(tt.r,s,o+1)):s[tt.s]=o},XC=function(tt){for(var s=tt.length;s&&!tt[--s];);for(var o=new up(++s),a=0,_e=tt[0],rt=1,nt=function(ct){o[a++]=ct},ot=1;ot<=s;++ot)if(tt[ot]==_e&&ot!=s)++rt;else{if(!_e&&rt>2){for(;rt>138;rt-=138)nt(32754);rt>2&&(nt(rt>10?rt-11<<5|28690:rt-3<<5|12305),rt=0)}else if(rt>3){for(nt(_e),--rt;rt>6;rt-=6)nt(8304);rt>2&&(nt(rt-3<<5|8208),rt=0)}for(;rt--;)nt(_e);rt=1,_e=tt[ot]}return[o.subarray(0,a),s]},yw=function(tt,s){for(var o=0,a=0;a<s.length;++a)o+=tt[a]*s[a];return o},Y1=function(tt,s,o){var a=o.length,_e=vw(s+2);tt[_e]=255&a,tt[_e+1]=a>>>8,tt[_e+2]=255^tt[_e],tt[_e+3]=255^tt[_e+1];for(var rt=0;rt<a;++rt)tt[_e+rt+4]=o[rt];return 8*(_e+4+a)},JC=function(tt,s,o,a,_e,rt,nt,ot,ct,pt,ht){y_(s,ht++,o),++_e[256];for(var _t=WE(_e,15),Et=_t[0],St=_t[1],Mt=WE(rt,15),It=Mt[0],Nt=Mt[1],Bt=XC(Et),kt=Bt[0],Pt=Bt[1],qt=XC(It),Kt=qt[0],nr=qt[1],ir=new up(19),fr=0;fr<kt.length;++fr)ir[31&kt[fr]]++;for(fr=0;fr<Kt.length;++fr)ir[31&Kt[fr]]++;for(var br=WE(ir,7),Tr=br[0],Dr=br[1],Rr=19;Rr>4&&!Tr[Q1[Rr-1]];--Rr);var Nr,Ir,kr,Hr,Lr=pt+5<<3,en=yw(_e,_0)+yw(rt,y0)+nt,vn=yw(_e,Et)+yw(rt,It)+nt+14+3*Rr+yw(ir,Tr)+(2*ir[16]+3*ir[17]+7*ir[18]);if(Lr<=en&&Lr<=vn)return Y1(s,ht,tt.subarray(ct,ct+pt));if(y_(s,ht,1+(vn<en)),ht+=2,vn<en){Nr=Lm(Et,St,0),Ir=Et,kr=Lm(It,Nt,0),Hr=It;var wn=Lm(Tr,Dr,0);for(y_(s,ht,Pt-257),y_(s,ht+5,nr-1),y_(s,ht+10,Rr-4),ht+=14,fr=0;fr<Rr;++fr)y_(s,ht+3*fr,Tr[Q1[fr]]);ht+=3*Rr;for(var pn=[kt,Kt],Fn=0;Fn<2;++Fn){var Gn=pn[Fn];for(fr=0;fr<Gn.length;++fr){var Qn=31&Gn[fr];y_(s,ht,wn[Qn]),ht+=Tr[Qn],Qn>15&&(y_(s,ht,Gn[fr]>>>5&127),ht+=Gn[fr]>>>12)}}}else Nr=vu,Ir=_0,kr=Eu,Hr=y0;for(fr=0;fr<ot;++fr)if(a[fr]>255){Qn=a[fr]>>>18&31,_w(s,ht,Nr[Qn+257]),ht+=Ir[Qn+257],Qn>7&&(y_(s,ht,a[fr]>>>23&31),ht+=v0[Qn]);var Yn=31&a[fr];_w(s,ht,kr[Yn]),ht+=Hr[Yn],Yn>3&&(_w(s,ht,a[fr]>>>5&8191),ht+=dy[Yn])}else _w(s,ht,Nr[a[fr]]),ht+=Ir[a[fr]];return _w(s,ht,Nr[256]),ht+Ir[256]},dR=new Np([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),A0=new ko(0),pR=function(tt,s,o,a,_e,rt){var nt=tt.length,ot=new ko(a+nt+5*(1+Math.ceil(nt/7e3))+_e),ct=ot.subarray(a,ot.length-_e),pt=0;if(!s||nt<8)for(var ht=0;ht<=nt;ht+=65535){var _t=ht+65535;_t<nt?pt=Y1(ct,pt,tt.subarray(ht,_t)):(ct[ht]=rt,pt=Y1(ct,pt,tt.subarray(ht,nt)))}else{for(var Et=dR[s-1],St=Et>>>13,Mt=8191&Et,It=(1<<o)-1,Nt=new up(32768),Bt=new up(It+1),kt=Math.ceil(o/3),Pt=2*kt,qt=function(Sl){return(tt[Sl]^tt[Sl+1]<<kt^tt[Sl+2]<<Pt)&It},Kt=new Np(25e3),nr=new up(288),ir=new up(32),fr=0,br=0,Tr=(ht=0,0),Dr=0,Rr=0;ht<nt;++ht){var Nr=qt(ht),Ir=32767&ht,kr=Bt[Nr];if(Nt[Ir]=kr,Bt[Nr]=Ir,Dr<=ht){var Hr=nt-ht;if((fr>7e3||Tr>24576)&&Hr>423){pt=JC(tt,ct,0,Kt,nr,ir,br,Tr,Rr,ht-Rr,pt),Tr=fr=br=0,Rr=ht;for(var Lr=0;Lr<286;++Lr)nr[Lr]=0;for(Lr=0;Lr<30;++Lr)ir[Lr]=0}var en=2,vn=0,wn=Mt,pn=Ir-kr&32767;if(Hr>2&&Nr==qt(ht-pn))for(var Fn=Math.min(St,Hr)-1,Gn=Math.min(32767,ht),Qn=Math.min(258,Hr);pn<=Gn&&--wn&&Ir!=kr;){if(tt[ht+en]==tt[ht+en-pn]){for(var Yn=0;Yn<Qn&&tt[ht+Yn]==tt[ht+Yn-pn];++Yn);if(Yn>en){if(en=Yn,vn=pn,Yn>Fn)break;var bs=Math.min(pn,Yn-2),Cn=0;for(Lr=0;Lr<bs;++Lr){var eo=ht-pn+Lr+32768&32767,vo=eo-Nt[eo]+32768&32767;vo>Cn&&(Cn=vo,kr=eo)}}}pn+=(Ir=kr)-(kr=Nt[Ir])+32768&32767}if(vn){Kt[Tr++]=268435456|H1[en]<<18|KC[vn];var to=31&H1[en],zo=31&KC[vn];br+=v0[to]+dy[zo],++nr[257+to],++ir[zo],Dr=ht+en,++fr}else Kt[Tr++]=tt[ht],++nr[tt[ht]]}}pt=JC(tt,ct,rt,Kt,nr,ir,br,Tr,Rr,ht-Rr,pt),!rt&&7&pt&&(pt=Y1(ct,pt+1,A0))}return Wp(ot,0,a+vw(pt)+_e)},hR=function(){for(var tt=new Np(256),s=0;s<256;++s){for(var o=s,a=9;--a;)o=(1&o&&3988292384)^o>>>1;tt[s]=o}return tt}(),Aw=function(){var tt=-1;return{p:function(s){for(var o=tt,a=0;a<s.length;++a)o=hR[255&o^s[a]]^o>>>8;tt=o},d:function(){return~tt}}},ZC=function(){var tt=1,s=0;return{p:function(o){for(var a=tt,_e=s,rt=o.length,nt=0;nt!=rt;){for(var ot=Math.min(nt+2655,rt);nt<ot;++nt)_e+=a+=o[nt];a=(65535&a)+15*(a>>16),_e=(65535&_e)+15*(_e>>16)}tt=a,s=_e},d:function(){return(255&(tt%=65521))<<24|tt>>>8<<16|(255&(s%=65521))<<8|s>>>8}}},uA=function(tt,s,o,a,_e){return pR(tt,s.level==null?6:s.level,s.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(tt.length)))):12+s.mem,o,a,!_e)},K1=function(tt,s){var o={};for(var a in tt)o[a]=tt[a];for(var a in s)o[a]=s[a];return o},fR=function(tt,s,o){for(var a=tt(),_e=tt.toString(),rt=_e.slice(_e.indexOf("[")+1,_e.lastIndexOf("]")).replace(/ /g,"").split(","),nt=0;nt<a.length;++nt){var ot=a[nt],ct=rt[nt];if(typeof ot=="function"){s+=";"+ct+"=";var pt=ot.toString();if(ot.prototype)if(pt.indexOf("[native code]")!=-1){var ht=pt.indexOf(" ",8)+1;s+=pt.slice(ht,pt.indexOf("(",ht))}else for(var _t in s+=pt,ot.prototype)s+=";"+ct+".prototype."+_t+"="+ot.prototype[_t].toString();else s+=pt}else o[ct]=ot}return[s,o]},YE=[],mR=function(tt,s,o,a){var _e;if(!YE[o]){for(var rt="",nt={},ot=tt.length-1,ct=0;ct<ot;++ct)rt=(_e=fR(tt[ct],rt,nt))[0],nt=_e[1];YE[o]=fR(tt[ot],rt,nt)}var pt=K1({},YE[o][1]);return function(ht,_t,Et,St,Mt){var It=aR(HC[_t]||(HC[_t]=gw(ht)));return It.onerror=function(Nt){return Mt(Nt.error,null)},It.onmessage=function(Nt){return Mt(null,Nt.data)},It.postMessage(Et,St),It}(YE[o][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+s.toString()+"}",o,pt,function(ht){var _t=[];for(var Et in ht)(ht[Et]instanceof ko||ht[Et]instanceof up||ht[Et]instanceof Np)&&_t.push((ht[Et]=new ht[Et].constructor(ht[Et])).buffer);return _t}(pt),a)},bw=function(){return[ko,up,Np,v0,dy,Q1,WC,uR,cR,W1,q1,Lm,HE,iv,qE,vw,Wp,lA,gr,py,eT]},ww=function(){return[ko,up,Np,v0,dy,Q1,H1,KC,vu,_0,Eu,y0,q1,dR,A0,Lm,y_,_w,WE,sv,XC,yw,Y1,JC,vw,Wp,pR,uA,Qt,py]},gR=function(){return[ft,Ct,lt,Aw,hR]},vR=function(){return[vt,At]},_R=function(){return[Tt,lt,ZC]},yR=function(){return[Ot]},py=function(tt){return postMessage(tt,[tt.buffer])},eT=function(tt){return tt&&tt.size&&new ko(tt.size)},xw=function(tt,s,o,a,_e,rt){var nt=mR(o,a,_e,function(ot,ct){nt.terminate(),rt(ot,ct)});return nt.postMessage([tt,s],s.consume?[tt.buffer]:[]),function(){nt.terminate()}},ov=function(tt){return tt.ondata=function(s,o){return postMessage([s,o],[s.buffer])},function(s){return tt.push(s.data[0],s.data[1])}},wt=function(tt,s,o,a,_e){var rt,nt=mR(tt,a,_e,function(ot,ct){ot?(nt.terminate(),s.ondata.call(s,ot)):(ct[1]&&nt.terminate(),s.ondata.call(s,ot,ct[0],ct[1]))});nt.postMessage(o),s.push=function(ot,ct){if(rt)throw"stream finished";if(!s.ondata)throw"no stream handler";nt.postMessage([ot,rt=ct],[ot.buffer])},s.terminate=function(){nt.terminate()}},_=function(tt,s){return tt[s]|tt[s+1]<<8},st=function(tt,s){return(tt[s]|tt[s+1]<<8|tt[s+2]<<16|tt[s+3]<<24)>>>0},at=function(tt,s){return st(tt,s)+4294967296*st(tt,s+4)},lt=function(tt,s,o){for(;o;++s)tt[s]=o,o>>>=8},ft=function(tt,s){var o=s.filename;if(tt[0]=31,tt[1]=139,tt[2]=8,tt[8]=s.level<2?4:s.level==9?2:0,tt[9]=3,s.mtime!=0&&lt(tt,4,Math.floor(new Date(s.mtime||Date.now())/1e3)),o){tt[3]=8;for(var a=0;a<=o.length;++a)tt[a+10]=o.charCodeAt(a)}},vt=function(tt){if(tt[0]!=31||tt[1]!=139||tt[2]!=8)throw"invalid gzip data";var s=tt[3],o=10;4&s&&(o+=tt[10]|2+(tt[11]<<8));for(var a=(s>>3&1)+(s>>4&1);a>0;a-=!tt[o++]);return o+(2&s)},At=function(tt){var s=tt.length;return(tt[s-4]|tt[s-3]<<8|tt[s-2]<<16|tt[s-1]<<24)>>>0},Ct=function(tt){return 10+(tt.filename&&tt.filename.length+1||0)},Tt=function(tt,s){var o=s.level,a=o==0?0:o<6?1:o==9?3:2;tt[0]=120,tt[1]=a<<6|(a?32-2*a:1)},Ot=function(tt){if((15&tt[0])!=8||tt[0]>>>4>7||(tt[0]<<8|tt[1])%31)throw"invalid zlib data";if(32&tt[1])throw"invalid zlib data: preset dictionaries not supported"};function Ut(tt,s){return s||typeof tt!="function"||(s=tt,tt={}),this.ondata=s,tt}var Lt=function(){function tt(s,o){o||typeof s!="function"||(o=s,s={}),this.ondata=o,this.o=s||{}}return tt.prototype.p=function(s,o){this.ondata(uA(s,this.o,0,0,!o),o)},tt.prototype.push=function(s,o){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=o,this.p(s,o||!1)},tt}(),Gt=function(){return function(tt,s){wt([ww,function(){return[ov,Lt]}],this,Ut.call(this,tt,s),function(o){var a=new Lt(o.data);onmessage=ov(a)},6)}}();function Xt(tt,s,o){if(o||(o=s,s={}),typeof o!="function")throw"no callback";return xw(tt,s,[ww],function(a){return py(Qt(a.data[0],a.data[1]))},0,o)}function Qt(tt,s){return uA(tt,s||{},0,0)}var lr=function(){function tt(s){this.s={},this.p=new ko(0),this.ondata=s}return tt.prototype.e=function(s){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var o=this.p.length,a=new ko(o+s.length);a.set(this.p),a.set(s,o),this.p=a},tt.prototype.c=function(s){this.d=this.s.i=s||!1;var o=this.s.b,a=lA(this.p,this.o,this.s);this.ondata(Wp(a,o,this.s.b),this.d),this.o=Wp(a,this.s.b-32768),this.s.b=this.o.length,this.p=Wp(this.p,this.s.p/8|0),this.s.p&=7},tt.prototype.push=function(s,o){this.e(s),this.c(o)},tt}(),ur=function(){return function(tt){this.ondata=tt,wt([bw,function(){return[ov,lr]}],this,0,function(){var s=new lr;onmessage=ov(s)},7)}}();function cr(tt,s,o){if(o||(o=s,s={}),typeof o!="function")throw"no callback";return xw(tt,s,[bw],function(a){return py(gr(a.data[0],eT(a.data[1])))},1,o)}function gr(tt,s){return lA(tt,s)}var wr=function(){function tt(s,o){this.c=Aw(),this.l=0,this.v=1,Lt.call(this,s,o)}return tt.prototype.push=function(s,o){Lt.prototype.push.call(this,s,o)},tt.prototype.p=function(s,o){this.c.p(s),this.l+=s.length;var a=uA(s,this.o,this.v&&Ct(this.o),o&&8,!o);this.v&&(ft(a,this.o),this.v=0),o&&(lt(a,a.length-8,this.c.d()),lt(a,a.length-4,this.l)),this.ondata(a,o)},tt}(),Er=function(){return function(tt,s){wt([ww,gR,function(){return[ov,Lt,wr]}],this,Ut.call(this,tt,s),function(o){var a=new wr(o.data);onmessage=ov(a)},8)}}();function Cr(tt,s,o){if(o||(o=s,s={}),typeof o!="function")throw"no callback";return xw(tt,s,[ww,gR,function(){return[zr]}],function(a){return py(zr(a.data[0],a.data[1]))},2,o)}function zr(tt,s){s||(s={});var o=Aw(),a=tt.length;o.p(tt);var _e=uA(tt,s,Ct(s),8),rt=_e.length;return ft(_e,s),lt(_e,rt-8,o.d()),lt(_e,rt-4,a),_e}var Gr=function(){function tt(s){this.v=1,lr.call(this,s)}return tt.prototype.push=function(s,o){if(lr.prototype.e.call(this,s),this.v){var a=this.p.length>3?vt(this.p):4;if(a>=this.p.length&&!o)return;this.p=this.p.subarray(a),this.v=0}if(o){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}lr.prototype.c.call(this,o)},tt}(),on=function(){return function(tt){this.ondata=tt,wt([bw,vR,function(){return[ov,lr,Gr]}],this,0,function(){var s=new Gr;onmessage=ov(s)},9)}}();function ln(tt,s,o){if(o||(o=s,s={}),typeof o!="function")throw"no callback";return xw(tt,s,[bw,vR,function(){return[Wr]}],function(a){return py(Wr(a.data[0]))},3,o)}function Wr(tt,s){return lA(tt.subarray(vt(tt),-8),s||new ko(At(tt)))}var Bn=function(){function tt(s,o){this.c=ZC(),this.v=1,Lt.call(this,s,o)}return tt.prototype.push=function(s,o){Lt.prototype.push.call(this,s,o)},tt.prototype.p=function(s,o){this.c.p(s);var a=uA(s,this.o,this.v&&2,o&&4,!o);this.v&&(Tt(a,this.o),this.v=0),o&&lt(a,a.length-4,this.c.d()),this.ondata(a,o)},tt}(),Hn=function(){return function(tt,s){wt([ww,_R,function(){return[ov,Lt,Bn]}],this,Ut.call(this,tt,s),function(o){var a=new Bn(o.data);onmessage=ov(a)},10)}}();function Pn(tt,s,o){if(o||(o=s,s={}),typeof o!="function")throw"no callback";return xw(tt,s,[ww,_R,function(){return[es]}],function(a){return py(es(a.data[0],a.data[1]))},4,o)}function es(tt,s){s||(s={});var o=ZC();o.p(tt);var a=uA(tt,s,2,4);return Tt(a,s),lt(a,a.length-4,o.d()),a}var ts=function(){function tt(s){this.v=1,lr.call(this,s)}return tt.prototype.push=function(s,o){if(lr.prototype.e.call(this,s),this.v){if(this.p.length<2&&!o)return;this.p=this.p.subarray(2),this.v=0}if(o){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}lr.prototype.c.call(this,o)},tt}(),bn=function(){return function(tt){this.ondata=tt,wt([bw,yR,function(){return[ov,lr,ts]}],this,0,function(){var s=new ts;onmessage=ov(s)},11)}}();function Sn(tt,s,o){if(o||(o=s,s={}),typeof o!="function")throw"no callback";return xw(tt,s,[bw,yR,function(){return[Kn]}],function(a){return py(Kn(a.data[0],eT(a.data[1])))},5,o)}function Kn(tt,s){return lA((Ot(tt),tt.subarray(2,-4)),s)}var kn=function(){function tt(s){this.G=Gr,this.I=lr,this.Z=ts,this.ondata=s}return tt.prototype.push=function(s,o){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(s,o);else{if(this.p&&this.p.length){var a=new ko(this.p.length+s.length);a.set(this.p),a.set(s,this.p.length)}else this.p=s;if(this.p.length>2){var _e=this,rt=function(){_e.ondata.apply(_e,arguments)};this.s=this.p[0]==31&&this.p[1]==139&&this.p[2]==8?new this.G(rt):(15&this.p[0])!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(rt):new this.Z(rt),this.s.push(this.p,o),this.p=null}}},tt}(),Zn=function(){function tt(s){this.G=on,this.I=ur,this.Z=bn,this.ondata=s}return tt.prototype.push=function(s,o){kn.prototype.push.call(this,s,o)},tt}();function Rs(tt,s,o){if(o||(o=s,s={}),typeof o!="function")throw"no callback";return tt[0]==31&&tt[1]==139&&tt[2]==8?ln(tt,s,o):(15&tt[0])!=8||tt[0]>>4>7||(tt[0]<<8|tt[1])%31?cr(tt,s,o):Sn(tt,s,o)}function wo(tt,s){return tt[0]==31&&tt[1]==139&&tt[2]==8?Wr(tt,s):(15&tt[0])!=8||tt[0]>>4>7||(tt[0]<<8|tt[1])%31?gr(tt,s):Kn(tt,s)}var Ds=function(tt,s,o,a){for(var _e in tt){var rt=tt[_e],nt=s+_e;rt instanceof ko?o[nt]=[rt,a]:Array.isArray(rt)?o[nt]=[rt[0],K1(a,rt[1])]:Ds(rt,nt+"/",o,a)}},fo=typeof TextEncoder<"u"&&new TextEncoder,Fr=typeof TextDecoder<"u"&&new TextDecoder,Br=0;try{Fr.decode(A0,{stream:!0}),Br=1}catch{}var fn=function(tt){for(var s="",o=0;;){var a=tt[o++],_e=(a>127)+(a>223)+(a>239);if(o+_e>tt.length)return[s,Wp(tt,o-1)];_e?_e==3?(a=((15&a)<<18|(63&tt[o++])<<12|(63&tt[o++])<<6|63&tt[o++])-65536,s+=String.fromCharCode(55296|a>>10,56320|1023&a)):s+=1&_e?String.fromCharCode((31&a)<<6|63&tt[o++]):String.fromCharCode((15&a)<<12|(63&tt[o++])<<6|63&tt[o++]):s+=String.fromCharCode(a)}},rn=function(){function tt(s){this.ondata=s,Br?this.t=new TextDecoder:this.p=A0}return tt.prototype.push=function(s,o){if(!this.ondata)throw"no callback";if(o=!!o,this.t){if(this.ondata(this.t.decode(s,{stream:!0}),o),o){if(this.t.decode().length)throw"invalid utf-8 data";this.t=null}}else{if(!this.p)throw"stream finished";var a=new ko(this.p.length+s.length);a.set(this.p),a.set(s,this.p.length);var _e=fn(a),rt=_e[0],nt=_e[1];if(o){if(nt.length)throw"invalid utf-8 data";this.p=null}else this.p=nt;this.ondata(rt,o)}},tt}(),Ur=function(){function tt(s){this.ondata=s}return tt.prototype.push=function(s,o){if(!this.ondata)throw"no callback";if(this.d)throw"stream finished";this.ondata(Zr(s),this.d=o||!1)},tt}();function Zr(tt,s){if(s){for(var o=new ko(tt.length),a=0;a<tt.length;++a)o[a]=tt.charCodeAt(a);return o}if(fo)return fo.encode(tt);var _e=tt.length,rt=new ko(tt.length+(tt.length>>1)),nt=0,ot=function(ht){rt[nt++]=ht};for(a=0;a<_e;++a){if(nt+5>rt.length){var ct=new ko(nt+8+(_e-a<<1));ct.set(rt),rt=ct}var pt=tt.charCodeAt(a);pt<128||s?ot(pt):pt<2048?(ot(192|pt>>6),ot(128|63&pt)):pt>55295&&pt<57344?(ot(240|(pt=65536+(1047552&pt)|1023&tt.charCodeAt(++a))>>18),ot(128|pt>>12&63),ot(128|pt>>6&63),ot(128|63&pt)):(ot(224|pt>>12),ot(128|pt>>6&63),ot(128|63&pt))}return Wp(rt,0,nt)}function xn(tt,s){if(s){for(var o="",a=0;a<tt.length;a+=16384)o+=String.fromCharCode.apply(null,tt.subarray(a,a+16384));return o}if(Fr)return Fr.decode(tt);var _e=fn(tt),rt=_e[0];if(_e[1].length)throw"invalid utf-8 data";return rt}var _r=function(tt){return tt==1?3:tt<6?2:tt==9?1:0},En=function(tt,s){return s+30+_(tt,s+26)+_(tt,s+28)},dn=function(tt,s,o){var a=_(tt,s+28),_e=xn(tt.subarray(s+46,s+46+a),!(2048&_(tt,s+8))),rt=s+46+a,nt=st(tt,s+20),ot=o&&nt==4294967295?Dn(tt,rt):[nt,st(tt,s+24),st(tt,s+42)],ct=ot[0],pt=ot[1],ht=ot[2];return[_(tt,s+10),ct,pt,_e,rt+_(tt,s+30)+_(tt,s+32),ht]},Dn=function(tt,s){for(;_(tt,s)!=1;s+=4+_(tt,s+2));return[at(tt,s+12),at(tt,s+4),at(tt,s+20)]},Nn=function(tt){var s=0;if(tt)for(var o in tt){var a=tt[o].length;if(a>65535)throw"extra field too long";s+=a+4}return s},as=function(tt,s,o,a,_e,rt,nt,ot){var ct=a.length,pt=o.extra,ht=ot&&ot.length,_t=Nn(pt);lt(tt,s,nt!=null?33639248:67324752),s+=4,nt!=null&&(tt[s++]=20,tt[s++]=o.os),tt[s]=20,s+=2,tt[s++]=o.flag<<1|(rt==null&&8),tt[s++]=_e&&8,tt[s++]=255&o.compression,tt[s++]=o.compression>>8;var Et=new Date(o.mtime==null?Date.now():o.mtime),St=Et.getFullYear()-1980;if(St<0||St>119)throw"date not in range 1980-2099";if(lt(tt,s,St<<25|Et.getMonth()+1<<21|Et.getDate()<<16|Et.getHours()<<11|Et.getMinutes()<<5|Et.getSeconds()>>>1),s+=4,rt!=null&&(lt(tt,s,o.crc),lt(tt,s+4,rt),lt(tt,s+8,o.size)),lt(tt,s+12,ct),lt(tt,s+14,_t),s+=16,nt!=null&&(lt(tt,s,ht),lt(tt,s+6,o.attrs),lt(tt,s+10,nt),s+=14),tt.set(a,s),s+=ct,_t)for(var Mt in pt){var It=pt[Mt],Nt=It.length;lt(tt,s,+Mt),lt(tt,s+2,Nt),tt.set(It,s+4),s+=4+Nt}return ht&&(tt.set(ot,s),s+=ht),s},Bs=function(tt,s,o,a,_e){lt(tt,s,101010256),lt(tt,s+8,o),lt(tt,s+10,o),lt(tt,s+12,a),lt(tt,s+16,_e)},Qs=function(){function tt(s){this.filename=s,this.c=Aw(),this.size=0,this.compression=0}return tt.prototype.process=function(s,o){this.ondata(null,s,o)},tt.prototype.push=function(s,o){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(s),this.size+=s.length,o&&(this.crc=this.c.d()),this.process(s,o||!1)},tt}(),lo=function(){function tt(s,o){var a=this;o||(o={}),Qs.call(this,s),this.d=new Lt(o,function(_e,rt){a.ondata(null,_e,rt)}),this.compression=8,this.flag=_r(o.level)}return tt.prototype.process=function(s,o){try{this.d.push(s,o)}catch(a){this.ondata(a,null,o)}},tt.prototype.push=function(s,o){Qs.prototype.push.call(this,s,o)},tt}(),zs=function(){function tt(s,o){var a=this;o||(o={}),Qs.call(this,s),this.d=new Gt(o,function(_e,rt,nt){a.ondata(_e,rt,nt)}),this.compression=8,this.flag=_r(o.level),this.terminate=this.d.terminate}return tt.prototype.process=function(s,o){this.d.push(s,o)},tt.prototype.push=function(s,o){Qs.prototype.push.call(this,s,o)},tt}(),Hs=function(){function tt(s){this.ondata=s,this.u=[],this.d=1}return tt.prototype.add=function(s){var o=this;if(2&this.d)throw"stream finished";var a=Zr(s.filename),_e=a.length,rt=s.comment,nt=rt&&Zr(rt),ot=_e!=s.filename.length||nt&&rt.length!=nt.length,ct=_e+Nn(s.extra)+30;if(_e>65535)throw"filename too long";var pt=new ko(ct);as(pt,0,s,a,ot);var ht=[pt],_t=function(){for(var Nt=0,Bt=ht;Nt<Bt.length;Nt++){var kt=Bt[Nt];o.ondata(null,kt,!1)}ht=[]},Et=this.d;this.d=0;var St=this.u.length,Mt=K1(s,{f:a,u:ot,o:nt,t:function(){s.terminate&&s.terminate()},r:function(){if(_t(),Et){var Nt=o.u[St+1];Nt?Nt.r():o.d=1}Et=1}}),It=0;s.ondata=function(Nt,Bt,kt){if(Nt)o.ondata(Nt,Bt,kt),o.terminate();else if(It+=Bt.length,ht.push(Bt),kt){var Pt=new ko(16);lt(Pt,0,134695760),lt(Pt,4,s.crc),lt(Pt,8,It),lt(Pt,12,s.size),ht.push(Pt),Mt.c=It,Mt.b=ct+It+16,Mt.crc=s.crc,Mt.size=s.size,Et&&Mt.r(),Et=1}else Et&&_t()},this.u.push(Mt)},tt.prototype.end=function(){var s=this;if(2&this.d)throw 1&this.d?"stream finishing":"stream finished";this.d?this.e():this.u.push({r:function(){1&s.d&&(s.u.splice(-1,1),s.e())},t:function(){}}),this.d=3},tt.prototype.e=function(){for(var s=0,o=0,a=0,_e=0,rt=this.u;_e<rt.length;_e++)a+=46+(pt=rt[_e]).f.length+Nn(pt.extra)+(pt.o?pt.o.length:0);for(var nt=new ko(a+22),ot=0,ct=this.u;ot<ct.length;ot++){var pt=ct[ot];as(nt,s,pt,pt.f,pt.u,pt.c,o,pt.o),s+=46+pt.f.length+Nn(pt.extra)+(pt.o?pt.o.length:0),o+=pt.b}Bs(nt,s,this.u.length,a,o),this.ondata(null,nt,!0),this.d=2},tt.prototype.terminate=function(){for(var s=0,o=this.u;s<o.length;s++)o[s].t();this.d=2},tt}();function _l(tt,s,o){if(o||(o=s,s={}),typeof o!="function")throw"no callback";var a={};Ds(tt,"",a,s);var _e=Object.keys(a),rt=_e.length,nt=0,ot=0,ct=rt,pt=new Array(rt),ht=[],_t=function(){for(var It=0;It<ht.length;++It)ht[It]()},Et=function(){var It=new ko(ot+22),Nt=nt,Bt=ot-nt;ot=0;for(var kt=0;kt<ct;++kt){var Pt=pt[kt];try{var qt=Pt.c.length;as(It,ot,Pt,Pt.f,Pt.u,qt);var Kt=30+Pt.f.length+Nn(Pt.extra),nr=ot+Kt;It.set(Pt.c,nr),as(It,nt,Pt,Pt.f,Pt.u,qt,ot,Pt.m),nt+=16+Kt+(Pt.m?Pt.m.length:0),ot=nr+qt}catch(ir){return o(ir,null)}}Bs(It,nt,pt.length,Bt,Nt),o(null,It)};rt||Et();for(var St=function(It){var Nt=_e[It],Bt=a[Nt],kt=Bt[0],Pt=Bt[1],qt=Aw(),Kt=kt.length;qt.p(kt);var nr=Zr(Nt),ir=nr.length,fr=Pt.comment,br=fr&&Zr(fr),Tr=br&&br.length,Dr=Nn(Pt.extra),Rr=Pt.level==0?0:8,Nr=function(Ir,kr){if(Ir)_t(),o(Ir,null);else{var Hr=kr.length;pt[It]=K1(Pt,{size:Kt,crc:qt.d(),c:kr,f:nr,m:br,u:ir!=Nt.length||br&&fr.length!=Tr,compression:Rr}),nt+=30+ir+Dr+Hr,ot+=76+2*(ir+Dr)+(Tr||0)+Hr,--rt||Et()}};if(ir>65535&&Nr("filename too long",null),Rr)if(Kt<16e4)try{Nr(null,Qt(kt,Pt))}catch(Ir){Nr(Ir,null)}else ht.push(Xt(kt,Pt,Nr));else Nr(null,kt)},Mt=0;Mt<ct;++Mt)St(Mt);return _t}function Nm(tt,s){s||(s={});var o={},a=[];Ds(tt,"",o,s);var _e=0,rt=0;for(var nt in o){var ot=o[nt],ct=ot[0],pt=ot[1],ht=pt.level==0?0:8,_t=(ir=Zr(nt)).length,Et=pt.comment,St=Et&&Zr(Et),Mt=St&&St.length,It=Nn(pt.extra);if(_t>65535)throw"filename too long";var Nt=ht?Qt(ct,pt):ct,Bt=Nt.length,kt=Aw();kt.p(ct),a.push(K1(pt,{size:ct.length,crc:kt.d(),c:Nt,f:ir,m:St,u:_t!=nt.length||St&&Et.length!=Mt,o:_e,compression:ht})),_e+=30+_t+It+Bt,rt+=76+2*(_t+It)+(Mt||0)+Bt}for(var Pt=new ko(rt+22),qt=_e,Kt=rt-_e,nr=0;nr<a.length;++nr){var ir=a[nr];as(Pt,ir.o,ir,ir.f,ir.u,ir.c.length);var fr=30+ir.f.length+Nn(ir.extra);Pt.set(ir.c,ir.o+fr),as(Pt,_e,ir,ir.f,ir.u,ir.c.length,ir.o,ir.m),_e+=16+fr+(ir.m?ir.m.length:0)}return Bs(Pt,_e,a.length,Kt,qt),Pt}var so=function(){function tt(){}return tt.prototype.push=function(s,o){this.ondata(null,s,o)},tt.compression=0,tt}(),Ml=function(){function tt(){var s=this;this.i=new lr(function(o,a){s.ondata(null,o,a)})}return tt.prototype.push=function(s,o){try{this.i.push(s,o)}catch(a){this.ondata(a,s,o)}},tt.compression=8,tt}(),Rl=function(){function tt(s,o){var a=this;o<32e4?this.i=new lr(function(_e,rt){a.ondata(null,_e,rt)}):(this.i=new ur(function(_e,rt,nt){a.ondata(_e,rt,nt)}),this.terminate=this.i.terminate)}return tt.prototype.push=function(s,o){this.i.terminate&&(s=Wp(s,0)),this.i.push(s,o)},tt.compression=8,tt}(),KE=function(){function tt(s){this.onfile=s,this.k=[],this.o={0:so},this.p=A0}return tt.prototype.push=function(s,o){var a=this;if(!this.onfile)throw"no callback";if(!this.p)throw"stream finished";if(this.c>0){var _e=Math.min(this.c,s.length),rt=s.subarray(0,_e);if(this.c-=_e,this.d?this.d.push(rt,!this.c):this.k[0].push(rt),(s=s.subarray(_e)).length)return this.push(s,o)}else{var nt=0,ot=0,ct=void 0,pt=void 0;this.p.length?s.length?((pt=new ko(this.p.length+s.length)).set(this.p),pt.set(s,this.p.length)):pt=this.p:pt=s;for(var ht=pt.length,_t=this.c,Et=_t&&this.d,St=function(){var Nt,Bt=st(pt,ot);if(Bt==67324752){nt=1,ct=ot,Mt.d=null,Mt.c=0;var kt=_(pt,ot+6),Pt=_(pt,ot+8),qt=2048&kt,Kt=8&kt,nr=_(pt,ot+26),ir=_(pt,ot+28);if(ht>ot+30+nr+ir){var fr=[];Mt.k.unshift(fr),nt=2;var br,Tr=st(pt,ot+18),Dr=st(pt,ot+22),Rr=xn(pt.subarray(ot+30,ot+=30+nr),!qt);Tr==4294967295?(Nt=Kt?[-2]:Dn(pt,ot),Tr=Nt[0],Dr=Nt[1]):Kt&&(Tr=-1),ot+=ir,Mt.c=Tr;var Nr={name:Rr,compression:Pt,start:function(){if(!Nr.ondata)throw"no callback";if(Tr){var Ir=a.o[Pt];if(!Ir)throw"unknown compression type "+Pt;(br=Tr<0?new Ir(Rr):new Ir(Rr,Tr,Dr)).ondata=function(en,vn,wn){Nr.ondata(en,vn,wn)};for(var kr=0,Hr=fr;kr<Hr.length;kr++){var Lr=Hr[kr];br.push(Lr,!1)}a.k[0]==fr&&a.c?a.d=br:br.push(A0,!0)}else Nr.ondata(null,A0,!0)},terminate:function(){br&&br.terminate&&br.terminate()}};Tr>=0&&(Nr.size=Tr,Nr.originalSize=Dr),Mt.onfile(Nr)}return"break"}if(_t){if(Bt==134695760)return ct=ot+=12+(_t==-2&&8),nt=3,Mt.c=0,"break";if(Bt==33639248)return ct=ot-=4,nt=3,Mt.c=0,"break"}},Mt=this;ot<ht-4&&St()!=="break";++ot);if(this.p=A0,_t<0){var It=nt?pt.subarray(0,ct-12-(_t==-2&&8)-(st(pt,ct-16)==134695760&&4)):pt.subarray(0,ot);Et?Et.push(It,!!nt):this.k[+(nt==2)].push(It)}if(2&nt)return this.push(pt.subarray(ot),o);this.p=pt.subarray(ot)}if(o){if(this.c)throw"invalid zip file";this.p=null}},tt.prototype.register=function(s){this.o[s.compression]=s},tt}();function hs(tt,s){if(typeof s!="function")throw"no callback";for(var o=[],a=function(){for(var Et=0;Et<o.length;++Et)o[Et]()},_e={},rt=tt.length-22;st(tt,rt)!=101010256;--rt)if(!rt||tt.length-rt>65558)return void s("invalid zip file",null);var nt=_(tt,rt+8);nt||s(null,{});var ot=nt,ct=st(tt,rt+16),pt=ct==4294967295;if(pt){if(rt=st(tt,rt-12),st(tt,rt)!=101075792)return void s("invalid zip file",null);ot=nt=st(tt,rt+32),ct=st(tt,rt+48)}for(var ht=function(Et){var St=dn(tt,ct,pt),Mt=St[0],It=St[1],Nt=St[2],Bt=St[3],kt=St[4],Pt=St[5],qt=En(tt,Pt);ct=kt;var Kt=function(ir,fr){ir?(a(),s(ir,null)):(_e[Bt]=fr,--nt||s(null,_e))};if(Mt)if(Mt==8){var nr=tt.subarray(qt,qt+It);if(It<32e4)try{Kt(null,gr(nr,new ko(Nt)))}catch(ir){Kt(ir,null)}else o.push(cr(nr,{size:Nt},Kt))}else Kt("unknown compression type "+Mt,null);else Kt(null,Wp(tt,qt,qt+It))},_t=0;_t<ot;++_t)ht();return a}function AR(tt){for(var s={},o=tt.length-22;st(tt,o)!=101010256;--o)if(!o||tt.length-o>65558)throw"invalid zip file";var a=_(tt,o+8);if(!a)return{};var _e=st(tt,o+16),rt=_e==4294967295;if(rt){if(o=st(tt,o-12),st(tt,o)!=101075792)throw"invalid zip file";a=st(tt,o+32),_e=st(tt,o+48)}for(var nt=0;nt<a;++nt){var ot=dn(tt,_e,rt),ct=ot[0],pt=ot[1],ht=ot[2],_t=ot[3],Et=ot[4],St=ot[5],Mt=En(tt,St);if(_e=Et,ct){if(ct!=8)throw"unknown compression type "+ct;s[_t]=gr(tt.subarray(Mt,Mt+pt),new ko(ht))}else s[_t]=Wp(tt,Mt,Mt+pt)}return s}class bR extends et.yxD{constructor(s){super(s),this.type=et.cLu}parse(s){const rt=Math.pow(2.7182818,2.2),nt={l:0,c:0,lc:0};function ot(xr,Qr,Sr,Xr,un){for(;Sr<xr;)Qr=Qr<<8|Fn(Xr,un),Sr+=8;Sr-=xr,nt.l=Qr>>Sr&(1<<xr)-1,nt.c=Qr,nt.lc=Sr}const ct=new Array(59);function pt(xr){return 63&xr}function ht(xr){return xr>>6}const _t={c:0,lc:0};function Et(xr,Qr,Sr,Xr){xr=xr<<8|Fn(Sr,Xr),Qr+=8,_t.c=xr,_t.lc=Qr}const St={c:0,lc:0};function Mt(xr,Qr,Sr,Xr,un,Kr,_n,Jn,us){if(xr==Qr){Xr<8&&(Et(Sr,Xr,un,Kr),Sr=_t.c,Xr=_t.lc);let _s=Sr>>(Xr-=8);if(_s=new Uint8Array([_s])[0],Jn.value+_s>us)return!1;const vs=_n[Jn.value-1];for(;_s-- >0;)_n[Jn.value++]=vs}else{if(!(Jn.value<us))return!1;_n[Jn.value++]=xr}St.c=Sr,St.lc=Xr}function It(xr){return 65535&xr}function Nt(xr){const Qr=It(xr);return Qr>32767?Qr-65536:Qr}const Bt={a:0,b:0};function kt(xr,Qr){const Sr=Nt(xr),Xr=Nt(Qr),un=Sr+(1&Xr)+(Xr>>1),Kr=un,_n=un-Xr;Bt.a=Kr,Bt.b=_n}function Pt(xr,Qr){const Sr=It(xr),Xr=It(Qr),un=Sr-(Xr>>1)&65535,Kr=Xr+un-32768&65535;Bt.a=Kr,Bt.b=un}function qt(xr,Qr,Sr,Xr,un,Kr,_n){const Jn=_n<16384,us=Sr>un?un:Sr;let _s,vs,ws=1;for(;ws<=us;)ws<<=1;for(ws>>=1,_s=ws,ws>>=1;ws>=1;){vs=0;const fs=vs+Kr*(un-_s),cs=Kr*ws,Is=Kr*_s,ns=Xr*ws,ks=Xr*_s;let $s,Xs,iu,zl;for(;vs<=fs;vs+=Is){let Os=vs;const no=vs+Xr*(Sr-_s);for(;Os<=no;Os+=ks){const Do=Os+ns,Sp=Os+cs,gv=Sp+ns;Jn?(kt(xr[Os+Qr],xr[Sp+Qr]),$s=Bt.a,iu=Bt.b,kt(xr[Do+Qr],xr[gv+Qr]),Xs=Bt.a,zl=Bt.b,kt($s,Xs),xr[Os+Qr]=Bt.a,xr[Do+Qr]=Bt.b,kt(iu,zl),xr[Sp+Qr]=Bt.a,xr[gv+Qr]=Bt.b):(Pt(xr[Os+Qr],xr[Sp+Qr]),$s=Bt.a,iu=Bt.b,Pt(xr[Do+Qr],xr[gv+Qr]),Xs=Bt.a,zl=Bt.b,Pt($s,Xs),xr[Os+Qr]=Bt.a,xr[Do+Qr]=Bt.b,Pt(iu,zl),xr[Sp+Qr]=Bt.a,xr[gv+Qr]=Bt.b)}if(Sr&ws){const Do=Os+cs;Jn?kt(xr[Os+Qr],xr[Do+Qr]):Pt(xr[Os+Qr],xr[Do+Qr]),$s=Bt.a,xr[Do+Qr]=Bt.b,xr[Os+Qr]=$s}}if(un&ws){let Os=vs;const no=vs+Xr*(Sr-_s);for(;Os<=no;Os+=ks){const Do=Os+ns;Jn?kt(xr[Os+Qr],xr[Do+Qr]):Pt(xr[Os+Qr],xr[Do+Qr]),$s=Bt.a,xr[Do+Qr]=Bt.b,xr[Os+Qr]=$s}}_s=ws,ws>>=1}return vs}function Kt(xr,Qr,Sr,Xr,un,Kr){const _n=Sr.value,Jn=pn(Qr,Sr),us=pn(Qr,Sr);Sr.value+=4;const _s=pn(Qr,Sr);if(Sr.value+=4,Jn<0||Jn>=65537||us<0||us>=65537)throw new Error("Something wrong with HUF_ENCSIZE");const vs=new Array(65537),ws=new Array(16384);if(function(fs){for(let cs=0;cs<16384;cs++)fs[cs]={},fs[cs].len=0,fs[cs].lit=0,fs[cs].p=null}(ws),function(fs,cs,Is,ns,ks,$s){const Xs=cs;let iu=0,zl=0;for(;ns<=ks;ns++){if(Xs.value-cs.value>Is)return!1;ot(6,iu,zl,fs,Xs);const Os=nt.l;if(iu=nt.c,zl=nt.lc,$s[ns]=Os,Os==63){if(Xs.value-cs.value>Is)throw new Error("Something wrong with hufUnpackEncTable");ot(8,iu,zl,fs,Xs);let no=nt.l+6;if(iu=nt.c,zl=nt.lc,ns+no>ks+1)throw new Error("Something wrong with hufUnpackEncTable");for(;no--;)$s[ns++]=0;ns--}else if(Os>=59){let no=Os-59+2;if(ns+no>ks+1)throw new Error("Something wrong with hufUnpackEncTable");for(;no--;)$s[ns++]=0;ns--}}(function(Os){for(let Do=0;Do<=58;++Do)ct[Do]=0;for(let Do=0;Do<65537;++Do)ct[Os[Do]]+=1;let no=0;for(let Do=58;Do>0;--Do){const Sp=no+ct[Do]>>1;ct[Do]=no,no=Sp}for(let Do=0;Do<65537;++Do){const Sp=Os[Do];Sp>0&&(Os[Do]=Sp|ct[Sp]++<<6)}})($s)}(xr,Sr,Xr-(Sr.value-_n),Jn,us,vs),_s>8*(Xr-(Sr.value-_n)))throw new Error("Something wrong with hufUncompress");(function(fs,cs,Is,ns){for(;cs<=Is;cs++){const ks=ht(fs[cs]),$s=pt(fs[cs]);if(ks>>$s)throw new Error("Invalid table entry");if($s>14){const Xs=ns[ks>>$s-14];if(Xs.len)throw new Error("Invalid table entry");if(Xs.lit++,Xs.p){const iu=Xs.p;Xs.p=new Array(Xs.lit);for(let zl=0;zl<Xs.lit-1;++zl)Xs.p[zl]=iu[zl]}else Xs.p=new Array(1);Xs.p[Xs.lit-1]=cs}else if($s){let Xs=0;for(let iu=1<<14-$s;iu>0;iu--){const zl=ns[(ks<<14-$s)+Xs];if(zl.len||zl.p)throw new Error("Invalid table entry");zl.len=$s,zl.lit=cs,Xs++}}}})(vs,Jn,us,ws),function(fs,cs,Is,ns,ks,$s,Xs,iu,zl){let Os=0,no=0;const Do=Xs,Sp=Math.trunc(ns.value+(ks+7)/8);for(;ns.value<Sp;)for(Et(Os,no,Is,ns),Os=_t.c,no=_t.lc;no>=14;){const Fp=cs[Os>>no-14&16383];if(Fp.len)no-=Fp.len,Mt(Fp.lit,$s,Os,no,Is,ns,iu,zl,Do),Os=St.c,no=St.lc;else{if(!Fp.p)throw new Error("hufDecode issues");let wA;for(wA=0;wA<Fp.lit;wA++){const Cx=pt(fs[Fp.p[wA]]);for(;no<Cx&&ns.value<Sp;)Et(Os,no,Is,ns),Os=_t.c,no=_t.lc;if(no>=Cx&&ht(fs[Fp.p[wA]])==(Os>>no-Cx&(1<<Cx)-1)){no-=Cx,Mt(Fp.p[wA],$s,Os,no,Is,ns,iu,zl,Do),Os=St.c,no=St.lc;break}}if(wA==Fp.lit)throw new Error("hufDecode issues")}}const gv=8-ks&7;for(Os>>=gv,no-=gv;no>0;){const Fp=cs[Os<<14-no&16383];if(!Fp.len)throw new Error("hufDecode issues");no-=Fp.len,Mt(Fp.lit,$s,Os,no,Is,ns,iu,zl,Do),Os=St.c,no=St.lc}}(vs,ws,xr,Sr,_s,us,Kr,un,{value:0})}function nr(xr){for(let Qr=1;Qr<xr.length;Qr++){const Sr=xr[Qr-1]+xr[Qr]-128;xr[Qr]=Sr}}function ir(xr,Qr){let Sr=0,Xr=Math.floor((xr.length+1)/2),un=0;const Kr=xr.length-1;for(;!(un>Kr||(Qr[un++]=xr[Sr++],un>Kr));)Qr[un++]=xr[Xr++]}function fr(xr){let Qr=xr.byteLength;const Sr=new Array;let Xr=0;const un=new DataView(xr);for(;Qr>0;){const Kr=un.getInt8(Xr++);if(Kr<0){const _n=-Kr;Qr-=_n+1;for(let Jn=0;Jn<_n;Jn++)Sr.push(un.getUint8(Xr++))}else{const _n=Kr;Qr-=2;const Jn=un.getUint8(Xr++);for(let us=0;us<_n+1;us++)Sr.push(Jn)}}return Sr}function br(xr,Qr,Sr){let Xr,un=1;for(;un<64;)Xr=Qr[xr.value],Xr==65280?un=64:Xr>>8==255?un+=255&Xr:(Sr[un]=Xr,un++),xr.value++}function Tr(xr){const Qr=.5*Math.cos(.7853975),Sr=.5*Math.cos(3.14159/16),Xr=.5*Math.cos(3.14159/8),un=.5*Math.cos(3*3.14159/16),Kr=.5*Math.cos(.981746875),_n=.5*Math.cos(3*3.14159/8),Jn=.5*Math.cos(1.374445625),us=new Array(4),_s=new Array(4),vs=new Array(4),ws=new Array(4);for(let fs=0;fs<8;++fs){const cs=8*fs;us[0]=Xr*xr[cs+2],us[1]=_n*xr[cs+2],us[2]=Xr*xr[cs+6],us[3]=_n*xr[cs+6],_s[0]=Sr*xr[cs+1]+un*xr[cs+3]+Kr*xr[cs+5]+Jn*xr[cs+7],_s[1]=un*xr[cs+1]-Jn*xr[cs+3]-Sr*xr[cs+5]-Kr*xr[cs+7],_s[2]=Kr*xr[cs+1]-Sr*xr[cs+3]+Jn*xr[cs+5]+un*xr[cs+7],_s[3]=Jn*xr[cs+1]-Kr*xr[cs+3]+un*xr[cs+5]-Sr*xr[cs+7],vs[0]=Qr*(xr[cs+0]+xr[cs+4]),vs[3]=Qr*(xr[cs+0]-xr[cs+4]),vs[1]=us[0]+us[3],vs[2]=us[1]-us[2],ws[0]=vs[0]+vs[1],ws[1]=vs[3]+vs[2],ws[2]=vs[3]-vs[2],ws[3]=vs[0]-vs[1],xr[cs+0]=ws[0]+_s[0],xr[cs+1]=ws[1]+_s[1],xr[cs+2]=ws[2]+_s[2],xr[cs+3]=ws[3]+_s[3],xr[cs+4]=ws[3]-_s[3],xr[cs+5]=ws[2]-_s[2],xr[cs+6]=ws[1]-_s[1],xr[cs+7]=ws[0]-_s[0]}for(let fs=0;fs<8;++fs)us[0]=Xr*xr[16+fs],us[1]=_n*xr[16+fs],us[2]=Xr*xr[48+fs],us[3]=_n*xr[48+fs],_s[0]=Sr*xr[8+fs]+un*xr[24+fs]+Kr*xr[40+fs]+Jn*xr[56+fs],_s[1]=un*xr[8+fs]-Jn*xr[24+fs]-Sr*xr[40+fs]-Kr*xr[56+fs],_s[2]=Kr*xr[8+fs]-Sr*xr[24+fs]+Jn*xr[40+fs]+un*xr[56+fs],_s[3]=Jn*xr[8+fs]-Kr*xr[24+fs]+un*xr[40+fs]-Sr*xr[56+fs],vs[0]=Qr*(xr[fs]+xr[32+fs]),vs[3]=Qr*(xr[fs]-xr[32+fs]),vs[1]=us[0]+us[3],vs[2]=us[1]-us[2],ws[0]=vs[0]+vs[1],ws[1]=vs[3]+vs[2],ws[2]=vs[3]-vs[2],ws[3]=vs[0]-vs[1],xr[0+fs]=ws[0]+_s[0],xr[8+fs]=ws[1]+_s[1],xr[16+fs]=ws[2]+_s[2],xr[24+fs]=ws[3]+_s[3],xr[32+fs]=ws[3]-_s[3],xr[40+fs]=ws[2]-_s[2],xr[48+fs]=ws[1]-_s[1],xr[56+fs]=ws[0]-_s[0]}function Dr(xr){for(let Qr=0;Qr<64;++Qr){const Sr=xr[0][Qr],Xr=xr[1][Qr],un=xr[2][Qr];xr[0][Qr]=Sr+1.5747*un,xr[1][Qr]=Sr-.1873*Xr-.4682*un,xr[2][Qr]=Sr+1.8556*Xr}}function Rr(xr,Qr,Sr){for(let un=0;un<64;++un)Qr[Sr+un]=et.A5E.toHalfFloat((Xr=xr[un])<=1?Math.sign(Xr)*Math.pow(Math.abs(Xr),2.2):Math.sign(Xr)*Math.pow(rt,Math.abs(Xr)-1));var Xr}function Nr(xr){return new DataView(xr.array.buffer,xr.offset.value,xr.size)}function Ir(xr){const Qr=xr.viewer.buffer.slice(xr.offset.value,xr.offset.value+xr.size),Sr=new Uint8Array(fr(Qr)),Xr=new Uint8Array(Sr.length);return nr(Sr),ir(Sr,Xr),new DataView(Xr.buffer)}function kr(xr){const Qr=xr.array.slice(xr.offset.value,xr.offset.value+xr.size);j===void 0&&console.error("THREE.EXRLoader: External library fflate.min.js required.");const Sr=Kn(Qr),Xr=new Uint8Array(Sr.length);return nr(Sr),ir(Sr,Xr),new DataView(Xr.buffer)}function Hr(xr){const Qr=xr.viewer,Sr={value:xr.offset.value},Xr=new Uint16Array(xr.width*xr.scanlineBlockSize*(xr.channels*xr.type)),un=new Uint8Array(8192);let Kr=0;const _n=new Array(xr.channels);for(let Is=0;Is<xr.channels;Is++)_n[Is]={},_n[Is].start=Kr,_n[Is].end=_n[Is].start,_n[Is].nx=xr.width,_n[Is].ny=xr.lines,_n[Is].size=xr.type,Kr+=_n[Is].nx*_n[Is].ny*_n[Is].size;const Jn=eo(Qr,Sr),us=eo(Qr,Sr);if(us>=8192)throw new Error("Something is wrong with PIZ_COMPRESSION BITMAP_SIZE");if(Jn<=us)for(let Is=0;Is<us-Jn+1;Is++)un[Is+Jn]=Gn(Qr,Sr);const _s=new Uint16Array(65536),vs=function(Is,ns){let ks=0;for(let Xs=0;Xs<65536;++Xs)(Xs==0||Is[Xs>>3]&1<<(7&Xs))&&(ns[ks++]=Xs);const $s=ks-1;for(;ks<65536;)ns[ks++]=0;return $s}(un,_s),ws=pn(Qr,Sr);Kt(xr.array,Qr,Sr,ws,Xr,Kr);for(let Is=0;Is<xr.channels;++Is){const ns=_n[Is];for(let ks=0;ks<_n[Is].size;++ks)qt(Xr,ns.start+ks,ns.nx,ns.size,ns.ny,ns.nx*ns.size,vs)}(function(Is,ns,ks){for(let $s=0;$s<ks;++$s)ns[$s]=Is[ns[$s]]})(_s,Xr,Kr);let fs=0;const cs=new Uint8Array(Xr.buffer.byteLength);for(let Is=0;Is<xr.lines;Is++)for(let ns=0;ns<xr.channels;ns++){const ks=_n[ns],$s=ks.nx*ks.size,Xs=new Uint8Array(Xr.buffer,2*ks.end,2*$s);cs.set(Xs,fs),fs+=2*$s,ks.end+=$s}return new DataView(cs.buffer)}function Lr(xr){const Qr=xr.array.slice(xr.offset.value,xr.offset.value+xr.size);j===void 0&&console.error("THREE.EXRLoader: External library fflate.min.js required.");const Sr=Kn(Qr),Xr=xr.lines*xr.channels*xr.width,un=xr.type==1?new Uint16Array(Xr):new Uint32Array(Xr);let Kr=0,_n=0;const Jn=new Array(4);for(let us=0;us<xr.lines;us++)for(let _s=0;_s<xr.channels;_s++){let vs=0;switch(xr.type){case 1:Jn[0]=Kr,Jn[1]=Jn[0]+xr.width,Kr=Jn[1]+xr.width;for(let ws=0;ws<xr.width;++ws)vs+=Sr[Jn[0]++]<<8|Sr[Jn[1]++],un[_n]=vs,_n++;break;case 2:Jn[0]=Kr,Jn[1]=Jn[0]+xr.width,Jn[2]=Jn[1]+xr.width,Kr=Jn[2]+xr.width;for(let ws=0;ws<xr.width;++ws)vs+=Sr[Jn[0]++]<<24|Sr[Jn[1]++]<<16|Sr[Jn[2]++]<<8,un[_n]=vs,_n++}}return new DataView(un.buffer)}function en(xr){const Qr=xr.viewer,Sr={value:xr.offset.value},Xr=new Uint8Array(xr.width*xr.lines*(xr.channels*xr.type*2)),un={version:Qn(Qr,Sr),unknownUncompressedSize:Qn(Qr,Sr),unknownCompressedSize:Qn(Qr,Sr),acCompressedSize:Qn(Qr,Sr),dcCompressedSize:Qn(Qr,Sr),rleCompressedSize:Qn(Qr,Sr),rleUncompressedSize:Qn(Qr,Sr),rleRawSize:Qn(Qr,Sr),totalAcUncompressedCount:Qn(Qr,Sr),totalDcUncompressedCount:Qn(Qr,Sr),acCompression:Qn(Qr,Sr)};if(un.version<2)throw new Error("EXRLoader.parse: "+qn.compression+" version "+un.version+" is unsupported");const Kr=new Array;let _n=eo(Qr,Sr)-2;for(;_n>0;){const ns=vn(Qr.buffer,Sr),ks=Gn(Qr,Sr),$s=ks>>2&3,Xs=new Int8Array([(ks>>4)-1])[0],iu=Gn(Qr,Sr);Kr.push({name:ns,index:Xs,type:iu,compression:$s}),_n-=ns.length+3}const Jn=qn.channels,us=new Array(xr.channels);for(let ns=0;ns<xr.channels;++ns){const ks=us[ns]={},$s=Jn[ns];ks.name=$s.name,ks.compression=0,ks.decoded=!1,ks.type=$s.pixelType,ks.pLinear=$s.pLinear,ks.width=xr.width,ks.height=xr.lines}const _s={idx:new Array(3)};for(let ns=0;ns<xr.channels;++ns){const ks=us[ns];for(let $s=0;$s<Kr.length;++$s){const Xs=Kr[$s];ks.name==Xs.name&&(ks.compression=Xs.compression,Xs.index>=0&&(_s.idx[Xs.index]=ns),ks.offset=ns)}}let vs,ws,fs;if(un.acCompressedSize>0)switch(un.acCompression){case 0:vs=new Uint16Array(un.totalAcUncompressedCount),Kt(xr.array,Qr,Sr,un.acCompressedSize,vs,un.totalAcUncompressedCount);break;case 1:const ns=Kn(xr.array.slice(Sr.value,Sr.value+un.totalAcUncompressedCount));vs=new Uint16Array(ns.buffer),Sr.value+=un.totalAcUncompressedCount}if(un.dcCompressedSize>0){const ns={array:xr.array,offset:Sr,size:un.dcCompressedSize};ws=new Uint16Array(kr(ns).buffer),Sr.value+=un.dcCompressedSize}un.rleRawSize>0&&(fs=fr(Kn(xr.array.slice(Sr.value,Sr.value+un.rleCompressedSize)).buffer),Sr.value+=un.rleCompressedSize);let cs=0;const Is=new Array(us.length);for(let ns=0;ns<Is.length;++ns)Is[ns]=new Array;for(let ns=0;ns<xr.lines;++ns)for(let ks=0;ks<us.length;++ks)Is[ks].push(cs),cs+=us[ks].width*xr.type*2;(function(ns,ks,$s,Xs,iu,zl){let Os=new DataView(zl.buffer);const no=$s[ns.idx[0]].width,Do=$s[ns.idx[0]].height,Sp=Math.floor(no/8),gv=Math.ceil(no/8),Fp=Math.ceil(Do/8),wA=no-8*(gv-1),Cx=Do-8*(Fp-1),XF={value:0},MD=new Array(3),$T=new Array(3),jT=new Array(3),R0=new Array(3),hP=new Array(3);for(let Au=0;Au<3;++Au)hP[Au]=ks[ns.idx[Au]],MD[Au]=Au<1?0:MD[Au-1]+gv*Fp,$T[Au]=new Float32Array(64),jT[Au]=new Uint16Array(64),R0[Au]=new Uint16Array(64*gv);for(let Au=0;Au<Fp;++Au){let NS=8;Au==Fp-1&&(NS=Cx);let FS=8;for(let Hl=0;Hl<gv;++Hl){Hl==gv-1&&(FS=wA);for(let cu=0;cu<3;++cu)jT[cu].fill(0),jT[cu][0]=iu[MD[cu]++],br(XF,Xs,jT[cu]),Cs=jT[cu],(Ts=$T[cu])[0]=Cn(Cs[0]),Ts[1]=Cn(Cs[1]),Ts[2]=Cn(Cs[5]),Ts[3]=Cn(Cs[6]),Ts[4]=Cn(Cs[14]),Ts[5]=Cn(Cs[15]),Ts[6]=Cn(Cs[27]),Ts[7]=Cn(Cs[28]),Ts[8]=Cn(Cs[2]),Ts[9]=Cn(Cs[4]),Ts[10]=Cn(Cs[7]),Ts[11]=Cn(Cs[13]),Ts[12]=Cn(Cs[16]),Ts[13]=Cn(Cs[26]),Ts[14]=Cn(Cs[29]),Ts[15]=Cn(Cs[42]),Ts[16]=Cn(Cs[3]),Ts[17]=Cn(Cs[8]),Ts[18]=Cn(Cs[12]),Ts[19]=Cn(Cs[17]),Ts[20]=Cn(Cs[25]),Ts[21]=Cn(Cs[30]),Ts[22]=Cn(Cs[41]),Ts[23]=Cn(Cs[43]),Ts[24]=Cn(Cs[9]),Ts[25]=Cn(Cs[11]),Ts[26]=Cn(Cs[18]),Ts[27]=Cn(Cs[24]),Ts[28]=Cn(Cs[31]),Ts[29]=Cn(Cs[40]),Ts[30]=Cn(Cs[44]),Ts[31]=Cn(Cs[53]),Ts[32]=Cn(Cs[10]),Ts[33]=Cn(Cs[19]),Ts[34]=Cn(Cs[23]),Ts[35]=Cn(Cs[32]),Ts[36]=Cn(Cs[39]),Ts[37]=Cn(Cs[45]),Ts[38]=Cn(Cs[52]),Ts[39]=Cn(Cs[54]),Ts[40]=Cn(Cs[20]),Ts[41]=Cn(Cs[22]),Ts[42]=Cn(Cs[33]),Ts[43]=Cn(Cs[38]),Ts[44]=Cn(Cs[46]),Ts[45]=Cn(Cs[51]),Ts[46]=Cn(Cs[55]),Ts[47]=Cn(Cs[60]),Ts[48]=Cn(Cs[21]),Ts[49]=Cn(Cs[34]),Ts[50]=Cn(Cs[37]),Ts[51]=Cn(Cs[47]),Ts[52]=Cn(Cs[50]),Ts[53]=Cn(Cs[56]),Ts[54]=Cn(Cs[59]),Ts[55]=Cn(Cs[61]),Ts[56]=Cn(Cs[35]),Ts[57]=Cn(Cs[36]),Ts[58]=Cn(Cs[48]),Ts[59]=Cn(Cs[49]),Ts[60]=Cn(Cs[57]),Ts[61]=Cn(Cs[58]),Ts[62]=Cn(Cs[62]),Ts[63]=Cn(Cs[63]),Tr($T[cu]);Dr($T);for(let cu=0;cu<3;++cu)Rr($T[cu],R0[cu],64*Hl)}let Wv=0;for(let Hl=0;Hl<3;++Hl){const cu=$s[ns.idx[Hl]].type;for(let xA=8*Au;xA<8*Au+NS;++xA){Wv=hP[Hl][xA];for(let zT=0;zT<Sp;++zT){const Dy=64*zT+8*(7&xA);Os.setUint16(Wv+0*cu,R0[Hl][Dy+0],!0),Os.setUint16(Wv+2*cu,R0[Hl][Dy+1],!0),Os.setUint16(Wv+4*cu,R0[Hl][Dy+2],!0),Os.setUint16(Wv+6*cu,R0[Hl][Dy+3],!0),Os.setUint16(Wv+8*cu,R0[Hl][Dy+4],!0),Os.setUint16(Wv+10*cu,R0[Hl][Dy+5],!0),Os.setUint16(Wv+12*cu,R0[Hl][Dy+6],!0),Os.setUint16(Wv+14*cu,R0[Hl][Dy+7],!0),Wv+=16*cu}}if(Sp!=gv)for(let xA=8*Au;xA<8*Au+NS;++xA){const zT=hP[Hl][xA]+8*Sp*2*cu,Dy=64*Sp+8*(7&xA);for(let fP=0;fP<FS;++fP)Os.setUint16(zT+2*fP*cu,R0[Hl][Dy+fP],!0)}}}var Cs,Ts;const iL=new Uint16Array(no);Os=new DataView(zl.buffer);for(let Au=0;Au<3;++Au){$s[ns.idx[Au]].decoded=!0;const NS=$s[ns.idx[Au]].type;if($s[Au].type==2)for(let FS=0;FS<Do;++FS){const Wv=hP[Au][FS];for(let Hl=0;Hl<no;++Hl)iL[Hl]=Os.getUint16(Wv+2*Hl*NS,!0);for(let Hl=0;Hl<no;++Hl)Os.setFloat32(Wv+2*Hl*NS,Cn(iL[Hl]),!0)}}})(_s,Is,us,vs,ws,Xr);for(let ns=0;ns<us.length;++ns){const ks=us[ns];if(!ks.decoded){if(ks.compression!==2)throw new Error("EXRLoader.parse: unsupported channel compression");{let $s=0,Xs=0;for(let iu=0;iu<xr.lines;++iu){let zl=Is[ns][$s];for(let Os=0;Os<ks.width;++Os){for(let no=0;no<2*ks.type;++no)Xr[zl++]=fs[Xs+no*ks.width*ks.height];Xs++}$s++}}}}return new DataView(Xr.buffer)}function vn(xr,Qr){const Sr=new Uint8Array(xr);let Xr=0;for(;Sr[Qr.value+Xr]!=0;)Xr+=1;const un=new TextDecoder().decode(Sr.slice(Qr.value,Qr.value+Xr));return Qr.value=Qr.value+Xr+1,un}function wn(xr,Qr){const Sr=xr.getInt32(Qr.value,!0);return Qr.value=Qr.value+4,Sr}function pn(xr,Qr){const Sr=xr.getUint32(Qr.value,!0);return Qr.value=Qr.value+4,Sr}function Fn(xr,Qr){const Sr=xr[Qr.value];return Qr.value=Qr.value+1,Sr}function Gn(xr,Qr){const Sr=xr.getUint8(Qr.value);return Qr.value=Qr.value+1,Sr}const Qn=function(xr,Qr){const Sr=Number(xr.getBigInt64(Qr.value,!0));return Qr.value+=8,Sr};function Yn(xr,Qr){const Sr=xr.getFloat32(Qr.value,!0);return Qr.value+=4,Sr}function bs(xr,Qr){return et.A5E.toHalfFloat(Yn(xr,Qr))}function Cn(xr){const Qr=(31744&xr)>>10,Sr=1023&xr;return(xr>>15?-1:1)*(Qr?Qr===31?Sr?NaN:1/0:Math.pow(2,Qr-15)*(1+Sr/1024):Sr/1024*6103515625e-14)}function eo(xr,Qr){const Sr=xr.getUint16(Qr.value,!0);return Qr.value+=2,Sr}function vo(xr,Qr){return Cn(eo(xr,Qr))}function to(xr,Qr,Sr,Xr,un){return Xr==="string"||Xr==="stringvector"||Xr==="iccProfile"?function(Kr,_n,Jn){const us=new TextDecoder().decode(new Uint8Array(Kr).slice(_n.value,_n.value+Jn));return _n.value=_n.value+Jn,us}(Qr,Sr,un):Xr==="chlist"?function(Kr,_n,Jn,us){const _s=Jn.value,vs=[];for(;Jn.value<_s+us-1;){const ws=vn(_n,Jn),fs=wn(Kr,Jn),cs=Gn(Kr,Jn);Jn.value+=3;const Is=wn(Kr,Jn),ns=wn(Kr,Jn);vs.push({name:ws,pixelType:fs,pLinear:cs,xSampling:Is,ySampling:ns})}return Jn.value+=1,vs}(xr,Qr,Sr,un):Xr==="chromaticities"?function(Kr,_n){return{redX:Yn(Kr,_n),redY:Yn(Kr,_n),greenX:Yn(Kr,_n),greenY:Yn(Kr,_n),blueX:Yn(Kr,_n),blueY:Yn(Kr,_n),whiteX:Yn(Kr,_n),whiteY:Yn(Kr,_n)}}(xr,Sr):Xr==="compression"?function(Kr,_n){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][Gn(Kr,_n)]}(xr,Sr):Xr==="box2i"?function(Kr,_n){return{xMin:pn(Kr,_n),yMin:pn(Kr,_n),xMax:pn(Kr,_n),yMax:pn(Kr,_n)}}(xr,Sr):Xr==="lineOrder"?function(Kr,_n){return["INCREASING_Y"][Gn(Kr,_n)]}(xr,Sr):Xr==="float"?Yn(xr,Sr):Xr==="v2f"?function(Kr,_n){return[Yn(Kr,_n),Yn(Kr,_n)]}(xr,Sr):Xr==="v3f"?function(Kr,_n){return[Yn(Kr,_n),Yn(Kr,_n),Yn(Kr,_n)]}(xr,Sr):Xr==="int"?wn(xr,Sr):Xr==="rational"?function(Kr,_n){return[wn(Kr,_n),pn(Kr,_n)]}(xr,Sr):Xr==="timecode"?function(Kr,_n){return[pn(Kr,_n),pn(Kr,_n)]}(xr,Sr):Xr==="preview"?(Sr.value+=un,"skipped"):void(Sr.value+=un)}const zo=new DataView(s),Sl=new Uint8Array(s),yn={value:0},qn=function(xr,Qr,Sr){const Xr={};if(xr.getUint32(0,!0)!=20000630)throw new Error("THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.");Xr.version=xr.getUint8(4);const un=xr.getUint8(5);Xr.spec={singleTile:!!(2&un),longName:!!(4&un),deepFormat:!!(8&un),multiPart:!!(16&un)},Sr.value=8;let Kr=!0;for(;Kr;){const _n=vn(Qr,Sr);if(_n==0)Kr=!1;else{const Jn=vn(Qr,Sr),us=to(xr,Qr,Sr,Jn,pn(xr,Sr));us===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${Jn}'.`):Xr[_n]=us}}if(-5&un)throw console.error("EXRHeader:",Xr),new Error("THREE.EXRLoader: provided file is currently unsupported.");return Xr}(zo,s,yn),Wn=function(xr,Qr,Sr,Xr,un){const Kr={size:0,viewer:Qr,array:Sr,offset:Xr,width:xr.dataWindow.xMax-xr.dataWindow.xMin+1,height:xr.dataWindow.yMax-xr.dataWindow.yMin+1,channels:xr.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:xr.channels[0].pixelType,uncompress:null,getter:null,format:null,encoding:null};switch(xr.compression){case"NO_COMPRESSION":Kr.lines=1,Kr.uncompress=Nr;break;case"RLE_COMPRESSION":Kr.lines=1,Kr.uncompress=Ir;break;case"ZIPS_COMPRESSION":Kr.lines=1,Kr.uncompress=kr;break;case"ZIP_COMPRESSION":Kr.lines=16,Kr.uncompress=kr;break;case"PIZ_COMPRESSION":Kr.lines=32,Kr.uncompress=Hr;break;case"PXR24_COMPRESSION":Kr.lines=16,Kr.uncompress=Lr;break;case"DWAA_COMPRESSION":Kr.lines=32,Kr.uncompress=en;break;case"DWAB_COMPRESSION":Kr.lines=256,Kr.uncompress=en;break;default:throw new Error("EXRLoader.parse: "+xr.compression+" is unsupported")}if(Kr.scanlineBlockSize=Kr.lines,Kr.type==1)switch(un){case et.VzW:Kr.getter=vo,Kr.inputSize=2;break;case et.cLu:Kr.getter=eo,Kr.inputSize=2}else{if(Kr.type!=2)throw new Error("EXRLoader.parse: unsupported pixelType "+Kr.type+" for "+xr.compression+".");switch(un){case et.VzW:Kr.getter=Yn,Kr.inputSize=4;break;case et.cLu:Kr.getter=bs,Kr.inputSize=4}}Kr.blockCount=(xr.dataWindow.yMax+1)/Kr.scanlineBlockSize;for(let Jn=0;Jn<Kr.blockCount;Jn++)Qn(Qr,Xr);Kr.outputChannels=Kr.channels==3?4:Kr.channels;const _n=Kr.width*Kr.height*Kr.outputChannels;switch(un){case et.VzW:Kr.byteArray=new Float32Array(_n),Kr.channels<Kr.outputChannels&&Kr.byteArray.fill(1,0,_n);break;case et.cLu:Kr.byteArray=new Uint16Array(_n),Kr.channels<Kr.outputChannels&&Kr.byteArray.fill(15360,0,_n);break;default:console.error("THREE.EXRLoader: unsupported type: ",un)}return Kr.bytesPerLine=Kr.width*Kr.inputSize*Kr.channels,Kr.outputChannels==4?(Kr.format=et.wk1,Kr.encoding=et.rnI):(Kr.format=et.hEm,Kr.encoding=et.rnI),Kr}(qn,zo,Sl,yn,this.type),ro={value:0},yl={R:0,G:1,B:2,A:3,Y:0};for(let xr=0;xr<Wn.height/Wn.scanlineBlockSize;xr++){const Qr=pn(zo,yn);Wn.size=pn(zo,yn),Wn.lines=Qr+Wn.scanlineBlockSize>Wn.height?Wn.height-Qr:Wn.scanlineBlockSize;const Sr=Wn.size<Wn.lines*Wn.bytesPerLine?Wn.uncompress(Wn):Nr(Wn);yn.value+=Wn.size;for(let Xr=0;Xr<Wn.scanlineBlockSize;Xr++){const un=Xr+xr*Wn.scanlineBlockSize;if(un>=Wn.height)break;for(let Kr=0;Kr<Wn.channels;Kr++){const _n=yl[qn.channels[Kr].name];for(let Jn=0;Jn<Wn.width;Jn++){ro.value=(Xr*(Wn.channels*Wn.width)+Kr*Wn.width+Jn)*Wn.inputSize;const us=(Wn.height-1-un)*(Wn.width*Wn.outputChannels)+Jn*Wn.outputChannels+_n;Wn.byteArray[us]=Wn.getter(Sr,ro)}}}}return{header:qn,width:Wn.width,height:Wn.height,data:Wn.byteArray,format:Wn.format,encoding:Wn.encoding,type:this.type}}setDataType(s){return this.type=s,this}load(s,o,a,_e){return super.load(s,function(rt,nt){rt.encoding=nt.encoding,rt.minFilter=et.wem,rt.magFilter=et.wem,rt.generateMipmaps=!1,rt.flipY=!1,o&&o(rt,nt)},a,_e)}}class Yp extends it{constructor(){super(...arguments),this.dependencies=[os]}async onAdded(s){this._importer||(this._importer=new Yl(class extends bR{constructor(o){super(o),this.setDataType($x(s.renderer.rendererObject))}},["exr"],!1)),mo.Importers.push(this._importer)}async onDispose(s){this._importer=void 0}async onRemove(s){this._importer&&mo.Importers.splice(mo.Importers.indexOf(this._importer),1),this._importer=void 0}}function tT(tt,s,o){const a=o.length-tt-1;if(s>=o[a])return a-1;if(s<=o[tt])return tt;let _e=tt,rt=a,nt=Math.floor((_e+rt)/2);for(;s<o[nt]||s>=o[nt+1];)s<o[nt]?rt=nt:_e=nt,nt=Math.floor((_e+rt)/2);return nt}function wR(tt,s){let o=1;for(let _e=2;_e<=tt;++_e)o*=_e;let a=1;for(let _e=2;_e<=s;++_e)a*=_e;for(let _e=2;_e<=tt-s;++_e)a*=_e;return o/a}Yp.PluginType="EXRLoadPlugin";class rT extends et.Hyl{constructor(s,o,a,_e,rt){super(),this.degree=s,this.knots=o,this.controlPoints=[],this.startKnot=_e||0,this.endKnot=rt||this.knots.length-1;for(let nt=0;nt<a.length;++nt){const ot=a[nt];this.controlPoints[nt]=new et.Ltg(ot.x,ot.y,ot.z,ot.w)}}getPoint(s,o=new et.Pa4){const a=o,_e=this.knots[this.startKnot]+s*(this.knots[this.endKnot]-this.knots[this.startKnot]),rt=function(nt,ot,ct,pt){const ht=tT(nt,pt,ot),_t=function(St,Mt,It,Nt){const Bt=[],kt=[],Pt=[];Bt[0]=1;for(let qt=1;qt<=It;++qt){kt[qt]=Mt-Nt[St+1-qt],Pt[qt]=Nt[St+qt]-Mt;let Kt=0;for(let nr=0;nr<qt;++nr){const ir=Pt[nr+1],fr=kt[qt-nr],br=Bt[nr]/(ir+fr);Bt[nr]=Kt+ir*br,Kt=fr*br}Bt[qt]=Kt}return Bt}(ht,pt,nt,ot),Et=new et.Ltg(0,0,0,0);for(let St=0;St<=nt;++St){const Mt=ct[ht-nt+St],It=_t[St],Nt=Mt.w*It;Et.x+=Mt.x*Nt,Et.y+=Mt.y*Nt,Et.z+=Mt.z*Nt,Et.w+=Mt.w*It}return Et}(this.degree,this.knots,this.controlPoints,_e);return rt.w!==1&&rt.divideScalar(rt.w),a.set(rt.x,rt.y,rt.z)}getTangent(s,o=new et.Pa4){const a=o,_e=this.knots[0]+s*(this.knots[this.knots.length-1]-this.knots[0]),rt=function(nt,ot,ct,pt,ht){const _t=function(Et,St,Mt,It,Nt){const Bt=Nt<Et?Nt:Et,kt=[],Pt=tT(Et,It,St),qt=function(nr,ir,fr,br,Tr){const Dr=[];for(let Lr=0;Lr<=fr;++Lr)Dr[Lr]=0;const Rr=[];for(let Lr=0;Lr<=br;++Lr)Rr[Lr]=Dr.slice(0);const Nr=[];for(let Lr=0;Lr<=fr;++Lr)Nr[Lr]=Dr.slice(0);Nr[0][0]=1;const Ir=Dr.slice(0),kr=Dr.slice(0);for(let Lr=1;Lr<=fr;++Lr){Ir[Lr]=ir-Tr[nr+1-Lr],kr[Lr]=Tr[nr+Lr]-ir;let en=0;for(let vn=0;vn<Lr;++vn){const wn=kr[vn+1],pn=Ir[Lr-vn];Nr[Lr][vn]=wn+pn;const Fn=Nr[vn][Lr-1]/Nr[Lr][vn];Nr[vn][Lr]=en+wn*Fn,en=pn*Fn}Nr[Lr][Lr]=en}for(let Lr=0;Lr<=fr;++Lr)Rr[0][Lr]=Nr[Lr][fr];for(let Lr=0;Lr<=fr;++Lr){let en=0,vn=1;const wn=[];for(let pn=0;pn<=fr;++pn)wn[pn]=Dr.slice(0);wn[0][0]=1;for(let pn=1;pn<=br;++pn){let Fn=0;const Gn=Lr-pn,Qn=fr-pn;Lr>=pn&&(wn[vn][0]=wn[en][0]/Nr[Qn+1][Gn],Fn=wn[vn][0]*Nr[Gn][Qn]);const Yn=Lr-1<=Qn?pn-1:fr-Lr;for(let Cn=Gn>=-1?1:-Gn;Cn<=Yn;++Cn)wn[vn][Cn]=(wn[en][Cn]-wn[en][Cn-1])/Nr[Qn+1][Gn+Cn],Fn+=wn[vn][Cn]*Nr[Gn+Cn][Qn];Lr<=Qn&&(wn[vn][pn]=-wn[en][pn-1]/Nr[Qn+1][Lr],Fn+=wn[vn][pn]*Nr[Lr][Qn]),Rr[pn][Lr]=Fn;const bs=en;en=vn,vn=bs}}let Hr=fr;for(let Lr=1;Lr<=br;++Lr){for(let en=0;en<=fr;++en)Rr[Lr][en]*=Hr;Hr*=fr-Lr}return Rr}(Pt,It,Et,Bt,St),Kt=[];for(let nr=0;nr<Mt.length;++nr){const ir=Mt[nr].clone(),fr=ir.w;ir.x*=fr,ir.y*=fr,ir.z*=fr,Kt[nr]=ir}for(let nr=0;nr<=Bt;++nr){const ir=Kt[Pt-Et].clone().multiplyScalar(qt[nr][0]);for(let fr=1;fr<=Et;++fr)ir.add(Kt[Pt-Et+fr].clone().multiplyScalar(qt[nr][fr]));kt[nr]=ir}for(let nr=Bt+1;nr<=Nt+1;++nr)kt[nr]=new et.Ltg(0,0,0);return kt}(nt,ot,ct,pt,ht);return function(Et){const St=Et.length,Mt=[],It=[];for(let Bt=0;Bt<St;++Bt){const kt=Et[Bt];Mt[Bt]=new et.Pa4(kt.x,kt.y,kt.z),It[Bt]=kt.w}const Nt=[];for(let Bt=0;Bt<St;++Bt){const kt=Mt[Bt].clone();for(let Pt=1;Pt<=Bt;++Pt)kt.sub(Nt[Bt-Pt].clone().multiplyScalar(wR(Bt,Pt)*It[Pt]));Nt[Bt]=kt.divideScalar(It[0])}return Nt}(_t)}(this.degree,this.knots,this.controlPoints,_e,1);return a.copy(rt[1]).normalize(),a}}let Po,_u,Kp;class xR extends et.aNw{constructor(s){super(s)}load(s,o,a,_e){const rt=this,nt=rt.path===""?et.Zp0.extractUrlBase(s):rt.path,ot=new et.hH6(this.manager);ot.setPath(rt.path),ot.setResponseType("arraybuffer"),ot.setRequestHeader(rt.requestHeader),ot.setWithCredentials(rt.withCredentials),ot.load(s,function(ct){try{o(rt.parse(ct,nt))}catch(pt){_e?_e(pt):console.error(pt),rt.manager.itemError(s)}},a,_e)}parse(s,o){if(function(_e){const rt="Kaydara FBX Binary  \0";return _e.byteLength>=rt.length&&rt===nu(_e,0,rt.length)}(s))Po=new PP().parse(s);else{const _e=nu(s);if(!function(rt){const nt=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let ot=0;function ct(pt){const ht=rt[pt-1];return rt=rt.slice(ot+pt),ot++,ht}for(let pt=0;pt<nt.length;++pt)if(ct(1)===nt[pt])return!1;return!0}(_e))throw new Error("THREE.FBXLoader: Unknown format.");if(Or(_e)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+Or(_e));Po=new XE().parse(_e)}const a=new et.dpR(this.manager).setPath(this.resourcePath||o).setCrossOrigin(this.crossOrigin);return new cA(a,this.manager).parse(Po)}}class cA{constructor(s,o){this.textureLoader=s,this.manager=o}parse(){_u=this.parseConnections();const s=this.parseImages(),o=this.parseTextures(s),a=this.parseMaterials(o),_e=this.parseDeformers(),rt=new ER().parse(_e);return this.parseScene(_e,rt,a),Kp}parseConnections(){const s=new Map;return"Connections"in Po&&Po.Connections.connections.forEach(function(o){const a=o[0],_e=o[1],rt=o[2];s.has(a)||s.set(a,{parents:[],children:[]});const nt={ID:_e,relationship:rt};s.get(a).parents.push(nt),s.has(_e)||s.set(_e,{parents:[],children:[]});const ot={ID:a,relationship:rt};s.get(_e).children.push(ot)}),s}parseImages(){const s={},o={};if("Video"in Po.Objects){const a=Po.Objects.Video;for(const _e in a){const rt=a[_e];if(s[parseInt(_e)]=rt.RelativeFilename||rt.Filename,"Content"in rt){const nt=rt.Content instanceof ArrayBuffer&&rt.Content.byteLength>0,ot=typeof rt.Content=="string"&&rt.Content!=="";if(nt||ot){const ct=this.parseImage(a[_e]);o[rt.RelativeFilename||rt.Filename]=ct}}}}for(const a in s){const _e=s[a];o[_e]!==void 0?s[a]=o[_e]:s[a]=s[a].split("\\").pop()}return s}parseImage(s){const o=s.Content,a=s.RelativeFilename||s.Filename,_e=a.slice(a.lastIndexOf(".")+1).toLowerCase();let rt;switch(_e){case"bmp":rt="image/bmp";break;case"jpg":case"jpeg":rt="image/jpeg";break;case"png":rt="image/png";break;case"tif":rt="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",a),rt="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+_e+'" is not supported.')}if(typeof o=="string")return"data:"+rt+";base64,"+o;{const nt=new Uint8Array(o);return window.URL.createObjectURL(new Blob([nt],{type:rt}))}}parseTextures(s){const o=new Map;if("Texture"in Po.Objects){const a=Po.Objects.Texture;for(const _e in a){const rt=this.parseTexture(a[_e],s);o.set(parseInt(_e),rt)}}return o}parseTexture(s,o){const a=this.loadTexture(s,o);a.ID=s.id,a.name=s.attrName;const _e=s.WrapModeU,rt=s.WrapModeV,nt=_e!==void 0?_e.value:0,ot=rt!==void 0?rt.value:0;if(a.wrapS=nt===0?et.rpg:et.uWy,a.wrapT=ot===0?et.rpg:et.uWy,"Scaling"in s){const ct=s.Scaling.value;a.repeat.x=ct[0],a.repeat.y=ct[1]}if("Translation"in s){const ct=s.Translation.value;a.offset.x=ct[0],a.offset.y=ct[1]}return a}loadTexture(s,o){let a;const _e=this.textureLoader.path,rt=_u.get(s.id).children;let nt;rt!==void 0&&rt.length>0&&o[rt[0].ID]!==void 0&&(a=o[rt[0].ID],a.indexOf("blob:")!==0&&a.indexOf("data:")!==0||this.textureLoader.setPath(void 0));const ot=s.FileName.slice(-3).toLowerCase();if(ot==="tga"){const ct=this.manager.getHandler(".tga");ct===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",s.RelativeFilename),nt=new et.xEZ):(ct.setPath(this.textureLoader.path),nt=ct.load(a))}else ot==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",s.RelativeFilename),nt=new et.xEZ):nt=this.textureLoader.load(a);return this.textureLoader.setPath(_e),nt}parseMaterials(s){const o=new Map;if("Material"in Po.Objects){const a=Po.Objects.Material;for(const _e in a){const rt=this.parseMaterial(a[_e],s);rt!==null&&o.set(parseInt(_e),rt)}}return o}parseMaterial(s,o){const a=s.id,_e=s.attrName;let rt=s.ShadingModel;if(typeof rt=="object"&&(rt=rt.value),!_u.has(a))return null;const nt=this.parseParameters(s,o,a);let ot;switch(rt.toLowerCase()){case"phong":ot=new et.xoR;break;case"lambert":ot=new et.YBo;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',rt),ot=new et.xoR}return ot.setValues(nt),ot.name=_e,ot}parseParameters(s,o,a){const _e={};s.BumpFactor&&(_e.bumpScale=s.BumpFactor.value),s.Diffuse?_e.color=new et.Ilk().fromArray(s.Diffuse.value):!s.DiffuseColor||s.DiffuseColor.type!=="Color"&&s.DiffuseColor.type!=="ColorRGB"||(_e.color=new et.Ilk().fromArray(s.DiffuseColor.value)),s.DisplacementFactor&&(_e.displacementScale=s.DisplacementFactor.value),s.Emissive?_e.emissive=new et.Ilk().fromArray(s.Emissive.value):!s.EmissiveColor||s.EmissiveColor.type!=="Color"&&s.EmissiveColor.type!=="ColorRGB"||(_e.emissive=new et.Ilk().fromArray(s.EmissiveColor.value)),s.EmissiveFactor&&(_e.emissiveIntensity=parseFloat(s.EmissiveFactor.value)),s.Opacity&&(_e.opacity=parseFloat(s.Opacity.value)),_e.opacity<1&&(_e.transparent=!0),s.ReflectionFactor&&(_e.reflectivity=s.ReflectionFactor.value),s.Shininess&&(_e.shininess=s.Shininess.value),s.Specular?_e.specular=new et.Ilk().fromArray(s.Specular.value):s.SpecularColor&&s.SpecularColor.type==="Color"&&(_e.specular=new et.Ilk().fromArray(s.SpecularColor.value));const rt=this;return _u.get(a).children.forEach(function(nt){const ot=nt.relationship;switch(ot){case"Bump":_e.bumpMap=rt.getTexture(o,nt.ID);break;case"Maya|TEX_ao_map":_e.aoMap=rt.getTexture(o,nt.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":_e.map=rt.getTexture(o,nt.ID),_e.map!==void 0&&(_e.map.encoding=et.knz);break;case"DisplacementColor":_e.displacementMap=rt.getTexture(o,nt.ID);break;case"EmissiveColor":_e.emissiveMap=rt.getTexture(o,nt.ID),_e.emissiveMap!==void 0&&(_e.emissiveMap.encoding=et.knz);break;case"NormalMap":case"Maya|TEX_normal_map":_e.normalMap=rt.getTexture(o,nt.ID);break;case"ReflectionColor":_e.envMap=rt.getTexture(o,nt.ID),_e.envMap!==void 0&&(_e.envMap.mapping=et.dSO,_e.envMap.encoding=et.knz);break;case"SpecularColor":_e.specularMap=rt.getTexture(o,nt.ID),_e.specularMap!==void 0&&(_e.specularMap.encoding=et.knz);break;case"TransparentColor":case"TransparencyFactor":_e.alphaMap=rt.getTexture(o,nt.ID),_e.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",ot)}}),_e}getTexture(s,o){return"LayeredTexture"in Po.Objects&&o in Po.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),o=_u.get(o).children[0].ID),s.get(o)}parseDeformers(){const s={},o={};if("Deformer"in Po.Objects){const a=Po.Objects.Deformer;for(const _e in a){const rt=a[_e],nt=_u.get(parseInt(_e));if(rt.attrType==="Skin"){const ot=this.parseSkeleton(nt,a);ot.ID=_e,nt.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),ot.geometryID=nt.parents[0].ID,s[_e]=ot}else if(rt.attrType==="BlendShape"){const ot={id:_e};ot.rawTargets=this.parseMorphTargets(nt,a),ot.id=_e,nt.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),o[_e]=ot}}}return{skeletons:s,morphTargets:o}}parseSkeleton(s,o){const a=[];return s.children.forEach(function(_e){const rt=o[_e.ID];if(rt.attrType!=="Cluster")return;const nt={ID:_e.ID,indices:[],weights:[],transformLink:new et.yGw().fromArray(rt.TransformLink.a)};"Indexes"in rt&&(nt.indices=rt.Indexes.a,nt.weights=rt.Weights.a),a.push(nt)}),{rawBones:a,bones:[]}}parseMorphTargets(s,o){const a=[];for(let _e=0;_e<s.children.length;_e++){const rt=s.children[_e],nt=o[rt.ID],ot={name:nt.attrName,initialWeight:nt.DeformPercent,id:nt.id,fullWeights:nt.FullWeights.a};if(nt.attrType!=="BlendShapeChannel")return;ot.geoID=_u.get(parseInt(rt.ID)).children.filter(function(ct){return ct.relationship===void 0})[0].ID,a.push(ot)}return a}parseScene(s,o,a){Kp=new et.ZAu;const _e=this.parseModels(s.skeletons,o,a),rt=Po.Objects.Model,nt=this;_e.forEach(function(ct){const pt=rt[ct.ID];nt.setLookAtProperties(ct,pt),_u.get(ct.ID).parents.forEach(function(ht){const _t=_e.get(ht.ID);_t!==void 0&&_t.add(ct)}),ct.parent===null&&Kp.add(ct)}),this.bindSkeleton(s.skeletons,o,_e),this.createAmbientLight(),Kp.traverse(function(ct){if(ct.userData.transformData){ct.parent&&(ct.userData.transformData.parentMatrix=ct.parent.matrix,ct.userData.transformData.parentMatrixWorld=ct.parent.matrixWorld);const pt=$o(ct.userData.transformData);ct.applyMatrix4(pt),ct.updateWorldMatrix()}});const ot=new SR().parse();Kp.children.length===1&&Kp.children[0].isGroup&&(Kp.children[0].animations=ot,Kp=Kp.children[0]),Kp.animations=ot}parseModels(s,o,a){const _e=new Map,rt=Po.Objects.Model;for(const nt in rt){const ot=parseInt(nt),ct=rt[nt],pt=_u.get(ot);let ht=this.buildSkeleton(pt,s,ot,ct.attrName);if(!ht){switch(ct.attrType){case"Camera":ht=this.createCamera(pt);break;case"Light":ht=this.createLight(pt);break;case"Mesh":ht=this.createMesh(pt,o,a);break;case"NurbsCurve":ht=this.createCurve(pt,o);break;case"LimbNode":case"Root":ht=new et.N$j;break;default:ht=new et.ZAu}ht.name=ct.attrName?et.iUV.sanitizeNodeName(ct.attrName):"",ht.ID=ot}this.getTransformData(ht,ct),_e.set(ot,ht)}return _e}buildSkeleton(s,o,a,_e){let rt=null;return s.parents.forEach(function(nt){for(const ot in o){const ct=o[ot];ct.rawBones.forEach(function(pt,ht){if(pt.ID===nt.ID){const _t=rt;rt=new et.N$j,rt.matrixWorld.copy(pt.transformLink),rt.name=_e?et.iUV.sanitizeNodeName(_e):"",rt.ID=a,ct.bones[ht]=rt,_t!==null&&rt.add(_t)}})}}),rt}createCamera(s){let o,a;if(s.children.forEach(function(_e){const rt=Po.Objects.NodeAttribute[_e.ID];rt!==void 0&&(a=rt)}),a===void 0)o=new et.Tme;else{let _e=0;a.CameraProjectionType!==void 0&&a.CameraProjectionType.value===1&&(_e=1);let rt=1;a.NearPlane!==void 0&&(rt=a.NearPlane.value/1e3);let nt=1e3;a.FarPlane!==void 0&&(nt=a.FarPlane.value/1e3);let ot=window.innerWidth,ct=window.innerHeight;a.AspectWidth!==void 0&&a.AspectHeight!==void 0&&(ot=a.AspectWidth.value,ct=a.AspectHeight.value);const pt=ot/ct;let ht=45;a.FieldOfView!==void 0&&(ht=a.FieldOfView.value);const _t=a.FocalLength?a.FocalLength.value:null;switch(_e){case 0:o=new et.cPb(ht,pt,rt,nt),_t!==null&&o.setFocalLength(_t);break;case 1:o=new et.iKG(-ot/2,ot/2,ct/2,-ct/2,rt,nt);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+_e+"."),o=new et.Tme}}return o}createLight(s){let o,a;if(s.children.forEach(function(_e){const rt=Po.Objects.NodeAttribute[_e.ID];rt!==void 0&&(a=rt)}),a===void 0)o=new et.Tme;else{let _e;_e=a.LightType===void 0?0:a.LightType.value;let rt=16777215;a.Color!==void 0&&(rt=new et.Ilk().fromArray(a.Color.value));let nt=a.Intensity===void 0?1:a.Intensity.value/100;a.CastLightOnObject!==void 0&&a.CastLightOnObject.value===0&&(nt=0);let ot=0;a.FarAttenuationEnd!==void 0&&(ot=a.EnableFarAttenuation!==void 0&&a.EnableFarAttenuation.value===0?0:a.FarAttenuationEnd.value);const ct=1;switch(_e){case 0:o=new et.cek(rt,nt,ot,ct);break;case 1:o=new et.Ox3(rt,nt);break;case 2:let pt=Math.PI/3;a.InnerAngle!==void 0&&(pt=et.M8C.degToRad(a.InnerAngle.value));let ht=0;a.OuterAngle!==void 0&&(ht=et.M8C.degToRad(a.OuterAngle.value),ht=Math.max(ht,1)),o=new et.PMe(rt,nt,ot,pt,ht,ct);break;default:console.warn("THREE.FBXLoader: Unknown light type "+a.LightType.value+", defaulting to a PointLight."),o=new et.cek(rt,nt)}a.CastShadows!==void 0&&a.CastShadows.value===1&&(o.castShadow=!0)}return o}createMesh(s,o,a){let _e,rt=null,nt=null;const ot=[];return s.children.forEach(function(ct){o.has(ct.ID)&&(rt=o.get(ct.ID)),a.has(ct.ID)&&ot.push(a.get(ct.ID))}),ot.length>1?nt=ot:ot.length>0?nt=ot[0]:(nt=new et.xoR({color:13421772}),ot.push(nt)),"color"in rt.attributes&&ot.forEach(function(ct){ct.vertexColors=!0}),rt.FBX_Deformer?(_e=new et.TUv(rt,nt),_e.normalizeSkinWeights()):_e=new et.Kj0(rt,nt),_e}createCurve(s,o){const a=s.children.reduce(function(rt,nt){return o.has(nt.ID)&&(rt=o.get(nt.ID)),rt},null),_e=new et.nls({color:3342591,linewidth:1});return new et.x12(a,_e)}getTransformData(s,o){const a={};"InheritType"in o&&(a.inheritType=parseInt(o.InheritType.value)),a.eulerOrder="RotationOrder"in o?Gs(o.RotationOrder.value):"ZYX","Lcl_Translation"in o&&(a.translation=o.Lcl_Translation.value),"PreRotation"in o&&(a.preRotation=o.PreRotation.value),"Lcl_Rotation"in o&&(a.rotation=o.Lcl_Rotation.value),"PostRotation"in o&&(a.postRotation=o.PostRotation.value),"Lcl_Scaling"in o&&(a.scale=o.Lcl_Scaling.value),"ScalingOffset"in o&&(a.scalingOffset=o.ScalingOffset.value),"ScalingPivot"in o&&(a.scalingPivot=o.ScalingPivot.value),"RotationOffset"in o&&(a.rotationOffset=o.RotationOffset.value),"RotationPivot"in o&&(a.rotationPivot=o.RotationPivot.value),s.userData.transformData=a}setLookAtProperties(s,o){"LookAtProperty"in o&&_u.get(s.ID).children.forEach(function(a){if(a.relationship==="LookAtProperty"){const _e=Po.Objects.Model[a.ID];if("Lcl_Translation"in _e){const rt=_e.Lcl_Translation.value;s.target!==void 0?(s.target.position.fromArray(rt),Kp.add(s.target)):s.lookAt(new et.Pa4().fromArray(rt))}}})}bindSkeleton(s,o,a){const _e=this.parsePoseNodes();for(const rt in s){const nt=s[rt];_u.get(parseInt(nt.ID)).parents.forEach(function(ot){if(o.has(ot.ID)){const ct=ot.ID;_u.get(ct).parents.forEach(function(pt){a.has(pt.ID)&&a.get(pt.ID).bind(new et.OdW(nt.bones),_e[pt.ID])})}})}}parsePoseNodes(){const s={};if("Pose"in Po.Objects){const o=Po.Objects.Pose;for(const a in o)if(o[a].attrType==="BindPose"&&o[a].NbPoseNodes>0){const _e=o[a].PoseNode;Array.isArray(_e)?_e.forEach(function(rt){s[rt.Node]=new et.yGw().fromArray(rt.Matrix.a)}):s[_e.Node]=new et.yGw().fromArray(_e.Matrix.a)}}return s}createAmbientLight(){if("GlobalSettings"in Po&&"AmbientColor"in Po.GlobalSettings){const s=Po.GlobalSettings.AmbientColor.value,o=s[0],a=s[1],_e=s[2];if(o!==0||a!==0||_e!==0){const rt=new et.Ilk(o,a,_e);Kp.add(new et.Mig(rt,1))}}}}class ER{parse(s){const o=new Map;if("Geometry"in Po.Objects){const a=Po.Objects.Geometry;for(const _e in a){const rt=_u.get(parseInt(_e)),nt=this.parseGeometry(rt,a[_e],s);o.set(parseInt(_e),nt)}}return o}parseGeometry(s,o,a){switch(o.attrType){case"Mesh":return this.parseMeshGeometry(s,o,a);case"NurbsCurve":return this.parseNurbsGeometry(o)}}parseMeshGeometry(s,o,a){const _e=a.skeletons,rt=[],nt=s.parents.map(function(_t){return Po.Objects.Model[_t.ID]});if(nt.length===0)return;const ot=s.children.reduce(function(_t,Et){return _e[Et.ID]!==void 0&&(_t=_e[Et.ID]),_t},null);s.children.forEach(function(_t){a.morphTargets[_t.ID]!==void 0&&rt.push(a.morphTargets[_t.ID])});const ct=nt[0],pt={};"RotationOrder"in ct&&(pt.eulerOrder=Gs(ct.RotationOrder.value)),"InheritType"in ct&&(pt.inheritType=parseInt(ct.InheritType.value)),"GeometricTranslation"in ct&&(pt.translation=ct.GeometricTranslation.value),"GeometricRotation"in ct&&(pt.rotation=ct.GeometricRotation.value),"GeometricScaling"in ct&&(pt.scale=ct.GeometricScaling.value);const ht=$o(pt);return this.genGeometry(o,ot,rt,ht)}genGeometry(s,o,a,_e){const rt=new et.u9r;s.attrName&&(rt.name=s.attrName);const nt=this.parseGeoNode(s,o),ot=this.genBuffers(nt),ct=new et.a$l(ot.vertex,3);if(ct.applyMatrix4(_e),rt.setAttribute("position",ct),ot.colors.length>0&&rt.setAttribute("color",new et.a$l(ot.colors,3)),o&&(rt.setAttribute("skinIndex",new et.qlB(ot.weightsIndices,4)),rt.setAttribute("skinWeight",new et.a$l(ot.vertexWeights,4)),rt.FBX_Deformer=o),ot.normal.length>0){const pt=new et.Vkp().getNormalMatrix(_e),ht=new et.a$l(ot.normal,3);ht.applyNormalMatrix(pt),rt.setAttribute("normal",ht)}if(ot.uvs.forEach(function(pt,ht){let _t="uv"+(ht+1).toString();ht===0&&(_t="uv"),rt.setAttribute(_t,new et.a$l(ot.uvs[ht],2))}),nt.material&&nt.material.mappingType!=="AllSame"){let pt=ot.materialIndex[0],ht=0;if(ot.materialIndex.forEach(function(_t,Et){_t!==pt&&(rt.addGroup(ht,Et-ht,pt),pt=_t,ht=Et)}),rt.groups.length>0){const _t=rt.groups[rt.groups.length-1],Et=_t.start+_t.count;Et!==ot.materialIndex.length&&rt.addGroup(Et,ot.materialIndex.length-Et,pt)}rt.groups.length===0&&rt.addGroup(0,ot.materialIndex.length,ot.materialIndex[0])}return this.addMorphTargets(rt,s,a,_e),rt}parseGeoNode(s,o){const a={};if(a.vertexPositions=s.Vertices!==void 0?s.Vertices.a:[],a.vertexIndices=s.PolygonVertexIndex!==void 0?s.PolygonVertexIndex.a:[],s.LayerElementColor&&(a.color=this.parseVertexColors(s.LayerElementColor[0])),s.LayerElementMaterial&&(a.material=this.parseMaterialIndices(s.LayerElementMaterial[0])),s.LayerElementNormal&&(a.normal=this.parseNormals(s.LayerElementNormal[0])),s.LayerElementUV){a.uv=[];let _e=0;for(;s.LayerElementUV[_e];)s.LayerElementUV[_e].UV&&a.uv.push(this.parseUVs(s.LayerElementUV[_e])),_e++}return a.weightTable={},o!==null&&(a.skeleton=o,o.rawBones.forEach(function(_e,rt){_e.indices.forEach(function(nt,ot){a.weightTable[nt]===void 0&&(a.weightTable[nt]=[]),a.weightTable[nt].push({id:rt,weight:_e.weights[ot]})})})),a}genBuffers(s){const o={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let a=0,_e=0,rt=!1,nt=[],ot=[],ct=[],pt=[],ht=[],_t=[];const Et=this;return s.vertexIndices.forEach(function(St,Mt){let It,Nt=!1;St<0&&(St^=-1,Nt=!0);let Bt=[],kt=[];if(nt.push(3*St,3*St+1,3*St+2),s.color){const Pt=Ln(Mt,a,St,s.color);ct.push(Pt[0],Pt[1],Pt[2])}if(s.skeleton){if(s.weightTable[St]!==void 0&&s.weightTable[St].forEach(function(Pt){kt.push(Pt.weight),Bt.push(Pt.id)}),kt.length>4){rt||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),rt=!0);const Pt=[0,0,0,0],qt=[0,0,0,0];kt.forEach(function(Kt,nr){let ir=Kt,fr=Bt[nr];qt.forEach(function(br,Tr,Dr){if(ir>br){Dr[Tr]=ir,ir=br;const Rr=Pt[Tr];Pt[Tr]=fr,fr=Rr}})}),Bt=Pt,kt=qt}for(;kt.length<4;)kt.push(0),Bt.push(0);for(let Pt=0;Pt<4;++Pt)ht.push(kt[Pt]),_t.push(Bt[Pt])}if(s.normal){const Pt=Ln(Mt,a,St,s.normal);ot.push(Pt[0],Pt[1],Pt[2])}s.material&&s.material.mappingType!=="AllSame"&&(It=Ln(Mt,a,St,s.material)[0],It<0&&(console.warn("THREE.FBXLoader: Invalid material index:",It),It=0)),s.uv&&s.uv.forEach(function(Pt,qt){const Kt=Ln(Mt,a,St,Pt);pt[qt]===void 0&&(pt[qt]=[]),pt[qt].push(Kt[0]),pt[qt].push(Kt[1])}),_e++,Nt&&(Et.genFace(o,s,nt,It,ot,ct,pt,ht,_t,_e),a++,_e=0,nt=[],ot=[],ct=[],pt=[],ht=[],_t=[])}),o}genFace(s,o,a,_e,rt,nt,ot,ct,pt,ht){for(let _t=2;_t<ht;_t++)s.vertex.push(o.vertexPositions[a[0]]),s.vertex.push(o.vertexPositions[a[1]]),s.vertex.push(o.vertexPositions[a[2]]),s.vertex.push(o.vertexPositions[a[3*(_t-1)]]),s.vertex.push(o.vertexPositions[a[3*(_t-1)+1]]),s.vertex.push(o.vertexPositions[a[3*(_t-1)+2]]),s.vertex.push(o.vertexPositions[a[3*_t]]),s.vertex.push(o.vertexPositions[a[3*_t+1]]),s.vertex.push(o.vertexPositions[a[3*_t+2]]),o.skeleton&&(s.vertexWeights.push(ct[0]),s.vertexWeights.push(ct[1]),s.vertexWeights.push(ct[2]),s.vertexWeights.push(ct[3]),s.vertexWeights.push(ct[4*(_t-1)]),s.vertexWeights.push(ct[4*(_t-1)+1]),s.vertexWeights.push(ct[4*(_t-1)+2]),s.vertexWeights.push(ct[4*(_t-1)+3]),s.vertexWeights.push(ct[4*_t]),s.vertexWeights.push(ct[4*_t+1]),s.vertexWeights.push(ct[4*_t+2]),s.vertexWeights.push(ct[4*_t+3]),s.weightsIndices.push(pt[0]),s.weightsIndices.push(pt[1]),s.weightsIndices.push(pt[2]),s.weightsIndices.push(pt[3]),s.weightsIndices.push(pt[4*(_t-1)]),s.weightsIndices.push(pt[4*(_t-1)+1]),s.weightsIndices.push(pt[4*(_t-1)+2]),s.weightsIndices.push(pt[4*(_t-1)+3]),s.weightsIndices.push(pt[4*_t]),s.weightsIndices.push(pt[4*_t+1]),s.weightsIndices.push(pt[4*_t+2]),s.weightsIndices.push(pt[4*_t+3])),o.color&&(s.colors.push(nt[0]),s.colors.push(nt[1]),s.colors.push(nt[2]),s.colors.push(nt[3*(_t-1)]),s.colors.push(nt[3*(_t-1)+1]),s.colors.push(nt[3*(_t-1)+2]),s.colors.push(nt[3*_t]),s.colors.push(nt[3*_t+1]),s.colors.push(nt[3*_t+2])),o.material&&o.material.mappingType!=="AllSame"&&(s.materialIndex.push(_e),s.materialIndex.push(_e),s.materialIndex.push(_e)),o.normal&&(s.normal.push(rt[0]),s.normal.push(rt[1]),s.normal.push(rt[2]),s.normal.push(rt[3*(_t-1)]),s.normal.push(rt[3*(_t-1)+1]),s.normal.push(rt[3*(_t-1)+2]),s.normal.push(rt[3*_t]),s.normal.push(rt[3*_t+1]),s.normal.push(rt[3*_t+2])),o.uv&&o.uv.forEach(function(Et,St){s.uvs[St]===void 0&&(s.uvs[St]=[]),s.uvs[St].push(ot[St][0]),s.uvs[St].push(ot[St][1]),s.uvs[St].push(ot[St][2*(_t-1)]),s.uvs[St].push(ot[St][2*(_t-1)+1]),s.uvs[St].push(ot[St][2*_t]),s.uvs[St].push(ot[St][2*_t+1])})}addMorphTargets(s,o,a,_e){if(a.length===0)return;s.morphTargetsRelative=!0,s.morphAttributes.position=[];const rt=this;a.forEach(function(nt){nt.rawTargets.forEach(function(ot){const ct=Po.Objects.Geometry[ot.geoID];ct!==void 0&&rt.genMorphGeometry(s,o,ct,_e,ot.name)})})}genMorphGeometry(s,o,a,_e,rt){const nt=o.PolygonVertexIndex!==void 0?o.PolygonVertexIndex.a:[],ot=a.Vertices!==void 0?a.Vertices.a:[],ct=a.Indexes!==void 0?a.Indexes.a:[],pt=3*s.attributes.position.count,ht=new Float32Array(pt);for(let Mt=0;Mt<ct.length;Mt++){const It=3*ct[Mt];ht[It]=ot[3*Mt],ht[It+1]=ot[3*Mt+1],ht[It+2]=ot[3*Mt+2]}const _t={vertexIndices:nt,vertexPositions:ht},Et=this.genBuffers(_t),St=new et.a$l(Et.vertex,3);St.name=rt||a.attrName,St.applyMatrix4(_e),s.morphAttributes.position.push(St)}parseNormals(s){const o=s.MappingInformationType,a=s.ReferenceInformationType,_e=s.Normals.a;let rt=[];return a==="IndexToDirect"&&("NormalIndex"in s?rt=s.NormalIndex.a:"NormalsIndex"in s&&(rt=s.NormalsIndex.a)),{dataSize:3,buffer:_e,indices:rt,mappingType:o,referenceType:a}}parseUVs(s){const o=s.MappingInformationType,a=s.ReferenceInformationType,_e=s.UV.a;let rt=[];return a==="IndexToDirect"&&(rt=s.UVIndex.a),{dataSize:2,buffer:_e,indices:rt,mappingType:o,referenceType:a}}parseVertexColors(s){const o=s.MappingInformationType,a=s.ReferenceInformationType,_e=s.Colors.a;let rt=[];return a==="IndexToDirect"&&(rt=s.ColorIndex.a),{dataSize:4,buffer:_e,indices:rt,mappingType:o,referenceType:a}}parseMaterialIndices(s){const o=s.MappingInformationType,a=s.ReferenceInformationType;if(o==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:a};const _e=s.Materials.a,rt=[];for(let nt=0;nt<_e.length;++nt)rt.push(nt);return{dataSize:1,buffer:_e,indices:rt,mappingType:o,referenceType:a}}parseNurbsGeometry(s){if(rT===void 0)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new et.u9r;const o=parseInt(s.Order);if(isNaN(o))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",s.Order,s.id),new et.u9r;const a=o-1,_e=s.KnotVector.a,rt=[],nt=s.Points.a;for(let ht=0,_t=nt.length;ht<_t;ht+=4)rt.push(new et.Ltg().fromArray(nt,ht));let ot,ct;if(s.Form==="Closed")rt.push(rt[0]);else if(s.Form==="Periodic"){ot=a,ct=_e.length-1-ot;for(let ht=0;ht<a;++ht)rt.push(rt[ht])}const pt=new rT(a,_e,rt,ot,ct).getPoints(12*rt.length);return new et.u9r().setFromPoints(pt)}}class SR{parse(){const s=[],o=this.parseClips();if(o!==void 0)for(const a in o){const _e=o[a],rt=this.addClip(_e);s.push(rt)}return s}parseClips(){if(Po.Objects.AnimationCurve===void 0)return;const s=this.parseAnimationCurveNodes();this.parseAnimationCurves(s);const o=this.parseAnimationLayers(s);return this.parseAnimStacks(o)}parseAnimationCurveNodes(){const s=Po.Objects.AnimationCurveNode,o=new Map;for(const a in s){const _e=s[a];if(_e.attrName.match(/S|R|T|DeformPercent/)!==null){const rt={id:_e.id,attr:_e.attrName,curves:{}};o.set(rt.id,rt)}}return o}parseAnimationCurves(s){const o=Po.Objects.AnimationCurve;for(const a in o){const _e={id:o[a].id,times:o[a].KeyTime.a.map(Mn),values:o[a].KeyValueFloat.a},rt=_u.get(_e.id);if(rt!==void 0){const nt=rt.parents[0].ID,ot=rt.parents[0].relationship;ot.match(/X/)?s.get(nt).curves.x=_e:ot.match(/Y/)?s.get(nt).curves.y=_e:ot.match(/Z/)?s.get(nt).curves.z=_e:ot.match(/d|DeformPercent/)&&s.has(nt)&&(s.get(nt).curves.morph=_e)}}}parseAnimationLayers(s){const o=Po.Objects.AnimationLayer,a=new Map;for(const _e in o){const rt=[],nt=_u.get(parseInt(_e));nt!==void 0&&(nt.children.forEach(function(ot,ct){if(s.has(ot.ID)){const pt=s.get(ot.ID);if(pt.curves.x!==void 0||pt.curves.y!==void 0||pt.curves.z!==void 0){if(rt[ct]===void 0){const ht=_u.get(ot.ID).parents.filter(function(_t){return _t.relationship!==void 0})[0].ID;if(ht!==void 0){const _t=Po.Objects.Model[ht.toString()];if(_t===void 0)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",ot);const Et={modelName:_t.attrName?et.iUV.sanitizeNodeName(_t.attrName):"",ID:_t.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Kp.traverse(function(St){St.ID===_t.id&&(Et.transform=St.matrix,St.userData.transformData&&(Et.eulerOrder=St.userData.transformData.eulerOrder))}),Et.transform||(Et.transform=new et.yGw),"PreRotation"in _t&&(Et.preRotation=_t.PreRotation.value),"PostRotation"in _t&&(Et.postRotation=_t.PostRotation.value),rt[ct]=Et}}rt[ct]&&(rt[ct][pt.attr]=pt)}else if(pt.curves.morph!==void 0){if(rt[ct]===void 0){const ht=_u.get(ot.ID).parents.filter(function(Nt){return Nt.relationship!==void 0})[0].ID,_t=_u.get(ht).parents[0].ID,Et=_u.get(_t).parents[0].ID,St=_u.get(Et).parents[0].ID,Mt=Po.Objects.Model[St],It={modelName:Mt.attrName?et.iUV.sanitizeNodeName(Mt.attrName):"",morphName:Po.Objects.Deformer[ht].attrName};rt[ct]=It}rt[ct][pt.attr]=pt}}}),a.set(parseInt(_e),rt))}return a}parseAnimStacks(s){const o=Po.Objects.AnimationStack,a={};for(const _e in o){const rt=_u.get(parseInt(_e)).children;rt.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const nt=s.get(rt[0].ID);a[_e]={name:o[_e].attrName,layer:nt}}return a}addClip(s){let o=[];const a=this;return s.layer.forEach(function(_e){o=o.concat(a.generateTracks(_e))}),new et.m7l(s.name,-1,o)}generateTracks(s){const o=[];let a=new et.Pa4,_e=new et._fP,rt=new et.Pa4;if(s.transform&&s.transform.decompose(a,_e,rt),a=a.toArray(),_e=new et.USm().setFromQuaternion(_e,s.eulerOrder).toArray(),rt=rt.toArray(),s.T!==void 0&&Object.keys(s.T.curves).length>0){const nt=this.generateVectorTrack(s.modelName,s.T.curves,a,"position");nt!==void 0&&o.push(nt)}if(s.R!==void 0&&Object.keys(s.R.curves).length>0){const nt=this.generateRotationTrack(s.modelName,s.R.curves,_e,s.preRotation,s.postRotation,s.eulerOrder);nt!==void 0&&o.push(nt)}if(s.S!==void 0&&Object.keys(s.S.curves).length>0){const nt=this.generateVectorTrack(s.modelName,s.S.curves,rt,"scale");nt!==void 0&&o.push(nt)}if(s.DeformPercent!==void 0){const nt=this.generateMorphTrack(s);nt!==void 0&&o.push(nt)}return o}generateVectorTrack(s,o,a,_e){const rt=this.getTimesForAllAxes(o),nt=this.getKeyframeTrackValues(rt,o,a);return new et.yC1(s+"."+_e,rt,nt)}generateRotationTrack(s,o,a,_e,rt,nt){o.x!==void 0&&(this.interpolateRotations(o.x),o.x.values=o.x.values.map(et.M8C.degToRad)),o.y!==void 0&&(this.interpolateRotations(o.y),o.y.values=o.y.values.map(et.M8C.degToRad)),o.z!==void 0&&(this.interpolateRotations(o.z),o.z.values=o.z.values.map(et.M8C.degToRad));const ot=this.getTimesForAllAxes(o),ct=this.getKeyframeTrackValues(ot,o,a);_e!==void 0&&((_e=_e.map(et.M8C.degToRad)).push(nt),_e=new et.USm().fromArray(_e),_e=new et._fP().setFromEuler(_e)),rt!==void 0&&((rt=rt.map(et.M8C.degToRad)).push(nt),rt=new et.USm().fromArray(rt),rt=new et._fP().setFromEuler(rt).invert());const pt=new et._fP,ht=new et.USm,_t=[];for(let Et=0;Et<ct.length;Et+=3)ht.set(ct[Et],ct[Et+1],ct[Et+2],nt),pt.setFromEuler(ht),_e!==void 0&&pt.premultiply(_e),rt!==void 0&&pt.multiply(rt),pt.toArray(_t,Et/3*4);return new et.iLg(s+".quaternion",ot,_t)}generateMorphTrack(s){const o=s.DeformPercent.curves.morph,a=o.values.map(function(rt){return rt/100}),_e=Kp.getObjectByName(s.modelName).morphTargetDictionary[s.morphName];return new et.dUE(s.modelName+".morphTargetInfluences["+_e+"]",o.times,a)}getTimesForAllAxes(s){let o=[];if(s.x!==void 0&&(o=o.concat(s.x.times)),s.y!==void 0&&(o=o.concat(s.y.times)),s.z!==void 0&&(o=o.concat(s.z.times)),o=o.sort(function(a,_e){return a-_e}),o.length>1){let a=1,_e=o[0];for(let rt=1;rt<o.length;rt++){const nt=o[rt];nt!==_e&&(o[a]=nt,_e=nt,a++)}o=o.slice(0,a)}return o}getKeyframeTrackValues(s,o,a){const _e=a,rt=[];let nt=-1,ot=-1,ct=-1;return s.forEach(function(pt){if(o.x&&(nt=o.x.times.indexOf(pt)),o.y&&(ot=o.y.times.indexOf(pt)),o.z&&(ct=o.z.times.indexOf(pt)),nt!==-1){const ht=o.x.values[nt];rt.push(ht),_e[0]=ht}else rt.push(_e[0]);if(ot!==-1){const ht=o.y.values[ot];rt.push(ht),_e[1]=ht}else rt.push(_e[1]);if(ct!==-1){const ht=o.z.values[ct];rt.push(ht),_e[2]=ht}else rt.push(_e[2])}),rt}interpolateRotations(s){for(let o=1;o<s.values.length;o++){const a=s.values[o-1],_e=s.values[o]-a,rt=Math.abs(_e);if(rt>=180){const nt=rt/180,ot=_e/nt;let ct=a+ot;const pt=s.times[o-1],ht=(s.times[o]-pt)/nt;let _t=pt+ht;const Et=[],St=[];for(;_t<s.times[o];)Et.push(_t),_t+=ht,St.push(ct),ct+=ot;s.times=jo(s.times,o,Et),s.values=jo(s.values,o,St)}}}}class XE{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(s){this.nodeStack.push(s),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(s,o){this.currentProp=s,this.currentPropName=o}parse(s){this.currentIndent=0,this.allNodes=new nT,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const o=this,a=s.split(/[\r\n]+/);return a.forEach(function(_e,rt){const nt=_e.match(/^[\s\t]*;/),ot=_e.match(/^[\s\t]*$/);if(nt||ot)return;const ct=_e.match("^\\t{"+o.currentIndent+"}(\\w+):(.*){",""),pt=_e.match("^\\t{"+o.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),ht=_e.match("^\\t{"+(o.currentIndent-1)+"}}");ct?o.parseNodeBegin(_e,ct):pt?o.parseNodeProperty(_e,pt,a[++rt]):ht?o.popStack():_e.match(/^[^\s\t}]/)&&o.parseNodePropertyContinued(_e)}),this.allNodes}parseNodeBegin(s,o){const a=o[1].trim().replace(/^"/,"").replace(/"$/,""),_e=o[2].split(",").map(function(ct){return ct.trim().replace(/^"/,"").replace(/"$/,"")}),rt={name:a},nt=this.parseNodeAttr(_e),ot=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(a,rt):a in ot?(a==="PoseNode"?ot.PoseNode.push(rt):ot[a].id!==void 0&&(ot[a]={},ot[a][ot[a].id]=ot[a]),nt.id!==""&&(ot[a][nt.id]=rt)):typeof nt.id=="number"?(ot[a]={},ot[a][nt.id]=rt):a!=="Properties70"&&(ot[a]=a==="PoseNode"?[rt]:rt),typeof nt.id=="number"&&(rt.id=nt.id),nt.name!==""&&(rt.attrName=nt.name),nt.type!==""&&(rt.attrType=nt.type),this.pushStack(rt)}parseNodeAttr(s){let o=s[0];s[0]!==""&&(o=parseInt(s[0]),isNaN(o)&&(o=s[0]));let a="",_e="";return s.length>1&&(a=s[1].replace(/^(\w+)::/,""),_e=s[2]),{id:o,name:a,type:_e}}parseNodeProperty(s,o,a){let _e=o[1].replace(/^"/,"").replace(/"$/,"").trim(),rt=o[2].replace(/^"/,"").replace(/"$/,"").trim();_e==="Content"&&rt===","&&(rt=a.replace(/"/g,"").replace(/,$/,"").trim());const nt=this.getCurrentNode();if(nt.name!=="Properties70"){if(_e==="C"){const ot=rt.split(",").slice(1),ct=parseInt(ot[0]),pt=parseInt(ot[1]);let ht=rt.split(",").slice(3);ht=ht.map(function(_t){return _t.trim().replace(/^"/,"")}),_e="connections",rt=[ct,pt],function(_t,Et){for(let St=0,Mt=_t.length,It=Et.length;St<It;St++,Mt++)_t[Mt]=Et[St]}(rt,ht),nt[_e]===void 0&&(nt[_e]=[])}_e==="Node"&&(nt.id=rt),_e in nt&&Array.isArray(nt[_e])?nt[_e].push(rt):_e!=="a"?nt[_e]=rt:nt.a=rt,this.setCurrentProp(nt,_e),_e==="a"&&rt.slice(-1)!==","&&(nt.a=xo(rt))}else this.parseNodeSpecialProperty(s,_e,rt)}parseNodePropertyContinued(s){const o=this.getCurrentNode();o.a+=s,s.slice(-1)!==","&&(o.a=xo(o.a))}parseNodeSpecialProperty(s,o,a){const _e=a.split('",').map(function(ht){return ht.trim().replace(/^\"/,"").replace(/\s/,"_")}),rt=_e[0],nt=_e[1],ot=_e[2],ct=_e[3];let pt=_e[4];switch(nt){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":pt=parseFloat(pt);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":pt=xo(pt)}this.getPrevNode()[rt]={type:nt,type2:ot,flag:ct,value:pt},this.setCurrentProp(this.getPrevNode(),rt)}}class PP{parse(s){const o=new X1(s);o.skip(23);const a=o.getUint32();if(a<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+a);const _e=new nT;for(;!this.endOfContent(o);){const rt=this.parseNode(o,a);rt!==null&&_e.add(rt.name,rt)}return _e}endOfContent(s){return s.size()%16==0?(s.getOffset()+160+16&-16)>=s.size():s.getOffset()+160+16>=s.size()}parseNode(s,o){const a={},_e=o>=7500?s.getUint64():s.getUint32(),rt=o>=7500?s.getUint64():s.getUint32();o>=7500?s.getUint64():s.getUint32();const nt=s.getUint8(),ot=s.getString(nt);if(_e===0)return null;const ct=[];for(let Et=0;Et<rt;Et++)ct.push(this.parseProperty(s));const pt=ct.length>0?ct[0]:"",ht=ct.length>1?ct[1]:"",_t=ct.length>2?ct[2]:"";for(a.singleProperty=rt===1&&s.getOffset()===_e;_e>s.getOffset();){const Et=this.parseNode(s,o);Et!==null&&this.parseSubNode(ot,a,Et)}return a.propertyList=ct,typeof pt=="number"&&(a.id=pt),ht!==""&&(a.attrName=ht),_t!==""&&(a.attrType=_t),ot!==""&&(a.name=ot),a}parseSubNode(s,o,a){if(a.singleProperty===!0){const _e=a.propertyList[0];Array.isArray(_e)?(o[a.name]=a,a.a=_e):o[a.name]=_e}else if(s==="Connections"&&a.name==="C"){const _e=[];a.propertyList.forEach(function(rt,nt){nt!==0&&_e.push(rt)}),o.connections===void 0&&(o.connections=[]),o.connections.push(_e)}else if(a.name==="Properties70")Object.keys(a).forEach(function(_e){o[_e]=a[_e]});else if(s==="Properties70"&&a.name==="P"){let _e=a.propertyList[0],rt=a.propertyList[1];const nt=a.propertyList[2],ot=a.propertyList[3];let ct;_e.indexOf("Lcl ")===0&&(_e=_e.replace("Lcl ","Lcl_")),rt.indexOf("Lcl ")===0&&(rt=rt.replace("Lcl ","Lcl_")),ct=rt==="Color"||rt==="ColorRGB"||rt==="Vector"||rt==="Vector3D"||rt.indexOf("Lcl_")===0?[a.propertyList[4],a.propertyList[5],a.propertyList[6]]:a.propertyList[4],o[_e]={type:rt,type2:nt,flag:ot,value:ct}}else o[a.name]===void 0?typeof a.id=="number"?(o[a.name]={},o[a.name][a.id]=a):o[a.name]=a:a.name==="PoseNode"?(Array.isArray(o[a.name])||(o[a.name]=[o[a.name]]),o[a.name].push(a)):o[a.name][a.id]===void 0&&(o[a.name][a.id]=a)}parseProperty(s){const o=s.getString(1);let a;switch(o){case"C":return s.getBoolean();case"D":return s.getFloat64();case"F":return s.getFloat32();case"I":return s.getInt32();case"L":return s.getInt64();case"R":return a=s.getUint32(),s.getArrayBuffer(a);case"S":return a=s.getUint32(),s.getString(a);case"Y":return s.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const _e=s.getUint32(),rt=s.getUint32(),nt=s.getUint32();if(rt===0)switch(o){case"b":case"c":return s.getBooleanArray(_e);case"d":return s.getFloat64Array(_e);case"f":return s.getFloat32Array(_e);case"i":return s.getInt32Array(_e);case"l":return s.getInt64Array(_e)}j===void 0&&console.error("THREE.FBXLoader: External library fflate.min.js required.");const ot=Kn(new Uint8Array(s.getArrayBuffer(nt))),ct=new X1(ot.buffer);switch(o){case"b":case"c":return ct.getBooleanArray(_e);case"d":return ct.getFloat64Array(_e);case"f":return ct.getFloat32Array(_e);case"i":return ct.getInt32Array(_e);case"l":return ct.getInt64Array(_e)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+o)}}}class X1{constructor(s,o){this.dv=new DataView(s),this.offset=0,this.littleEndian=o===void 0||o}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(s){this.offset+=s}getBoolean(){return(1&this.getUint8())==1}getBooleanArray(s){const o=[];for(let a=0;a<s;a++)o.push(this.getBoolean());return o}getUint8(){const s=this.dv.getUint8(this.offset);return this.offset+=1,s}getInt16(){const s=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,s}getInt32(){const s=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,s}getInt32Array(s){const o=[];for(let a=0;a<s;a++)o.push(this.getInt32());return o}getUint32(){const s=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,s}getInt64(){let s,o;return this.littleEndian?(s=this.getUint32(),o=this.getUint32()):(o=this.getUint32(),s=this.getUint32()),2147483648&o?(o=4294967295&~o,s=4294967295&~s,s===4294967295&&(o=o+1&4294967295),s=s+1&4294967295,-(4294967296*o+s)):4294967296*o+s}getInt64Array(s){const o=[];for(let a=0;a<s;a++)o.push(this.getInt64());return o}getUint64(){let s,o;return this.littleEndian?(s=this.getUint32(),o=this.getUint32()):(o=this.getUint32(),s=this.getUint32()),4294967296*o+s}getFloat32(){const s=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,s}getFloat32Array(s){const o=[];for(let a=0;a<s;a++)o.push(this.getFloat32());return o}getFloat64(){const s=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,s}getFloat64Array(s){const o=[];for(let a=0;a<s;a++)o.push(this.getFloat64());return o}getArrayBuffer(s){const o=this.dv.buffer.slice(this.offset,this.offset+s);return this.offset+=s,o}getString(s){let o=[];for(let _e=0;_e<s;_e++)o[_e]=this.getUint8();const a=o.indexOf(0);return a>=0&&(o=o.slice(0,a)),et.Zp0.decodeText(new Uint8Array(o))}}class nT{add(s,o){this[s]=o}}function Or(tt){const s=tt.match(/FBXVersion: (\d+)/);if(s)return parseInt(s[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function Mn(tt){return tt/46186158e3}const Un=[];function Ln(tt,s,o,a){let _e;switch(a.mappingType){case"ByPolygonVertex":_e=tt;break;case"ByPolygon":_e=s;break;case"ByVertice":_e=o;break;case"AllSame":_e=a.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+a.mappingType)}a.referenceType==="IndexToDirect"&&(_e=a.indices[_e]);const rt=_e*a.dataSize,nt=rt+a.dataSize;return function(ot,ct,pt,ht){for(let _t=pt,Et=0;_t<ht;_t++,Et++)ot[Et]=ct[_t];return ot}(Un,a.buffer,rt,nt)}const Xn=new et.USm,Es=new et.Pa4;function $o(tt){const s=new et.yGw,o=new et.yGw,a=new et.yGw,_e=new et.yGw,rt=new et.yGw,nt=new et.yGw,ot=new et.yGw,ct=new et.yGw,pt=new et.yGw,ht=new et.yGw,_t=new et.yGw,Et=new et.yGw,St=tt.inheritType?tt.inheritType:0;if(tt.translation&&s.setPosition(Es.fromArray(tt.translation)),tt.preRotation){const Tr=tt.preRotation.map(et.M8C.degToRad);Tr.push(tt.eulerOrder||et.USm.DefaultOrder),o.makeRotationFromEuler(Xn.fromArray(Tr))}if(tt.rotation){const Tr=tt.rotation.map(et.M8C.degToRad);Tr.push(tt.eulerOrder||et.USm.DefaultOrder),a.makeRotationFromEuler(Xn.fromArray(Tr))}if(tt.postRotation){const Tr=tt.postRotation.map(et.M8C.degToRad);Tr.push(tt.eulerOrder||et.USm.DefaultOrder),_e.makeRotationFromEuler(Xn.fromArray(Tr)),_e.invert()}tt.scale&&rt.scale(Es.fromArray(tt.scale)),tt.scalingOffset&&ot.setPosition(Es.fromArray(tt.scalingOffset)),tt.scalingPivot&&nt.setPosition(Es.fromArray(tt.scalingPivot)),tt.rotationOffset&&ct.setPosition(Es.fromArray(tt.rotationOffset)),tt.rotationPivot&&pt.setPosition(Es.fromArray(tt.rotationPivot)),tt.parentMatrixWorld&&(_t.copy(tt.parentMatrix),ht.copy(tt.parentMatrixWorld));const Mt=o.clone().multiply(a).multiply(_e),It=new et.yGw;It.extractRotation(ht);const Nt=new et.yGw;Nt.copyPosition(ht);const Bt=Nt.clone().invert().multiply(ht),kt=It.clone().invert().multiply(Bt),Pt=rt,qt=new et.yGw;if(St===0)qt.copy(It).multiply(Mt).multiply(kt).multiply(Pt);else if(St===1)qt.copy(It).multiply(kt).multiply(Mt).multiply(Pt);else{const Tr=new et.yGw().scale(new et.Pa4().setFromMatrixScale(_t)).clone().invert(),Dr=kt.clone().multiply(Tr);qt.copy(It).multiply(Mt).multiply(Dr).multiply(Pt)}const Kt=pt.clone().invert(),nr=nt.clone().invert();let ir=s.clone().multiply(ct).multiply(pt).multiply(o).multiply(a).multiply(_e).multiply(Kt).multiply(ot).multiply(nt).multiply(rt).multiply(nr);const fr=new et.yGw().copyPosition(ir),br=ht.clone().multiply(fr);return Et.copyPosition(br),ir=Et.clone().multiply(qt),ir.premultiply(ht.invert()),ir}function Gs(tt){const s=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return(tt=tt||0)===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),s[0]):s[tt]}function xo(tt){return tt.split(",").map(function(s){return parseFloat(s)})}function nu(tt,s,o){return s===void 0&&(s=0),o===void 0&&(o=tt.byteLength),et.Zp0.decodeText(new Uint8Array(tt,s,o))}function jo(tt,s,o){return tt.slice(0,s).concat(o).concat(tt.slice(s))}class go extends it{constructor(){super(...arguments),this.dependencies=[os],this._importer=new Yl(xR,["fbx"],!0)}async onAdded(s){mo.Importers.push(this._importer)}async onDispose(s){}async onRemove(s){mo.Importers.splice(mo.Importers.indexOf(this._importer),1)}}go.PluginType="FBXLoadPlugin";const Bu=new WeakMap;class J1 extends et.aNw{constructor(s){super(s),this.libraryPath="",this.libraryPending=null,this.libraryBinary=null,this.libraryConfig={},this.url="",this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.workerConfig={},this.materials=[],this.warnings=[]}setLibraryPath(s){return this.libraryPath=s,this}setWorkerLimit(s){return this.workerLimit=s,this}load(s,o,a,_e){const rt=new et.hH6(this.manager);rt.setPath(this.path),rt.setResponseType("arraybuffer"),rt.setRequestHeader(this.requestHeader),this.url=s,rt.load(s,nt=>{if(Bu.has(nt))return Bu.get(nt).promise.then(o).catch(_e);this.decodeObjects(nt,s).then(ot=>{ot.userData.warnings=this.warnings,o(ot)}).catch(ot=>_e(ot))},a,_e)}debug(){console.log("Task load: ",this.workerPool.map(s=>s._taskLoad))}decodeObjects(s,o){let a,_e;const rt=s.byteLength,nt=this._getWorker(rt).then(ot=>(a=ot,_e=this.workerNextTaskID++,new Promise((ct,pt)=>{a._callbacks[_e]={resolve:ct,reject:pt},a.postMessage({type:"decode",id:_e,buffer:s},[s])}))).then(ot=>this._createGeometry(ot.data)).catch(ot=>{throw ot});return nt.catch(()=>!0).then(()=>{a&&_e&&this._releaseTask(a,_e)}),Bu.set(s,{url:o,promise:nt}),nt}parse(s,o,a){this.decodeObjects(s,"").then(_e=>{_e.userData.warnings=this.warnings,o(_e)}).catch(_e=>a(_e))}_compareMaterials(s){const o={};o.name=s.name,o.color={},o.color.r=s.color.r,o.color.g=s.color.g,o.color.b=s.color.b,o.type=s.type;for(let a=0;a<this.materials.length;a++){const _e=this.materials[a],rt={};if(rt.name=_e.name,rt.color={},rt.color.r=_e.color.r,rt.color.g=_e.color.g,rt.color.b=_e.color.b,rt.type=_e.type,JSON.stringify(o)===JSON.stringify(rt))return _e}return this.materials.push(s),s}_createMaterial(s){if(s===void 0)return new et.Wid({color:new et.Ilk(1,1,1),metalness:.8,name:"default",side:2});const o=s.diffuseColor,a=new et.Ilk(o.r/255,o.g/255,o.b/255);o.r===0&&o.g===0&&o.b===0&&(a.r=1,a.g=1,a.b=1);const _e=new et.Wid({color:a,name:s.name,side:2,transparent:s.transparency>0,opacity:1-s.transparency}),rt=new et.dpR;for(let nt=0;nt<s.textures.length;nt++){const ot=s.textures[nt];if(ot.image!==null){const ct=rt.load(ot.image);switch(ot.type){case"Diffuse":_e.map=ct;break;case"Bump":_e.bumpMap=ct;break;case"Transparency":_e.alphaMap=ct,_e.transparent=!0;break;case"Emap":_e.envMap=ct}ct.wrapS=ot.wrapU===0?et.rpg:et.uWy,ct.wrapT=ot.wrapV===0?et.rpg:et.uWy,ct.repeat.set(ot.repeat[0],ot.repeat[1])}}return _e}_createGeometry(s){const o=new et.Tme,a=[],_e=[],rt=[];o.userData.layers=s.layers,o.userData.groups=s.groups,o.userData.settings=s.settings,o.userData.objectType="File3dm",o.userData.materials=null,o.name=this.url;let nt=s.objects;const ot=s.materials;for(let ct=0;ct<nt.length;ct++){const pt=nt[ct],ht=pt.attributes;switch(pt.objectType){case"InstanceDefinition":_e.push(pt);break;case"InstanceReference":rt.push(pt);break;default:let _t;if(ht.materialIndex>=0){const St=ot[ht.materialIndex];let Mt=this._createMaterial(St);Mt=this._compareMaterials(Mt),_t=this._createObject(pt,Mt)}else{const St=this._createMaterial();_t=this._createObject(pt,St)}if(_t===void 0)continue;const Et=s.layers[ht.layerIndex];_t.visible=!Et||s.layers[ht.layerIndex].visible,ht.isInstanceDefinitionObject?a.push(_t):o.add(_t)}}for(let ct=0;ct<_e.length;ct++){const pt=_e[ct];nt=[];for(let ht=0;ht<pt.attributes.objectIds.length;ht++){const _t=pt.attributes.objectIds[ht];for(let Et=0;Et<a.length;Et++)_t===a[Et].userData.attributes.id&&nt.push(a[Et])}for(let ht=0;ht<rt.length;ht++){const _t=rt[ht];if(_t.geometry.parentIdefId===pt.attributes.id){const Et=new et.Tme,St=_t.geometry.xform.array,Mt=new et.yGw;Mt.set(St[0],St[1],St[2],St[3],St[4],St[5],St[6],St[7],St[8],St[9],St[10],St[11],St[12],St[13],St[14],St[15]),Et.applyMatrix4(Mt);for(let It=0;It<nt.length;It++)Et.add(nt[It].clone(!0));o.add(Et)}}}return o.userData.materials=this.materials,o}_createObject(s,o){const a=new et.s4_,_e=s.attributes;let rt,nt,ot,ct;switch(s.objectType){case"Point":case"PointSet":rt=a.parse(s.geometry),rt.attributes.hasOwnProperty("color")?nt=new et.UY4({vertexColors:!0,sizeAttenuation:!1,size:2}):(ot=_e.drawColor,ct=new et.Ilk(ot.r/255,ot.g/255,ot.b/255),nt=new et.UY4({color:ct,sizeAttenuation:!1,size:2})),nt=this._compareMaterials(nt);const pt=new et.woe(rt,nt);return pt.userData.attributes=_e,pt.userData.objectType=s.objectType,_e.name&&(pt.name=_e.name),pt;case"Mesh":case"Extrusion":case"SubD":case"Brep":if(s.geometry===null)return;rt=a.parse(s.geometry),rt.attributes.hasOwnProperty("color")&&(o.vertexColors=!0),o===null&&(o=this._createMaterial(),o=this._compareMaterials(o));const ht=new et.Kj0(rt,o);return ht.castShadow=_e.castsShadows,ht.receiveShadow=_e.receivesShadows,ht.userData.attributes=_e,ht.userData.objectType=s.objectType,_e.name&&(ht.name=_e.name),ht;case"Curve":rt=a.parse(s.geometry),ot=_e.drawColor,ct=new et.Ilk(ot.r/255,ot.g/255,ot.b/255),nt=new et.nls({color:ct}),nt=this._compareMaterials(nt);const _t=new et.x12(rt,nt);return _t.userData.attributes=_e,_t.userData.objectType=s.objectType,_e.name&&(_t.name=_e.name),_t;case"TextDot":rt=s.geometry;const Et=document.createElement("canvas").getContext("2d"),St=`${rt.fontHeight}px ${rt.fontFace}`;Et.font=St;const Mt=Et.measureText(rt.text).width+10,It=rt.fontHeight+10,Nt=window.devicePixelRatio;Et.canvas.width=Mt*Nt,Et.canvas.height=It*Nt,Et.canvas.style.width=Mt+"px",Et.canvas.style.height=It+"px",Et.setTransform(Nt,0,0,Nt,0,0),Et.font=St,Et.textBaseline="middle",Et.textAlign="center",ct=_e.drawColor,Et.fillStyle=`rgba(${ct.r},${ct.g},${ct.b},${ct.a})`,Et.fillRect(0,0,Mt,It),Et.fillStyle="white",Et.fillText(rt.text,Mt/2,It/2);const Bt=new et.ROQ(Et.canvas);Bt.minFilter=et.wem,Bt.wrapS=et.uWy,Bt.wrapT=et.uWy,nt=new et.xeV({map:Bt,depthTest:!1});const kt=new et.jyi(nt);return kt.position.set(rt.point[0],rt.point[1],rt.point[2]),kt.scale.set(Mt/10,It/10,1),kt.userData.attributes=_e,kt.userData.objectType=s.objectType,_e.name&&(kt.name=_e.name),kt;case"Light":let Pt;switch(rt=s.geometry,rt.lightStyle.name){case"LightStyle_WorldPoint":Pt=new et.cek,Pt.castShadow=_e.castsShadows,Pt.position.set(rt.location[0],rt.location[1],rt.location[2]),Pt.shadow.normalBias=.1;break;case"LightStyle_WorldSpot":Pt=new et.PMe,Pt.castShadow=_e.castsShadows,Pt.position.set(rt.location[0],rt.location[1],rt.location[2]),Pt.target.position.set(rt.direction[0],rt.direction[1],rt.direction[2]),Pt.angle=rt.spotAngleRadians,Pt.shadow.normalBias=.1;break;case"LightStyle_WorldRectangular":Pt=new et.T_f;const qt=Math.abs(rt.width[2]),Kt=Math.abs(rt.length[0]);Pt.position.set(rt.location[0]-Kt/2,rt.location[1],rt.location[2]-qt/2),Pt.height=Kt,Pt.width=qt,Pt.lookAt(new et.Pa4(rt.direction[0],rt.direction[1],rt.direction[2]));break;case"LightStyle_WorldDirectional":Pt=new et.Ox3,Pt.castShadow=_e.castsShadows,Pt.position.set(rt.location[0],rt.location[1],rt.location[2]),Pt.target.position.set(rt.direction[0],rt.direction[1],rt.direction[2]),Pt.shadow.normalBias=.1}return Pt&&(Pt.intensity=rt.intensity,ot=rt.diffuse,ct=new et.Ilk(ot.r/255,ot.g/255,ot.b/255),Pt.color=ct,Pt.userData.attributes=_e,Pt.userData.objectType=s.objectType),Pt}}_initLibrary(){if(!this.libraryPending){const s=new et.hH6(this.manager);s.setPath(this.libraryPath);const o=new Promise((rt,nt)=>{s.load("rhino3dm.js",rt,void 0,nt)}),a=new et.hH6(this.manager);a.setPath(this.libraryPath),a.setResponseType("arraybuffer");const _e=new Promise((rt,nt)=>{a.load("rhino3dm.wasm",rt,void 0,nt)});this.libraryPending=Promise.all([o,_e]).then(([rt,nt])=>{this.libraryConfig.wasmBinary=nt;const ot=av.toString(),ct=["/* rhino3dm.js */",rt,"/* worker */",ot.substring(ot.indexOf("{")+1,ot.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([ct]))})}return this.libraryPending}_getWorker(s){return this._initLibrary().then(()=>{if(this.workerPool.length<this.workerLimit){const a=new Worker(this.workerSourceURL);a._callbacks={},a._taskCosts={},a._taskLoad=0,a.postMessage({type:"init",libraryConfig:this.libraryConfig}),a.onmessage=_e=>{const rt=_e.data;switch(rt.type){case"warning":this.warnings.push(rt.data),console.warn(rt.data);break;case"decode":a._callbacks[rt.id].resolve(rt);break;case"error":a._callbacks[rt.id].reject(rt);break;default:console.error('THREE.Rhino3dmLoader: Unexpected message, "'+rt.type+'"')}},this.workerPool.push(a)}else this.workerPool.sort(function(a,_e){return a._taskLoad>_e._taskLoad?-1:1});const o=this.workerPool[this.workerPool.length-1];return o._taskLoad+=s,o})}_releaseTask(s,o){s._taskLoad-=s._taskCosts[o],delete s._callbacks[o],delete s._taskCosts[o]}dispose(){for(let s=0;s<this.workerPool.length;++s)this.workerPool[s].terminate();return this.workerPool.length=0,this}}function av(){let tt,s,o,a;function _e(ot,ct){const pt=ot.geometry(),ht=ot.attributes();let _t,Et,St,Mt,It,Nt=pt.objectType;switch(Nt){case o.ObjectType.Curve:const Bt=nt(pt,100);St={},Et={},Mt={},St.itemSize=3,St.type="Float32Array",St.array=[];for(let nr=0;nr<Bt.length;nr++)St.array.push(Bt[nr][0]),St.array.push(Bt[nr][1]),St.array.push(Bt[nr][2]);Et.position=St,Mt.attributes=Et,_t={data:Mt};break;case o.ObjectType.Point:const kt=pt.location;St={};const Pt={};Et={},Mt={},St.itemSize=3,St.type="Float32Array",St.array=[kt[0],kt[1],kt[2]];const qt=ht.drawColor(ct);Pt.itemSize=3,Pt.type="Float32Array",Pt.array=[qt.r/255,qt.g/255,qt.b/255],Et.position=St,Et.color=Pt,Mt.attributes=Et,_t={data:Mt};break;case o.ObjectType.PointSet:case o.ObjectType.Mesh:_t=pt.toThreejsJSON();break;case o.ObjectType.Brep:const Kt=pt.faces();It=new o.Mesh;for(let nr=0;nr<Kt.count;nr++){const ir=Kt.get(nr),fr=ir.getMesh(o.MeshType.Any);fr&&(It.append(fr),fr.delete()),ir.delete()}It.faces().count>0&&(It.compact(),_t=It.toThreejsJSON(),Kt.delete()),It.delete();break;case o.ObjectType.Extrusion:It=pt.getMesh(o.MeshType.Any),It&&(_t=It.toThreejsJSON(),It.delete());break;case o.ObjectType.TextDot:_t=rt(pt);break;case o.ObjectType.Light:_t=rt(pt),_t.lightStyle.name==="LightStyle_WorldLinear"&&self.postMessage({type:"warning",id:a,data:{message:`THREE.3DMLoader: No conversion exists for ${Nt.constructor.name} ${_t.lightStyle.name}`,type:"no conversion",guid:ht.id}});break;case o.ObjectType.InstanceReference:_t=rt(pt),_t.xform=rt(pt.xform),_t.xform.array=pt.xform.toFloatArray(!0);break;case o.ObjectType.SubD:pt.subdivide(3),It=o.Mesh.createFromSubDControlNet(pt),It&&(_t=It.toThreejsJSON(),It.delete());break;default:self.postMessage({type:"warning",id:a,data:{message:`THREE.3DMLoader: Conversion not implemented for ${Nt.constructor.name}`,type:"not implemented",guid:ht.id}})}if(_t)return Et=rt(ht),Et.geometry=rt(pt),ht.groupCount>0&&(Et.groupIds=ht.getGroupList()),ht.userStringCount>0&&(Et.userStrings=ht.getUserStrings()),pt.userStringCount>0&&(Et.geometry.userStrings=pt.getUserStrings()),Et.drawColor=ht.drawColor(ct),Nt=Nt.constructor.name,Nt=Nt.substring(11,Nt.length),{geometry:_t,attributes:Et,objectType:Nt};self.postMessage({type:"warning",id:a,data:{message:`THREE.3DMLoader: ${Nt.constructor.name} has no associated mesh geometry.`,type:"missing mesh",guid:ht.id}})}function rt(ot){const ct={};for(const pt in ot){const ht=ot[pt];typeof ht!="function"&&(typeof ht=="object"&&ht!==null&&ht.hasOwnProperty("constructor")?ct[pt]={name:ht.constructor.name,value:ht.value}:ct[pt]=ht)}return ct}function nt(ot,ct){let pt=ct,ht=[];const _t=[];if(ot instanceof o.LineCurve)return[ot.pointAtStart,ot.pointAtEnd];if(ot instanceof o.PolylineCurve){pt=ot.pointCount;for(let Mt=0;Mt<pt;Mt++)ht.push(ot.point(Mt));return ht}if(ot instanceof o.PolyCurve){const Mt=ot.segmentCount;for(let It=0;It<Mt;It++){const Nt=ot.segmentCurve(It),Bt=nt(Nt,pt);ht=ht.concat(Bt),Nt.delete()}return ht}if(ot instanceof o.ArcCurve&&(pt=Math.floor(ot.angleDegrees/5),pt=pt<2?2:pt),ot instanceof o.NurbsCurve&&ot.degree===1){const Mt=ot.tryGetPolyline();for(let It=0;It<Mt.count;It++)ht.push(Mt.get(It));return Mt.delete(),ht}const Et=ot.domain,St=pt-1;for(let Mt=0;Mt<pt;Mt++){const It=Et[0]+Mt/St*(Et[1]-Et[0]);if(It===Et[0]||It===Et[1]){_t.push(It);continue}const Nt=ot.tangentAt(It),Bt=ot.tangentAt(_t.slice(-1)[0]),kt=Nt[0]*Nt[0]+Nt[1]*Nt[1]+Nt[2]*Nt[2],Pt=Bt[0]*Bt[0]+Bt[1]*Bt[1]+Bt[2]*Bt[2],qt=Math.sqrt(kt*Pt);let Kt;if(qt===0)Kt=Math.PI/2;else{const nr=(Nt.x*Bt.x+Nt.y*Bt.y+Nt.z*Bt.z)/qt;Kt=Math.acos(Math.max(-1,Math.min(1,nr)))}Kt<.1||_t.push(It)}return ht=_t.map(Mt=>ot.pointAt(Mt)),ht}onmessage=function(ot){const ct=ot.data;switch(ct.type){case"init":s=ct.libraryConfig;const pt=s.wasmBinary;let ht;tt=new Promise(function(Et){ht={wasmBinary:pt,onRuntimeInitialized:Et},rhino3dm(ht)}).then(()=>{o=ht});break;case"decode":a=ct.id;const _t=ct.buffer;tt.then(()=>{try{const Et=function(St,Mt){const It=new Uint8Array(Mt),Nt=St.File3dm.fromByteArray(It),Bt=[],kt=[],Pt=[],qt=[],Kt=[],nr=[],ir=[],fr=Nt.objects(),br=fr.count;for(let Ir=0;Ir<br;Ir++){const kr=fr.get(Ir),Hr=_e(kr,Nt);kr.delete(),Hr&&Bt.push(Hr)}for(let Ir=0;Ir<Nt.instanceDefinitions().count();Ir++){const kr=Nt.instanceDefinitions().get(Ir),Hr=rt(kr);Hr.objectIds=kr.getObjectIds(),Bt.push({geometry:null,attributes:Hr,objectType:"InstanceDefinition"})}const Tr=[St.TextureType.Diffuse,St.TextureType.Bump,St.TextureType.Transparency,St.TextureType.Opacity,St.TextureType.Emap],Dr=[St.TextureType.PBR_BaseColor,St.TextureType.PBR_Subsurface,St.TextureType.PBR_SubsurfaceScattering,St.TextureType.PBR_SubsurfaceScatteringRadius,St.TextureType.PBR_Metallic,St.TextureType.PBR_Specular,St.TextureType.PBR_SpecularTint,St.TextureType.PBR_Roughness,St.TextureType.PBR_Anisotropic,St.TextureType.PBR_Anisotropic_Rotation,St.TextureType.PBR_Sheen,St.TextureType.PBR_SheenTint,St.TextureType.PBR_Clearcoat,St.TextureType.PBR_ClearcoatBump,St.TextureType.PBR_ClearcoatRoughness,St.TextureType.PBR_OpacityIor,St.TextureType.PBR_OpacityRoughness,St.TextureType.PBR_Emission,St.TextureType.PBR_AmbientOcclusion,St.TextureType.PBR_Displacement];for(let Ir=0;Ir<Nt.materials().count();Ir++){const kr=Nt.materials().get(Ir),Hr=kr.physicallyBased();let Lr=rt(kr);const en=[];for(let vn=0;vn<Tr.length;vn++){const wn=kr.getTexture(Tr[vn]);if(wn){let pn=Tr[vn].constructor.name;pn=pn.substring(12,pn.length);const Fn={type:pn},Gn=Nt.getEmbeddedFileAsBase64(wn.fileName);Fn.wrapU=wn.wrapU,Fn.wrapV=wn.wrapV,Fn.wrapW=wn.wrapW;const Qn=wn.uvwTransform.toFloatArray(!0);Fn.repeat=[Qn[0],Qn[5]],Gn?Fn.image="data:image/png;base64,"+Gn:(self.postMessage({type:"warning",id:a,data:{message:`THREE.3DMLoader: Image for ${pn} texture not embedded in file.`,type:"missing resource"}}),Fn.image=null),en.push(Fn),wn.delete()}}if(Lr.textures=en,Hr.supported){for(let wn=0;wn<Dr.length;wn++){const pn=kr.getTexture(Dr[wn]);if(pn){const Fn=Nt.getEmbeddedFileAsBase64(pn.fileName);let Gn=Dr[wn].constructor.name;Gn=Gn.substring(12,Gn.length);const Qn={type:Gn,image:"data:image/png;base64,"+Fn};en.push(Qn),pn.delete()}}const vn=rt(kr.physicallyBased());Lr=Object.assign(vn,Lr)}kt.push(Lr),kr.delete(),Hr.delete()}for(let Ir=0;Ir<Nt.layers().count();Ir++){const kr=Nt.layers().get(Ir),Hr=rt(kr);Pt.push(Hr),kr.delete()}for(let Ir=0;Ir<Nt.views().count();Ir++){const kr=Nt.views().get(Ir),Hr=rt(kr);qt.push(Hr),kr.delete()}for(let Ir=0;Ir<Nt.namedViews().count();Ir++){const kr=Nt.namedViews().get(Ir),Hr=rt(kr);Kt.push(Hr),kr.delete()}for(let Ir=0;Ir<Nt.groups().count();Ir++){const kr=Nt.groups().get(Ir),Hr=rt(kr);nr.push(Hr),kr.delete()}const Rr=rt(Nt.settings()),Nr=Nt.strings().count();for(let Ir=0;Ir<Nr;Ir++)ir.push(Nt.strings().get(Ir));return Nt.delete(),{objects:Bt,materials:kt,layers:Pt,views:qt,namedViews:Kt,groups:nr,strings:ir,settings:Rr}}(o,_t);self.postMessage({type:"decode",id:ct.id,data:Et})}catch(Et){self.postMessage({type:"error",id:ct.id,error:Et})}})}}}class JE extends J1{constructor(s){super(s),this.setLibraryPath("https://cdn.jsdelivr.net/npm/rhino3dm@7.11.1/")}async loadAsync(s,o){return await super.loadAsync(s,o)}}class A_ extends it{constructor(){super(...arguments),this.dependencies=[os],this._importer=new Yl(JE,["3dm"],!0)}async onAdded(s){mo.Importers.push(this._importer)}async onDispose(s){}async onRemove(s){mo.Importers.splice(mo.Importers.indexOf(this._importer),1)}}A_.PluginType="Rhino3dmLoadPlugin";class iT extends it{constructor(){super(...arguments),this.dependencies=[os]}async onAdded(s){const o=document.createElement("script");o.type="module",o.innerHTML=`
import { MeshoptDecoder } from 'https://cdn.jsdelivr.net/gh/zeux/meshoptimizer@master/js/meshopt_decoder.module.js'
window.MeshoptDecoder = MeshoptDecoder
`,document.head.appendChild(o),this._script=o}async onDispose(s){}async onRemove(s){this._script&&(document.head.removeChild(this._script),this._script=void 0)}}iT.PluginType="GLTFMeshOptPlugin";class ZE extends et.aNw{constructor(s){super(s)}load(s,o,a,_e){const rt=this,nt=new et.hH6(this.manager);nt.setPath(this.path),nt.setResponseType("arraybuffer"),nt.setRequestHeader(this.requestHeader),nt.setWithCredentials(this.withCredentials),nt.load(s,function(ot){try{o(rt.parse(ot))}catch(ct){_e?_e(ct):console.error(ct),rt.manager.itemError(s)}},a,_e)}parse(s){function o(rt,nt,ot){for(let ct=0,pt=rt.length;ct<pt;ct++)if(rt[ct]!==nt.getUint8(ot+ct))return!1;return!0}const a=function(rt){if(typeof rt=="string"){const nt=new Uint8Array(rt.length);for(let ot=0;ot<rt.length;ot++)nt[ot]=255&rt.charCodeAt(ot);return nt.buffer||nt}return rt}(s);return function(rt){const nt=new DataView(rt);if(84+50*nt.getUint32(80,!0)===nt.byteLength)return!0;const ot=[115,111,108,105,100];for(let ct=0;ct<5;ct++)if(o(ot,nt,ct))return!1;return!0}(a)?function(rt){const nt=new DataView(rt),ot=nt.getUint32(80,!0);let ct,pt,ht,_t,Et,St,Mt,It,Nt=!1;for(let qt=0;qt<70;qt++)nt.getUint32(qt,!1)==1129270351&&nt.getUint8(qt+4)==82&&nt.getUint8(qt+5)==61&&(Nt=!0,_t=new Float32Array(3*ot*3),Et=nt.getUint8(qt+6)/255,St=nt.getUint8(qt+7)/255,Mt=nt.getUint8(qt+8)/255,It=nt.getUint8(qt+9)/255);const Bt=new et.u9r,kt=new Float32Array(3*ot*3),Pt=new Float32Array(3*ot*3);for(let qt=0;qt<ot;qt++){const Kt=84+50*qt,nr=nt.getFloat32(Kt,!0),ir=nt.getFloat32(Kt+4,!0),fr=nt.getFloat32(Kt+8,!0);if(Nt){const br=nt.getUint16(Kt+48,!0);32768&br?(ct=Et,pt=St,ht=Mt):(ct=(31&br)/31,pt=(br>>5&31)/31,ht=(br>>10&31)/31)}for(let br=1;br<=3;br++){const Tr=Kt+12*br,Dr=3*qt*3+3*(br-1);kt[Dr]=nt.getFloat32(Tr,!0),kt[Dr+1]=nt.getFloat32(Tr+4,!0),kt[Dr+2]=nt.getFloat32(Tr+8,!0),Pt[Dr]=nr,Pt[Dr+1]=ir,Pt[Dr+2]=fr,Nt&&(_t[Dr]=ct,_t[Dr+1]=pt,_t[Dr+2]=ht)}}return Bt.setAttribute("position",new et.TlE(kt,3)),Bt.setAttribute("normal",new et.TlE(Pt,3)),Nt&&(Bt.setAttribute("color",new et.TlE(_t,3)),Bt.hasColors=!0,Bt.alpha=It),Bt}(a):function(rt){const nt=new et.u9r,ot=/solid([\s\S]*?)endsolid/g,ct=/facet([\s\S]*?)endfacet/g;let pt=0;const ht=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,_t=new RegExp("vertex"+ht+ht+ht,"g"),Et=new RegExp("normal"+ht+ht+ht,"g"),St=[],Mt=[],It=new et.Pa4;let Nt,Bt=0,kt=0,Pt=0;for(;(Nt=ot.exec(rt))!==null;){kt=Pt;const qt=Nt[0];for(;(Nt=ct.exec(qt))!==null;){let ir=0,fr=0;const br=Nt[0];for(;(Nt=Et.exec(br))!==null;)It.x=parseFloat(Nt[1]),It.y=parseFloat(Nt[2]),It.z=parseFloat(Nt[3]),fr++;for(;(Nt=_t.exec(br))!==null;)St.push(parseFloat(Nt[1]),parseFloat(Nt[2]),parseFloat(Nt[3])),Mt.push(It.x,It.y,It.z),ir++,Pt++;fr!==1&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+pt),ir!==3&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+pt),pt++}const Kt=kt,nr=Pt-kt;nt.addGroup(Kt,nr,Bt),Bt++}return nt.setAttribute("position",new et.a$l(St,3)),nt.setAttribute("normal",new et.a$l(Mt,3)),nt}(typeof(_e=s)!="string"?et.Zp0.decodeText(new Uint8Array(_e)):_e);var _e}}class sT extends it{constructor(){super(...arguments),this.dependencies=[os]}async onAdded(s){this._importer||(this._importer=new Yl(ZE,["stl"],!0)),mo.Importers.push(this._importer)}async onDispose(s){this._importer=void 0}async onRemove(s){this._importer&&mo.Importers.splice(mo.Importers.indexOf(this._importer),1),this._importer=void 0}}sT.PluginType="STLLoadPlugin";class Z1 extends et.aNw{constructor(s){super(s)}load(s,o,a,_e){const rt=this,nt=this.path===""?et.Zp0.extractUrlBase(s):this.path,ot=new et.hH6(this.manager);ot.setPath(this.path),ot.setRequestHeader(this.requestHeader),ot.setWithCredentials(this.withCredentials),ot.load(s,function(ct){try{o(rt.parse(ct,nt))}catch(pt){_e?_e(pt):console.error(pt),rt.manager.itemError(s)}},a,_e)}setMaterialOptions(s){return this.materialOptions=s,this}parse(s,o){const a=s.split(`
`);let _e={};const rt=/\s+/,nt={};for(let ct=0;ct<a.length;ct++){let pt=a[ct];if(pt=pt.trim(),pt.length===0||pt.charAt(0)==="#")continue;const ht=pt.indexOf(" ");let _t=ht>=0?pt.substring(0,ht):pt;_t=_t.toLowerCase();let Et=ht>=0?pt.substring(ht+1):"";if(Et=Et.trim(),_t==="newmtl")_e={name:Et},nt[Et]=_e;else if(_t==="ka"||_t==="kd"||_t==="ks"||_t==="ke"){const St=Et.split(rt,3);_e[_t]=[parseFloat(St[0]),parseFloat(St[1]),parseFloat(St[2])]}else _e[_t]=Et}const ot=new Ap(this.resourcePath||o,this.materialOptions);return ot.setCrossOrigin(this.crossOrigin),ot.setManager(this.manager),ot.setMaterials(nt),ot}}class Ap{constructor(s="",o={}){this.baseUrl=s,this.options=o,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:et.Wl3,this.wrap=this.options.wrap!==void 0?this.options.wrap:et.rpg}setCrossOrigin(s){return this.crossOrigin=s,this}setManager(s){this.manager=s}setMaterials(s){this.materialsInfo=this.convert(s),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(s){if(!this.options)return s;const o={};for(const a in s){const _e=s[a],rt={};o[a]=rt;for(const nt in _e){let ot=!0,ct=_e[nt];const pt=nt.toLowerCase();switch(pt){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(ct=[ct[0]/255,ct[1]/255,ct[2]/255]),this.options&&this.options.ignoreZeroRGBs&&ct[0]===0&&ct[1]===0&&ct[2]===0&&(ot=!1)}ot&&(rt[pt]=ct)}}return o}async preload(){for(const s in this.materialsInfo)await this.create(s)}getIndex(s){return this.nameLookup[s]}async getAsArray(){let s=0;for(const o in this.materialsInfo)this.materialsArray[s]=await this.create(o),this.nameLookup[o]=s,s++;return this.materialsArray}async create(s){return this.materials[s]===void 0&&await this.createMaterial_(s),this.materials[s]}async createMaterial_(s){const o=this,a=this.materialsInfo[s],_e={name:s,side:this.side};async function rt(ct,pt){if(_e[ct])return;const ht=o.getTextureParams(pt,_e);return new Promise((_t,Et)=>{let St=!1,Mt=()=>!St&&(St=!0)&&_t();const It=o.loadTexture((Nt=o.baseUrl,typeof(Bt=ht.url)!="string"||Bt===""?"":/^https?:\/\//i.test(Bt)?Bt:Nt+Bt),void 0,kt=>{_e[ct]=kt,Mt()},void 0,Mt);var Nt,Bt;setTimeout(Mt,50),It.repeat.copy(ht.scale),It.offset.copy(ht.offset),It.wrapS=o.wrap,It.wrapT=o.wrap})}const nt=Array.from(Object.keys(a||{}));let ot=nt.includes("d")||nt.includes("D");for(const ct of nt){const pt=a[ct];let ht;if(pt!=="")switch(ct.toLowerCase()){case"kd":_e.color=new et.Ilk().fromArray(pt);break;case"ks":_e.specular=new et.Ilk().fromArray(pt);break;case"ke":_e.emissive=new et.Ilk().fromArray(pt);break;case"map_kd":await rt("map",pt);break;case"map_ks":await rt("specularMap",pt);break;case"map_ke":await rt("emissiveMap",pt);break;case"norm":await rt("normalMap",pt);break;case"map_bump":case"bump":await rt("bumpMap",pt);break;case"map_d":await rt("alphaMap",pt),_e.transparent=!0;break;case"ns":_e.shininess=parseFloat(pt);break;case"d":ht=parseFloat(pt),ht<1&&(_e.opacity=ht,_e.transparent=!0);break;case"tr":if(ot)break;ht=parseFloat(pt),this.options&&this.options.invertTrProperty&&(ht=1-ht),ht>0&&(_e.opacity=1-ht,_e.transparent=!0)}}return this.materials[s]=new et.xoR(_e),this.materials[s]}getTextureParams(s,o){const a={scale:new et.FM8(1,1),offset:new et.FM8(0,0)},_e=s.split(/\s+/);let rt;return rt=_e.indexOf("-bm"),rt>=0&&(o.bumpScale=parseFloat(_e[rt+1]),_e.splice(rt,2)),rt=_e.indexOf("-s"),rt>=0&&(a.scale.set(parseFloat(_e[rt+1]),parseFloat(_e[rt+2])),_e.splice(rt,4)),rt=_e.indexOf("-o"),rt>=0&&(a.offset.set(parseFloat(_e[rt+1]),parseFloat(_e[rt+2])),_e.splice(rt,4)),a.url=_e.join(" ").trim(),a}loadTexture(s,o,a,_e,rt){const nt=this.manager!==void 0?this.manager:et.tEQ;let ot=nt.getHandler(s);ot===null&&(ot=new et.dpR(nt)),ot.setCrossOrigin&&ot.setCrossOrigin(this.crossOrigin);const ct=ot.load(s,a,_e,rt);return o!==void 0&&(ct.mapping=o),ct}}const ex=/^[og]\s*(.+)?/,$v=/^mtllib /,Zs=/^usemtl /,cp=/^usemap /,eS=new et.Pa4,oT=new et.Pa4,CR=new et.Pa4,tx=new et.Pa4,lv=new et.Pa4;function DP(){const tt={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(s,o){if(this.object&&this.object.fromDeclaration===!1)return this.object.name=s,void(this.object.fromDeclaration=o!==!1);const a=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:s||"",fromDeclaration:o!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(_e,rt){const nt=this._finalize(!1);nt&&(nt.inherited||nt.groupCount<=0)&&this.materials.splice(nt.index,1);const ot={index:this.materials.length,name:_e||"",mtllib:Array.isArray(rt)&&rt.length>0?rt[rt.length-1]:"",smooth:nt!==void 0?nt.smooth:this.smooth,groupStart:nt!==void 0?nt.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(ct){const pt={index:typeof ct=="number"?ct:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return pt.clone=this.clone.bind(pt),pt}};return this.materials.push(ot),ot},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(_e){const rt=this.currentMaterial();if(rt&&rt.groupEnd===-1&&(rt.groupEnd=this.geometry.vertices.length/3,rt.groupCount=rt.groupEnd-rt.groupStart,rt.inherited=!1),_e&&this.materials.length>1)for(let nt=this.materials.length-1;nt>=0;nt--)this.materials[nt].groupCount<=0&&this.materials.splice(nt,1);return _e&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),rt}},a&&a.name&&typeof a.clone=="function"){const _e=a.clone(0);_e.inherited=!0,this.object.materials.push(_e)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(s,o){const a=parseInt(s,10);return 3*(a>=0?a-1:a+o/3)},parseNormalIndex:function(s,o){const a=parseInt(s,10);return 3*(a>=0?a-1:a+o/3)},parseUVIndex:function(s,o){const a=parseInt(s,10);return 2*(a>=0?a-1:a+o/2)},addVertex:function(s,o,a){const _e=this.vertices,rt=this.object.geometry.vertices;rt.push(_e[s+0],_e[s+1],_e[s+2]),rt.push(_e[o+0],_e[o+1],_e[o+2]),rt.push(_e[a+0],_e[a+1],_e[a+2])},addVertexPoint:function(s){const o=this.vertices;this.object.geometry.vertices.push(o[s+0],o[s+1],o[s+2])},addVertexLine:function(s){const o=this.vertices;this.object.geometry.vertices.push(o[s+0],o[s+1],o[s+2])},addNormal:function(s,o,a){const _e=this.normals,rt=this.object.geometry.normals;rt.push(_e[s+0],_e[s+1],_e[s+2]),rt.push(_e[o+0],_e[o+1],_e[o+2]),rt.push(_e[a+0],_e[a+1],_e[a+2])},addFaceNormal:function(s,o,a){const _e=this.vertices,rt=this.object.geometry.normals;eS.fromArray(_e,s),oT.fromArray(_e,o),CR.fromArray(_e,a),lv.subVectors(CR,oT),tx.subVectors(eS,oT),lv.cross(tx),lv.normalize(),rt.push(lv.x,lv.y,lv.z),rt.push(lv.x,lv.y,lv.z),rt.push(lv.x,lv.y,lv.z)},addColor:function(s,o,a){const _e=this.colors,rt=this.object.geometry.colors;_e[s]!==void 0&&rt.push(_e[s+0],_e[s+1],_e[s+2]),_e[o]!==void 0&&rt.push(_e[o+0],_e[o+1],_e[o+2]),_e[a]!==void 0&&rt.push(_e[a+0],_e[a+1],_e[a+2])},addUV:function(s,o,a){const _e=this.uvs,rt=this.object.geometry.uvs;rt.push(_e[s+0],_e[s+1]),rt.push(_e[o+0],_e[o+1]),rt.push(_e[a+0],_e[a+1])},addDefaultUV:function(){const s=this.object.geometry.uvs;s.push(0,0),s.push(0,0),s.push(0,0)},addUVLine:function(s){const o=this.uvs;this.object.geometry.uvs.push(o[s+0],o[s+1])},addFace:function(s,o,a,_e,rt,nt,ot,ct,pt){const ht=this.vertices.length;let _t=this.parseVertexIndex(s,ht),Et=this.parseVertexIndex(o,ht),St=this.parseVertexIndex(a,ht);if(this.addVertex(_t,Et,St),this.addColor(_t,Et,St),ot!==void 0&&ot!==""){const Mt=this.normals.length;_t=this.parseNormalIndex(ot,Mt),Et=this.parseNormalIndex(ct,Mt),St=this.parseNormalIndex(pt,Mt),this.addNormal(_t,Et,St)}else this.addFaceNormal(_t,Et,St);if(_e!==void 0&&_e!==""){const Mt=this.uvs.length;_t=this.parseUVIndex(_e,Mt),Et=this.parseUVIndex(rt,Mt),St=this.parseUVIndex(nt,Mt),this.addUV(_t,Et,St),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(s){this.object.geometry.type="Points";const o=this.vertices.length;for(let a=0,_e=s.length;a<_e;a++){const rt=this.parseVertexIndex(s[a],o);this.addVertexPoint(rt),this.addColor(rt)}},addLineGeometry:function(s,o){this.object.geometry.type="Line";const a=this.vertices.length,_e=this.uvs.length;for(let rt=0,nt=s.length;rt<nt;rt++)this.addVertexLine(this.parseVertexIndex(s[rt],a));for(let rt=0,nt=o.length;rt<nt;rt++)this.addUVLine(this.parseUVIndex(o[rt],_e))}};return tt.startObject("",!1),tt}class TR extends et.aNw{constructor(s){super(s),this.materials=null}load(s,o,a,_e){const rt=this,nt=new et.hH6(this.manager);nt.setPath(this.path),nt.setRequestHeader(this.requestHeader),nt.setWithCredentials(this.withCredentials),nt.load(s,async function(ot){try{o(await rt.parse(ot))}catch(ct){_e?_e(ct):console.error(ct),rt.manager.itemError(s)}},a,_e)}setMaterials(s){return this.materials=s,this}async parse(s){const o=new DP;s.indexOf(`\r
`)!==-1&&(s=s.replace(/\r\n/g,`
`)),s.indexOf(`\\
`)!==-1&&(s=s.replace(/\\\n/g,""));const a=s.split(`
`);let _e="",rt="",nt=0,ot=[];const ct=typeof"".trimLeft=="function";for(let ht=0,_t=a.length;ht<_t;ht++)if(_e=a[ht],_e=ct?_e.trimLeft():_e.trim(),nt=_e.length,nt!==0&&(rt=_e.charAt(0),rt!=="#"))if(rt==="v"){const Et=_e.split(/\s+/);switch(Et[0]){case"v":o.vertices.push(parseFloat(Et[1]),parseFloat(Et[2]),parseFloat(Et[3])),Et.length>=7?o.colors.push(parseFloat(Et[4]),parseFloat(Et[5]),parseFloat(Et[6])):o.colors.push(void 0,void 0,void 0);break;case"vn":o.normals.push(parseFloat(Et[1]),parseFloat(Et[2]),parseFloat(Et[3]));break;case"vt":o.uvs.push(parseFloat(Et[1]),parseFloat(Et[2]))}}else if(rt==="f"){const Et=_e.substr(1).trim().split(/\s+/),St=[];for(let It=0,Nt=Et.length;It<Nt;It++){const Bt=Et[It];if(Bt.length>0){const kt=Bt.split("/");St.push(kt)}}const Mt=St[0];for(let It=1,Nt=St.length-1;It<Nt;It++){const Bt=St[It],kt=St[It+1];o.addFace(Mt[0],Bt[0],kt[0],Mt[1],Bt[1],kt[1],Mt[2],Bt[2],kt[2])}}else if(rt==="l"){const Et=_e.substring(1).trim().split(" ");let St=[];const Mt=[];if(_e.indexOf("/")===-1)St=Et;else for(let It=0,Nt=Et.length;It<Nt;It++){const Bt=Et[It].split("/");Bt[0]!==""&&St.push(Bt[0]),Bt[1]!==""&&Mt.push(Bt[1])}o.addLineGeometry(St,Mt)}else if(rt==="p"){const Et=_e.substr(1).trim().split(" ");o.addPointGeometry(Et)}else if((ot=ex.exec(_e))!==null){const Et=(" "+ot[0].substr(1).trim()).substr(1);o.startObject(Et)}else if(Zs.test(_e))o.object.startMaterial(_e.substring(7).trim(),o.materialLibraries);else if($v.test(_e)){o.materialLibraries.push(_e.substring(7).trim());const Et=_e.substring(7).trim(),St=this.manager.getHandler(Et);if(St){const Mt=await St.loadAsync(Et).catch(It=>{console.warn(It)});Mt&&this.setMaterials(Mt)}else console.warn("OBJLoader2: Set MTLLoader to loading manager to load materials.")}else if(cp.test(_e))console.warn('OBJLoader2: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(rt==="s"){if(ot=_e.split(" "),ot.length>1){const St=ot[1].trim().toLowerCase();o.object.smooth=St!=="0"&&St!=="off"}else o.object.smooth=!0;const Et=o.object.currentMaterial();Et&&(Et.smooth=o.object.smooth)}else{if(_e==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+_e+'"')}o.finalize();const pt=new et.ZAu;if(pt.materialLibraries=[].concat(o.materialLibraries),!(o.objects.length===1&&o.objects[0].geometry.vertices.length===0))for(let ht=0,_t=o.objects.length;ht<_t;ht++){const Et=o.objects[ht],St=Et.geometry,Mt=Et.materials,It=St.type==="Line",Nt=St.type==="Points";let Bt=!1;if(St.vertices.length===0)continue;const kt=new et.u9r;kt.setAttribute("position",new et.a$l(St.vertices,3)),St.normals.length>0&&kt.setAttribute("normal",new et.a$l(St.normals,3)),St.colors.length>0&&(Bt=!0,kt.setAttribute("color",new et.a$l(St.colors,3))),St.hasUVIndices===!0&&kt.setAttribute("uv",new et.a$l(St.uvs,2));const Pt=[];for(let Kt=0,nr=Mt.length;Kt<nr;Kt++){const ir=Mt[Kt],fr=ir.name+"_"+ir.smooth+"_"+Bt;let br=o.materials[fr];if(this.materials!==null)if(br=await this.materials.create(ir.name),!It||!br||br instanceof et.nls){if(Nt&&br&&!(br instanceof et.UY4)){const Tr=new et.UY4({size:10,sizeAttenuation:!1});et.F5T.prototype.copy.call(Tr,br),Tr.color.copy(br.color),Tr.map=br.map,br=Tr}}else{const Tr=new et.nls;et.F5T.prototype.copy.call(Tr,br),Tr.color.copy(br.color),br=Tr}br===void 0&&(br=It?new et.nls:Nt?new et.UY4({size:1,sizeAttenuation:!1}):new et.xoR,br.name=ir.name,br.flatShading=!ir.smooth,br.vertexColors=Bt,o.materials[fr]=br),Pt.push(br)}let qt;if(Pt.length>1){for(let Kt=0,nr=Mt.length;Kt<nr;Kt++){const ir=Mt[Kt];kt.addGroup(ir.groupStart,ir.groupCount,Kt)}qt=It?new et.ejS(kt,Pt):Nt?new et.woe(kt,Pt):new et.Kj0(kt,Pt)}else qt=It?new et.ejS(kt,Pt[0]):Nt?new et.woe(kt,Pt[0]):new et.Kj0(kt,Pt[0]);qt.name=Et.name,pt.add(qt)}else if(o.vertices.length>0){const ht=new et.UY4({size:1,sizeAttenuation:!1}),_t=new et.u9r;_t.setAttribute("position",new et.a$l(o.vertices,3)),o.colors.length>0&&o.colors[0]!==void 0&&(_t.setAttribute("color",new et.a$l(o.colors,3)),ht.vertexColors=!0);const Et=new et.woe(_t,ht);pt.add(Et)}return pt}}class aT extends it{constructor(){super(...arguments),this.dependencies=[os],this._importer1=new Yl(TR,["obj"],!0),this._importer2=new Yl(Z1,["mtl"],!1)}async onAdded(s){mo.Importers.push(this._importer1),mo.Importers.push(this._importer2)}async onDispose(s){}async onRemove(s){mo.Importers.splice(mo.Importers.indexOf(this._importer1),1),mo.Importers.splice(mo.Importers.indexOf(this._importer2),1)}}aT.PluginType="ObjMtlLoadPlugin";class BP extends et.DqL{constructor(s){super(s)}parse(s,o){const a=new kP(s,1);return{mipmaps:a.mipmaps(o),width:a.pixelWidth,height:a.pixelHeight,format:a.glInternalFormat,isCubemap:a.numberOfFaces===6,mipmapCount:a.numberOfMipmapLevels}}}class kP{constructor(s,o){this.arrayBuffer=s;const a=new Uint8Array(this.arrayBuffer,0,12);if(a[0]!==171||a[1]!==75||a[2]!==84||a[3]!==88||a[4]!==32||a[5]!==49||a[6]!==49||a[7]!==187||a[8]!==13||a[9]!==10||a[10]!==26||a[11]!==10)return void console.error("texture missing KTX identifier");const _e=Uint32Array.BYTES_PER_ELEMENT,rt=new DataView(this.arrayBuffer,12,13*_e),nt=rt.getUint32(0,!0)===67305985;this.glType=rt.getUint32(1*_e,nt),this.glTypeSize=rt.getUint32(2*_e,nt),this.glFormat=rt.getUint32(3*_e,nt),this.glInternalFormat=rt.getUint32(4*_e,nt),this.glBaseInternalFormat=rt.getUint32(5*_e,nt),this.pixelWidth=rt.getUint32(6*_e,nt),this.pixelHeight=rt.getUint32(7*_e,nt),this.pixelDepth=rt.getUint32(8*_e,nt),this.numberOfArrayElements=rt.getUint32(9*_e,nt),this.numberOfFaces=rt.getUint32(10*_e,nt),this.numberOfMipmapLevels=rt.getUint32(11*_e,nt),this.bytesOfKeyValueData=rt.getUint32(12*_e,nt),this.glType===0?(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),this.pixelHeight!==0&&this.pixelDepth===0?this.numberOfArrayElements===0?this.numberOfFaces===o?this.loadType=0:console.warn("number of faces expected"+o+", but found "+this.numberOfFaces):console.warn("texture arrays not currently supported"):console.warn("only 2D textures currently supported")):console.warn("only compressed formats currently supported")}mipmaps(s){const o=[];let a=64+this.bytesOfKeyValueData,_e=this.pixelWidth,rt=this.pixelHeight;const nt=s?this.numberOfMipmapLevels:1;for(let ot=0;ot<nt;ot++){const ct=new Int32Array(this.arrayBuffer,a,1)[0];a+=4;for(let pt=0;pt<this.numberOfFaces;pt++){const ht=new Uint8Array(this.arrayBuffer,a,ct);o.push({data:ht,width:_e,height:rt}),a+=ct,a+=3-(ct+3)%4}_e=Math.max(1,.5*_e),rt=Math.max(1,.5*rt)}return o}}class tS extends it{constructor(){super(...arguments),this.dependencies=[os]}async onAdded(s){this._importer||(this._importer=new Yl(BP,["ktx"],!1)),mo.Importers.push(this._importer)}async onDispose(s){this._importer=void 0}async onRemove(s){this._importer&&mo.Importers.splice(mo.Importers.indexOf(this._importer),1),this._importer=void 0}}tS.PluginType="KTXLoadPlugin";class OP extends et.hH6{constructor(s){super(s),this.responseType="blob"}}class Bl extends et.hH6{constructor(s){super(s),this.responseType="blob"}load(s,o,a,_e){return super.load(s,rt=>{try{o==null||o(Su(rt))}catch(nt){_e==null||_e(nt)}},a,_e)}}class MR{async parseAsync(s,o){var a;return new Blob([JSON.stringify(s,null,(a=o.jsonSpaces)!==null&&a!==void 0?a:2)],{type:"application/json"})}}class b_{async parseAsync(s,o){return new Blob([s],{type:"text/plain"})}}class w_{constructor(){this.pluginCallbacks=[],this.register(function(s){return new Jp(s)}),this.register(function(s){return new rx(s)}),this.register(function(s){return new LP(s)}),this.register(function(s){return new oL(s)}),this.register(function(s){return new aL(s)}),this.register(function(s){return new RR(s)}),this.register(function(s){return new lL(s)}),this.register(function(s){return new sL(s)}),this.register(function(s){return new uL(s)})}register(s){return this.pluginCallbacks.indexOf(s)===-1&&this.pluginCallbacks.push(s),this}unregister(s){return this.pluginCallbacks.indexOf(s)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(s),1),this}parse(s,o,a,_e,rt){const nt=rt||new lT,ot=[];for(let ct=0,pt=this.pluginCallbacks.length;ct<pt;ct++)ot.push(this.pluginCallbacks[ct](nt));nt.setPlugins(ot),nt.write(s,o,_e).catch(a)}parseAsync(s,o){const a=this;return new Promise(function(_e,rt){a.parse(s,_e,rt,o)})}}const rS=5121,dA=5123,Xp={};Xp[et.TyD]=9728,Xp[et.YLQ]=9984,Xp[et.aH4]=9986,Xp[et.wem]=9729,Xp[et.qyh]=9985,Xp[et.D1R]=9987,Xp[et.uWy]=33071,Xp[et.rpg]=10497,Xp[et.OoA]=33648;const bp={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"};function jv(tt,s){return tt.length===s.length&&tt.every(function(o,a){return o===s[a]})}function nS(tt){return 4*Math.ceil(tt/4)}function uv(tt,s=0){const o=nS(tt.byteLength);if(o!==tt.byteLength){const a=new Uint8Array(o);if(a.set(new Uint8Array(tt)),s!==0)for(let _e=tt.byteLength;_e<o;_e++)a[_e]=s;return a.buffer}return tt}function cv(tt,s){if(tt.toBlob!==void 0)return new Promise(a=>tt.toBlob(a,s));let o;return s==="image/jpeg"?o=.92:s==="image/webp"&&(o=.8),tt.convertToBlob({type:s,quality:o})}class lT{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(s){this.plugins=s}async write(s,o,a){this.options=Object.assign({},{binary:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},a),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(s),await Promise.all(this.pending);const _e=this,rt=_e.buffers,nt=_e.json;a=_e.options;const ot=_e.extensionsUsed,ct=new Blob(rt,{type:"application/octet-stream"}),pt=Object.keys(ot);if(pt.length>0&&(nt.extensionsUsed=pt),nt.buffers&&nt.buffers.length>0&&(nt.buffers[0].byteLength=ct.size),a.binary===!0){const ht=new FileReader;ht.readAsArrayBuffer(ct),ht.onloadend=function(){const _t=uv(ht.result),Et=new DataView(new ArrayBuffer(8));Et.setUint32(0,_t.byteLength,!0),Et.setUint32(4,5130562,!0);const St=uv((Mt=JSON.stringify(nt),new TextEncoder().encode(Mt).buffer),32);var Mt;const It=new DataView(new ArrayBuffer(8));It.setUint32(0,St.byteLength,!0),It.setUint32(4,1313821514,!0);const Nt=new ArrayBuffer(12),Bt=new DataView(Nt);Bt.setUint32(0,1179937895,!0),Bt.setUint32(4,2,!0);const kt=12+It.byteLength+St.byteLength+Et.byteLength+_t.byteLength;Bt.setUint32(8,kt,!0);const Pt=new Blob([Nt,It,St,Et,_t],{type:"application/octet-stream"}),qt=new FileReader;qt.readAsArrayBuffer(Pt),qt.onloadend=function(){o(qt.result)}}}else if(nt.buffers&&nt.buffers.length>0){const ht=new FileReader;ht.readAsDataURL(ct),ht.onloadend=function(){const _t=ht.result;nt.buffers[0].uri=_t,o(nt)}}else o(nt)}serializeUserData(s,o){if(Object.keys(s.userData).length===0)return;const a=this.options,_e=this.extensionsUsed;try{const rt=JSON.parse(JSON.stringify(s.userData));if(a.includeCustomExtensions&&rt.gltfExtensions){o.extensions===void 0&&(o.extensions={});for(const nt in rt.gltfExtensions)o.extensions[nt]=rt.gltfExtensions[nt],_e[nt]=!0;delete rt.gltfExtensions}Object.keys(rt).length>0&&(o.extras=rt)}catch(rt){console.warn("THREE.GLTFExporter: userData of '"+s.name+"' won't be serialized because of JSON.stringify error - "+rt.message),console.warn({...s.userData})}}getUID(s,o=!1){if(this.uids.has(s)===!1){const a=new Map;a.set(!0,this.uid++),a.set(!1,this.uid++),this.uids.set(s,a)}return this.uids.get(s).get(o)}isNormalizedNormalAttribute(s){if(this.cache.attributesNormalized.has(s))return!1;const o=new et.Pa4;for(let a=0,_e=s.count;a<_e;a++)if(Math.abs(o.fromBufferAttribute(s,a).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(s){const o=this.cache;if(o.attributesNormalized.has(s))return o.attributesNormalized.get(s);const a=s.clone(),_e=new et.Pa4;for(let rt=0,nt=a.count;rt<nt;rt++)_e.fromBufferAttribute(a,rt),_e.x===0&&_e.y===0&&_e.z===0?_e.setX(1):_e.normalize(),a.setXYZ(rt,_e.x,_e.y,_e.z);return o.attributesNormalized.set(s,a),a}applyTextureTransform(s,o){let a=!1;const _e={};o.offset.x===0&&o.offset.y===0||(_e.offset=o.offset.toArray(),a=!0),o.rotation!==0&&(_e.rotation=o.rotation,a=!0),o.repeat.x===1&&o.repeat.y===1||(_e.scale=o.repeat.toArray(),a=!0),a&&(s.extensions=s.extensions||{},s.extensions.KHR_texture_transform=_e,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(s,o){if(s===o)return s;function a(Et){return Et.encoding===et.knz?function(St){return St<.04045?.0773993808*St:Math.pow(.9478672986*St+.0521327014,2.4)}:function(St){return St}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures.");const _e=s?s.image:void 0,rt=o?o.image:void 0,nt=Math.max(_e?_e.width:0,rt?rt.width:0),ot=Math.max(_e?_e.height:0,rt?rt.height:0),ct=document.createElement("canvas");ct.width=nt,ct.height=ot;const pt=ct.getContext("2d");pt.fillStyle="#00ffff",pt.fillRect(0,0,nt,ot);const ht=pt.getImageData(0,0,nt,ot);if(_e){pt.drawImage(_e,0,0,nt,ot);const Et=a(s),St=pt.getImageData(0,0,nt,ot).data;for(let Mt=2;Mt<St.length;Mt+=4)ht.data[Mt]=256*Et(St[Mt]/256)}if(rt){pt.drawImage(rt,0,0,nt,ot);const Et=a(o),St=pt.getImageData(0,0,nt,ot).data;for(let Mt=1;Mt<St.length;Mt+=4)ht.data[Mt]=256*Et(St[Mt]/256)}pt.putImageData(ht,0,0);const _t=(s||o).clone();return _t.source=new et.Hw6(ct),_t.encoding=et.rnI,_t}processBuffer(s){const o=this.json,a=this.buffers;return o.buffers||(o.buffers=[{byteLength:0}]),a.push(s),0}processBufferView(s,o,a,_e,rt){const nt=this.json;let ot;nt.bufferViews||(nt.bufferViews=[]),ot=o===rS?1:o===dA?2:4;const ct=nS(_e*s.itemSize*ot),pt=new DataView(new ArrayBuffer(ct));let ht=0;for(let Et=a;Et<a+_e;Et++)for(let St=0;St<s.itemSize;St++){let Mt;s.itemSize>4?Mt=s.array[Et*s.itemSize+St]:St===0?Mt=s.getX(Et):St===1?Mt=s.getY(Et):St===2?Mt=s.getZ(Et):St===3&&(Mt=s.getW(Et)),o===5126?pt.setFloat32(ht,Mt,!0):o===5125?pt.setUint32(ht,Mt,!0):o===dA?pt.setUint16(ht,Mt,!0):o===rS&&pt.setUint8(ht,Mt),ht+=ot}const _t={buffer:this.processBuffer(pt.buffer),byteOffset:this.byteOffset,byteLength:ct};return rt!==void 0&&(_t.target=rt),rt===34962&&(_t.byteStride=s.itemSize*ot),this.byteOffset+=ct,nt.bufferViews.push(_t),{id:nt.bufferViews.length-1,byteLength:0}}processBufferViewImage(s){const o=this,a=o.json;return a.bufferViews||(a.bufferViews=[]),new Promise(function(_e){const rt=new FileReader;rt.readAsArrayBuffer(s),rt.onloadend=function(){const nt=uv(rt.result),ot={buffer:o.processBuffer(nt),byteOffset:o.byteOffset,byteLength:nt.byteLength};o.byteOffset+=nt.byteLength,_e(a.bufferViews.push(ot)-1)}})}processAccessor(s,o,a,_e){const rt=this.options,nt=this.json;let ot;if(s.array.constructor===Float32Array)ot=5126;else if(s.array.constructor===Uint32Array)ot=5125;else if(s.array.constructor===Uint16Array)ot=dA;else{if(s.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");ot=rS}if(a===void 0&&(a=0),_e===void 0&&(_e=s.count),rt.truncateDrawRange&&o!==void 0&&o.index===null){const Et=a+_e,St=o.drawRange.count===1/0?s.count:o.drawRange.start+o.drawRange.count;a=Math.max(a,o.drawRange.start),_e=Math.min(Et,St)-a,_e<0&&(_e=0)}if(_e===0)return null;const ct=function(Et,St,Mt){const It={min:new Array(Et.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(Et.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let Nt=St;Nt<St+Mt;Nt++)for(let Bt=0;Bt<Et.itemSize;Bt++){let kt;Et.itemSize>4?kt=Et.array[Nt*Et.itemSize+Bt]:Bt===0?kt=Et.getX(Nt):Bt===1?kt=Et.getY(Nt):Bt===2?kt=Et.getZ(Nt):Bt===3&&(kt=Et.getW(Nt)),It.min[Bt]=Math.min(It.min[Bt],kt),It.max[Bt]=Math.max(It.max[Bt],kt)}return It}(s,a,_e);let pt;o!==void 0&&(pt=s===o.index?34963:34962);const ht=this.processBufferView(s,ot,a,_e,pt),_t={bufferView:ht.id,byteOffset:ht.byteOffset,componentType:ot,count:_e,max:ct.max,min:ct.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[s.itemSize]};return nt.accessors||(nt.accessors=[]),nt.accessors.push(_t)-1}processImage(s,o,a,_e="image/png"){const rt=this,nt=rt.cache,ot=rt.json,ct=rt.options,pt=rt.pending;nt.images.has(s)||nt.images.set(s,{});const ht=nt.images.get(s),_t=_e+":flipY/"+a.toString();if(ht[_t]!==void 0)return ht[_t];ot.images||(ot.images=[]);const Et={mimeType:_e},St=typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas");St.width=Math.min(s.width,ct.maxTextureSize),St.height=Math.min(s.height,ct.maxTextureSize);const Mt=St.getContext("2d");if(a===!0&&(Mt.translate(0,St.height),Mt.scale(1,-1)),s.data!==void 0){o!==et.wk1&&console.error("GLTFExporter: Only RGBAFormat is supported."),(s.width>ct.maxTextureSize||s.height>ct.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",s);const Nt=new Uint8ClampedArray(s.height*s.width*4);for(let Bt=0;Bt<Nt.length;Bt+=4)Nt[Bt+0]=s.data[Bt+0],Nt[Bt+1]=s.data[Bt+1],Nt[Bt+2]=s.data[Bt+2],Nt[Bt+3]=s.data[Bt+3];Mt.putImageData(new ImageData(Nt,s.width,s.height),0,0)}else Mt.drawImage(s,0,0,St.width,St.height);ct.binary===!0?pt.push(cv(St,_e).then(Nt=>rt.processBufferViewImage(Nt)).then(Nt=>{Et.bufferView=Nt})):St.toDataURL!==void 0?Et.uri=St.toDataURL(_e):pt.push(cv(St,_e).then(Nt=>new FileReader().readAsDataURL(Nt)).then(Nt=>{Et.uri=Nt}));const It=ot.images.push(Et)-1;return ht[_t]=It,It}processSampler(s){const o=this.json;o.samplers||(o.samplers=[]);const a={magFilter:Xp[s.magFilter],minFilter:Xp[s.minFilter],wrapS:Xp[s.wrapS],wrapT:Xp[s.wrapT]};return o.samplers.push(a)-1}processTexture(s){const o=this.cache,a=this.json;if(o.textures.has(s))return o.textures.get(s);a.textures||(a.textures=[]);let _e=s.userData.mimeType;_e==="image/webp"&&(_e="image/png"),_e==="image/jpg"&&(_e="image/jpeg");const rt=["image/jpeg","image/png"];_e&&!rt.includes(_e)&&console.error("GLTFExporter: Unsupported mime type: "+_e+". Cannot export texture.",s);const nt={sampler:this.processSampler(s),source:!_e||rt.includes(_e)?this.processImage(s.image,s.format,s.flipY,_e):null};s.name&&(nt.name=s.name),this._invokeAll(function(ct){ct.writeTexture&&ct.writeTexture(s,nt)});const ot=a.textures.push(nt)-1;return o.textures.set(s,ot),ot}processMaterial(s){const o=this.cache,a=this.json;if(o.materials.has(s))return o.materials.get(s);if(s.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;a.materials||(a.materials=[]);const _e={pbrMetallicRoughness:{}};s.isMeshStandardMaterial!==!0&&s.isMeshBasicMaterial!==!0&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const rt=s.color.toArray().concat([s.opacity]);if(jv(rt,[1,1,1,1])||(_e.pbrMetallicRoughness.baseColorFactor=rt),s.isMeshStandardMaterial?(_e.pbrMetallicRoughness.metallicFactor=s.metalness,_e.pbrMetallicRoughness.roughnessFactor=s.roughness):(_e.pbrMetallicRoughness.metallicFactor=.5,_e.pbrMetallicRoughness.roughnessFactor=.5),s.metalnessMap||s.roughnessMap){const ot=this.buildMetalRoughTexture(s.metalnessMap,s.roughnessMap),ct={index:this.processTexture(ot)};this.applyTextureTransform(ct,ot),_e.pbrMetallicRoughness.metallicRoughnessTexture=ct}if(s.map){const ot={index:this.processTexture(s.map)};this.applyTextureTransform(ot,s.map),_e.pbrMetallicRoughness.baseColorTexture=ot}if(s.emissive){const ot=s.emissive.clone().multiplyScalar(s.emissiveIntensity),ct=Math.max(ot.r,ot.g,ot.b);if(ct>1&&(ot.multiplyScalar(1/ct),console.warn("THREE.GLTFExporter: Some emissive components exceed 1; emissive has been limited")),ct>0&&(_e.emissiveFactor=ot.toArray()),s.emissiveMap){const pt={index:this.processTexture(s.emissiveMap)};this.applyTextureTransform(pt,s.emissiveMap),_e.emissiveTexture=pt}}if(s.normalMap){const ot={index:this.processTexture(s.normalMap)};s.normalScale&&s.normalScale.x!==1&&(ot.scale=s.normalScale.x),this.applyTextureTransform(ot,s.normalMap),_e.normalTexture=ot}if(s.aoMap){const ot={index:this.processTexture(s.aoMap),texCoord:1};s.aoMapIntensity!==1&&(ot.strength=s.aoMapIntensity),this.applyTextureTransform(ot,s.aoMap),_e.occlusionTexture=ot}s.transparent?_e.alphaMode="BLEND":s.alphaTest>0&&(_e.alphaMode="MASK",_e.alphaCutoff=s.alphaTest),s.side===et.ehD&&(_e.doubleSided=!0),s.name!==""&&(_e.name=s.name),this.serializeUserData(s,_e),this._invokeAll(function(ot){ot.writeMaterial&&ot.writeMaterial(s,_e)});const nt=a.materials.push(_e)-1;return o.materials.set(s,nt),nt}processMesh(s){const o=this.cache,a=this.json,_e=[s.geometry.uuid];if(Array.isArray(s.material))for(let Pt=0,qt=s.material.length;Pt<qt;Pt++)_e.push(s.material[Pt].uuid);else _e.push(s.material.uuid);const rt=_e.join(":");if(o.meshes.has(rt))return o.meshes.get(rt);const nt=s.geometry;let ot;ot=s.isLineSegments?1:s.isLineLoop?2:s.isLine?3:s.isPoints?0:s.material.wireframe?1:4;const ct={},pt={},ht=[],_t=[],Et={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},St=nt.getAttribute("normal");St===void 0||this.isNormalizedNormalAttribute(St)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),nt.setAttribute("normal",this.createNormalizedNormalAttribute(St)));let Mt=null;for(let Pt in nt.attributes){if(Pt.slice(0,5)==="morph")continue;const qt=nt.attributes[Pt];if(Pt=Et[Pt]||Pt.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(Pt)||(Pt="_"+Pt),o.attributes.has(this.getUID(qt))){pt[Pt]=o.attributes.get(this.getUID(qt));continue}Mt=null;const Kt=qt.array;Pt!=="JOINTS_0"||Kt instanceof Uint16Array||Kt instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),Mt=new et.TlE(new Uint16Array(Kt),qt.itemSize,qt.normalized));const nr=this.processAccessor(Mt||qt,nt);nr!==null&&(pt[Pt]=nr,o.attributes.set(this.getUID(qt),nr))}if(St!==void 0&&nt.setAttribute("normal",St),Object.keys(pt).length===0)return null;if(s.morphTargetInfluences!==void 0&&s.morphTargetInfluences.length>0){const Pt=[],qt=[],Kt={};if(s.morphTargetDictionary!==void 0)for(const nr in s.morphTargetDictionary)Kt[s.morphTargetDictionary[nr]]=nr;for(let nr=0;nr<s.morphTargetInfluences.length;++nr){const ir={};let fr=!1;for(const br in nt.morphAttributes){if(br!=="position"&&br!=="normal"){fr||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),fr=!0);continue}const Tr=nt.morphAttributes[br][nr],Dr=br.toUpperCase(),Rr=nt.attributes[br];if(o.attributes.has(this.getUID(Tr,!0))){ir[Dr]=o.attributes.get(this.getUID(Tr,!0));continue}const Nr=Tr.clone();if(!nt.morphTargetsRelative)for(let Ir=0,kr=Tr.count;Ir<kr;Ir++)Nr.setXYZ(Ir,Tr.getX(Ir)-Rr.getX(Ir),Tr.getY(Ir)-Rr.getY(Ir),Tr.getZ(Ir)-Rr.getZ(Ir));ir[Dr]=this.processAccessor(Nr,nt),o.attributes.set(this.getUID(Rr,!0),ir[Dr])}_t.push(ir),Pt.push(s.morphTargetInfluences[nr]),s.morphTargetDictionary!==void 0&&qt.push(Kt[nr])}ct.weights=Pt,qt.length>0&&(ct.extras={},ct.extras.targetNames=qt)}const It=Array.isArray(s.material);if(It&&nt.groups.length===0)return null;const Nt=It?s.material:[s.material],Bt=It?nt.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let Pt=0,qt=Bt.length;Pt<qt;Pt++){const Kt={mode:ot,attributes:pt};if(this.serializeUserData(nt,Kt),_t.length>0&&(Kt.targets=_t),nt.index!==null){let ir=this.getUID(nt.index);Bt[Pt].start===void 0&&Bt[Pt].count===void 0||(ir+=":"+Bt[Pt].start+":"+Bt[Pt].count),o.attributes.has(ir)?Kt.indices=o.attributes.get(ir):(Kt.indices=this.processAccessor(nt.index,nt,Bt[Pt].start,Bt[Pt].count),o.attributes.set(ir,Kt.indices)),Kt.indices===null&&delete Kt.indices}const nr=this.processMaterial(Nt[Bt[Pt].materialIndex]);nr!==null&&(Kt.material=nr),ht.push(Kt)}ct.primitives=ht,a.meshes||(a.meshes=[]),this._invokeAll(function(Pt){Pt.writeMesh&&Pt.writeMesh(s,ct)});const kt=a.meshes.push(ct)-1;return o.meshes.set(rt,kt),kt}processCamera(s){const o=this.json;o.cameras||(o.cameras=[]);const a=s.isOrthographicCamera,_e={type:a?"orthographic":"perspective"};return a?_e.orthographic={xmag:2*s.right,ymag:2*s.top,zfar:s.far<=0?.001:s.far,znear:s.near<0?0:s.near}:_e.perspective={aspectRatio:s.aspect,yfov:et.M8C.degToRad(s.fov),zfar:s.far<=0?.001:s.far,znear:s.near<0?0:s.near},s.name!==""&&(_e.name=s.type),o.cameras.push(_e)-1}processAnimation(s,o){const a=this.json,_e=this.nodeMap;a.animations||(a.animations=[]);const rt=(s=w_.Utils.mergeMorphTargetTracks(s.clone(),o)).tracks,nt=[],ot=[];for(let ct=0;ct<rt.length;++ct){const pt=rt[ct],ht=et.iUV.parseTrackName(pt.name);let _t=et.iUV.findNode(o,ht.nodeName);const Et=bp[ht.propertyName];if(ht.objectName==="bones"&&(_t=_t.isSkinnedMesh===!0?_t.skeleton.getBoneByName(ht.objectIndex):void 0),!_t||!Et)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',pt.name),null;const St=1;let Mt,It=pt.values.length/pt.times.length;Et===bp.morphTargetInfluences&&(It/=_t.morphTargetInfluences.length),pt.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(Mt="CUBICSPLINE",It/=3):Mt=pt.getInterpolation()===et.Syv?"STEP":"LINEAR",ot.push({input:this.processAccessor(new et.TlE(pt.times,St)),output:this.processAccessor(new et.TlE(pt.values,It)),interpolation:Mt}),nt.push({sampler:ot.length-1,target:{node:_e.get(_t),path:Et}})}return a.animations.push({name:s.name||"clip_"+a.animations.length,samplers:ot,channels:nt}),a.animations.length-1}processSkin(s){const o=this.json,a=this.nodeMap,_e=o.nodes[a.get(s)],rt=s.skeleton;if(rt===void 0)return null;const nt=s.skeleton.bones[0];if(nt===void 0)return null;const ot=[],ct=new Float32Array(16*rt.bones.length),pt=new et.yGw;for(let ht=0;ht<rt.bones.length;++ht)ot.push(a.get(rt.bones[ht])),pt.copy(rt.boneInverses[ht]),pt.multiply(s.bindMatrix).toArray(ct,16*ht);return o.skins===void 0&&(o.skins=[]),o.skins.push({inverseBindMatrices:this.processAccessor(new et.TlE(ct,16)),joints:ot,skeleton:a.get(nt)}),_e.skin=o.skins.length-1}processNode(s){const o=this.json,a=this.options,_e=this.nodeMap;o.nodes||(o.nodes=[]);const rt={};if(a.trs){const ot=s.quaternion.toArray(),ct=s.position.toArray(),pt=s.scale.toArray();jv(ot,[0,0,0,1])||(rt.rotation=ot),jv(ct,[0,0,0])||(rt.translation=ct),jv(pt,[1,1,1])||(rt.scale=pt)}else s.matrixAutoUpdate&&s.updateMatrix(),jv(s.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])===!1&&(rt.matrix=s.matrix.elements);if(s.name!==""&&(rt.name=String(s.name)),this.serializeUserData(s,rt),s.isMesh||s.isLine||s.isPoints){const ot=this.processMesh(s);ot!==null&&(rt.mesh=ot)}else s.isCamera&&(rt.camera=this.processCamera(s));if(s.isSkinnedMesh&&this.skins.push(s),s.children.length>0){const ot=[];for(let ct=0,pt=s.children.length;ct<pt;ct++){const ht=s.children[ct];if(ht.visible||a.onlyVisible===!1){const _t=this.processNode(ht);_t!==null&&ot.push(_t)}}ot.length>0&&(rt.children=ot)}this._invokeAll(function(ot){ot.writeNode&&ot.writeNode(s,rt)});const nt=o.nodes.push(rt)-1;return _e.set(s,nt),nt}processScene(s){const o=this.json,a=this.options;o.scenes||(o.scenes=[],o.scene=0);const _e={};s.name!==""&&(_e.name=s.name),o.scenes.push(_e);const rt=[];for(let nt=0,ot=s.children.length;nt<ot;nt++){const ct=s.children[nt];if(ct.visible||a.onlyVisible===!1){const pt=this.processNode(ct);pt!==null&&rt.push(pt)}}rt.length>0&&(_e.nodes=rt),this.serializeUserData(s,_e)}processObjects(s){const o=new et.xsS;o.name="AuxScene";for(let a=0;a<s.length;a++)o.children.push(s[a]);this.processScene(o)}processInput(s){const o=this.options;s=s instanceof Array?s:[s],this._invokeAll(function(_e){_e.beforeParse&&_e.beforeParse(s)});const a=[];for(let _e=0;_e<s.length;_e++)s[_e]instanceof et.xsS?this.processScene(s[_e]):a.push(s[_e]);a.length>0&&this.processObjects(a);for(let _e=0;_e<this.skins.length;++_e)this.processSkin(this.skins[_e]);for(let _e=0;_e<o.animations.length;++_e)this.processAnimation(o.animations[_e],s[0]);this._invokeAll(function(_e){_e.afterParse&&_e.afterParse(s)})}_invokeAll(s){for(let o=0,a=this.plugins.length;o<a;o++)s(this.plugins[o])}}class Jp{constructor(s){this.writer=s,this.name="KHR_lights_punctual"}writeNode(s,o){if(!s.isLight)return;if(!s.isDirectionalLight&&!s.isPointLight&&!s.isSpotLight)return void console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",s);const a=this.writer,_e=a.json,rt=a.extensionsUsed,nt={};s.name&&(nt.name=s.name),nt.color=s.color.toArray(),nt.intensity=s.intensity,s.isDirectionalLight?nt.type="directional":s.isPointLight?(nt.type="point",s.distance>0&&(nt.range=s.distance)):s.isSpotLight&&(nt.type="spot",s.distance>0&&(nt.range=s.distance),nt.spot={},nt.spot.innerConeAngle=(s.penumbra-1)*s.angle*-1,nt.spot.outerConeAngle=s.angle),s.decay!==void 0&&s.decay!==2&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!s.target||s.target.parent===s&&s.target.position.x===0&&s.target.position.y===0&&s.target.position.z===-1||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),rt[this.name]||(_e.extensions=_e.extensions||{},_e.extensions[this.name]={lights:[]},rt[this.name]=!0);const ot=_e.extensions[this.name].lights;ot.push(nt),o.extensions=o.extensions||{},o.extensions[this.name]={light:ot.length-1}}}class rx{constructor(s){this.writer=s,this.name="KHR_materials_unlit"}writeMaterial(s,o){if(!s.isMeshBasicMaterial)return;const a=this.writer.extensionsUsed;o.extensions=o.extensions||{},o.extensions[this.name]={},a[this.name]=!0,o.pbrMetallicRoughness.metallicFactor=0,o.pbrMetallicRoughness.roughnessFactor=.9}}class LP{constructor(s){this.writer=s,this.name="KHR_materials_pbrSpecularGlossiness"}writeMaterial(s,o){if(!s.isGLTFSpecularGlossinessMaterial)return;const a=this.writer,_e=a.extensionsUsed,rt={};o.pbrMetallicRoughness.baseColorFactor&&(rt.diffuseFactor=o.pbrMetallicRoughness.baseColorFactor);const nt=[1,1,1];if(s.specular.toArray(nt,0),rt.specularFactor=nt,rt.glossinessFactor=s.glossiness,o.pbrMetallicRoughness.baseColorTexture&&(rt.diffuseTexture=o.pbrMetallicRoughness.baseColorTexture),s.specularMap){const ot={index:a.processTexture(s.specularMap)};a.applyTextureTransform(ot,s.specularMap),rt.specularGlossinessTexture=ot}o.extensions=o.extensions||{},o.extensions[this.name]=rt,_e[this.name]=!0}}class RR{constructor(s){this.writer=s,this.name="KHR_materials_clearcoat"}writeMaterial(s,o){if(!s.isMeshPhysicalMaterial)return;const a=this.writer,_e=a.extensionsUsed,rt={};if(rt.clearcoatFactor=s.clearcoat,s.clearcoatMap){const nt={index:a.processTexture(s.clearcoatMap)};a.applyTextureTransform(nt,s.clearcoatMap),rt.clearcoatTexture=nt}if(rt.clearcoatRoughnessFactor=s.clearcoatRoughness,s.clearcoatRoughnessMap){const nt={index:a.processTexture(s.clearcoatRoughnessMap)};a.applyTextureTransform(nt,s.clearcoatRoughnessMap),rt.clearcoatRoughnessTexture=nt}if(s.clearcoatNormalMap){const nt={index:a.processTexture(s.clearcoatNormalMap)};a.applyTextureTransform(nt,s.clearcoatNormalMap),rt.clearcoatNormalTexture=nt}o.extensions=o.extensions||{},o.extensions[this.name]=rt,_e[this.name]=!0}}class sL{constructor(s){this.writer=s,this.name="KHR_materials_iridescence"}writeMaterial(s,o){if(!s.isMeshPhysicalMaterial)return;const a=this.writer,_e=a.extensionsUsed,rt={};if(rt.iridescenceFactor=s.iridescence,s.iridescenceMap){const nt={index:a.processTexture(s.iridescenceMap)};a.applyTextureTransform(nt,s.iridescenceMap),rt.iridescenceTexture=nt}if(rt.iridescenceIor=s.iridescenceIOR,rt.iridescenceThicknessMinimum=s.iridescenceThicknessRange[0],rt.iridescenceThicknessMaximum=s.iridescenceThicknessRange[1],s.iridescenceThicknessMap){const nt={index:a.processTexture(s.iridescenceThicknessMap)};a.applyTextureTransform(nt,s.iridescenceThicknessMap),rt.iridescenceThicknessTexture=nt}o.extensions=o.extensions||{},o.extensions[this.name]=rt,_e[this.name]=!0}}class oL{constructor(s){this.writer=s,this.name="KHR_materials_transmission"}writeMaterial(s,o){if(!s.isMeshPhysicalMaterial||s.transmission===0)return;const a=this.writer,_e=a.extensionsUsed,rt={};if(rt.transmissionFactor=s.transmission,s.transmissionMap){const nt={index:a.processTexture(s.transmissionMap)};a.applyTextureTransform(nt,s.transmissionMap),rt.transmissionTexture=nt}o.extensions=o.extensions||{},o.extensions[this.name]=rt,_e[this.name]=!0}}class aL{constructor(s){this.writer=s,this.name="KHR_materials_volume"}writeMaterial(s,o){if(!s.isMeshPhysicalMaterial||s.transmission===0)return;const a=this.writer,_e=a.extensionsUsed,rt={};if(rt.thicknessFactor=s.thickness,s.thicknessMap){const nt={index:a.processTexture(s.thicknessMap)};a.applyTextureTransform(nt,s.thicknessMap),rt.thicknessTexture=nt}rt.attenuationDistance=s.attenuationDistance,rt.attenuationColor=s.attenuationColor.toArray(),o.extensions=o.extensions||{},o.extensions[this.name]=rt,_e[this.name]=!0}}class lL{constructor(s){this.writer=s,this.name="KHR_materials_sheen"}writeMaterial(s,o){if(!s.isMeshPhysicalMaterial||s.sheen<.01)return;const a=this.writer,_e=a.extensionsUsed,rt={};if(rt.sheenColorFactor=s.sheenColor.toArray(),s.sheenColorMap){const nt={index:a.processTexture(s.sheenColorMap)};a.applyTextureTransform(nt,s.sheenColorMap),rt.sheenColorTexture=nt}if(rt.sheenRoughnessFactor=s.sheenRoughness,s.sheenRoughnessMap){const nt={index:a.processTexture(s.sheenRoughnessMap)};a.applyTextureTransform(nt,s.sheenRoughnessMap),rt.sheenRoughnessTexture=nt}o.extensions=o.extensions||{},o.extensions[this.name]=rt,o.extras=o.extras||{},o.extras.sheenFactor=s.sheen,_e[this.name]=!0}}class uL{constructor(s){this.writer=s,this.name="KHR_materials_ior"}writeMaterial(s,o){if(!s.isMeshPhysicalMaterial)return;const a=this.writer.extensionsUsed,_e={};_e.ior=s.ior,o.extensions=o.extensions||{},o.extensions[this.name]=_e,a[this.name]=!0}}w_.Utils={GLTFWriter:lT,insertKeyframe:function(tt,s){const a=tt.getValueSize(),_e=new tt.TimeBufferType(tt.times.length+1),rt=new tt.ValueBufferType(tt.values.length+a),nt=tt.createInterpolant(new tt.ValueBufferType(a));let ot;if(tt.times.length===0){_e[0]=s;for(let ct=0;ct<a;ct++)rt[ct]=0;ot=0}else if(s<tt.times[0]){if(Math.abs(tt.times[0]-s)<.001)return 0;_e[0]=s,_e.set(tt.times,1),rt.set(nt.evaluate(s),0),rt.set(tt.values,a),ot=0}else if(s>tt.times[tt.times.length-1]){if(Math.abs(tt.times[tt.times.length-1]-s)<.001)return tt.times.length-1;_e[_e.length-1]=s,_e.set(tt.times,0),rt.set(tt.values,0),rt.set(nt.evaluate(s),tt.values.length),ot=_e.length-1}else for(let ct=0;ct<tt.times.length;ct++){if(Math.abs(tt.times[ct]-s)<.001)return ct;if(tt.times[ct]<s&&tt.times[ct+1]>s){_e.set(tt.times.slice(0,ct+1),0),_e[ct+1]=s,_e.set(tt.times.slice(ct+1),ct+2),rt.set(tt.values.slice(0,(ct+1)*a),0),rt.set(nt.evaluate(s),(ct+1)*a),rt.set(tt.values.slice((ct+1)*a),(ct+2)*a),ot=ct+1;break}}return tt.times=_e,tt.values=rt,ot},mergeMorphTargetTracks:function(tt,s){const o=[],a={},_e=tt.tracks;for(let rt=0;rt<_e.length;++rt){let nt=_e[rt];const ot=et.iUV.parseTrackName(nt.name),ct=et.iUV.findNode(s,ot.nodeName);if(ot.propertyName!=="morphTargetInfluences"||ot.propertyIndex===void 0){o.push(nt);continue}if(nt.createInterpolant!==nt.InterpolantFactoryMethodDiscrete&&nt.createInterpolant!==nt.InterpolantFactoryMethodLinear){if(nt.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),nt=nt.clone(),nt.setInterpolation(et.NMF)}const pt=ct.morphTargetInfluences.length,ht=ct.morphTargetDictionary[ot.propertyIndex];if(ht===void 0)throw new Error("THREE.GLTFExporter: Morph target name not found: "+ot.propertyIndex);let _t;if(a[ct.uuid]===void 0){_t=nt.clone();const St=new _t.ValueBufferType(pt*_t.times.length);for(let Mt=0;Mt<_t.times.length;Mt++)St[Mt*pt+ht]=_t.values[Mt];_t.name=(ot.nodeName||"")+".morphTargetInfluences",_t.values=St,a[ct.uuid]=_t,o.push(_t);continue}const Et=nt.createInterpolant(new nt.ValueBufferType(1));_t=a[ct.uuid];for(let St=0;St<_t.times.length;St++)_t.values[St*pt+ht]=Et.evaluate(_t.times[St]);for(let St=0;St<nt.times.length;St++){const Mt=this.insertKeyframe(_t,nt.times[St]);_t.values[Mt*pt+ht]=nt.values[St]}}return tt.tracks=o,tt}};class RD extends w_.Utils.GLTFWriter{constructor(){super(...arguments),this._defaultMaterial=new et.Wid}serializeUserData(s,o){const a=s.userData,_e={};a.__disposed&&console.error("Serializing a disposed object",s),Object.entries(a).forEach(([rt,nt])=>{(!nt||typeof nt=="function"||nt.isObject3D||nt.isTexture||nt.isMaterial||nt.assetType!=null||rt.startsWith("_")||rt!=="uuid"&&(Jo.includes(rt)||ep.includes(rt)||su.includes(rt)))&&(_e[rt]=nt,delete a[rt])}),super.serializeUserData(s,o),Object.entries(_e).forEach(([rt,nt])=>{a[rt]=nt,delete _e[rt]})}processObjects(s){var o;s.length===1&&(!((o=s[0])===null||o===void 0)&&o.userData.rootSceneModelRoot)?this.processScene(s[0]):super.processObjects(s)}processMaterial(s){if(this.cache.materials.has(s))return this.cache.materials.get(s);let o=s;o&&!o.isShaderMaterial||(o=this._defaultMaterial);const a=super.processMaterial(o);if(!s||o===s)return a;const _e=JSON.stringify(this.json.materials[a]),rt=JSON.parse(_e);this.serializeUserData(s,rt),this._invokeAll(ot=>{ot.writeMaterial&&ot.writeMaterial(s,rt)});const nt=this.json.materials.push(rt)-1;return this.cache.materials.set(s,nt),nt}processImageBlob(s,o){if(!s)return-1;const a=this.cache,_e=this.options,rt=this.pending,nt=this.json,ot=o.image;a.images.has(ot)||a.images.set(ot,{});const ct=a.images.get(ot),pt=s.type+":flipY/"+o.flipY.toString();if(ct[pt]!==void 0)return ct[pt];nt.images||(nt.images=[]);const ht={mimeType:s.type};_e.binary===!0?rt.push(new Promise(Et=>{this.processBufferViewImage(s).then(St=>{ht.bufferView=St,Et()})})):rt.push(Su(s).then(Et=>{ht.uri=Et}));const _t=nt.images.push(ht)-1;return ct[pt]=_t,_t}processSampler(s){return super.processSampler(s)}processTexture(s){const o=this.cache,a=this.json;if(o.textures.has(s))return o.textures.get(s);const _e=s.source.data,rt=s.userData.mimeType;s.userData.rootPath&&!this.options.embedUrlImages&&(s.source.data=null,delete s.userData.mimeType);const nt=super.processTexture(s),ot=a.textures[nt];if(!ot)return console.error("No texture def",nt,s),nt;const ct=a.images?a.images[ot.source]:null;if(ct&&(ct.extras||(ct.extras={}),s.source&&(ct.extras.uuid=s.source.uuid),ct.extras.t_uuid=s.uuid),s.userData.rootPath&&!this.options.embedUrlImages){if(s.source.data=_e,s.userData.mimeType=rt,!ot)return console.error("textureDef is null",nt,s),nt;ot.source>=0?console.warn("textureDef.source is already set",nt,s):ot.source=this.processImageUri(s.image,s.userData.rootPath,s.flipY,rt)}return ot.source<0&&console.error("textureDef.source cannot be saved",ot,s),nt}processImage(s,o,a,_e="image/png"){return s?super.processImage(s,o,a,_e):-1}processImageUri(s,o,a,_e="image/png"){const rt=this.cache,nt=this.json;rt.images.has(s)||rt.images.set(s,{});const ot=rt.images.get(s),ct=_e+":flipY/"+a.toString();if(ot[ct]!==void 0)return ot[ct];nt.images||(nt.images=[]);const pt={mimeType:_e,uri:o,extras:{flipY:a}},ht=nt.images.push(pt)-1;return ot[ct]=ht,ht}}class NP extends w_{register(s){return super.register(s)}async parseAsync(s,o){var a;if(!s)throw new Error("No object to export");const _e=s.__isGLTFOutput||!Array.isArray(s)&&!s.isObject3D?s:await new Promise((rt,nt)=>this.parse(s,rt,nt,o));if(_e&&typeof _e=="object"&&!_e.byteLength)return new Blob([JSON.stringify(_e,(rt,nt)=>rt.startsWith("__")?void 0:nt,(a=o.jsonSpaces)!==null&&a!==void 0?a:2)],{type:"model/gltf+json"});if(_e)return new Blob([_e],{type:"model/gltf+binary"});throw new Error("GLTFExporter2.parse() failed")}parse(s,o,a,_e={}){var rt;const nt={binary:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,externalImagesInExtras:!_e.embedUrlImages&&_e.externalImagesInExtras||!1,embedUrlImages:(rt=_e.embedUrlImages)!==null&&rt!==void 0&&rt,maxTextureSize:1/0,animations:[],includeCustomExtensions:!0};return _e.exportExt==="glb"&&(nt.binary=!0),_e.preserveUUIDs!==!1&&(Array.isArray(s)?s:[s]).forEach(ot=>ot.traverse(ct=>{ct.uuid&&(ct.userData.gltfUUID=ct.uuid)})),(Array.isArray(s)?s:[s]).forEach(ot=>ot.traverse(ct=>{if(ct.animations)for(const pt of ct.animations)pt.__gltfExport===!1||nt.animations.includes(pt)||nt.animations.push(...ct.animations)})),super.parse(s,ot=>{_e.preserveUUIDs!==!1&&(Array.isArray(s)?s:[s]).forEach(ct=>ct.traverse(pt=>{delete pt.userData.gltfUUID})),o(Object.assign(ot,{__isGLTFOutput:!0}))},a,nt,new RD)}}function ID(tt,s){const o=tt.getPlugin(os).exportViewerConfig();s.json.textures&&s.json.samplers&&s.json.images&&o.resources.textures&&Object.entries(o.resources.textures).forEach(([_e,rt])=>{s.json.textures.find(ot=>{var ct,pt,ht,_t,Et;return((ct=ot.extras)===null||ct===void 0?void 0:ct.uuid)===_e||((ht=(pt=s.json.samplers[ot.sampler])===null||pt===void 0?void 0:pt.extras)===null||ht===void 0?void 0:ht.uuid)===_e||((Et=(_t=s.json.images[ot.source])===null||_t===void 0?void 0:_t.extras)===null||Et===void 0?void 0:Et.t_uuid)===_e})&&(rt.image&&o.resources.images&&o.resources.images[rt.image]&&delete o.resources.images[rt.image],o.resources.textures[_e]={})}),s.json.materials&&o.resources.materials&&Object.entries(o.resources.materials).forEach(([_e,rt])=>{s.json.materials.find(ot=>{var ct;return((ct=ot.extras)===null||ct===void 0?void 0:ct.uuid)===_e})&&(o.resources.materials[_e]={})});const a=[];Object.values(o.resources).forEach(_e=>{Object.values(_e).forEach(rt=>{rt.url&&(rt.url.type==="Uint16Array"&&rt.url.data&&(rt.url.data instanceof Uint16Array||(rt.url.data=new Uint16Array(rt.url.data)),a.push(rt.url)),rt.url.type==="Uint8Array"&&rt.url.data&&(rt.url.data instanceof Uint8Array||(rt.url.data=new Uint8Array(rt.url.data)),a.push(rt.url)))})});for(const _e of a){let rt="application/octet-stream";if(_e.type==="Uint16Array"){const pt=cL(_e.data,4),ht=new ImageData(pt,_e.width,_e.height),_t=et.PpQ.getDataURL(ht,!0).split(",")[1];rt="image/png",_e.data=atob(_t),_e.encoding="rgbe"}const nt=new Blob([_e.data],{type:rt});s.json.images||(s.json.images=[]);const ot={mimeType:rt},ct=s.json.images.push(ot)-1;_e.data={image:ct},s.pending.push(s.processBufferViewImage(nt).then(pt=>{ot.bufferView=pt}))}return o}function cL(tt,s=3,o){let a,_e,rt,nt,ot;const ct=tt.byteLength/(2*s)|0;o=o||new Uint8ClampedArray(4*ct);for(let pt=0;pt<ct;pt++){a=tt[pt*s],_e=tt[pt*s+1],rt=tt[pt*s+2],nt=Math.max(Math.max(a,_e),rt);const ht=Math.ceil(Math.log2(nt));ot=Math.pow(2,ht-8),o[4*pt]=a/ot|0,o[4*pt+1]=_e/ot|0,o[4*pt+2]=rt/ot|0,o[4*pt+3]=ht+128}return o}function FP(tt,s=NP,o){var a;if(!tt)return;const _e=hy.Exporters.findIndex(nt=>nt.ext.includes("gltf")||nt.ext.includes("glb")),rt=[];_e>=0?(rt.push(...(a=hy.Exporters[_e].extensions)!==null&&a!==void 0?a:[]),hy.Exporters.splice(_e,1)):(rt.push(hL),rt.push(pL),rt.push(dL),rt.push(nt=>new fL(nt)),rt.push(nt=>new mL(nt)),rt.push(nt=>new gL(nt)),rt.push(nt=>new vL(nt))),hy.Exporters.push({ctor:()=>{const nt=new s;return rt.forEach(ot=>nt.register(ot)),nt.register(ot=>({afterParse:ct=>{var pt,ht;if(!(!((pt=(ct=Array.isArray(ct)?ct[0]:ct)==null?void 0:ct.userData)===null||pt===void 0)&&pt.rootSceneModelRoot)||((ht=ct==null?void 0:ct.userData)===null||ht===void 0?void 0:ht.__exportViewerConfig)===!1)return;const _t=ot.json.scenes[ot.json.scene||0];_t.extensions||(_t.extensions={}),_t.extensions[im]=ID(tt,ot),ot.extensionsUsed[im]=!0}})),o==null||o(nt),nt},ext:["gltf","glb"],extensions:rt})}const dL=tt=>({writeNode:(s,o)=>{if(!(s!=null&&s.isLight))return;o.extensions||(o.extensions={});const a={};s.shadow&&(a.shadow=s.shadow.toJSON()),Object.keys(a).length>0&&(o.extensions[Mr]=a,tt.extensionsUsed[Mr]=!0)}}),pL=tt=>({writeNode:(s,o)=>{if(!(s!=null&&s.isObject3D))return;o.extensions||(o.extensions={});const a={};s.castShadow!==void 0&&(a.castShadow=s.castShadow),s.receiveShadow!==void 0&&(a.receiveShadow=s.receiveShadow),s.visible===!1&&(a.visible=!1),s.frustumCulled===!1&&(a.frustumCulled=!1),s.renderOrder!==0&&(a.renderOrder=s.renderOrder),s.layers.mask!==1&&(a.layers=s.layers.mask),s.matrixAutoUpdate===!1&&(a.matrixAutoUpdate=!1),Object.keys(a).length>0&&(o.extensions[wv]=a,tt.extensionsUsed[wv]=!0)}}),hL=tt=>({writeMaterial(s,o){var a;if(!(s!=null&&s.isMaterial))return;o.extensions||(o.extensions={});const _e={};if(s.emissiveIntensity!==void 0&&(!((a=s.emissive)===null||a===void 0)&&a.isColor)){const nt=s.emissive.clone().multiplyScalar(s.emissiveIntensity),ot=Math.max(nt.r,nt.g,nt.b);ot>1&&(_e.emissiveIntensity=ot)}s.fog!==void 0&&(_e.fog=s.fog),s.flatShading!==void 0&&(_e.flatShading=s.flatShading),s.blending!==void 0&&(_e.blending=s.blending),s.side!==void 0&&s.side!==et.ehD&&(_e.side=s.side),s.shadowSide!==void 0&&(_e.shadowSide=s.shadowSide),s.depthFunc!==void 0&&(_e.depthFunc=s.depthFunc),s.depthTest!==void 0&&(_e.depthTest=s.depthTest),s.depthWrite!==void 0&&(_e.depthWrite=s.depthWrite),s.colorWrite!==void 0&&(_e.colorWrite=s.colorWrite),s.wireframe!==void 0&&(_e.wireframe=s.wireframe),s.wireframeLinewidth!==void 0&&(_e.wireframeLinewidth=s.wireframeLinewidth),s.wireframeLinecap!==void 0&&(_e.wireframeLinecap=s.wireframeLinecap),s.wireframeLinejoin!==void 0&&(_e.wireframeLinejoin=s.wireframeLinejoin),s.rotation!==void 0&&(_e.rotation=s.rotation),s.polygonOffset!==void 0&&(_e.polygonOffset=s.polygonOffset),s.polygonOffsetFactor!==void 0&&(_e.polygonOffsetFactor=s.polygonOffsetFactor),s.polygonOffsetUnits!==void 0&&(_e.polygonOffsetUnits=s.polygonOffsetUnits),s.dithering!==void 0&&(_e.dithering=s.dithering),s.alphaToCoverage!==void 0&&(_e.alphaToCoverage=s.alphaToCoverage),s.premultipliedAlpha!==void 0&&(_e.premultipliedAlpha=s.premultipliedAlpha),s.toneMapped!==void 0&&(_e.toneMapped=s.toneMapped);const rt=this.materialExternalResources[s.uuid];rt&&Object.entries(rt).forEach(([nt,ot])=>{nt.startsWith("_")||(_e[nt]=rs(ot,!1,this.serializedMeta))}),Object.keys(_e).length>0&&(o.extensions[sm]=_e,tt.extensionsUsed[sm]=!0)},materialExternalResources:{},serializedMeta:{images:{},textures:{}},beforeParse(s){if(this.materialExternalResources={},!tt.options.externalImagesInExtras)return;const o=[];(Array.isArray(s)?s:[s]).forEach(a=>{a==null||a.traverse(_e=>{var rt;_e&&(!((rt=_e.material)===null||rt===void 0)&&rt.isMaterial)&&o.push(_e.material)})}),o.forEach(a=>{a&&(this.materialExternalResources[a.uuid]||(this.materialExternalResources[a.uuid]={}),this.materialExternalResources[a.uuid].__materialRef=a,Object.entries(a).forEach(([_e,rt])=>{_e.startsWith("_")||rt&&rt.isTexture&&rt.userData.rootPath&&(a[_e]=null,this.materialExternalResources[a.uuid][_e]=rt)}))})},afterParse(s){const o=Object.values(this.materialExternalResources);if(o.length<1)return;o.forEach(_e=>{const rt=_e.__materialRef;rt&&(Object.entries(_e).forEach(([nt,ot])=>{nt.startsWith("_")||ot&&(rt[nt]=ot)}),delete this.materialExternalResources[rt.uuid])});const a=tt.json.scenes[tt.json.scene||0];a.extensions||(a.extensions={}),a.extensions[sm]={resources:this.serializedMeta},tt.extensionsUsed[sm]=!0}});class fL{constructor(s){this.writer=s,this.name=Tm}writeMaterial(s,o){if(!s.isMeshStandardMaterial||s.bumpScale===0)return;const a=this.writer,_e=a.extensionsUsed,rt={};if(rt.bumpScale=s.bumpScale,s.bumpMap){const nt={index:a.processTexture(s.bumpMap)};a.applyTextureTransform(nt,s.bumpMap),rt.bumpTexture=nt}o.extensions=o.extensions||{},o.extensions[this.name]=rt,_e[this.name]=!0}}class mL{constructor(s){this.writer=s,this.name=r_}writeMaterial(s,o){if(!s.isMeshStandardMaterial||s.displacementScale===0)return;const a=this.writer,_e=a.extensionsUsed,rt={};if(rt.displacementScale=s.displacementScale,rt.displacementBias=s.displacementBias,s.displacementMap){const nt={index:a.processTexture(s.displacementMap)};a.applyTextureTransform(nt,s.displacementMap),rt.displacementTexture=nt}o.extensions=o.extensions||{},o.extensions[this.name]=rt,_e[this.name]=!0}}class gL{constructor(s){this.writer=s,this.name=Mm}writeMaterial(s,o){if(!s.isMeshStandardMaterial||s.lightMapIntensity===0)return;const a=this.writer,_e=a.extensionsUsed,rt={};if(rt.lightMapIntensity=s.lightMapIntensity,s.lightMap){const nt={index:a.processTexture(s.lightMap)};a.applyTextureTransform(nt,s.lightMap),rt.lightMapTexture=nt}o.extensions=o.extensions||{},o.extensions[this.name]=rt,_e[this.name]=!0}}class vL{constructor(s){this.writer=s,this.name=Ev}writeMaterial(s,o){if(!s.isMeshStandardMaterial||!s.alphaMap)return;const a=this.writer,_e=a.extensionsUsed,rt={};if(s.alphaMap){const nt={index:a.processTexture(s.alphaMap)};a.applyTextureTransform(nt,s.alphaMap),rt.alphaTexture=nt}o.extensions=o.extensions||{},o.extensions[this.name]=rt,_e[this.name]=!0}}class hy extends it{constructor(s,o={}){super(),this._processors=new B0,this._cachedParsers=[],FP(s)}get processors(){return this._processors}getExporter(...s){return hy.Exporters.find(o=>o.ext.some(a=>s.includes(a)))}async exportObject(s,o={}){var a,_e,rt,nt;if(!(s!=null&&s.assetType))return void console.error("Object has no asset type");!((_e=(a=s)===null||a===void 0?void 0:a.userData)===null||_e===void 0)&&_e.rootSceneModelRoot&&o.viewerConfig===!1&&(s.userData.__exportViewerConfig=!1);const ot=await this._exportFile(s,o);return!((nt=(rt=s)===null||rt===void 0?void 0:rt.userData)===null||nt===void 0)&&nt.rootSceneModelRoot&&o.viewerConfig===!1&&delete s.userData.__exportViewerConfig,ot}async _exportFile(s,o={}){var a,_e,rt;let nt;this.dispatchEvent({type:"exportFile",obj:s,state:"processing"});try{const ot=await this.processBeforeExport(s,o),ct=(_e=(a=o.exportExt)!==null&&a!==void 0?a:ot==null?void 0:ot.typeExt)!==null&&_e!==void 0?_e:ot==null?void 0:ot.ext;if(!ot||!ct)throw new Error(`Unable to preprocess before export ${ct}`);const pt=this._getParser(ct);this.dispatchEvent({type:"exportFile",obj:s,state:"exporting"});const ht=await pt.parseAsync(ot.obj,{exportExt:(rt=ot.ext)!==null&&rt!==void 0?rt:ct,...o});ht.ext=ot.ext,nt=ht}catch(ot){return console.error("AssetExporter: Unable to Export file",s),console.error(ot),void this.dispatchEvent({type:"exportFile",obj:s,state:"error",error:ot})}return this.dispatchEvent({type:"exportFile",obj:s,state:"done"}),nt}_createParser(s){const o=hy.Exporters.find(_e=>_e.ext.includes(s));if(!o)throw new Error(`No exporter found for extension ${s}`);const a=o==null?void 0:o.ctor(this);if(!a)throw new Error(`Unable to create parser for extension ${s}`);return this._cachedParsers.push({ext:o.ext,parser:a}),this.dispatchEvent({type:"exporterCreate",exporter:o,parser:a}),a}_getParser(s){var o,a;return(a=(o=this._cachedParsers.find(_e=>_e.ext.includes(s)))===null||o===void 0?void 0:o.parser)!==null&&a!==void 0?a:this._createParser(s)}async processBeforeExport(s,o={}){switch(s.assetType!=null&&(s=await this._processors.process(s.assetType,s,o)),s.assetType){case"light":return void console.error("AssetExporter: light export not implemented");case"model":return{obj:s,ext:"glb"};case"material":return{obj:s.toJSON(),ext:s.typeSlug||"json",typeExt:"json"};case"texture":return{obj:s.toJSON(),ext:"json"};default:console.error("AssetExporter: unknown asset type",s.assetType)}}dispose(){var s;(s=this._processors)===null||s===void 0||s.dispose()}}hy.Exporters=[{ctor:()=>new MR,ext:["json"]},{ctor:()=>new b_,ext:["txt","text"]}];class uT extends io{constructor(s){super(),this.enabled=!0,this.exportOptions={compress:!1,name:"scene",viewerConfig:!0,convertMeshToIndexed:!1,embedUrlImages:!1},this.exporter=s,this.exportScene=this.exportScene.bind(this)}async onAdded(s){await super.onAdded(s),this.exporter||(this.exporter=new hy(s)),this.exporter.processors.add("model",{forAssetType:"model",processAsync:async(o,a)=>{var _e;return a.convertMeshToIndexed&&((_e=o.modelObject)===null||_e===void 0||_e.traverse(rt=>{var nt;rt.geometry&&(rt.geometry.attributes.index||(nt=rt.setGeometry)===null||nt===void 0||nt.call(rt,qs(rt.geometry)))})),o}})}async onRemove(s){return super.onRemove(s)}async exportScene(s){var o,a;return(o=this.exporter)===null||o===void 0?void 0:o.exportObject((a=this._viewer)===null||a===void 0?void 0:a.scene.modelRoot,s||{...this.exportOptions})}get uiConfig(){if(this._uiConfig)return this._uiConfig;const s=this._viewer;s.addEventListener("addPlugin",a=>{var _e;typeof((_e=a.plugin)===null||_e===void 0?void 0:_e.toJSON)=="function"&&console.error("Add all plugins before setting up the export UI, or use `toJSON: any = null` in the plugin ")});const o=Object.entries(s.plugins).filter(([a,_e])=>typeof(_e==null?void 0:_e.toJSON)=="function").map(([a,_e])=>({label:a,type:"checkbox",value:!0}));return this._uiConfig={type:"folder",label:"Asset Export",limitedUi:!0,children:[{type:"input",property:[this.exportOptions,"name"],limitedUi:!0},{type:"folder",label:"GLB Export",limitedUi:!0,children:[{type:"checkbox",label:"DRACO Compress",property:[this.exportOptions,"compress"],limitedUi:!0},{type:"checkbox",label:"Scene Settings",property:[this.exportOptions,"viewerConfig"],limitedUi:!0},{type:"checkbox",label:"Indexed meshes only",property:[this.exportOptions,"convertMeshToIndexed"]},{type:"button",label:"Export GLB",limitedUi:!0,value:async()=>{const a=await this.exportScene(this.exportOptions);a&&Nu(a,this.exportOptions.name+"."+a.ext)}}]},{type:"folder",label:"Preset/Config export",children:[{type:"folder",label:"Plugins",children:o},{type:"button",label:"Select none",value:()=>{o.forEach(a=>{var _e;a.value=!1,(_e=a.uiRefresh)===null||_e===void 0||_e.call(a)})}},{type:"button",label:"Select all",value:()=>{o.forEach(a=>{var _e;a.value=!0,(_e=a.uiRefresh)===null||_e===void 0||_e.call(a)})}},{type:"button",label:"Export Plugins",limitedUi:!0,value:async()=>{const a=new Blob([JSON.stringify(s.getPlugin(os).exportPluginPresets(o.filter(_e=>!!_e.value).map(_e=>er(_e.label)||"")),null,2)],{type:"application/json"});a&&Nu(a,this.exportOptions.name+"."+os.ViewerTypeSlug)}},{type:"button",label:"Export All Viewer Config",limitedUi:!0,value:async()=>{const a=new Blob([JSON.stringify(s.getPlugin(os).exportViewerConfig(),null,2)],{type:"application/json"});a&&Nu(a,this.exportOptions.name+"."+os.ViewerTypeSlug)}}]}]}}}uT.PluginType="AssetExporterPlugin";class UP{constructor(){this._listeners={}}addEventListener(s,o){const a=this._listeners;return a[s]===void 0&&(a[s]=[]),a[s].indexOf(o)===-1&&a[s].push(o),this}removeEventListener(s,o){if(this._listeners===void 0)return this;const a=this._listeners[s];if(a!==void 0){const _e=a.indexOf(o);_e!==-1&&a.splice(_e,1)}return this}dispatchEvent(s){if(this._listeners===void 0)return this;const o=this._listeners[s.type];if(o!==void 0){const a=o.slice(0);for(let _e=0,rt=a.length;_e<rt;_e++)a[_e].call(this,s)}return this}dispose(){for(const s in this._listeners)delete this._listeners[s]}}class fy extends UP{constructor(s,o,a,_e={}){if(super(),this._name=void 0,this._parent=void 0,this._child=void 0,this._attributes=void 0,this._disposed=!1,this._name=s,this._parent=o,this._child=a,this._attributes=_e,!o.isOnGraph(a))throw new Error("Cannot connect disconnected graphs.")}getName(){return this._name}getParent(){return this._parent}getChild(){return this._child}setChild(s){return this._child=s,this}getAttributes(){return this._attributes}dispose(){this._disposed||(this._disposed=!0,this.dispatchEvent({type:"dispose",target:this}),super.dispose())}isDisposed(){return this._disposed}}class _L extends UP{constructor(...s){super(...s),this._emptySet=new Set,this._edges=new Set,this._parentEdges=new Map,this._childEdges=new Map}listEdges(){return Array.from(this._edges)}listParentEdges(s){return Array.from(this._childEdges.get(s)||this._emptySet)}listParents(s){return this.listParentEdges(s).map(o=>o.getParent())}listChildEdges(s){return Array.from(this._parentEdges.get(s)||this._emptySet)}listChildren(s){return this.listChildEdges(s).map(o=>o.getChild())}disconnectParents(s,o){let a=this.listParentEdges(s);return o&&(a=a.filter(_e=>o(_e.getParent()))),a.forEach(_e=>_e.dispose()),this}createEdge(s,o,a,_e){return this._registerEdge(new fy(s,o,a,_e))}_registerEdge(s){this._edges.add(s);const o=s.getParent();this._parentEdges.has(o)||this._parentEdges.set(o,new Set),this._parentEdges.get(o).add(s);const a=s.getChild();return this._childEdges.has(a)||this._childEdges.set(a,new Set),this._childEdges.get(a).add(s),s.addEventListener("dispose",()=>this._removeEdge(s)),s}_removeEdge(s){return this._edges.delete(s),this._parentEdges.get(s.getParent()).delete(s),this._childEdges.get(s.getChild()).delete(s),this}}function cT(){return cT=Object.assign||function(tt){for(var s=1;s<arguments.length;s++){var o=arguments[s];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(tt[a]=o[a])}return tt},cT.apply(this,arguments)}function $P(tt){return tt instanceof fy}function jP(tt){return Array.isArray(tt)&&tt[0]instanceof fy}function zP(tt){return!!(tt&&typeof tt=="object"&&Object.values(tt)[0]instanceof fy)}const Ql=Symbol("attributes"),iS=Symbol("immutableKeys");class VP extends UP{constructor(s){super(),this._disposed=!1,this.graph=void 0,this[Ql]=void 0,this[iS]=void 0,this.graph=s,this[iS]=new Set,this[Ql]=this._createAttributes()}getDefaults(){return{}}_createAttributes(){const s=this.getDefaults(),o={};for(const a in s){const _e=s[a];if(_e instanceof VP){const rt=this.graph.createEdge(a,this,_e);rt.addEventListener("dispose",()=>_e.dispose()),this[iS].add(a),o[a]=rt}else o[a]=_e}return o}isOnGraph(s){return this.graph===s.graph}isDisposed(){return this._disposed}dispose(){this._disposed||(this.graph.listChildEdges(this).forEach(s=>s.dispose()),this.graph.disconnectParents(this),this._disposed=!0,this.dispatchEvent({type:"dispose"}))}detach(){return this.graph.disconnectParents(this),this}swap(s,o){for(const a in this[Ql]){const _e=this[Ql][a];if($P(_e)){const rt=_e;rt.getChild()===s&&this.setRef(a,o,rt.getAttributes())}else if(jP(_e)){const rt=_e.find(nt=>nt.getChild()===s);if(rt){const nt=rt.getAttributes();this.removeRef(a,s).addRef(a,o,nt)}}else if(zP(_e)){const rt=_e;for(const nt in rt){const ot=rt[nt];ot.getChild()===s&&this.setRefMap(a,nt,o,ot.getAttributes())}}}return this}get(s){return this[Ql][s]}set(s,o){return this[Ql][s]=o,this.dispatchEvent({type:"change",attribute:s})}getRef(s){const o=this[Ql][s];return o?o.getChild():null}setRef(s,o,a){if(this[iS].has(s))throw new Error(`Cannot overwrite immutable attribute, "${s}".`);const _e=this[Ql][s];if(_e&&_e.dispose(),!o)return this;const rt=this.graph.createEdge(s,this,o,a);return rt.addEventListener("dispose",()=>{delete this[Ql][s],this.dispatchEvent({type:"change",attribute:s})}),this[Ql][s]=rt,this.dispatchEvent({type:"change",attribute:s})}listRefs(s){return this[Ql][s].map(o=>o.getChild())}addRef(s,o,a){const _e=this.graph.createEdge(s,this,o,a),rt=this[Ql][s];return rt.push(_e),_e.addEventListener("dispose",()=>{const nt=rt.filter(ot=>ot!==_e);rt.length=0;for(const ot of nt)rt.push(ot);this.dispatchEvent({type:"change",attribute:s})}),this.dispatchEvent({type:"change",attribute:s})}removeRef(s,o){return this[Ql][s].filter(a=>a.getChild()===o).forEach(a=>a.dispose()),this}listRefMapKeys(s){return Object.keys(this[Ql][s])}listRefMapValues(s){return Object.values(this[Ql][s]).map(o=>o.getChild())}getRefMap(s,o){const a=this[Ql][s];return a[o]?a[o].getChild():null}setRefMap(s,o,a,_e){const rt=this[Ql][s],nt=rt[o];if(nt&&nt.dispose(),!a)return this;_e=Object.assign(_e||{},{key:o});const ot=this.graph.createEdge(s,this,a,cT({},_e,{key:o}));return ot.addEventListener("dispose",()=>{delete rt[o],this.dispatchEvent({type:"change",attribute:s,key:o})}),rt[o]=ot,this.dispatchEvent({type:"change",attribute:s,key:o})}dispatchEvent(s){return super.dispatchEvent(cT({},s,{target:this})),this.graph.dispatchEvent(cT({},s,{target:this,type:`node:${s.type}`})),this}}var IR,ss,PR,b0,Yu,x_,GP=typeof Float32Array<"u"?Float32Array:Array;function QP(tt){var s=tt[0],o=tt[1],a=tt[2];return Math.hypot(s,o,a)}function yL(tt,s,o){var a=s[0],_e=s[1],rt=s[2],nt=o[3]*a+o[7]*_e+o[11]*rt+o[15];return nt=nt||1,tt[0]=(o[0]*a+o[4]*_e+o[8]*rt+o[12])/nt,tt[1]=(o[1]*a+o[5]*_e+o[9]*rt+o[13])/nt,tt[2]=(o[2]*a+o[6]*_e+o[10]*rt+o[14])/nt,tt}function AL(tt,s,o){var a=s[0],_e=s[1],rt=s[2],nt=s[3],ot=s[4],ct=s[5],pt=s[6],ht=s[7],_t=s[8],Et=s[9],St=s[10],Mt=s[11],It=s[12],Nt=s[13],Bt=s[14],kt=s[15],Pt=o[0],qt=o[1],Kt=o[2],nr=o[3];return tt[0]=Pt*a+qt*ot+Kt*_t+nr*It,tt[1]=Pt*_e+qt*ct+Kt*Et+nr*Nt,tt[2]=Pt*rt+qt*pt+Kt*St+nr*Bt,tt[3]=Pt*nt+qt*ht+Kt*Mt+nr*kt,Pt=o[4],qt=o[5],Kt=o[6],nr=o[7],tt[4]=Pt*a+qt*ot+Kt*_t+nr*It,tt[5]=Pt*_e+qt*ct+Kt*Et+nr*Nt,tt[6]=Pt*rt+qt*pt+Kt*St+nr*Bt,tt[7]=Pt*nt+qt*ht+Kt*Mt+nr*kt,Pt=o[8],qt=o[9],Kt=o[10],nr=o[11],tt[8]=Pt*a+qt*ot+Kt*_t+nr*It,tt[9]=Pt*_e+qt*ct+Kt*Et+nr*Nt,tt[10]=Pt*rt+qt*pt+Kt*St+nr*Bt,tt[11]=Pt*nt+qt*ht+Kt*Mt+nr*kt,Pt=o[12],qt=o[13],Kt=o[14],nr=o[15],tt[12]=Pt*a+qt*ot+Kt*_t+nr*It,tt[13]=Pt*_e+qt*ct+Kt*Et+nr*Nt,tt[14]=Pt*rt+qt*pt+Kt*St+nr*Bt,tt[15]=Pt*nt+qt*ht+Kt*Mt+nr*kt,tt}function bL(tt,s){const o={min:[1/0,1/0,1/0],max:[-1/0,-1/0,-1/0]};for(const a of tt.listPrimitives()){const _e=a.getAttribute("POSITION");if(!_e)continue;let rt=[0,0,0],nt=[0,0,0];for(let ot=0;ot<_e.getCount();ot++)rt=_e.getElement(ot,rt),nt=yL(nt,rt,s),HP(nt,o)}return o}function HP(tt,s){for(let o=0;o<3;o++)s.min[o]=Math.min(tt[o],s.min[o]),s.max[o]=Math.max(tt[o],s.max[o])}Math.hypot||(Math.hypot=function(){for(var tt=0,s=arguments.length;s--;)tt+=arguments[s]*arguments[s];return Math.sqrt(tt)}),IR=new GP(3),GP!=Float32Array&&(IR[0]=0,IR[1]=0,IR[2]=0),function(tt){tt.ACCESSOR="Accessor",tt.ANIMATION="Animation",tt.ANIMATION_CHANNEL="AnimationChannel",tt.ANIMATION_SAMPLER="AnimationSampler",tt.BUFFER="Buffer",tt.CAMERA="Camera",tt.MATERIAL="Material",tt.MESH="Mesh",tt.PRIMITIVE="Primitive",tt.PRIMITIVE_TARGET="PrimitiveTarget",tt.NODE="Node",tt.ROOT="Root",tt.SCENE="Scene",tt.SKIN="Skin",tt.TEXTURE="Texture",tt.TEXTURE_INFO="TextureInfo"}(ss||(ss={})),function(tt){tt.INTERLEAVED="interleaved",tt.SEPARATE="separate"}(PR||(PR={})),function(tt){tt.ARRAY_BUFFER="ARRAY_BUFFER",tt.ELEMENT_ARRAY_BUFFER="ELEMENT_ARRAY_BUFFER",tt.INVERSE_BIND_MATRICES="INVERSE_BIND_MATRICES",tt.OTHER="OTHER"}(b0||(b0={})),function(tt){tt[tt.R=4096]="R",tt[tt.G=256]="G",tt[tt.B=16]="B",tt[tt.A=1]="A"}(Yu||(Yu={})),function(tt){tt.GLTF="GLTF",tt.GLB="GLB"}(x_||(x_={}));class Yo{static createBufferFromDataURI(s){if(typeof Buffer>"u"){const o=atob(s.split(",")[1]),a=new Uint8Array(o.length);for(let _e=0;_e<o.length;_e++)a[_e]=o.charCodeAt(_e);return a}{const o=s.split(",")[1],a=s.indexOf("base64")>=0;return Buffer.from(o,a?"base64":"utf8")}}static encodeText(s){return typeof TextEncoder<"u"?new TextEncoder().encode(s):Buffer.from(s)}static decodeText(s){return typeof TextDecoder<"u"?new TextDecoder().decode(s):Buffer.from(s).toString("utf8")}static concat(s){let o=0;for(const rt of s)o+=rt.byteLength;const a=new Uint8Array(o);let _e=0;for(const rt of s)a.set(rt,_e),_e+=rt.byteLength;return a}static pad(s,o=0){const a=this.padNumber(s.byteLength);if(a===s.byteLength)return s;const _e=new Uint8Array(a);if(_e.set(s),o!==0)for(let rt=s.byteLength;rt<a;rt++)_e[rt]=o;return _e}static padNumber(s){return 4*Math.ceil(s/4)}static equals(s,o){if(s===o)return!0;if(s.byteLength!==o.byteLength)return!1;let a=s.byteLength;for(;a--;)if(s[a]!==o[a])return!1;return!0}static toView(s,o=0,a=1/0){return new Uint8Array(s.buffer,s.byteOffset+o,Math.min(s.byteLength,a))}static assertView(s){if(s&&!ArrayBuffer.isView(s))throw new Error(`Method requires Uint8Array parameter; received "${typeof s}".`);return s}}class dv{static hexToFactor(s,o){s=Math.floor(s);const a=o;return a[0]=(s>>16&255)/255,a[1]=(s>>8&255)/255,a[2]=(255&s)/255,this.convertSRGBToLinear(o,o)}static factorToHex(s){const o=[...s],[a,_e,rt]=this.convertLinearToSRGB(s,o);return 255*a<<16^255*_e<<8^255*rt<<0}static convertSRGBToLinear(s,o){const a=s,_e=o;for(let rt=0;rt<3;rt++)_e[rt]=a[rt]<.04045?.0773993808*a[rt]:Math.pow(.9478672986*a[rt]+.0521327014,2.4);return o}static convertLinearToSRGB(s,o){const a=s,_e=o;for(let rt=0;rt<3;rt++)_e[rt]=a[rt]<.0031308?12.92*a[rt]:1.055*Math.pow(a[rt],.41666)-.055;return o}}class DR{match(s){return s.length>=8&&s[0]===137&&s[1]===80&&s[2]===78&&s[3]===71&&s[4]===13&&s[5]===10&&s[6]===26&&s[7]===10}getSize(s){const o=new DataView(s.buffer,s.byteOffset);return Yo.decodeText(s.slice(12,16))===DR.PNG_FRIED_CHUNK_NAME?[o.getUint32(32,!1),o.getUint32(36,!1)]:[o.getUint32(16,!1),o.getUint32(20,!1)]}getChannels(s){return 4}}DR.PNG_FRIED_CHUNK_NAME="CgBI";class pA{static registerFormat(s,o){this.impls[s]=o}static getMimeType(s){for(const o in this.impls)if(this.impls[o].match(s))return o;return null}static getSize(s,o){return this.impls[o]?this.impls[o].getSize(s):null}static getChannels(s,o){return this.impls[o]?this.impls[o].getChannels(s):null}static getMemSize(s,o){if(!this.impls[o])return null;if(this.impls[o].getGPUByteLength)return this.impls[o].getGPUByteLength(s);let a=0;const _e=this.getSize(s,o);if(!_e)return null;for(;_e[0]>1||_e[1]>1;)a+=_e[0]*_e[1]*4,_e[0]=Math.max(Math.floor(_e[0]/2),1),_e[1]=Math.max(Math.floor(_e[1]/2),1);return a+=4,a}static mimeTypeToExtension(s){return s==="image/jpeg"?"jpg":s.split("/").pop()}static extensionToMimeType(s){return s==="jpg"?"image/jpeg":`image/${s}`}}function wL(tt,s){if(s>tt.byteLength)throw new TypeError("Corrupt JPG, exceeded buffer limits");if(tt.getUint8(s)!==255)throw new TypeError("Invalid JPG, marker table corrupted");return tt}pA.impls={"image/jpeg":new class{match(tt){return tt.length>=3&&tt[0]===255&&tt[1]===216&&tt[2]===255}getSize(tt){let s,o,a=new DataView(tt.buffer,tt.byteOffset+4);for(;a.byteLength;){if(s=a.getUint16(0,!1),wL(a,s),o=a.getUint8(s+1),o===192||o===193||o===194)return[a.getUint16(s+7,!1),a.getUint16(s+5,!1)];a=new DataView(tt.buffer,a.byteOffset+s+2)}throw new TypeError("Invalid JPG, no size found")}getChannels(tt){return 3}},"image/png":new DR};class nx{static basename(s){const o=s.split(/[\\/]/).pop();return o.substring(0,o.lastIndexOf("."))}static extension(s){if(s.startsWith("data:image/")){const o=s.match(/data:(image\/\w+)/)[1];return pA.mimeTypeToExtension(o)}return s.startsWith("data:model/gltf+json")?"gltf":s.startsWith("data:model/gltf-binary")?"glb":s.startsWith("data:application/")?"bin":s.split(/[\\/]/).pop().split(/[.]/).pop()}}function PD(tt){return Object.prototype.toString.call(tt)==="[object Object]"}function hA(tt){if(PD(tt)===!1)return!1;const s=tt.constructor;if(s===void 0)return!0;const o=s.prototype;return PD(o)!==!1&&Object.prototype.hasOwnProperty.call(o,"isPrototypeOf")!==!1}class zv{constructor(s){this.verbosity=void 0,this.verbosity=s}debug(s){this.verbosity<=zv.Verbosity.DEBUG&&console.debug(s)}info(s){this.verbosity<=zv.Verbosity.INFO&&console.info(s)}warn(s){this.verbosity<=zv.Verbosity.WARN&&console.warn(s)}error(s){this.verbosity<=zv.Verbosity.ERROR&&console.error(s)}}zv.Verbosity={SILENT:4,ERROR:3,WARN:2,INFO:1,DEBUG:0},zv.DEFAULT_INSTANCE=new zv(zv.Verbosity.INFO);class ku{static identity(s){return s}static eq(s,o){if(s.length!==o.length)return!1;for(let a=0;a<s.length;a++)if(Math.abs(s[a]-o[a])>1e-5)return!1;return!0}static denormalize(s,o){switch(o){case 5126:return s;case 5123:return s/65535;case 5121:return s/255;case 5122:return Math.max(s/32767,-1);case 5120:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}static normalize(s,o){switch(o){case 5126:return s;case 5123:return Math.round(65535*s);case 5121:return Math.round(255*s);case 5122:return Math.round(32767*s);case 5120:return Math.round(127*s);default:throw new Error("Invalid component type.")}}static decompose(s,o,a,_e){let rt=QP([s[0],s[1],s[2]]);const nt=QP([s[4],s[5],s[6]]),ot=QP([s[8],s[9],s[10]]);(function(Et){var St=Et[0],Mt=Et[1],It=Et[2],Nt=Et[3],Bt=Et[4],kt=Et[5],Pt=Et[6],qt=Et[7],Kt=Et[8],nr=Et[9],ir=Et[10],fr=Et[11],br=Et[12],Tr=Et[13],Dr=Et[14],Rr=Et[15];return(St*kt-Mt*Bt)*(ir*Rr-fr*Dr)-(St*Pt-It*Bt)*(nr*Rr-fr*Tr)+(St*qt-Nt*Bt)*(nr*Dr-ir*Tr)+(Mt*Pt-It*kt)*(Kt*Rr-fr*br)-(Mt*qt-Nt*kt)*(Kt*Dr-ir*br)+(It*qt-Nt*Pt)*(Kt*Tr-nr*br)})(s)<0&&(rt=-rt),o[0]=s[12],o[1]=s[13],o[2]=s[14];const ct=s.slice(),pt=1/rt,ht=1/nt,_t=1/ot;ct[0]*=pt,ct[1]*=pt,ct[2]*=pt,ct[4]*=ht,ct[5]*=ht,ct[6]*=ht,ct[8]*=_t,ct[9]*=_t,ct[10]*=_t,function(Et,St){var Mt=new GP(3);(function(Nr,Ir){var kr=Ir[0],Hr=Ir[1],Lr=Ir[2],en=Ir[4],vn=Ir[5],wn=Ir[6],pn=Ir[8],Fn=Ir[9],Gn=Ir[10];Nr[0]=Math.hypot(kr,Hr,Lr),Nr[1]=Math.hypot(en,vn,wn),Nr[2]=Math.hypot(pn,Fn,Gn)})(Mt,St);var It=1/Mt[0],Nt=1/Mt[1],Bt=1/Mt[2],kt=St[0]*It,Pt=St[1]*Nt,qt=St[2]*Bt,Kt=St[4]*It,nr=St[5]*Nt,ir=St[6]*Bt,fr=St[8]*It,br=St[9]*Nt,Tr=St[10]*Bt,Dr=kt+nr+Tr,Rr=0;Dr>0?(Rr=2*Math.sqrt(Dr+1),Et[3]=.25*Rr,Et[0]=(ir-br)/Rr,Et[1]=(fr-qt)/Rr,Et[2]=(Pt-Kt)/Rr):kt>nr&&kt>Tr?(Rr=2*Math.sqrt(1+kt-nr-Tr),Et[3]=(ir-br)/Rr,Et[0]=.25*Rr,Et[1]=(Pt+Kt)/Rr,Et[2]=(fr+qt)/Rr):nr>Tr?(Rr=2*Math.sqrt(1+nr-kt-Tr),Et[3]=(fr-qt)/Rr,Et[0]=(Pt+Kt)/Rr,Et[1]=.25*Rr,Et[2]=(ir+br)/Rr):(Rr=2*Math.sqrt(1+Tr-kt-nr),Et[3]=(Pt-Kt)/Rr,Et[0]=(fr+qt)/Rr,Et[1]=(ir+br)/Rr,Et[2]=.25*Rr)}(a,ct),_e[0]=rt,_e[1]=nt,_e[2]=ot}static compose(s,o,a,_e){const rt=_e,nt=o[0],ot=o[1],ct=o[2],pt=o[3],ht=nt+nt,_t=ot+ot,Et=ct+ct,St=nt*ht,Mt=nt*_t,It=nt*Et,Nt=ot*_t,Bt=ot*Et,kt=ct*Et,Pt=pt*ht,qt=pt*_t,Kt=pt*Et,nr=a[0],ir=a[1],fr=a[2];return rt[0]=(1-(Nt+kt))*nr,rt[1]=(Mt+Kt)*nr,rt[2]=(It-qt)*nr,rt[3]=0,rt[4]=(Mt-Kt)*ir,rt[5]=(1-(St+kt))*ir,rt[6]=(Bt+Pt)*ir,rt[7]=0,rt[8]=(It+qt)*fr,rt[9]=(Bt-Pt)*fr,rt[10]=(1-(St+Nt))*fr,rt[11]=0,rt[12]=s[0],rt[13]=s[1],rt[14]=s[2],rt[15]=1,rt}}function xL(tt,s){if(!!tt!=!!s)return!1;const o=tt.getChild(),a=s.getChild();return o===a||o.equals(a)}function EL(tt,s){if(!!tt!=!!s||tt.length!==s.length)return!1;for(let o=0;o<tt.length;o++){const a=tt[o],_e=s[o];if(a.getChild()!==_e.getChild()&&!a.getChild().equals(_e.getChild()))return!1}return!0}function SL(tt,s){if(!!tt!=!!s)return!1;const o=Object.keys(tt),a=Object.keys(s);if(o.length!==a.length)return!1;for(const _e in tt){const rt=tt[_e],nt=s[_e];if(!!rt!=!!nt)return!1;const ot=rt.getChild(),ct=nt.getChild();if(ot!==ct&&!ot.equals(ct))return!1}return!0}function DD(tt,s){if(tt===s)return!0;if(!!tt!=!!s||!tt||!s||tt.length!==s.length)return!1;for(let o=0;o<tt.length;o++)if(tt[o]!==s[o])return!1;return!0}function BD(tt,s){if(tt===s)return!0;if(!!tt!=!!s)return!1;if(!hA(tt)||!hA(s))return tt===s;const o=tt,a=s;let _e,rt=0,nt=0;for(_e in o)rt++;for(_e in a)nt++;if(rt!==nt)return!1;for(_e in o){const ot=o[_e],ct=a[_e];if(BR(ot)&&BR(ct)){if(!DD(ot,ct))return!1}else if(hA(ot)&&hA(ct)){if(!BD(ot,ct))return!1}else if(ot!==ct)return!1}return!0}function BR(tt){return Array.isArray(tt)||ArrayBuffer.isView(tt)}const kD="23456789abdegjkmnpqrvwxyzABDEGJKMNPQRVWXYZ",OD=new Set,CL=function(){let tt="";for(let s=0;s<6;s++)tt+=kD.charAt(Math.floor(Math.random()*kD.length));return tt};class Ew{static dirname(s){const o=s.lastIndexOf("/");return o===-1?"./":s.substring(0,o+1)}static basename(s){return nx.basename(new URL(s,"https://null.example").pathname)}static extension(s){return nx.extension(new URL(s,"https://null.example").pathname)}static resolve(s,o){if(!this.isRelativePath(o))return o;const a=s.split("/"),_e=o.split("/");a.pop();for(let rt=0;rt<_e.length;rt++)_e[rt]!=="."&&(_e[rt]===".."?a.pop():a.push(_e[rt]));return a.join("/")}static isAbsoluteURL(s){return this.PROTOCOL_REGEXP.test(s)}static isRelativePath(s){return!/^(?:[a-zA-Z]+:)?\//.test(s)}}Ew.DEFAULT_INIT={},Ew.PROTOCOL_REGEXP=/^[a-zA-Z]+:\/\//;const my=tt=>tt,TL=new Set;class qP extends VP{constructor(s,o=""){super(s),this[Ql].name=o,this.init(),this.dispatchEvent({type:"create"})}getDefaults(){return Object.assign(super.getDefaults(),{name:"",extras:{}})}getName(){return this.get("name")}setName(s){return this.set("name",s)}getExtras(){return this.get("extras")}setExtras(s){return this.set("extras",s)}clone(){return new this.constructor(this.graph).copy(this,my)}copy(s,o=my){for(const a in this[Ql]){const _e=this[Ql][a];if(_e instanceof fy)this[iS].has(a)||_e.dispose();else if(Array.isArray(_e)&&_e[0]instanceof fy)for(const rt of _e)rt.dispose();else if(hA(_e)&&Object.values(_e)[0]instanceof fy)for(const rt in _e)_e[rt].dispose()}for(const a in s[Ql]){const _e=this[Ql][a],rt=s[Ql][a];if(rt instanceof fy)this[iS].has(a)?_e.getChild().copy(o(rt.getChild()),o):this.setRef(a,o(rt.getChild()),rt.getAttributes());else if(Array.isArray(rt)&&rt[0]instanceof fy)for(const nt of rt)this.addRef(a,o(nt.getChild()),nt.getAttributes());else if(hA(rt)&&Object.values(rt)[0]instanceof fy)for(const nt in rt){const ot=rt[nt];this.setRefMap(a,nt,o(ot.getChild()),ot.getAttributes())}else this[Ql][a]=hA(rt)?JSON.parse(JSON.stringify(rt)):Array.isArray(rt)||rt instanceof ArrayBuffer||ArrayBuffer.isView(rt)?rt.slice():rt}return this}equals(s,o=TL){if(this===s)return!0;if(this.propertyType!==s.propertyType)return!1;for(const a in this[Ql]){if(o.has(a))continue;const _e=this[Ql][a],rt=s[Ql][a];if($P(_e)||$P(rt)){if(!xL(_e,rt))return!1}else if(jP(_e)||jP(rt)){if(!EL(_e,rt))return!1}else if(zP(_e)||zP(rt)){if(!SL(_e,rt))return!1}else if(hA(_e)||hA(rt)){if(!BD(_e,rt))return!1}else if(BR(_e)||BR(rt)){if(!DD(_e,rt))return!1}else if(_e!==rt)return!1}return!0}detach(){return this.graph.disconnectParents(this,s=>s.propertyType!=="Root"),this}listParents(){return this.graph.listParents(this)}}class Fm extends qP{getDefaults(){return Object.assign(super.getDefaults(),{extensions:{}})}getExtension(s){return this.getRefMap("extensions",s)}setExtension(s,o){return o&&o.t(this),this.setRefMap("extensions",s,o)}listExtensions(){return this.listRefMapValues("extensions")}}class Ss extends Fm{constructor(...s){super(...s),this.i=ku.identity,this.o=ku.identity}init(){this.propertyType=ss.ACCESSOR}getDefaults(){return Object.assign(super.getDefaults(),{array:null,type:Ss.Type.SCALAR,componentType:Ss.ComponentType.FLOAT,normalized:!1,buffer:null})}copy(s,o=my){return super.copy(s,o),this.i=s.i,this.o=s.o,this}static getElementSize(s){switch(s){case Ss.Type.SCALAR:return 1;case Ss.Type.VEC2:return 2;case Ss.Type.VEC3:return 3;case Ss.Type.VEC4:case Ss.Type.MAT2:return 4;case Ss.Type.MAT3:return 9;case Ss.Type.MAT4:return 16;default:throw new Error("Unexpected type: "+s)}}static getComponentSize(s){switch(s){case Ss.ComponentType.BYTE:case Ss.ComponentType.UNSIGNED_BYTE:return 1;case Ss.ComponentType.SHORT:case Ss.ComponentType.UNSIGNED_SHORT:return 2;case Ss.ComponentType.UNSIGNED_INT:case Ss.ComponentType.FLOAT:return 4;default:throw new Error("Unexpected component type: "+s)}}getMinNormalized(s){const o=this.getElementSize();this.getMin(s);for(let a=0;a<o;a++)s[a]=this.o(s[a]);return s}getMin(s){const o=this.get("array"),a=this.getCount(),_e=this.getElementSize();for(let rt=0;rt<_e;rt++)s[rt]=1/0;for(let rt=0;rt<a*_e;rt+=_e)for(let nt=0;nt<_e;nt++){const ot=o[rt+nt];Number.isFinite(ot)&&(s[nt]=Math.min(s[nt],ot))}return s}getMaxNormalized(s){const o=this.getElementSize();this.getMax(s);for(let a=0;a<o;a++)s[a]=this.o(s[a]);return s}getMax(s){const o=this.get("array"),a=this.getCount(),_e=this.getElementSize();for(let rt=0;rt<_e;rt++)s[rt]=-1/0;for(let rt=0;rt<a*_e;rt+=_e)for(let nt=0;nt<_e;nt++){const ot=o[rt+nt];Number.isFinite(ot)&&(s[nt]=Math.max(s[nt],ot))}return s}getCount(){const s=this.get("array");return s?s.length/this.getElementSize():0}getType(){return this.get("type")}setType(s){return this.set("type",s)}getElementSize(){return Ss.getElementSize(this.get("type"))}getComponentSize(){return this.get("array").BYTES_PER_ELEMENT}getComponentType(){return this.get("componentType")}getNormalized(){return this.get("normalized")}setNormalized(s){return this.set("normalized",s),s?(this.o=o=>ku.denormalize(o,this.get("componentType")),this.i=o=>ku.normalize(o,this.get("componentType"))):(this.o=ku.identity,this.i=ku.identity),this}getScalar(s){const o=this.getElementSize();return this.o(this.get("array")[s*o])}setScalar(s,o){return this.get("array")[s*this.getElementSize()]=this.i(o),this}getElement(s,o){const a=this.getElementSize(),_e=this.get("array");for(let rt=0;rt<a;rt++)o[rt]=this.o(_e[s*a+rt]);return o}setElement(s,o){const a=this.getElementSize(),_e=this.get("array");for(let rt=0;rt<a;rt++)_e[s*a+rt]=this.i(o[rt]);return this}getBuffer(){return this.getRef("buffer")}setBuffer(s){return this.setRef("buffer",s)}getArray(){return this.get("array")}setArray(s){return this.set("componentType",s?function(o){switch(o.constructor){case Float32Array:return Ss.ComponentType.FLOAT;case Uint32Array:return Ss.ComponentType.UNSIGNED_INT;case Uint16Array:return Ss.ComponentType.UNSIGNED_SHORT;case Uint8Array:return Ss.ComponentType.UNSIGNED_BYTE;case Int16Array:return Ss.ComponentType.SHORT;case Int8Array:return Ss.ComponentType.BYTE;default:throw new Error("Unknown accessor componentType.")}}(s):Ss.ComponentType.FLOAT),this.set("array",s),this}getByteLength(){const s=this.get("array");return s?s.byteLength:0}}Ss.Type={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4"},Ss.ComponentType={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126};class LD extends Fm{init(){this.propertyType=ss.ANIMATION}getDefaults(){return Object.assign(super.getDefaults(),{channels:[],samplers:[]})}addChannel(s){return this.addRef("channels",s)}removeChannel(s){return this.removeRef("channels",s)}listChannels(){return this.listRefs("channels")}addSampler(s){return this.addRef("samplers",s)}removeSampler(s){return this.removeRef("samplers",s)}listSamplers(){return this.listRefs("samplers")}}class WP extends Fm{init(){this.propertyType=ss.ANIMATION_CHANNEL}getDefaults(){return Object.assign(super.getDefaults(),{targetPath:null,targetNode:null,sampler:null})}getTargetPath(){return this.get("targetPath")}setTargetPath(s){return this.set("targetPath",s)}getTargetNode(){return this.getRef("targetNode")}setTargetNode(s){return this.setRef("targetNode",s)}getSampler(){return this.getRef("sampler")}setSampler(s){return this.setRef("sampler",s)}}WP.TargetPath={TRANSLATION:"translation",ROTATION:"rotation",SCALE:"scale",WEIGHTS:"weights"};class sS extends Fm{init(){this.propertyType=ss.ANIMATION_SAMPLER}getDefaultAttributes(){return Object.assign(super.getDefaults(),{interpolation:sS.Interpolation.LINEAR,input:null,output:null})}getInterpolation(){return this.get("interpolation")}setInterpolation(s){return this.set("interpolation",s)}getInput(){return this.getRef("input")}setInput(s){return this.setRef("input",s,{usage:b0.OTHER})}getOutput(){return this.getRef("output")}setOutput(s){return this.setRef("output",s,{usage:b0.OTHER})}}sS.Interpolation={LINEAR:"LINEAR",STEP:"STEP",CUBICSPLINE:"CUBICSPLINE"};class ND extends Fm{init(){this.propertyType=ss.BUFFER}getDefaults(){return Object.assign(super.getDefaults(),{uri:""})}getURI(){return this.get("uri")}setURI(s){return this.set("uri",s)}}class ix extends Fm{init(){this.propertyType=ss.CAMERA}getDefaults(){return Object.assign(super.getDefaults(),{type:ix.Type.PERSPECTIVE,znear:.1,zfar:100,aspectRatio:null,yfov:2*Math.PI*50/360,xmag:1,ymag:1})}getType(){return this.get("type")}setType(s){return this.set("type",s)}getZNear(){return this.get("znear")}setZNear(s){return this.set("znear",s)}getZFar(){return this.get("zfar")}setZFar(s){return this.set("zfar",s)}getAspectRatio(){return this.get("aspectRatio")}setAspectRatio(s){return this.set("aspectRatio",s)}getYFov(){return this.get("yfov")}setYFov(s){return this.set("yfov",s)}getXMag(){return this.get("xmag")}setXMag(s){return this.set("xmag",s)}getYMag(){return this.get("ymag")}setYMag(s){return this.set("ymag",s)}}ix.Type={PERSPECTIVE:"perspective",ORTHOGRAPHIC:"orthographic"};class Ku extends qP{t(s){if(!this.parentTypes.includes(s.propertyType))throw new Error(`Parent "${s.propertyType}" invalid for child "${this.propertyType}".`)}}Ku.EXTENSION_NAME=void 0;class yu extends Fm{init(){this.propertyType=ss.TEXTURE_INFO}getDefaults(){return Object.assign(super.getDefaults(),{texCoord:0,magFilter:null,minFilter:null,wrapS:yu.WrapMode.REPEAT,wrapT:yu.WrapMode.REPEAT})}getTexCoord(){return this.get("texCoord")}setTexCoord(s){return this.set("texCoord",s)}getMagFilter(){return this.get("magFilter")}setMagFilter(s){return this.set("magFilter",s)}getMinFilter(){return this.get("minFilter")}setMinFilter(s){return this.set("minFilter",s)}getWrapS(){return this.get("wrapS")}setWrapS(s){return this.set("wrapS",s)}getWrapT(){return this.get("wrapT")}setWrapT(s){return this.set("wrapT",s)}}yu.WrapMode={CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},yu.MagFilter={NEAREST:9728,LINEAR:9729},yu.MinFilter={NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987};const{R:kR,G:OR,B:LR,A:ML}=Yu;class sx extends Fm{init(){this.propertyType=ss.MATERIAL}getDefaults(){return Object.assign(super.getDefaults(),{alphaMode:sx.AlphaMode.OPAQUE,alphaCutoff:.5,doubleSided:!1,baseColorFactor:[1,1,1,1],baseColorTexture:null,baseColorTextureInfo:new yu(this.graph,"baseColorTextureInfo"),emissiveFactor:[0,0,0],emissiveTexture:null,emissiveTextureInfo:new yu(this.graph,"emissiveTextureInfo"),normalScale:1,normalTexture:null,normalTextureInfo:new yu(this.graph,"normalTextureInfo"),occlusionStrength:1,occlusionTexture:null,occlusionTextureInfo:new yu(this.graph,"occlusionTextureInfo"),roughnessFactor:1,metallicFactor:1,metallicRoughnessTexture:null,metallicRoughnessTextureInfo:new yu(this.graph,"metallicRoughnessTextureInfo")})}getDoubleSided(){return this.get("doubleSided")}setDoubleSided(s){return this.set("doubleSided",s)}getAlpha(){return this.get("baseColorFactor")[3]}setAlpha(s){const o=this.get("baseColorFactor").slice();return o[3]=s,this.set("baseColorFactor",o)}getAlphaMode(){return this.get("alphaMode")}setAlphaMode(s){return this.set("alphaMode",s)}getAlphaCutoff(){return this.get("alphaCutoff")}setAlphaCutoff(s){return this.set("alphaCutoff",s)}getBaseColorFactor(){return this.get("baseColorFactor")}setBaseColorFactor(s){return this.set("baseColorFactor",s)}getBaseColorHex(){return dv.factorToHex(this.get("baseColorFactor"))}setBaseColorHex(s){const o=this.get("baseColorFactor").slice();return this.set("baseColorFactor",dv.hexToFactor(s,o))}getBaseColorTexture(){return this.getRef("baseColorTexture")}getBaseColorTextureInfo(){return this.getRef("baseColorTexture")?this.getRef("baseColorTextureInfo"):null}setBaseColorTexture(s){return this.setRef("baseColorTexture",s,{channels:kR|OR|LR|ML})}getEmissiveFactor(){return this.get("emissiveFactor")}setEmissiveFactor(s){return this.set("emissiveFactor",s)}getEmissiveHex(){return dv.factorToHex(this.get("emissiveFactor"))}setEmissiveHex(s){const o=this.get("emissiveFactor").slice();return this.set("emissiveFactor",dv.hexToFactor(s,o))}getEmissiveTexture(){return this.getRef("emissiveTexture")}getEmissiveTextureInfo(){return this.getRef("emissiveTexture")?this.getRef("emissiveTextureInfo"):null}setEmissiveTexture(s){return this.setRef("emissiveTexture",s,{channels:kR|OR|LR})}getNormalScale(){return this.get("normalScale")}setNormalScale(s){return this.set("normalScale",s)}getNormalTexture(){return this.getRef("normalTexture")}getNormalTextureInfo(){return this.getRef("normalTexture")?this.getRef("normalTextureInfo"):null}setNormalTexture(s){return this.setRef("normalTexture",s,{channels:kR|OR|LR})}getOcclusionStrength(){return this.get("occlusionStrength")}setOcclusionStrength(s){return this.set("occlusionStrength",s)}getOcclusionTexture(){return this.getRef("occlusionTexture")}getOcclusionTextureInfo(){return this.getRef("occlusionTexture")?this.getRef("occlusionTextureInfo"):null}setOcclusionTexture(s){return this.setRef("occlusionTexture",s,{channels:kR})}getRoughnessFactor(){return this.get("roughnessFactor")}setRoughnessFactor(s){return this.set("roughnessFactor",s)}getMetallicFactor(){return this.get("metallicFactor")}setMetallicFactor(s){return this.set("metallicFactor",s)}getMetallicRoughnessTexture(){return this.getRef("metallicRoughnessTexture")}getMetallicRoughnessTextureInfo(){return this.getRef("metallicRoughnessTexture")?this.getRef("metallicRoughnessTextureInfo"):null}setMetallicRoughnessTexture(s){return this.setRef("metallicRoughnessTexture",s,{channels:OR|LR})}}sx.AlphaMode={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};class FD extends Fm{init(){this.propertyType=ss.MESH}getDefaults(){return Object.assign(super.getDefaults(),{weights:[],primitives:[]})}addPrimitive(s){return this.addRef("primitives",s)}removePrimitive(s){return this.removeRef("primitives",s)}listPrimitives(){return this.listRefs("primitives")}getWeights(){return this.get("weights")}setWeights(s){return this.set("weights",s)}}class NR extends Fm{constructor(...s){super(...s),this.u=null}init(){this.propertyType=ss.NODE}getDefaults(){return Object.assign(super.getDefaults(),{translation:[0,0,0],rotation:[0,0,0,1],scale:[1,1,1],weights:[],camera:null,mesh:null,skin:null,children:[]})}copy(s,o=my){if(o===my)throw new Error("Node cannot be copied.");return super.copy(s,o)}getTranslation(){return this.get("translation")}getRotation(){return this.get("rotation")}getScale(){return this.get("scale")}setTranslation(s){return this.set("translation",s)}setRotation(s){return this.set("rotation",s)}setScale(s){return this.set("scale",s)}getMatrix(){return ku.compose(this.get("translation"),this.get("rotation"),this.get("scale"),[])}setMatrix(s){const o=this.get("translation").slice(),a=this.get("rotation").slice(),_e=this.get("scale").slice();return ku.decompose(s,o,a,_e),this.set("translation",o).set("rotation",a).set("scale",_e)}getWorldTranslation(){const s=[0,0,0];return ku.decompose(this.getWorldMatrix(),s,[0,0,0,1],[1,1,1]),s}getWorldRotation(){const s=[0,0,0,1];return ku.decompose(this.getWorldMatrix(),[0,0,0],s,[1,1,1]),s}getWorldScale(){const s=[1,1,1];return ku.decompose(this.getWorldMatrix(),[0,0,0],[0,0,0,1],s),s}getWorldMatrix(){const s=[];for(let _e=this;_e instanceof NR;_e=_e.u)s.push(_e);let o;const a=s.pop().getMatrix();for(;o=s.pop();)AL(a,a,o.getMatrix());return a}addChild(s){s.u&&s.u.removeChild(s),this.addRef("children",s),s.u=this;const o=this[Ql].children;return o[o.length-1].addEventListener("dispose",()=>s.u=null),this}removeChild(s){return this.removeRef("children",s)}listChildren(){return this.listRefs("children")}getParent(){return this.u}getMesh(){return this.getRef("mesh")}setMesh(s){return this.setRef("mesh",s)}getCamera(){return this.getRef("camera")}setCamera(s){return this.setRef("camera",s)}getSkin(){return this.getRef("skin")}setSkin(s){return this.setRef("skin",s)}getWeights(){return this.get("weights")}setWeights(s){return this.set("weights",s)}traverse(s){s(this);for(const o of this.listChildren())o.traverse(s);return this}}class ox extends Fm{init(){this.propertyType=ss.PRIMITIVE}getDefaults(){return Object.assign(super.getDefaults(),{mode:ox.Mode.TRIANGLES,material:null,indices:null,attributes:{},targets:[]})}getIndices(){return this.getRef("indices")}setIndices(s){return this.setRef("indices",s,{usage:b0.ELEMENT_ARRAY_BUFFER})}getAttribute(s){return this.getRefMap("attributes",s)}setAttribute(s,o){return this.setRefMap("attributes",s,o,{usage:b0.ARRAY_BUFFER})}listAttributes(){return this.listRefMapValues("attributes")}listSemantics(){return this.listRefMapKeys("attributes")}getMaterial(){return this.getRef("material")}setMaterial(s){return this.setRef("material",s)}getMode(){return this.get("mode")}setMode(s){return this.set("mode",s)}listTargets(){return this.listRefs("targets")}addTarget(s){return this.addRef("targets",s)}removeTarget(s){return this.removeRef("targets",s)}}ox.Mode={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class RL extends qP{init(){this.propertyType=ss.PRIMITIVE_TARGET}getDefaults(){return Object.assign(super.getDefaults(),{attributes:{}})}getAttribute(s){return this.getRefMap("attributes",s)}setAttribute(s,o){return this.setRefMap("attributes",s,o,{usage:b0.ARRAY_BUFFER})}listAttributes(){return this.listRefMapValues("attributes")}listSemantics(){return this.listRefMapKeys("attributes")}}function pv(){return(pv=Object.assign||function(tt){for(var s=1;s<arguments.length;s++){var o=arguments[s];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(tt[a]=o[a])}return tt}).apply(this,arguments)}class UD extends Fm{init(){this.propertyType=ss.SCENE}getDefaults(){return Object.assign(super.getDefaults(),{children:[]})}copy(s,o=my){if(o===my)throw new Error("Scene cannot be copied.");return super.copy(s,o)}addChild(s){s.u&&s.u.removeChild(s),this.addRef("children",s),s.u=this;const o=this[Ql].children;return o[o.length-1].addEventListener("dispose",()=>s.u=null),this}removeChild(s){return this.removeRef("children",s)}listChildren(){return this.listRefs("children")}traverse(s){for(const o of this.listChildren())o.traverse(s);return this}}class $D extends Fm{init(){this.propertyType=ss.SKIN}getDefaults(){return Object.assign(super.getDefaults(),{skeleton:null,inverseBindMatrices:null,joints:[]})}getSkeleton(){return this.getRef("skeleton")}setSkeleton(s){return this.setRef("skeleton",s)}getInverseBindMatrices(){return this.getRef("inverseBindMatrices")}setInverseBindMatrices(s){return this.setRef("inverseBindMatrices",s,{usage:b0.INVERSE_BIND_MATRICES})}addJoint(s){return this.addRef("joints",s)}removeJoint(s){return this.removeRef("joints",s)}listJoints(){return this.listRefs("joints")}}class jD extends Fm{init(){this.propertyType=ss.TEXTURE}getDefaults(){return Object.assign(super.getDefaults(),{image:null,mimeType:"",uri:""})}getMimeType(){return this.get("mimeType")||pA.extensionToMimeType(nx.extension(this.get("uri")))}setMimeType(s){return this.set("mimeType",s)}getURI(){return this.get("uri")}setURI(s){return this.set("uri",s),this.set("mimeType",pA.extensionToMimeType(nx.extension(s))),this}getImage(){return this.get("image")}setImage(s){return this.set("image",Yo.assertView(s))}getSize(){const s=this.get("image");return s?pA.getSize(s,this.getMimeType()):null}}class zD extends Fm{init(){this.propertyType=ss.ROOT}getDefaults(){return Object.assign(super.getDefaults(),{asset:{generator:"glTF-Transform v2.2.3",version:"2.0"},defaultScene:null,accessors:[],animations:[],buffers:[],cameras:[],materials:[],meshes:[],nodes:[],scenes:[],skins:[],textures:[]})}constructor(s){super(s),this.h=new Set,s.addEventListener("node:create",o=>{this.l(o.target)})}clone(){throw new Error("Root cannot be cloned.")}copy(s,o=my){if(o===my)throw new Error("Root cannot be copied.");this.set("asset",pv({},s.get("asset"))),this.setName(s.getName()),this.setExtras(pv({},s.getExtras())),this.setDefaultScene(s.getDefaultScene()?o(s.getDefaultScene()):null);for(const a of s.listRefMapKeys("extensions")){const _e=s.getExtension(a);this.setExtension(a,o(_e))}return this}l(s){return s instanceof UD?this.addRef("scenes",s):s instanceof NR?this.addRef("nodes",s):s instanceof ix?this.addRef("cameras",s):s instanceof $D?this.addRef("skins",s):s instanceof FD?this.addRef("meshes",s):s instanceof sx?this.addRef("materials",s):s instanceof jD?this.addRef("textures",s):s instanceof LD?this.addRef("animations",s):s instanceof Ss?this.addRef("accessors",s):s instanceof ND&&this.addRef("buffers",s),this}getAsset(){return this.get("asset")}listExtensionsUsed(){return Array.from(this.h)}listExtensionsRequired(){return this.listExtensionsUsed().filter(s=>s.isRequired())}g(s){return this.h.add(s),this}p(s){return this.h.delete(s),this}listScenes(){return this.listRefs("scenes")}setDefaultScene(s){return this.setRef("defaultScene",s)}getDefaultScene(){return this.getRef("defaultScene")}listNodes(){return this.listRefs("nodes")}listCameras(){return this.listRefs("cameras")}listSkins(){return this.listRefs("skins")}listMeshes(){return this.listRefs("meshes")}listMaterials(){return this.listRefs("materials")}listTextures(){return this.listRefs("textures")}listAnimations(){return this.listRefs("animations")}listAccessors(){return this.listRefs("accessors")}listBuffers(){return this.listRefs("buffers")}}class YP{constructor(){this.m=new _L,this.T=new zD(this.m),this.v=zv.DEFAULT_INSTANCE}getRoot(){return this.T}getGraph(){return this.m}getLogger(){return this.v}setLogger(s){return this.v=s,this}clone(){return new YP().setLogger(this.v).merge(this)}merge(s){for(const rt of s.getRoot().listExtensionsUsed()){const nt=this.createExtension(rt.constructor);rt.isRequired()&&nt.setRequired(!0)}const o=new Set,a=new Map;o.add(s.T),a.set(s.T,this.T);for(const rt of s.m.listEdges())for(const nt of[rt.getParent(),rt.getChild()]){if(o.has(nt))continue;let ot;ot=nt.propertyType===ss.TEXTURE_INFO?nt:new nt.constructor(this.m),a.set(nt,ot),o.add(nt)}const _e=rt=>{const nt=a.get(rt);if(!nt)throw new Error("Could resolve property.");return nt};for(const rt of o){const nt=a.get(rt);if(!nt)throw new Error("Could resolve property.");nt.propertyType!==ss.TEXTURE_INFO&&nt.copy(rt,_e)}return this}async transform(...s){const o=s.map(a=>a.name);for(const a of s)await a(this,{stack:o});return this}createExtension(s){const o=s.EXTENSION_NAME;return this.getRoot().listExtensionsUsed().find(a=>a.extensionName===o)||new s(this)}createScene(s=""){return new UD(this.m,s)}createNode(s=""){return new NR(this.m,s)}createCamera(s=""){return new ix(this.m,s)}createSkin(s=""){return new $D(this.m,s)}createMesh(s=""){return new FD(this.m,s)}createPrimitive(){return new ox(this.m)}createPrimitiveTarget(s=""){return new RL(this.m,s)}createMaterial(s=""){return new sx(this.m,s)}createTexture(s=""){return new jD(this.m,s)}createAnimation(s=""){return new LD(this.m,s)}createAnimationChannel(s=""){return new WP(this.m,s)}createAnimationSampler(s=""){return new sS(this.m,s)}createAccessor(s="",o=null){return o||(o=this.getRoot().listBuffers()[0]),new Ss(this.m,s).setBuffer(o)}createBuffer(s=""){return new ND(this.m,s)}}class Tu{constructor(s){this.extensionName="",this.prereadTypes=[],this.prewriteTypes=[],this.readDependencies=[],this.writeDependencies=[],this.document=void 0,this.required=!1,this.properties=new Set,this.S=void 0,this.document=s,s.getRoot().g(this),this.S=a=>{const _e=a,rt=_e.target;rt instanceof Ku&&rt.extensionName===this.extensionName&&(_e.type==="node:create"&&this.M(rt),_e.type==="node:dispose"&&this.I(rt))};const o=s.getGraph();o.addEventListener("node:create",this.S),o.addEventListener("node:dispose",this.S)}dispose(){this.document.getRoot().p(this);const s=this.document.getGraph();s.removeEventListener("node:create",this.S),s.removeEventListener("node:dispose",this.S);for(const o of this.properties)o.dispose()}static register(){}isRequired(){return this.required}setRequired(s){return this.required=s,this}M(s){return this.properties.add(s),this}I(s){return this.properties.delete(s),this}install(s,o){return this}preread(s,o){return this}prewrite(s,o){return this}}Tu.EXTENSION_NAME=void 0;class IL{constructor(s){this.jsonDoc=void 0,this.buffers=[],this.bufferViews=[],this.bufferViewBuffers=[],this.accessors=[],this.textures=[],this.textureInfos=new Map,this.materials=[],this.meshes=[],this.cameras=[],this.nodes=[],this.skins=[],this.animations=[],this.scenes=[],this.jsonDoc=s}setTextureInfo(s,o){this.textureInfos.set(s,o),o.texCoord!==void 0&&s.setTexCoord(o.texCoord);const a=this.jsonDoc.json.textures[o.index];if(a.sampler===void 0)return;const _e=this.jsonDoc.json.samplers[a.sampler];_e.magFilter!==void 0&&s.setMagFilter(_e.magFilter),_e.minFilter!==void 0&&s.setMinFilter(_e.minFilter),_e.wrapS!==void 0&&s.setWrapS(_e.wrapS),_e.wrapT!==void 0&&s.setWrapT(_e.wrapT)}}const KP={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},VD={logger:zv.DEFAULT_INSTANCE,extensions:[],dependencies:{}};function FR(tt,s){const o=s.bufferViews[tt.bufferView],a=s.jsonDoc.json.bufferViews[tt.bufferView],_e=KP[tt.componentType],rt=Ss.getElementSize(tt.type),nt=_e.BYTES_PER_ELEMENT;if(a.byteStride!==void 0&&a.byteStride!==rt*nt)return function(ct,pt){const ht=pt.bufferViews[ct.bufferView],_t=pt.jsonDoc.json.bufferViews[ct.bufferView],Et=KP[ct.componentType],St=Ss.getElementSize(ct.type),Mt=Et.BYTES_PER_ELEMENT,It=ct.byteOffset||0,Nt=new Et(ct.count*St),Bt=new DataView(ht.buffer,ht.byteOffset,ht.byteLength),kt=_t.byteStride;for(let Pt=0;Pt<ct.count;Pt++)for(let qt=0;qt<St;qt++){const Kt=It+Pt*kt+qt*Mt;let nr;switch(ct.componentType){case Ss.ComponentType.FLOAT:nr=Bt.getFloat32(Kt,!0);break;case Ss.ComponentType.UNSIGNED_INT:nr=Bt.getUint32(Kt,!0);break;case Ss.ComponentType.UNSIGNED_SHORT:nr=Bt.getUint16(Kt,!0);break;case Ss.ComponentType.UNSIGNED_BYTE:nr=Bt.getUint8(Kt);break;case Ss.ComponentType.SHORT:nr=Bt.getInt16(Kt,!0);break;case Ss.ComponentType.BYTE:nr=Bt.getInt8(Kt);break;default:throw new Error(`Unexpected componentType "${ct.componentType}".`)}Nt[Pt*St+qt]=nr}return Nt}(tt,s);const ot=o.byteOffset+(tt.byteOffset||0);return new _e(o.buffer.slice(ot,ot+tt.count*rt*nt))}var dT;(function(tt){tt[tt.ARRAY_BUFFER=34962]="ARRAY_BUFFER",tt[tt.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER"})(dT||(dT={}));class E_{constructor(s,o,a){this.N=void 0,this.jsonDoc=void 0,this.options=void 0,this.accessorIndexMap=new Map,this.animationIndexMap=new Map,this.bufferIndexMap=new Map,this.cameraIndexMap=new Map,this.skinIndexMap=new Map,this.materialIndexMap=new Map,this.meshIndexMap=new Map,this.nodeIndexMap=new Map,this.imageIndexMap=new Map,this.textureDefIndexMap=new Map,this.textureInfoDefMap=new Map,this.samplerDefIndexMap=new Map,this.sceneIndexMap=new Map,this.imageBufferViews=[],this.otherBufferViews=new Map,this.otherBufferViewsIndexMap=new Map,this.extensionData={},this.bufferURIGenerator=void 0,this.imageURIGenerator=void 0,this.logger=void 0,this.O=new Map,this.accessorUsageGroupedByParent=new Set(["ARRAY_BUFFER"]),this.accessorParents=new Map,this.N=s,this.jsonDoc=o,this.options=a;const _e=s.getRoot(),rt=_e.listBuffers().length,nt=_e.listTextures().length;this.bufferURIGenerator=new GD(rt>1,a.basename),this.imageURIGenerator=new GD(nt>1,a.basename),this.logger=s.getLogger()}createTextureInfoDef(s,o){const a={magFilter:o.getMagFilter()||void 0,minFilter:o.getMinFilter()||void 0,wrapS:o.getWrapS(),wrapT:o.getWrapT()},_e=JSON.stringify(a);this.samplerDefIndexMap.has(_e)||(this.samplerDefIndexMap.set(_e,this.jsonDoc.json.samplers.length),this.jsonDoc.json.samplers.push(a));const rt={source:this.imageIndexMap.get(s),sampler:this.samplerDefIndexMap.get(_e)},nt=JSON.stringify(rt);this.textureDefIndexMap.has(nt)||(this.textureDefIndexMap.set(nt,this.jsonDoc.json.textures.length),this.jsonDoc.json.textures.push(rt));const ot={index:this.textureDefIndexMap.get(nt)};return o.getTexCoord()!==0&&(ot.texCoord=o.getTexCoord()),this.textureInfoDefMap.set(o,ot),ot}createPropertyDef(s){const o={};return s.getName()&&(o.name=s.getName()),Object.keys(s.getExtras()).length>0&&(o.extras=s.getExtras()),o}createAccessorDef(s){const o=this.createPropertyDef(s);return o.type=s.getType(),o.componentType=s.getComponentType(),o.count=s.getCount(),this.N.getGraph().listParentEdges(s).some(a=>a.getName()==="attributes"&&a.getAttributes().key==="POSITION"||a.getName()==="input")&&(o.max=s.getMax([]).map(Math.fround),o.min=s.getMin([]).map(Math.fround)),s.getNormalized()&&(o.normalized=s.getNormalized()),o}createImageData(s,o,a){if(this.options.format===x_.GLB)this.imageBufferViews.push(o),s.bufferView=this.jsonDoc.json.bufferViews.length,this.jsonDoc.json.bufferViews.push({buffer:0,byteOffset:-1,byteLength:o.byteLength});else{const _e=pA.mimeTypeToExtension(a.getMimeType());s.uri=this.imageURIGenerator.createURI(a,_e),this.jsonDoc.resources[s.uri]=o}}getAccessorUsage(s){const o=this.O.get(s);if(o)return o;for(const a of this.N.getGraph().listParentEdges(s)){const{usage:_e}=a.getAttributes();if(_e)return _e;a.getParent().propertyType!==ss.ROOT&&this.N.getLogger().warn(`Missing attribute ".usage" on edge, "${a.getName()}".`)}return E_.BufferViewUsage.OTHER}addAccessorToUsageGroup(s,o){const a=this.O.get(s);if(a&&a!==o)throw new Error(`Accessor with usage "${a}" cannot be reused as "${o}".`);return this.O.set(s,o),this}listAccessorUsageGroups(){const s={};for(const[o,a]of Array.from(this.O.entries()))s[a]=s[a]||[],s[a].push(o);return s}}E_.BufferViewTarget=dT,E_.BufferViewUsage=b0,E_.USAGE_TO_TARGET={[b0.ARRAY_BUFFER]:dT.ARRAY_BUFFER,[b0.ELEMENT_ARRAY_BUFFER]:dT.ELEMENT_ARRAY_BUFFER};class GD{constructor(s,o){this.multiple=void 0,this.basename=void 0,this.counter=1,this.multiple=s,this.basename=o}createURI(s,o){return s.getURI()?s.getURI():this.multiple?`${this.basename}_${this.counter++}.${o}`:`${this.basename}.${o}`}}const{BufferViewUsage:XP}=E_;var UR;(function(tt){tt[tt.JSON=1313821514]="JSON",tt[tt.BIN=5130562]="BIN"})(UR||(UR={}));class PL extends class{constructor(){this.v=zv.DEFAULT_INSTANCE,this.h=new Set,this.C={},this.F=PR.INTERLEAVED,this.lastReadBytes=0,this.lastWriteBytes=0}setLogger(s){return this.v=s,this}registerExtensions(s){for(const o of s)this.h.add(o),o.register();return this}registerDependencies(s){return Object.assign(this.C,s),this}setVertexLayout(s){return this.F=s,this}async read(s){return await this.readJSON(await this.readAsJSON(s))}async readAsJSON(s){return s.match(/^data:application\/octet-stream;/)||this.detectFormat(s)===x_.GLB?this.U(s):this.P(s)}async readJSON(s){return s=this.j(s),this.L(s),(class{static read(o,a=VD){const _e=pv({},VD,a),{json:rt}=o,nt=new YP;this.validate(o,_e);const ot=new IL(o),ct=rt.asset,pt=nt.getRoot().getAsset();ct.copyright&&(pt.copyright=ct.copyright),ct.extras&&(pt.extras=ct.extras),rt.extras!==void 0&&nt.getRoot().setExtras(pv({},rt.extras));const ht=rt.extensionsUsed||[],_t=rt.extensionsRequired||[];for(const kt of _e.extensions)if(ht.includes(kt.EXTENSION_NAME)){const Pt=nt.createExtension(kt).setRequired(_t.includes(kt.EXTENSION_NAME));for(const qt of Pt.readDependencies)Pt.install(qt,_e.dependencies[qt])}const Et=rt.buffers||[];nt.getRoot().listExtensionsUsed().filter(kt=>kt.prereadTypes.includes(ss.BUFFER)).forEach(kt=>kt.preread(ot,ss.BUFFER)),ot.buffers=Et.map(kt=>{const Pt=nt.createBuffer(kt.name);return kt.extras&&Pt.setExtras(kt.extras),kt.uri&&kt.uri.indexOf("__")!==0&&Pt.setURI(kt.uri),Pt}),ot.bufferViewBuffers=(rt.bufferViews||[]).map((kt,Pt)=>{if(!ot.bufferViews[Pt]){const qt=o.json.buffers[kt.buffer];ot.bufferViews[Pt]=Yo.toView(qt.uri?o.resources[qt.uri]:o.resources["@glb.bin"],kt.byteOffset||0,kt.byteLength)}return ot.buffers[kt.buffer]}),ot.accessors=(rt.accessors||[]).map(kt=>{const Pt=nt.createAccessor(kt.name,ot.bufferViewBuffers[kt.bufferView]).setType(kt.type);if(kt.extras&&Pt.setExtras(kt.extras),kt.normalized!==void 0&&Pt.setNormalized(kt.normalized),kt.bufferView===void 0&&!kt.sparse)return Pt;let qt;return qt=kt.sparse!==void 0?function(Kt,nr){const ir=KP[Kt.componentType],fr=Ss.getElementSize(Kt.type);let br;br=Kt.bufferView!==void 0?FR(Kt,nr):new ir(Kt.count*fr);const Tr=Kt.sparse,Dr=Tr.count,Rr=pv({},Kt,Tr.indices,{count:Dr,type:"SCALAR"}),Nr=pv({},Kt,Tr.values,{count:Dr}),Ir=FR(Rr,nr),kr=FR(Nr,nr);for(let Hr=0;Hr<Rr.count;Hr++)for(let Lr=0;Lr<fr;Lr++)br[Ir[Hr]*fr+Lr]=kr[Hr*fr+Lr];return br}(kt,ot):FR(kt,ot),Pt.setArray(qt),Pt});const St=rt.images||[],Mt=rt.textures||[];nt.getRoot().listExtensionsUsed().filter(kt=>kt.prereadTypes.includes(ss.TEXTURE)).forEach(kt=>kt.preread(ot,ss.TEXTURE)),ot.textures=St.map(kt=>{const Pt=nt.createTexture(kt.name);if(kt.extras&&Pt.setExtras(kt.extras),kt.bufferView!==void 0){const qt=rt.bufferViews[kt.bufferView],Kt=o.json.buffers[qt.buffer],nr=qt.byteOffset||0,ir=(Kt.uri?o.resources[Kt.uri]:o.resources["@glb.bin"]).slice(nr,nr+qt.byteLength);Pt.setImage(ir)}else kt.uri!==void 0&&(Pt.setImage(o.resources[kt.uri]),kt.uri.indexOf("__")!==0&&Pt.setURI(kt.uri));if(kt.mimeType!==void 0)Pt.setMimeType(kt.mimeType);else if(kt.uri){const qt=nx.extension(kt.uri);Pt.setMimeType(pA.extensionToMimeType(qt))}return Pt}),ot.materials=(rt.materials||[]).map(kt=>{const Pt=nt.createMaterial(kt.name);kt.extras&&Pt.setExtras(kt.extras),kt.alphaMode!==void 0&&Pt.setAlphaMode(kt.alphaMode),kt.alphaCutoff!==void 0&&Pt.setAlphaCutoff(kt.alphaCutoff),kt.doubleSided!==void 0&&Pt.setDoubleSided(kt.doubleSided);const qt=kt.pbrMetallicRoughness||{};if(qt.baseColorFactor!==void 0&&Pt.setBaseColorFactor(qt.baseColorFactor),kt.emissiveFactor!==void 0&&Pt.setEmissiveFactor(kt.emissiveFactor),qt.metallicFactor!==void 0&&Pt.setMetallicFactor(qt.metallicFactor),qt.roughnessFactor!==void 0&&Pt.setRoughnessFactor(qt.roughnessFactor),qt.baseColorTexture!==void 0){const Kt=qt.baseColorTexture;Pt.setBaseColorTexture(ot.textures[Mt[Kt.index].source]),ot.setTextureInfo(Pt.getBaseColorTextureInfo(),Kt)}if(kt.emissiveTexture!==void 0){const Kt=kt.emissiveTexture;Pt.setEmissiveTexture(ot.textures[Mt[Kt.index].source]),ot.setTextureInfo(Pt.getEmissiveTextureInfo(),Kt)}if(kt.normalTexture!==void 0){const Kt=kt.normalTexture;Pt.setNormalTexture(ot.textures[Mt[Kt.index].source]),ot.setTextureInfo(Pt.getNormalTextureInfo(),Kt),kt.normalTexture.scale!==void 0&&Pt.setNormalScale(kt.normalTexture.scale)}if(kt.occlusionTexture!==void 0){const Kt=kt.occlusionTexture;Pt.setOcclusionTexture(ot.textures[Mt[Kt.index].source]),ot.setTextureInfo(Pt.getOcclusionTextureInfo(),Kt),kt.occlusionTexture.strength!==void 0&&Pt.setOcclusionStrength(kt.occlusionTexture.strength)}if(qt.metallicRoughnessTexture!==void 0){const Kt=qt.metallicRoughnessTexture;Pt.setMetallicRoughnessTexture(ot.textures[Mt[Kt.index].source]),ot.setTextureInfo(Pt.getMetallicRoughnessTextureInfo(),Kt)}return Pt});const It=rt.meshes||[];nt.getRoot().listExtensionsUsed().filter(kt=>kt.prereadTypes.includes(ss.PRIMITIVE)).forEach(kt=>kt.preread(ot,ss.PRIMITIVE)),ot.meshes=It.map(kt=>{const Pt=nt.createMesh(kt.name);return kt.extras&&Pt.setExtras(kt.extras),kt.weights!==void 0&&Pt.setWeights(kt.weights),(kt.primitives||[]).forEach(qt=>{const Kt=nt.createPrimitive();qt.extras&&Kt.setExtras(qt.extras),qt.material!==void 0&&Kt.setMaterial(ot.materials[qt.material]),qt.mode!==void 0&&Kt.setMode(qt.mode);for(const[ir,fr]of Object.entries(qt.attributes||{}))Kt.setAttribute(ir,ot.accessors[fr]);qt.indices!==void 0&&Kt.setIndices(ot.accessors[qt.indices]);const nr=kt.extras&&kt.extras.targetNames||[];(qt.targets||[]).forEach((ir,fr)=>{const br=nr[fr]||fr.toString(),Tr=nt.createPrimitiveTarget(br);for(const[Dr,Rr]of Object.entries(ir))Tr.setAttribute(Dr,ot.accessors[Rr]);Kt.addTarget(Tr)}),Pt.addPrimitive(Kt)}),Pt}),ot.cameras=(rt.cameras||[]).map(kt=>{const Pt=nt.createCamera(kt.name).setType(kt.type);if(kt.extras&&Pt.setExtras(kt.extras),kt.type===ix.Type.PERSPECTIVE){const qt=kt.perspective;Pt.setYFov(qt.yfov),Pt.setZNear(qt.znear),qt.zfar!==void 0&&Pt.setZFar(qt.zfar),qt.aspectRatio!==void 0&&Pt.setAspectRatio(qt.aspectRatio)}else{const qt=kt.orthographic;Pt.setZNear(qt.znear).setZFar(qt.zfar).setXMag(qt.xmag).setYMag(qt.ymag)}return Pt});const Nt=rt.nodes||[];nt.getRoot().listExtensionsUsed().filter(kt=>kt.prereadTypes.includes(ss.NODE)).forEach(kt=>kt.preread(ot,ss.NODE)),ot.nodes=Nt.map(kt=>{const Pt=nt.createNode(kt.name);if(kt.extras&&Pt.setExtras(kt.extras),kt.translation!==void 0&&Pt.setTranslation(kt.translation),kt.rotation!==void 0&&Pt.setRotation(kt.rotation),kt.scale!==void 0&&Pt.setScale(kt.scale),kt.matrix!==void 0){const qt=[0,0,0],Kt=[0,0,0,1],nr=[1,1,1];ku.decompose(kt.matrix,qt,Kt,nr),Pt.setTranslation(qt),Pt.setRotation(Kt),Pt.setScale(nr)}return kt.weights!==void 0&&Pt.setWeights(kt.weights),Pt}),ot.skins=(rt.skins||[]).map(kt=>{const Pt=nt.createSkin(kt.name);kt.extras&&Pt.setExtras(kt.extras),kt.inverseBindMatrices!==void 0&&Pt.setInverseBindMatrices(ot.accessors[kt.inverseBindMatrices]),kt.skeleton!==void 0&&Pt.setSkeleton(ot.nodes[kt.skeleton]);for(const qt of kt.joints)Pt.addJoint(ot.nodes[qt]);return Pt}),Nt.map((kt,Pt)=>{const qt=ot.nodes[Pt];(kt.children||[]).forEach(Kt=>qt.addChild(ot.nodes[Kt])),kt.mesh!==void 0&&qt.setMesh(ot.meshes[kt.mesh]),kt.camera!==void 0&&qt.setCamera(ot.cameras[kt.camera]),kt.skin!==void 0&&qt.setSkin(ot.skins[kt.skin])}),ot.animations=(rt.animations||[]).map(kt=>{const Pt=nt.createAnimation(kt.name);kt.extras&&Pt.setExtras(kt.extras);const qt=(kt.samplers||[]).map(Kt=>{const nr=nt.createAnimationSampler().setInput(ot.accessors[Kt.input]).setOutput(ot.accessors[Kt.output]).setInterpolation(Kt.interpolation||sS.Interpolation.LINEAR);return Kt.extras&&nr.setExtras(Kt.extras),Pt.addSampler(nr),nr});return(kt.channels||[]).forEach(Kt=>{const nr=nt.createAnimationChannel().setSampler(qt[Kt.sampler]).setTargetPath(Kt.target.path);Kt.target.node!==void 0&&nr.setTargetNode(ot.nodes[Kt.target.node]),Kt.extras&&nr.setExtras(Kt.extras),Pt.addChannel(nr)}),Pt});const Bt=rt.scenes||[];return nt.getRoot().listExtensionsUsed().filter(kt=>kt.prereadTypes.includes(ss.SCENE)).forEach(kt=>kt.preread(ot,ss.SCENE)),ot.scenes=Bt.map(kt=>{const Pt=nt.createScene(kt.name);return kt.extras&&Pt.setExtras(kt.extras),(kt.nodes||[]).map(qt=>ot.nodes[qt]).forEach(qt=>Pt.addChild(qt)),Pt}),rt.scene!==void 0&&nt.getRoot().setDefaultScene(ot.scenes[rt.scene]),nt.getRoot().listExtensionsUsed().forEach(kt=>kt.read(ot)),nt}static validate(o,a){const _e=o.json;if(_e.asset.version!=="2.0")throw new Error(`Unsupported glTF version, "${_e.asset.version}".`);if(_e.extensionsRequired){for(const rt of _e.extensionsRequired)if(!a.extensions.find(nt=>nt.EXTENSION_NAME===rt))throw new Error(`Missing required extension, "${rt}".`)}if(_e.extensionsUsed)for(const rt of _e.extensionsUsed)a.extensions.find(nt=>nt.EXTENSION_NAME===rt)||a.logger.warn(`Missing optional extension, "${rt}".`)}}).read(s,{extensions:Array.from(this.h),dependencies:this.C,logger:this.v})}async binaryToJSON(s){const o=this._(Yo.assertView(s));this.L(o);const a=o.json;if(a.buffers&&a.buffers.some(_e=>function(rt,nt){return nt.uri!==void 0&&!(nt.uri in rt.resources)}(o,_e)))throw new Error("Cannot resolve external buffers with binaryToJSON().");if(a.images&&a.images.some(_e=>function(rt,nt){return nt.uri!==void 0&&!(nt.uri in rt.resources)&&nt.bufferView===void 0}(o,_e)))throw new Error("Cannot resolve external images with binaryToJSON().");return o}async readBinary(s){return this.readJSON(await this.binaryToJSON(Yo.assertView(s)))}async writeJSON(s,o={}){if(o.format===x_.GLB&&s.getRoot().listBuffers().length>1)throw new Error("GLB must have 0–1 buffers.");return(class{static write(a,_e){const rt=a.getRoot(),nt={asset:pv({generator:"glTF-Transform v2.2.3"},rt.getAsset()),extras:pv({},rt.getExtras())},ot={json:nt,resources:{}},ct=new E_(a,ot,_e),pt=_e.logger||zv.DEFAULT_INSTANCE,ht=new Set(_e.extensions.map(Bt=>Bt.EXTENSION_NAME)),_t=a.getRoot().listExtensionsUsed().filter(Bt=>ht.has(Bt.extensionName)),Et=a.getRoot().listExtensionsRequired().filter(Bt=>ht.has(Bt.extensionName));_t.length<a.getRoot().listExtensionsUsed().length&&pt.debug("Some extensions were not registered for I/O, and will not be written.");for(const Bt of _t)for(const kt of Bt.writeDependencies)Bt.install(kt,_e.dependencies[kt]);function St(Bt,kt,Pt,qt){const Kt=[];let nr=0;for(const fr of Bt){const br=ct.createAccessorDef(fr);br.bufferView=nt.bufferViews.length;const Tr=fr.getArray(),Dr=Yo.pad(Yo.toView(Tr));br.byteOffset=nr,nr+=Dr.byteLength,Kt.push(Dr),ct.accessorIndexMap.set(fr,nt.accessors.length),nt.accessors.push(br)}const ir={buffer:kt,byteOffset:Pt,byteLength:Yo.concat(Kt).byteLength};return qt&&(ir.target=qt),nt.bufferViews.push(ir),{buffers:Kt,byteLength:nr}}function Mt(Bt,kt,Pt){const qt=Bt[0].getCount();let Kt=0;for(const br of Bt){const Tr=ct.createAccessorDef(br);Tr.bufferView=nt.bufferViews.length,Tr.byteOffset=Kt;const Dr=br.getElementSize(),Rr=br.getComponentSize();Kt+=Yo.padNumber(Dr*Rr),ct.accessorIndexMap.set(br,nt.accessors.length),nt.accessors.push(Tr)}const nr=qt*Kt,ir=new ArrayBuffer(nr),fr=new DataView(ir);for(let br=0;br<qt;br++){let Tr=0;for(const Dr of Bt){const Rr=Dr.getElementSize(),Nr=Dr.getComponentSize(),Ir=Dr.getComponentType(),kr=Dr.getArray();for(let Hr=0;Hr<Rr;Hr++){const Lr=br*Kt+Tr+Hr*Nr,en=kr[br*Rr+Hr];switch(Ir){case Ss.ComponentType.FLOAT:fr.setFloat32(Lr,en,!0);break;case Ss.ComponentType.BYTE:fr.setInt8(Lr,en);break;case Ss.ComponentType.SHORT:fr.setInt16(Lr,en,!0);break;case Ss.ComponentType.UNSIGNED_BYTE:fr.setUint8(Lr,en);break;case Ss.ComponentType.UNSIGNED_SHORT:fr.setUint16(Lr,en,!0);break;case Ss.ComponentType.UNSIGNED_INT:fr.setUint32(Lr,en,!0);break;default:throw new Error("Unexpected component type: "+Ir)}}Tr+=Yo.padNumber(Rr*Nr)}}return nt.bufferViews.push({buffer:kt,byteOffset:Pt,byteLength:nr,byteStride:Kt,target:E_.BufferViewTarget.ARRAY_BUFFER}),{byteLength:nr,buffers:[new Uint8Array(ir)]}}const It=new Map;for(const Bt of a.getGraph().listEdges()){if(Bt.getParent()===rt)continue;const kt=Bt.getChild();if(kt instanceof Ss){const Pt=It.get(kt)||[];Pt.push(Bt),It.set(kt,Pt)}}if(nt.accessors=[],nt.bufferViews=[],nt.samplers=[],nt.textures=[],nt.images=rt.listTextures().map((Bt,kt)=>{const Pt=ct.createPropertyDef(Bt);Bt.getMimeType()&&(Pt.mimeType=Bt.getMimeType());const qt=Bt.getImage();return qt&&ct.createImageData(Pt,qt,Bt),ct.imageIndexMap.set(Bt,kt),Pt}),_t.filter(Bt=>Bt.prewriteTypes.includes(ss.ACCESSOR)).forEach(Bt=>Bt.prewrite(ct,ss.ACCESSOR)),rt.listAccessors().forEach(Bt=>{const kt=ct.accessorUsageGroupedByParent,Pt=ct.accessorParents;if(ct.accessorIndexMap.has(Bt))return;const qt=It.get(Bt)||[],Kt=ct.getAccessorUsage(Bt);if(ct.addAccessorToUsageGroup(Bt,Kt),kt.has(Kt)){const nr=qt[0].getParent(),ir=Pt.get(nr)||new Set;ir.add(Bt),Pt.set(nr,ir)}}),_t.filter(Bt=>Bt.prewriteTypes.includes(ss.BUFFER)).forEach(Bt=>Bt.prewrite(ct,ss.BUFFER)),(rt.listAccessors().length>0||rt.listTextures().length>0||ct.otherBufferViews.size>0)&&rt.listBuffers().length===0)throw new Error("Buffer required for Document resources, but none was found.");nt.buffers=[],rt.listBuffers().forEach((Bt,kt)=>{const Pt=ct.createPropertyDef(Bt),qt=ct.accessorUsageGroupedByParent,Kt=ct.accessorParents,nr=Bt.listParents().filter(Rr=>Rr instanceof Ss),ir=new Set(nr),fr=[],br=nt.buffers.length;let Tr=0;const Dr=ct.listAccessorUsageGroups();for(const Rr in Dr)if(qt.has(Rr))for(const Nr of Array.from(Kt.values())){const Ir=Array.from(Nr).filter(kr=>ir.has(kr)).filter(kr=>ct.getAccessorUsage(kr)===Rr);if(Ir.length)if(Rr!==XP.ARRAY_BUFFER||_e.vertexLayout===PR.INTERLEAVED){const kr=Rr===XP.ARRAY_BUFFER?Mt(Ir,br,Tr):St(Ir,br,Tr);Tr+=kr.byteLength,fr.push(...kr.buffers)}else for(const kr of Ir){const Hr=Mt([kr],br,Tr);Tr+=Hr.byteLength,fr.push(...Hr.buffers)}}else{const Nr=Dr[Rr].filter(kr=>ir.has(kr));if(!Nr.length)continue;const Ir=St(Nr,br,Tr,Rr===XP.ELEMENT_ARRAY_BUFFER?E_.BufferViewTarget.ELEMENT_ARRAY_BUFFER:void 0);Tr+=Ir.byteLength,fr.push(...Ir.buffers)}if(ct.imageBufferViews.length&&kt===0){for(let Rr=0;Rr<ct.imageBufferViews.length;Rr++)if(nt.bufferViews[nt.images[Rr].bufferView].byteOffset=Tr,Tr+=ct.imageBufferViews[Rr].byteLength,fr.push(ct.imageBufferViews[Rr]),Tr%8){const Nr=8-Tr%8;Tr+=Nr,fr.push(new Uint8Array(Nr))}}if(ct.otherBufferViews.has(Bt))for(const Rr of ct.otherBufferViews.get(Bt))nt.bufferViews.push({buffer:br,byteOffset:Tr,byteLength:Rr.byteLength}),ct.otherBufferViewsIndexMap.set(Rr,nt.bufferViews.length-1),Tr+=Rr.byteLength,fr.push(Rr);if(Tr){let Rr;_e.format===x_.GLB?Rr="@glb.bin":(Rr=ct.bufferURIGenerator.createURI(Bt,"bin"),Pt.uri=Rr),Pt.byteLength=Tr,ot.resources[Rr]=Yo.concat(fr)}nt.buffers.push(Pt),ct.bufferIndexMap.set(Bt,kt)}),rt.listAccessors().find(Bt=>!Bt.getBuffer())&&pt.warn("Skipped writing one or more Accessors: no Buffer assigned."),nt.materials=rt.listMaterials().map((Bt,kt)=>{const Pt=ct.createPropertyDef(Bt);if(Bt.getAlphaMode()!==sx.AlphaMode.OPAQUE&&(Pt.alphaMode=Bt.getAlphaMode()),Bt.getAlphaMode()===sx.AlphaMode.MASK&&(Pt.alphaCutoff=Bt.getAlphaCutoff()),Bt.getDoubleSided()&&(Pt.doubleSided=!0),Pt.pbrMetallicRoughness={},ku.eq(Bt.getBaseColorFactor(),[1,1,1,1])||(Pt.pbrMetallicRoughness.baseColorFactor=Bt.getBaseColorFactor()),ku.eq(Bt.getEmissiveFactor(),[0,0,0])||(Pt.emissiveFactor=Bt.getEmissiveFactor()),Bt.getRoughnessFactor()!==1&&(Pt.pbrMetallicRoughness.roughnessFactor=Bt.getRoughnessFactor()),Bt.getMetallicFactor()!==1&&(Pt.pbrMetallicRoughness.metallicFactor=Bt.getMetallicFactor()),Bt.getBaseColorTexture()){const qt=Bt.getBaseColorTexture(),Kt=Bt.getBaseColorTextureInfo();Pt.pbrMetallicRoughness.baseColorTexture=ct.createTextureInfoDef(qt,Kt)}if(Bt.getEmissiveTexture()){const qt=Bt.getEmissiveTexture(),Kt=Bt.getEmissiveTextureInfo();Pt.emissiveTexture=ct.createTextureInfoDef(qt,Kt)}if(Bt.getNormalTexture()){const qt=Bt.getNormalTexture(),Kt=Bt.getNormalTextureInfo(),nr=ct.createTextureInfoDef(qt,Kt);Bt.getNormalScale()!==1&&(nr.scale=Bt.getNormalScale()),Pt.normalTexture=nr}if(Bt.getOcclusionTexture()){const qt=Bt.getOcclusionTexture(),Kt=Bt.getOcclusionTextureInfo(),nr=ct.createTextureInfoDef(qt,Kt);Bt.getOcclusionStrength()!==1&&(nr.strength=Bt.getOcclusionStrength()),Pt.occlusionTexture=nr}if(Bt.getMetallicRoughnessTexture()){const qt=Bt.getMetallicRoughnessTexture(),Kt=Bt.getMetallicRoughnessTextureInfo();Pt.pbrMetallicRoughness.metallicRoughnessTexture=ct.createTextureInfoDef(qt,Kt)}return ct.materialIndexMap.set(Bt,kt),Pt}),nt.meshes=rt.listMeshes().map((Bt,kt)=>{const Pt=ct.createPropertyDef(Bt);let qt=null;return Pt.primitives=Bt.listPrimitives().map(Kt=>{const nr={attributes:{}};nr.mode=Kt.getMode();const ir=Kt.getMaterial();ir&&(nr.material=ct.materialIndexMap.get(ir)),Object.keys(Kt.getExtras()).length&&(nr.extras=Kt.getExtras());const fr=Kt.getIndices();fr&&(nr.indices=ct.accessorIndexMap.get(fr));for(const br of Kt.listSemantics())nr.attributes[br]=ct.accessorIndexMap.get(Kt.getAttribute(br));for(const br of Kt.listTargets()){const Tr={};for(const Dr of br.listSemantics())Tr[Dr]=ct.accessorIndexMap.get(br.getAttribute(Dr));nr.targets=nr.targets||[],nr.targets.push(Tr)}return Kt.listTargets().length&&!qt&&(qt=Kt.listTargets().map(br=>br.getName())),nr}),Bt.getWeights().length&&(Pt.weights=Bt.getWeights()),qt&&(Pt.extras=Pt.extras||{},Pt.extras.targetNames=qt),ct.meshIndexMap.set(Bt,kt),Pt}),nt.cameras=rt.listCameras().map((Bt,kt)=>{const Pt=ct.createPropertyDef(Bt);if(Pt.type=Bt.getType(),Pt.type===ix.Type.PERSPECTIVE){Pt.perspective={znear:Bt.getZNear(),zfar:Bt.getZFar(),yfov:Bt.getYFov()};const qt=Bt.getAspectRatio();qt!==null&&(Pt.perspective.aspectRatio=qt)}else Pt.orthographic={znear:Bt.getZNear(),zfar:Bt.getZFar(),xmag:Bt.getXMag(),ymag:Bt.getYMag()};return ct.cameraIndexMap.set(Bt,kt),Pt}),nt.nodes=rt.listNodes().map((Bt,kt)=>{const Pt=ct.createPropertyDef(Bt);return ku.eq(Bt.getTranslation(),[0,0,0])||(Pt.translation=Bt.getTranslation()),ku.eq(Bt.getRotation(),[0,0,0,1])||(Pt.rotation=Bt.getRotation()),ku.eq(Bt.getScale(),[1,1,1])||(Pt.scale=Bt.getScale()),Bt.getWeights().length&&(Pt.weights=Bt.getWeights()),ct.nodeIndexMap.set(Bt,kt),Pt}),nt.skins=rt.listSkins().map((Bt,kt)=>{const Pt=ct.createPropertyDef(Bt),qt=Bt.getInverseBindMatrices();qt&&(Pt.inverseBindMatrices=ct.accessorIndexMap.get(qt));const Kt=Bt.getSkeleton();return Kt&&(Pt.skeleton=ct.nodeIndexMap.get(Kt)),Pt.joints=Bt.listJoints().map(nr=>ct.nodeIndexMap.get(nr)),ct.skinIndexMap.set(Bt,kt),Pt}),rt.listNodes().forEach((Bt,kt)=>{const Pt=nt.nodes[kt],qt=Bt.getMesh();qt&&(Pt.mesh=ct.meshIndexMap.get(qt));const Kt=Bt.getCamera();Kt&&(Pt.camera=ct.cameraIndexMap.get(Kt));const nr=Bt.getSkin();nr&&(Pt.skin=ct.skinIndexMap.get(nr)),Bt.listChildren().length>0&&(Pt.children=Bt.listChildren().map(ir=>ct.nodeIndexMap.get(ir)))}),nt.animations=rt.listAnimations().map((Bt,kt)=>{const Pt=ct.createPropertyDef(Bt),qt=new Map;return Pt.samplers=Bt.listSamplers().map((Kt,nr)=>{const ir=ct.createPropertyDef(Kt);return ir.input=ct.accessorIndexMap.get(Kt.getInput()),ir.output=ct.accessorIndexMap.get(Kt.getOutput()),ir.interpolation=Kt.getInterpolation(),qt.set(Kt,nr),ir}),Pt.channels=Bt.listChannels().map(Kt=>{const nr=ct.createPropertyDef(Kt);return nr.sampler=qt.get(Kt.getSampler()),nr.target={node:ct.nodeIndexMap.get(Kt.getTargetNode()),path:Kt.getTargetPath()},nr}),ct.animationIndexMap.set(Bt,kt),Pt}),nt.scenes=rt.listScenes().map((Bt,kt)=>{const Pt=ct.createPropertyDef(Bt);return Pt.nodes=Bt.listChildren().map(qt=>ct.nodeIndexMap.get(qt)),ct.sceneIndexMap.set(Bt,kt),Pt});const Nt=rt.getDefaultScene();return Nt&&(nt.scene=rt.listScenes().indexOf(Nt)),nt.extensionsUsed=_t.map(Bt=>Bt.extensionName),nt.extensionsRequired=Et.map(Bt=>Bt.extensionName),_t.forEach(Bt=>Bt.write(ct)),function(Bt){const kt=[];for(const Pt in Bt){const qt=Bt[Pt];(Array.isArray(qt)&&qt.length===0||qt===null||qt===""||qt&&typeof qt=="object"&&Object.keys(qt).length===0)&&kt.push(Pt)}for(const Pt of kt)delete Bt[Pt]}(nt),ot}}).write(s,{format:o.format||x_.GLTF,basename:o.basename||"",logger:this.v,vertexLayout:this.F,dependencies:pv({},this.C),extensions:Array.from(this.h)})}async writeBinary(s){const{json:o,resources:a}=await this.writeJSON(s,{format:x_.GLB}),_e=new Uint32Array([1179937895,2,12]),rt=JSON.stringify(o),nt=Yo.pad(Yo.encodeText(rt),32),ot=Yo.toView(new Uint32Array([nt.byteLength,1313821514])),ct=Yo.concat([ot,nt]);_e[_e.length-1]+=ct.byteLength;const pt=Object.values(a)[0];if(!pt||!pt.byteLength)return Yo.concat([Yo.toView(_e),ct]);const ht=Yo.pad(pt,0),_t=Yo.toView(new Uint32Array([ht.byteLength,5130562])),Et=Yo.concat([_t,ht]);return _e[_e.length-1]+=Et.byteLength,Yo.concat([Yo.toView(_e),ct,Et])}detectFormat(s){return(Ew.isAbsoluteURL(s)?Ew.extension(s):nx.extension(s))==="glb"?x_.GLB:x_.GLTF}async P(s){this.lastReadBytes=0;const o=await this.readURI(s,"text");this.lastReadBytes+=o.length;const a={json:JSON.parse(o),resources:{}};return await this.D(a,this.dirname(s)),this.L(a),a}async U(s){const o=await this.readURI(s,"view");this.lastReadBytes=o.byteLength;const a=this._(o);return await this.D(a,this.dirname(s)),this.L(a),a}async D(s,o){var a=this;const _e=[...s.json.images||[],...s.json.buffers||[]].map(async function(rt){const nt=rt.uri;if(!nt||nt.match(/data:/))return Promise.resolve();s.resources[nt]=await a.readURI(a.resolve(o,nt),"view"),a.lastReadBytes+=s.resources[nt].byteLength});await Promise.all(_e)}L(s){function o(a){if(a.uri){if(a.uri in s.resources)Yo.assertView(s.resources[a.uri]);else if(a.uri.match(/data:/)){const _e=`__${function(){for(let rt=0;rt<999;rt++){const nt=CL();if(!OD.has(nt))return OD.add(nt),nt}return""}()}.${nx.extension(a.uri)}`;s.resources[_e]=Yo.createBufferFromDataURI(a.uri),a.uri=_e}}}(s.json.images||[]).forEach(a=>{if(a.bufferView===void 0&&a.uri===void 0)throw new Error("Missing resource URI or buffer view.");o(a)}),(s.json.buffers||[]).forEach(o)}j(s){const{images:o,buffers:a}=s.json;return s={json:pv({},s.json),resources:pv({},s.resources)},o&&(s.json.images=o.map(_e=>pv({},_e))),a&&(s.json.buffers=a.map(_e=>pv({},_e))),s}_(s){const o=new Uint32Array(s.buffer,s.byteOffset,3);if(o[0]!==1179937895)throw new Error("Invalid glTF asset.");if(o[1]!==2)throw new Error(`Unsupported glTF binary version, "${o[1]}".`);const a=new Uint32Array(s.buffer,s.byteOffset+12,2);if(a[1]!==UR.JSON)throw new Error("Missing required GLB JSON chunk.");const _e=a[0],rt=Yo.decodeText(Yo.toView(s,20,_e)),nt=JSON.parse(rt),ot=20+_e;if(s.byteLength<=ot)return{json:nt,resources:{}};const ct=new Uint32Array(s.buffer,s.byteOffset+ot,2);if(ct[1]!==UR.BIN)throw new Error("Expected GLB BIN in second chunk.");return{json:nt,resources:{"@glb.bin":Yo.toView(s,ot+8,ct[0])}}}}{constructor(s=Ew.DEFAULT_INIT){super(),this.V=void 0,this.V=s}async readURI(s,o){const a=await fetch(s,this.V);switch(o){case"view":return new Uint8Array(await a.arrayBuffer());case"text":return a.text()}}resolve(s,o){return Ew.resolve(s,o)}dirname(s){return Ew.dirname(s)}detectFormat(s){return Ew.extension(s)==="glb"?x_.GLB:x_.GLTF}}class DL{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class pT{constructor(s,o,a,_e){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(s.buffer,s.byteOffset+o,a),this._littleEndian=_e,this._offset=0}_nextUint8(){const s=this._dataView.getUint8(this._offset);return this._offset+=1,s}_nextUint16(){const s=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,s}_nextUint32(){const s=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,s}_nextUint64(){const s=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,s}_nextInt32(){const s=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,s}_skip(s){return this._offset+=s,this}_scan(s,o=0){const a=this._offset;let _e=0;for(;this._dataView.getUint8(this._offset)!==o&&_e<s;)_e++,this._offset++;return _e<s&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+a,_e)}}const Um=[171,75,84,88,32,50,48,187,13,10,26,10];function QD(tt){return typeof TextDecoder<"u"?new TextDecoder().decode(tt):Buffer.from(tt).toString("utf8")}function JP(tt){const s=new Uint8Array(tt.buffer,tt.byteOffset,Um.length);if(s[0]!==Um[0]||s[1]!==Um[1]||s[2]!==Um[2]||s[3]!==Um[3]||s[4]!==Um[4]||s[5]!==Um[5]||s[6]!==Um[6]||s[7]!==Um[7]||s[8]!==Um[8]||s[9]!==Um[9]||s[10]!==Um[10]||s[11]!==Um[11])throw new Error("Missing KTX 2.0 identifier.");const o=new DL,a=17*Uint32Array.BYTES_PER_ELEMENT,_e=new pT(tt,Um.length,a,!0);o.vkFormat=_e._nextUint32(),o.typeSize=_e._nextUint32(),o.pixelWidth=_e._nextUint32(),o.pixelHeight=_e._nextUint32(),o.pixelDepth=_e._nextUint32(),o.layerCount=_e._nextUint32(),o.faceCount=_e._nextUint32();const rt=_e._nextUint32();o.supercompressionScheme=_e._nextUint32();const nt=_e._nextUint32(),ot=_e._nextUint32(),ct=_e._nextUint32(),pt=_e._nextUint32(),ht=_e._nextUint64(),_t=_e._nextUint64(),Et=new pT(tt,Um.length+a,3*rt*8,!0);for(let Lr=0;Lr<rt;Lr++)o.levels.push({levelData:new Uint8Array(tt.buffer,tt.byteOffset+Et._nextUint64(),Et._nextUint64()),uncompressedByteLength:Et._nextUint64()});const St=new pT(tt,nt,ot,!0),Mt={vendorId:St._skip(4)._nextUint16(),descriptorType:St._nextUint16(),versionNumber:St._nextUint16(),descriptorBlockSize:St._nextUint16(),colorModel:St._nextUint8(),colorPrimaries:St._nextUint8(),transferFunction:St._nextUint8(),flags:St._nextUint8(),texelBlockDimension:[St._nextUint8(),St._nextUint8(),St._nextUint8(),St._nextUint8()],bytesPlane:[St._nextUint8(),St._nextUint8(),St._nextUint8(),St._nextUint8(),St._nextUint8(),St._nextUint8(),St._nextUint8(),St._nextUint8()],samples:[]},It=(Mt.descriptorBlockSize/4-6)/4;for(let Lr=0;Lr<It;Lr++){const en={bitOffset:St._nextUint16(),bitLength:St._nextUint8(),channelType:St._nextUint8(),samplePosition:[St._nextUint8(),St._nextUint8(),St._nextUint8(),St._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&en.channelType?(en.sampleLower=St._nextInt32(),en.sampleUpper=St._nextInt32()):(en.sampleLower=St._nextUint32(),en.sampleUpper=St._nextUint32()),Mt.samples[Lr]=en}o.dataFormatDescriptor.length=0,o.dataFormatDescriptor.push(Mt);const Nt=new pT(tt,ct,pt,!0);for(;Nt._offset<pt;){const Lr=Nt._nextUint32(),en=Nt._scan(Lr),vn=QD(en),wn=Nt._scan(Lr-en.byteLength);o.keyValue[vn]=vn.match(/^ktx/i)?QD(wn):wn,Nt._offset%4&&Nt._skip(4-Nt._offset%4)}if(_t<=0)return o;const Bt=new pT(tt,ht,_t,!0),kt=Bt._nextUint16(),Pt=Bt._nextUint16(),qt=Bt._nextUint32(),Kt=Bt._nextUint32(),nr=Bt._nextUint32(),ir=Bt._nextUint32(),fr=[];for(let Lr=0;Lr<rt;Lr++)fr.push({imageFlags:Bt._nextUint32(),rgbSliceByteOffset:Bt._nextUint32(),rgbSliceByteLength:Bt._nextUint32(),alphaSliceByteOffset:Bt._nextUint32(),alphaSliceByteLength:Bt._nextUint32()});const br=ht+Bt._offset,Tr=br+qt,Dr=Tr+Kt,Rr=Dr+nr,Nr=new Uint8Array(tt.buffer,tt.byteOffset+br,qt),Ir=new Uint8Array(tt.buffer,tt.byteOffset+Tr,Kt),kr=new Uint8Array(tt.buffer,tt.byteOffset+Dr,nr),Hr=new Uint8Array(tt.buffer,tt.byteOffset+Rr,ir);return o.globalData={endpointCount:kt,selectorCount:Pt,imageDescs:fr,endpointsData:Nr,selectorsData:Ir,tablesData:kr,extendedData:Hr},o}class HD extends Ku{init(){this.extensionName="EXT_mesh_gpu_instancing",this.propertyType="InstancedMesh",this.parentTypes=[ss.NODE]}getDefaults(){return Object.assign(super.getDefaults(),{attributes:{}})}getAttribute(s){return this.getRefMap("attributes",s)}setAttribute(s,o){return this.setRefMap("attributes",s,o,{usage:"INSTANCE_ATTRIBUTE"})}listAttributes(){return this.listRefMapValues("attributes")}listSemantics(){return this.listRefMapKeys("attributes")}}HD.EXTENSION_NAME="EXT_mesh_gpu_instancing";const ax="EXT_mesh_gpu_instancing";function Sw(){return(Sw=Object.assign||function(tt){for(var s=1;s<arguments.length;s++){var o=arguments[s];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(tt[a]=o[a])}return tt}).apply(this,arguments)}var hT,oS,Xu;(class extends Tu{constructor(...tt){super(...tt),this.extensionName=ax,this.provideTypes=[ss.NODE],this.prewriteTypes=[ss.ACCESSOR]}createInstancedMesh(){return new HD(this.document.getGraph())}read(tt){return(tt.jsonDoc.json.nodes||[]).forEach((s,o)=>{if(!s.extensions||!s.extensions[ax])return;const a=s.extensions[ax],_e=this.createInstancedMesh();for(const rt in a.attributes)_e.setAttribute(rt,tt.accessors[a.attributes[rt]]);tt.nodes[o].setExtension(ax,_e)}),this}prewrite(tt){tt.accessorUsageGroupedByParent.add("INSTANCE_ATTRIBUTE");for(const s of this.properties)for(const o of s.listAttributes())tt.addAccessorToUsageGroup(o,"INSTANCE_ATTRIBUTE");return this}write(tt){const s=tt.jsonDoc;return this.document.getRoot().listNodes().forEach(o=>{const a=o.getExtension(ax);if(a){const _e=tt.nodeIndexMap.get(o),rt=s.json.nodes[_e],nt={attributes:{}};a.listSemantics().forEach(ot=>{const ct=a.getAttribute(ot);nt.attributes[ot]=tt.accessorIndexMap.get(ct)}),rt.extensions=rt.extensions||{},rt.extensions[ax]=nt}}),this}}).EXTENSION_NAME=ax,function(tt){tt.QUANTIZE="quantize",tt.FILTER="filter"}(hT||(hT={})),function(tt){tt.ATTRIBUTES="ATTRIBUTES",tt.TRIANGLES="TRIANGLES",tt.INDICES="INDICES"}(oS||(oS={})),function(tt){tt.NONE="NONE",tt.OCTAHEDRAL="OCTAHEDRAL",tt.QUATERNION="QUATERNION",tt.EXPONENTIAL="EXPONENTIAL"}(Xu||(Xu={}));const{BYTE:BL,SHORT:qD,FLOAT:kL}=Ss.ComponentType,{normalize:WD,denormalize:ZP}=ku;function OL(tt,s,o,a){const{filter:_e,bits:rt}=a,nt={array:tt.getArray(),byteStride:tt.getElementSize()*tt.getComponentSize(),componentType:tt.getComponentType(),normalized:tt.getNormalized()};if(o!==oS.ATTRIBUTES)return nt;if(_e!==Xu.NONE){let ot=tt.getNormalized()?function(ct){const pt=ct.getComponentType(),ht=ct.getArray(),_t=new Float32Array(ht.length);for(let Et=0;Et<ht.length;Et++)_t[Et]=ZP(ht[Et],pt);return _t}(tt):new Float32Array(nt.array);switch(_e){case Xu.EXPONENTIAL:nt.byteStride=4*tt.getElementSize(),nt.componentType=kL,nt.normalized=!1,nt.array=s.encodeFilterExp(ot,tt.getCount(),nt.byteStride,rt);break;case Xu.OCTAHEDRAL:nt.byteStride=rt>8?8:4,nt.componentType=rt>8?qD:BL,nt.normalized=!0,ot=tt.getElementSize()===3?function(ct){const pt=new Float32Array(4*ct.length/3);for(let ht=0,_t=ct.length/3;ht<_t;ht++)pt[4*ht]=ct[3*ht],pt[4*ht+1]=ct[3*ht+1],pt[4*ht+2]=ct[3*ht+2];return pt}(ot):ot,nt.array=s.encodeFilterOct(ot,tt.getCount(),nt.byteStride,rt);break;case Xu.QUATERNION:nt.byteStride=8,nt.componentType=qD,nt.normalized=!0,nt.array=s.encodeFilterQuat(ot,tt.getCount(),nt.byteStride,rt);break;default:throw new Error("Invalid filter.")}nt.min=tt.getMin([]),nt.max=tt.getMax([]),tt.getNormalized()&&(nt.min=nt.min.map(ct=>ZP(ct,tt.getComponentType())),nt.max=nt.max.map(ct=>ZP(ct,tt.getComponentType()))),nt.normalized&&(nt.min=nt.min.map(ct=>WD(ct,nt.componentType)),nt.max=nt.max.map(ct=>WD(ct,nt.componentType)))}else nt.byteStride%4&&(nt.array=function(ot,ct){const pt=Yo.padNumber(ot.BYTES_PER_ELEMENT*ct)/ot.BYTES_PER_ELEMENT,ht=new ot.constructor(ot.length/ct*pt);for(let _t=0;_t*ct<ot.length;_t++)for(let Et=0;Et<ct;Et++)ht[_t*pt+Et]=ot[_t*ct+Et];return ht}(nt.array,tt.getElementSize()),nt.byteStride=nt.array.byteLength/tt.getCount());return nt}function LL(tt,s){return s===E_.BufferViewUsage.ELEMENT_ARRAY_BUFFER?tt.listParents().some(o=>o instanceof ox&&o.getMode()===ox.Mode.TRIANGLES)?oS.TRIANGLES:oS.INDICES:oS.ATTRIBUTES}function NL(tt,s){const o=s.getGraph().listParentEdges(tt).filter(a=>!(a.getParent()instanceof zD));for(const a of o){const _e=a.getName(),rt=a.getAttributes().key||"";if(_e==="indices")return{filter:Xu.NONE};if(_e==="attributes"){if(rt==="POSITION")return{filter:Xu.NONE};if(rt==="TEXCOORD_0")return{filter:Xu.NONE};if(rt==="NORMAL")return{filter:Xu.OCTAHEDRAL,bits:8};if(rt==="TANGENT")return{filter:Xu.OCTAHEDRAL,bits:8};if(rt.startsWith("JOINTS_"))return{filter:Xu.NONE};if(rt.startsWith("WEIGHTS_"))return{filter:Xu.NONE}}if(_e==="output"){const nt=YD(tt);return nt==="rotation"?{filter:Xu.QUATERNION,bits:16}:nt==="translation"||nt==="scale"?{filter:Xu.EXPONENTIAL,bits:12}:{filter:Xu.NONE}}if(_e==="input")return{filter:Xu.NONE};if(_e==="inverseBindMatrices")return{filter:Xu.NONE}}return{filter:Xu.NONE}}function YD(tt){for(const s of tt.listParents())if(s instanceof sS){for(const o of s.listParents())if(o instanceof WP)return o.getTargetPath()}return null}const $m="EXT_meshopt_compression",KD={method:hT.QUANTIZE};class XD extends Tu{constructor(...s){super(...s),this.extensionName=$m,this.prereadTypes=[ss.BUFFER,ss.PRIMITIVE],this.prewriteTypes=[ss.BUFFER,ss.ACCESSOR],this.readDependencies=["meshopt.decoder"],this.writeDependencies=["meshopt.encoder"],this._decoder=null,this._decoderFallbackBufferMap=new Map,this._encoder=null,this._encoderOptions=KD,this._encoderFallbackBuffer=null,this._encoderBufferViews={},this._encoderBufferViewData={},this._encoderBufferViewAccessors={}}install(s,o){return s==="meshopt.decoder"&&(this._decoder=o),s==="meshopt.encoder"&&(this._encoder=o),this}setEncoderOptions(s){return this._encoderOptions=Sw({},KD,s),this}preread(s,o){if(!this._decoder){if(!this.isRequired())return this;throw new Error(`[${$m}] Please install extension dependency, "meshopt.decoder".`)}if(!this._decoder.supported){if(!this.isRequired())return this;throw new Error(`[${$m}]: Missing WASM support.`)}return o===ss.BUFFER?this._prereadBuffers(s):o===ss.PRIMITIVE&&this._prereadPrimitives(s),this}_prereadBuffers(s){const o=s.jsonDoc;(o.json.bufferViews||[]).forEach((a,_e)=>{if(!a.extensions||!a.extensions[$m])return;const rt=a.extensions[$m],nt=rt.byteOffset||0,ot=rt.byteLength||0,ct=rt.count,pt=rt.byteStride,ht=new Uint8Array(ct*pt),_t=o.json.buffers[a.buffer],Et=Yo.toView(_t.uri?o.resources[_t.uri]:o.resources["@glb.bin"],nt,ot);this._decoder.decodeGltfBuffer(ht,ct,pt,Et,rt.mode,rt.filter),s.bufferViews[_e]=ht})}_prereadPrimitives(s){const o=s.jsonDoc;(o.json.bufferViews||[]).forEach(a=>{var _e;a.extensions&&a.extensions[$m]&&(_e=o.json.buffers[a.buffer]).extensions&&_e.extensions.EXT_meshopt_compression&&_e.extensions.EXT_meshopt_compression.fallback&&this._decoderFallbackBufferMap.set(s.buffers[a.buffer],s.buffers[a.extensions[$m].buffer])})}read(s){if(!this.isRequired())return this;for(const[o,a]of this._decoderFallbackBufferMap){for(const _e of o.listParents())_e instanceof Ss&&_e.swap(o,a);o.dispose()}return this}prewrite(s,o){return o===ss.ACCESSOR?this._prewriteAccessors(s):o===ss.BUFFER&&this._prewriteBuffers(s),this}_prewriteAccessors(s){const o=s.jsonDoc.json,a=this._encoder,_e=this._encoderOptions,rt=this.document.createBuffer(),nt=this.document.getRoot().listBuffers().indexOf(rt);this._encoderFallbackBuffer=rt,this._encoderBufferViews={},this._encoderBufferViewData={},this._encoderBufferViewAccessors={};for(const ot of this.document.getRoot().listAccessors()){if(YD(ot)==="weights")continue;const ct=s.getAccessorUsage(ot),pt=LL(ot,ct),ht=_e.method===hT.FILTER?NL(ot,this.document):{filter:Xu.NONE},_t=OL(ot,a,pt,ht),{array:Et,byteStride:St}=_t,Mt=ot.getBuffer();if(!Mt)throw new Error(`${$m}: Missing buffer for accessor.`);const It=this.document.getRoot().listBuffers().indexOf(Mt),Nt=[ct,pt,ht.filter,St,It].join(":");let Bt=this._encoderBufferViews[Nt],kt=this._encoderBufferViewData[Nt],Pt=this._encoderBufferViewAccessors[Nt];Bt&&kt||(Pt=this._encoderBufferViewAccessors[Nt]=[],kt=this._encoderBufferViewData[Nt]=[],Bt=this._encoderBufferViews[Nt]={buffer:nt,target:E_.USAGE_TO_TARGET[ct],byteOffset:0,byteLength:0,byteStride:ct===E_.BufferViewUsage.ARRAY_BUFFER?St:void 0,extensions:{[$m]:{buffer:It,byteOffset:0,byteLength:0,mode:pt,filter:ht.filter!==Xu.NONE?ht.filter:void 0,byteStride:St,count:0}}});const qt=s.createAccessorDef(ot);qt.componentType=_t.componentType,qt.normalized=_t.normalized,qt.byteOffset=Bt.byteLength,qt.min&&_t.min&&(qt.min=_t.min),qt.max&&_t.max&&(qt.max=_t.max),s.accessorIndexMap.set(ot,o.accessors.length),o.accessors.push(qt),Pt.push(qt),kt.push(new Uint8Array(Et.buffer,Et.byteOffset,Et.byteLength)),Bt.byteLength+=Et.byteLength,Bt.extensions.EXT_meshopt_compression.count+=ot.getCount()}}_prewriteBuffers(s){const o=this._encoder;for(const a in this._encoderBufferViews){const _e=this._encoderBufferViews[a],rt=this._encoderBufferViewData[a],nt=this.document.getRoot().listBuffers()[_e.extensions[$m].buffer],ot=s.otherBufferViews.get(nt)||[],{count:ct,byteStride:pt,mode:ht}=_e.extensions[$m],_t=Yo.concat(rt),Et=o.encodeGltfBuffer(_t,ct,pt,ht),St=Yo.pad(Et);_e.extensions[$m].byteLength=Et.byteLength,rt.length=0,rt.push(St),ot.push(St),s.otherBufferViews.set(nt,ot)}}write(s){let o=0;for(const nt in this._encoderBufferViews){const ot=this._encoderBufferViews[nt],ct=s.otherBufferViewsIndexMap.get(this._encoderBufferViewData[nt][0]),pt=this._encoderBufferViewAccessors[nt];for(const Et of pt)Et.bufferView=ct;const ht=s.jsonDoc.json.bufferViews[ct],_t=ht.byteOffset||0;Object.assign(ht,ot),ht.byteOffset=o,ht.extensions[$m].byteOffset=_t,o+=Yo.padNumber(ot.byteLength)}const a=this._encoderFallbackBuffer,_e=s.bufferIndexMap.get(a),rt=s.jsonDoc.json.buffers[_e];return rt.byteLength=o,rt.extensions={[$m]:{fallback:!0}},a.dispose(),this}}XD.EXTENSION_NAME=$m,XD.EncoderMethod=hT;const JD="EXT_texture_webp";class FL{match(s){return s.length>=12&&s[8]===87&&s[9]===69&&s[10]===66&&s[11]===80}getSize(s){const o=Yo.decodeText(s.slice(0,4)),a=Yo.decodeText(s.slice(8,12));if(o!=="RIFF"||a!=="WEBP")return null;const _e=new DataView(s.buffer,s.byteOffset);let rt=12;for(;rt<_e.byteLength;){const nt=Yo.decodeText(new Uint8Array([_e.getUint8(rt),_e.getUint8(rt+1),_e.getUint8(rt+2),_e.getUint8(rt+3)])),ot=_e.getUint32(rt+4,!0);if(nt==="VP8 ")return[16383&_e.getInt16(rt+14,!0),16383&_e.getInt16(rt+16,!0)];if(nt==="VP8L"){const ct=_e.getUint8(rt+9),pt=_e.getUint8(rt+10),ht=_e.getUint8(rt+11);return[1+((63&pt)<<8|ct),1+((15&_e.getUint8(rt+12))<<10|ht<<2|(192&pt)>>6)]}rt+=8+ot+ot%2}return null}getChannels(s){return 4}}(class extends Tu{constructor(...tt){super(...tt),this.extensionName=JD,this.prereadTypes=[ss.TEXTURE]}static register(){pA.registerFormat("image/webp",new FL)}preread(tt){return(tt.jsonDoc.json.textures||[]).forEach(s=>{s.extensions&&s.extensions.EXT_texture_webp&&(s.source=s.extensions.EXT_texture_webp.source)}),this}read(tt){return this}write(tt){const s=tt.jsonDoc;return this.document.getRoot().listTextures().forEach(o=>{if(o.getMimeType()==="image/webp"){const a=tt.imageIndexMap.get(o);(s.json.textures||[]).forEach(_e=>{_e.source===a&&(_e.extensions=_e.extensions||{},_e.extensions.EXT_texture_webp={source:_e.source},delete _e.source)})}}),this}}).EXTENSION_NAME=JD;const ZD="KHR_draco_mesh_compression";let wp,eB,tB,hv;function UL(tt,s){const o=new wp.DecoderBuffer;try{if(o.Init(s,s.length),tt.GetEncodedGeometryType(o)!==wp.TRIANGULAR_MESH)throw new Error(`[${ZD}] Unknown geometry type.`);const a=new wp.Mesh;if(!tt.DecodeBufferToMesh(o,a).ok()||a.ptr===0)throw new Error(`[${ZD}] Decoding failure.`);return a}finally{wp.destroy(o)}}function $L(tt,s){const o=3*s.num_faces();let a,_e;if(s.num_points()<=65534){const rt=o*Uint16Array.BYTES_PER_ELEMENT;a=wp._malloc(rt),tt.GetTrianglesUInt16Array(s,rt,a),_e=new Uint16Array(wp.HEAPU16.buffer,a,o).slice()}else{const rt=o*Uint32Array.BYTES_PER_ELEMENT;a=wp._malloc(rt),tt.GetTrianglesUInt32Array(s,rt,a),_e=new Uint32Array(wp.HEAPU32.buffer,a,o).slice()}return wp._free(a),_e}function jL(tt,s,o,a){const _e=tB[a.componentType],rt=eB[a.componentType],nt=o.num_components(),ot=s.num_points()*nt,ct=ot*rt.BYTES_PER_ELEMENT,pt=wp._malloc(ct);tt.GetAttributeDataArrayForAllPoints(s,o,_e,ct,pt);const ht=new rt(wp.HEAPF32.buffer,pt,ot).slice();return wp._free(pt),ht}var fT,S_;(function(tt){tt[tt.EDGEBREAKER=1]="EDGEBREAKER",tt[tt.SEQUENTIAL=0]="SEQUENTIAL"})(fT||(fT={})),function(tt){tt.POSITION="POSITION",tt.NORMAL="NORMAL",tt.COLOR="COLOR",tt.TEX_COORD="TEX_COORD",tt.GENERIC="GENERIC"}(S_||(S_={}));const rB={[S_.POSITION]:14,[S_.NORMAL]:10,[S_.COLOR]:8,[S_.TEX_COORD]:12,[S_.GENERIC]:12},nB={decodeSpeed:5,encodeSpeed:5,method:fT.EDGEBREAKER,quantizationBits:rB,quantizationVolume:"mesh"};function zL(tt,s=nB){const o=Sw({},nB,s);o.quantizationBits=Sw({},rB,s.quantizationBits);const a=new hv.Encoder,_e=new hv.MeshBuilder,rt=new hv.Mesh,nt={},ot=new hv.DracoInt8Array;for(const Mt of tt.listSemantics()){const It=tt.getAttribute(Mt),Nt=VL(Mt),Bt=GL(_e,It.getComponentType(),rt,hv[Nt],It.getCount(),It.getElementSize(),It.getArray());if(Bt===-1)throw new Error(`Error compressing "${Mt}" attribute.`);if(nt[Mt]=Bt,o.quantizationVolume==="mesh"||Mt!=="POSITION")a.SetAttributeQuantization(hv[Nt],o.quantizationBits[Nt]);else{if(typeof o.quantizationVolume!="object")throw new Error("Invalid quantization volume state.");{const{quantizationVolume:kt}=o,Pt=Math.max(kt.max[0]-kt.min[0],kt.max[1]-kt.min[1],kt.max[2]-kt.min[2]);a.SetAttributeExplicitQuantization(hv[Nt],o.quantizationBits[Nt],It.getElementSize(),kt.min,Pt)}}}const ct=tt.getIndices();if(!ct)throw new Error("Primitive must have indices.");_e.AddFacesToMesh(rt,ct.getCount()/3,ct.getArray()),a.SetSpeedOptions(o.encodeSpeed,o.decodeSpeed),a.SetTrackEncodedProperties(!0),o.method===fT.SEQUENTIAL||tt.listTargets().length>0?a.SetEncodingMethod(hv.MESH_SEQUENTIAL_ENCODING):a.SetEncodingMethod(hv.MESH_EDGEBREAKER_ENCODING);const pt=a.EncodeMeshToDracoBuffer(rt,ot);if(pt<=0)throw new Error("Error applying Draco compression.");const ht=new Uint8Array(pt);for(let Mt=0;Mt<pt;++Mt)ht[Mt]=ot.GetValue(Mt);const _t=tt.getAttribute("POSITION").getCount(),Et=a.GetNumberOfEncodedPoints(),St=3*a.GetNumberOfEncodedFaces();if(tt.listTargets().length>0&&Et!==_t)throw new Error('Compression reduced vertex count unexpectedly, corrupting morph targets. Applying the "weld" function before compression may resolve the issue.');return hv.destroy(ot),hv.destroy(rt),hv.destroy(_e),hv.destroy(a),{numVertices:Et,numIndices:St,data:ht,attributeIDs:nt}}function VL(tt){return tt==="POSITION"?S_.POSITION:tt==="NORMAL"?S_.NORMAL:tt.startsWith("COLOR_")?S_.COLOR:tt.startsWith("TEXCOORD_")?S_.TEX_COORD:S_.GENERIC}function GL(tt,s,o,a,_e,rt,nt){switch(s){case Ss.ComponentType.UNSIGNED_BYTE:return tt.AddUInt8Attribute(o,a,_e,rt,nt);case Ss.ComponentType.BYTE:return tt.AddInt8Attribute(o,a,_e,rt,nt);case Ss.ComponentType.UNSIGNED_SHORT:return tt.AddUInt16Attribute(o,a,_e,rt,nt);case Ss.ComponentType.SHORT:return tt.AddInt16Attribute(o,a,_e,rt,nt);case Ss.ComponentType.UNSIGNED_INT:return tt.AddUInt32Attribute(o,a,_e,rt,nt);case Ss.ComponentType.FLOAT:return tt.AddFloatAttribute(o,a,_e,rt,nt);default:throw new Error(`Unexpected component type, "${s}".`)}}const dp="KHR_draco_mesh_compression";class mT extends Tu{constructor(...s){super(...s),this.extensionName=dp,this.prereadTypes=[ss.PRIMITIVE],this.prewriteTypes=[ss.ACCESSOR],this.readDependencies=["draco3d.decoder"],this.writeDependencies=["draco3d.encoder"],this._decoderModule=null,this._encoderModule=null,this._encoderOptions={}}install(s,o){return s==="draco3d.decoder"&&(this._decoderModule=o,wp=this._decoderModule,eB={[Ss.ComponentType.FLOAT]:Float32Array,[Ss.ComponentType.UNSIGNED_INT]:Uint32Array,[Ss.ComponentType.UNSIGNED_SHORT]:Uint16Array,[Ss.ComponentType.UNSIGNED_BYTE]:Uint8Array,[Ss.ComponentType.SHORT]:Int16Array,[Ss.ComponentType.BYTE]:Int8Array},tB={[Ss.ComponentType.FLOAT]:wp.DT_FLOAT32,[Ss.ComponentType.UNSIGNED_INT]:wp.DT_UINT32,[Ss.ComponentType.UNSIGNED_SHORT]:wp.DT_UINT16,[Ss.ComponentType.UNSIGNED_BYTE]:wp.DT_UINT8,[Ss.ComponentType.SHORT]:wp.DT_INT16,[Ss.ComponentType.BYTE]:wp.DT_INT8}),s==="draco3d.encoder"&&(this._encoderModule=o,hv=this._encoderModule),this}setEncoderOptions(s){return this._encoderOptions=s,this}preread(s){if(!this._decoderModule)throw new Error(`[${dp}] Please install extension dependency, "draco3d.decoder".`);const o=this.document.getLogger(),a=s.jsonDoc,_e=new Map;try{const rt=a.json.meshes||[];for(const nt of rt)for(const ot of nt.primitives){if(!ot.extensions||!ot.extensions[dp])continue;const ct=ot.extensions[dp];let[pt,ht]=_e.get(ct.bufferView)||[];if(!ht||!pt){const _t=a.json.bufferViews[ct.bufferView],Et=a.json.buffers[_t.buffer],St=Yo.toView(Et.uri?a.resources[Et.uri]:a.resources["@glb.bin"],_t.byteOffset||0,_t.byteLength);pt=new this._decoderModule.Decoder,ht=UL(pt,St),_e.set(ct.bufferView,[pt,ht]),o.debug(`[${dp}] Decompressed ${St.byteLength} bytes.`)}for(const _t in ot.attributes){const Et=s.jsonDoc.json.accessors[ot.attributes[_t]],St=pt.GetAttributeByUniqueId(ht,ct.attributes[_t]),Mt=jL(pt,ht,St,Et);s.accessors[ot.attributes[_t]].setArray(Mt)}ot.indices!==void 0&&s.accessors[ot.indices].setArray($L(pt,ht))}}finally{for(const[rt,nt]of Array.from(_e.values()))this._decoderModule.destroy(rt),this._decoderModule.destroy(nt)}return this}read(s){return this}prewrite(s,o){if(!this._encoderModule)throw new Error(`[${dp}] Please install extension dependency, "draco3d.encoder".`);const a=this.document.getLogger();a.debug(`[${dp}] Compression options: ${JSON.stringify(this._encoderOptions)}`);const _e=function(ot){const ct=ot.getLogger(),pt=new Set,ht=new Set;for(const Nt of ot.getRoot().listMeshes())for(const Bt of Nt.listPrimitives())Bt.getIndices()?Bt.getMode()!==ox.Mode.TRIANGLES?(ht.add(Bt),ct.warn(`[${dp}] Skipping Draco compression on non-TRIANGLES primitive.`)):pt.add(Bt):(ht.add(Bt),ct.warn(`[${dp}] Skipping Draco compression on non-indexed primitive.`));const _t=ot.getRoot().listAccessors(),Et=new Map;for(let Nt=0;Nt<_t.length;Nt++)Et.set(_t[Nt],Nt);const St=new Map,Mt=new Set,It=new Map;for(const Nt of Array.from(pt)){let Bt=iB(Nt,Et);if(Mt.has(Bt))It.set(Nt,Bt);else{if(St.has(Nt.getIndices())){const kt=Nt.getIndices(),Pt=kt.clone();Et.set(Pt,ot.getRoot().listAccessors().length-1),Nt.swap(kt,Pt)}for(const kt of Nt.listAttributes())if(St.has(kt)){const Pt=kt.clone();Et.set(Pt,ot.getRoot().listAccessors().length-1),Nt.swap(kt,Pt)}Bt=iB(Nt,Et),Mt.add(Bt),It.set(Nt,Bt),St.set(Nt.getIndices(),Bt);for(const kt of Nt.listAttributes())St.set(kt,Bt)}}for(const Nt of Array.from(St.keys())){const Bt=new Set(Nt.listParents().map(kt=>kt.propertyType));if(Bt.size!==2||!Bt.has(ss.PRIMITIVE)||!Bt.has(ss.ROOT))throw new Error(`[${dp}] Compressed accessors must only be used as indices or vertex attributes.`)}for(const Nt of Array.from(pt)){const Bt=It.get(Nt),kt=Nt.getIndices();if(St.get(kt)!==Bt||Nt.listAttributes().some(Pt=>St.get(Pt)!==Bt))throw new Error(`[${dp}] Draco primitives must share all, or no, accessors.`)}for(const Nt of Array.from(ht)){const Bt=Nt.getIndices();if(St.has(Bt)||Nt.listAttributes().some(kt=>St.has(kt)))throw new Error(`[${dp}] Accessor cannot be shared by compressed and uncompressed primitives.`)}return It}(this.document),rt=new Map;let nt="mesh";this._encoderOptions.quantizationVolume==="scene"&&(this.document.getRoot().listScenes().length!==1?a.warn(`[${dp}]: quantizationVolume=scene requires exactly 1 scene.`):nt=function(ot){const ct={min:[1/0,1/0,1/0],max:[-1/0,-1/0,-1/0]},pt=ot.propertyType===ss.NODE?[ot]:ot.listChildren();for(const ht of pt)ht.traverse(_t=>{const Et=_t.getMesh();if(!Et)return;const St=bL(Et,_t.getWorldMatrix());HP(St.min,ct),HP(St.max,ct)});return ct}(this.document.getRoot().listScenes().pop()));for(const ot of Array.from(_e.keys())){const ct=_e.get(ot);if(!ct)throw new Error("Unexpected primitive.");if(rt.has(ct)){rt.set(ct,rt.get(ct));continue}const pt=ot.getIndices(),ht=s.jsonDoc.json.accessors,_t=zL(ot,Sw({},this._encoderOptions,{quantizationVolume:nt}));rt.set(ct,_t);const Et=s.createAccessorDef(pt);Et.count=_t.numIndices,s.accessorIndexMap.set(pt,ht.length),ht.push(Et);for(const Mt of ot.listSemantics()){const It=ot.getAttribute(Mt),Nt=s.createAccessorDef(It);Nt.count=_t.numVertices,s.accessorIndexMap.set(It,ht.length),ht.push(Nt)}const St=ot.getAttribute("POSITION").getBuffer()||this.document.getRoot().listBuffers()[0];s.otherBufferViews.has(St)||s.otherBufferViews.set(St,[]),s.otherBufferViews.get(St).push(_t.data)}return a.debug(`[${dp}] Compressed ${_e.size} primitives.`),s.extensionData[dp]={primitiveHashMap:_e,primitiveEncodingMap:rt},this}write(s){const o=s.extensionData[dp];for(const a of this.document.getRoot().listMeshes()){const _e=s.jsonDoc.json.meshes[s.meshIndexMap.get(a)];for(let rt=0;rt<a.listPrimitives().length;rt++){const nt=a.listPrimitives()[rt],ot=_e.primitives[rt],ct=o.primitiveHashMap.get(nt);if(!ct)continue;const pt=o.primitiveEncodingMap.get(ct);ot.extensions=ot.extensions||{},ot.extensions[dp]={bufferView:s.otherBufferViewsIndexMap.get(pt.data),attributes:pt.attributeIDs}}}if(!o.primitiveHashMap.size){const a=s.jsonDoc.json;a.extensionsUsed=(a.extensionsUsed||[]).filter(_e=>_e!==dp),a.extensionsRequired=(a.extensionsRequired||[]).filter(_e=>_e!==dp)}return this}}function iB(tt,s){const o=[],a=tt.getIndices();o.push(s.get(a));for(const _e of tt.listAttributes())o.push(s.get(_e));return o.sort().join("|")}mT.EXTENSION_NAME=dp,mT.EncoderMethod=fT;class aS extends Ku{init(){this.extensionName="KHR_lights_punctual",this.propertyType="Light",this.parentTypes=[ss.NODE]}getDefaults(){return Object.assign(super.getDefaults(),{color:[1,1,1],intensity:1,type:aS.Type.POINT,range:null,innerConeAngle:0,outerConeAngle:Math.PI/4})}getColor(){return this.get("color")}setColor(s){return this.set("color",s)}getColorHex(){return dv.factorToHex(this.getColor())}setColorHex(s){const o=this.getColor().slice();return dv.hexToFactor(s,o),this.setColor(o)}getIntensity(){return this.get("intensity")}setIntensity(s){return this.set("intensity",s)}getType(){return this.get("type")}setType(s){return this.set("type",s)}getRange(){return this.get("range")}setRange(s){return this.set("range",s)}getInnerConeAngle(){return this.get("innerConeAngle")}setInnerConeAngle(s){return this.set("innerConeAngle",s)}getOuterConeAngle(){return this.get("outerConeAngle")}setOuterConeAngle(s){return this.set("outerConeAngle",s)}}aS.EXTENSION_NAME="KHR_lights_punctual",aS.Type={POINT:"point",SPOT:"spot",DIRECTIONAL:"directional"};const $R="KHR_lights_punctual";class sB extends Tu{constructor(...s){super(...s),this.extensionName=$R}createLight(s=""){return new aS(this.document.getGraph(),s)}read(s){const o=s.jsonDoc;if(!o.json.extensions||!o.json.extensions.KHR_lights_punctual)return this;const a=(o.json.extensions.KHR_lights_punctual.lights||[]).map(_e=>{var rt,nt;const ot=this.createLight().setName(_e.name||"").setType(_e.type);return _e.color!==void 0&&ot.setColor(_e.color),_e.intensity!==void 0&&ot.setIntensity(_e.intensity),_e.range!==void 0&&ot.setRange(_e.range),((rt=_e.spot)==null?void 0:rt.innerConeAngle)!==void 0&&ot.setInnerConeAngle(_e.spot.innerConeAngle),((nt=_e.spot)==null?void 0:nt.outerConeAngle)!==void 0&&ot.setOuterConeAngle(_e.spot.outerConeAngle),ot});return o.json.nodes.forEach((_e,rt)=>{_e.extensions&&_e.extensions.KHR_lights_punctual&&s.nodes[rt].setExtension($R,a[_e.extensions.KHR_lights_punctual.light])}),this}write(s){const o=s.jsonDoc;if(this.properties.size===0)return this;const a=[],_e=new Map;for(const rt of this.properties){const nt=rt,ot={type:nt.getType()};ku.eq(nt.getColor(),[1,1,1])||(ot.color=nt.getColor()),nt.getIntensity()!==1&&(ot.intensity=nt.getIntensity()),nt.getRange()!=null&&(ot.range=nt.getRange()),nt.getName()&&(ot.name=nt.getName()),nt.getType()===aS.Type.SPOT&&(ot.spot={innerConeAngle:nt.getInnerConeAngle(),outerConeAngle:nt.getOuterConeAngle()}),a.push(ot),_e.set(nt,a.length-1)}return this.document.getRoot().listNodes().forEach(rt=>{const nt=rt.getExtension($R);if(nt){const ot=s.nodeIndexMap.get(rt),ct=o.json.nodes[ot];ct.extensions=ct.extensions||{},ct.extensions.KHR_lights_punctual={light:_e.get(nt)}}}),o.json.extensions=o.json.extensions||{},o.json.extensions.KHR_lights_punctual={lights:a},this}}sB.EXTENSION_NAME=$R;const{R:oB,G:aB,B:QL}=Yu;class lB extends Ku{init(){this.extensionName="KHR_materials_clearcoat",this.propertyType="Clearcoat",this.parentTypes=[ss.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{clearcoatFactor:0,clearcoatTexture:null,clearcoatTextureInfo:new yu(this.graph,"clearcoatTextureInfo"),clearcoatRoughnessFactor:0,clearcoatRoughnessTexture:null,clearcoatRoughnessTextureInfo:new yu(this.graph,"clearcoatRoughnessTextureInfo"),clearcoatNormalScale:1,clearcoatNormalTexture:null,clearcoatNormalTextureInfo:new yu(this.graph,"clearcoatNormalTextureInfo")})}getClearcoatFactor(){return this.get("clearcoatFactor")}setClearcoatFactor(s){return this.set("clearcoatFactor",s)}getClearcoatTexture(){return this.getRef("clearcoatTexture")}getClearcoatTextureInfo(){return this.getRef("clearcoatTexture")?this.getRef("clearcoatTextureInfo"):null}setClearcoatTexture(s){return this.setRef("clearcoatTexture",s,{channels:oB})}getClearcoatRoughnessFactor(){return this.get("clearcoatRoughnessFactor")}setClearcoatRoughnessFactor(s){return this.set("clearcoatRoughnessFactor",s)}getClearcoatRoughnessTexture(){return this.getRef("clearcoatRoughnessTexture")}getClearcoatRoughnessTextureInfo(){return this.getRef("clearcoatRoughnessTexture")?this.getRef("clearcoatRoughnessTextureInfo"):null}setClearcoatRoughnessTexture(s){return this.setRef("clearcoatRoughnessTexture",s,{channels:aB})}getClearcoatNormalScale(){return this.get("clearcoatNormalScale")}setClearcoatNormalScale(s){return this.set("clearcoatNormalScale",s)}getClearcoatNormalTexture(){return this.getRef("clearcoatNormalTexture")}getClearcoatNormalTextureInfo(){return this.getRef("clearcoatNormalTexture")?this.getRef("clearcoatNormalTextureInfo"):null}setClearcoatNormalTexture(s){return this.setRef("clearcoatNormalTexture",s,{channels:oB|aB|QL})}}lB.EXTENSION_NAME="KHR_materials_clearcoat";const lx="KHR_materials_clearcoat";class uB extends Tu{constructor(...s){super(...s),this.extensionName=lx}createClearcoat(){return new lB(this.document.getGraph())}read(s){const o=s.jsonDoc,a=o.json.textures||[];return(o.json.materials||[]).forEach((_e,rt)=>{if(_e.extensions&&_e.extensions[lx]){const nt=this.createClearcoat();s.materials[rt].setExtension(lx,nt);const ot=_e.extensions[lx];if(ot.clearcoatFactor!==void 0&&nt.setClearcoatFactor(ot.clearcoatFactor),ot.clearcoatRoughnessFactor!==void 0&&nt.setClearcoatRoughnessFactor(ot.clearcoatRoughnessFactor),ot.clearcoatTexture!==void 0){const ct=ot.clearcoatTexture;nt.setClearcoatTexture(s.textures[a[ct.index].source]),s.setTextureInfo(nt.getClearcoatTextureInfo(),ct)}if(ot.clearcoatRoughnessTexture!==void 0){const ct=ot.clearcoatRoughnessTexture;nt.setClearcoatRoughnessTexture(s.textures[a[ct.index].source]),s.setTextureInfo(nt.getClearcoatRoughnessTextureInfo(),ct)}if(ot.clearcoatNormalTexture!==void 0){const ct=ot.clearcoatNormalTexture;nt.setClearcoatNormalTexture(s.textures[a[ct.index].source]),s.setTextureInfo(nt.getClearcoatNormalTextureInfo(),ct),ct.scale!==void 0&&nt.setClearcoatNormalScale(ct.scale)}}}),this}write(s){const o=s.jsonDoc;return this.document.getRoot().listMaterials().forEach(a=>{const _e=a.getExtension(lx);if(_e){const rt=s.materialIndexMap.get(a),nt=o.json.materials[rt];nt.extensions=nt.extensions||{};const ot=nt.extensions[lx]={clearcoatFactor:_e.getClearcoatFactor(),clearcoatRoughnessFactor:_e.getClearcoatRoughnessFactor()};if(_e.getClearcoatTexture()){const ct=_e.getClearcoatTexture(),pt=_e.getClearcoatTextureInfo();ot.clearcoatTexture=s.createTextureInfoDef(ct,pt)}if(_e.getClearcoatRoughnessTexture()){const ct=_e.getClearcoatRoughnessTexture(),pt=_e.getClearcoatRoughnessTextureInfo();ot.clearcoatRoughnessTexture=s.createTextureInfoDef(ct,pt)}if(_e.getClearcoatNormalTexture()){const ct=_e.getClearcoatNormalTexture(),pt=_e.getClearcoatNormalTextureInfo();ot.clearcoatNormalTexture=s.createTextureInfoDef(ct,pt),_e.getClearcoatNormalScale()!==1&&(ot.clearcoatNormalTexture.scale=_e.getClearcoatNormalScale())}}}),this}}uB.EXTENSION_NAME=lx;class cB extends Ku{init(){this.extensionName="KHR_materials_emissive_strength",this.propertyType="EmissiveStrength",this.parentTypes=[ss.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{emissiveStrength:1})}getEmissiveStrength(){return this.get("emissiveStrength")}setEmissiveStrength(s){return this.set("emissiveStrength",s)}}cB.EXTENSION_NAME="KHR_materials_emissive_strength";const ux="KHR_materials_emissive_strength";class dB extends Tu{constructor(...s){super(...s),this.extensionName=ux}createEmissiveStrength(){return new cB(this.document.getGraph())}read(s){return(s.jsonDoc.json.materials||[]).forEach((o,a)=>{if(o.extensions&&o.extensions[ux]){const _e=this.createEmissiveStrength();s.materials[a].setExtension(ux,_e);const rt=o.extensions[ux];rt.emissiveStrength!==void 0&&_e.setEmissiveStrength(rt.emissiveStrength)}}),this}write(s){const o=s.jsonDoc;return this.document.getRoot().listMaterials().forEach(a=>{const _e=a.getExtension(ux);if(_e){const rt=s.materialIndexMap.get(a),nt=o.json.materials[rt];nt.extensions=nt.extensions||{},nt.extensions[ux]={emissiveStrength:_e.getEmissiveStrength()}}}),this}}dB.EXTENSION_NAME=ux;class pB extends Ku{init(){this.extensionName="KHR_materials_ior",this.propertyType="IOR",this.parentTypes=[ss.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{ior:0})}getIOR(){return this.get("ior")}setIOR(s){return this.set("ior",s)}}pB.EXTENSION_NAME="KHR_materials_ior";const jR="KHR_materials_ior";class hB extends Tu{constructor(...s){super(...s),this.extensionName=jR}createIOR(){return new pB(this.document.getGraph())}read(s){return(s.jsonDoc.json.materials||[]).forEach((o,a)=>{if(o.extensions&&o.extensions.KHR_materials_ior){const _e=this.createIOR();s.materials[a].setExtension(jR,_e);const rt=o.extensions.KHR_materials_ior;rt.ior!==void 0&&_e.setIOR(rt.ior)}}),this}write(s){const o=s.jsonDoc;return this.document.getRoot().listMaterials().forEach(a=>{const _e=a.getExtension(jR);if(_e){const rt=s.materialIndexMap.get(a),nt=o.json.materials[rt];nt.extensions=nt.extensions||{},nt.extensions.KHR_materials_ior={ior:_e.getIOR()}}}),this}}hB.EXTENSION_NAME=jR;const{R:HL,G:qL}=Yu;class fB extends Ku{init(){this.extensionName="KHR_materials_iridescence",this.propertyType="Iridescence",this.parentTypes=[ss.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{iridescenceFactor:0,iridescenceTexture:null,iridescenceTextureInfo:new yu(this.graph,"iridescenceTextureInfo"),iridescenceIOR:1.3,iridescenceThicknessMinimum:100,iridescenceThicknessMaximum:400,iridescenceThicknessTexture:null,iridescenceThicknessTextureInfo:new yu(this.graph,"iridescenceThicknessTextureInfo")})}getIridescenceFactor(){return this.get("iridescenceFactor")}setIridescenceFactor(s){return this.set("iridescenceFactor",s)}getIridescenceTexture(){return this.getRef("iridescenceTexture")}getIridescenceTextureInfo(){return this.getRef("iridescenceTexture")?this.getRef("iridescenceTextureInfo"):null}setIridescenceTexture(s){return this.setRef("iridescenceTexture",s,{channels:HL})}getIridescenceIOR(){return this.get("iridescenceIOR")}setIridescenceIOR(s){return this.set("iridescenceIOR",s)}getIridescenceThicknessMinimum(){return this.get("iridescenceThicknessMinimum")}setIridescenceThicknessMinimum(s){return this.set("iridescenceThicknessMinimum",s)}getIridescenceThicknessMaximum(){return this.get("iridescenceThicknessMaximum")}setIridescenceThicknessMaximum(s){return this.set("iridescenceThicknessMaximum",s)}getIridescenceThicknessTexture(){return this.getRef("iridescenceThicknessTexture")}getIridescenceThicknessTextureInfo(){return this.getRef("iridescenceThicknessTexture")?this.getRef("iridescenceThicknessTextureInfo"):null}setIridescenceThicknessTexture(s){return this.setRef("iridescenceThicknessTexture",s,{channels:qL})}}fB.EXTENSION_NAME="KHR_materials_iridescence";const cx="KHR_materials_iridescence";class mB extends Tu{constructor(...s){super(...s),this.extensionName=cx}createIridescence(){return new fB(this.document.getGraph())}read(s){const o=s.jsonDoc,a=o.json.textures||[];return(o.json.materials||[]).forEach((_e,rt)=>{if(_e.extensions&&_e.extensions[cx]){const nt=this.createIridescence();s.materials[rt].setExtension(cx,nt);const ot=_e.extensions[cx];if(ot.iridescenceFactor!==void 0&&nt.setIridescenceFactor(ot.iridescenceFactor),ot.iridescenceIor!==void 0&&nt.setIridescenceIOR(ot.iridescenceIor),ot.iridescenceThicknessMinimum!==void 0&&nt.setIridescenceThicknessMinimum(ot.iridescenceThicknessMinimum),ot.iridescenceThicknessMaximum!==void 0&&nt.setIridescenceThicknessMaximum(ot.iridescenceThicknessMaximum),ot.iridescenceTexture!==void 0){const ct=ot.iridescenceTexture;nt.setIridescenceTexture(s.textures[a[ct.index].source]),s.setTextureInfo(nt.getIridescenceTextureInfo(),ct)}if(ot.iridescenceThicknessTexture!==void 0){const ct=ot.iridescenceThicknessTexture;nt.setIridescenceThicknessTexture(s.textures[a[ct.index].source]),s.setTextureInfo(nt.getIridescenceThicknessTextureInfo(),ct)}}}),this}write(s){const o=s.jsonDoc;return this.document.getRoot().listMaterials().forEach(a=>{const _e=a.getExtension(cx);if(_e){const rt=s.materialIndexMap.get(a),nt=o.json.materials[rt];nt.extensions=nt.extensions||{};const ot=nt.extensions[cx]={};if(_e.getIridescenceFactor()>0&&(ot.iridescenceFactor=_e.getIridescenceFactor()),_e.getIridescenceIOR()!==1.3&&(ot.iridescenceIor=_e.getIridescenceIOR()),_e.getIridescenceThicknessMinimum()!==100&&(ot.iridescenceThicknessMinimum=_e.getIridescenceThicknessMinimum()),_e.getIridescenceThicknessMaximum()!==400&&(ot.iridescenceThicknessMaximum=_e.getIridescenceThicknessMaximum()),_e.getIridescenceTexture()){const ct=_e.getIridescenceTexture(),pt=_e.getIridescenceTextureInfo();ot.iridescenceTexture=s.createTextureInfoDef(ct,pt)}if(_e.getIridescenceThicknessTexture()){const ct=_e.getIridescenceThicknessTexture(),pt=_e.getIridescenceThicknessTextureInfo();ot.iridescenceThicknessTexture=s.createTextureInfoDef(ct,pt)}}}),this}}mB.EXTENSION_NAME=cx;const{R:gB,G:vB,B:_B,A:yB}=Yu;class AB extends Ku{init(){this.extensionName="KHR_materials_pbrSpecularGlossiness",this.propertyType="PBRSpecularGlossiness",this.parentTypes=[ss.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{diffuseFactor:[1,1,1,1],diffuseTexture:null,diffuseTextureInfo:new yu(this.graph,"diffuseTextureInfo"),specularFactor:[1,1,1],glossinessFactor:1,specularGlossinessTexture:null,specularGlossinessTextureInfo:new yu(this.graph,"specularGlossinessTextureInfo")})}getDiffuseFactor(){return this.get("diffuseFactor")}setDiffuseFactor(s){return this.set("diffuseFactor",s)}getDiffuseHex(){return dv.factorToHex(this.getDiffuseFactor())}setDiffuseHex(s){const o=this.getDiffuseFactor().slice();return this.setDiffuseFactor(dv.hexToFactor(s,o))}getDiffuseTexture(){return this.getRef("diffuseTexture")}getDiffuseTextureInfo(){return this.getRef("diffuseTexture")?this.getRef("diffuseTextureInfo"):null}setDiffuseTexture(s){return this.setRef("diffuseTexture",s,{channels:gB|vB|_B|yB})}getSpecularFactor(){return this.get("specularFactor")}setSpecularFactor(s){return this.set("specularFactor",s)}getGlossinessFactor(){return this.get("glossinessFactor")}setGlossinessFactor(s){return this.set("glossinessFactor",s)}getSpecularGlossinessTexture(){return this.getRef("specularGlossinessTexture")}getSpecularGlossinessTextureInfo(){return this.getRef("specularGlossinessTexture")?this.getRef("specularGlossinessTextureInfo"):null}setSpecularGlossinessTexture(s){return this.setRef("specularGlossinessTexture",s,{channels:gB|vB|_B|yB})}}AB.EXTENSION_NAME="KHR_materials_pbrSpecularGlossiness";const dx="KHR_materials_pbrSpecularGlossiness";class bB extends Tu{constructor(...s){super(...s),this.extensionName=dx}createPBRSpecularGlossiness(){return new AB(this.document.getGraph())}read(s){const o=s.jsonDoc,a=o.json.textures||[];return(o.json.materials||[]).forEach((_e,rt)=>{if(_e.extensions&&_e.extensions[dx]){const nt=this.createPBRSpecularGlossiness();s.materials[rt].setExtension(dx,nt);const ot=_e.extensions[dx];if(ot.diffuseFactor!==void 0&&nt.setDiffuseFactor(ot.diffuseFactor),ot.specularFactor!==void 0&&nt.setSpecularFactor(ot.specularFactor),ot.glossinessFactor!==void 0&&nt.setGlossinessFactor(ot.glossinessFactor),ot.diffuseTexture!==void 0){const ct=ot.diffuseTexture;nt.setDiffuseTexture(s.textures[a[ct.index].source]),s.setTextureInfo(nt.getDiffuseTextureInfo(),ct)}if(ot.specularGlossinessTexture!==void 0){const ct=ot.specularGlossinessTexture;nt.setSpecularGlossinessTexture(s.textures[a[ct.index].source]),s.setTextureInfo(nt.getSpecularGlossinessTextureInfo(),ct)}}}),this}write(s){const o=s.jsonDoc;return this.document.getRoot().listMaterials().forEach(a=>{const _e=a.getExtension(dx);if(_e){const rt=s.materialIndexMap.get(a),nt=o.json.materials[rt];nt.extensions=nt.extensions||{};const ot=nt.extensions[dx]={diffuseFactor:_e.getDiffuseFactor(),specularFactor:_e.getSpecularFactor(),glossinessFactor:_e.getGlossinessFactor()};if(_e.getDiffuseTexture()){const ct=_e.getDiffuseTexture(),pt=_e.getDiffuseTextureInfo();ot.diffuseTexture=s.createTextureInfoDef(ct,pt)}if(_e.getSpecularGlossinessTexture()){const ct=_e.getSpecularGlossinessTexture(),pt=_e.getSpecularGlossinessTextureInfo();ot.specularGlossinessTexture=s.createTextureInfoDef(ct,pt)}}}),this}}bB.EXTENSION_NAME=dx;const{R:WL,G:YL,B:KL,A:XL}=Yu;class wB extends Ku{init(){this.extensionName="KHR_materials_sheen",this.propertyType="Sheen",this.parentTypes=[ss.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{sheenColorFactor:[0,0,0],sheenColorTexture:null,sheenColorTextureInfo:new yu(this.graph,"sheenColorTextureInfo"),sheenRoughnessFactor:0,sheenRoughnessTexture:null,sheenRoughnessTextureInfo:new yu(this.graph,"sheenRoughnessTextureInfo")})}getSheenColorFactor(){return this.get("sheenColorFactor")}getSheenColorHex(){return dv.factorToHex(this.getSheenColorFactor())}setSheenColorFactor(s){return this.set("sheenColorFactor",s)}setSheenColorHex(s){const o=this.getSheenColorFactor().slice();return this.set("sheenColorFactor",dv.hexToFactor(s,o))}getSheenColorTexture(){return this.getRef("sheenColorTexture")}getSheenColorTextureInfo(){return this.getRef("sheenColorTexture")?this.getRef("sheenColorTextureInfo"):null}setSheenColorTexture(s){return this.setRef("sheenColorTexture",s,{channels:WL|YL|KL})}getSheenRoughnessFactor(){return this.get("sheenRoughnessFactor")}setSheenRoughnessFactor(s){return this.set("sheenRoughnessFactor",s)}getSheenRoughnessTexture(){return this.getRef("sheenRoughnessTexture")}getSheenRoughnessTextureInfo(){return this.getRef("sheenRoughnessTexture")?this.getRef("sheenRoughnessTextureInfo"):null}setSheenRoughnessTexture(s){return this.setRef("sheenRoughnessTexture",s,{channels:XL})}}wB.EXTENSION_NAME="KHR_materials_sheen";const zR="KHR_materials_sheen";class xB extends Tu{constructor(...s){super(...s),this.extensionName=zR}createSheen(){return new wB(this.document.getGraph())}read(s){const o=s.jsonDoc,a=o.json.textures||[];return(o.json.materials||[]).forEach((_e,rt)=>{if(_e.extensions&&_e.extensions.KHR_materials_sheen){const nt=this.createSheen();s.materials[rt].setExtension(zR,nt);const ot=_e.extensions.KHR_materials_sheen;if(ot.sheenColorFactor!==void 0&&nt.setSheenColorFactor(ot.sheenColorFactor),ot.sheenRoughnessFactor!==void 0&&nt.setSheenRoughnessFactor(ot.sheenRoughnessFactor),ot.sheenColorTexture!==void 0){const ct=ot.sheenColorTexture;nt.setSheenColorTexture(s.textures[a[ct.index].source]),s.setTextureInfo(nt.getSheenColorTextureInfo(),ct)}if(ot.sheenRoughnessTexture!==void 0){const ct=ot.sheenRoughnessTexture;nt.setSheenRoughnessTexture(s.textures[a[ct.index].source]),s.setTextureInfo(nt.getSheenRoughnessTextureInfo(),ct)}}}),this}write(s){const o=s.jsonDoc;return this.document.getRoot().listMaterials().forEach(a=>{const _e=a.getExtension(zR);if(_e){const rt=s.materialIndexMap.get(a),nt=o.json.materials[rt];nt.extensions=nt.extensions||{};const ot=nt.extensions.KHR_materials_sheen={sheenColorFactor:_e.getSheenColorFactor(),sheenRoughnessFactor:_e.getSheenRoughnessFactor()};if(_e.getSheenColorTexture()){const ct=_e.getSheenColorTexture(),pt=_e.getSheenColorTextureInfo();ot.sheenColorTexture=s.createTextureInfoDef(ct,pt)}if(_e.getSheenRoughnessTexture()){const ct=_e.getSheenRoughnessTexture(),pt=_e.getSheenRoughnessTextureInfo();ot.sheenRoughnessTexture=s.createTextureInfoDef(ct,pt)}}}),this}}xB.EXTENSION_NAME=zR;const{R:JL,G:ZL,B:eN,A:tN}=Yu;class EB extends Ku{init(){this.extensionName="KHR_materials_specular",this.propertyType="Specular",this.parentTypes=[ss.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{specularFactor:1,specularTexture:null,specularTextureInfo:new yu(this.graph,"specularTextureInfo"),specularColorFactor:[1,1,1],specularColorTexture:null,specularColorTextureInfo:new yu(this.graph,"specularColorTextureInfo")})}getSpecularFactor(){return this.get("specularFactor")}setSpecularFactor(s){return this.set("specularFactor",s)}getSpecularColorFactor(){return this.get("specularColorFactor")}setSpecularColorFactor(s){return this.set("specularColorFactor",s)}getSpecularColorHex(){return dv.factorToHex(this.getSpecularColorFactor())}setSpecularColorHex(s){const o=this.getSpecularColorFactor().slice();return this.set("specularColorFactor",dv.hexToFactor(s,o))}getSpecularTexture(){return this.getRef("specularTexture")}getSpecularTextureInfo(){return this.getRef("specularTexture")?this.getRef("specularTextureInfo"):null}setSpecularTexture(s){return this.setRef("specularTexture",s,{channels:tN})}getSpecularColorTexture(){return this.getRef("specularColorTexture")}getSpecularColorTextureInfo(){return this.getRef("specularColorTexture")?this.getRef("specularColorTextureInfo"):null}setSpecularColorTexture(s){return this.setRef("specularColorTexture",s,{channels:JL|ZL|eN})}}EB.EXTENSION_NAME="KHR_materials_specular";const px="KHR_materials_specular";class SB extends Tu{constructor(...s){super(...s),this.extensionName=px}createSpecular(){return new EB(this.document.getGraph())}read(s){const o=s.jsonDoc,a=o.json.textures||[];return(o.json.materials||[]).forEach((_e,rt)=>{if(_e.extensions&&_e.extensions[px]){const nt=this.createSpecular();s.materials[rt].setExtension(px,nt);const ot=_e.extensions[px];if(ot.specularFactor!==void 0&&nt.setSpecularFactor(ot.specularFactor),ot.specularColorFactor!==void 0&&nt.setSpecularColorFactor(ot.specularColorFactor),ot.specularTexture!==void 0){const ct=ot.specularTexture;nt.setSpecularTexture(s.textures[a[ct.index].source]),s.setTextureInfo(nt.getSpecularTextureInfo(),ct)}if(ot.specularColorTexture!==void 0){const ct=ot.specularColorTexture;nt.setSpecularColorTexture(s.textures[a[ct.index].source]),s.setTextureInfo(nt.getSpecularColorTextureInfo(),ct)}}}),this}write(s){const o=s.jsonDoc;return this.document.getRoot().listMaterials().forEach(a=>{const _e=a.getExtension(px);if(_e){const rt=s.materialIndexMap.get(a),nt=o.json.materials[rt];nt.extensions=nt.extensions||{};const ot=nt.extensions[px]={};if(_e.getSpecularFactor()!==1&&(ot.specularFactor=_e.getSpecularFactor()),ku.eq(_e.getSpecularColorFactor(),[1,1,1])||(ot.specularColorFactor=_e.getSpecularColorFactor()),_e.getSpecularTexture()){const ct=_e.getSpecularTexture(),pt=_e.getSpecularTextureInfo();ot.specularTexture=s.createTextureInfoDef(ct,pt)}if(_e.getSpecularColorTexture()){const ct=_e.getSpecularColorTexture(),pt=_e.getSpecularColorTextureInfo();ot.specularColorTexture=s.createTextureInfoDef(ct,pt)}}}),this}}SB.EXTENSION_NAME=px;const{R:rN}=Yu;class CB extends Ku{init(){this.extensionName="KHR_materials_transmission",this.propertyType="Transmission",this.parentTypes=[ss.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{transmissionFactor:0,transmissionTexture:null,transmissionTextureInfo:new yu(this.graph,"transmissionTextureInfo")})}getTransmissionFactor(){return this.get("transmissionFactor")}setTransmissionFactor(s){return this.set("transmissionFactor",s)}getTransmissionTexture(){return this.getRef("transmissionTexture")}getTransmissionTextureInfo(){return this.getRef("transmissionTexture")?this.getRef("transmissionTextureInfo"):null}setTransmissionTexture(s){return this.setRef("transmissionTexture",s,{channels:rN})}}CB.EXTENSION_NAME="KHR_materials_transmission";const hx="KHR_materials_transmission";class TB extends Tu{constructor(...s){super(...s),this.extensionName=hx}createTransmission(){return new CB(this.document.getGraph())}read(s){const o=s.jsonDoc,a=o.json.textures||[];return(o.json.materials||[]).forEach((_e,rt)=>{if(_e.extensions&&_e.extensions[hx]){const nt=this.createTransmission();s.materials[rt].setExtension(hx,nt);const ot=_e.extensions[hx];if(ot.transmissionFactor!==void 0&&nt.setTransmissionFactor(ot.transmissionFactor),ot.transmissionTexture!==void 0){const ct=ot.transmissionTexture;nt.setTransmissionTexture(s.textures[a[ct.index].source]),s.setTextureInfo(nt.getTransmissionTextureInfo(),ct)}}}),this}write(s){const o=s.jsonDoc;return this.document.getRoot().listMaterials().forEach(a=>{const _e=a.getExtension(hx);if(_e){const rt=s.materialIndexMap.get(a),nt=o.json.materials[rt];nt.extensions=nt.extensions||{};const ot=nt.extensions[hx]={transmissionFactor:_e.getTransmissionFactor()};if(_e.getTransmissionTexture()){const ct=_e.getTransmissionTexture(),pt=_e.getTransmissionTextureInfo();ot.transmissionTexture=s.createTextureInfoDef(ct,pt)}}}),this}}TB.EXTENSION_NAME=hx;class MB extends Ku{init(){this.extensionName="KHR_materials_unlit",this.propertyType="Unlit",this.parentTypes=[ss.MATERIAL]}}MB.EXTENSION_NAME="KHR_materials_unlit";const VR="KHR_materials_unlit";class RB extends Tu{constructor(...s){super(...s),this.extensionName=VR}createUnlit(){return new MB(this.document.getGraph())}read(s){return(s.jsonDoc.json.materials||[]).forEach((o,a)=>{o.extensions&&o.extensions.KHR_materials_unlit&&s.materials[a].setExtension(VR,this.createUnlit())}),this}write(s){const o=s.jsonDoc;return this.document.getRoot().listMaterials().forEach(a=>{if(a.getExtension(VR)){const _e=s.materialIndexMap.get(a),rt=o.json.materials[_e];rt.extensions=rt.extensions||{},rt.extensions.KHR_materials_unlit={}}}),this}}RB.EXTENSION_NAME=VR;class IB extends Ku{init(){this.extensionName="KHR_materials_variants",this.propertyType="Mapping",this.parentTypes=["MappingList"]}getDefaults(){return Object.assign(super.getDefaults(),{material:null,variants:[]})}getMaterial(){return this.getRef("material")}setMaterial(s){return this.setRef("material",s)}addVariant(s){return this.addRef("variants",s)}removeVariant(s){return this.removeRef("variants",s)}listVariants(){return this.listRefs("variants")}}IB.EXTENSION_NAME="KHR_materials_variants";class PB extends Ku{init(){this.extensionName="KHR_materials_variants",this.propertyType="MappingList",this.parentTypes=[ss.PRIMITIVE]}getDefaults(){return Object.assign(super.getDefaults(),{mappings:[]})}addMapping(s){return this.addRef("mappings",s)}removeMapping(s){return this.removeRef("mappings",s)}listMappings(){return this.listRefs("mappings")}}PB.EXTENSION_NAME="KHR_materials_variants";class e2 extends Ku{init(){this.extensionName="KHR_materials_variants",this.propertyType="Variant",this.parentTypes=["MappingList"]}}e2.EXTENSION_NAME="KHR_materials_variants";const gy="KHR_materials_variants";class DB extends Tu{constructor(...s){super(...s),this.extensionName=gy}createMappingList(){return new PB(this.document.getGraph())}createVariant(s=""){return new e2(this.document.getGraph(),s)}createMapping(){return new IB(this.document.getGraph())}listVariants(){return Array.from(this.properties).filter(s=>s instanceof e2)}read(s){const o=s.jsonDoc;if(!o.json.extensions||!o.json.extensions[gy])return this;const a=(o.json.extensions[gy].variants||[]).map(_e=>this.createVariant().setName(_e.name||""));return(o.json.meshes||[]).forEach((_e,rt)=>{const nt=s.meshes[rt];(_e.primitives||[]).forEach((ot,ct)=>{if(!ot.extensions||!ot.extensions[gy])return;const pt=this.createMappingList(),ht=ot.extensions[gy];for(const _t of ht.mappings){const Et=this.createMapping();_t.material!==void 0&&Et.setMaterial(s.materials[_t.material]);for(const St of _t.variants||[])Et.addVariant(a[St]);pt.addMapping(Et)}nt.listPrimitives()[ct].setExtension(gy,pt)})}),this}write(s){const o=s.jsonDoc,a=this.listVariants();if(!a.length)return this;const _e=[],rt=new Map;for(const nt of a)rt.set(nt,_e.length),_e.push(s.createPropertyDef(nt));for(const nt of this.document.getRoot().listMeshes()){const ot=s.meshIndexMap.get(nt);nt.listPrimitives().forEach((ct,pt)=>{const ht=ct.getExtension(gy);if(!ht)return;const _t=s.jsonDoc.json.meshes[ot].primitives[pt],Et=ht.listMappings().map(St=>{const Mt=s.createPropertyDef(St),It=St.getMaterial();return It&&(Mt.material=s.materialIndexMap.get(It)),Mt.variants=St.listVariants().map(Nt=>rt.get(Nt)),Mt});_t.extensions=_t.extensions||{},_t.extensions[gy]={mappings:Et}})}return o.json.extensions=o.json.extensions||{},o.json.extensions[gy]={variants:_e},this}}DB.EXTENSION_NAME=gy;const{G:nN}=Yu;class BB extends Ku{init(){this.extensionName="KHR_materials_volume",this.propertyType="Volume",this.parentTypes=[ss.MATERIAL]}getDefaults(){return Object.assign(super.getDefaults(),{thicknessFactor:0,thicknessTexture:null,thicknessTextureInfo:new yu(this.graph,"thicknessTexture"),attenuationDistance:1/0,attenuationColor:[1,1,1]})}getThicknessFactor(){return this.get("thicknessFactor")}setThicknessFactor(s){return this.set("thicknessFactor",s)}getThicknessTexture(){return this.getRef("thicknessTexture")}getThicknessTextureInfo(){return this.getRef("thicknessTexture")?this.getRef("thicknessTextureInfo"):null}setThicknessTexture(s){return this.setRef("thicknessTexture",s,{channels:nN})}getAttenuationDistance(){return this.get("attenuationDistance")}setAttenuationDistance(s){return this.set("attenuationDistance",s)}getAttenuationColor(){return this.get("attenuationColor")}setAttenuationColor(s){return this.set("attenuationColor",s)}getAttenuationColorHex(){return dv.factorToHex(this.getAttenuationColor())}setAttenuationColorHex(s){const o=this.getAttenuationColor().slice();return this.set("attenuationColor",dv.hexToFactor(s,o))}}BB.EXTENSION_NAME="KHR_materials_volume";const GR="KHR_materials_volume";class kB extends Tu{constructor(...s){super(...s),this.extensionName=GR}createVolume(){return new BB(this.document.getGraph())}read(s){const o=s.jsonDoc,a=o.json.textures||[];return(o.json.materials||[]).forEach((_e,rt)=>{if(_e.extensions&&_e.extensions.KHR_materials_volume){const nt=this.createVolume();s.materials[rt].setExtension(GR,nt);const ot=_e.extensions.KHR_materials_volume;if(ot.thicknessFactor!==void 0&&nt.setThicknessFactor(ot.thicknessFactor),ot.attenuationDistance!==void 0&&nt.setAttenuationDistance(ot.attenuationDistance),ot.attenuationColor!==void 0&&nt.setAttenuationColor(ot.attenuationColor),ot.thicknessTexture!==void 0){const ct=ot.thicknessTexture;nt.setThicknessTexture(s.textures[a[ct.index].source]),s.setTextureInfo(nt.getThicknessTextureInfo(),ct)}}}),this}write(s){const o=s.jsonDoc;return this.document.getRoot().listMaterials().forEach(a=>{const _e=a.getExtension(GR);if(_e){const rt=s.materialIndexMap.get(a),nt=o.json.materials[rt];nt.extensions=nt.extensions||{};const ot=nt.extensions.KHR_materials_volume={};if(_e.getThicknessFactor()>0&&(ot.thicknessFactor=_e.getThicknessFactor()),Number.isFinite(_e.getAttenuationDistance())&&(ot.attenuationDistance=_e.getAttenuationDistance()),ku.eq(_e.getAttenuationColor(),[1,1,1])||(ot.attenuationColor=_e.getAttenuationColor()),_e.getThicknessTexture()){const ct=_e.getThicknessTexture(),pt=_e.getThicknessTextureInfo();ot.thicknessTexture=s.createTextureInfoDef(ct,pt)}}}),this}}kB.EXTENSION_NAME=GR;const OB="KHR_mesh_quantization";class LB extends Tu{constructor(...s){super(...s),this.extensionName=OB}read(s){return this}write(s){return this}}LB.EXTENSION_NAME=OB;const NB="KHR_texture_basisu";class iN{match(s){return s[0]===171&&s[1]===75&&s[2]===84&&s[3]===88&&s[4]===32&&s[5]===50&&s[6]===48&&s[7]===187&&s[8]===13&&s[9]===10&&s[10]===26&&s[11]===10}getSize(s){const o=JP(s);return[o.pixelWidth,o.pixelHeight]}getChannels(s){const o=JP(s).dataFormatDescriptor[0];if(o.colorModel===163)return o.samples.length===2&&(15&o.samples[1].channelType)==15?4:3;if(o.colorModel===166)return(15&o.samples[0].channelType)==3?4:3;throw new Error(`Unexpected KTX2 colorModel, "${o.colorModel}".`)}getGPUByteLength(s){const o=JP(s),a=this.getChannels(s)>3;let _e=0;for(let rt=0;rt<o.levels.length;rt++){const nt=o.levels[rt];_e+=nt.uncompressedByteLength?nt.uncompressedByteLength:Math.max(1,Math.floor(o.pixelWidth/Math.pow(2,rt)))/4*(Math.max(1,Math.floor(o.pixelHeight/Math.pow(2,rt)))/4)*(a?16:8)}return _e}}class FB extends Tu{constructor(...s){super(...s),this.extensionName=NB,this.prereadTypes=[ss.TEXTURE]}static register(){pA.registerFormat("image/ktx2",new iN)}preread(s){return s.jsonDoc.json.textures.forEach(o=>{o.extensions&&o.extensions.KHR_texture_basisu&&(o.source=o.extensions.KHR_texture_basisu.source)}),this}read(s){return this}write(s){const o=s.jsonDoc;return this.document.getRoot().listTextures().forEach(a=>{if(a.getMimeType()==="image/ktx2"){const _e=s.imageIndexMap.get(a);o.json.textures.forEach(rt=>{rt.source===_e&&(rt.extensions=rt.extensions||{},rt.extensions.KHR_texture_basisu={source:rt.source},delete rt.source)})}}),this}}FB.EXTENSION_NAME=NB;class UB extends Ku{init(){this.extensionName="KHR_texture_transform",this.propertyType="Transform",this.parentTypes=[ss.TEXTURE_INFO]}getDefaults(){return Object.assign(super.getDefaults(),{offset:[0,0],rotation:0,scale:[1,1],texCoord:null})}getOffset(){return this.get("offset")}setOffset(s){return this.set("offset",s)}getRotation(){return this.get("rotation")}setRotation(s){return this.set("rotation",s)}getScale(){return this.get("scale")}setScale(s){return this.set("scale",s)}getTexCoord(){return this.get("texCoord")}setTexCoord(s){return this.set("texCoord",s)}}UB.EXTENSION_NAME="KHR_texture_transform";const QR="KHR_texture_transform";class $B extends Tu{constructor(...s){super(...s),this.extensionName=QR}createTransform(){return new UB(this.document.getGraph())}read(s){for(const[o,a]of Array.from(s.textureInfos.entries())){if(!a.extensions||!a.extensions.KHR_texture_transform)continue;const _e=this.createTransform(),rt=a.extensions.KHR_texture_transform;rt.offset!==void 0&&_e.setOffset(rt.offset),rt.rotation!==void 0&&_e.setRotation(rt.rotation),rt.scale!==void 0&&_e.setScale(rt.scale),rt.texCoord!==void 0&&_e.setTexCoord(rt.texCoord),o.setExtension(QR,_e)}return this}write(s){const o=Array.from(s.textureInfoDefMap.entries());for(const[a,_e]of o){const rt=a.getExtension(QR);if(!rt)continue;_e.extensions=_e.extensions||{};const nt={},ot=ku.eq;ot(rt.getOffset(),[0,0])||(nt.offset=rt.getOffset()),rt.getRotation()!==0&&(nt.rotation=rt.getRotation()),ot(rt.getScale(),[1,1])||(nt.scale=rt.getScale()),rt.getTexCoord()!=null&&(nt.texCoord=rt.getTexCoord()),_e.extensions.KHR_texture_transform=nt}return this}}$B.EXTENSION_NAME=QR;const sN=[ss.ROOT,ss.SCENE,ss.NODE,ss.MESH,ss.MATERIAL,ss.TEXTURE,ss.ANIMATION];class jB extends Ku{init(){this.extensionName="KHR_xmp_json_ld",this.propertyType="Packet",this.parentTypes=sN}getDefaults(){return Object.assign(super.getDefaults(),{context:{},properties:{}})}getContext(){return this.get("context")}setContext(s){return this.set("context",Sw({},s))}listProperties(){return Object.keys(this.get("properties"))}getProperty(s){const o=this.get("properties");return s in o?o[s]:null}setProperty(s,o){this._assertContext(s);const a=Sw({},this.get("properties"));return o?a[s]=o:delete a[s],this.set("properties",a)}toJSONLD(){return Sw({"@context":t2(this.get("context"))},t2(this.get("properties")))}fromJSONLD(s){const o=(s=t2(s))["@context"];return o&&this.set("context",o),delete s["@context"],this.set("properties",s)}_assertContext(s){if(!(s.split(":")[0]in this.get("context")))throw new Error(`KHR_xmp_json_ld: Missing context for term, "${s}".`)}}function t2(tt){return JSON.parse(JSON.stringify(tt))}jB.EXTENSION_NAME="KHR_xmp_json_ld";const r2="KHR_xmp_json_ld";class zB extends Tu{constructor(...s){super(...s),this.extensionName=r2}createPacket(){return new jB(this.document.getGraph())}listPackets(){return Array.from(this.properties)}read(s){var o;const a=(o=s.jsonDoc.json.extensions)==null?void 0:o.KHR_xmp_json_ld;if(!a||!a.packets)return this;const _e=s.jsonDoc.json,rt=this.document.getRoot(),nt=a.packets.map(pt=>this.createPacket().fromJSONLD(pt)),ot=[[_e.asset],_e.scenes,_e.nodes,_e.meshes,_e.materials,_e.images,_e.animations],ct=[[rt],rt.listScenes(),rt.listNodes(),rt.listMeshes(),rt.listMaterials(),rt.listTextures(),rt.listAnimations()];for(let pt=0;pt<ot.length;pt++){const ht=ot[pt]||[];for(let _t=0;_t<ht.length;_t++){const Et=ht[_t];Et.extensions&&Et.extensions.KHR_xmp_json_ld&&ct[pt][_t].setExtension(r2,nt[Et.extensions.KHR_xmp_json_ld.packet])}}return this}write(s){const{json:o}=s.jsonDoc,a=[];for(const _e of this.properties){a.push(_e.toJSONLD());for(const rt of _e.listParents()){let nt;switch(rt.propertyType){case ss.ROOT:nt=o.asset;break;case ss.SCENE:nt=o.scenes[s.sceneIndexMap.get(rt)];break;case ss.NODE:nt=o.nodes[s.nodeIndexMap.get(rt)];break;case ss.MESH:nt=o.meshes[s.meshIndexMap.get(rt)];break;case ss.MATERIAL:nt=o.materials[s.materialIndexMap.get(rt)];break;case ss.TEXTURE:nt=o.images[s.imageIndexMap.get(rt)];break;case ss.ANIMATION:nt=o.animations[s.animationIndexMap.get(rt)];break;default:nt=null,this.document.getLogger().warn(`[KHR_xmp_json_ld]: Unsupported parent property, "${rt.propertyType}"`)}nt&&(nt.extensions=nt.extensions||{},nt.extensions.KHR_xmp_json_ld={packet:a.length-1})}}return a.length>0&&(o.extensions=o.extensions||{},o.extensions.KHR_xmp_json_ld={packets:a}),this}}zB.EXTENSION_NAME=r2;const oN=[mT,sB,uB,dB,hB,mB,bB,SB,xB,TB,RB,DB,kB,LB,FB,$B,zB];let n2=class extends na{constructor(tt,s,o){super(tt,s,o??new aN,new ys(0,0,0),1),this.enabled=!0,this._firstCall=!0}render(tt,s,o,a,_e){this.enabled&&super.render(tt,s,o,a,_e)}};n2=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt}([Ao("High precision Normal Buffer")],n2);class aN extends et.RSm{constructor(){super()}onBeforeRender(s,o,a,_e,rt){var nt,ot;let ct=rt.material;Array.isArray(ct)&&(ct=ct[0]),this.normalMap=(nt=ct==null?void 0:ct.normalMap)!==null&&nt!==void 0?nt:null,this.needsUpdate=!0,this.side=(ot=ct.side)!==null&&ot!==void 0?ot:et.ehD}}class lS extends Mv{constructor(s=!0){super(),this.passId="normalBuffer",this._beforeFilters=["render"],this._afterFilters=[],this._requiredFilters=["render"],this.enabled=s}passCtor(s){this._normalTarget=s.renderer.createTarget({depthBuffer:!0,type:et.cLu,minFilter:et.TyD,magFilter:et.TyD,generateMipmaps:!1}),this._normalTarget.texture.name="normalBuffer",this._normalTarget.texture.generateMipmaps=!1;const o=this._normalTarget,a=new Set,_e=new Set;return new class extends n2{render(rt,nt,ot,ct,pt){const ht=rt.getRenderTarget(),_t=rt.getActiveCubeFace(),Et=rt.getActiveMipmapLevel();this.scene&&(this.scene.traverse(({material:St})=>{St&&((St.transparent&&St.userData.renderToDepth||!St.transparent&&St.transmission===0&&St.userData.renderToDepth===!1)&&(a.add(St),St.transparent=!St.transparent),Math.abs(St.transmission||0)>0&&St.userData.renderToDepth&&(_e.add([St,St.transmission]),St.transmission=0))}),jn(rt,{shadowMapRender:!1,backgroundRender:!1,opaqueRender:!0,transparentRender:!1,transmissionRender:!1,mainRenderPass:!1},()=>super.render(rt,nt,o,ct,pt)),a.forEach(St=>St.transparent=!St.transparent),a.clear(),_e.forEach(([St,Mt])=>St.transmission=Mt),_e.clear(),rt.setRenderTarget(ht,_t,Et))}}}_update(s){if(!super._update(s))return!1;const o=this.pass.passObject;return o.scene=s.scene.modelObject,o.camera=s.scene.activeCamera.cameraObject,!0}getNormalBuffer(){return this._normalTarget}async onDispose(s){}async onRemove(s){var o,a;return s.renderer.disposeTarget((a=(o=this._normalTarget)===null||o===void 0?void 0:o.dispose)===null||a===void 0?void 0:a.call(o)),super.onRemove(s)}updateShaderProperties(s){var o,a;return s.uniforms.tNormalBuffer?s.uniforms.tNormalBuffer.value=this.enabled&&(a=(o=this.getNormalBuffer())===null||o===void 0?void 0:o.texture)!==null&&a!==void 0?a:null:console.warn("BaseRenderer: no uniform: tNormalBuffer"),this}get uiConfig(){var s;return(s=this.pass)===null||s===void 0?void 0:s.passObject.uiConfig}}lS.PluginType="NormalBufferPlugin";function VB(tt){const s=tt==null?void 0:tt.userData;if(!s)return!1;s._ssBevel||(s._ssBevel={});const o=s._ssBevel;return o.hasSSBevel=!0,o.radius===void 0&&(o.radius=0),tt.isMaterial&&(tt.needsUpdate=!0),!0}let i2=class extends Ru{constructor(tt,s,o,a){super({defines:{NUM_SAMPLES:16},uniforms:{tNormalDepth:{value:null},tNormalBuffer:{value:null},tGBufferFlags:{value:null},edgeMaskBuffer:{value:null},screenSize:{value:new et.FM8},radius:{value:1},samples:{value:null},frameCount:{value:0},cameraPositionWorld:{value:new et.Pa4(1,1,1)}},vertexShader:Iv,fragmentShader:`

            ${o}

            ${Pv}

            uniform sampler2D tNormalBuffer;uniform sampler2D edgeMaskBuffer;uniform vec2 screenSize;const float depthStep=0.02;uniform vec2 samples[NUM_SAMPLES];uniform vec3 cameraPositionWorld;varying vec2 vUv;
#include <common>
vec3 smoothNormal(){vec2 uv=gl_FragCoord.xy/screenSize;vec4 texel=texture2D(tNormalDepth,uv);vec4 edgeMask=texture2D(edgeMaskBuffer,uv);vec3 avgNormal=2.*texture2D(tNormalBuffer,uv).rgb-1.;float depth=pow(unpack16(texel.xy),2.);vec2 invScreenSize=vec2(1.)/screenSize;vec4 mask=texture2D(tGBufferFlags,uv);float weightSum=0.;float radius=mask.g*255.*2.;float randomAngle=6.2*random(frameCount*0.1);float theta=randomAngle;float snTheta=sin(theta);float csTheta=cos(theta);mat2 randomRotationMatrix=mat2(csTheta,snTheta,-snTheta,csTheta);float d_=dot(cameraPositionWorld,cameraPositionWorld);float radiusModifier=clamp(1./(1.+pow(d_,0.5)),0.,1.);for(int i=0;i<5;i++){float x=float(i)-2.;for(int j=0;j<5;j++){float y=float(j)-2.;vec2 offset=randomRotationMatrix*vec2(x,y)*radius*radiusModifier*invScreenSize;vec4 texel=texture2D(tNormalDepth,uv+offset);float offsetDepth=pow(unpack16(texel.xy),2.);float depthWeight=abs(offsetDepth-depth);depthWeight=(1.-step(depthStep,depthWeight));vec3 offsetNormal=2.*texture2D(tNormalBuffer,uv+offset).rgb-1.;if(dot(offsetNormal,offsetNormal)>0.){avgNormal+=offsetNormal*depthWeight;}}}return normalize(avgNormal);}void main(){vec2 uv=gl_FragCoord.xy/screenSize;vec4 edgeMask=texture2D(edgeMaskBuffer,uv);vec3 normal=vec3(0.);if(edgeMask.x>0.){normal=smoothNormal();}else{normal=2.*texture2D(tNormalBuffer,uv).rgb-1.;}gl_FragColor=vec4(vec3(0.5*normal+0.5),1.);}
            
            `},"tDiffuse"),this.uiConfig=void 0,this.materialExtension={shaderExtender:(_e,rt,nt)=>{var ot,ct;this.enabled&&(!((ct=(ot=rt.materialObject.userData)===null||ot===void 0?void 0:ot._ssBevel)===null||ct===void 0)&&ct.hasSSBevel)&&(_e.fragmentShader=Wl(_e.fragmentShader,"#include <normal_fragment_maps>",` 
                normal = 2. * texture2D(tSSBevelMap, viewToScreen(vViewPosition.xyz).xy).rgb - 1.;
                normal = normalize(normal);
                //geometryNormal = normal;
            `))},onObjectRender:(_e,rt,nt)=>{var ot,ct;if(!this.enabled||!(!((ct=(ot=rt.materialObject.userData)===null||ot===void 0?void 0:ot._ssBevel)===null||ct===void 0)&&ct.hasSSBevel))return;const pt=rt.materialObject,ht=this._target.texture;this.materialExtension.extraUniforms.tSSBevelMap.value!==ht&&(this.materialExtension.extraUniforms.tSSBevelMap.value=ht,pt.needsUpdate=!0)},getUiConfig:_e=>{const rt={type:"folder",label:"SSBevel (Dev)",children:[{type:"checkbox",label:"Enabled",get value(){var nt;return((nt=_e.materialObject.userData._ssBevel)===null||nt===void 0?void 0:nt.hasSSBevel)||!1},set value(nt){var ot,ct;nt!==((ot=_e.materialObject.userData._ssBevel)===null||ot===void 0?void 0:ot.hasSSBevel)&&(nt?VB(_e.materialObject)||alert("Cannot add screen space bevel."):(_e.materialObject.userData._ssBevel.hasSSBevel=!1,_e.materialObject.needsUpdate=!0),(ct=rt.uiRefresh)===null||ct===void 0||ct.call(rt,"postFrame",!0))},onChange:this.setDirty},()=>({type:"slider",bounds:[0,8],label:"radius",hidden:()=>{var nt;return!(!((nt=_e.materialObject.userData._ssBevel)===null||nt===void 0)&&nt.hasSSBevel)},property:[_e.materialObject.userData._ssBevel,"radius"],onChange:this.setDirty})]};return rt},parsFragmentSnippet:(_e,rt)=>{var nt,ot;return this.enabled&&(!((ot=(nt=rt==null?void 0:rt.materialObject.userData)===null||nt===void 0?void 0:nt._ssBevel)===null||ot===void 0)&&ot.hasSSBevel)?Wt`
            uniform sampler2D tSSBevelMap;
            ${Gx}
            `:""},extraUniforms:{tSSBevelMap:{value:null}},computeCacheKey:_e=>{var rt,nt;return(this.enabled?"1":"0")+(!((nt=(rt=_e.materialObject.userData)===null||rt===void 0?void 0:rt._ssBevel)===null||nt===void 0)&&nt.hasSSBevel?"1":"0")},isCompatible:_e=>_e.isMeshStandardMaterial2},this._target=s,this.needsSwap=!1,this.clear=!0,this._viewerApp=a,this._edgeMaterial=new L_({uniforms:{tNormalDepth:{value:null},tNormalBuffer:{value:null},tGBufferFlags:{value:null},screenSize:{value:null},radius:{value:10},cameraNearFar:{value:new et.FM8(1,1)},cameraPositionWorld:{value:new et.Pa4(1,1,1)}},vertexShader:Iv,fragmentShader:"uniform vec2 screenSize;uniform sampler2D tNormalDepth;uniform sampler2D tNormalBuffer;uniform sampler2D tGBufferFlags;uniform float radius;uniform vec2 cameraNearFar;uniform vec3 cameraPositionWorld;const float depthStep=0.2;const float normalThreshold=0.9;float unpack16(vec2 value){return(value.x*0.996108949416342426275150501169264316558837890625+value.y*0.00389105058365758760263730664519243873655796051025390625);}vec3 unpackNormal(vec2 enc){vec2 fenc=enc*4.-2.;float f=dot(fenc,fenc);float g=sqrt(1.-f/4.);return vec3(fenc*g,1.-f/2.);}void lookupNormalDepth(out float depth,out vec3 normal,vec2 off){vec2 uv=(gl_FragCoord.st+off)/screenSize;vec4 texel=texture2D(tNormalDepth,uv);depth=mix(cameraNearFar.x,cameraNearFar.y,pow(unpack16(texel.xy),2.));normal=2.*texture2D(tNormalBuffer,uv).rgb-1.;}float getBorderWeight(){float depth1,depth2,depth3,depth4;vec3 normal1,normal2,normal3,normal4;float d_=dot(cameraPositionWorld,cameraPositionWorld);float radiusModifier=clamp(3./(1.+pow(d_,0.5)),0.,1.);float modRad=radius;lookupNormalDepth(depth1,normal1,vec2(0.,modRad));lookupNormalDepth(depth2,normal2,vec2(0.,-modRad));lookupNormalDepth(depth3,normal3,vec2(modRad,0.));lookupNormalDepth(depth4,normal4,vec2(-modRad,0.));vec2 uv=(gl_FragCoord.st)/screenSize;float mask=step(0.0001,texture2D(tGBufferFlags,uv).g);float mask1=texture2D(tGBufferFlags,uv+vec2(0.,modRad)/screenSize).b*255.;float mask2=texture2D(tGBufferFlags,uv+vec2(0.,-modRad)/screenSize).b*255.;float mask3=texture2D(tGBufferFlags,uv+vec2(modRad,0.)/screenSize).b*255.;float mask4=texture2D(tGBufferFlags,uv+vec2(-modRad,0.)/screenSize).b*255.;float maskWeight=max(abs(mask1-mask2),abs(mask3-mask4))*255.;maskWeight=(step(maskWeight,0.01));float a1=dot(normal1,normal2);float a2=dot(normal3,normal4);float normalWeight=min(abs(a1),abs(a2));normalWeight=1.-step(normalThreshold,normalWeight);float depthWeight=max(abs(depth1-depth2),abs(depth3-depth4));depthWeight=(step(depthWeight,depthStep));return normalWeight*depthWeight*maskWeight*mask;}void main(){float weight=getBorderWeight();vec2 uv=gl_FragCoord.st/screenSize;vec4 texel=texture2D(tNormalDepth,uv);float depth=pow(unpack16(texel.xy),2.);vec3 outColor=vec3(0.);if(depth>0.999){weight=0.;}else{outColor=vec3(weight);}gl_FragColor=vec4(outColor,1.);}"}),this._separableBlurMaterial=new L_({defines:{KERNEL_RADIUS:3,SIGMA:3},uniforms:{colorTexture:{value:null},maskTexture:{value:null},texSize:{value:new et.FM8(.5,.5)},direction:{value:new et.FM8(.5,.5)}},vertexShader:Iv,fragmentShader:"varying vec2 vUv;uniform sampler2D colorTexture;uniform sampler2D maskTexture;uniform vec2 texSize;uniform vec2 direction;float gaussianPdf(in float x,in float sigma){return 0.39894*exp(-0.5*x*x/(sigma*sigma))/sigma;}void main(){vec2 invSize=1./texSize;float fSigma=float(SIGMA);float weightSum=gaussianPdf(0.,fSigma);vec4 mask=texture2D(maskTexture,vUv);vec3 diffuseSum=texture2D(colorTexture,vUv).rgb*weightSum;for(int i=1;i<KERNEL_RADIUS;i++){float x=float(i);float w=gaussianPdf(x,fSigma);vec2 uvOffset=direction*invSize*x;vec3 sample1=texture2D(colorTexture,vUv+uvOffset).rgb;vec3 sample2=texture2D(colorTexture,vUv-uvOffset).rgb;diffuseSum+=(sample1+sample2)*w;weightSum+=2.*w;}gl_FragColor=vec4(diffuseSum/weightSum,1.);}"})}render(tt,s,o,a,_e){var rt,nt;if(!this.enabled)return;const ot=tt.baseRenderer,ct={minFilter:et.wem,magFilter:et.wem,isAntialiased:!1,format:et.wk1,depthBuffer:!1,generateMipmaps:!1},pt=ot.getTempTarget(ct);this._renderEdges(ot,pt),this._blurEdges(ot,pt),this._viewerApp.scene.activeCamera.updateShaderProperties(this.material),(rt=this._viewerApp.getPlugin(Dl))===null||rt===void 0||rt.updateShaderProperties(this.material),(nt=this._viewerApp.getPlugin(lS))===null||nt===void 0||nt.updateShaderProperties(this.material),this._viewerApp.renderer.updateShaderProperties(this.material),this.uniforms.edgeMaskBuffer.value=pt.texture,super.render(tt,this._target,pt,a,_e),ot.releaseTempTarget(pt)}_initsamples(){const tt=[];return tt.push(new et.FM8(-8,0).multiplyScalar(.125)),tt.push(new et.FM8(-6,-4).multiplyScalar(.125)),tt.push(new et.FM8(-3,-2).multiplyScalar(.125)),tt.push(new et.FM8(-2,-6).multiplyScalar(.125)),tt.push(new et.FM8(1,-1).multiplyScalar(.125)),tt.push(new et.FM8(2,-5).multiplyScalar(.125)),tt.push(new et.FM8(6,-7).multiplyScalar(.125)),tt.push(new et.FM8(5,-3).multiplyScalar(.125)),tt.push(new et.FM8(4,1).multiplyScalar(.125)),tt.push(new et.FM8(7,4).multiplyScalar(.125)),tt.push(new et.FM8(3,5).multiplyScalar(.125)),tt.push(new et.FM8(0,7).multiplyScalar(.125)),tt.push(new et.FM8(-1,3).multiplyScalar(.125)),tt.push(new et.FM8(-4,6).multiplyScalar(.125)),tt.push(new et.FM8(-7,8).multiplyScalar(.125)),tt.push(new et.FM8(-5,2).multiplyScalar(.125)),tt}_blurEdges(tt,s){var o,a;const _e={minFilter:et.wem,magFilter:et.wem,isAntialiased:!1,format:et.wk1,depthBuffer:!1,generateMipmaps:!1,sizeMultiplier:.5},rt=tt.getTempTarget(_e),nt=((o=s.texture.image)===null||o===void 0?void 0:o.width)||1,ot=((a=s.texture.image)===null||a===void 0?void 0:a.height)||1;this._separableBlurMaterial.uniforms.texSize.value=new et.FM8(nt,ot),this._separableBlurMaterial.uniforms.colorTexture.value=s.texture,this._separableBlurMaterial.uniforms.direction.value=new et.FM8(1,0),tt.blit(void 0,rt,{material:this._separableBlurMaterial}),this._separableBlurMaterial.uniforms.texSize.value=new et.FM8(nt/2,ot/2),this._separableBlurMaterial.uniforms.colorTexture.value=rt.texture,this._separableBlurMaterial.uniforms.direction.value=new et.FM8(0,1),tt.blit(void 0,s,{material:this._separableBlurMaterial}),tt.releaseTempTarget(rt)}_renderEdges(tt,s){var o,a,_e,rt;const nt=((o=s.texture.image)===null||o===void 0?void 0:o.width)||1,ot=((a=s.texture.image)===null||a===void 0?void 0:a.height)||1;this._edgeMaterial.uniforms.screenSize.value=new et.FM8(nt,ot),this._viewerApp.scene.activeCamera.updateShaderProperties(this._edgeMaterial),(_e=this._viewerApp.getPlugin(Dl))===null||_e===void 0||_e.updateShaderProperties(this._edgeMaterial),(rt=this._viewerApp.getPlugin(lS))===null||rt===void 0||rt.updateShaderProperties(this._edgeMaterial),tt.blit(void 0,s,{material:this._edgeMaterial})}};i2=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt}([Ao("SSBevel")],i2);class Cw extends Mv{constructor(s=!0){super(),this.passId="ssBevel",this._beforeFilters=["render"],this._afterFilters=["gbuffer","normalBuffer"],this._requiredFilters=["render","gbuffer","normalBuffer"],this._lastEnabled=!1,this.dependencies=[os,Dl,lS],this.enabled=s,this.setDirty=this.setDirty.bind(this),this._loaderCreate=this._loaderCreate.bind(this)}get bevelTarget(){return this._bevelTarget}_loaderCreate({loader:s}){s.isGLTFLoader2&&s.register(o=>new lN(o))}passCtor(s){var o,a;this._bevelTarget=s.renderer.createTarget({depthBuffer:!0,type:et.cLu,minFilter:et.TyD,magFilter:et.TyD,generateMipmaps:!1}),this._bevelTarget.texture.name="bevelBuffer",this._bevelTarget.texture.generateMipmaps=!1;const _e=s.getPluginByType("debug");return _e&&_e.addTexture("tempBuffer",()=>this._bevelTarget.texture,[440,50,400,200]),new i2(s.renderer,this._bevelTarget,(a=(o=s.getPlugin(Dl))===null||o===void 0?void 0:o.getUnpackSnippet())!==null&&a!==void 0?a:"",s)}async onAdded(s){var o,a,_e,rt,nt,ot,ct;await super.onAdded(s);const pt=s.getPlugin(os);return!((o=this.pass)===null||o===void 0)&&o.passObject.materialExtension&&((a=pt==null?void 0:pt.materials)===null||a===void 0||a.registerMaterialExtension((_e=this.pass)===null||_e===void 0?void 0:_e.passObject.materialExtension)),(rt=pt==null?void 0:pt.importer)===null||rt===void 0||rt.addEventListener("loaderCreate",this._loaderCreate),(ct=(ot=(nt=pt==null?void 0:pt.exporter)===null||nt===void 0?void 0:nt.getExporter("gltf","glb"))===null||ot===void 0?void 0:ot.extensions)===null||ct===void 0||ct.push(uN),super.onAdded(s)}async onRemove(s){return s.renderer.disposeTarget(this._bevelTarget),super.onRemove(s)}setDirty(){var s,o,a,_e;(s=this._viewer)===null||s===void 0||s.setDirty(),(_e=(o=this.pass)===null||o===void 0?void 0:(a=o.passObject.materialExtension).setDirty)===null||_e===void 0||_e.call(a)}_update(s){var o;let a=this.enabled;if(a&&!this._lastEnabled){const _e=(o=this._viewer)===null||o===void 0?void 0:o.getPluginByType("NormalBufferPlugin");confirm("SS Bevel Plugin needs to enable NormalBufferPlugin. Enable now?")?_e.enabled=!0:(this.enabled=!1,_e.enabled=!1,a=!1)}return this._lastEnabled=a,a}get uiConfig(){var s,o,a,_e,rt;const nt=(a=(o=(s=this.pass)===null||s===void 0?void 0:s.passObject)===null||o===void 0?void 0:o.uiConfig)!==null&&a!==void 0?a:{};return(rt=(_e=nt.children)===null||_e===void 0?void 0:_e.map(ot=>er(ot)))===null||rt===void 0||rt.flat(2).forEach(ot=>ot&&(ot.onChange=this.setDirty)),nt}}Cw.PluginType="SSBevelPlugin",Cw.SSBEVEL_GLTF_EXTENSION="WEBGI_materials_ssbevel";class lN{constructor(s){this.parser=s,this.name=Cw.SSBEVEL_GLTF_EXTENSION}async extendMaterialParams(s,o){const a=this.parser.json.materials[s];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();const _e=a.extensions[this.name];return o.userData||(o.userData={}),VB(o),o.userData._ssBevel=In(_e,o.userData._ssBevel,!1,{}),Promise.resolve()}}const uN=tt=>({writeMaterial:(s,o)=>{if(!s.isMeshStandardMaterial||!s.userData._ssBevel||!s.userData._ssBevel.hasSSBevel)return;o.extensions=o.extensions||{};const a=rs(s.userData._ssBevel,!1);o.extensions[Cw.SSBEVEL_GLTF_EXTENSION]=a,tt.extensionsUsed[Cw.SSBEVEL_GLTF_EXTENSION]=!0}});class GB extends NP{constructor(s){super(),this._loadedLibs=!1,s=s||{method:mT.EncoderMethod.EDGEBREAKER,encodeSpeed:5},this._io=new PL().registerExtensions(oN).registerExtensions([QB,KR,qR,WR,YR,XR,JR,ZR,eI,tI,rI,nI,iI,sI,oI]),this._encoderOptions=s}preload(){return this._loadLibs(),this}async _loadLibs(){if(this._loadedLibs||!this.loader)return;const s=await Promise.all([this.loader.initEncoder(),this.loader.initDecoder()]);this._io.registerDependencies({"draco3d.encoder":s[0],"draco3d.decoder":s[1]}),this._loadedLibs=!0}async parseAsync(s,{compress:o=!1,...a}){if(!this.loader)return console.error("GLTFDracoExporter: No DRACOLoader2 instance provided"),super.parseAsync(s,a);await this._loadLibs();const _e={...a};o&&(_e.externalImagesInExtras=!0);const rt=await new Promise((_t,Et)=>this.parse(s,_t,Et,_e)),nt=await super.parseAsync(rt,_e);if(!o)return nt;if(!rt)throw new Error("GLTFDracoExporter: gltf is null");let ot=rt;const ct=ot.byteLength||1/0,pt=await(typeof ot!="object"||ot.byteLength?this._io.readBinary(new Uint8Array(ot)):this._io.readJSON({json:ot,resources:{}}));if(pt.createExtension(mT).setRequired(!0).setEncoderOptions(this._encoderOptions),_e.exportExt==="glb")ot=await this._io.writeBinary(pt),isFinite(ct)&&console.log("DRACO Compression ratio: "+(ot.byteLength/ct).toFixed(5));else{const _t=await this._io.writeJSON(pt);ot=_t.json,Object.values(_t.resources).filter(Et=>Et).length>0&&(console.warn("DRACOExporter: extra resources in resources not supported properly"),ot.resources=_t.resources)}ot.__isGLTFOutput=!0;const ht=await super.parseAsync(ot,_e);return ht.__uncompressed=nt,ht}}class s2 extends io{constructor(){super(...arguments),this.enabled=!0,this.dependencies=[os,uT]}async onAdded(s){await super.onAdded(s);const o=s.getManager().importer;if(!o)throw new Error("GLTFDracoExportPlugin: AssetImporter not found");(function(a,_e){FP(a,GB,rt=>{const nt=Mo()+".drc",ot=rt;ot.loader=_e.registerFile(nt),ot.loader.setDecoderConfig({type:"js"}),ot.loader.preload(!0,!0)})})(s,o)}}s2.PluginType="GLTFDracoExportPlugin";class cN extends Ku{constructor(){super(...arguments),this.extensionName=im,this.parentTypes=[ss.SCENE],this.propertyType="ViewerJSON"}init(){}}class QB extends Tu{constructor(){super(...arguments),this.extensionName=im,this._viewerConfig={},this._texturesRef=[],this.required=!0}read(s){var o;return this._viewerConfig={},(o=s.jsonDoc.json.scenes)===null||o===void 0||o.forEach((a,_e)=>{if(a.extensions&&a.extensions[im]){const rt=new cN(this.document.getGraph());s.scenes[_e].setExtension(im,rt);const nt=a.extensions[im];this._viewerConfig=nt}}),this}write(s){return this.document.getRoot().listScenes().forEach(o=>{var a;if(o.getExtension(im)){const _e=(a=s.jsonDoc.json.scenes)===null||a===void 0?void 0:a[s.jsonDoc.json.scene||0];_e&&this._viewerConfig!=={}&&(_e.extensions=_e.extensions||{},_e.extensions[im]=this._viewerConfig,this._texturesRef=[],this._viewerConfig={})}}),this}}QB.EXTENSION_NAME=im;class HR extends Ku{constructor(s,o,a){super(s,o),this.parentTypes=[ss.MATERIAL,ss.MESH,ss.NODE,ss.SCENE],this.propertyType="GenericExtension",this.textures={},this.extensionName=a}addTexture(s,o,a,_e=4369){this.setRef(s,a,{channels:_e}),this.textures[s]=[o,a]}copy(s,o=my){return super.copy(s,o),this}dispose(){Object.values(this.textures).forEach(([s,o])=>{s==null||s.dispose()}),super.dispose()}init(){}}class fv extends Tu{constructor(){super(...arguments),this.textureChannels={}}read(s){const o=s.jsonDoc,a=o.json.materials||[],_e=o.json.textures||[];return a.forEach((rt,nt)=>{var ot,ct;if(rt.extensions&&rt.extensions[this.extensionName]){const pt=new HR(this.document.getGraph(),"",this.extensionName);s.materials[nt].setExtension(this.extensionName,pt);const ht={...rt.extensions[this.extensionName]};for(const[_t,Et]of Object.entries(ht))if(typeof(Et==null?void 0:Et.index)=="number"){const St=Et,Mt=(ot=_e[St.index])===null||ot===void 0?void 0:ot.source;if(typeof Mt!="number"){console.warn("GLTF Pipeline: source texture not found for texture info",St);continue}const It=s.textures[Mt],Nt=new yu(this.document.getGraph()),Bt=(ct=this.textureChannels[_t])!==null&&ct!==void 0?ct:4369;pt.addTexture(_t,Nt,It,Bt),s.setTextureInfo(Nt,St),delete ht[_t]}pt.setExtras(ht)}}),(o.json.meshes||[]).forEach((rt,nt)=>{if(rt.extensions&&rt.extensions[this.extensionName]){const ot=new HR(this.document.getGraph(),"",this.extensionName);s.meshes[nt].setExtension(this.extensionName,ot);const ct=rt.extensions[this.extensionName];ot.setExtras(ct)}}),(o.json.nodes||[]).forEach((rt,nt)=>{if(rt.extensions&&rt.extensions[this.extensionName]){const ot=new HR(this.document.getGraph(),"",this.extensionName);s.nodes[nt].setExtension(this.extensionName,ot);const ct=rt.extensions[this.extensionName];ot.setExtras(ct)}}),(o.json.scenes||[]).forEach((rt,nt)=>{if(rt.extensions&&rt.extensions[this.extensionName]){const ot=new HR(this.document.getGraph(),"",this.extensionName);s.scenes[nt].setExtension(this.extensionName,ot);const ct=rt.extensions[this.extensionName];ot.setExtras(ct)}}),this}write(s){const o=s.jsonDoc;return this.document.getRoot().listMaterials().forEach(a=>{const _e=a.getExtension(this.extensionName);if(_e){const rt=s.materialIndexMap.get(a),nt=o.json.materials[rt];nt.extensions=nt.extensions||{};const ot={..._e.getExtras()};for(const[ct,pt]of Object.entries(_e.textures)){const ht=pt[0],_t=pt[1];_t&&(ot[ct]=s.createTextureInfoDef(_t,ht))}nt.extensions[this.extensionName]=ot}}),this.document.getRoot().listMeshes().forEach(a=>{const _e=a.getExtension(this.extensionName);if(_e){const rt=s.meshIndexMap.get(a),nt=o.json.meshes[rt];nt.extensions=nt.extensions||{},nt.extensions[this.extensionName]=_e.getExtras()}}),this.document.getRoot().listNodes().forEach(a=>{const _e=a.getExtension(this.extensionName);if(_e){const rt=s.nodeIndexMap.get(a),nt=o.json.nodes[rt];nt.extensions=nt.extensions||{},nt.extensions[this.extensionName]=_e.getExtras()}}),this.document.getRoot().listScenes().forEach(a=>{const _e=a.getExtension(this.extensionName);if(_e){const rt=s.jsonDoc.json.scene||0,nt=o.json.scenes[rt];if(!nt)return;nt.extensions=nt.extensions||{},nt.extensions[this.extensionName]=_e.getExtras()}}),this}}class qR extends fv{constructor(){super(...arguments),this.extensionName=qR.EXTENSION_NAME,this.textureChannels={bumpTexture:Yu.R}}}qR.EXTENSION_NAME=Tm;class WR extends fv{constructor(){super(...arguments),this.extensionName=WR.EXTENSION_NAME,this.textureChannels={lightMapTexture:Yu.R|Yu.G|Yu.B}}}WR.EXTENSION_NAME=Mm;class YR extends fv{constructor(){super(...arguments),this.extensionName=YR.EXTENSION_NAME,this.textureChannels={alphaTexture:Yu.G}}}YR.EXTENSION_NAME=Ev;class KR extends fv{constructor(){super(...arguments),this.extensionName=KR.EXTENSION_NAME}}KR.EXTENSION_NAME=ru.DIAMOND_GLTF_EXTENSION;class XR extends fv{constructor(){super(...arguments),this.extensionName=XR.EXTENSION_NAME}}XR.EXTENSION_NAME=Gl.AnimationMarkersExtension;class JR extends fv{constructor(){super(...arguments),this.extensionName=JR.EXTENSION_NAME,this.textureChannels={anisotropyDirection:Yu.R|Yu.G|Yu.B}}}JR.EXTENSION_NAME=Am.ANISOTROPY_GLTF_EXTENSION;class ZR extends fv{constructor(){super(...arguments),this.extensionName=ZR.EXTENSION_NAME,this.textureChannels={anisotropyDirection:Yu.R|Yu.G|Yu.B}}}ZR.EXTENSION_NAME=lp.CUSTOM_BUMP_MAP_GLTF_EXTENSION;class eI extends fv{constructor(){super(...arguments),this.extensionName=eI.EXTENSION_NAME}}eI.EXTENSION_NAME=Mr;class tI extends fv{constructor(){super(...arguments),this.extensionName=tI.EXTENSION_NAME}}tI.EXTENSION_NAME=wv;class rI extends fv{constructor(){super(...arguments),this.extensionName=rI.EXTENSION_NAME}}rI.EXTENSION_NAME=sm;class nI extends fv{constructor(){super(...arguments),this.extensionName=nI.EXTENSION_NAME}}nI.EXTENSION_NAME=rv.CLEARCOAT_TINT_GLTF_EXTENSION;class iI extends fv{constructor(){super(...arguments),this.extensionName=iI.EXTENSION_NAME}}iI.EXTENSION_NAME=km.THIN_FILM_LAYER_GLTF_EXTENSION;class sI extends fv{constructor(){super(...arguments),this.extensionName=sI.EXTENSION_NAME}}sI.EXTENSION_NAME=Cw.SSBEVEL_GLTF_EXTENSION;class oI extends fv{constructor(){super(...arguments),this.extensionName=oI.EXTENSION_NAME}}oI.EXTENSION_NAME=yp.NOISE_BUMP_MATERIAL_GLTF_EXTENSION;class HB extends it{constructor(){super(...arguments),this.processor={forAssetType:"texture",process:(s,o)=>s}}async onAdded(s){}async onDispose(s){}async onRemove(s){this._pmrem=void 0}}HB.PluginType="PMREMGenerator";const qB=new et.Pa4,dN=new et._fP,WB=new et.Pa4;class pN extends et.Tme{constructor(s=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=s,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(o){o.element instanceof Element&&o.element.parentNode!==null&&o.element.parentNode.removeChild(o.element)})})}copy(s,o){return super.copy(s,o),this.element=s.element.cloneNode(!0),this}}const vy=new et.yGw,hN=new et.yGw;class fN{constructor(s={}){const o=this;let a,_e,rt,nt;const ot={camera:{fov:0,style:""},objects:new WeakMap},ct=s.element!==void 0?s.element:document.createElement("div");ct.style.overflow="hidden",this.domElement=ct;const pt=document.createElement("div");function ht(Mt){return Math.abs(Mt)<1e-10?0:Mt}function _t(Mt){const It=Mt.elements;return"matrix3d("+ht(It[0])+","+ht(-It[1])+","+ht(It[2])+","+ht(It[3])+","+ht(It[4])+","+ht(-It[5])+","+ht(It[6])+","+ht(It[7])+","+ht(It[8])+","+ht(-It[9])+","+ht(It[10])+","+ht(It[11])+","+ht(It[12])+","+ht(-It[13])+","+ht(It[14])+","+ht(It[15])+")"}function Et(Mt){const It=Mt.elements;return"translate(-50%,-50%)matrix3d("+ht(It[0])+","+ht(It[1])+","+ht(It[2])+","+ht(It[3])+","+ht(-It[4])+","+ht(-It[5])+","+ht(-It[6])+","+ht(-It[7])+","+ht(It[8])+","+ht(It[9])+","+ht(It[10])+","+ht(It[11])+","+ht(It[12])+","+ht(It[13])+","+ht(It[14])+","+ht(It[15])+")"}function St(Mt,It,Nt,Bt){if(Mt.isCSS3DObject){const kt=Mt.visible===!0&&Mt.layers.test(Nt.layers)===!0;if(Mt.element.style.display=kt===!0?"":"none",kt===!0){let Pt;Mt.onBeforeRender(o,It,Nt),Mt.isCSS3DSprite?(vy.copy(Nt.matrixWorldInverse),vy.transpose(),Mt.rotation2D!==0&&vy.multiply(hN.makeRotationZ(Mt.rotation2D)),Mt.matrixWorld.decompose(qB,dN,WB),vy.setPosition(qB),vy.scale(WB),vy.elements[3]=0,vy.elements[7]=0,vy.elements[11]=0,vy.elements[15]=1,Pt=Et(vy)):Pt=Et(Mt.matrixWorld);const qt=Mt.element,Kt=ot.objects.get(Mt);if(Kt===void 0||Kt.style!==Pt){qt.style.transform=Pt;const nr={style:Pt};ot.objects.set(Mt,nr)}qt.parentNode!==pt&&pt.appendChild(qt),Mt.onAfterRender(o,It,Nt)}}for(let kt=0,Pt=Mt.children.length;kt<Pt;kt++)St(Mt.children[kt],It,Nt)}pt.style.transformStyle="preserve-3d",pt.style.pointerEvents="none",ct.appendChild(pt),this.getSize=function(){return{width:a,height:_e}},this.render=function(Mt,It){const Nt=It.projectionMatrix.elements[5]*nt;let Bt,kt;ot.camera.fov!==Nt&&(ct.style.perspective=It.isPerspectiveCamera?Nt+"px":"",ot.camera.fov=Nt),Mt.matrixWorldAutoUpdate===!0&&Mt.updateMatrixWorld(),It.parent===null&&It.matrixWorldAutoUpdate===!0&&It.updateMatrixWorld(),It.isOrthographicCamera&&(Bt=-(It.right+It.left)/2,kt=(It.top+It.bottom)/2);const Pt=It.isOrthographicCamera?"scale("+Nt+")translate("+ht(Bt)+"px,"+ht(kt)+"px)"+_t(It.matrixWorldInverse):"translateZ("+Nt+"px)"+_t(It.matrixWorldInverse),qt=Pt+"translate("+rt+"px,"+nt+"px)";ot.camera.style!==qt&&(pt.style.transform=qt,ot.camera.style=qt),St(Mt,Mt,It)},this.setSize=function(Mt,It){a=Mt,_e=It,rt=a/2,nt=_e/2,ct.style.width=Mt+"px",ct.style.height=It+"px",pt.style.width=Mt+"px",pt.style.height=It+"px"}}}var aI,lI=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let fA=aI=class extends io{constructor(tt=!0){super(),this._scene=new et.xsS,this.overCanvas=!0,this._trackers=[],this.attachIFrameToSelected=async()=>{var s,o,a,_e,rt;const nt=(o=(s=this._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0?void 0:o.getSelectedObject();if(!(nt!=null&&nt.geometry))return void await((a=this._viewer)===null||a===void 0?void 0:a.alert("No Geometry: Selected object must have a geometry to apply the iframe to"));const ot=await((_e=this._viewer)===null||_e===void 0?void 0:_e.prompt("URL: Enter the url for the webpage. (Make sure its allowed to be embedded in an iframe.)","https://webgi.xyz/",!1))||"https://webgi.pixotronics.com/";if(!ot)return;const ct=await((rt=this._viewer)===null||rt===void 0?void 0:rt.prompt("Width: Enter the width for the object.","512",!1))||"512";ct&&this.attachIFrame(nt,ot,parseInt(ct))},this._resizeObserver=new ResizeObserver(()=>{var s;this.enabled&&((s=this._viewer)===null||s===void 0||s.scene.setDirty({sceneUpdate:!0}))}),this.enabled=tt,this._refreshCanvasInDOM=this._refreshCanvasInDOM.bind(this),this._refreshEnabled=this._refreshEnabled.bind(this)}_refreshEnabled(){}_refreshCanvasInDOM(){const tt=this._viewer;tt&&this._renderer&&(tt.canvas.remove(),this.overCanvas?this._renderer.domElement.insertAdjacentElement("afterbegin",tt.canvas):this._renderer.domElement.appendChild(tt.canvas))}_initialize(){if(this._renderer||!this._viewer)return;this._renderer=new fN;const tt=this._viewer.renderer.rendererObject.getSize(new et.FM8);this._renderer.setSize(tt.width,tt.height);const s=document.createElement("div");s.style.position="absolute",s.style.top="0",s.style.zIndex="0",s.appendChild(this._renderer.domElement),this._viewer.canvas.style.position="absolute",this._viewer.canvas.style.top="0",this._viewer.canvas.style.left="0",this._viewer.canvas.style.zIndex="0",this._viewer.container.appendChild(s),this._refreshCanvasInDOM(),this._viewer.renderer.addEventListener("resize",()=>{if(!this._viewer||!this._renderer)return;const o=this._viewer.renderer.rendererObject.getSize(new et.FM8);this._renderer.setSize(o.width,o.height)})}async onAdded(tt){await super.onAdded(tt);let s=!0,o=!0;tt.addEventListener("postFrame",rt=>{var nt,ot;s&&this.enabled&&(this._renderer||this._initialize(),this._renderer&&(o&&this._trackers.forEach(ct=>{var pt,ht;let _t=!0;const Et=ct.modelObj.material.side;if(Et!==et.ehD){const St=new et.Pa4(0,0,1).applyQuaternion(ct.cssObj.quaternion),Mt=(ht=(pt=this._viewer)===null||pt===void 0?void 0:pt.scene.activeCamera)===null||ht===void 0?void 0:ht.cameraObject,It=St.dot(Mt.getWorldDirection(new et.Pa4));_t=Et===et._Li?It>0:It<0}ct.cssObj.element.style.visibility=_t?"visible":"hidden"}),this._trackers.filter(ct=>ct.dirty).forEach(ct=>this._syncProperties(ct)),(nt=this._renderer)===null||nt===void 0||nt.render(this._scene,(ot=tt.scene.activeCamera)===null||ot===void 0?void 0:ot.cameraObject),s=!1))}),tt.addEventListener("update",rt=>{this.enabled&&(s=this._trackers.length>0)}),tt.scene.addEventListener("sceneUpdate",rt=>{this.enabled&&(this._trackers.forEach(nt=>nt.dirty=!0),s=this._trackers.length>0)}),tt.scene.addEventListener("activeCameraUpdate",rt=>{this.enabled&&(s=this._trackers.length>0,o=!0)});let a=!1;const _e=new et.iMs;tt.container.addEventListener("mousemove",rt=>{if(!this.enabled||!this._viewer||this.overCanvas)return;const nt=this._viewer.canvas.getBoundingClientRect(),ot=(rt.clientX-nt.x)/nt.width*2-1,ct=-(rt.clientY-nt.y)/nt.height*2+1;_e.setFromCamera({x:ot,y:ct},this._viewer.scene.activeCamera.cameraObject);const pt=this._trackers.map(_t=>_t.modelObj),ht=_e.intersectObjects(pt,!1);if(console.log(ht),ht.length)return this._viewer.canvas.style.pointerEvents="none",a=!0,void console.log(this._viewer.canvas.style.pointerEvents);a&&(this._viewer.canvas.style.pointerEvents="auto",a=!1)})}attachIFrame(tt,s,o){const a=cI(tt.modelObject),_e=YB(s,o,o*a.y/a.x,()=>{var rt;return(rt=tt.setDirty)===null||rt===void 0?void 0:rt.call(tt)});return this.attachCSS3DObject(_e,tt),_e}attachCSS3DObject(tt,s){var o,a,_e,rt,nt;if(this._trackers.push({cssObj:tt,modelObj:s.modelObject,dirty:!0}),tt.element&&(this._resizeObserver.observe(tt.element),tt.element.__isCSS3DObjectElement=!0,console.log(tt.element,tt.element.__isCSS3DObjectElement)),s.userData.__oldMaterial=s.material,!s.setMaterial)throw"model not processed?";const ot=(o=this._viewer)===null||o===void 0?void 0:o.createMaterial("basic",{opacity:0,color:new et.Ilk("black"),blending:et.jFi,side:et.Wl3});if(!ot)throw"cannot create mat";ot.userData.forcedLinearDepth=0,(a=s.setMaterial)===null||a===void 0||a.call(s,ot),uI(s.modelObject),o2(s.modelObject),cI(s.modelObject),this._scene.add(tt),(rt=(_e=this.uiConfig)===null||_e===void 0?void 0:_e.uiRefresh)===null||rt===void 0||rt.call(_e),(nt=s.setDirty)===null||nt===void 0||nt.call(s)}_syncProperties(tt){const s=tt.modelObj,o=tt.cssObj;s.updateMatrixWorld();const a=tt.cssObj.element.clientWidth<1.5?0:(tt.cssObj.element.clientWidth-1.5)/cI(s).x,_e=uI(s);o.quaternion.setFromUnitVectors(new et.Pa4(0,0,1),_e),o.position.copy(o2(s)),o.scale.set(1,1,1).multiplyScalar(1/a),o.updateMatrixWorld(),o.applyMatrix4(s.matrixWorld),tt.dirty=!1}async onDispose(tt){return this._resizeObserver.disconnect(),super.onDispose(tt)}};function YB(tt,s,o,a){const _e=document.createElement("div");_e.style.width=s.toString()+"px",_e.style.height=o.toString()+"px",_e.style.backgroundColor="transparent";const rt=document.createElement("iframe",{is:"x-frame-bypass"});rt.style.width="100%",rt.style.height="100%",rt.style.border="0px";const nt=()=>{var ot,ct;try{rt.contentWindow.name}catch(pt){(typeof pt=="string"?pt:(ct=(ot=pt==null?void 0:pt.toString)===null||ot===void 0?void 0:ot.call(pt))!==null&&ct!==void 0?ct:"").includes("cross-origin")?console.warn("Trying to load cross-origin scripts, Install chrome extension if not able to load: https://chrome.google.com/webstore/detail/ignore-x-frame-headers/gleekbfjekiniecknbkamfmkohkpodhe"):console.error(pt)}a(),rt.removeEventListener("load",nt)};return rt.addEventListener("load",nt),rt.src=tt,_e.appendChild(rt),new pN(_e)}function uI(tt){if(tt.geometry.userData.geometryNormal)return tt.geometry.userData.geometryNormal;const s=tt.geometry.attributes.normal,o=new et.Pa4,a=new et.Pa4;for(let _e=0,rt=s.count;_e<rt;_e++)o.fromBufferAttribute(s,_e),a.add(o);return a.normalize(),tt.geometry.userData.geometryNormal=a,a}function o2(tt){if(tt.geometry.userData.geometryCenter)return tt.geometry.userData.geometryCenter;const s=tt.geometry;if(!s)return new et.Pa4(0,0,0);s.boundingBox||s.computeBoundingBox();const o=s.boundingBox.getCenter(new et.Pa4);return tt.geometry.userData.geometryCenter=o,o}function cI(tt,s=new et.Pa4(0,0,1)){if(tt.geometry.userData.geometrySize)return tt.geometry.userData.geometrySize;const o=tt.geometry;if(!o)return new et.Pa4(0,0,0);const a=o.clone();a.applyMatrix4(new et.yGw().makeRotationFromQuaternion(new et._fP().setFromUnitVectors(s,uI(tt)).invert())),a.computeBoundingBox();const _e=a.boundingBox.getSize(new et.Pa4);return tt.geometry.userData.geometrySize=_e,a.dispose(),_e}fA.PluginType="CSS3DRenderer",lI([ds("Enabled"),vr(aI.prototype._refreshEnabled),Yr()],fA.prototype,"enabled",void 0),lI([ds("Over canvas"),vr(aI.prototype._refreshCanvasInDOM),Yr()],fA.prototype,"overCanvas",void 0),lI([Qo("Attach iframe")],fA.prototype,"attachIFrameToSelected",void 0),fA=aI=lI([Ao("CSS3D Renderer")],fA);const mN=1e4,KB=50;class uS{constructor(s=KB){this.velocity=0,this.naturalFrequency=0,this.setDecayTime(s)}setDecayTime(s){this.naturalFrequency=1/Math.max(.001,s)}update(s,o,a,_e){const rt=2e-4*this.naturalFrequency;if(s==null||_e===0||s===o&&this.velocity===0)return o;if(a<0)return s;const nt=s-o,ot=this.velocity+this.naturalFrequency*nt,ct=nt+a*ot,pt=Math.exp(-this.naturalFrequency*a),ht=(ot-this.naturalFrequency*ct)*pt,_t=-this.naturalFrequency*(ht+ot*pt);return Math.abs(ht)<rt*Math.abs(_e)&&_t*nt>=0?(this.velocity=0,o):(this.velocity=ht,o+ct*pt)}}const a2=new et.Pa4;class XB{constructor(){this.inputSource=null,this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!1,this.lastDragPosition=new et.Pa4,this.firstRatio=0,this.lastAngle=0,this.goalPosition=new et.Pa4,this.goalYaw=0,this.goalScale=1,this.presentedScene=null,this.placementBox=null,this.placeOnWall=!1,this.placementComplete=!1,this.xr=null,this.session=null,this._hitPosition=new et.Pa4,this._hitMatrix=new et.yGw,this.xDamper=new uS,this.yDamper=new uS,this.zDamper=new uS,this.yawDamper=new uS,this.scaleDamper=new uS,this.onSelectStart=s=>{const o=this.transientHitTestSource;if(o==null)return;const a=this.frame.getHitTestResultsForTransientInput(o),_e=this.presentedScene,rt=this.placementBox;if(a.length===1){this.inputSource=s.inputSource;const{axes:nt}=this.inputSource.gamepad||{axes:[0,0]},ot=rt.getHit(_e,nt[0],nt[1]);rt.show=!0,ot!=null?(this.isTranslating=!0,this.lastDragPosition.copy(ot)):this.placeOnWall||(this.isRotating=!0,this.lastAngle=1.5*nt[0])}else if(a.length===2){rt.show=!0,this.isTwoFingering=!0;const{separation:nt}=this.fingerPolar(a);this.firstRatio=nt/_e.scale.x}},this.onSelectEnd=()=>{this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!1,this.inputSource=null,this.goalPosition.y+=this.placementBox.offsetHeight*this.presentedScene.scale.x,this.placementBox.show=!1}}async setSession(s,o,a,_e){var rt;this.transientHitTestSource=await((rt=s.requestHitTestSourceForTransientInput)===null||rt===void 0?void 0:rt.call(s,{profile:"generic-touchscreen"})),this.presentedScene=o,this.placementBox=_e,this.xr=a,this.session=s,this.placementComplete=!1,this.goalPosition.copy(o.position),this.goalYaw=o.rotation.y,this.goalScale=o.scale.x,s.addEventListener("selectstart",this.onSelectStart),s.addEventListener("selectend",this.onSelectEnd)}cancel(){this.transientHitTestSource&&(this.transientHitTestSource.cancel(),this.transientHitTestSource=void 0),this.presentedScene=null,this.placeOnWall=!1,this.frame=void 0,this.xr=null,this.placementBox&&(this.placementBox.show=!1,this.placementBox=null),this.session&&(this.session.removeEventListener("selectstart",this.onSelectStart),this.session.removeEventListener("selectend",this.onSelectEnd),this.session=null)}getHitPoint(s){var o;const a=(o=this.xr)===null||o===void 0?void 0:o.getReferenceSpace(),_e=a?s.getPose(a):null;return _e?(this._hitMatrix.fromArray(_e.transform.matrix),this.placeOnWall&&(this.goalYaw=Math.atan2(this._hitMatrix.elements[4],this._hitMatrix.elements[6])),this._hitMatrix.elements[5]>.75!==this.placeOnWall?this._hitPosition.setFromMatrixPosition(this._hitMatrix):null):null}moveScene(s){if(!this.session)return;const o=this.presentedScene,a=o.position,_e=o.rotation.y,rt=this.placementBox,nt=Math.max(rt.boundingSize.x,rt.boundingSize.y,rt.boundingSize.z)/2,ot=this.goalPosition,ct=o.scale.x;if(!ot.equals(a)||this.goalScale!==ct){let{x:pt,y:ht,z:_t}=a;pt=this.xDamper.update(pt,ot.x,s,nt),ht=this.yDamper.update(ht,ot.y,s,nt),_t=this.zDamper.update(_t,ot.z,s,nt),a.set(pt,ht,_t);const Et=this.scaleDamper.update(ct,this.goalScale,s,1);if(o.scale.set(Et,Et,Et),!this.isTranslating){const St=ot.y-ht;this.placementComplete&&!this.placeOnWall?rt.offsetHeight=St/Et:St===0&&(this.placementComplete=!0,rt.show=!1)}}rt.updateOpacity(s),o.rotation.y=this.yawDamper.update(_e,this.goalYaw,s,Math.PI)}processInput(s){var o;this.frame=s;const a=this.transientHitTestSource;if(!a||!this.isTranslating&&!this.isTwoFingering&&!this.isRotating)return;const _e=s.getHitTestResultsForTransientInput(a),rt=this.presentedScene,nt=rt.scale.x;if(this.isTwoFingering)if(_e.length<2)this.isTwoFingering=!1;else{const{separation:ot,deltaYaw:ct}=this.fingerPolar(_e);if(this.placeOnWall||(this.goalYaw+=ct),!rt.userData.__scaleDisabled){const pt=ot/this.firstRatio;this.goalScale=pt<1.3&&pt>.7692307692307692?1:pt}}else if(_e.length!==2)if(this.isRotating&&(!((o=this.inputSource)===null||o===void 0)&&o.gamepad)){const ot=1.5*this.inputSource.gamepad.axes[0];this.goalYaw+=ot-this.lastAngle,this.lastAngle=ot}else this.isTranslating&&(console.log("translating"),_e.forEach(ot=>{if(ot.inputSource!==this.inputSource)return;let ct=null;if(ot.results.length>0&&(ct=this.getHitPoint(ot.results[0])),ct==null&&(ct=this.getTouchLocation()),ct!=null){if(this.goalPosition.sub(this.lastDragPosition),!this.placeOnWall){const pt=ct.y-this.lastDragPosition.y;if(pt<0){this.placementBox.offsetHeight=pt/nt;const ht=a2.copy(this.xr.getCamera().position),_t=-pt/(ht.y-ct.y);ht.multiplyScalar(_t),ct.multiplyScalar(1-_t).add(ht)}}this.goalPosition.add(ct),this.lastDragPosition.copy(ct)}}));else{this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!0;const{separation:ot}=this.fingerPolar(_e);this.firstRatio=ot/nt}}getTouchLocation(){var s,o;const{axes:a}=(s=this.inputSource.gamepad)!==null&&s!==void 0?s:{axes:[0,0]},_e=this.placementBox.getExpandedHit(this.presentedScene,a[0],a[1]);return _e!=null&&(a2.copy(_e).sub((o=this.xr)===null||o===void 0?void 0:o.getCamera().position),a2.length()>10)?null:_e}fingerPolar(s){var o,a,_e,rt,nt,ot;const ct=(_e=(a=(o=s[0].inputSource)===null||o===void 0?void 0:o.gamepad)===null||a===void 0?void 0:a.axes)!==null&&_e!==void 0?_e:[0,0],pt=(ot=(nt=(rt=s[1].inputSource)===null||rt===void 0?void 0:rt.gamepad)===null||nt===void 0?void 0:nt.axes)!==null&&ot!==void 0?ot:[0,0],ht=pt[0]-ct[0],_t=pt[1]-ct[1],Et=Math.atan2(_t,ht);let St=this.lastAngle-Et;return St>Math.PI?St-=2*Math.PI:St<-Math.PI&&(St+=2*Math.PI),this.lastAngle=Et,{separation:Math.sqrt(ht*ht+_t*_t),deltaYaw:St}}}const dI=.2,gN=Math.PI/24,JB=new et.FM8,pI=(tt,s,o)=>{let a=s>0?o>0?0:-Math.PI/2:o>0?Math.PI/2:Math.PI;for(let _e=0;_e<=12;++_e)tt.push(s+.17*Math.cos(a),o+.17*Math.sin(a),0,s+dI*Math.cos(a),o+dI*Math.sin(a),0),a+=gN};class ZB extends et.Kj0{constructor(s,o,a=!1){super(((ct,pt)=>{const ht=new et.u9r,_t=[],Et=[],St=ct.getSize(new et.Pa4),Mt=St.x/2,It=(pt?St.y:St.z)/2;pI(Et,Mt,It),pI(Et,-Mt,It),pI(Et,-Mt,-It),pI(Et,Mt,-It);const Nt=Et.length/3;for(let kt=0;kt<Nt-2;kt+=2)_t.push(kt,kt+1,kt+3,kt,kt+3,kt+2);const Bt=Nt-2;return _t.push(Bt,Bt+1,1,Bt,1,0),ht.setAttribute("position",new et.a$l(Et,3)),ht.setIndex(_t),ht})(s,a)),this.boundingSize=new et.Pa4,this._raycaster=new et.iMs,this._camera=o,this._placeOnWall=a;const _e=this.material;_e.side=et.Wl3,_e.color=new ys(16711935),_e.opacity=0,this.userData.bboxVisible=!1;const rt=s.getSize(this.boundingSize);console.log(s,a,rt,this);const nt=rt.x/2,ot=(a?rt.y:rt.z)/2;this.hitPlane=new et.Kj0(new et._12(2*(nt+dI),2*(ot+dI))),this.hitPlane.visible=!1,this.add(this.hitPlane),s.getCenter(this.position),a?(this.shadowHeight=s.min.z,this.position.z=this.shadowHeight):(this.rotateX(-Math.PI/2),this.shadowHeight=s.min.y,this.position.y=this.shadowHeight),this.offsetHeight=0}getHit(s,o,a){JB.set(o,-a),this.hitPlane.visible=!0;const _e=this._positionAndNormalFromPoint(JB,this.hitPlane);return this.hitPlane.visible=!1,_e==null?null:_e.position}getExpandedHit(s,o,a){this.hitPlane.scale.set(1e3,1e3,1e3);const _e=this.getHit(s,o,a);return this.hitPlane.scale.set(1,1,1),_e}set offsetHeight(s){s-=.001,this._placeOnWall?this.position.z=this.shadowHeight+s:this.position.y=this.shadowHeight+s}get offsetHeight(){return this._placeOnWall?this.position.z-this.shadowHeight:this.position.y-this.shadowHeight}set show(s){this.material.opacity=s?.75:0}get show(){return this.material.opacity>.01}updateOpacity(s){const o=this.material;this.visible=o.opacity>0}dispose(){var s;const{geometry:o,material:a}=this.hitPlane;o.dispose(),a.dispose(),this.geometry.dispose(),this.material.dispose(),(s=this.parent)===null||s===void 0||s.remove(this)}_positionAndNormalFromPoint(s,o){if(!this._camera)return null;this._raycaster.setFromCamera(s,this._camera);const a=this._raycaster.intersectObject(o,!0);if(a.length===0)return null;const _e=a[0];return _e.face==null?null:_e.uv==null?{position:_e.point,normal:_e.face.normal,uv:null}:(_e.face.normal.applyNormalMatrix(new et.Vkp().getNormalMatrix(_e.object.matrixWorld)),{position:_e.point,normal:_e.face.normal,uv:_e.uv})}}class _k extends io{constructor(){super(...arguments),this.enabled=!0,this._touchInputHelper=new XB,this._preRender=()=>{if(!(this._dirty&&this._viewer&&this._xrManager&&this._xrSession))return;this._viewer.renderer.composer.renderToScreen=!1,this._xrManager.enabled=!1;const s=this._xrManager.getCamera(),o=s.cameras[0]||s,a=this._viewer.scene.activeCamera;a.cameraObject.projectionMatrix.copy(o.projectionMatrix),a.cameraObject.projectionMatrixInverse.copy(a.cameraObject.projectionMatrix).invert()},this._postRender=()=>{var s,o;if(!this._dirty||!this._viewer||!this._xrSession)return;this._viewer.scene.activeCamera.cameraObject.updateProjectionMatrix();const a=this._viewer.renderer,_e=(o=(s=this._xrManager)===null||s===void 0?void 0:s.getCamera())===null||o===void 0?void 0:o.cameras[0].viewport;_e?a.rendererObject.setViewport(_e):console.warn("no viewport for ar camera"),jn(a.rendererObject,{sceneRender:!0,opaqueRender:!0,shadowMapRender:!1,backgroundRender:!1,transparentRender:!1,transmissionRender:!1,screenSpaceRendering:!1},()=>{hI.render(a.rendererObject,null,a.composer.readBuffer,0,!1)}),this._xrManager.enabled=!0,this._viewer.renderer.composer.renderToScreen=!0},this._frameCount=0,this._lastTime=0,this._preFrame=({xrFrame:s,deltaTime:o})=>{var a,_e;if(this.dirty=!!s&&((a=this._xrManager)===null||a===void 0?void 0:a.isPresenting)||!1,this._viewer.scene.activeCamera.interactionsEnabled=!this._dirty,this._viewer.scene.activeCamera.autoLookAtTarget=!this._dirty,!this._dirty||!s)return void(this._xrSession&&this._xrSessionEnd());if(!this._xrSession&&!this._xrManager.getSession())return console.error("no xr session found, shouldn't happen"),void(this.dirty=!1);this._xrSession||console.log("webxr: AR session init"),this._frameCount++;const rt=this._xrManager.getReferenceSpace(),nt=s.getViewerPose(rt);if(nt==null&&this._frameCount,nt==null||((_e=this._viewer)===null||_e===void 0?void 0:_e.scene.modelRoot.children.length)===0)return this.dirty=!1,void console.log("no pose or no model");if(!this._xrSession){if(this._xrSession=this._xrManager.getSession()||void 0,!this._xrSession)return;this._frameCount=0,this._cancelHitSources(),this._savePreXRState(),this._preSetupModel(),this._xrSessionStart()}const ot=this._viewer.scene.activeCamera;this._xrManager.updateCamera(ot.cameraObject),ot.setDirty(),this.moveToFloor(s),this._touchInputHelper.processInput(s),this._touchInputHelper.moveScene(o),this._updateShadow()},this.placeOnWall=!1,this._preXRState={viewerBg:null,modelScale:new et.Pa4(1,1,1),modelPosition:new et.Pa4,modelRotation:new et._fP,cameraPosition:new et.Pa4(0,0,5),cameraTarget:new et.Pa4,cameraUp:new et.Pa4(0,1,0),cameraAspect:1,cameraFov:50,cameraZoom:1,cameraNear:.01,cameraFar:100,groundOffset:new et.Pa4,groundScale:1},this._savePreXRState=()=>{if(!this._viewer)return;this._preXRState.viewerBg=this._viewer.getBackground(!0);const s=this._viewer.scene.modelRoot,o=this._viewer.scene.activeCamera;s.updateMatrix(),s.updateMatrixWorld(!0),this._preXRState.modelScale.copy(s.scale),this._preXRState.modelPosition.copy(s.position),this._preXRState.modelRotation.copy(s.quaternion),this._preXRState.cameraPosition.copy(o.position),this._preXRState.cameraTarget.copy(o.target),this._preXRState.cameraUp.copy(o.cameraObject.up),o.cameraObject.isPerspectiveCamera&&(this._preXRState.cameraFov=o.cameraObject.fov,this._preXRState.cameraAspect=o.cameraObject.aspect),this._preXRState.cameraZoom=o.cameraObject.zoom,this._preXRState.cameraNear=o.cameraObject.near,this._preXRState.cameraFar=o.cameraObject.far;const a=this._viewer.getPluginByType("Ground");a!=null&&a.mesh&&(this._preXRState.groundOffset.subVectors(s.position,a.mesh.modelObject.position),this._preXRState.groundScale=a.mesh.modelObject.scale.x,console.log("ground offset",this._preXRState.groundOffset,this._preXRState.groundScale),a.shadowBaker.enabled=!1)},this._xrSessionStart=()=>{if(!this._xrSession||!this._viewer)return;console.log("webxr: AR session start");const s=20*Math.PI/180,o=this.placeOnWall?void 0:new window.XRRay(new DOMPoint(0,0,0),{x:0,y:-Math.sin(s),z:-Math.cos(s)});this._touchInputHelper.placeOnWall=this.placeOnWall,this._viewer.resize(),(async()=>{var a,_e;if(this._xrSession){const rt=await this._xrSession.requestReferenceSpace("viewer");this._hitTestSource=await((_e=(a=this._xrSession).requestHitTestSource)===null||_e===void 0?void 0:_e.call(a,{space:rt,offsetRay:o}))}this._xrSession&&await this._touchInputHelper.setSession(this._xrSession,this._viewer.scene.modelRoot,this._xrManager,this._placementBox)})()},this._xrSessionEnd=()=>{var s;console.log("webxr: AR session end"),this._frameCount=0,(s=this._xrSession)===null||s===void 0||s.removeEventListener("end",this._xrSessionEnd),this._xrSession=void 0,this._cancelHitSources(),this._viewer&&(this._restorePreXRState(),this._viewer.resize())}}async onAdded(s){await super.onAdded(s);const o=s.renderer.rendererObject.xr;o.enabled=!0,o.cameraAutoUpdate=!1,this._xrManager=o;const a=document.getElementById("tweakpaneUiContainer"),_e=a?{root:a}:void 0;document.body.appendChild((class{static createButton(rt,nt={}){const ot=document.createElement("button");function ct(){ot.style.display="",ot.style.cursor="auto",ot.style.left="calc(50% - 75px)",ot.style.width="150px",ot.onmouseenter=null,ot.onmouseleave=null,ot.onclick=null}function pt(ht){ht.style.position="absolute",ht.style.bottom="20px",ht.style.padding="12px 6px",ht.style.border="1px solid #fff",ht.style.borderRadius="4px",ht.style.background="rgba(0,0,0,0.1)",ht.style.color="#fff",ht.style.font="normal 13px sans-serif",ht.style.textAlign="center",ht.style.opacity="0.5",ht.style.outline="none",ht.style.zIndex="999"}if("xr"in navigator)return ot.id="ARButton",ot.style.display="none",pt(ot),navigator.xr.isSessionSupported("immersive-ar").then(function(ht){ht?function(){if(nt.domOverlay===void 0){const Mt=document.createElement("div");Mt.style.display="none",document.body.appendChild(Mt);const It=document.createElementNS("http://www.w3.org/2000/svg","svg");It.setAttribute("width",38),It.setAttribute("height",38),It.style.position="absolute",It.style.right="20px",It.style.top="20px",It.addEventListener("click",function(){_t.end()}),Mt.appendChild(It);const Nt=document.createElementNS("http://www.w3.org/2000/svg","path");Nt.setAttribute("d","M 12,12 L 28,28 M 28,12 12,28"),Nt.setAttribute("stroke","#fff"),Nt.setAttribute("stroke-width",2),It.appendChild(Nt),nt.optionalFeatures===void 0&&(nt.optionalFeatures=[]),nt.optionalFeatures.push("dom-overlay"),nt.domOverlay={root:Mt}}let _t=null;async function Et(Mt){Mt.addEventListener("end",St),rt.xr.setReferenceSpaceType("local"),await rt.xr.setSession(Mt),ot.textContent="STOP AR",nt.domOverlay.root.style.display="",_t=Mt}function St(){_t.removeEventListener("end",St),ot.textContent="START AR",nt.domOverlay.root.style.display="none",_t=null}ot.style.display="",ot.style.cursor="pointer",ot.style.left="calc(50% - 50px)",ot.style.width="100px",ot.textContent="START AR",ot.onmouseenter=function(){ot.style.opacity="1.0"},ot.onmouseleave=function(){ot.style.opacity="0.5"},ot.onclick=function(){_t===null?navigator.xr.requestSession("immersive-ar",nt).then(Et):_t.end()}}():(ct(),ot.textContent="AR NOT SUPPORTED")}).catch(function(ht){ct(),console.warn("Exception when trying to call xr.isSessionSupported",ht),ot.textContent="AR NOT ALLOWED"}),ot;{const ht=document.createElement("a");return window.isSecureContext===!1?(ht.href=document.location.href.replace(/^http:/,"https:"),ht.innerHTML="WEBXR NEEDS HTTPS"):(ht.href="https://immersiveweb.dev/",ht.innerHTML="WEBXR NOT AVAILABLE"),ht.style.left="calc(50% - 90px)",ht.style.width="180px",ht.style.textDecoration="none",pt(ht),ht}}}).createButton(s.renderer.rendererObject,{requiredFeatures:["hit-test"],optionalFeatures:["dom-overlay"],domOverlay:_e})),s.addEventListener("preRender",this._preRender),s.addEventListener("postRender",this._postRender),s.addEventListener("preFrame",this._preFrame)}_updateShadow(){if(!this._viewer)return;const s=this._viewer.scene.modelRoot,o=this._viewer.getPluginByType("Ground");o&&(o.groundReflection=!1,o.mesh.modelObject.position.copy(this._preXRState.groundOffset).multiplyScalar(s.modelObject.scale.x).sub(s.modelObject.position).negate(),o.mesh.modelObject.scale.setScalar(s.modelObject.scale.x*this._preXRState.groundScale))}moveToFloor(s){if(!this._dirty||!this._hitTestSource||!this._xrManager)return;const o=s.getHitTestResults(this._hitTestSource);if(!o.length)return;const a=o[0],_e=this._touchInputHelper.getHitPoint(a);_e&&(this._placementBox.show=!0,this._viewer.scene.modelRoot,this.placeOnWall?this._touchInputHelper.goalPosition.copy(_e):this._touchInputHelper.goalPosition.y=_e.y,this._hitTestSource.cancel(),this._hitTestSource=void 0,console.log("move to initial hit point",_e))}_removePlacementBox(){this._placementBox&&(this._placementBox.dispose(),this._placementBox=void 0)}_preSetupModel(){var s;const o=this._viewer.scene.modelRoot,a=this._viewer.scene.activeCamera,_e=(s=this._xrManager)===null||s===void 0?void 0:s.getCamera(),rt=_e.cameras[0]||_e;this._removePlacementBox();const nt=this._viewer.scene.getBounds(!0,!0);nt.getSize(new et.Pa4).length()>.01&&(this._placementBox=new ZB(nt,_e,this.placeOnWall),o.add(this._placementBox),this._placementBox.show=!1);const ot=_e.getWorldDirection(new et.Pa4);o.rotation.y=Math.atan2(-ot.x,-ot.z)-0,a.cameraObject.zoom=rt.zoom,a.cameraObject.near=rt.near,a.cameraObject.far=rt.far,a.cameraObject.isPerspectiveCamera?(a.cameraObject.fov=rt.fov,a.cameraObject.aspect=rt.viewport.width/rt.viewport.height):console.warn("Perspective camera required."),a.cameraObject.updateProjectionMatrix(),o.position.set(0,0,0);const ct=o.userData.arScale||1;o.scale.set(ct,ct,ct),o.position.copy(_e.position).add(ot.multiplyScalar(5)),o.visible=!0,this._viewer.setBackground(null)}_restorePreXRState(){if(!this._viewer)return;this._viewer.setBackground(this._preXRState.viewerBg),this._preXRState.viewerBg=null;const s=this._viewer.scene.modelRoot;s.scale.copy(this._preXRState.modelScale),s.position.copy(this._preXRState.modelPosition),s.quaternion.copy(this._preXRState.modelRotation),s.updateMatrix(),s.updateMatrixWorld(!0),s.visible=!0;const o=this._viewer.scene.activeCamera;o.position.copy(this._preXRState.cameraPosition),o.target.copy(this._preXRState.cameraTarget),o.cameraObject.up.copy(this._preXRState.cameraUp),o.cameraObject.near=this._preXRState.cameraNear,o.cameraObject.far=this._preXRState.cameraFar,o.cameraObject.isPerspectiveCamera&&(this._preXRState.cameraFov!==void 0&&(o.cameraObject.fov=this._preXRState.cameraFov),this._preXRState.cameraAspect!==void 0&&(o.cameraObject.aspect=this._preXRState.cameraAspect)),o.positionUpdated(!1),o.targetUpdated(!0),o.cameraObject.updateMatrixWorld(!0),o.cameraObject.updateProjectionMatrix()}_cancelHitSources(){this._hitTestSource&&(this._hitTestSource.cancel(),this._hitTestSource=void 0),this._touchInputHelper.cancel()}}_k.PluginType="WEBXR_ARPlugin";const hI=new Rt({vertexShader:ut.vertexShader,fragmentShader:`
    uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			// gl_FragColor = vec4(1,0,1,1);
			gl_FragColor = texel;

		}
		`,uniforms:ut.uniforms});async function eO(tt,s){if(tt.createWriter){const a=await tt.createWriter();return await a.write(0,s),void await a.close()}const o=await tt.createWritable();await o.write(s),await o.close()}async function vN(tt,s){const o={};return s&&(o.writable=!0,o.mode="readwrite"),await tt.queryPermission(o)==="granted"||await tt.requestPermission(o)==="granted"}hI.renderToScreen=!1,hI.useExistingRenderTarget=!0,hI.clear=!1;class gT extends it{constructor(s,o){super(),this._state="stopped",this._console=console,this._currentRecording=[],this._currentImages=[],this.stepMode=!1,this._resumeSyncTime=0,this._frameCount=0,this._onstop=_e=>{var rt;if(this._state="stopped",this._recorder&&this._currentRecording.length>0){const nt=new Blob(this._currentRecording,{type:this._options.mimeType});(rt=this._recordingCallback)===null||rt===void 0||rt.call(this,nt)}else this._currentImages.length>0&&(this._writeImages([...this._currentImages]),this._currentImages=[]);this._recorder=void 0,this.dispatchEvent({type:"stop"})},this._onstart=_e=>{var rt;this._state="recording",this._frameCount=0,this.dispatchEvent({type:"start"}),this.stepMode&&((rt=this._recorder)===null||rt===void 0||rt.pause())},this._onresume=_e=>{if(!this.stepMode)return;const rt=()=>{var ot;this._state==="recording"&&((ot=this._recorder)===null||ot===void 0||ot.pause())},nt=Math.min(this._resumeSyncTime-bo(),0)+1e3/this._options.frameRate;nt>0?mu(nt).then(rt):rt()},this._onpause=_e=>{},this._ondataavailable=_e=>{_e.data&&_e.data.size>0&&this._currentRecording.push(_e.data)},this._onerror=_e=>{this._state="error",this._console.error(_e),this.dispatchEvent({type:"error",error:_e}),this._recorder=void 0},this._canvas=s;const a=o==null?void 0:o.mimeType;this._options={mimeType:a||"auto",frameRate:30},this._setOptions(o||this._options)}_setOptions(s){var o,a;Object.assign(this._options,s),this._options.mimeType&&this._options.mimeType!=="auto"||(this._options.mimeType=(o=gT.GetSupportedMimeTypes([],["h264"],!0))!==null&&o!==void 0?o:gT.GetSupportedMimeTypes(void 0,void 0,!0)),this._options.mimeType&&!(!((a=this._options.mimeType)===null||a===void 0)&&a.startsWith("video/"))||window.MediaRecorder||(this._console.warn("MediaRecorder is not supported, switching to png"),this._options.mimeType="image/png"),this._options.mimeType||console.warn(new Error("No supported mimetype found"))}setOptions(s){this._setOptions(s)}isRecording(){return this._state==="recording"}start(){var s,o,a;if(this._state==="recording")return void this._console.log("Already recording canvas");if(this._state==="error"&&(this._recorder=void 0,this._console.warn("Resetting from error state.")),this._recorder)return this._state==="paused"?(this.dispatchEvent({type:"starting"}),void this._recorder.resume()):void this._console.warn("Canvas recorder unknown state",this._state);if(this._state==="paused")return this.dispatchEvent({type:"starting"}),void(this._state="recording");const _e={mimeType:this._options.mimeType,videoBitsPerSecond:this._options.videoBitsPerSecond};if(this._currentRecording=[],this._currentImages=[],this._frameCount=0,(s=_e.mimeType)===null||s===void 0?void 0:s.startsWith("video")){if(!window.MediaRecorder)return this._console.error("MediaRecorder not supported, use image sequence"),void(this._state="error");{const rt=this._canvas.captureStream(this.stepMode?0:this._options.frameRate),nt=(o=rt.getVideoTracks())===null||o===void 0?void 0:o[0];this._track=nt,this._recorder=new window.MediaRecorder(rt,_e),this._recorder.onstop=this._onstop,this._recorder.ondataavailable=this._ondataavailable,this._recorder.onerror=this._onerror,this._recorder.onresume=this._onresume,this._recorder.onstart=this._onstart}}this.dispatchEvent({type:"starting"}),this._recorder?(this._state="recording",(a=this._recorder)===null||a===void 0||a.start()):window.showDirectoryPicker&&window.showDirectoryPicker().then(async rt=>{const nt=await(rt==null?void 0:rt.getDirectoryHandle("i-"+Math.floor(Date.now()),{create:!0}));this._imgDirectory=nt,this._state="recording",this._onstart({})}).catch(rt=>{this._onerror({detail:rt})})}async requestFrame(){if(this._state!=="recording")return;this._frameCount++;const s=this._options.mimeType;if(!this._recorder&&s.startsWith("image/")){const o=this._canvas.toDataURL(s,90);this._currentImages.push(["frame_"+String(this._frameCount).padStart(5,"0")+(s.includes("png")?".png":".jpg"),o]),this._currentImages.length>60&&(this._writeImages([...this._currentImages]),this._currentImages=[])}this._recorder&&this._track&&this.stepMode&&(this._resumeSyncTime=bo(),this._track.requestFrame(),this._recorder.resume())}pause(){this._state!=="paused"&&this._state!=="stopped"&&(this._recorder?this._recorder.pause():this._state="paused")}stop(s){this._state!=="stopped"&&(this._state!=="error"?(this._recordingCallback=s,this.dispatchEvent({type:"stopping"}),this._recorder?this._recorder.stop():this._onstop({})):this._console.error("Recorder in error state, cannot stop, call start again."))}get state(){return this._state}dispose(){this._recorder&&this._state!=="error"?this.stop(s=>{this._console.warn("disposed with blob",s),this.dispose()}):this._recorder=void 0}async _writeImages(s){if(!this._imgDirectory)return;const o=await Promise.all(s.map(async([_e,rt])=>await(await fetch(rt)).blob())),a=[];for(let _e=0;_e<s.length;_e++){const rt=await this._imgDirectory.getFileHandle(s[_e][0],{create:!0});a.push(eO(rt,o[_e]))}await Promise.all(a)}static GetSupportedMimeTypes(s,o,a=!1){if(!window.MediaRecorder)return a?void 0:[];const _e=["webm","ogg","mp4","x-matroska"].filter(ot=>!s||s.length<1||s.includes(ot)),rt=["vp9","vp9.0","vp8","vp8.0","avc1","av1","h265","h.265","h264","h.264","opus"].filter(ot=>!o||o.length<1||o.includes(ot)),nt=[];return _e.forEach(ot=>{const ct=`video/${ot}`;rt.forEach(pt=>{[`${ct};codecs=${pt}`,`${ct};codecs:${pt}`,`${ct};codecs=${pt.toUpperCase()}`,`${ct};codecs:${pt.toUpperCase()}`,`${ct}`].forEach(ht=>{MediaRecorder.isTypeSupported(ht)&&nt.push(ht)})})}),a?nt.length>0?nt[0]:void 0:nt}}var l2=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};class _y extends io{constructor(){super(...arguments),this.enabled=!0,this.convergeMode=!1,this.mimeType="auto",this.videoFrameRate=30,this._renderToScreenDisabled=!1,this._preRender=()=>{var s,o,a;if(this.convergeMode&&(!((s=this._recorder)===null||s===void 0)&&s.isRecording())){const _e=this._viewer.renderer.composer.renderToScreen;this._viewer.renderer.composer.renderToScreen=((a=(o=this._viewer)===null||o===void 0?void 0:o.getPluginByType("Progressive"))===null||a===void 0?void 0:a.isConverged())||!1,_e&&!this._viewer.renderer.composer.renderToScreen&&(this._renderToScreenDisabled=!0)}},this._postRender=()=>{var s,o,a;if(!((s=this._recorder)===null||s===void 0)&&s.isRecording()&&(!this.convergeMode||!((a=(o=this._viewer)===null||o===void 0?void 0:o.getPluginByType("Progressive"))===null||a===void 0)&&a.isConverged(!0))){const _e=()=>{var rt;return(rt=this._recorder)===null||rt===void 0?void 0:rt.requestFrame()};this.convergeMode?mu(1).then(_e):_e()}this._renderToScreenDisabled&&(this._viewer.renderer.composer.renderToScreen=!0)}}get recorder(){return this._recorder}isRecording(){var s,o;return(o=(s=this._recorder)===null||s===void 0?void 0:s.isRecording())!==null&&o!==void 0&&o}refreshRecorderOptions(){this._recorder&&(this._recorder.setOptions({frameRate:this.videoFrameRate,mimeType:this.mimeType}),this._recorder.stepMode=this.convergeMode)}async onAdded(s){await super.onAdded(s),this._recorder=new gT(s.canvas,{frameRate:this.videoFrameRate,mimeType:this.mimeType}),s.addEventListener("preRender",this._preRender),s.addEventListener("postRender",this._postRender),this._recorder.addEventListener("starting",()=>this._stateChange(!1)),this._recorder.addEventListener("start",()=>{this.dispatchEvent({type:"start"}),this._stateChange(!this.convergeMode)}),this._recorder.addEventListener("error",()=>{this.dispatchEvent({type:"error"})}),this._recorder.addEventListener("pause",()=>this._stateChange(!1)),this._recorder.addEventListener("resume",()=>this._stateChange(!this.convergeMode)),this._recorder.addEventListener("stop",()=>{this.dispatchEvent({type:"stop"}),this._stateChange(!1)})}_stateChange(s){var o,a,_e;this.dirty=s,(o=this._viewer)===null||o===void 0||o.setDirty(),(_e=(a=this._uiConfig)===null||a===void 0?void 0:a.children)===null||_e===void 0||_e.map(rt=>er(rt)).flat(2).forEach(rt=>{var nt;return(nt=rt==null?void 0:rt.uiRefresh)===null||nt===void 0?void 0:nt.call(rt)})}async onRemove(s){var o;return s.removeEventListener("preRender",this._preRender),s.removeEventListener("preRender",this._postRender),(o=this._recorder)===null||o===void 0||o.dispose(),super.onRemove(s)}startRecording(){var s;return!!this.enabled&&((s=this.recorder)===null||s===void 0?void 0:s.isRecording())===!1&&(this.recorder.stepMode=this.convergeMode,this.recorder.start(),!0)}async stopRecording(){var s;if(!((s=this.recorder)===null||s===void 0)&&s.isRecording())return new Promise((o,a)=>{var _e;return(_e=this.recorder)===null||_e===void 0?void 0:_e.stop(o)})}get uiConfig(){if(this._uiConfig)return this._uiConfig;const s=this;return this._uiConfig={type:"folder",label:"Video Export",children:[{type:"slider",label:"Frame Rate",bounds:[1,60],stepSize:1,property:[this,"videoFrameRate"]},{type:"checkbox",limitedUi:!0,property:[this,"convergeMode"]},{type:"dropdown",label:"Mime type",limitedUi:!0,property:[this,"mimeType"],children:[["Auto Video (x264)","auto"],["PNG sequence","image/png"],["JPEG sequence","image/jpeg"]].map(o=>({label:o[0],value:o[1]}))},{type:"input",disabled:!0,label:"State",limitedUi:!0,get value(){var o,a;return(a=(o=s.recorder)===null||o===void 0?void 0:o.state)!==null&&a!==void 0?a:"not initialized"},set value(o){}},{type:"button",get label(){var o;return!((o=s.recorder)===null||o===void 0)&&o.isRecording()?"Stop":"Start"},value:()=>{var o;!((o=s.recorder)===null||o===void 0)&&o.isRecording()?this.stopRecording().then(a=>{if(a){console.log(a);const _e=a.type.split(";")[0].split("/").pop()||"mp4";Nu(a,"test."+_e)}}):this.startRecording()}},{type:"button",limitedUi:!0,label:"Record Camera Views",hidden:()=>{var o,a;return!!(!((o=s.recorder)===null||o===void 0)&&o.isRecording())||!(!((a=this._viewer)===null||a===void 0)&&a.getPluginByType("CameraViews"))},value:()=>{var o,a;(a=(o=this._viewer)===null||o===void 0?void 0:o.getPluginByType("CameraViews"))===null||a===void 0||a.recordAllViews()}},{type:"button",limitedUi:!0,label:"Record Camera Views + GLTF Anim",hidden:()=>{var o,a,_e,rt;return!!(!((o=s.recorder)===null||o===void 0)&&o.isRecording())||!(!((a=this._viewer)===null||a===void 0)&&a.getPluginByType("CameraViews"))||!(!((rt=(_e=this._viewer)===null||_e===void 0?void 0:_e.getPluginByType("GLTFAnimation"))===null||rt===void 0)&&rt.animations.length)},value:()=>{var o,a,_e,rt;const nt=((a=(o=this._viewer)===null||o===void 0?void 0:o.getPluginByType("GLTFAnimation"))===null||a===void 0?void 0:a.animationState)==="playing";(rt=(_e=this._viewer)===null||_e===void 0?void 0:_e.getPluginByType("CameraViews"))===null||rt===void 0||rt.recordAllViews(()=>{var ot,ct;(ct=(ot=this._viewer)===null||ot===void 0?void 0:ot.getPluginByType("GLTFAnimation"))===null||ct===void 0||ct.playAnimation()}).then(()=>{var ot,ct;nt||(ct=(ot=this._viewer)===null||ot===void 0?void 0:ot.getPluginByType("GLTFAnimation"))===null||ct===void 0||ct.stopAnimation()})}}]}}}_y.PluginType="CanvasRecorder",l2([vr(_y.prototype.refreshRecorderOptions),Yr()],_y.prototype,"convergeMode",void 0),l2([vr(_y.prototype.refreshRecorderOptions),Yr()],_y.prototype,"mimeType",void 0),l2([vr(_y.prototype.refreshRecorderOptions),Yr()],_y.prototype,"videoFrameRate",void 0);var fI=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};const u2=new et.jyz({uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform float h;

		varying vec2 vUv;

		void main() {

			vec4 sum = vec4( 0.0 );

			sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
			sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
			sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

			gl_FragColor = sum;

		}`});u2.depthTest=!1;const c2=new et.jyz({uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform float v;

		varying vec2 vUv;

		void main() {

			vec4 sum = vec4( 0.0 );

			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

			gl_FragColor = sum;

		}`});c2.depthTest=!1;class yy extends Op{constructor(s={},o=!1){super(s),this.contactShadows=!0,this.blurAmount=1,this.shadowScale=1,this.shadowHeight=5,this.shadowCamera=new et.iKG(-1,1,1,-1,.001,this.shadowHeight),this._refreshShadowCameraFrustum=this._refreshShadowCameraFrustum.bind(this),this.refreshOptions=this.refreshOptions.bind(this),this._showDebug=o,o&&this.dependencies.push(Ov)}async onAdded(s){const o=s.renderer.createTarget({type:et.ywz,format:et.wk1,encoding:et.rnI,size:{width:512,height:512},generateMipmaps:!1,depthBuffer:!0,minFilter:et.wem,magFilter:et.wem});o.texture.name="groundContactDepthTexture";const a=new et.lRF({depthPacking:et.z81});a.onBeforeCompile=function(rt){rt.uniforms.opacity.value=1,rt.fragmentShader=`
						${rt.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );","gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), 1.0 );")}
					`};const _e=new KT(o,a);this._depthPass=_e,await super.onAdded(s)}_postFrame(){super._postFrame(),this._viewer}_preRender(){if(super._preRender(),!this._viewer||!this._depthPass)return;this._depthPass.scene=this._viewer.scene.modelObject,this._depthPass.camera=this.shadowCamera,this._depthPass.render(this._viewer.renderer.rendererObject);const s=this._viewer.renderer.getTempTarget({type:et.ywz,format:et.wk1,encoding:et.rnI,size:{width:1024,height:1024},generateMipmaps:!1,depthBuffer:!1,minFilter:et.wem,magFilter:et.wem});this._blurShadow(s),this._blurShadow(s,.4),this._viewer.renderer.releaseTempTarget(s)}_blurShadow(s,o=1){this._viewer&&this._depthPass&&(u2.uniforms.h.value=o*this.blurAmount/256,c2.uniforms.v.value=o*this.blurAmount/256,this._viewer.renderer.blit(this._depthPass.target.texture,s,{material:u2,clear:!0}),this._viewer.renderer.blit(s.texture,this._depthPass.target,{material:c2,clear:!0}))}async onDispose(s){return super.onDispose(s)}async onRemove(s){return super.onRemove(s)}_refreshTransform(){super._refreshTransform(),this._mesh&&this._viewer&&(this.shadowCamera.position.copy(this._mesh.getWorldPosition(new et.Pa4)),this.shadowCamera.setRotationFromEuler(new et.USm(Math.PI/2,0,0)),this.shadowCamera.updateMatrixWorld(),this._refreshShadowCameraFrustum(),this._mesh.scale.y=-this.size)}_refreshShadowCameraFrustum(){this.shadowCamera&&(this.shadowCamera.left=-this.size/(2*this.shadowScale),this.shadowCamera.right=this.size/(2*this.shadowScale),this.shadowCamera.top=this.size/(2*this.shadowScale),this.shadowCamera.bottom=-this.size/(2*this.shadowScale),this.shadowCamera.far=this.shadowHeight,this.shadowCamera.updateProjectionMatrix(),this._setDirty())}_setDirty(){var s;(s=this._viewer)===null||s===void 0||s.setDirty()}_removeMaterial(){this._material&&super._removeMaterial()}refreshOptions(){this._viewer&&super.refreshOptions()}_refreshMaterial(){var s;if(!this._viewer)return!1;const o=super._refreshMaterial();return this._material&&(this._material.alphaMap=((s=this._depthPass)===null||s===void 0?void 0:s.target.texture)||null,o&&(this._material.roughness=1,this._material.metalness=0,this._material.color.set(1118481),this._material.transparent=!0,this._material.materialObject.userData.ssreflDisabled=!0,this._material.materialObject.userData.ssreflNonPhysical=!1)),o}_extraUiConfig(){return[{label:"Contact Shadows",type:"checkbox",property:[this,"contactShadows"]},{label:"Shadow Scale",type:"slider",bounds:[0,2],property:[this,"shadowScale"]},{label:"Shadow Height",type:"slider",bounds:[0,20],property:[this,"shadowHeight"]},{label:"Blur Amount",type:"slider",bounds:[0,10],property:[this,"blurAmount"]},...super._extraUiConfig()]}}yy.PluginType="ContactShadowGroundPlugin",fI([vr(yy.prototype.refreshOptions),Yr()],yy.prototype,"contactShadows",void 0),fI([Yr(),vr(yy.prototype._setDirty)],yy.prototype,"blurAmount",void 0),fI([Yr(),vr(yy.prototype._refreshShadowCameraFrustum)],yy.prototype,"shadowScale",void 0),fI([Yr(),vr(yy.prototype._refreshShadowCameraFrustum)],yy.prototype,"shadowHeight",void 0);const cS=new et.cPb(45,1,.1,1e3);function d2(tt,s,o,a=7,_e=new et.Pa4(0,0,1.5)){o=o??tt.scene.modelObject;const rt=new cn().expandByObject(o??s,!0,!0),nt=rt.getCenter(new et.Pa4),ot=rt.getSize(new et.Pa4);cS.position.copy(nt).add(_e.clone().multiplyScalar(Math.max(ot.x,ot.y,ot.z))),cS.lookAt(nt),s&&s.traverseVisible(ht=>{ht.layers.enable(a)}),a>0?cS.layers.set(a):cS.layers.enableAll();const ct=s==null?void 0:s.visible;s&&(s.visible=!0),tt.renderer.rendererObject.setRenderTarget(null),tt.renderer.rendererObject.render(o,cS);const pt=tt.renderer.rendererObject.domElement.toDataURL("image/png");return s&&(s.visible=ct,s.traverseVisible(ht=>{ht.layers.disable(a)}),cS.layers.enableAll()),tt.setDirty(),pt}class p2{constructor(s){this.viewer=s,this._lights=[],this.shapes={sphere:new et.Kj0(new et.xo$(1)),cube:new et.Kj0(new et.DvJ(1,1,1)),cylinder:new et.Kj0(new et.fHI(.5,.5,1))};const o=new et.xsS;this._channel=7;const a=new et.vmT(16777215,4473924,1);a.position.set(0,10,0),a.layers.set(this._channel),o.add(a),this._lights.push(a),this._scene=o}dispose(){[...this._lights].forEach(s=>s.dispose()),Object.values(this.shapes).forEach(s=>{s.geometry&&s.geometry.dispose()})}generate(s,o="sphere"){const a=this.shapes[o]||new et.Kj0(new et.xo$(1));a.material=s.materialObject,a.geometry.attributes.tangent||a.geometry.computeTangents(),this._scene.add(a),this._scene.environment=this.viewer.scene.getEnvironment();const _e=a.material.envMapIntensity;typeof _e=="number"&&(a.material.envMapIntensity=Math.max(_e,2));const rt=d2(this.viewer,a,this._scene,this._channel,new et.Pa4(0,0,1.5));return typeof _e=="number"&&(a.material.envMapIntensity=_e),this._scene.remove(a),a.material=void 0,rt}}class mI extends io{constructor(){super(...arguments),this.enabled=!0,this._uiNeedRefresh=!1,this._refreshUiConfig=()=>{var s,o;this.enabled&&((o=(s=this.uiConfig).uiRefresh)===null||o===void 0||o.call(s))},this.dependencies=[os],this.variations=[],this._selectedMaterial=()=>{var s,o;return((o=(s=this._picking)===null||s===void 0?void 0:s.getSelectedObject())===null||o===void 0?void 0:o.material)||void 0},this.uiConfig={label:"Material Configurator",type:"folder",children:[()=>{var s;return[{type:"input",label:"uuid",property:[this._selectedMaterial(),"uuid"],hidden:()=>!this._selectedMaterial(),disabled:!0},{type:"input",label:"title",hidden:()=>!this._selectedMaterial(),property:()=>[this.getSelectedVariation(),"title"],onChange:async()=>this.refreshUi()},{type:"dropdown",label:"Preview Type",hidden:()=>!this._selectedMaterial(),property:()=>[this.getSelectedVariation(),"preview"],onChange:async()=>this.refreshUi(),children:["generate:sphere","generate:cube","color","map","emissive",...Object.keys(Fw).filter(o=>o.endsWith("Map"))].map(o=>({label:o,value:o}))},...((s=this.getSelectedVariation())===null||s===void 0?void 0:s.materials.map(o=>o.uiConfig?Object.assign(o.uiConfig,{expanded:!1}):{}))||[],{type:"button",label:"Remove All",hidden:()=>!this._selectedMaterial(),value:async()=>{const o=this.getSelectedVariation();o&&await this._viewer.confirm("Material configurator: Remove all variations for this material?")&&(o.materials=[]),this.refreshUi()}},{type:"button",label:"Remove Variation",hidden:()=>!this._selectedMaterial(),value:async()=>{const o=this.getSelectedVariation();o&&await this._viewer.confirm("Material configurator: Remove this variation?")&&this.removeVariation(o)}},{type:"button",label:"Add Variation",hidden:()=>!this._selectedMaterial(),value:()=>this.addVariation(this._selectedMaterial())},{type:"button",label:"Refresh Ui",value:()=>this.refreshUi()}]}]}}async onAdded(s){var o,a;await super.onAdded(s),this.refreshUi=this.refreshUi.bind(this),this._refreshUi=this._refreshUi.bind(this),this._picking=(o=this._viewer)===null||o===void 0?void 0:o.getPluginByType("Picking"),this._previewGenerator=new p2(this._viewer),(a=this._picking)===null||a===void 0||a.addEventListener("selectedObjectChanged",this._refreshUiConfig),s.addEventListener("preFrame",this._refreshUi),this.addEventListener("deserialize",this.refreshUi)}fromJSON(s,o){return this.variations=[],super.fromJSON(s,o)}async onRemove(s){var o,a;return(o=this._previewGenerator)===null||o===void 0||o.dispose(),this._previewGenerator=void 0,(a=this._picking)===null||a===void 0||a.removeEventListener("selectedObjectChanged",this._refreshUiConfig),this.removeEventListener("deserialize",this.refreshUi),s.removeEventListener("preFrame",this._refreshUi),this._picking=void 0,super.onRemove(s)}findVariation(s){return s?this.variations.find(o=>o.uuid===s):void 0}getSelectedVariation(){var s,o;return this.findVariation((s=this._selectedMaterial())===null||s===void 0?void 0:s.uuid)||this.findVariation((o=this._selectedMaterial())===null||o===void 0?void 0:o.name)}applyVariation(s,o){var a,_e;const rt=s.materials.find(nt=>nt.uuid===o);if(rt){const nt=(_e=(a=this._viewer)===null||a===void 0?void 0:a.getManager())===null||_e===void 0?void 0:_e.materials;let ot=nt==null?void 0:nt.findMaterialsByName(s.uuid);(!ot||ot.length<1)&&(ot=[nt==null?void 0:nt.findMaterial(s.uuid)]),ot.forEach(ct=>{if(!ct)return;const pt=ct.name;ct.copyProps(rt),ct.name=pt})}}refreshUi(){this.enabled&&(this._uiNeedRefresh=!0)}async _refreshUi(){return!(!this.enabled||!this._viewer||!this._uiNeedRefresh||(this._uiNeedRefresh=!1,this._refreshUiConfig(),0))}removeVariationForMaterial(s){let o=this.findVariation(s.uuid);!o&&s.name.length>0&&(o=this.findVariation(s.name)),o&&this.removeVariation(o)}removeVariation(s){s&&(this.variations.splice(this.variations.indexOf(s),1),this.refreshUi())}addVariation(s){var o;const a=(o=s==null?void 0:s.clone)===null||o===void 0?void 0:o.call(s);if(s&&a){let _e=this.findVariation(s.uuid);!_e&&s.name.length>0&&(_e=this.findVariation(s.name)),_e||this.variations.push(_e={uuid:s.name.length>0?s.name:s.uuid,title:"Name",preview:"generate:sphere",materials:[]}),_e.materials.push(a),this.refreshUi()}}}mI.PluginType="MaterialConfiguratorBasePlugin",function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);rt>3&&nt&&Object.defineProperty(s,o,nt)}([Yr()],mI.prototype,"variations",void 0);const tO=(tt,s=!0)=>{const o=new ys().set(tt);return s&&o.convertLinearToSRGB(),`data:image/svg+xml,%3Csvg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='16' height='16' fill='%23${o.getHexString()}'/%3E%3C/svg%3E%0A`},rO=(tt,s=!0)=>{const o=new ys().set(tt);return s&&o.convertLinearToSRGB(),`data:image/svg+xml,%3Csvg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='8' cy='8' r='7' fill='%23${o.getHexString()}'/%3E%3C/svg%3E%0A`},vT=tt=>`data:image/svg+xml,%3Csvg viewBox='0 0 80 14' xmlns='http://www.w3.org/2000/svg'%3E%3Ctext style='font: 8px "Roboto Mono", "Source Code Pro", Menlo, Courier, monospace; fill: white;' x='9' y='9'%3E${tt}%3C/text%3E%3C/svg%3E%0A`,h2=async(tt,s)=>Fu(await CA(tt),s),nO=async(tt,s)=>await h2(tt,s).then(o=>o.toDataURL("image/png"));class w0{static _initialize(){this._inited=!0,Jv(Zt`
  .customContextGrid {
    background: #28223C;
    //backdrop-filter: blur(8px);
    border: 0.5px solid rgba(220, 220, 220, 0.3);
    width: auto;
    height: auto;
    position: absolute;
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    z-index: 200;
    padding: 0.35rem 0.35rem;
    border-radius: 0.375rem;
    min-width: 5rem;
    pointer-events: auto;
    box-shadow: 0px 2px 10px rgba(12, 12, 12, 0.2);

    color: white;
    font-size: 0.65rem;
    font-family: Inter, "Roboto Mono", "Source Code Pro", Menlo, Courier, monospace;
  }
  .customContextGridItems {
    background-color: transparent;
    cursor: pointer;
    border-radius: 0.25rem;
    line-height: 1rem;
    font-weight: 500;
    overflow: hidden;
    margin: 0.12rem;
  }
  .customContextGridItems:hover {
    color: white;
    background-color: #017AFF;
  }
  .customContextGridItemImage{
    width: 100%;
    height: 100%;
  }
  .customContextGridHeading{
    width: 100%;
    padding: 0.12rem;
    font-size: 0.85rem;
  }

        `)}static Create(s,o,a,_e,rt,nt,ot){var ct;this._inited||this._initialize();const pt=Nw(),ht=pt?.15:.25,_t=pt?1.5:2.5,Et=Ll({classList:["customContextGrid"],addToBody:!1,innerHTML:`
            <div class="customContextGridHeading"> ${o} </div>
            `});Et.style.top=rt+"px",Et.style.left=_e+"px",Et.style.gap=ht+"rem",Et.style.width=(_t+ht)*a-ht+"rem",Et.dataset.tag=s;for(const St of nt){const Mt=Ll({classList:["customContextGridItems"],addToBody:!1,innerHTML:`
            <img src="${St.image}" class="customContextGridItemImage">
            `});Mt.style.width=_t+"rem",Mt.style.height=_t+"rem",Et.appendChild(Mt),Mt.onclick=()=>{var It;return(It=St.onClick)===null||It===void 0?void 0:It.call(St,St.id)},ot(Mt,St)}return(ct=this.Elements)===null||ct===void 0||ct.push(Et),Et}static RemoveAll(s){if(s){const o=this.Elements.filter(a=>a.dataset.tag===s);for(const a of o)a.remove();this.Elements=this.Elements.filter(a=>a.dataset.tag!==s)}else{for(const o of this.Elements)o.remove();this.Elements=[]}}static RebuildUi(s){if(this.Elements.length===0)return;s||(s=document.body);for(const a of this.Elements)a.remove();let o=20;for(const a of this.Elements)a.style.top=o+"px",s.appendChild(a),o+=a.clientHeight+20}}function x0(tt){if(tt==null)return window;if(tt.toString()!=="[object Window]"){var s=tt.ownerDocument;return s&&s.defaultView||window}return tt}function dS(tt){return tt instanceof x0(tt).Element||tt instanceof Element}function C_(tt){return tt instanceof x0(tt).HTMLElement||tt instanceof HTMLElement}function f2(tt){return typeof ShadowRoot<"u"&&(tt instanceof x0(tt).ShadowRoot||tt instanceof ShadowRoot)}w0.Elements=[],w0._inited=!1;var fx=Math.max,gI=Math.min,pS=Math.round;function hS(tt,s){s===void 0&&(s=!1);var o=tt.getBoundingClientRect(),a=1,_e=1;if(C_(tt)&&s){var rt=tt.offsetHeight,nt=tt.offsetWidth;nt>0&&(a=pS(o.width)/nt||1),rt>0&&(_e=pS(o.height)/rt||1)}return{width:o.width/a,height:o.height/_e,top:o.top/_e,right:o.right/a,bottom:o.bottom/_e,left:o.left/a,x:o.left/a,y:o.top/_e}}function m2(tt){var s=x0(tt);return{scrollLeft:s.pageXOffset,scrollTop:s.pageYOffset}}function Ay(tt){return tt?(tt.nodeName||"").toLowerCase():null}function Tw(tt){return((dS(tt)?tt.ownerDocument:tt.document)||window.document).documentElement}function g2(tt){return hS(Tw(tt)).left+m2(tt).scrollLeft}function mA(tt){return x0(tt).getComputedStyle(tt)}function v2(tt){var s=mA(tt),o=s.overflow,a=s.overflowX,_e=s.overflowY;return/auto|scroll|overlay|hidden/.test(o+_e+a)}function _N(tt,s,o){o===void 0&&(o=!1);var a,_e,rt=C_(s),nt=C_(s)&&function(_t){var Et=_t.getBoundingClientRect(),St=pS(Et.width)/_t.offsetWidth||1,Mt=pS(Et.height)/_t.offsetHeight||1;return St!==1||Mt!==1}(s),ot=Tw(s),ct=hS(tt,nt),pt={scrollLeft:0,scrollTop:0},ht={x:0,y:0};return(rt||!rt&&!o)&&((Ay(s)!=="body"||v2(ot))&&(pt=(a=s)!==x0(a)&&C_(a)?{scrollLeft:(_e=a).scrollLeft,scrollTop:_e.scrollTop}:m2(a)),C_(s)?((ht=hS(s,!0)).x+=s.clientLeft,ht.y+=s.clientTop):ot&&(ht.x=g2(ot))),{x:ct.left+pt.scrollLeft-ht.x,y:ct.top+pt.scrollTop-ht.y,width:ct.width,height:ct.height}}function _2(tt){var s=hS(tt),o=tt.offsetWidth,a=tt.offsetHeight;return Math.abs(s.width-o)<=1&&(o=s.width),Math.abs(s.height-a)<=1&&(a=s.height),{x:tt.offsetLeft,y:tt.offsetTop,width:o,height:a}}function vI(tt){return Ay(tt)==="html"?tt:tt.assignedSlot||tt.parentNode||(f2(tt)?tt.host:null)||Tw(tt)}function iO(tt){return["html","body","#document"].indexOf(Ay(tt))>=0?tt.ownerDocument.body:C_(tt)&&v2(tt)?tt:iO(vI(tt))}function _T(tt,s){var o;s===void 0&&(s=[]);var a=iO(tt),_e=a===((o=tt.ownerDocument)==null?void 0:o.body),rt=x0(a),nt=_e?[rt].concat(rt.visualViewport||[],v2(a)?a:[]):a,ot=s.concat(nt);return _e?ot:ot.concat(_T(vI(nt)))}function yN(tt){return["table","td","th"].indexOf(Ay(tt))>=0}function sO(tt){return C_(tt)&&mA(tt).position!=="fixed"?tt.offsetParent:null}function yT(tt){for(var s=x0(tt),o=sO(tt);o&&yN(o)&&mA(o).position==="static";)o=sO(o);return o&&(Ay(o)==="html"||Ay(o)==="body"&&mA(o).position==="static")?s:o||function(a){var _e=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1;if(navigator.userAgent.indexOf("Trident")!==-1&&C_(a)&&mA(a).position==="fixed")return null;var rt=vI(a);for(f2(rt)&&(rt=rt.host);C_(rt)&&["html","body"].indexOf(Ay(rt))<0;){var nt=mA(rt);if(nt.transform!=="none"||nt.perspective!=="none"||nt.contain==="paint"||["transform","perspective"].indexOf(nt.willChange)!==-1||_e&&nt.willChange==="filter"||_e&&nt.filter&&nt.filter!=="none")return rt;rt=rt.parentNode}return null}(tt)||s}var jm="top",Vv="bottom",Gv="right",zm="left",_I="auto",fS=[jm,Vv,Gv,zm],mx="start",mS="end",oO="clippingParents",y2="viewport",gS="popper",aO="reference",A2=fS.reduce(function(tt,s){return tt.concat([s+"-"+mx,s+"-"+mS])},[]),b2=[].concat(fS,[_I]).reduce(function(tt,s){return tt.concat([s,s+"-"+mx,s+"-"+mS])},[]),lO="beforeRead",uO="read",cO="afterRead",dO="beforeMain",pO="main",hO="afterMain",fO="beforeWrite",mO="write",gO="afterWrite",vO=[lO,uO,cO,dO,pO,hO,fO,mO,gO];function AN(tt){var s=new Map,o=new Set,a=[];function _e(rt){o.add(rt.name),[].concat(rt.requires||[],rt.requiresIfExists||[]).forEach(function(nt){if(!o.has(nt)){var ot=s.get(nt);ot&&_e(ot)}}),a.push(rt)}return tt.forEach(function(rt){s.set(rt.name,rt)}),tt.forEach(function(rt){o.has(rt.name)||_e(rt)}),a}var _O={placement:"bottom",modifiers:[],strategy:"absolute"};function yO(){for(var tt=arguments.length,s=new Array(tt),o=0;o<tt;o++)s[o]=arguments[o];return!s.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function yI(tt){tt===void 0&&(tt={});var s=tt,o=s.defaultModifiers,a=o===void 0?[]:o,_e=s.defaultOptions,rt=_e===void 0?_O:_e;return function(nt,ot,ct){ct===void 0&&(ct=rt);var pt,ht,_t={placement:"bottom",orderedModifiers:[],options:Object.assign({},_O,rt),modifiersData:{},elements:{reference:nt,popper:ot},attributes:{},styles:{}},Et=[],St=!1,Mt={state:_t,setOptions:function(Nt){var Bt=typeof Nt=="function"?Nt(_t.options):Nt;It(),_t.options=Object.assign({},rt,_t.options,Bt),_t.scrollParents={reference:dS(nt)?_T(nt):nt.contextElement?_T(nt.contextElement):[],popper:_T(ot)};var kt,Pt,qt=function(Kt){var nr=AN(Kt);return vO.reduce(function(ir,fr){return ir.concat(nr.filter(function(br){return br.phase===fr}))},[])}((kt=[].concat(a,_t.options.modifiers),Pt=kt.reduce(function(Kt,nr){var ir=Kt[nr.name];return Kt[nr.name]=ir?Object.assign({},ir,nr,{options:Object.assign({},ir.options,nr.options),data:Object.assign({},ir.data,nr.data)}):nr,Kt},{}),Object.keys(Pt).map(function(Kt){return Pt[Kt]})));return _t.orderedModifiers=qt.filter(function(Kt){return Kt.enabled}),_t.orderedModifiers.forEach(function(Kt){var nr=Kt.name,ir=Kt.options,fr=ir===void 0?{}:ir,br=Kt.effect;if(typeof br=="function"){var Tr=br({state:_t,name:nr,instance:Mt,options:fr});Et.push(Tr||function(){})}}),Mt.update()},forceUpdate:function(){if(!St){var Nt=_t.elements,Bt=Nt.reference,kt=Nt.popper;if(yO(Bt,kt)){_t.rects={reference:_N(Bt,yT(kt),_t.options.strategy==="fixed"),popper:_2(kt)},_t.reset=!1,_t.placement=_t.options.placement,_t.orderedModifiers.forEach(function(br){return _t.modifiersData[br.name]=Object.assign({},br.data)});for(var Pt=0;Pt<_t.orderedModifiers.length;Pt++)if(_t.reset!==!0){var qt=_t.orderedModifiers[Pt],Kt=qt.fn,nr=qt.options,ir=nr===void 0?{}:nr,fr=qt.name;typeof Kt=="function"&&(_t=Kt({state:_t,options:ir,name:fr,instance:Mt})||_t)}else _t.reset=!1,Pt=-1}}},update:(pt=function(){return new Promise(function(Nt){Mt.forceUpdate(),Nt(_t)})},function(){return ht||(ht=new Promise(function(Nt){Promise.resolve().then(function(){ht=void 0,Nt(pt())})})),ht}),destroy:function(){It(),St=!0}};if(!yO(nt,ot))return Mt;function It(){Et.forEach(function(Nt){return Nt()}),Et=[]}return Mt.setOptions(ct).then(function(Nt){!St&&ct.onFirstUpdate&&ct.onFirstUpdate(Nt)}),Mt}}var bN=yI(),AI={passive:!0},w2={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(tt){var s=tt.state,o=tt.instance,a=tt.options,_e=a.scroll,rt=_e===void 0||_e,nt=a.resize,ot=nt===void 0||nt,ct=x0(s.elements.popper),pt=[].concat(s.scrollParents.reference,s.scrollParents.popper);return rt&&pt.forEach(function(ht){ht.addEventListener("scroll",o.update,AI)}),ot&&ct.addEventListener("resize",o.update,AI),function(){rt&&pt.forEach(function(ht){ht.removeEventListener("scroll",o.update,AI)}),ot&&ct.removeEventListener("resize",o.update,AI)}},data:{}};function by(tt){return tt.split("-")[0]}function vS(tt){return tt.split("-")[1]}function x2(tt){return["top","bottom"].indexOf(tt)>=0?"x":"y"}function AO(tt){var s,o=tt.reference,a=tt.element,_e=tt.placement,rt=_e?by(_e):null,nt=_e?vS(_e):null,ot=o.x+o.width/2-a.width/2,ct=o.y+o.height/2-a.height/2;switch(rt){case jm:s={x:ot,y:o.y-a.height};break;case Vv:s={x:ot,y:o.y+o.height};break;case Gv:s={x:o.x+o.width,y:ct};break;case zm:s={x:o.x-a.width,y:ct};break;default:s={x:o.x,y:o.y}}var pt=rt?x2(rt):null;if(pt!=null){var ht=pt==="y"?"height":"width";switch(nt){case mx:s[pt]=s[pt]-(o[ht]/2-a[ht]/2);break;case mS:s[pt]=s[pt]+(o[ht]/2-a[ht]/2)}}return s}var E2={name:"popperOffsets",enabled:!0,phase:"read",fn:function(tt){var s=tt.state,o=tt.name;s.modifiersData[o]=AO({reference:s.rects.reference,element:s.rects.popper,strategy:"absolute",placement:s.placement})},data:{}},wN={top:"auto",right:"auto",bottom:"auto",left:"auto"};function bO(tt){var s,o=tt.popper,a=tt.popperRect,_e=tt.placement,rt=tt.variation,nt=tt.offsets,ot=tt.position,ct=tt.gpuAcceleration,pt=tt.adaptive,ht=tt.roundOffsets,_t=tt.isFixed,Et=nt.x,St=Et===void 0?0:Et,Mt=nt.y,It=Mt===void 0?0:Mt,Nt=typeof ht=="function"?ht({x:St,y:It}):{x:St,y:It};St=Nt.x,It=Nt.y;var Bt=nt.hasOwnProperty("x"),kt=nt.hasOwnProperty("y"),Pt=zm,qt=jm,Kt=window;if(pt){var nr=yT(o),ir="clientHeight",fr="clientWidth";nr===x0(o)&&mA(nr=Tw(o)).position!=="static"&&ot==="absolute"&&(ir="scrollHeight",fr="scrollWidth"),(_e===jm||(_e===zm||_e===Gv)&&rt===mS)&&(qt=Vv,It-=(_t&&nr===Kt&&Kt.visualViewport?Kt.visualViewport.height:nr[ir])-a.height,It*=ct?1:-1),_e!==zm&&(_e!==jm&&_e!==Vv||rt!==mS)||(Pt=Gv,St-=(_t&&nr===Kt&&Kt.visualViewport?Kt.visualViewport.width:nr[fr])-a.width,St*=ct?1:-1)}var br,Tr=Object.assign({position:ot},pt&&wN),Dr=ht===!0?function(Rr){var Nr=Rr.x,Ir=Rr.y,kr=window.devicePixelRatio||1;return{x:pS(Nr*kr)/kr||0,y:pS(Ir*kr)/kr||0}}({x:St,y:It}):{x:St,y:It};return St=Dr.x,It=Dr.y,ct?Object.assign({},Tr,((br={})[qt]=kt?"0":"",br[Pt]=Bt?"0":"",br.transform=(Kt.devicePixelRatio||1)<=1?"translate("+St+"px, "+It+"px)":"translate3d("+St+"px, "+It+"px, 0)",br)):Object.assign({},Tr,((s={})[qt]=kt?It+"px":"",s[Pt]=Bt?St+"px":"",s.transform="",s))}var S2={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(tt){var s=tt.state,o=tt.options,a=o.gpuAcceleration,_e=a===void 0||a,rt=o.adaptive,nt=rt===void 0||rt,ot=o.roundOffsets,ct=ot===void 0||ot,pt={placement:by(s.placement),variation:vS(s.placement),popper:s.elements.popper,popperRect:s.rects.popper,gpuAcceleration:_e,isFixed:s.options.strategy==="fixed"};s.modifiersData.popperOffsets!=null&&(s.styles.popper=Object.assign({},s.styles.popper,bO(Object.assign({},pt,{offsets:s.modifiersData.popperOffsets,position:s.options.strategy,adaptive:nt,roundOffsets:ct})))),s.modifiersData.arrow!=null&&(s.styles.arrow=Object.assign({},s.styles.arrow,bO(Object.assign({},pt,{offsets:s.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:ct})))),s.attributes.popper=Object.assign({},s.attributes.popper,{"data-popper-placement":s.placement})},data:{}},bI={name:"applyStyles",enabled:!0,phase:"write",fn:function(tt){var s=tt.state;Object.keys(s.elements).forEach(function(o){var a=s.styles[o]||{},_e=s.attributes[o]||{},rt=s.elements[o];C_(rt)&&Ay(rt)&&(Object.assign(rt.style,a),Object.keys(_e).forEach(function(nt){var ot=_e[nt];ot===!1?rt.removeAttribute(nt):rt.setAttribute(nt,ot===!0?"":ot)}))})},effect:function(tt){var s=tt.state,o={popper:{position:s.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(s.elements.popper.style,o.popper),s.styles=o,s.elements.arrow&&Object.assign(s.elements.arrow.style,o.arrow),function(){Object.keys(s.elements).forEach(function(a){var _e=s.elements[a],rt=s.attributes[a]||{},nt=Object.keys(s.styles.hasOwnProperty(a)?s.styles[a]:o[a]).reduce(function(ot,ct){return ot[ct]="",ot},{});C_(_e)&&Ay(_e)&&(Object.assign(_e.style,nt),Object.keys(rt).forEach(function(ot){_e.removeAttribute(ot)}))})}},requires:["computeStyles"]},wO={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(tt){var s=tt.state,o=tt.options,a=tt.name,_e=o.offset,rt=_e===void 0?[0,0]:_e,nt=b2.reduce(function(ht,_t){return ht[_t]=function(Et,St,Mt){var It=by(Et),Nt=[zm,jm].indexOf(It)>=0?-1:1,Bt=typeof Mt=="function"?Mt(Object.assign({},St,{placement:Et})):Mt,kt=Bt[0],Pt=Bt[1];return kt=kt||0,Pt=(Pt||0)*Nt,[zm,Gv].indexOf(It)>=0?{x:Pt,y:kt}:{x:kt,y:Pt}}(_t,s.rects,rt),ht},{}),ot=nt[s.placement],ct=ot.x,pt=ot.y;s.modifiersData.popperOffsets!=null&&(s.modifiersData.popperOffsets.x+=ct,s.modifiersData.popperOffsets.y+=pt),s.modifiersData[a]=nt}},xN={left:"right",right:"left",bottom:"top",top:"bottom"};function wI(tt){return tt.replace(/left|right|bottom|top/g,function(s){return xN[s]})}var EN={start:"end",end:"start"};function xO(tt){return tt.replace(/start|end/g,function(s){return EN[s]})}function EO(tt,s){var o=s.getRootNode&&s.getRootNode();if(tt.contains(s))return!0;if(o&&f2(o)){var a=s;do{if(a&&tt.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function C2(tt){return Object.assign({},tt,{left:tt.x,top:tt.y,right:tt.x+tt.width,bottom:tt.y+tt.height})}function SO(tt,s){return s===y2?C2(function(o){var a=x0(o),_e=Tw(o),rt=a.visualViewport,nt=_e.clientWidth,ot=_e.clientHeight,ct=0,pt=0;return rt&&(nt=rt.width,ot=rt.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(ct=rt.offsetLeft,pt=rt.offsetTop)),{width:nt,height:ot,x:ct+g2(o),y:pt}}(tt)):dS(s)?function(o){var a=hS(o);return a.top=a.top+o.clientTop,a.left=a.left+o.clientLeft,a.bottom=a.top+o.clientHeight,a.right=a.left+o.clientWidth,a.width=o.clientWidth,a.height=o.clientHeight,a.x=a.left,a.y=a.top,a}(s):C2(function(o){var a,_e=Tw(o),rt=m2(o),nt=(a=o.ownerDocument)==null?void 0:a.body,ot=fx(_e.scrollWidth,_e.clientWidth,nt?nt.scrollWidth:0,nt?nt.clientWidth:0),ct=fx(_e.scrollHeight,_e.clientHeight,nt?nt.scrollHeight:0,nt?nt.clientHeight:0),pt=-rt.scrollLeft+g2(o),ht=-rt.scrollTop;return mA(nt||_e).direction==="rtl"&&(pt+=fx(_e.clientWidth,nt?nt.clientWidth:0)-ot),{width:ot,height:ct,x:pt,y:ht}}(Tw(tt)))}function CO(tt){return Object.assign({},{top:0,right:0,bottom:0,left:0},tt)}function TO(tt,s){return s.reduce(function(o,a){return o[a]=tt,o},{})}function _S(tt,s){s===void 0&&(s={});var o=s,a=o.placement,_e=a===void 0?tt.placement:a,rt=o.boundary,nt=rt===void 0?oO:rt,ot=o.rootBoundary,ct=ot===void 0?y2:ot,pt=o.elementContext,ht=pt===void 0?gS:pt,_t=o.altBoundary,Et=_t!==void 0&&_t,St=o.padding,Mt=St===void 0?0:St,It=CO(typeof Mt!="number"?Mt:TO(Mt,fS)),Nt=ht===gS?aO:gS,Bt=tt.rects.popper,kt=tt.elements[Et?Nt:ht],Pt=function(Dr,Rr,Nr){var Ir=Rr==="clippingParents"?function(en){var vn=_T(vI(en)),wn=["absolute","fixed"].indexOf(mA(en).position)>=0&&C_(en)?yT(en):en;return dS(wn)?vn.filter(function(pn){return dS(pn)&&EO(pn,wn)&&Ay(pn)!=="body"}):[]}(Dr):[].concat(Rr),kr=[].concat(Ir,[Nr]),Hr=kr[0],Lr=kr.reduce(function(en,vn){var wn=SO(Dr,vn);return en.top=fx(wn.top,en.top),en.right=gI(wn.right,en.right),en.bottom=gI(wn.bottom,en.bottom),en.left=fx(wn.left,en.left),en},SO(Dr,Hr));return Lr.width=Lr.right-Lr.left,Lr.height=Lr.bottom-Lr.top,Lr.x=Lr.left,Lr.y=Lr.top,Lr}(dS(kt)?kt:kt.contextElement||Tw(tt.elements.popper),nt,ct),qt=hS(tt.elements.reference),Kt=AO({reference:qt,element:Bt,strategy:"absolute",placement:_e}),nr=C2(Object.assign({},Bt,Kt)),ir=ht===gS?nr:qt,fr={top:Pt.top-ir.top+It.top,bottom:ir.bottom-Pt.bottom+It.bottom,left:Pt.left-ir.left+It.left,right:ir.right-Pt.right+It.right},br=tt.modifiersData.offset;if(ht===gS&&br){var Tr=br[_e];Object.keys(fr).forEach(function(Dr){var Rr=[Gv,Vv].indexOf(Dr)>=0?1:-1,Nr=[jm,Vv].indexOf(Dr)>=0?"y":"x";fr[Dr]+=Tr[Nr]*Rr})}return fr}var MO={name:"flip",enabled:!0,phase:"main",fn:function(tt){var s=tt.state,o=tt.options,a=tt.name;if(!s.modifiersData[a]._skip){for(var _e=o.mainAxis,rt=_e===void 0||_e,nt=o.altAxis,ot=nt===void 0||nt,ct=o.fallbackPlacements,pt=o.padding,ht=o.boundary,_t=o.rootBoundary,Et=o.altBoundary,St=o.flipVariations,Mt=St===void 0||St,It=o.allowedAutoPlacements,Nt=s.options.placement,Bt=by(Nt),kt=ct||(Bt!==Nt&&Mt?function(pn){if(by(pn)===_I)return[];var Fn=wI(pn);return[xO(pn),Fn,xO(Fn)]}(Nt):[wI(Nt)]),Pt=[Nt].concat(kt).reduce(function(pn,Fn){return pn.concat(by(Fn)===_I?function(Gn,Qn){Qn===void 0&&(Qn={});var Yn=Qn,bs=Yn.placement,Cn=Yn.boundary,eo=Yn.rootBoundary,vo=Yn.padding,to=Yn.flipVariations,zo=Yn.allowedAutoPlacements,Sl=zo===void 0?b2:zo,yn=vS(bs),qn=yn?to?A2:A2.filter(function(yl){return vS(yl)===yn}):fS,Wn=qn.filter(function(yl){return Sl.indexOf(yl)>=0});Wn.length===0&&(Wn=qn);var ro=Wn.reduce(function(yl,xr){return yl[xr]=_S(Gn,{placement:xr,boundary:Cn,rootBoundary:eo,padding:vo})[by(xr)],yl},{});return Object.keys(ro).sort(function(yl,xr){return ro[yl]-ro[xr]})}(s,{placement:Fn,boundary:ht,rootBoundary:_t,padding:pt,flipVariations:Mt,allowedAutoPlacements:It}):Fn)},[]),qt=s.rects.reference,Kt=s.rects.popper,nr=new Map,ir=!0,fr=Pt[0],br=0;br<Pt.length;br++){var Tr=Pt[br],Dr=by(Tr),Rr=vS(Tr)===mx,Nr=[jm,Vv].indexOf(Dr)>=0,Ir=Nr?"width":"height",kr=_S(s,{placement:Tr,boundary:ht,rootBoundary:_t,altBoundary:Et,padding:pt}),Hr=Nr?Rr?Gv:zm:Rr?Vv:jm;qt[Ir]>Kt[Ir]&&(Hr=wI(Hr));var Lr=wI(Hr),en=[];if(rt&&en.push(kr[Dr]<=0),ot&&en.push(kr[Hr]<=0,kr[Lr]<=0),en.every(function(pn){return pn})){fr=Tr,ir=!1;break}nr.set(Tr,en)}if(ir)for(var vn=function(pn){var Fn=Pt.find(function(Gn){var Qn=nr.get(Gn);if(Qn)return Qn.slice(0,pn).every(function(Yn){return Yn})});if(Fn)return fr=Fn,"break"},wn=Mt?3:1;wn>0&&vn(wn)!=="break";wn--);s.placement!==fr&&(s.modifiersData[a]._skip=!0,s.placement=fr,s.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function AT(tt,s,o){return fx(tt,gI(s,o))}var RO={name:"preventOverflow",enabled:!0,phase:"main",fn:function(tt){var s=tt.state,o=tt.options,a=tt.name,_e=o.mainAxis,rt=_e===void 0||_e,nt=o.altAxis,ot=nt!==void 0&&nt,ct=o.boundary,pt=o.rootBoundary,ht=o.altBoundary,_t=o.padding,Et=o.tether,St=Et===void 0||Et,Mt=o.tetherOffset,It=Mt===void 0?0:Mt,Nt=_S(s,{boundary:ct,rootBoundary:pt,padding:_t,altBoundary:ht}),Bt=by(s.placement),kt=vS(s.placement),Pt=!kt,qt=x2(Bt),Kt=qt==="x"?"y":"x",nr=s.modifiersData.popperOffsets,ir=s.rects.reference,fr=s.rects.popper,br=typeof It=="function"?It(Object.assign({},s.rects,{placement:s.placement})):It,Tr=typeof br=="number"?{mainAxis:br,altAxis:br}:Object.assign({mainAxis:0,altAxis:0},br),Dr=s.modifiersData.offset?s.modifiersData.offset[s.placement]:null,Rr={x:0,y:0};if(nr){if(rt){var Nr,Ir=qt==="y"?jm:zm,kr=qt==="y"?Vv:Gv,Hr=qt==="y"?"height":"width",Lr=nr[qt],en=Lr+Nt[Ir],vn=Lr-Nt[kr],wn=St?-fr[Hr]/2:0,pn=kt===mx?ir[Hr]:fr[Hr],Fn=kt===mx?-fr[Hr]:-ir[Hr],Gn=s.elements.arrow,Qn=St&&Gn?_2(Gn):{width:0,height:0},Yn=s.modifiersData["arrow#persistent"]?s.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},bs=Yn[Ir],Cn=Yn[kr],eo=AT(0,ir[Hr],Qn[Hr]),vo=Pt?ir[Hr]/2-wn-eo-bs-Tr.mainAxis:pn-eo-bs-Tr.mainAxis,to=Pt?-ir[Hr]/2+wn+eo+Cn+Tr.mainAxis:Fn+eo+Cn+Tr.mainAxis,zo=s.elements.arrow&&yT(s.elements.arrow),Sl=zo?qt==="y"?zo.clientTop||0:zo.clientLeft||0:0,yn=(Nr=Dr==null?void 0:Dr[qt])!=null?Nr:0,qn=Lr+to-yn,Wn=AT(St?gI(en,Lr+vo-yn-Sl):en,Lr,St?fx(vn,qn):vn);nr[qt]=Wn,Rr[qt]=Wn-Lr}if(ot){var ro,yl=qt==="x"?jm:zm,xr=qt==="x"?Vv:Gv,Qr=nr[Kt],Sr=Kt==="y"?"height":"width",Xr=Qr+Nt[yl],un=Qr-Nt[xr],Kr=[jm,zm].indexOf(Bt)!==-1,_n=(ro=Dr==null?void 0:Dr[Kt])!=null?ro:0,Jn=Kr?Xr:Qr-ir[Sr]-fr[Sr]-_n+Tr.altAxis,us=Kr?Qr+ir[Sr]+fr[Sr]-_n-Tr.altAxis:un,_s=St&&Kr?function(vs,ws,fs){var cs=AT(vs,ws,fs);return cs>fs?fs:cs}(Jn,Qr,us):AT(St?Jn:Xr,Qr,St?us:un);nr[Kt]=_s,Rr[Kt]=_s-Qr}s.modifiersData[a]=Rr}},requiresIfExists:["offset"]},IO={name:"arrow",enabled:!0,phase:"main",fn:function(tt){var s,o=tt.state,a=tt.name,_e=tt.options,rt=o.elements.arrow,nt=o.modifiersData.popperOffsets,ot=by(o.placement),ct=x2(ot),pt=[zm,Gv].indexOf(ot)>=0?"height":"width";if(rt&&nt){var ht=function(fr,br){return CO(typeof(fr=typeof fr=="function"?fr(Object.assign({},br.rects,{placement:br.placement})):fr)!="number"?fr:TO(fr,fS))}(_e.padding,o),_t=_2(rt),Et=ct==="y"?jm:zm,St=ct==="y"?Vv:Gv,Mt=o.rects.reference[pt]+o.rects.reference[ct]-nt[ct]-o.rects.popper[pt],It=nt[ct]-o.rects.reference[ct],Nt=yT(rt),Bt=Nt?ct==="y"?Nt.clientHeight||0:Nt.clientWidth||0:0,kt=Mt/2-It/2,Pt=ht[Et],qt=Bt-_t[pt]-ht[St],Kt=Bt/2-_t[pt]/2+kt,nr=AT(Pt,Kt,qt),ir=ct;o.modifiersData[a]=((s={})[ir]=nr,s.centerOffset=nr-Kt,s)}},effect:function(tt){var s=tt.state,o=tt.options.element,a=o===void 0?"[data-popper-arrow]":o;a!=null&&(typeof a!="string"||(a=s.elements.popper.querySelector(a)))&&EO(s.elements.popper,a)&&(s.elements.arrow=a)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function PO(tt,s,o){return o===void 0&&(o={x:0,y:0}),{top:tt.top-s.height-o.y,right:tt.right-s.width+o.x,bottom:tt.bottom-s.height+o.y,left:tt.left-s.width-o.x}}function DO(tt){return[jm,Gv,Vv,zm].some(function(s){return tt[s]>=0})}var BO={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(tt){var s=tt.state,o=tt.name,a=s.rects.reference,_e=s.rects.popper,rt=s.modifiersData.preventOverflow,nt=_S(s,{elementContext:"reference"}),ot=_S(s,{altBoundary:!0}),ct=PO(nt,a),pt=PO(ot,_e,rt),ht=DO(ct),_t=DO(pt);s.modifiersData[o]={referenceClippingOffsets:ct,popperEscapeOffsets:pt,isReferenceHidden:ht,hasPopperEscaped:_t},s.attributes.popper=Object.assign({},s.attributes.popper,{"data-popper-reference-hidden":ht,"data-popper-escaped":_t})}},kO=yI({defaultModifiers:[w2,E2,S2,bI,wO,MO,RO,IO,BO]}),OO="tippy-content",LO="tippy-arrow",NO="tippy-svg-arrow",gx={passive:!0,capture:!0},FO=function(){return document.body};function T2(tt,s,o){if(Array.isArray(tt)){var a=tt[s];return a??(Array.isArray(o)?o[s]:o)}return tt}function M2(tt,s){var o={}.toString.call(tt);return o.indexOf("[object")===0&&o.indexOf(s+"]")>-1}function UO(tt,s){return typeof tt=="function"?tt.apply(void 0,s):tt}function $O(tt,s){return s===0?tt:function(a){clearTimeout(o),o=setTimeout(function(){tt(a)},s)};var o}function yS(tt){return[].concat(tt)}function jO(tt,s){tt.indexOf(s)===-1&&tt.push(s)}function xI(tt){return[].slice.call(tt)}function zO(tt){return Object.keys(tt).reduce(function(s,o){return tt[o]!==void 0&&(s[o]=tt[o]),s},{})}function bT(){return document.createElement("div")}function EI(tt){return["Element","Fragment"].some(function(s){return M2(tt,s)})}function R2(tt,s){tt.forEach(function(o){o&&(o.style.transitionDuration=s+"ms")})}function VO(tt,s){tt.forEach(function(o){o&&o.setAttribute("data-state",s)})}function I2(tt,s,o){var a=s+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(_e){tt[a](_e,o)})}function GO(tt,s){for(var o=s;o;){var a;if(tt.contains(o))return!0;o=o.getRootNode==null||(a=o.getRootNode())==null?void 0:a.host}return!1}var wy={isTouch:!1},QO=0;function SN(){wy.isTouch||(wy.isTouch=!0,window.performance&&document.addEventListener("mousemove",HO))}function HO(){var tt=performance.now();tt-QO<20&&(wy.isTouch=!1,document.removeEventListener("mousemove",HO)),QO=tt}function CN(){var tt,s=document.activeElement;if((tt=s)&&tt._tippy&&tt._tippy.reference===tt){var o=s._tippy;s.blur&&!o.state.isVisible&&s.blur()}}var TN=!(typeof window>"u"||typeof document>"u"||!window.msCrypto),E0=Object.assign({appendTo:FO,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},{animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),MN=Object.keys(E0);function qO(tt){var s=(tt.plugins||[]).reduce(function(o,a){var _e,rt=a.name,nt=a.defaultValue;return rt&&(o[rt]=tt[rt]!==void 0?tt[rt]:(_e=E0[rt])!=null?_e:nt),o},{});return Object.assign({},tt,s)}function WO(tt,s){var o=Object.assign({},s,{content:UO(s.content,[tt])},s.ignoreAttributes?{}:function(a,_e){return(_e?Object.keys(qO(Object.assign({},E0,{plugins:_e}))):MN).reduce(function(rt,nt){var ot=(a.getAttribute("data-tippy-"+nt)||"").trim();if(!ot)return rt;if(nt==="content")rt[nt]=ot;else try{rt[nt]=JSON.parse(ot)}catch{rt[nt]=ot}return rt},{})}(tt,s.plugins));return o.aria=Object.assign({},E0.aria,o.aria),o.aria={expanded:o.aria.expanded==="auto"?s.interactive:o.aria.expanded,content:o.aria.content==="auto"?s.interactive?null:"describedby":o.aria.content},o}function P2(tt,s){tt.innerHTML=s}function YO(tt){var s=bT();return tt===!0?s.className=LO:(s.className=NO,EI(tt)?s.appendChild(tt):P2(s,tt)),s}function KO(tt,s){EI(s.content)?(P2(tt,""),tt.appendChild(s.content)):typeof s.content!="function"&&(s.allowHTML?P2(tt,s.content):tt.textContent=s.content)}function D2(tt){var s=tt.firstElementChild,o=xI(s.children);return{box:s,content:o.find(function(a){return a.classList.contains(OO)}),arrow:o.find(function(a){return a.classList.contains(LO)||a.classList.contains(NO)}),backdrop:o.find(function(a){return a.classList.contains("tippy-backdrop")})}}function XO(tt){var s=bT(),o=bT();o.className="tippy-box",o.setAttribute("data-state","hidden"),o.setAttribute("tabindex","-1");var a=bT();function _e(rt,nt){var ot=D2(s),ct=ot.box,pt=ot.content,ht=ot.arrow;nt.theme?ct.setAttribute("data-theme",nt.theme):ct.removeAttribute("data-theme"),typeof nt.animation=="string"?ct.setAttribute("data-animation",nt.animation):ct.removeAttribute("data-animation"),nt.inertia?ct.setAttribute("data-inertia",""):ct.removeAttribute("data-inertia"),ct.style.maxWidth=typeof nt.maxWidth=="number"?nt.maxWidth+"px":nt.maxWidth,nt.role?ct.setAttribute("role",nt.role):ct.removeAttribute("role"),rt.content===nt.content&&rt.allowHTML===nt.allowHTML||KO(pt,tt.props),nt.arrow?ht?rt.arrow!==nt.arrow&&(ct.removeChild(ht),ct.appendChild(YO(nt.arrow))):ct.appendChild(YO(nt.arrow)):ht&&ct.removeChild(ht)}return a.className=OO,a.setAttribute("data-state","hidden"),KO(a,tt.props),s.appendChild(o),o.appendChild(a),_e(tt.props,tt.props),{popper:s,onUpdate:_e}}XO.$$tippy=!0;var RN=1,SI=[],B2=[];function IN(tt,s){var o,a,_e,rt,nt,ot,ct,pt,ht=WO(tt,Object.assign({},E0,qO(zO(s)))),_t=!1,Et=!1,St=!1,Mt=!1,It=[],Nt=$O(zo,ht.interactiveDebounce),Bt=RN++,kt=(pt=ht.plugins).filter(function(Sr,Xr){return pt.indexOf(Sr)===Xr}),Pt={id:Bt,reference:tt,popper:bT(),popperInstance:null,props:ht,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:kt,clearDelayTimeouts:function(){clearTimeout(o),clearTimeout(a),cancelAnimationFrame(_e)},setProps:function(Sr){if(!Pt.state.isDestroyed){Lr("onBeforeUpdate",[Pt,Sr]),vo();var Xr=Pt.props,un=WO(tt,Object.assign({},Xr,zO(Sr),{ignoreAttributes:!0}));Pt.props=un,eo(),Xr.interactiveDebounce!==un.interactiveDebounce&&(wn(),Nt=$O(zo,un.interactiveDebounce)),Xr.triggerTarget&&!un.triggerTarget?yS(Xr.triggerTarget).forEach(function(Kr){Kr.removeAttribute("aria-expanded")}):un.triggerTarget&&tt.removeAttribute("aria-expanded"),vn(),Hr(),nr&&nr(Xr,un),Pt.popperInstance&&(Wn(),yl().forEach(function(Kr){requestAnimationFrame(Kr._tippy.popperInstance.forceUpdate)})),Lr("onAfterUpdate",[Pt,Sr])}},setContent:function(Sr){Pt.setProps({content:Sr})},show:function(){var Sr=Pt.state.isVisible,Xr=Pt.state.isDestroyed,un=!Pt.state.isEnabled,Kr=wy.isTouch&&!Pt.props.touch,_n=T2(Pt.props.duration,0,E0.duration);if(!(Sr||Xr||un||Kr||Rr().hasAttribute("disabled")||(Lr("onShow",[Pt],!1),Pt.props.onShow(Pt)===!1))){if(Pt.state.isVisible=!0,Dr()&&(Kt.style.visibility="visible"),Hr(),Qn(),Pt.state.isMounted||(Kt.style.transition="none"),Dr()){var Jn=Ir();R2([Jn.box,Jn.content],0)}var us,_s,vs;ot=function(){var ws;if(Pt.state.isVisible&&!Mt){if(Mt=!0,Kt.offsetHeight,Kt.style.transition=Pt.props.moveTransition,Dr()&&Pt.props.animation){var fs=Ir(),cs=fs.box,Is=fs.content;R2([cs,Is],_n),VO([cs,Is],"visible")}en(),vn(),jO(B2,Pt),(ws=Pt.popperInstance)==null||ws.forceUpdate(),Lr("onMount",[Pt]),Pt.props.animation&&Dr()&&function(ns,ks){bs(ns,function(){Pt.state.isShown=!0,Lr("onShown",[Pt])})}(_n)}},_s=Pt.props.appendTo,vs=Rr(),(us=Pt.props.interactive&&_s===FO||_s==="parent"?vs.parentNode:UO(_s,[vs])).contains(Kt)||us.appendChild(Kt),Pt.state.isMounted=!0,Wn()}},hide:function(){var Sr=!Pt.state.isVisible,Xr=Pt.state.isDestroyed,un=!Pt.state.isEnabled,Kr=T2(Pt.props.duration,1,E0.duration);if(!(Sr||Xr||un)&&(Lr("onHide",[Pt],!1),Pt.props.onHide(Pt)!==!1)){if(Pt.state.isVisible=!1,Pt.state.isShown=!1,Mt=!1,_t=!1,Dr()&&(Kt.style.visibility="hidden"),wn(),Yn(),Hr(!0),Dr()){var _n=Ir(),Jn=_n.box,us=_n.content;Pt.props.animation&&(R2([Jn,us],Kr),VO([Jn,us],"hidden"))}en(),vn(),Pt.props.animation?Dr()&&function(_s,vs){bs(_s,function(){!Pt.state.isVisible&&Kt.parentNode&&Kt.parentNode.contains(Kt)&&vs()})}(Kr,Pt.unmount):Pt.unmount()}},hideWithInteractivity:function(Sr){Nr().addEventListener("mousemove",Nt),jO(SI,Nt),Nt(Sr)},enable:function(){Pt.state.isEnabled=!0},disable:function(){Pt.hide(),Pt.state.isEnabled=!1},unmount:function(){Pt.state.isVisible&&Pt.hide(),Pt.state.isMounted&&(ro(),yl().forEach(function(Sr){Sr._tippy.unmount()}),Kt.parentNode&&Kt.parentNode.removeChild(Kt),B2=B2.filter(function(Sr){return Sr!==Pt}),Pt.state.isMounted=!1,Lr("onHidden",[Pt]))},destroy:function(){Pt.state.isDestroyed||(Pt.clearDelayTimeouts(),Pt.unmount(),vo(),delete tt._tippy,Pt.state.isDestroyed=!0,Lr("onDestroy",[Pt]))}};if(!ht.render)return Pt;var qt=ht.render(Pt),Kt=qt.popper,nr=qt.onUpdate;Kt.setAttribute("data-tippy-root",""),Kt.id="tippy-"+Pt.id,Pt.popper=Kt,tt._tippy=Pt,Kt._tippy=Pt;var ir=kt.map(function(Sr){return Sr.fn(Pt)}),fr=tt.hasAttribute("aria-expanded");return eo(),vn(),Hr(),Lr("onCreate",[Pt]),ht.showOnCreate&&xr(),Kt.addEventListener("mouseenter",function(){Pt.props.interactive&&Pt.state.isVisible&&Pt.clearDelayTimeouts()}),Kt.addEventListener("mouseleave",function(){Pt.props.interactive&&Pt.props.trigger.indexOf("mouseenter")>=0&&Nr().addEventListener("mousemove",Nt)}),Pt;function br(){var Sr=Pt.props.touch;return Array.isArray(Sr)?Sr:[Sr,0]}function Tr(){return br()[0]==="hold"}function Dr(){var Sr;return!((Sr=Pt.props.render)==null||!Sr.$$tippy)}function Rr(){return ct||tt}function Nr(){var Sr,Xr,un=Rr().parentNode;return un&&(Xr=yS(un)[0])!=null&&(Sr=Xr.ownerDocument)!=null&&Sr.body?Xr.ownerDocument:document}function Ir(){return D2(Kt)}function kr(Sr){return Pt.state.isMounted&&!Pt.state.isVisible||wy.isTouch||rt&&rt.type==="focus"?0:T2(Pt.props.delay,Sr?0:1,E0.delay)}function Hr(Sr){Sr===void 0&&(Sr=!1),Kt.style.pointerEvents=Pt.props.interactive&&!Sr?"":"none",Kt.style.zIndex=""+Pt.props.zIndex}function Lr(Sr,Xr,un){var Kr;un===void 0&&(un=!0),ir.forEach(function(_n){_n[Sr]&&_n[Sr].apply(_n,Xr)}),un&&(Kr=Pt.props)[Sr].apply(Kr,Xr)}function en(){var Sr=Pt.props.aria;if(Sr.content){var Xr="aria-"+Sr.content,un=Kt.id;yS(Pt.props.triggerTarget||tt).forEach(function(Kr){var _n=Kr.getAttribute(Xr);if(Pt.state.isVisible)Kr.setAttribute(Xr,_n?_n+" "+un:un);else{var Jn=_n&&_n.replace(un,"").trim();Jn?Kr.setAttribute(Xr,Jn):Kr.removeAttribute(Xr)}})}}function vn(){!fr&&Pt.props.aria.expanded&&yS(Pt.props.triggerTarget||tt).forEach(function(Sr){Pt.props.interactive?Sr.setAttribute("aria-expanded",Pt.state.isVisible&&Sr===Rr()?"true":"false"):Sr.removeAttribute("aria-expanded")})}function wn(){Nr().removeEventListener("mousemove",Nt),SI=SI.filter(function(Sr){return Sr!==Nt})}function pn(Sr){if(!wy.isTouch||!St&&Sr.type!=="mousedown"){var Xr=Sr.composedPath&&Sr.composedPath()[0]||Sr.target;if(!Pt.props.interactive||!GO(Kt,Xr)){if(yS(Pt.props.triggerTarget||tt).some(function(un){return GO(un,Xr)})){if(wy.isTouch||Pt.state.isVisible&&Pt.props.trigger.indexOf("click")>=0)return}else Lr("onClickOutside",[Pt,Sr]);Pt.props.hideOnClick===!0&&(Pt.clearDelayTimeouts(),Pt.hide(),Et=!0,setTimeout(function(){Et=!1}),Pt.state.isMounted||Yn())}}}function Fn(){St=!0}function Gn(){St=!1}function Qn(){var Sr=Nr();Sr.addEventListener("mousedown",pn,!0),Sr.addEventListener("touchend",pn,gx),Sr.addEventListener("touchstart",Gn,gx),Sr.addEventListener("touchmove",Fn,gx)}function Yn(){var Sr=Nr();Sr.removeEventListener("mousedown",pn,!0),Sr.removeEventListener("touchend",pn,gx),Sr.removeEventListener("touchstart",Gn,gx),Sr.removeEventListener("touchmove",Fn,gx)}function bs(Sr,Xr){var un=Ir().box;function Kr(_n){_n.target===un&&(I2(un,"remove",Kr),Xr())}if(Sr===0)return Xr();I2(un,"remove",nt),I2(un,"add",Kr),nt=Kr}function Cn(Sr,Xr,un){un===void 0&&(un=!1),yS(Pt.props.triggerTarget||tt).forEach(function(Kr){Kr.addEventListener(Sr,Xr,un),It.push({node:Kr,eventType:Sr,handler:Xr,options:un})})}function eo(){var Sr;Tr()&&(Cn("touchstart",to,{passive:!0}),Cn("touchend",Sl,{passive:!0})),(Sr=Pt.props.trigger,Sr.split(/\s+/).filter(Boolean)).forEach(function(Xr){if(Xr!=="manual")switch(Cn(Xr,to),Xr){case"mouseenter":Cn("mouseleave",Sl);break;case"focus":Cn(TN?"focusout":"blur",yn);break;case"focusin":Cn("focusout",yn)}})}function vo(){It.forEach(function(Sr){var Xr=Sr.node,un=Sr.eventType,Kr=Sr.handler,_n=Sr.options;Xr.removeEventListener(un,Kr,_n)}),It=[]}function to(Sr){var Xr,un=!1;if(Pt.state.isEnabled&&!qn(Sr)&&!Et){var Kr=((Xr=rt)==null?void 0:Xr.type)==="focus";rt=Sr,ct=Sr.currentTarget,vn(),!Pt.state.isVisible&&M2(Sr,"MouseEvent")&&SI.forEach(function(_n){return _n(Sr)}),Sr.type==="click"&&(Pt.props.trigger.indexOf("mouseenter")<0||_t)&&Pt.props.hideOnClick!==!1&&Pt.state.isVisible?un=!0:xr(Sr),Sr.type==="click"&&(_t=!un),un&&!Kr&&Qr(Sr)}}function zo(Sr){var Xr=Sr.target,un=Rr().contains(Xr)||Kt.contains(Xr);if(Sr.type!=="mousemove"||!un){var Kr=yl().concat(Kt).map(function(_n){var Jn,us=(Jn=_n._tippy.popperInstance)==null?void 0:Jn.state;return us?{popperRect:_n.getBoundingClientRect(),popperState:us,props:ht}:null}).filter(Boolean);(function(_n,Jn){var us=Jn.clientX,_s=Jn.clientY;return _n.every(function(vs){var ws=vs.popperRect,fs=vs.popperState,cs=vs.props.interactiveBorder,Is=fs.placement.split("-")[0],ns=fs.modifiersData.offset;if(!ns)return!0;var ks=Is==="bottom"?ns.top.y:0,$s=Is==="top"?ns.bottom.y:0,Xs=Is==="right"?ns.left.x:0,iu=Is==="left"?ns.right.x:0,zl=ws.top-_s+ks>cs,Os=_s-ws.bottom-$s>cs,no=ws.left-us+Xs>cs,Do=us-ws.right-iu>cs;return zl||Os||no||Do})})(Kr,Sr)&&(wn(),Qr(Sr))}}function Sl(Sr){qn(Sr)||Pt.props.trigger.indexOf("click")>=0&&_t||(Pt.props.interactive?Pt.hideWithInteractivity(Sr):Qr(Sr))}function yn(Sr){Pt.props.trigger.indexOf("focusin")<0&&Sr.target!==Rr()||Pt.props.interactive&&Sr.relatedTarget&&Kt.contains(Sr.relatedTarget)||Qr(Sr)}function qn(Sr){return!!wy.isTouch&&Tr()!==Sr.type.indexOf("touch")>=0}function Wn(){ro();var Sr=Pt.props,Xr=Sr.popperOptions,un=Sr.placement,Kr=Sr.offset,_n=Sr.getReferenceClientRect,Jn=Sr.moveTransition,us=Dr()?D2(Kt).arrow:null,_s=_n?{getBoundingClientRect:_n,contextElement:_n.contextElement||Rr()}:tt,vs=[{name:"offset",options:{offset:Kr}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!Jn}},{name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(ws){var fs=ws.state;if(Dr()){var cs=Ir().box;["placement","reference-hidden","escaped"].forEach(function(Is){Is==="placement"?cs.setAttribute("data-placement",fs.placement):fs.attributes.popper["data-popper-"+Is]?cs.setAttribute("data-"+Is,""):cs.removeAttribute("data-"+Is)}),fs.attributes.popper={}}}}];Dr()&&us&&vs.push({name:"arrow",options:{element:us,padding:3}}),vs.push.apply(vs,(Xr==null?void 0:Xr.modifiers)||[]),Pt.popperInstance=kO(_s,Kt,Object.assign({},Xr,{placement:un,onFirstUpdate:ot,modifiers:vs}))}function ro(){Pt.popperInstance&&(Pt.popperInstance.destroy(),Pt.popperInstance=null)}function yl(){return xI(Kt.querySelectorAll("[data-tippy-root]"))}function xr(Sr){Pt.clearDelayTimeouts(),Sr&&Lr("onTrigger",[Pt,Sr]),Qn();var Xr=kr(!0),un=br(),Kr=un[0],_n=un[1];wy.isTouch&&Kr==="hold"&&_n&&(Xr=_n),Xr?o=setTimeout(function(){Pt.show()},Xr):Pt.show()}function Qr(Sr){if(Pt.clearDelayTimeouts(),Lr("onUntrigger",[Pt,Sr]),Pt.state.isVisible){if(!(Pt.props.trigger.indexOf("mouseenter")>=0&&Pt.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(Sr.type)>=0&&_t)){var Xr=kr(!1);Xr?a=setTimeout(function(){Pt.state.isVisible&&Pt.hide()},Xr):_e=requestAnimationFrame(function(){Pt.hide()})}}else Yn()}}function wT(tt,s){s===void 0&&(s={});var o=E0.plugins.concat(s.plugins||[]);document.addEventListener("touchstart",SN,gx),window.addEventListener("blur",CN);var a,_e=Object.assign({},s,{plugins:o}),rt=(a=tt,EI(a)?[a]:function(nt){return M2(nt,"NodeList")}(a)?xI(a):Array.isArray(a)?a:xI(document.querySelectorAll(a))).reduce(function(nt,ot){var ct=ot&&IN(ot,_e);return ct&&nt.push(ct),nt},[]);return EI(tt)?rt[0]:rt}wT.defaultProps=E0,wT.setDefaultProps=function(tt){Object.keys(tt).forEach(function(s){E0[s]=tt[s]})},wT.currentInput=wy,Object.assign({},bI,{effect:function(tt){var s=tt.state,o={popper:{position:s.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(s.elements.popper.style,o.popper),s.styles=o,s.elements.arrow&&Object.assign(s.elements.arrow.style,o.arrow)}}),wT.setDefaultProps({render:XO});var k2=wT;class vx extends mI{async _refreshUi(){var s;if(!await super._refreshUi())return!1;w0.RemoveAll(vx.PluginType);for(const o of this.variations)w0.Create(vx.PluginType,o.title,5,20,0,o.materials.map(a=>{let _e;if(o.preview.startsWith("generate:"))_e=this._previewGenerator.generate(a,o.preview.split(":")[1]);else{const rt=a[o.preview]||"#ff00ff";_e=rt.image?k_(rt.image,100):void 0,_e||(_e=rO(rt,!0))}return{id:a.uuid,image:_e,onClick:rt=>this.applyVariation(o,rt),tooltip:a.name||a.uuid}}),(a,_e)=>k2(a,{placement:"bottom",content:_e.tooltip}));return w0.RebuildUi((s=this._viewer)===null||s===void 0?void 0:s.container),!0}}vx.PluginType="MaterialConfiguratorPlugin";class CI extends io{constructor(){super(...arguments),this.enabled=!0,this._uiNeedRefresh=!1,this._refreshUiConfig=()=>{var s,o;this.enabled&&((o=(s=this.uiConfig)===null||s===void 0?void 0:s.uiRefresh)===null||o===void 0||o.call(s,"postFrame",!0))},this.dependencies=[os],this._selectedObject=()=>{var s;return((s=this._picking)===null||s===void 0?void 0:s.getSelectedObject())||void 0},this._selectedMaterial=()=>{var s;return((s=this._selectedObject())===null||s===void 0?void 0:s.material)||void 0}}async onAdded(s){var o,a;await super.onAdded(s),this.refreshUi=this.refreshUi.bind(this),this._refreshUi=this._refreshUi.bind(this),this._picking=(o=this._viewer)===null||o===void 0?void 0:o.getPluginByType("Picking"),this._previewGenerator=new p2(this._viewer),(a=this._picking)===null||a===void 0||a.addEventListener("selectedObjectChanged",this._refreshUiConfig),s.addEventListener("preFrame",this._refreshUi),this.addEventListener("deserialize",this.refreshUi)}async onRemove(s){var o,a;return(o=this._previewGenerator)===null||o===void 0||o.dispose(),this._previewGenerator=void 0,(a=this._picking)===null||a===void 0||a.removeEventListener("selectedObjectChanged",this._refreshUiConfig),this.removeEventListener("deserialize",this.refreshUi),s.removeEventListener("preFrame",this._refreshUi),this._picking=void 0,super.onRemove(s)}refreshUi(){this.enabled&&(this._uiNeedRefresh=!0)}async _refreshUi(){return this._uiNeedRefresh&&this.enabled&&this._refreshUiConfig(),this._uiNeedRefresh=!1,!1}}CI.PluginType="MaterialLibraryBasePlugin",function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);rt>3&&nt&&Object.defineProperty(s,o,nt)}([ds("Enabled")],CI.prototype,"enabled",void 0);class Mw extends CI{constructor(){super(...arguments),this.replaceMaterial=!1,this.uiConfig={type:"folder",label:"Material Library",uuid:Mo(),children:[...Yv(this),()=>{var s;return{type:"dropdown",label:"Apply Material",limitedUi:!0,hidden:()=>!this._selectedObject(),children:[{label:"select one",value:""},[...this._viewer.getPlugin(os).materials.getMaterialsOfType((s=this._selectedMaterial())===null||s===void 0?void 0:s.typeSlug).map(o=>({label:o.name||o.uuid,value:o.uuid}))||[]]],getValue:()=>{var o;return(o=this._selectedMaterial())===null||o===void 0?void 0:o.uuid},setValue:o=>{var a,_e,rt,nt,ot;const ct=(rt=(_e=(a=this._viewer)===null||a===void 0?void 0:a.getPlugin(os))===null||_e===void 0?void 0:_e.materials)===null||rt===void 0?void 0:rt.findMaterial(o);if(ct)if(this.replaceMaterial)(ot=(nt=this._selectedObject())===null||nt===void 0?void 0:nt.setMaterial)===null||ot===void 0||ot.call(nt,ct);else{const pt=this._selectedMaterial();if(pt){const ht=pt.name,_t=pt.uuid;pt.copyProps(ct),pt.name=ht,pt.uuid=_t,pt.userData.uuid&&(pt.userData.uuid=_t)}}this._refreshUi()}}}]}}async _refreshUi(){var s,o,a,_e;if(!await super._refreshUi())return!1;const rt=[tp.TypeSlug,Ul.TypeSlug],nt=(o=(s=this._viewer)===null||s===void 0?void 0:s.getPlugin(os))===null||o===void 0?void 0:o.materials,ot=rt.map(ct=>[ct,nt==null?void 0:nt.getMaterialsOfType(ct)]);w0.RemoveAll(Mw.PluginType);for(const[ct,pt]of ot)w0.Create(Mw.PluginType,ct,5,20,0,(a=pt)===null||a===void 0?void 0:a.filter(ht=>!ht.userData.__runtimeMaterial).map(ht=>{let _t;const Et="generate:sphere";if(Et.startsWith("generate:"))_t=this._previewGenerator.generate(ht,Et.split(":")[1]);else{const St=ht[Et]||"#ff00ff";_t=St.image?k_(St.image,100):void 0,_t||(_t=tO(St,!0))}return{id:ht.uuid,image:_t,onClick:St=>{const Mt=nt==null?void 0:nt.findMaterial(St);if(console.log(Mt==null?void 0:Mt.name),Mt){const It=Mt.userData.__appliedMeshes;if(It!=null&&It.size){const Nt=It.keys().next().value;Nt.dispatchEvent({type:"select",value:Nt})}}},tooltip:ht.name||ht.uuid}}),(ht,_t)=>k2(ht,{placement:"bottom",content:_t.tooltip}));return w0.RebuildUi((_e=this._viewer)===null||_e===void 0?void 0:_e.container),!0}}function JO(tt,s,o,a){tt.traverse(_e=>{_e&&(_e.userData.cloneRotI=s,_e.userData.rotationCount=o,_e.userData.rotationAxis=a,_e.addEventListener("beforeRender",rt=>function(nt,ot){var ct;ot&&(!((ct=ot.map)===null||ct===void 0)&&ct.isTexture)&&(ot.extraUniformsToUpload||(ot.extraUniformsToUpload={}),ot.extraUniformsToUpload.uvTransform||(ot.extraUniformsToUpload.uvTransform={value:new et.Vkp}),ot.extraUniformsToUpload.uvTransform.value.setUvTransform(ot.map.offset.x*ot.map.repeat.x*nt.userData.cloneRotI/(nt.userData.rotationCount||1),ot.map.offset.y*ot.map.repeat.y*nt.userData.cloneRotI/(nt.userData.rotationCount||1),ot.map.repeat.x,ot.map.repeat.y,ot.map.rotation,ot.map.center.x,ot.map.center.y))}(_e,rt.material)))})}function ZO(tt,s,o,a="x"){var _e;if(tt.userData.rotationCount>1&&!tt.userData.rotationRoot)return tt;const rt=tt.parent;if(!rt)throw new Error("No parent");if(tt.userData.cloneParent){const ot=tt.userData.cloneParent;if(!(tt=rt.children.find(ct=>ot===ct.uuid)))return console.error("Couldn't find clone root, cannot rotate. maybe a serialization issue?",ot,rt),tt}let nt=rt.children.filter(ot=>{var ct;return((ct=ot.userData)===null||ct===void 0?void 0:ct.cloneParent)===tt.uuid}).sort((ot,ct)=>ot.userData.cloneRotI-ct.userData.cloneRotI);if(tt.userData.rotationCount===s&&s===nt.length&&o===void 0&&tt.userData.rotationAxis===a)return tt;if(o==null&&(o=(_e=tt.userData.rotationSkips)!==null&&_e!==void 0?_e:[]),o!==tt.userData.rotationSkips&&(tt.userData.rotationSkips=[...o]),JO(tt,0,s,a),tt.userData.rotationRoot=!0,tt.visible=!0,s<=nt.length){for(let ot=s-1;ot<nt.length;ot++)rt.remove(nt[ot]),nt[ot].traverse(ct=>ct.userData={__disposed:!0});nt=nt.slice(0,s)}for(let ot=1;ot<s;ot++){const ct=ot<=nt.length?nt[ot-1]:tt.clone();ct.rotation.copy(tt.rotation),ct.rotation[a]+=ot/s*Math.PI*2,JO(ct,ot,s,a),ot>nt.length&&rt.add(ct),ct.visible=!o.includes(ot)}return tt.visible=!o.includes(0),tt}Mw.PluginType="MaterialLibraryPlugin",function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);rt>3&&nt&&Object.defineProperty(s,o,nt)}([ds("Replace Material")],Mw.prototype,"replaceMaterial",void 0);var AS,xT=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let xy=AS=class extends io{constructor(){super(),this.enabled=!0,this.rotations=1,this.axis="x",this.skips="",this._selectedObjectChanged=this._selectedObjectChanged.bind(this)}async onAdded(tt){var s;await super.onAdded(tt),(s=tt.getPluginByType("Picking"))===null||s===void 0||s.addEventListener("selectedObjectChanged",this._selectedObjectChanged)}_selectedObjectChanged(){var tt,s,o,a,_e,rt,nt,ot,ct;if(!this.enabled)return;const pt=(s=(tt=this._viewer)===null||tt===void 0?void 0:tt.getPluginByType("Picking"))===null||s===void 0?void 0:s.getSelectedObject();if(!pt)return void((a=(o=this.uiConfig).uiRefresh)===null||a===void 0||a.call(o,"postFrame",!0));const ht=pt.userData.rotationRoot&&(_e=pt.userData.rotationCount)!==null&&_e!==void 0?_e:1;this.rotations=ht,this.skips=(nt=(rt=pt.userData.rotationSkips)===null||rt===void 0?void 0:rt.join(","))!==null&&nt!==void 0?nt:"",this.axis=pt.userData.rotationAxis||"x",(ct=(ot=this.uiConfig).uiRefresh)===null||ct===void 0||ct.call(ot,"postFrame",!0)}_paramsChanged(){var tt,s,o,a,_e,rt;if(!this.enabled)return;const nt=(s=(tt=this._viewer)===null||tt===void 0?void 0:tt.getPluginByType("Picking"))===null||s===void 0?void 0:s.getSelectedObject();if(nt){if(this.rotations>1||nt.userData.rotationCount){const ot=nt.userData.rotationCount,ct=ZO(nt,this.rotations,this.skips.split(",").map(ht=>parseInt(ht)).filter(ht=>isFinite(ht)),this.axis),pt=ct==null?void 0:ct.userData.rotationCount;if(pt&&pt!==ot){const ht=[];ct==null||ct.traverseAncestors(_t=>{ht.push(_t)});for(const _t of ht)if(_t.userData.autoScaled){ps(_t),(o=this._viewer)===null||o===void 0||o.resetCamera({rootObject:_t,centerOffset:new et.Pa4(4,4,4)});break}}nt.parent&&!nt.userData.__disposed||(_e=(a=this._viewer)===null||a===void 0?void 0:a.getPluginByType("Picking"))===null||_e===void 0||_e.setSelectedObject(ct,!0)}(rt=this._viewer)===null||rt===void 0||rt.scene.setDirty({frameFade:!1,sceneUpdate:!0})}}};xy.PluginType="ObjectRotationPlugin",xT([Yr(),ds("Enabled"),vr(AS.prototype._paramsChanged)],xy.prototype,"enabled",void 0),xT([gs("Rotation Count",[1,100],1,tt=>({hidden:()=>{var s,o;return!(!((o=(s=tt._viewer)===null||s===void 0?void 0:s.getPluginByType("Picking"))===null||o===void 0)&&o.getSelectedObject())||!tt.rotations}})),vr(AS.prototype._paramsChanged)],xy.prototype,"rotations",void 0),xT([Mp("Axis",["x","y","z"].map(tt=>({label:tt})),tt=>({hidden:()=>{var s,o;return!(!((o=(s=tt._viewer)===null||s===void 0?void 0:s.getPluginByType("Picking"))===null||o===void 0)&&o.getSelectedObject())||!tt.rotations}})),vr(AS.prototype._paramsChanged)],xy.prototype,"axis",void 0),xT([yo("Rotation Skips",tt=>({hidden:()=>{var s,o;return!(!((o=(s=tt._viewer)===null||s===void 0?void 0:s.getPluginByType("Picking"))===null||o===void 0)&&o.getSelectedObject())||!tt.rotations}})),vr(AS.prototype._paramsChanged)],xy.prototype,"skips",void 0),xy=AS=xT([Ao("Object Rotations")],xy);var _x,bS=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let S0=_x=class extends io{constructor(tt=!0){super(),this.enabled=!0,this.debugNormals=!1,this.debugHitHeight=!1,this._defines={PARALLAX_NORMAL_MAP_QUALITY:0},this.stepCount=12,this.binaryStepCount=3,this._bumpMapExtension={shaderExtender:(s,o,a)=>{if(o.materialObject.bumpMap&&this.enabled){s.fragmentShader=s.fragmentShader.replace("#include <normal_fragment_begin>",""),s.fragmentShader=s.fragmentShader.replace("#include <normal_fragment_maps>",""),s.fragmentShader=s.fragmentShader.replace("#include <map_fragment>",`#include <normal_fragment_begin>
#include <normal_fragment_maps>
#include <map_fragment>`);for(const _e of["map_fragment","alphamap_fragment","roughnessmap_fragment","metalnessmap_fragment","emissivemap_fragment","transmission_fragment"])s.fragmentShader=s.fragmentShader.replace(`#include <${_e}>`,et.WdD[_e].replace("vUv","parallaxUv.xy"));(this.debugNormals||this.debugHitHeight)&&(s.fragmentShader=s.fragmentShader.replace("texture2D( map, parallaxUv.xy )",this.debugNormals?"vec4(normal, 1.); normal = geometryNormal":"vec4(parallaxUv.z,0., 0., 1.)")),s.fragmentShader=s.fragmentShader.replace("#include <normal_fragment_maps>",et.WdD.normal_fragment_maps.replace("#elif defined( TANGENTSPACE_NORMALMAP )","#elif defined( TANGENTSPACE_NORMALMAP ) && !defined( USE_BUMPMAP )").replace("normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );","vec3 parallaxUv = reliefParallaxPerturbNormal(faceDirection, normal);"))}},parsFragmentSnippet:()=>this.enabled?`#ifdef USE_BUMPMAP
mat3 mat3_inverse(mat3 A){mat3 M_t=mat3(vec3(A[0][0],A[1][0],A[2][0]),vec3(A[0][1],A[1][1],A[2][1]),vec3(A[0][2],A[1][2],A[2][2]));float det=dot(cross(M_t[0],M_t[1]),M_t[2]);mat3 adjugate=mat3(cross(M_t[1],M_t[2]),cross(M_t[2],M_t[0]),cross(M_t[0],M_t[1]));return adjugate/det;}float CalculateHeight(in vec2 texCoords){float height=texture2D(bumpMap,texCoords).x;return clamp(height,0.,1.);}const vec2 bumpMapSize=vec2(512,512);vec3 CalculateNormal(in vec2 texCoords){
#if defined( TANGENTSPACE_NORMALMAP ) && 0 
vec3 mapN=texture2D(normalMap,texCoords).xyz;mapN.xy*=normalScale;return normalize(mapN);
#else
vec2 texOffs=1./bumpMapSize;
#if PARALLAX_NORMAL_MAP_QUALITY > 0
float hx[9];hx[0]=texture2D(bumpMap,texCoords.st+texOffs*vec2(-1.,-1.)).r;hx[1]=texture2D(bumpMap,texCoords.st+texOffs*vec2(0.,-1.)).r;hx[2]=texture2D(bumpMap,texCoords.st+texOffs*vec2(1.,-1.)).r;hx[3]=texture2D(bumpMap,texCoords.st+texOffs*vec2(-1.,0.)).r;hx[4]=texture2D(bumpMap,texCoords.st).r;hx[5]=texture2D(bumpMap,texCoords.st+texOffs*vec2(1.,0.)).r;hx[6]=texture2D(bumpMap,texCoords.st+texOffs*vec2(-1.,1.)).r;hx[7]=texture2D(bumpMap,texCoords.st+texOffs*vec2(0.,1.)).r;hx[8]=texture2D(bumpMap,texCoords.st+texOffs*vec2(1.,1.)).r;vec2 deltaH=vec2(hx[0]-hx[2]+2.*(hx[3]-hx[5])+hx[6]-hx[8],hx[0]-hx[6]+2.*(hx[1]-hx[7])+hx[2]-hx[8]);
#else
float h_xa=texture2D(bumpMap,texCoords.st+texOffs*vec2(-1.,0.)).r;float h_xb=texture2D(bumpMap,texCoords.st+texOffs*vec2(1.,0.)).r;float h_ya=texture2D(bumpMap,texCoords.st+texOffs*vec2(0.,-1.)).r;float h_yb=texture2D(bumpMap,texCoords.st+texOffs*vec2(0.,1.)).r;vec2 deltaH=vec2(h_xa-h_xb,h_ya-h_yb);
#endif
return normalize(vec3(deltaH/texOffs,1.));
#endif
}vec3 ReliefParallax(in float frontFace,in vec3 texDir3D,in vec2 texCoord){float surf_sign=frontFace;float back_face=step(0.,-surf_sign);vec2 texStep=surf_sign*texDir3D.xy/abs(texDir3D.z);vec2 texC=texCoord.st+surf_sign*texStep+back_face*texStep.xy;float mapHeight=1.;float bumpHeightStep=1./float(PARALLAX_MAP_STEPS);float bestBumpHeight=mapHeight+bumpHeightStep;
#pragma unroll_loop_start
for(int i=0;i<PARALLAX_MAP_STEPS;i++){if(mapHeight<bestBumpHeight){bestBumpHeight-=bumpHeightStep;mapHeight=back_face+surf_sign*CalculateHeight(texC.xy-bestBumpHeight*texStep.xy);}}
#pragma unroll_loop_end
bestBumpHeight+=bumpHeightStep;
#pragma unroll_loop_start
for(int i=0;i<PARALLAX_MAP_B_STEPS;i++){bumpHeightStep*=0.5;bestBumpHeight-=bumpHeightStep;mapHeight=back_face+surf_sign*CalculateHeight(texC.xy-bestBumpHeight*texStep.xy);bestBumpHeight+=(bestBumpHeight<mapHeight)?bumpHeightStep:0.;}
#pragma unroll_loop_end
bestBumpHeight-=bumpHeightStep*clamp((bestBumpHeight-mapHeight)/bumpHeightStep,0.,1.);mapHeight=bestBumpHeight;texC-=mapHeight*texStep;return vec3(texC.xy,mapHeight);}vec3 reliefParallaxPerturbNormal(in float faceDirection,inout vec3 normal){if(abs(bumpScale)<0.001)return vec3(vUv,0.);float parallaxHeight;vec2 texCoords=vUv;float face_sign=sign(dot(normal,vViewPosition));vec3 N=normalize(normal);vec3 dp1=dFdx(-vViewPosition);vec3 dp2=dFdy(-vViewPosition);vec2 duv1=dFdx(vUv);vec2 duv2=dFdy(vUv);vec3 dp2perp=cross(dp2,N);vec3 dp1perp=cross(N,dp1);vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;float invmax=inversesqrt(max(dot(T,T),dot(B,B)));mat3 tbnMat=mat3(T*invmax,B*invmax,N*bumpScale);vec3 tangentPos=normalize(mat3_inverse(tbnMat)*-vViewPosition);vec3 parallaxUv=ReliefParallax(face_sign,tangentPos,vUv);tbnMat[2]=face_sign*N/bumpScale;normal=normalize(tbnMat*CalculateNormal(parallaxUv.xy).xyz);
#ifdef FLIP_SIDED
normal=-normal;
#endif
return parallaxUv;}
#endif 

`.replaceAll("PARALLAX_MAP_STEPS",this._defines.PARALLAX_MAP_STEPS).replaceAll("PARALLAX_MAP_B_STEPS",this._defines.PARALLAX_MAP_B_STEPS):"",isCompatible:s=>s.isMeshStandardMaterial2,computeCacheKey:s=>{var o;return this.enabled+" "+((o=s.materialObject.bumpMap)===null||o===void 0?void 0:o.uuid)+" "+this.debugNormals+" "+this.debugHitHeight+"  "},onObjectRender:(s,{materialObject:o},a)=>{for(const[_e,rt]of Object.entries(this._defines)){const nt=typeof rt=="number"?rt:rt?1:0;o.defines[_e]!==nt&&(o.defines[_e]=nt,o.needsUpdate=!0)}}},this.dependencies=[os],this.enabled=tt,this._updateExtension=this._updateExtension.bind(this)}_updateExtension(){var tt,s,o;(s=(tt=this._bumpMapExtension)===null||tt===void 0?void 0:tt.setDirty)===null||s===void 0||s.call(tt),(o=this._viewer)===null||o===void 0||o.setDirty()}async onAdded(tt){var s,o;return(o=(s=tt.getPlugin(os))===null||s===void 0?void 0:s.materials)===null||o===void 0||o.registerMaterialExtension(this._bumpMapExtension),super.onAdded(tt)}async onRemove(tt){var s,o;return(o=(s=tt.getPlugin(os))===null||s===void 0?void 0:s.materials)===null||o===void 0||o.unregisterMaterialExtension(this._bumpMapExtension),super.onRemove(tt)}};S0.PluginType="ReliefParallaxMapping",bS([vr(_x.prototype._updateExtension),ds("Enabled")],S0.prototype,"enabled",void 0),bS([vr(_x.prototype._updateExtension),ds("Debug Normals")],S0.prototype,"debugNormals",void 0),bS([vr(_x.prototype._updateExtension),ds("Debug Hit Height")],S0.prototype,"debugHitHeight",void 0),bS([jr("PARALLAX_MAP_STEPS",void 0,!0,_x.prototype._updateExtension),gs("Step count",[1,32],1),Yr()],S0.prototype,"stepCount",void 0),bS([jr("PARALLAX_MAP_B_STEPS",void 0,!0,_x.prototype._updateExtension),gs("Binary search steps",[1,8],1),Yr()],S0.prototype,"binaryStepCount",void 0),S0=_x=bS([Ao("Parallax Mapping")],S0);var T_=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};class Qv extends Ru{constructor(s,o,a,_e=!1){super({vertexShader:Iv,fragmentShader:`

${zx}
${e1}
${Pv}
${ZS}
${a}

${Vx}

varying vec2 vUv;uniform float intensity;uniform float objectRadius;uniform float rayCount;uniform float power;uniform float bias;uniform float falloff;uniform float tolerance;uniform bool autoRadius;uniform vec2 screenSize;vec3 ComputeUniformL(vec3 N,vec2 E){vec3 L;L.xy=E;L.z=interleavedGradientNoise(gl_FragCoord.xy,frameCount*5.);L=L*2.-1.;return L;}vec2 GetRandomE(float seed){vec2 rand_e;rand_e.x=random3(vec3(gl_FragCoord.xy,frameCount+seed));rand_e.y=random3(vec3(gl_FragCoord.yx,rand_e.x+(frameCount)*7.));return rand_e;}vec4 calculateGI(in float seed,in vec3 screenPos,in vec3 normal,in float radiusFactor){vec3 viewPos=screenToView(screenPos.xy,screenPos.z);normal=normalize(normal);vec2 E=GetRandomE(seed);vec3 L=ComputeUniformL(normal,E);L=normalize(L);L*=sign(dot(L,normal));float cameraDist=length(cameraPositionWorld);float rayLen=autoRadius?length(viewPos-screenToView(screenPos.xy+objectRadius/10.,screenPos.z)):mix((cameraNearFar.y)+viewPos.z,-viewPos.z-cameraNearFar.x,L.z*0.5+0.5)*objectRadius;rayLen*=radiusFactor;float r=interleavedGradientNoise(gl_FragCoord.xy,frameCount*14.+seed)+0.05;rayLen=max(rayLen,0.001);vec3 state=vec3(1.,(r+0.5)/float(RTAO_STEP_COUNT),2.);viewPos+=normal*max(-0.01*viewPos.z,0.001);vec3 screenHitP=traceRay(viewPos,L*rayLen,tolerance*rayLen,state,RTAO_STEP_COUNT);vec3 viewHitP=screenToView(screenHitP.xy,screenHitP.z);vec3 LRes=viewHitP-viewPos;if(state.z>1.)LRes=vec3(9999999.);float dist=length(LRes)*falloff;float EPS=0.01;float zBias=(viewPos.z)*bias;float ao=(max(dot(normal,L)+zBias,0.))/(dist*dist+EPS);
#if defined(SSGI_ENABLED) && SSGI_ENABLED > 0
vec3 hitColor=tLastFrameTexelToLinear(texture2D(tLastFrame,screenHitP.xy)).rgb;vec3 hitNormal=getViewNormal(screenHitP.xy);float giWeight=1.;giWeight=saturate2(giWeight/(dist+EPS),1.);giWeight*=saturate2((dot(normal,L)),1.);giWeight*=saturate2((dot(hitNormal,-L)),1.);return vec4(hitColor*giWeight,ao);
#endif
return vec4(0,0,0,ao);}float normpdf(in float x,in float sigma){return exp(-0.5*x*x/(sigma*sigma));}vec4 getLastThis(sampler2D tex,float depth,vec3 normal){vec2 direction=vec2(1,1);vec4 color=clamp(tLastThisTexelToLinear(texture2D(tex,vUv.xy)),0.,5.);return color;}void main(){float depth;vec3 normal;getDepthNormal(vUv,depth,normal);if(depth>0.99){discard;gl_FragColor=getLastThis(tLastThis,depth,normal);return;}float viewZ=depthToViewZ(depth);vec3 screenPos=vec3(vUv.x,vUv.y,viewZ);vec4 gi=vec4(0.);gi+=calculateGI(8.,screenPos,normal,1.);if(rayCount>1.5)gi=max(gi,calculateGI(2.,screenPos,normal,0.4));if(rayCount>2.5)gi=max(gi,calculateGI(3.,screenPos,normal,1.5));if(rayCount>3.5)gi=max(gi,calculateGI(1.,screenPos,normal,0.6));if(rayCount>4.5)gi=max(gi,calculateGI(3.,screenPos,normal,1.));gi.a=min(1.,gi.a);gi.a=max(0.,gi.a);gi.rgb=min(vec3(3.),gi.rgb);gi.rgb=max(vec3(0.),gi.rgb);if(frameCount<3.){gl_FragColor=gi;return;}gl_FragColor=(texture2D(tLastThis,vUv));gl_FragColor=((gi+(gl_FragColor)*frameCount)/(frameCount+1.));}

            `,uniforms:{tLastThis:{value:null},tDiffuse:{value:null},tNormalDepth:{value:null},tLastFrame:{value:null},opacity:{value:1},intensity:{value:2.14},rayCount:{value:.1},objectRadius:{value:1},autoRadius:{value:!_e},power:{value:1.1},bias:{value:.015},falloff:{value:.7},tolerance:{value:1.5},frameCount:{value:0},projection:{value:new et.yGw},screenSize:{value:new et.FM8},cameraPositionWorld:{value:new et.Pa4},cameraNearFar:{value:new et.FM8(.1,1e3)}},defines:{PERSPECTIVE_CAMERA:1,SSGI_ENABLED:_e?1:0}},"tDiffuse","tLastFrame","tLastThis"),this.materialExtension={shaderExtender:(rt,nt,ot)=>{if(!rt.defines.SSRTAO_ENABLED)return;const ct="vec3 totalDiffuse =";rt.fragmentShader=rt.fragmentShader.replace(ct,`

            
            #if defined(SSRTAO_ENABLED) && SSRTAO_ENABLED > 0
vec4 ssgi=tSSGIMapTexelToLinear(texture2D(tSSGIMap,viewToScreen(vViewPosition.xyz).xy));float ambientOcclusion=1.-ssgi.a;ambientOcclusion=max(0.,ambientOcclusion);ambientOcclusion=pow(ambientOcclusion,ssaoPower);ambientOcclusion=min(1.,ambientOcclusion);reflectedLight.indirectDiffuse*=ambientOcclusion;
#if defined(SSGI_ENABLED) && SSGI_ENABLED > 0
vec3 ssgiColor=ssgi.rgb*ssgiIntensity;reflectedLight.indirectDiffuse+=ssgiColor*(material.diffuseColor.rgb);
#endif
#if defined( USE_ENVMAP )
float dotNV=saturate(dot(geometry.normal,geometry.viewDir));float specularOcclusion=saturate(pow(dotNV+ambientOcclusion,exp2(-16.*material.roughness-1.))-1.+ambientOcclusion);reflectedLight.indirectSpecular*=specularOcclusion;
#if defined(SSGI_ENABLED) && SSGI_ENABLED > 0
#if !defined(SSR_ENABLED) || SSR_ENABLED < 1
reflectedLight.indirectSpecular+=ssgiColor*material.specularColor;
#endif
#endif
#endif
#endif

            
            // reflectedLight.directDiffuse = vec3(0.);
            // reflectedLight.indirectDiffuse = vec3(0.);
            // reflectedLight.directSpecular = vec3(0.);
            // reflectedLight.indirectSpecular = vec3(0.);
            
            
${ct}`),rt.fragmentShader=rt.fragmentShader.replace("#include <aomap_fragment>",""),rt.vertexUvs=!0},onObjectRender:(rt,nt,ot)=>{var ct,pt,ht;this.materialExtension.extraUniforms.tSSGIMap.value=(ct=this._target)===null||ct===void 0?void 0:ct.texture;const _t=nt.materialObject,Et=!_t.transparent&&_t.transmission<.001;let St=this.enabled&&Et&&(this.renderWithCamera||this._renderer.frameCount>1)&&ot.userData.screenSpaceRendering!==!1&&!(!((pt=_t.userData)===null||pt===void 0)&&pt.ssrtaoDisabled)&&!(!((ht=_t.userData)===null||ht===void 0)&&ht.ssaoDisabled)?1:0;_t.defines.SSRTAO_ENABLED!==St&&(_t.defines.SSRTAO_ENABLED=St,_t.needsUpdate=!0),St=this.material.defines.SSGI_ENABLED,_t.defines.SSGI_ENABLED!==St&&(_t.defines.SSGI_ENABLED=St,_t.needsUpdate=!0),St=this._target.texture,this.materialExtension.extraUniforms.tSSGIMap.value!==St&&(this.materialExtension.extraUniforms.tSSGIMap.value=St,_t.needsUpdate=!0)},parsFragmentSnippet:rt=>{var nt;return Wt`
            uniform float ssaoPower;
            uniform float ssgiIntensity;
            uniform sampler2D tSSGIMap;
            ${sn("tSSGIMap",(nt=this._target)===null||nt===void 0?void 0:nt.texture,rt.capabilities.isWebGL2)}

            ${Gx}

        `},extraUniforms:{tSSGIMap:{value:null},ssaoPower:this.material.uniforms.power,ssgiIntensity:this.material.uniforms.intensity},computeCacheKey:rt=>{var nt,ot;return this.enabled?"1":"0"+((ot=(nt=this._target)===null||nt===void 0?void 0:nt.texture)===null||ot===void 0?void 0:ot.encoding)},isCompatible:rt=>{var nt;return!(!((nt=rt.materialObject.userData)===null||nt===void 0)&&nt.ssaoDisabled)&&rt.isMeshStandardMaterial2}},this.intensity=2,this.power=1.1,this.autoRadius=!0,this.objectRadius=2,this.tolerance=1,this.bias=.15,this.falloff=.7,this.rayCount=2,this.stepCount=4,this.smoothEnabled=!0,this.renderWithCamera=!0,this.uiConfig={type:"folder",label:"SS Global illumination (Dev)",children:[...Yv(this),{type:"checkbox",label:"GI Enabled",hidden:()=>!this._giActivated,property:[this,"ssgiEnabled"]}]},this._renderer=s,this._target=o,this.needsSwap=!0,this._giActivated=_e,this.ssgiEnabled=_e,this.bilateralPass=new Hx(this._target,a,"rgba")}get ssgiEnabled(){return parseInt(this.material.defines.SSGI_ENABLED)>.5}set ssgiEnabled(s){s=s&&this._giActivated,this.material.defines.SSGI_ENABLED=s?1:0,this.material.needsUpdate=!0}render(s,o,a,_e,rt){this.needsSwap=!1,!this.renderWithCamera&&this._renderer.frameCount<2||(this._renderer.blit(this._target.texture,o),this.uniforms.tLastThis.value=o.texture,super.render(s,this._target,a,_e,rt),this.smoothEnabled&&this.bilateralPass.render(s,o,a,_e,rt))}}T_([Yr()],Qv.prototype,"bilateralPass",void 0),T_([gs("Intensity",[0,4]),Yr(),Ar()],Qv.prototype,"intensity",void 0),T_([gs("Power",[0,3]),Yr(),Ar()],Qv.prototype,"power",void 0),T_([ds("Auto radius"),Yr(),Ar()],Qv.prototype,"autoRadius",void 0),T_([gs("Object Radius",[.01,10]),Yr(),Ar()],Qv.prototype,"objectRadius",void 0),T_([gs("Tolerance",[.1,5]),Yr(),Ar()],Qv.prototype,"tolerance",void 0),T_([gs("Bias",[-.3,.3]),Yr(),Ar()],Qv.prototype,"bias",void 0),T_([gs("Falloff",[1e-4,4]),Yr(),Ar()],Qv.prototype,"falloff",void 0),T_([gs("Ray Count",[1,5],1),Yr(),Ar()],Qv.prototype,"rayCount",void 0),T_([gs("Step count",[1,16],1),Yr(),jr("RTAO_STEP_COUNT")],Qv.prototype,"stepCount",void 0),T_([ds("Smooth Enabled"),Yr()],Qv.prototype,"smoothEnabled",void 0),T_([ds("Render with Camera")],Qv.prototype,"renderWithCamera",void 0);class TI extends Zw{constructor(s=!0){super(),this.dependencies=[os,Dl,_p],this._initEnabled=!1,this.setDirty=this.setDirty.bind(this),this._initEnabled=s}get rtgiTarget(){return this._rtgiTarget}async onAdded(s){var o,a;await super.onAdded(s),this.enabled=this._initEnabled,(a=(o=this.uiConfig).uiRefresh)===null||a===void 0||a.call(o,"postFrame",!0)}get enabled(){var s,o;return((o=(s=this.passes.ssrtgi)===null||s===void 0?void 0:s.passObject)===null||o===void 0?void 0:o.enabled)||!1}set enabled(s){var o;!((o=this.passes.ssrtgi)===null||o===void 0)&&o.passObject&&(this.passes.ssrtgi.passObject.enabled=s)}createPasses(s){var o,a,_e;this._rtgiTarget=s.renderer.createTarget({sizeMultiplier:1});let rt=!1;return(o=this._viewer)===null||o===void 0||o.getPluginByType("debug"),[YA(s,{passId:"ssrtgi",after:["gbuffer"],before:["render"],required:["render","gbuffer","progressive"],passObject:new Qv(s.renderer,this._rtgiTarget,(_e=(a=s.getPlugin(Dl))===null||a===void 0?void 0:a.getUnpackSnippet())!==null&&_e!==void 0?_e:"",!0),update:()=>{var nt;let ot=this.enabled;if(ot&&!rt){const ct=(nt=this._viewer)===null||nt===void 0?void 0:nt.getPluginByType("SSAO");ct!=null&&ct.enabled&&(confirm("SSAO Plugin needs to be disabled to enable SSRTGI or SSRTAO. Disable now?")?ct.enabled=!1:(this.enabled=!1,ot=!1))}rt=ot,ot&&this.passes.ssrtgi.passObject.bilateralPass.updateShaderProperties([s.getPlugin(Dl)])}},()=>[s.getPlugin(Dl),s.getPlugin(_p),s.scene.activeCamera,s.renderer])]}async onRemove(s){return s.renderer.disposeTarget(this._rtgiTarget),super.onRemove(s)}setDirty(){var s;(s=this._viewer)===null||s===void 0||s.setDirty()}get uiConfig(){var s,o,a,_e,rt;const nt=(a=(o=(s=this.passes.ssrtgi)===null||s===void 0?void 0:s.passObject)===null||o===void 0?void 0:o.uiConfig)!==null&&a!==void 0?a:{};return(rt=(_e=nt.children)===null||_e===void 0?void 0:_e.map(ot=>er(ot)))===null||rt===void 0||rt.flat(2).forEach(ot=>ot&&(ot.onChange=this.setDirty)),nt}}TI.PluginType="SSGI";class Rw extends io{constructor(){super(...arguments),this.enabled=!0,this._uiNeedRefresh=!1,this.dependencies=[os],this.variations=[],this._selectedSwitchNode=()=>{var s;const o=(s=this._picking)===null||s===void 0?void 0:s.getSelectedObject();if(!o)return;const a=this.variations.map(rt=>rt.name);let _e;return o.traverseAncestors(rt=>{_e||a.includes(rt.name)&&(_e=rt)}),_e},this.uiConfig={label:"Switch Node",type:"folder",children:[()=>[{type:"folder",label:"All nodes",expanded:!0,children:[this.variations.map(s=>({type:"input",label:s.title,property:[s,"name"],onChange:()=>this.refreshUi()}))]},{type:"button",label:"Add Node",value:()=>{this.variations.push({name:"switch_node",selected:"",title:"Switch Node",camView:"front",camDistance:1}),this.refreshUi()}},{type:"button",label:"Refresh UI",value:()=>this.refreshUi()},{type:"input",label:"Selected node title",hidden:()=>!this._selectedSwitchNode(),property:()=>{const s=this._selectedSwitchNode();return s?[this.variations.find(o=>o.name===s.name),"title"]:[]},onChange:()=>this.refreshUi()},{type:"slider",bounds:[.01,2],stepSize:.01,label:"Cam Distance",hidden:()=>!this._selectedSwitchNode(),property:()=>{const s=this._selectedSwitchNode();return s?[this.variations.find(o=>o.name===s.name),"camDistance"]:[]}},{type:"dropdown",label:"Cam View",hidden:()=>!this._selectedSwitchNode(),property:()=>{const s=this._selectedSwitchNode();return s?[this.variations.find(o=>o.name===s.name),"camView"]:[]},onChange:()=>this.refreshUi(),children:["top","bottom","front","back","left","right"].map(s=>({label:s,value:s}))}]]}}async onAdded(s){var o,a;await super.onAdded(s),this._picking=(o=this._viewer)===null||o===void 0?void 0:o.getPluginByType("Picking"),(a=this._picking)===null||a===void 0||a.addEventListener("selectedObjectChanged",()=>{var _e,rt;(rt=(_e=this.uiConfig).uiRefresh)===null||rt===void 0||rt.call(_e)}),s.addEventListener("postFrame",()=>{this._uiNeedRefresh&&this._refreshUi()}),s.addEventListener("preRender",()=>{if(this._viewer)for(const _e of this.variations){const rt=this._viewer.scene.getObjectByName(_e.name);if(!rt||rt.children.length<1)return;_e.selected||(_e.selected=rt.children[0].name||rt.children[0].uuid);for(const nt of rt.children)nt.visible=(nt.name||nt.uuid)===_e.selected}}),s.addEventListener("postRender",()=>{if(this._viewer)for(const _e of this.variations){const rt=this._viewer.scene.getObjectByName(_e.name);if(!rt||rt.children.length<1)return;for(const nt of rt.children)nt.visible=!0}}),this.addEventListener("deserialize",async()=>{await mu(200),this.refreshUi()})}refreshUi(){this.enabled&&(this._uiNeedRefresh=!0)}_refreshUi(){var s,o,a;if(this.enabled&&this._viewer){this._uiNeedRefresh=!1,w0.RemoveAll(Rw.PluginType);for(const _e of this.variations){const rt=this._viewer.scene.getObjectByName(_e.name);rt?(rt.children.length<1&&console.warn("SwitchNode does not have enough children",_e),w0.Create(Rw.PluginType,_e.title,Math.min(5,rt.children.length),20,0,rt.children.map(nt=>{const ot=_e.camView,ct=new et.Pa4((ot.includes("right")?1:0)-(ot.includes("left")?1:0),(ot.includes("top")?1:0)-(ot.includes("bottom")?1:0),(ot.includes("front")?1:0)-(ot.includes("back")?1:0));_e.camDistance||(_e.camDistance=1);const pt=d2(this._viewer,nt,void 0,7,ct.multiplyScalar(.5*_e.camDistance));return{id:nt.uuid,image:pt,onClick:()=>{var ht;_e.selected=nt.name||nt.uuid,(ht=this._viewer)===null||ht===void 0||ht.scene.setDirty({sceneUpdate:!0,frameFade:!0})},tooltip:nt.name||nt.uuid}}),(nt,ot)=>k2(nt,{placement:"bottom",content:ot.tooltip}))):console.warn("no object found for variation, skipping",_e)}w0.RebuildUi((s=this._viewer)===null||s===void 0?void 0:s.container),(a=(o=this.uiConfig).uiRefresh)===null||a===void 0||a.call(o)}}}Rw.PluginType="SwitchNodePlugin",function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);rt>3&&nt&&Object.defineProperty(s,o,nt)}([Yr()],Rw.prototype,"variations",void 0);class O2 extends et.u9r{constructor(s,o,a=32,_e=64,rt=!1,nt=new et.FM8(1,1),ot="shape"){super(),this.type="TubeShapeGeometry",this.parameters={path:o,shape:s,shapeSegments:a,tubularSegments:_e,closed:rt,primary:ot,shapeScale:nt.clone()};const ct=o.computeFrenetFrames(_e,rt);this.frames=ct;const pt=new et.Pa4,ht=new et.Pa4,_t=new et.Pa4,Et=new et.FM8;let St=new et.Pa4;const Mt=[],It=[],Nt=[],Bt=s.getSpacedPoints(a);for(const qt of Bt)qt.multiply(nt);(function(){for(let qt=0;qt<_e;qt++)Pt(qt);Pt(rt===!1?_e:0),function(){for(let qt=0;qt<=_e;qt++)for(let Kt=0;Kt<=a;Kt++)Et.x=qt/_e,Et.y=Kt/a,It.push(Et.x,Et.y)}(),function(){const qt=ot==="shape",Kt=qt?a:_e,nr=qt?_e:a;for(let ir=1;ir<=Kt;ir++)for(let fr=1;fr<=nr;fr++){const[br,Tr]=qt?[fr,ir]:[ir,fr],Dr=(a+1)*(br-1)+(Tr-1),Rr=(a+1)*br+(Tr-1),Nr=(a+1)*br+Tr,Ir=(a+1)*(br-1)+Tr;Nt.push(Dr,Rr,Ir),Nt.push(Rr,Nr,Ir)}}()})(),this.setIndex(Nt),this.setAttribute("position",new et.a$l(Mt,3)),this.setAttribute("uv",new et.a$l(It,2)),this.computeVertexNormals();const kt=this.attributes.normal;function Pt(qt){St=o.getPointAt(qt/_e,St);const Kt=ct.normals[qt],nr=ct.binormals[qt];for(let ir=0;ir<=a;ir++){const fr=Bt[ir%a];ht.set(0,0,0).addScaledVector(Kt,fr.x).addScaledVector(nr,fr.y),pt.copy(St).add(ht),Mt.push(pt.x,pt.y,pt.z)}}(function(){for(let Kt=1;Kt<a;Kt++){const nr=Kt+_e*(a+1);ht.fromBufferAttribute(kt,Kt),_t.fromBufferAttribute(kt,nr),ht.add(_t).normalize(),kt.setXYZ(Kt,ht.x,ht.y,ht.z),kt.setXYZ(nr,ht.x,ht.y,ht.z)}for(let Kt=1;Kt<_e;Kt++){const nr=Kt*(a+1),ir=nr+a;ht.fromBufferAttribute(kt,nr),_t.fromBufferAttribute(kt,ir),ht.add(_t).normalize(),kt.setXYZ(nr,ht.x,ht.y,ht.z),kt.setXYZ(ir,ht.x,ht.y,ht.z)}ht.fromBufferAttribute(kt,0),_t.fromBufferAttribute(kt,a),ht.add(_t);const qt=_e*(a+1);_t.fromBufferAttribute(kt,qt),ht.add(_t),_t.fromBufferAttribute(kt,qt+a),ht.add(_t),ht.normalize(),kt.setXYZ(0,ht.x,ht.y,ht.z),kt.setXYZ(a,ht.x,ht.y,ht.z),kt.setXYZ(qt,ht.x,ht.y,ht.z),kt.setXYZ(qt+a,ht.x,ht.y,ht.z),kt.needsUpdate=!0})()}createSplits(s){this.clearGroups();const o=this.parameters.primary==="shape"?this.parameters.shapeSegments:this.parameters.tubularSegments,a=this.index.count,_e=[...s,1].sort();let rt=0,nt=0;for(const ot of _e){const ct=Math.round(o*ot)*a/o;this.addGroup(rt,ct-rt,nt++),rt=ct}return this.groups.length}toJSON(){const s=super.toJSON();return s.path=this.parameters.path.toJSON(),s.shape=this.parameters.shape.toJSON(),s}}var L2,Iw=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let Hv=L2=class extends io{constructor(){super(...arguments),this.enabled=!0,this.shapeSegments=32,this.tubularSegments=32,this.shapeScale=new et.FM8(1,1),this.materialSplits="0.3, 0.6",this.horizontalSplits=!0,this.extrudeCirceTube=async()=>{var tt,s;const o=(s=(tt=this._viewer)===null||tt===void 0?void 0:tt.getPlugin(Wo))===null||s===void 0?void 0:s.getSelectedObject();if(!o)return;let a=this._viewer.prompt("Radius: Radius for the circle","1",!0);if(!a)return;a=parseFloat(a);const _e=new N2(0,0,a,a,0,2*Math.PI,!0,0);await this.extrudeObject(o,_e)}}async onAdded(tt){await super.onAdded(tt)}static CreateCurve(tt,s){var o,a;if(tt==="circle")return new N2(0,0,(o=s.radius)!==null&&o!==void 0?o:1,(a=s.radius)!==null&&a!==void 0?a:1,0,2*Math.PI,!0,0);throw new Error("Unknown curve type")}async extrudeObject(tt,s,o=this.shapeSegments,a=this.tubularSegments,_e=this.shapeScale,rt=this.materialSplits.split(",").map(ot=>parseFloat(ot.trim())),nt=this.horizontalSplits){var ot,ct,pt,ht,_t,Et,St,Mt;if(tt.userData.isExtrudedTube,tt.userData._extrudeSource){const qt=tt.userData._extrudeSource;if(tt=(ot=tt.parent)===null||ot===void 0?void 0:ot.children.find(Kt=>qt===Kt.uuid),!tt)return void console.warn("Could not find extrude source with uuid",qt)}if(tt.userData.extrudedObject){const qt=tt.userData.extrudedObject,Kt=(ct=tt.parent)===null||ct===void 0?void 0:ct.children.find(nr=>qt===nr.uuid);Kt&&(Kt.removeFromParent(),Kt.geometry.dispose(),Kt.geometry=null,Kt.material=null),delete tt.userData.extrudedObject}const It=tt.geometry;if(!It)return void((pt=this._viewer)===null||pt===void 0||pt.alert("Extrude: No geometry to extrude"));const Nt=[tt.material];let Bt;try{const qt=L2.ConvertGeometryToFlatShape(It);Bt=new O2(qt,s,o,a,!0,_e,nt?"shape":"path"),Bt.computeBoundingBox(),Bt.createSplits(rt)}catch(qt){return void((ht=this._viewer)===null||ht===void 0||ht.alert(typeof qt=="string"?qt:qt==null?void 0:qt.message))}Nt[0].color.set(16777215);for(let qt=Nt.length;qt<Bt.groups.length;qt++){const Kt=Nt[0].clone();Nt.push(Kt),Kt.color.set(16777215*Math.random())}const kt=new et.Kj0(Bt,Nt);kt.userData._extrudeSource=tt.uuid,kt.userData.isExtrudedTube=!0,tt.visible=!1,tt.userData.bboxVisible=!1,kt.name=tt.name+"_extruded";const Pt=await((St=(Et=(_t=this._viewer)===null||_t===void 0?void 0:_t.getManager())===null||Et===void 0?void 0:Et.importer)===null||St===void 0?void 0:St.processImportedSingle(kt,{autoCenter:!1,autoScale:!1}));Pt&&((Mt=tt.parent)===null||Mt===void 0||Mt.add(Pt.modelObject),tt.userData.extrudedObject=Pt.modelObject.uuid,Pt.dispatchEvent({type:"select",ui:!0,value:Pt}))}static ExtrudeShape(tt,s,o,a,_e,rt,nt,ot){const ct=new O2(tt,a,s,o,!0,new et.FM8(_e,rt),ot?"shape":"path");ct.computeBoundingBox(),ct.createSplits(nt);const pt=new et.Kj0(ct,[]);return pt.userData.isExtrudedTube=!0,pt}static ConvertGeometryToFlatShape(tt,s=!0){if(tt.userData.__planarShape)return tt.userData.__planarShape;let o=tt.attributes.position;if(!o)throw"no position attribute";if(o.count>500)throw"too large to extrude";const a=tt;o=a.attributes.position,a.boundingBox||a.computeBoundingBox();const _e=a.boundingBox.getSize(new et.Pa4),rt=_e.x<.001?"x":_e.y<.001?"y":_e.z<.001?"z":null;if(!rt)throw"geometry is not axis aligned not planar";let nt=[];for(let ct=0;ct<o.count;ct++){const pt=new et.FM8;rt==="x"?pt.set(o.getY(ct),o.getZ(ct)):rt==="y"?pt.set(o.getX(ct),o.getZ(ct)):pt.set(o.getX(ct),o.getY(ct)),nt.push(pt)}if(s){let ct=0;for(let pt=0;pt<nt.length;pt++)(nt[pt].x<nt[ct].x||nt[pt].x===nt[ct].x&&nt[pt].y<nt[ct].y)&&(ct=pt);ct!==0&&(nt=nt.slice(ct).concat(nt.slice(0,ct)))}const ot=new et.bnF(nt);return tt.userData.__planarShape=ot,ot}};Hv.PluginType="ShapeTubeExtrudePlugin",Iw([ds("Enabled")],Hv.prototype,"enabled",void 0),Iw([gs("Shape Segments (X)",[1,100],1,tt=>({hidden:()=>{var s,o;return!(!((o=(s=tt._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0)&&o.getSelectedObject())}}))],Hv.prototype,"shapeSegments",void 0),Iw([gs("Tube Segments (Y)",[1,100],1,tt=>({hidden:()=>{var s,o;return!(!((o=(s=tt._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0)&&o.getSelectedObject())}}))],Hv.prototype,"tubularSegments",void 0),Iw([ou("Shape scale",[.01,10],.01,tt=>({hidden:()=>{var s,o;return!(!((o=(s=tt._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0)&&o.getSelectedObject())}}))],Hv.prototype,"shapeScale",void 0),Iw([yo("Material Splits",tt=>({hidden:()=>{var s,o;return!(!((o=(s=tt._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0)&&o.getSelectedObject())}}))],Hv.prototype,"materialSplits",void 0),Iw([ds("Horizontal Splits",tt=>({hidden:()=>{var s,o;return!(!((o=(s=tt._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0)&&o.getSelectedObject())}}))],Hv.prototype,"horizontalSplits",void 0),Iw([Qo("Extrude Circle Tube",tt=>({hidden:()=>{var s,o;return!(!((o=(s=tt._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0)&&o.getSelectedObject())}}))],Hv.prototype,"extrudeCirceTube",void 0),Hv=L2=Iw([Ao("Extrude Tube Shapes")],Hv);class N2 extends et.Ny0{getPoint(s,o){return super.getPoint(s,o||new et.Pa4)}}class ET extends io{constructor(s=!0){super(),this.enabled=!0,this.toJSON=void 0,this.fromJSON=void 0,this._lastFrameTime=0,this._updaters=[],this.dependencies=[],this._fadeDisabled=!1,this.disableFrameFade=!0,this._postFrame=()=>{var o,a;if(!this._viewer)return;if(!this.enabled||Object.keys(this.animations).length<1)return this._lastFrameTime=0,void(this._fadeDisabled&&((o=this._viewer.getPluginByType("FrameFade"))===null||o===void 0||o.enable(ET.PluginType),this._fadeDisabled=!1));const _e=bo()/1e3;this._lastFrameTime<1&&(this._lastFrameTime=_e-1/60);let rt=_e-this._lastFrameTime;this._lastFrameTime=_e;const nt=(a=this._viewer.getPluginByType("Progressive"))===null||a===void 0?void 0:a.postFrameConvergedRecordingDelta();if(nt&&nt>0&&(rt=nt),nt!==0&&(rt*=1e3,!(rt<=.001)&&(this._updaters.forEach(ot=>{let ct=rt;ot.time+ct<0&&(ct=-ot.time),ot.time+=ct,Math.abs(ct)>.001&&ot.u(ct)}),!this._fadeDisabled&&this.disableFrameFade))){const ot=this._viewer.getPluginByType("FrameFade");ot&&(ot.disable(ET.PluginType),this._fadeDisabled=!0)}},this.defaultDriver=o=>({start:()=>this._updaters.push({u:o,time:0}),stop:()=>this._updaters.splice(this._updaters.findIndex(a=>a.u===o),1)}),this.animations={},this.enabled=s,this._postFrame=this._postFrame.bind(this)}async onAdded(s){await super.onAdded(s),s.addEventListener("postFrame",this._postFrame)}async onRemove(s){return s.removeEventListener("postFrame",this._postFrame),super.onRemove(s)}animate(s){const o=Mo(),a={id:o,options:s,stop:()=>{var _e,rt,nt;!((_e=this.animations[o])===null||_e===void 0)&&_e._stop?(nt=(rt=this.animations[o])===null||rt===void 0?void 0:rt._stop)===null||nt===void 0||nt.call(rt):console.warn("Animation not started")}};return this.animations[o]=a,a.promise=new Promise((_e,rt)=>{const nt={driver:this.defaultDriver,onComplete:()=>{var ct;(ct=s.onComplete)===null||ct===void 0||ct.call(s),_e()},onStop:()=>{var ct;(ct=s.onStop)===null||ct===void 0||ct.call(s),_e()},...s},ot=iw(nt);this.animations[o]._stop=ot.stop,this.animations[o].options=nt}).then(()=>(delete this.animations[o],o)),this.animations[o]}async animateAsync(s){return this.animate(s).promise}}ET.PluginType="PopmotionPlugin";const PN=async tt=>Su(await(await fetch(tt)).blob());async function e3(tt,s=PN){const o=tt.match(/(((ftp|https?):\/\/)[\-\w@:%_\+.~#?,&\/\/=]+)/g);if(o)for(const a of o){const _e=await s(a);tt=tt.replace(a,_e)}return tt}function F2(tt,s,{width:o,height:a},_e=!0){const rt=`
<svg viewBox="0 0 ${o} ${a}" xmlns="http://www.w3.org/2000/svg">
    <style>
    ${s}
    </style>
    <foreignObject x="0" y="0" width="100%" height="100%">
        <div xmlns="http://www.w3.org/1999/xhtml" style="height: 100%; width: 100%; position: absolute: top:0; left:0">
            ${tt}
        </div>
    </foreignObject>
</svg>
    `;return _e?tr(rt):rt}async function DN(tt,s,o){const a=F2(tt,s,o);return await h2(a,o)}async function BN(tt,s,o){const a=F2(tt,s,o);return await nO(a,o)}var U2,C0,Mu=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};const Vm=tt=>({onChange:s=>{s.last&&tt.onChange()}});let xp=U2=class{constructor(){this.text="Custom Text",this.fontSize=100,this.width=1024,this.height=1024,this.xOffset=0,this.yOffset=0,this.boxWidth=1024,this.boxHeight=1024,this.fontFamily="",this.fontPath="",this.maskText=!1,this.innerShadow=!1,this.textColor="#000000",this.bgFillColor="#ffffff",this.svgBackground="#ffffff",this.onChange=()=>{}}set(tt){Object.assign(this,tt)}reset(){const tt=this.onChange;Object.assign(this,new U2),this.onChange=tt}toJSON(){return{text:this.text,fontFamily:this.fontFamily,fontPath:this.fontPath,svgBackground:this.svgBackground,width:this.width,height:this.height,xOffset:this.xOffset,yOffset:this.yOffset,boxWidth:this.boxWidth,boxHeight:this.boxHeight,fontSize:this.fontSize,maskText:this.maskText,innerShadow:this.innerShadow,bgFillColor:this.bgFillColor,textColor:this.textColor}}};Mu([yo("Text",Vm)],xp.prototype,"text",void 0),Mu([gs("Font Size",[2,400],1,Vm)],xp.prototype,"fontSize",void 0),Mu([gs("Width",[2,4096],1,Vm)],xp.prototype,"width",void 0),Mu([gs("Height",[2,4096],1,Vm)],xp.prototype,"height",void 0),Mu([gs("X Offset",[-1024,1024],1,Vm)],xp.prototype,"xOffset",void 0),Mu([gs("Y Offset",[-1024,1024],1,Vm)],xp.prototype,"yOffset",void 0),Mu([gs("V-Width",[2,4096],1,Vm)],xp.prototype,"boxWidth",void 0),Mu([gs("V-Height",[2,4096],1,Vm)],xp.prototype,"boxHeight",void 0),Mu([yo("Font",Vm)],xp.prototype,"fontFamily",void 0),Mu([yo("Font Url",Vm)],xp.prototype,"fontPath",void 0),Mu([ds("Mask Text",Vm)],xp.prototype,"maskText",void 0),Mu([ds("Inner Shadow",Vm)],xp.prototype,"innerShadow",void 0),Mu([vv("Text Color",Vm)],xp.prototype,"textColor",void 0),Mu([vv("BG Fill",Vm)],xp.prototype,"bgFillColor",void 0),Mu([vv("SVG BG",Vm)],xp.prototype,"svgBackground",void 0),xp=U2=Mu([Ao("Text SVG Options")],xp);const t3={woff:"woff",woff2:"woff2",ttf:"truetype",otf:"opentype",eot:"embedded-opentype"},ST=tt=>({hidden:()=>{const s=tt.getSelected();return!s||!s.userData[qv.PluginType]}});let qv=C0=class extends io{constructor(){super(),this.enabled=!0,this.getSelected=()=>{var tt,s;return(s=(tt=this._viewer)===null||tt===void 0?void 0:tt.getPluginByType("Picking"))===null||s===void 0?void 0:s.getSelectedObject()},this.options=new xp,this.applyToMap=!0,this.applyToBumpMap=!1,this.applyToAlphaMap=!0,this.inverseAlphaMap=!1,this._lastMeta=void 0,this.fonts={roboto:"https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxKKTU1Kg.woff2"},this._assetLoadOptions=void 0,this._selectedObjectChanged=this._selectedObjectChanged.bind(this),this.addTextToSelected=this.addTextToSelected.bind(this),this._paramsChanged=this._paramsChanged.bind(this),this.options.onChange=this._paramsChanged}async onAdded(tt){var s;await super.onAdded(tt),(s=tt.getPluginByType("Picking"))===null||s===void 0||s.addEventListener("selectedObjectChanged",this._selectedObjectChanged)}_selectedObjectChanged(){var tt,s,o,a,_e,rt;if(!this.enabled)return;const nt=this.getSelected();if(!nt)return void((s=(tt=this.uiConfig).uiRefresh)===null||s===void 0||s.call(tt,"postFrame",!0));const ot=nt.userData[C0.PluginType];if(!ot)return this.options.reset(),this._lastMeta=void 0,void((a=(o=this.uiConfig).uiRefresh)===null||a===void 0||a.call(o,"postFrame",!0));this._lastMeta!==ot&&(this.options.set(ot),this._lastMeta=ot),(rt=(_e=this.uiConfig).uiRefresh)===null||rt===void 0||rt.call(_e,"postFrame",!0)}_paramsChanged(){if(!this.enabled)return;const tt=this.getSelected();tt&&tt.isMesh&&tt.userData[C0.PluginType]&&this.updateText(tt,this.options.toJSON())}async addTextToSelected(){var tt;const s=this.getSelected();s&&s.isMesh?s.material?(s.userData[C0.PluginType]||!s.material.map||await((tt=this._viewer)===null||tt===void 0?void 0:tt.confirm("Add Text: This mesh already has a texture. Adding text will replace the texture. Continue?")))&&await this.addText(s):console.error("no material on mesh"):console.error("no mesh is selected")}async addText(tt,s){return this.updateText(tt,Object.assign(this.options.toJSON(),s))}async updateText(tt,s){var o,a;if(!tt.isMesh)return;if(!tt.material)return void console.error("updateText: no material on mesh");let _e=tt.userData[C0.PluginType];_e||(tt.userData[C0.PluginType]=_e={}),Object.assign(_e,s);const rt=tt.material;rt.map&&(rt.map._isSimpleTextTexture&&rt.map.dispose(),rt.map=void 0),rt.alphaMap&&(rt.alphaMap._isSimpleTextTexture&&rt.alphaMap.dispose(),rt.alphaMap=void 0),rt.bumpMap&&(rt.bumpMap._isSimpleTextTexture&&rt.bumpMap.dispose(),rt.bumpMap=void 0);const nt=await this.makeTextSvg(_e);this.applyToMap&&(rt.map=nt),this.applyToAlphaMap&&(rt.alphaMap=nt,rt.transparent=!0),this.applyToBumpMap&&(rt.bumpMap=nt),rt.userData.inverseAlphaMap=this.inverseAlphaMap,rt.setDirty(),rt.needsUpdate=!0,(a=(o=this.uiConfig).uiRefresh)===null||a===void 0||a.call(o,"postFrame",!0)}async makeTextSvg(tt){const s=tt.fontFamily||"Arial",o=tt.fontPath||this.fonts[s]||"";let a=tt.style;if(o.length>0){const nt=o.split("?")[0].split(".").pop()||"woff";a+=`
`+(o.length>0?`
            @font-face {
                font-family: ${s};
                src: url(${o}) format(${t3[nt]||nt});
            }`:"")}let _e=function({text:nt="Custom Text",svgBackground:ot="#ffffff",xOffset:ct=0,yOffset:pt=0,width:ht=1024,height:_t=1024,boxWidth:Et=1024,boxHeight:St=1024,fontFamily:Mt="",fontSize:It=32,maskText:Nt=!0,innerShadow:Bt=!0,bgFillColor:kt="#000000",textColor:Pt="#ffffff",style:qt=""}){return`
<svg style="background-color:${ot}" width="${ht}" height="${_t}" viewBox="0 0 ${Et} ${St}"
 xmlns="http://www.w3.org/2000/svg"
 xmlns:xlink="http://www.w3.org/1999/xlink">
     <defs>
        <style>
        ${qt}
        </style>
    </defs>

    <g style="overflow:hidden; text-anchor: middle; font-size: ${It}px; font-family: ${Mt||"Arial"}">
        <defs>

`+(Nt?`
<mask id="textMask">
<text style="fill:white; font-size: ${It}px;" x="${ct+Et/2}" y="${St/2+pt+It/4}" > ${nt} </text>
</mask>
`:"")+`

`+(Bt?`
<filter id="innerShadow" x="-20%" y="-20%" width="140%" height="140%">
<feGaussianBlur in="SourceGraphic" stdDeviation="0.5" result="blur"/>
<feOffset in="blur" dx="1.5" dy="1.5"/>
</filter>
`:"")+`

        </defs>

`+(Nt?`
        <g mask="url(#textMask)">
`:"")+`

        <rect x="0" y="0" width="${Et}" height="${St}" style="fill:${kt}"/>
        <text style="${Bt?"filter: url(#innerShadow);":""} fill:${Pt};" x="${ct+Et/2}" y="${St/2+pt+It/4}"> ${nt} </text>

`+(Nt?`
        </g>
`:"")+`

    </g>
</svg>
`}({...tt,fontFamily:s,style:a});_e=await e3(_e,async nt=>this._getAssetData(nt)),_e=tr(_e);const rt=await this._viewer.getManager().importer.importSinglePath(_e,{generateMipmaps:!1,minFilter:et.wem});return rt._isSimpleTextTexture=!0,rt.flipY=!1,rt.needsUpdate=!0,rt}async _getAssetData(tt){var s,o;if(tt.startsWith("http://www.w3.org"))return tt;const a=(o=(s=this._viewer)===null||s===void 0?void 0:s.getManager())===null||o===void 0?void 0:o.importer;if(!a)throw new Error("no importer");this._assetLoadOptions=this._assetLoadOptions||{fileHandler:new Bl(a.loadingManager),processImported:!1};try{return await a.importPath(tt,this._assetLoadOptions)}catch(_e){return console.error(_e),""}}};qv.PluginType="SimpleTextPlugin",Mu([Pl(void 0,{params:ST})],qv.prototype,"options",void 0),Mu([ds("Apply Map",ST),vr(C0.prototype._paramsChanged)],qv.prototype,"applyToMap",void 0),Mu([ds("Apply Bump Map",ST),vr(C0.prototype._paramsChanged)],qv.prototype,"applyToBumpMap",void 0),Mu([ds("Apply Alpha Map",ST),vr(C0.prototype._paramsChanged)],qv.prototype,"applyToAlphaMap",void 0),Mu([ds("Invert Alpha Map",ST),vr(C0.prototype._paramsChanged)],qv.prototype,"inverseAlphaMap",void 0),Mu([Qo("Add Text",tt=>({hidden:()=>!tt.getSelected()}))],qv.prototype,"addTextToSelected",null),qv=C0=Mu([Ao("Simple Text")],qv);class $2{constructor(s){this.top=0,this.array=new Float32Array(s)}write(s){this.array[this.top++]=s.x,this.array[this.top++]=s.y,this.array[this.top++]=s.z}}class kN{constructor(s){this.top=0,this.array=new Float32Array(s)}write(s){this.array[this.top++]=s.x,this.array[this.top++]=s.y}}class Ey{constructor(s){this.plane=null,this.front=null,this.back=null,this.polygons=[],s&&this.build(s)}clone(){const s=new Ey;return s.plane=this.plane&&this.plane.clone(),s.front=this.front&&this.front.clone(),s.back=this.back&&this.back.clone(),s.polygons=this.polygons.map(o=>o.clone()),s}invert(){for(let o=0;o<this.polygons.length;o++)this.polygons[o].flip();this.plane&&this.plane.flip(),this.front&&this.front.invert(),this.back&&this.back.invert();const s=this.front;this.front=this.back,this.back=s}clipPolygons(s){if(!this.plane)return s.slice();let o=new Array,a=new Array;for(let _e=0;_e<s.length;_e++)this.plane.splitPolygon(s[_e],o,a,o,a);return this.front&&(o=this.front.clipPolygons(o)),a=this.back?this.back.clipPolygons(a):[],o.concat(a)}clipTo(s){this.polygons=s.clipPolygons(this.polygons),this.front&&this.front.clipTo(s),this.back&&this.back.clipTo(s)}allPolygons(){let s=this.polygons.slice();return this.front&&(s=s.concat(this.front.allPolygons())),this.back&&(s=s.concat(this.back.allPolygons())),s}build(s){if(!s.length)return;this.plane||(this.plane=s[0].plane.clone());const o=[],a=[];for(let _e=0;_e<s.length;_e++)this.plane.splitPolygon(s[_e],this.polygons,this.polygons,o,a);o.length&&(this.front||(this.front=new Ey),this.front.build(o)),a.length&&(this.back||(this.back=new Ey),this.back.build(a))}}class mv{constructor(s=0,o=0,a=0){this.x=s,this.y=o,this.z=a}copy(s){return this.x=s.x,this.y=s.y,this.z=s.z,this}clone(){return new mv(this.x,this.y,this.z)}negate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}add(s){return this.x+=s.x,this.y+=s.y,this.z+=s.z,this}sub(s){return this.x-=s.x,this.y-=s.y,this.z-=s.z,this}times(s){return this.x*=s,this.y*=s,this.z*=s,this}dividedBy(s){return this.x/=s,this.y/=s,this.z/=s,this}lerp(s,o){return this.add(new mv().copy(s).sub(this).times(o))}unit(){return this.dividedBy(this.length())}length(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))}normalize(){return this.unit()}cross(s){const o=this.clone(),a=o.x,_e=o.y,rt=o.z,nt=s.x,ot=s.y,ct=s.z;return this.x=_e*ct-rt*ot,this.y=rt*nt-a*ct,this.z=a*ot-_e*nt,this}dot(s){return this.x*s.x+this.y*s.y+this.z*s.z}toVector3(){return new et.Pa4(this.x,this.y,this.z)}}class yx{constructor(s,o){this.normal=s,this.w=o,this.normal=s,this.w=o}clone(){return new yx(this.normal.clone(),this.w)}flip(){this.normal.negate(),this.w=-this.w}splitPolygon(s,o,a,_e,rt){let nt=0;const ot=[];for(let ct=0;ct<s.vertices.length;ct++){const pt=this.normal.dot(s.vertices[ct].pos)-this.w,ht=pt<-yx.EPSILON?2:pt>yx.EPSILON?1:0;nt|=ht,ot.push(ht)}switch(nt){case 0:(this.normal.dot(s.plane.normal)>0?o:a).push(s);break;case 1:_e.push(s);break;case 2:rt.push(s);break;case 3:{const ct=[],pt=[];for(let ht=0;ht<s.vertices.length;ht++){const _t=(ht+1)%s.vertices.length,Et=ot[ht],St=ot[_t],Mt=s.vertices[ht],It=s.vertices[_t];if(Et!=2&&ct.push(Mt),Et!=1&&pt.push(Et!=2?Mt.clone():Mt),(Et|St)==3){const Nt=(this.w-this.normal.dot(Mt.pos))/this.normal.dot(new mv().copy(It.pos).sub(Mt.pos)),Bt=Mt.interpolate(It,Nt);ct.push(Bt),pt.push(Bt.clone())}}ct.length>=3&&_e.push(new wS(ct,s.shared)),pt.length>=3&&rt.push(new wS(pt,s.shared));break}}}static fromPoints(s,o,a){const _e=new mv().copy(o).sub(s).cross(new mv().copy(a).sub(s)).normalize();return new yx(_e.clone(),_e.dot(s))}}yx.EPSILON=1e-5;class wS{constructor(s,o){this.vertices=s,this.shared=o,this.plane=yx.fromPoints(s[0].pos,s[1].pos,s[2].pos)}clone(){return new wS(this.vertices.map(s=>s.clone()),this.shared)}flip(){this.vertices.reverse().map(s=>s.flip()),this.plane.flip()}}class MI{constructor(s,o,a,_e){this.pos=new mv().copy(s),this.normal=new mv().copy(o),this.uv=new mv().copy(a),this.uv.z=0,_e&&(this.color=new mv().copy(_e))}clone(){return new MI(this.pos,this.normal,this.uv,this.color)}flip(){this.normal.negate()}interpolate(s,o){return new MI(this.pos.clone().lerp(s.pos,o),this.normal.clone().lerp(s.normal,o),this.uv.clone().lerp(s.uv,o),this.color&&s.color&&this.color.clone().lerp(s.color,o))}}class Ou{constructor(){this.polygons=new Array}static fromPolygons(s){const o=new Ou;return o.polygons=s,o}static fromGeometry(s,o){let a=[];const _e=s.attributes.position,rt=s.attributes.normal,nt=s.attributes.uv,ot=s.attributes.color,ct=s.groups;let pt;if(s.index)pt=s.index.array;else{pt=new Array(_e.array.length/_e.itemSize|0);for(let _t=0;_t<pt.length;_t++)pt[_t]=_t}const ht=pt.length/3|0;a=new Array(ht);for(let _t=0,Et=0,St=pt.length;_t<St;_t+=3,Et++){const Mt=new Array(3);for(let It=0;It<3;It++){const Nt=pt[_t+It],Bt=3*Nt,kt=2*Nt,Pt=_e.array[Bt],qt=_e.array[Bt+1],Kt=_e.array[Bt+2],nr=rt.array[Bt],ir=rt.array[Bt+1],fr=rt.array[Bt+2],br=nt==null?void 0:nt.array[kt],Tr=nt==null?void 0:nt.array[kt+1];Mt[It]=new MI(new mv(Pt,qt,Kt),new mv(nr,ir,fr),new mv(br,Tr,0),ot&&new mv(ot.array[kt],ot.array[kt+1],ot.array[kt+2]))}if(o===void 0&&ct&&ct.length>0)for(const It of ct)_t>=It.start&&_t<It.start+It.count&&(a[Et]=new wS(Mt,It.materialIndex));else a[Et]=new wS(Mt,o)}return Ou.fromPolygons(a.filter(_t=>!isNaN(_t.plane.normal.x)))}static toGeometry(s,o){let a=0;const _e=s.polygons;for(const St of _e)a+=St.vertices.length-2;const rt=new et.u9r,nt=new $2(3*a*3),ot=new $2(3*a*3),ct=new kN(2*a*3);let pt;const ht=[],_t=[];for(const St of _e){const Mt=St.vertices,It=Mt.length;St.shared!==void 0&&(ht[St.shared]||(ht[St.shared]=[])),It&&Mt[0].color!==void 0&&(pt||(pt=new $2(3*a*3)));for(let Nt=3;Nt<=It;Nt++)(St.shared===void 0?_t:ht[St.shared]).push(nt.top/3,nt.top/3+1,nt.top/3+2),nt.write(Mt[0].pos),nt.write(Mt[Nt-2].pos),nt.write(Mt[Nt-1].pos),ot.write(Mt[0].normal),ot.write(Mt[Nt-2].normal),ot.write(Mt[Nt-1].normal),ct&&(ct.write(Mt[0].uv),ct.write(Mt[Nt-2].uv),ct.write(Mt[Nt-1].uv)),pt&&(pt.write(Mt[0].color),pt.write(Mt[Nt-2].color),pt.write(Mt[Nt-1].color))}rt.setAttribute("position",new et.TlE(nt.array,3)),rt.setAttribute("normal",new et.TlE(ot.array,3)),ct&&rt.setAttribute("uv",new et.TlE(ct.array,2)),pt&&rt.setAttribute("color",new et.TlE(pt.array,3));for(let St=0;St<ht.length;St++)ht[St]===void 0&&(ht[St]=[]);if(ht.length){let St=[],Mt=0;for(let It=0;It<ht.length;It++)rt.addGroup(Mt,ht[It].length,It),Mt+=ht[It].length,St=St.concat(ht[It]);rt.addGroup(Mt,_t.length,ht.length),St=St.concat(_t),rt.setIndex(St)}const Et=new et.yGw().copy(o).invert();return rt.applyMatrix4(Et),rt.computeBoundingSphere(),rt.computeBoundingBox(),rt}static fromMesh(s,o){const a=Ou.fromGeometry(s.geometry,o),_e=new et.Pa4,rt=new et.Vkp;rt.getNormalMatrix(s.matrix);for(let nt=0;nt<a.polygons.length;nt++){const ot=a.polygons[nt];for(let ct=0;ct<ot.vertices.length;ct++){const pt=ot.vertices[ct];pt.pos.copy(_e.copy(pt.pos.toVector3()).applyMatrix4(s.matrix)),pt.normal.copy(_e.copy(pt.normal.toVector3()).applyMatrix3(rt))}}return a}static toMesh(s,o,a){const _e=Ou.toGeometry(s,o),rt=new et.Kj0(_e,a);return rt.matrix.copy(o),rt.matrix.decompose(rt.position,rt.quaternion,rt.scale),rt.rotation.setFromQuaternion(rt.quaternion),rt.updateMatrixWorld(),rt.castShadow=rt.receiveShadow=!0,rt}static union(s,o){const a=Ou.fromMesh(s),_e=Ou.fromMesh(o);return Ou.toMesh(a.union(_e),s.matrix,s.material)}static subtract(s,o){const a=Ou.fromMesh(s),_e=Ou.fromMesh(o);return Ou.toMesh(a.subtract(_e),s.matrix,s.material)}static intersect(s,o){const a=Ou.fromMesh(s),_e=Ou.fromMesh(o);return Ou.toMesh(a.intersect(_e),s.matrix,s.material)}clone(){const s=new Ou;return s.polygons=this.polygons.map(o=>o.clone()).filter(o=>Number.isFinite(o.plane.w)),s}toPolygons(){return this.polygons}union(s){const o=new Ey(this.clone().polygons),a=new Ey(s.clone().polygons);return o.clipTo(a),a.clipTo(o),a.invert(),a.clipTo(o),a.invert(),o.build(a.allPolygons()),Ou.fromPolygons(o.allPolygons())}subtract(s){const o=new Ey(this.clone().polygons),a=new Ey(s.clone().polygons);return o.invert(),o.clipTo(a),a.clipTo(o),a.invert(),a.clipTo(o),a.invert(),o.build(a.allPolygons()),o.invert(),Ou.fromPolygons(o.allPolygons())}intersect(s){const o=new Ey(this.clone().polygons),a=new Ey(s.clone().polygons);return o.invert(),a.clipTo(o),a.invert(),o.clipTo(a),a.clipTo(o),o.build(a.allPolygons()),o.invert(),Ou.fromPolygons(o.allPolygons())}inverse(){const s=this.clone();for(const o of s.polygons)o.flip();return s}toMesh(s,o){return Ou.toMesh(this,s,o)}toGeometry(s){return Ou.toGeometry(this,s)}}var xS=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};const j2=["union","subtract","intersect"];class gA extends io{constructor(){super(),this.enabled=!0,this.toJSON=void 0,this.dependencies=[Wo],this.rootMesh=new et.Kj0,this.showResult=!1,this.csgSelectedEnabled=!1,this.csgSelectedOperation="union",this._csgNeedsUpdate=!1,this._csgVisible=!1,this._sceneUpdate=this._sceneUpdate.bind(this),this._preFrame=this._preFrame.bind(this),this.makeSelectedCSGBrush=this.makeSelectedCSGBrush.bind(this),this.refreshCSG=this.refreshCSG.bind(this),this._selectedObjectChanged=this._selectedObjectChanged.bind(this),this._updateSelectedProperties=this._updateSelectedProperties.bind(this),this.downloadObject=this.downloadObject.bind(this),this.exportObject=this.exportObject.bind(this)}async onAdded(s){var o;await super.onAdded(s),this.rootObject=await s.createObject3D(),this.rootObject.modelObject.add(this.rootMesh),s.scene.addEventListener("sceneUpdate",this._sceneUpdate),s.addEventListener("preFrame",this._preFrame),(o=s.getPlugin(Wo))===null||o===void 0||o.addEventListener("selectedObjectChanged",this._selectedObjectChanged)}async makeSelectedCSGBrush(){var s,o;const a=(o=(s=this._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0?void 0:o.getSelectedObject();a&&a.geometry&&(a.userData._isCSGMesh||(a.userData.csgBrush||(a.userData.csgBrush={enabled:!0,operation:"union"}),this._selectedObjectChanged()))}refreshCSG(){this._sceneUpdate()}async downloadObject(){const s=await this.exportObject();s&&Nu(s,"csg."+s.ext)}async exportObject(){var s,o;const a=(o=(s=this._viewer)===null||s===void 0?void 0:s.getPluginByType("AssetExporterPlugin"))===null||o===void 0?void 0:o.exporter;if(!a||!this.rootObject)return;const _e=this.rootMesh.visible;this.rootMesh.visible=!0;const rt=await a.exportObject(this.rootObject.modelObject,{});return this.rootMesh.visible=_e,rt}_updateSelectedProperties(){var s,o;const a=(o=(s=this._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0?void 0:o.getSelectedObject();a&&a.userData.csgBrush&&(a.userData.csgBrush.enabled=this.csgSelectedEnabled,a.userData.csgBrush.operation=this.csgSelectedOperation)}_selectedObjectChanged(){var s,o,a,_e,rt,nt,ot,ct;const pt=(o=(s=this._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0?void 0:o.getSelectedObject();pt&&(this.csgSelectedEnabled=(_e=(a=pt.userData.csgBrush)===null||a===void 0?void 0:a.enabled)!==null&&_e!==void 0&&_e,this.csgSelectedOperation=(nt=(rt=pt.userData.csgBrush)===null||rt===void 0?void 0:rt.operation)!==null&&nt!==void 0?nt:"union"),(ct=(ot=this.uiConfig)===null||ot===void 0?void 0:ot.uiRefresh)===null||ct===void 0||ct.call(ot,"postFrame",!0)}_preFrame(){var s,o,a;if(!this.rootObject||!this._csgNeedsUpdate&&this._csgVisible===this.showResult)return;const _e=this._findCSGMeshes();this._csgNeedsUpdate&&(this._csgNeedsUpdate=!1,(s=this.rootObject)===null||s===void 0||s.modelObject.updateMatrixWorld(!0),((o=this.rootMesh.userData.dispose)!==null&&o!==void 0?o:this.rootMesh.removeFromParent)(),this.rootMesh=this._buildCSGMesh(_e)),this.rootMesh&&!this.rootMesh.parent&&((a=this.rootObject)===null||a===void 0||a.modelObject.add(this.rootMesh)),this.showResult?(_e.forEach(rt=>{rt[0].visible=!1}),this.rootObject.visible=!0,this._csgVisible=!0,this.rootObject.setDirty()):(_e.forEach(rt=>{rt[0].visible=!0}),this.rootObject.visible=!1,this._csgVisible=!1,this.rootObject.setDirty())}_findCSGMeshes(){var s;const o=[];return(s=this._viewer)===null||s===void 0||s.scene.traverse(a=>{var _e;a.isMesh&&a.geometry&&(!((_e=a.userData.csgBrush)===null||_e===void 0)&&_e.enabled)&&o.push([a,a.userData.csgBrush.operation])}),o}_sceneUpdate(s){var o,a;!((a=(o=s==null?void 0:s.object)===null||o===void 0?void 0:o.userData)===null||a===void 0)&&a._isCSGMesh||(this._csgNeedsUpdate=!0)}}xS([ds("Show Result",tt=>({onChange:()=>{var s;return(s=tt._viewer)===null||s===void 0?void 0:s.setDirty()}}))],gA.prototype,"showResult",void 0),xS([Qo("Make CSG Brush",tt=>({hidden:()=>{var s,o;const a=(o=(s=tt._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0?void 0:o.getSelectedObject();return!(a!=null&&a.userData)||!!a.userData.csgBrush||a.userData._isCSGMesh}}))],gA.prototype,"makeSelectedCSGBrush",null),xS([ds("Enabled",tt=>({hidden:()=>{var s,o;const a=(o=(s=tt._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0?void 0:o.getSelectedObject();return!a||!a.userData.csgBrush},onChange:tt._updateSelectedProperties}))],gA.prototype,"csgSelectedEnabled",void 0),xS([Mp("Operation",j2.map(tt=>({label:tt})),tt=>({hidden:()=>{var s,o;const a=(o=(s=tt._viewer)===null||s===void 0?void 0:s.getPlugin(Wo))===null||o===void 0?void 0:o.getSelectedObject();return!a||!a.userData.csgBrush},onChange:tt._updateSelectedProperties}))],gA.prototype,"csgSelectedOperation",void 0),xS([Qo("Refresh CSG")],gA.prototype,"refreshCSG",null),xS([Qo("Export Result",tt=>({hidden:()=>{var s;return!(!((s=tt._viewer)===null||s===void 0)&&s.getPluginByType("AssetExporterPlugin"))}}))],gA.prototype,"downloadObject",null);function r3(tt,s){let o=new Ou;const a=tt.map(rt=>rt[0].material).flatMap(rt=>rt);tt.forEach(([rt,nt])=>{if(!j2.includes(nt))return void console.error(`Unknown operation ${nt}`);rt.updateMatrix(),rt.updateMatrixWorld();const ot=rt.matrix;rt.matrix=rt.matrixWorld;let ct=0;ct=Array.isArray(rt.material)?void 0:a.indexOf(rt.material),o=o[nt](Ou.fromMesh(rt,ct)),rt.matrix=ot});const _e=o.toMesh(s??new et.yGw().identity(),a);return _e.userData._isCSGMesh=!0,_e.geometry.groups=_e.geometry.groups.filter(rt=>rt.count>0),_e}let RI=class extends gA{_buildCSGMesh(tt){return r3(tt)}};RI.PluginType="CSGPluginBSP",RI=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt}([Ao("CSG Plugin (BSP)")],RI);class vA{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(s,o){let a=1/0,_e=-1/0;for(let rt=0,nt=s.length;rt<nt;rt++){const ot=s[rt][o];a=ot<a?ot:a,_e=ot>_e?ot:_e}this.min=a,this.max=_e}setFromPoints(s,o){let a=1/0,_e=-1/0;for(let rt=0,nt=o.length;rt<nt;rt++){const ot=o[rt],ct=s.dot(ot);a=ct<a?ct:a,_e=ct>_e?ct:_e}this.min=a,this.max=_e}isSeparated(s){return this.min>s.max||s.min>this.max}}vA.prototype.setFromBox=function(){const tt=new et.Pa4;return function(s,o){const a=o.min,_e=o.max;let rt=1/0,nt=-1/0;for(let ot=0;ot<=1;ot++)for(let ct=0;ct<=1;ct++)for(let pt=0;pt<=1;pt++){tt.x=a.x*ot+_e.x*(1-ot),tt.y=a.y*ct+_e.y*(1-ct),tt.z=a.z*pt+_e.z*(1-pt);const ht=s.dot(tt);rt=Math.min(ht,rt),nt=Math.max(ht,nt)}this.min=rt,this.max=nt}}();const ON=function(){const tt=new et.Pa4,s=new et.Pa4,o=new et.Pa4;return function(a,_e,rt){const nt=a.start,ot=tt,ct=_e.start,pt=s;o.subVectors(nt,ct),tt.subVectors(a.end,_e.start),s.subVectors(_e.end,_e.start);const ht=o.dot(pt),_t=pt.dot(ot),Et=pt.dot(pt),St=o.dot(ot),Mt=ot.dot(ot)*Et-_t*_t;let It,Nt;It=Mt!==0?(ht*_t-St*Et)/Mt:0,Nt=(ht+It*_t)/Et,rt.x=It,rt.y=Nt}}(),z2=function(){const tt=new et.FM8,s=new et.Pa4,o=new et.Pa4;return function(a,_e,rt,nt){ON(a,_e,tt);let ot=tt.x,ct=tt.y;if(ot>=0&&ot<=1&&ct>=0&&ct<=1)return a.at(ot,rt),void _e.at(ct,nt);if(ot>=0&&ot<=1)return ct<0?_e.at(0,nt):_e.at(1,nt),void a.closestPointToPoint(nt,!0,rt);if(ct>=0&&ct<=1)return ot<0?a.at(0,rt):a.at(1,rt),void _e.closestPointToPoint(rt,!0,nt);{let pt,ht;pt=ot<0?a.start:a.end,ht=ct<0?_e.start:_e.end;const _t=s,Et=o;return a.closestPointToPoint(ht,!0,s),_e.closestPointToPoint(pt,!0,o),_t.distanceToSquared(ht)<=Et.distanceToSquared(pt)?(rt.copy(_t),void nt.copy(ht)):(rt.copy(pt),void nt.copy(Et))}}}(),LN=function(){const tt=new et.Pa4,s=new et.Pa4,o=new et.JOQ,a=new et.Zzh;return function(_e,rt){const{radius:nt,center:ot}=_e,{a:ct,b:pt,c:ht}=rt;if(a.start=ct,a.end=pt,a.closestPointToPoint(ot,!0,tt).distanceTo(ot)<=nt||(a.start=ct,a.end=ht,a.closestPointToPoint(ot,!0,tt).distanceTo(ot)<=nt)||(a.start=pt,a.end=ht,a.closestPointToPoint(ot,!0,tt).distanceTo(ot)<=nt))return!0;const _t=rt.getPlane(o);if(Math.abs(_t.distanceToPoint(ot))<=nt){const Et=_t.projectPoint(ot,s);if(rt.containsPoint(Et))return!0}return!1}}();function ES(tt){return Math.abs(tt)<1e-15}class Sy extends et.CJI{constructor(...s){super(...s),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new et.Pa4),this.satBounds=new Array(4).fill().map(()=>new vA),this.points=[this.a,this.b,this.c],this.sphere=new et.aLr,this.plane=new et.JOQ,this.needsUpdate=!0}intersectsSphere(s){return LN(s,this)}update(){const s=this.a,o=this.b,a=this.c,_e=this.points,rt=this.satAxes,nt=this.satBounds,ot=rt[0],ct=nt[0];this.getNormal(ot),ct.setFromPoints(ot,_e);const pt=rt[1],ht=nt[1];pt.subVectors(s,o),ht.setFromPoints(pt,_e);const _t=rt[2],Et=nt[2];_t.subVectors(o,a),Et.setFromPoints(_t,_e);const St=rt[3],Mt=nt[3];St.subVectors(a,s),Mt.setFromPoints(St,_e),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(ot,s),this.needsUpdate=!1}}Sy.prototype.closestPointToSegment=function(){const tt=new et.Pa4,s=new et.Pa4,o=new et.Zzh;return function(a,_e=null,rt=null){const{start:nt,end:ot}=a,ct=this.points;let pt,ht=1/0;for(let _t=0;_t<3;_t++){const Et=(_t+1)%3;o.start.copy(ct[_t]),o.end.copy(ct[Et]),z2(o,a,tt,s),pt=tt.distanceToSquared(s),pt<ht&&(ht=pt,_e&&_e.copy(tt),rt&&rt.copy(s))}return this.closestPointToPoint(nt,tt),pt=nt.distanceToSquared(tt),pt<ht&&(ht=pt,_e&&_e.copy(tt),rt&&rt.copy(nt)),this.closestPointToPoint(ot,tt),pt=ot.distanceToSquared(tt),pt<ht&&(ht=pt,_e&&_e.copy(tt),rt&&rt.copy(ot)),Math.sqrt(ht)}}(),Sy.prototype.intersectsTriangle=function(){const tt=new Sy,s=new Array(3),o=new Array(3),a=new vA,_e=new vA,rt=new et.Pa4,nt=new et.Pa4,ot=new et.Pa4,ct=new et.Pa4,pt=new et.Zzh,ht=new et.Zzh,_t=new et.Zzh;return function(Et,St=null){this.needsUpdate&&this.update(),Et.isExtendedTriangle?Et.needsUpdate&&Et.update():(tt.copy(Et),tt.update(),Et=tt);const Mt=this.plane,It=Et.plane;if(Math.abs(Mt.normal.dot(It.normal))>1-1e-10){const Nt=this.satBounds,Bt=this.satAxes;o[0]=Et.a,o[1]=Et.b,o[2]=Et.c;for(let qt=0;qt<4;qt++){const Kt=Nt[qt],nr=Bt[qt];if(a.setFromPoints(nr,o),Kt.isSeparated(a))return!1}const kt=Et.satBounds,Pt=Et.satAxes;s[0]=this.a,s[1]=this.b,s[2]=this.c;for(let qt=0;qt<4;qt++){const Kt=kt[qt],nr=Pt[qt];if(a.setFromPoints(nr,s),Kt.isSeparated(a))return!1}for(let qt=0;qt<4;qt++){const Kt=Bt[qt];for(let nr=0;nr<4;nr++){const ir=Pt[nr];if(rt.crossVectors(Kt,ir),a.setFromPoints(rt,s),_e.setFromPoints(rt,o),a.isSeparated(_e))return!1}}return St&&(console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),St.start.set(0,0,0),St.end.set(0,0,0)),!0}{const Nt=this.points;let Bt=!1,kt=0;for(let Rr=0;Rr<3;Rr++){const Nr=Nt[Rr],Ir=Nt[(Rr+1)%3];pt.start.copy(Nr),pt.end.copy(Ir),pt.delta(nt);const kr=Bt?ht.start:ht.end,Hr=ES(It.distanceToPoint(Nr));if(ES(It.normal.dot(nt))&&Hr){ht.copy(pt),kt=2;break}if((It.intersectLine(pt,kr)||Hr)&&!ES(kr.distanceTo(Ir))){if(kt++,Bt)break;Bt=!0}}if(kt===1&&this.containsPoint(ht.start))return St&&(St.start.copy(ht.start),St.end.copy(ht.start)),!0;if(kt!==2)return!1;const Pt=Et.points;let qt=!1,Kt=0;for(let Rr=0;Rr<3;Rr++){const Nr=Pt[Rr],Ir=Pt[(Rr+1)%3];pt.start.copy(Nr),pt.end.copy(Ir),pt.delta(ot);const kr=qt?_t.start:_t.end,Hr=ES(Mt.distanceToPoint(Nr));if(ES(Mt.normal.dot(ot))&&Hr){_t.copy(pt),Kt=2;break}if((Mt.intersectLine(pt,kr)||Hr)&&!ES(kr.distanceTo(Ir))){if(Kt++,qt)break;qt=!0}}if(Kt===1&&this.containsPoint(_t.start))return St&&(St.start.copy(_t.start),St.end.copy(_t.start)),!0;if(Kt!==2)return!1;if(ht.delta(nt),_t.delta(ot),nt.dot(ot)<0){let Rr=_t.start;_t.start=_t.end,_t.end=Rr}const nr=ht.start.dot(nt),ir=ht.end.dot(nt),fr=_t.start.dot(nt),br=_t.end.dot(nt),Tr=ir<fr,Dr=nr<br;return(nr===br||fr===ir||Tr!==Dr)&&(St&&(ct.subVectors(ht.start,_t.start),ct.dot(nt)>0?St.start.copy(ht.start):St.start.copy(_t.start),ct.subVectors(ht.end,_t.end),ct.dot(nt)<0?St.end.copy(ht.end):St.end.copy(_t.end)),!0)}}}(),Sy.prototype.distanceToPoint=function(){const tt=new et.Pa4;return function(s){return this.closestPointToPoint(s,tt),s.distanceTo(tt)}}(),Sy.prototype.distanceToTriangle=function(){const tt=new et.Pa4,s=new et.Pa4,o=["a","b","c"],a=new et.Zzh,_e=new et.Zzh;return function(rt,nt=null,ot=null){const ct=nt||ot?a:null;if(this.intersectsTriangle(rt,ct))return(nt||ot)&&(nt&&ct.getCenter(nt),ot&&ct.getCenter(ot)),0;let pt=1/0;for(let ht=0;ht<3;ht++){let _t;const Et=o[ht],St=rt[Et];this.closestPointToPoint(St,tt),_t=St.distanceToSquared(tt),_t<pt&&(pt=_t,nt&&nt.copy(tt),ot&&ot.copy(St));const Mt=this[Et];rt.closestPointToPoint(Mt,tt),_t=Mt.distanceToSquared(tt),_t<pt&&(pt=_t,nt&&nt.copy(Mt),ot&&ot.copy(tt))}for(let ht=0;ht<3;ht++){const _t=o[ht],Et=o[(ht+1)%3];a.set(this[_t],this[Et]);for(let St=0;St<3;St++){const Mt=o[St],It=o[(St+1)%3];_e.set(rt[Mt],rt[It]),z2(a,_e,tt,s);const Nt=tt.distanceToSquared(s);Nt<pt&&(pt=Nt,nt&&nt.copy(tt),ot&&ot.copy(s))}}return Math.sqrt(pt)}}();class n3{constructor(){this.intersectionSet={},this.ids=[]}add(s,o){const{intersectionSet:a,ids:_e}=this;a[s]||(a[s]=[],_e.push(s)),a[s].push(o)}}const Ax=new et.zHn,i3=new et.yGw,Gm=new et.CJI,_A=new et.Pa4,s3=new et.Ltg,o3=new et.Ltg,a3=new et.Ltg,V2=new et.Ltg,II=new et.Ltg,PI=new et.Ltg,G2=new et.Zzh,Q2=1e-8;let DI=null;function l3(tt){DI=tt}function u3(tt,s){function o(){return Math.random()-.5}Ax.origin.copy(tt.a).add(tt.b).add(tt.c).multiplyScalar(1/3),tt.getNormal(Ax.direction);let a=0,_e=1/0;for(let rt=0;rt<3;rt++){Ax.direction.x+=o()*Q2,Ax.direction.y+=o()*Q2,Ax.direction.z+=o()*Q2;const nt=s.raycastFirst(Ax,et.ehD);if(nt&&Ax.direction.dot(nt.face.normal)>0&&a++,nt!==null&&(_e=Math.min(_e,nt.distance)),_e===0||a/3>.5||(rt-a+1)/3>.5)break}return _e===0?0:a/3>.5?-1:1}function c3(tt,s,o,a,_e,rt,nt=!1){const ot=o.attributes,ct=o.index,pt=3*tt,ht=ct.getX(pt+0),_t=ct.getX(pt+1),Et=ct.getX(pt+2);for(const St in rt){const Mt=ot[St],It=rt[St];if(!(St in ot))throw new Error(`CSG Operations: Attribute ${St} not available on geometry.`);const Nt=Mt.itemSize;St==="position"?(Gm.a.fromBufferAttribute(Mt,ht).applyMatrix4(a),Gm.b.fromBufferAttribute(Mt,_t).applyMatrix4(a),Gm.c.fromBufferAttribute(Mt,Et).applyMatrix4(a),H2(Gm.a,Gm.b,Gm.c,s,3,It,nt)):St==="normal"?(Gm.a.fromBufferAttribute(Mt,ht).applyNormalMatrix(_e),Gm.b.fromBufferAttribute(Mt,_t).applyNormalMatrix(_e),Gm.c.fromBufferAttribute(Mt,Et).applyNormalMatrix(_e),nt&&(Gm.a.multiplyScalar(-1),Gm.b.multiplyScalar(-1),Gm.c.multiplyScalar(-1)),H2(Gm.a,Gm.b,Gm.c,s,3,It,nt,!0)):(s3.fromBufferAttribute(Mt,ht),o3.fromBufferAttribute(Mt,_t),a3.fromBufferAttribute(Mt,Et),H2(s3,o3,a3,s,Nt,It,nt))}}function d3(tt,s,o,a,_e,rt,nt,ot=!1){q2(tt,a,_e,rt,nt,ot),q2(s,a,_e,rt,nt,ot),q2(o,a,_e,rt,nt,ot)}function p3(tt,s,o=!1){switch(tt){case 0:if(s===1||s===0&&o)return 1;break;case 1:if(o){if(s===-1)return 0}else if(s===1)return 1;break;case 3:if(s===-1)return 0;if(s===1)return 1;case 4:if(s===-1||s===0&&o)return 1;break;default:throw new Error(`Unrecognized CSG operation enum "${tt}".`)}return 2}function H2(tt,s,o,a,_e,rt,nt=!1,ot=!1){const ct=pt=>{rt.push(pt.x),_e>1&&rt.push(pt.y),_e>2&&rt.push(pt.z),_e>3&&rt.push(pt.w)};V2.set(0,0,0,0).addScaledVector(tt,a.a.x).addScaledVector(s,a.a.y).addScaledVector(o,a.a.z),II.set(0,0,0,0).addScaledVector(tt,a.b.x).addScaledVector(s,a.b.y).addScaledVector(o,a.b.z),PI.set(0,0,0,0).addScaledVector(tt,a.c.x).addScaledVector(s,a.c.y).addScaledVector(o,a.c.z),ot&&(V2.normalize(),II.normalize(),PI.normalize()),ct(V2),nt?(ct(PI),ct(II)):(ct(II),ct(PI))}function q2(tt,s,o,a,_e,rt=!1){for(const nt in _e){const ot=s[nt],ct=_e[nt];if(!(nt in s))throw new Error(`CSG Operations: Attribute ${nt} no available on geometry.`);const pt=ot.itemSize;nt==="position"?(_A.fromBufferAttribute(ot,tt).applyMatrix4(o),ct.push(_A.x,_A.y,_A.z)):nt==="normal"?(_A.fromBufferAttribute(ot,tt).applyNormalMatrix(a),rt&&_A.multiplyScalar(-1),ct.push(_A.x,_A.y,_A.z)):(ct.push(ot.getX(tt)),pt>1&&ct.push(ot.getY(tt)),pt>2&&ct.push(ot.getZ(tt)),pt>3&&ct.push(ot.getW(tt)))}}const Pw=1e-14,BI=1e-7,Cy=new et.Zzh,Ju=new et.Zzh,T0=new et.Pa4,h3=new et.Pa4,CT=new et.JOQ,NN=new Sy;function TT(tt){return tt.a.distanceToSquared(tt.b)<Pw||tt.a.distanceToSquared(tt.c)<Pw||tt.b.distanceToSquared(tt.c)<Pw}class FN extends et.CJI{constructor(...s){super(...s),this.side=null,this.originalSide=null,this.coplanarCount=0}init(){this.side=null,this.originalSide=null,this.coplanarCount=0}initFrom(s){this.side=s.side,this.originalSide=s.originalSide,this.coplanarCount=s.coplanarCount}updateSide(s,o=null,a=-1){if(this.originalSide!==null&&this.side===null)return;T0.copy(this.a).add(this.b).add(this.c).multiplyScalar(1/3);const _e=s.distanceToPoint(T0)<0?-1:1;o&&a!==-1?_e===1&&(this.coplanarCount++,this.coplanarCount===3&&(this.side=0)):(this.originalSide===null&&(this.originalSide=_e,this.side=_e),_e!==this.side&&(this.side=null))}}class UN{constructor(){this._pool=[],this._index=0}getTriangle(){this._index>=this._pool.length&&this._pool.push(new FN);const s=this._pool[this._index++];return s.init(),s}clear(){this._index=0}reset(){this._pool.length=0,this._index=0}}class $N{constructor(){this.trianglePool=new UN,this.triangles=[],this.normal=new et.Pa4}initialize(s){const{triangles:o,trianglePool:a,normal:_e}=this;if(o.length=0,a.clear(),Array.isArray(s))for(let rt=0,nt=s.length;rt<nt;rt++){const ot=s[rt];if(rt===0)ot.getNormal(_e);else if(Math.abs(1-ot.getNormal(T0).dot(_e))>Pw)throw new Error("Triangle Splitter: Cannot initialize with triangles that have different normals.");const ct=a.getTriangle();ct.copy(ot),o.push(ct)}else{s.getNormal(_e);const rt=a.getTriangle();rt.copy(s),o.push(rt)}}splitByTriangle(s){const{normal:o,triangles:a}=this;if(s.getPlane(CT),Math.abs(1-Math.abs(CT.normal.dot(o)))<BI){const _e=[s.a,s.b,s.c];for(let rt=0;rt<3;rt++){const nt=(rt+1)%3,ot=_e[rt],ct=_e[nt];T0.subVectors(ct,ot).normalize(),h3.crossVectors(o,T0),CT.setFromNormalAndCoplanarPoint(h3,ot),this.splitByPlane(CT,s,rt)}for(let rt=0,nt=a.length;rt<nt;rt++)a[rt].coplanarCount=0}else this.splitByPlane(CT,s)}splitByPlane(s,o=null,a=-1){const{triangles:_e,trianglePool:rt}=this;let nt=null;o!==null&&(nt=NN,nt.copy(o),nt.needsUpdate=!0);for(let ot=0,ct=_e.length;ot<ct;ot++){const pt=_e[ot],{a:ht,b:_t,c:Et}=pt;if(nt&&(!nt.intersectsTriangle(pt,Cy)||Cy.distance()<1e-5)){pt.updateSide(s,nt,a),pt.side=null;continue}let St=0,Mt=-1,It=0,Nt=0,Bt=!1;const kt=[ht,_t,Et];for(let Pt=0;Pt<3;Pt++){const qt=(Pt+1)%3;Cy.start.copy(kt[Pt]),Cy.end.copy(kt[qt]);const Kt=s.distanceToPoint(Cy.start),nr=s.distanceToPoint(Cy.end);Math.abs(Kt)<Pw?Nt++:Kt>0&&It++,Math.abs(Kt)<BI&&Math.abs(nr)<BI&&(Bt=!0);let ir=!!s.intersectLine(Cy,T0);!ir&&Math.abs(nr)<Pw&&(T0.copy(Cy.end),ir=!0),!ir||T0.distanceTo(Cy.start)<Pw||(T0.distanceTo(Cy.end)<Pw&&(Mt=Pt),St===0?Ju.start.copy(T0):Ju.end.copy(T0),St++)}if(!Bt&&Nt<2&&St===2&&Ju.distance()>BI)if(Mt!==-1){Mt=(Mt+1)%3;let Pt=0;Pt===Mt&&(Pt=(Pt+1)%3);let qt=Pt+1;qt===Mt&&(qt=(qt+1)%3);const Kt=rt.getTriangle();Kt.a.copy(kt[qt]),Kt.b.copy(Ju.end),Kt.c.copy(Ju.start),TT(Kt)||(_e.push(Kt),Kt.initFrom(pt),Kt.updateSide(s,nt,a)),pt.a.copy(kt[Pt]),pt.b.copy(Ju.start),pt.c.copy(Ju.end),TT(pt)?(_e.splice(ot,1),ot--,ct--):pt.updateSide(s,nt,a)}else{const Pt=kt.findIndex(fr=>It>=2?s.distanceToPoint(fr)<0:s.distanceToPoint(fr)>0);if(Pt===0){let fr=Ju.start;Ju.start=Ju.end,Ju.end=fr}else if(Pt===-1)continue;const qt=(Pt+1)%3,Kt=(Pt+2)%3,nr=rt.getTriangle(),ir=rt.getTriangle();kt[qt].distanceToSquared(Ju.start)<kt[Kt].distanceToSquared(Ju.end)?(nr.a.copy(kt[qt]),nr.b.copy(Ju.start),nr.c.copy(Ju.end),ir.a.copy(kt[qt]),ir.b.copy(kt[Kt]),ir.c.copy(Ju.start)):(nr.a.copy(kt[Kt]),nr.b.copy(Ju.start),nr.c.copy(Ju.end),ir.a.copy(kt[qt]),ir.b.copy(kt[Kt]),ir.c.copy(Ju.end)),pt.a.copy(kt[Pt]),pt.b.copy(Ju.end),pt.c.copy(Ju.start),TT(nr)||(_e.push(nr),nr.initFrom(pt),nr.updateSide(s,nt,a)),TT(ir)||(_e.push(ir),ir.initFrom(pt),ir.updateSide(s,nt,a)),TT(pt)?(_e.splice(ot,1),ot--,ct--):pt.updateSide(s,nt,a)}else St===3&&console.warn("TriangleClipper: Coplanar clip not handled")}}reset(){this.triangles.length=0}}function f3(){return typeof SharedArrayBuffer<"u"}function jN(tt){if(tt.buffer instanceof SharedArrayBuffer)return tt;const s=tt.constructor,o=tt.buffer,a=new SharedArrayBuffer(o.byteLength),_e=new Uint8Array(o);return new Uint8Array(a).set(_e,0),new s(a)}class m3{constructor(s,o=500){const a=f3()?SharedArrayBuffer:ArrayBuffer;this.expansionFactor=1.5,this.type=s,this.array=new s(new a(o*s.BYTES_PER_ELEMENT)),this.length=0}expand(s=null){const{type:o,array:a,expansionFactor:_e}=this;s===null&&(s=~~(a.length*_e));const rt=new o(s);rt.set(a,0),this.array=rt}push(...s){let{array:o,length:a}=this;a+s.length>o.length&&(this.expand(),o=this.array);for(let _e=0,rt=s.length;_e<rt;_e++)o[a+_e]=s[_e];this.length+=s.length}clear(){this.length=0}}class zN{constructor(){this.groupAttributes=[{}],this.groupCount=0}getType(s){return this.groupAttributes[0][s].type}getTotalLength(s){const{groupCount:o,groupAttributes:a}=this;let _e=0;for(let rt=0;rt<o;rt++)_e+=a[rt][s].length;return _e}getGroupSet(s=0){const{groupAttributes:o}=this;if(o[s])return this.groupCount=Math.max(this.groupCount,s+1),o[s];const a=o[0];for(this.groupCount=Math.max(this.groupCount,s+1);s>=o.length;){const _e={};o.push(_e);for(const rt in a)_e[rt]=new m3(a[rt].type)}return o[s]}getGroupArray(s,o=0){const{groupAttributes:a}=this;if(!a[0][s])throw new Error(`TypedAttributeData: Attribute with "${s}" has not been initialized`);return this.getGroupSet(o)[s]}initializeArray(s,o){const{groupAttributes:a}=this,_e=a[0][s];if(_e){if(_e.type!==o)throw new Error(`TypedAttributeData: Array ${s} already initialized with a different type.`)}else for(let rt=0,nt=a.length;rt<nt;rt++)a[rt][s]=new m3(o)}clear(){this.groupCount=0;const{groupAttributes:s}=this;s.forEach(o=>{for(const a in o)o[a].clear()})}delete(s){this.groupAttributes.forEach(o=>{delete o[s]})}reset(){this.groupAttributes=[]}}class VN{constructor(s){this.triangle=new et.CJI().copy(s),this.intersects={}}addTriangle(s,o){this.intersects[s]=new et.CJI().copy(o)}getIntersectArray(){const s=[],{intersects:o}=this;for(const a in o)s.push(o[a]);return s}}class g3{constructor(){this.data={}}addTriangleIntersection(s,o,a,_e){const{data:rt}=this;rt[s]||(rt[s]=new VN(o)),rt[s].addTriangle(a,_e)}getTrianglesAsArray(s=null){const{data:o}=this,a=[];if(s!==null)s in o&&a.push(o[s].triangle);else for(const _e in o)a.push(o[_e].triangle);return a}getTriangleIndices(){return Object.keys(this.data).map(s=>parseInt(s))}getIntersectionIndices(s){const{data:o}=this;return o[s]?Object.keys(o[s].intersects).map(a=>parseInt(a)):[]}getIntersectionsAsArray(s=null,o=null){const{data:a}=this,_e=new Set,rt=[],nt=ot=>{if(a[ot])if(o!==null)a[ot].intersects[o]&&rt.push(a[ot].intersects[o]);else{const ct=a[ot].intersects;for(const pt in ct)_e.has(pt)||(_e.add(pt),rt.push(ct[pt]))}};if(s!==null)nt(s);else for(const ot in a)nt(ot);return rt}reset(){this.data={}}}class GN{constructor(){this.enabled=!1,this.triangleIntersectsA=new g3,this.triangleIntersectsB=new g3,this.intersectionEdges=[]}addIntersectingTriangles(s,o,a,_e){const{triangleIntersectsA:rt,triangleIntersectsB:nt}=this;rt.addTriangleIntersection(s,o,a,_e),nt.addTriangleIntersection(a,_e,s,o)}addEdge(s){this.intersectionEdges.push(s.clone())}reset(){this.triangleIntersectsA.reset(),this.triangleIntersectsB.reset(),this.intersectionEdges=[]}}const Dw=new et.yGw,SS=new et.Vkp,bx=new et.CJI,kI=new et.CJI,OI=new et.CJI,MT=new et.CJI;function QN(tt){for(const s of tt)return s}function v3(tt,s,o,a,_e,rt,nt,ot=0){Dw.copy(s.matrixWorld).invert().multiply(tt.matrixWorld),SS.getNormalMatrix(tt.matrixWorld);const ct=tt.geometry.groupIndices,pt=tt.geometry.index,ht=tt.geometry.attributes.position,_t=s.geometry.boundsTree,Et=s.geometry.index,St=s.geometry.attributes.position,Mt=o.ids,It=o.intersectionSet;for(let Nt=0,Bt=Mt.length;Nt<Bt;Nt++){const kt=Mt[Nt],Pt=ot===-1?0:ct[kt]+ot,qt=nt.getGroupSet(Pt),Kt=3*kt,nr=pt.getX(Kt+0),ir=pt.getX(Kt+1),fr=pt.getX(Kt+2);bx.a.fromBufferAttribute(ht,nr).applyMatrix4(Dw),bx.b.fromBufferAttribute(ht,ir).applyMatrix4(Dw),bx.c.fromBufferAttribute(ht,fr).applyMatrix4(Dw),rt.initialize(bx);const br=It[kt];for(let Dr=0,Rr=br.length;Dr<Rr;Dr++){const Nr=3*br[Dr],Ir=Et.getX(Nr+0),kr=Et.getX(Nr+1),Hr=Et.getX(Nr+2);kI.a.fromBufferAttribute(St,Ir),kI.b.fromBufferAttribute(St,kr),kI.c.fromBufferAttribute(St,Hr),rt.splitByTriangle(kI)}const Tr=rt.triangles;for(let Dr=0,Rr=Tr.length;Dr<Rr;Dr++){const Nr=Tr[Dr],Ir=p3(a,u3(Nr,_t),_e);if(Ir!==2)switch(bx.getBarycoord(Nr.a,MT.a),bx.getBarycoord(Nr.b,MT.b),bx.getBarycoord(Nr.c,MT.c),Ir){case 1:c3(kt,MT,tt.geometry,tt.matrixWorld,SS,qt);break;case 0:c3(kt,MT,tt.geometry,tt.matrixWorld,SS,qt,!0)}}}return Mt.length}function _3(tt,s,o,a,_e,rt,nt=0){Dw.copy(s.matrixWorld).invert().multiply(tt.matrixWorld),SS.getNormalMatrix(tt.matrixWorld);const ot=s.geometry.boundsTree,ct=tt.geometry.groupIndices,pt=tt.geometry.index,ht=tt.geometry.attributes,_t=ht.position,Et=[],St=tt.geometry.halfEdges,Mt=new Set;for(let It=0,Nt=pt.count/3;It<Nt;It++)It in o.intersectionSet||Mt.add(It);for(;Mt.size>0;){const It=QN(Mt);Mt.delete(It),Et.push(It);const Nt=3*It,Bt=pt.getX(Nt+0),kt=pt.getX(Nt+1),Pt=pt.getX(Nt+2);OI.a.fromBufferAttribute(_t,Bt).applyMatrix4(Dw),OI.b.fromBufferAttribute(_t,kt).applyMatrix4(Dw),OI.c.fromBufferAttribute(_t,Pt).applyMatrix4(Dw);const qt=p3(a,u3(OI,ot),_e);for(;Et.length>0;){const Kt=Et.pop(),nr=nt===-1?0:ct[Kt]+nt,ir=rt.getGroupSet(nr);for(let Rr=0;Rr<3;Rr++){const Nr=St.getSiblingTriangleIndex(Kt,Rr);Nr!==-1&&Mt.has(Nr)&&(Et.push(Nr),Mt.delete(Nr))}const fr=3*Kt,br=pt.getX(fr+0),Tr=pt.getX(fr+1),Dr=pt.getX(fr+2);switch(qt){case 1:d3(br,Tr,Dr,ht,tt.matrixWorld,SS,ir);break;case 0:d3(Dr,Tr,br,ht,tt.matrixWorld,SS,ir,_e)}}}}const W2=1.25,Y2=65535,HN=Math.pow(2,-24);class LI{constructor(){}}function Ty(tt,s,o){return o.min.x=s[tt],o.min.y=s[tt+1],o.min.z=s[tt+2],o.max.x=s[tt+3],o.max.y=s[tt+4],o.max.z=s[tt+5],o}function y3(tt){let s=-1,o=-1/0;for(let a=0;a<3;a++){const _e=tt[a+3]-tt[a];_e>o&&(o=_e,s=a)}return s}function A3(tt,s){s.set(tt)}function b3(tt,s,o){let a,_e;for(let rt=0;rt<3;rt++){const nt=rt+3;a=tt[rt],_e=s[rt],o[rt]=a<_e?a:_e,a=tt[nt],_e=s[nt],o[nt]=a>_e?a:_e}}function NI(tt,s,o){for(let a=0;a<3;a++){const _e=s[tt+2*a],rt=s[tt+2*a+1],nt=_e-rt,ot=_e+rt;nt<o[a]&&(o[a]=nt),ot>o[a+3]&&(o[a+3]=ot)}}function RT(tt){const s=tt[3]-tt[0],o=tt[4]-tt[1],a=tt[5]-tt[2];return 2*(s*o+o*a+a*s)}function K2(tt,s,o,a,_e=null){let rt=1/0,nt=1/0,ot=1/0,ct=-1/0,pt=-1/0,ht=-1/0,_t=1/0,Et=1/0,St=1/0,Mt=-1/0,It=-1/0,Nt=-1/0;const Bt=_e!==null;for(let kt=6*s,Pt=6*(s+o);kt<Pt;kt+=6){const qt=tt[kt+0],Kt=tt[kt+1],nr=qt-Kt,ir=qt+Kt;nr<rt&&(rt=nr),ir>ct&&(ct=ir),Bt&&qt<_t&&(_t=qt),Bt&&qt>Mt&&(Mt=qt);const fr=tt[kt+2],br=tt[kt+3],Tr=fr-br,Dr=fr+br;Tr<nt&&(nt=Tr),Dr>pt&&(pt=Dr),Bt&&fr<Et&&(Et=fr),Bt&&fr>It&&(It=fr);const Rr=tt[kt+4],Nr=tt[kt+5],Ir=Rr-Nr,kr=Rr+Nr;Ir<ot&&(ot=Ir),kr>ht&&(ht=kr),Bt&&Rr<St&&(St=Rr),Bt&&Rr>Nt&&(Nt=Rr)}a[0]=rt,a[1]=nt,a[2]=ot,a[3]=ct,a[4]=pt,a[5]=ht,Bt&&(_e[0]=_t,_e[1]=Et,_e[2]=St,_e[3]=Mt,_e[4]=It,_e[5]=Nt)}const qN=(tt,s)=>tt.candidate-s.candidate,Bw=new Array(32).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),FI=new Float32Array(6);class My extends et.ZzF{constructor(...s){super(...s),this.isOrientedBox=!0,this.matrix=new et.yGw,this.invMatrix=new et.yGw,this.points=new Array(8).fill().map(()=>new et.Pa4),this.satAxes=new Array(3).fill().map(()=>new et.Pa4),this.satBounds=new Array(3).fill().map(()=>new vA),this.alignedSatBounds=new Array(3).fill().map(()=>new vA),this.needsUpdate=!1}set(s,o,a){super.set(s,o),this.matrix.copy(a),this.needsUpdate=!0}copy(s){super.copy(s),this.matrix.copy(s.matrix),this.needsUpdate=!0}}My.prototype.update=function(){const tt=this.matrix,s=this.min,o=this.max,a=this.points;for(let ct=0;ct<=1;ct++)for(let pt=0;pt<=1;pt++)for(let ht=0;ht<=1;ht++){const _t=a[1*ct|2*pt|4*ht];_t.x=ct?o.x:s.x,_t.y=pt?o.y:s.y,_t.z=ht?o.z:s.z,_t.applyMatrix4(tt)}const _e=this.satBounds,rt=this.satAxes,nt=a[0];for(let ct=0;ct<3;ct++){const pt=rt[ct],ht=_e[ct],_t=a[1<<ct];pt.subVectors(nt,_t),ht.setFromPoints(pt,a)}const ot=this.alignedSatBounds;ot[0].setFromPointsField(a,"x"),ot[1].setFromPointsField(a,"y"),ot[2].setFromPointsField(a,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},My.prototype.intersectsBox=function(){const tt=new vA;return function(s){this.needsUpdate&&this.update();const o=s.min,a=s.max,_e=this.satBounds,rt=this.satAxes,nt=this.alignedSatBounds;if(tt.min=o.x,tt.max=a.x,nt[0].isSeparated(tt)||(tt.min=o.y,tt.max=a.y,nt[1].isSeparated(tt))||(tt.min=o.z,tt.max=a.z,nt[2].isSeparated(tt)))return!1;for(let ot=0;ot<3;ot++){const ct=rt[ot],pt=_e[ot];if(tt.setFromBox(ct,s),pt.isSeparated(tt))return!1}return!0}}(),My.prototype.intersectsTriangle=function(){const tt=new Sy,s=new Array(3),o=new vA,a=new vA,_e=new et.Pa4;return function(rt){this.needsUpdate&&this.update(),rt.isExtendedTriangle?rt.needsUpdate&&rt.update():(tt.copy(rt),tt.update(),rt=tt);const nt=this.satBounds,ot=this.satAxes;s[0]=rt.a,s[1]=rt.b,s[2]=rt.c;for(let _t=0;_t<3;_t++){const Et=nt[_t],St=ot[_t];if(o.setFromPoints(St,s),Et.isSeparated(o))return!1}const ct=rt.satBounds,pt=rt.satAxes,ht=this.points;for(let _t=0;_t<3;_t++){const Et=ct[_t],St=pt[_t];if(o.setFromPoints(St,ht),Et.isSeparated(o))return!1}for(let _t=0;_t<3;_t++){const Et=ot[_t];for(let St=0;St<4;St++){const Mt=pt[St];if(_e.crossVectors(Et,Mt),o.setFromPoints(_e,s),a.setFromPoints(_e,ht),o.isSeparated(a))return!1}}return!0}}(),My.prototype.closestPointToPoint=function(tt,s){return this.needsUpdate&&this.update(),s.copy(tt).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),s},My.prototype.distanceToPoint=function(){const tt=new et.Pa4;return function(s){return this.closestPointToPoint(s,tt),s.distanceTo(tt)}}(),My.prototype.distanceToBox=function(){const tt=["x","y","z"],s=new Array(12).fill().map(()=>new et.Zzh),o=new Array(12).fill().map(()=>new et.Zzh),a=new et.Pa4,_e=new et.Pa4;return function(rt,nt=0,ot=null,ct=null){if(this.needsUpdate&&this.update(),this.intersectsBox(rt))return(ot||ct)&&(rt.getCenter(_e),this.closestPointToPoint(_e,a),rt.closestPointToPoint(a,_e),ot&&ot.copy(a),ct&&ct.copy(_e)),0;const pt=nt*nt,ht=rt.min,_t=rt.max,Et=this.points;let St=1/0;for(let It=0;It<8;It++){const Nt=Et[It];_e.copy(Nt).clamp(ht,_t);const Bt=Nt.distanceToSquared(_e);if(Bt<St&&(St=Bt,ot&&ot.copy(Nt),ct&&ct.copy(_e),Bt<pt))return Math.sqrt(Bt)}let Mt=0;for(let It=0;It<3;It++)for(let Nt=0;Nt<=1;Nt++)for(let Bt=0;Bt<=1;Bt++){const kt=(It+1)%3,Pt=(It+2)%3,qt=1<<It|Nt<<kt|Bt<<Pt,Kt=Et[Nt<<kt|Bt<<Pt],nr=Et[qt];s[Mt].set(Kt,nr);const ir=tt[It],fr=tt[kt],br=tt[Pt],Tr=o[Mt],Dr=Tr.start,Rr=Tr.end;Dr[ir]=ht[ir],Dr[fr]=Nt?ht[fr]:_t[fr],Dr[br]=Bt?ht[br]:_t[fr],Rr[ir]=_t[ir],Rr[fr]=Nt?ht[fr]:_t[fr],Rr[br]=Bt?ht[br]:_t[fr],Mt++}for(let It=0;It<=1;It++)for(let Nt=0;Nt<=1;Nt++)for(let Bt=0;Bt<=1;Bt++){_e.x=It?_t.x:ht.x,_e.y=Nt?_t.y:ht.y,_e.z=Bt?_t.z:ht.z,this.closestPointToPoint(_e,a);const kt=_e.distanceToSquared(a);if(kt<St&&(St=kt,ot&&ot.copy(a),ct&&ct.copy(_e),kt<pt))return Math.sqrt(kt)}for(let It=0;It<12;It++){const Nt=s[It];for(let Bt=0;Bt<12;Bt++){const kt=o[Bt];z2(Nt,kt,a,_e);const Pt=a.distanceToSquared(_e);if(Pt<St&&(St=Pt,ot&&ot.copy(a),ct&&ct.copy(_e),Pt<pt))return Math.sqrt(Pt)}}return Math.sqrt(St)}}();const UI=new et.Pa4,$I=new et.Pa4,jI=new et.Pa4,w3=new et.FM8,x3=new et.FM8,E3=new et.FM8,S3=new et.Pa4;function C3(tt,s,o,a,_e){const rt=3*a,nt=tt.index.getX(rt),ot=tt.index.getX(rt+1),ct=tt.index.getX(rt+2),pt=function(ht,_t,Et,St,Mt,It,Nt){UI.fromBufferAttribute(_t,St),$I.fromBufferAttribute(_t,Mt),jI.fromBufferAttribute(_t,It);const Bt=function(kt,Pt,qt,Kt,nr,ir){let fr;return fr=ir===et._Li?kt.intersectTriangle(Kt,qt,Pt,!0,nr):kt.intersectTriangle(Pt,qt,Kt,ir!==et.ehD,nr),fr===null?null:{distance:kt.origin.distanceTo(nr),point:nr.clone()}}(ht,UI,$I,jI,S3,Nt);if(Bt){Et&&(w3.fromBufferAttribute(Et,St),x3.fromBufferAttribute(Et,Mt),E3.fromBufferAttribute(Et,It),Bt.uv=et.CJI.getUV(S3,UI,$I,jI,w3,x3,E3,new et.FM8));const kt={a:St,b:Mt,c:It,normal:new et.Pa4,materialIndex:0};et.CJI.getNormal(UI,$I,jI,kt.normal),Bt.face=kt,Bt.faceIndex=St}return Bt}(o,tt.attributes.position,tt.attributes.uv,nt,ot,ct,s);return pt?(pt.faceIndex=a,_e&&_e.push(pt),pt):null}function T3(tt,s,o){return tt===null?null:(tt.point.applyMatrix4(s.matrixWorld),tt.distance=tt.point.distanceTo(o.ray.origin),tt.object=s,tt.distance<o.near||tt.distance>o.far?null:tt)}function Ry(tt,s,o,a){const _e=tt.a,rt=tt.b,nt=tt.c;let ot=s,ct=s+1,pt=s+2;o&&(ot=o.getX(s),ct=o.getX(s+1),pt=o.getX(s+2)),_e.x=a.getX(ot),_e.y=a.getY(ot),_e.z=a.getZ(ot),rt.x=a.getX(ct),rt.y=a.getY(ct),rt.z=a.getZ(ct),nt.x=a.getX(pt),nt.y=a.getY(pt),nt.z=a.getZ(pt)}function M3(tt,s,o,a,_e,rt,nt){const ot=o.index,ct=o.attributes.position;for(let pt=tt,ht=s+tt;pt<ht;pt++)if(Ry(nt,3*pt,ot,ct),nt.needsUpdate=!0,a(nt,pt,_e,rt))return!0;return!1}class R3{constructor(s){this._getNewPrimitive=s,this._primitives=[]}getPrimitive(){const s=this._primitives;return s.length===0?this._getNewPrimitive():s.pop()}releasePrimitive(s){this._primitives.push(s)}}function kw(tt,s){return s[tt+15]===65535}function CS(tt,s){return s[tt+6]}function IT(tt,s){return s[tt+14]}function PT(tt){return tt+8}function DT(tt,s){return s[tt+6]}const TS=new et.ZzF,zI=new et.Pa4,WN=["x","y","z"];function X2(tt,s,o,a,_e){let rt=2*tt,nt=MS,ot=Ow,ct=Lw;if(kw(rt,ot))(function(pt,ht,_t,Et,St,Mt){for(let It=Et,Nt=Et+St;It<Nt;It++)C3(pt,ht,_t,It,Mt)})(s,o,a,CS(tt,ct),IT(rt,ot),_e);else{const pt=PT(tt);VI(pt,nt,a,zI)&&X2(pt,s,o,a,_e);const ht=DT(tt,ct);VI(ht,nt,a,zI)&&X2(ht,s,o,a,_e)}}function J2(tt,s,o,a){let _e=2*tt,rt=MS,nt=Ow,ot=Lw;if(kw(_e,nt))return function(ct,pt,ht,_t,Et){let St=1/0,Mt=null;for(let It=_t,Nt=_t+Et;It<Nt;It++){const Bt=C3(ct,pt,ht,It);Bt&&Bt.distance<St&&(Mt=Bt,St=Bt.distance)}return Mt}(s,o,a,CS(tt,ot),IT(_e,nt));{const ct=function(It,Nt){return Nt[It+7]}(tt,ot),pt=WN[ct],ht=a.direction[pt]>=0;let _t,Et;ht?(_t=PT(tt),Et=DT(tt,ot)):(_t=DT(tt,ot),Et=PT(tt));const St=VI(_t,rt,a,zI)?J2(_t,s,o,a):null;if(St){const It=St.point[pt];if(ht?It<=rt[Et+ct]:It>=rt[Et+ct+3])return St}const Mt=VI(Et,rt,a,zI)?J2(Et,s,o,a):null;return St&&Mt?St.distance<=Mt.distance?St:Mt:St||Mt||null}}const YN=function(){let tt,s;const o=[],a=new R3(()=>new et.ZzF);return function(...rt){tt=a.getPrimitive(),s=a.getPrimitive(),o.push(tt,s);const nt=_e(...rt);a.releasePrimitive(tt),a.releasePrimitive(s),o.pop(),o.pop();const ot=o.length;return ot>0&&(s=o[ot-1],tt=o[ot-2]),nt};function _e(rt,nt,ot,ct,pt=null,ht=0,_t=0){function Et(kt){let Pt=2*kt,qt=Ow,Kt=Lw;for(;!kw(Pt,qt);)Pt=2*(kt=PT(kt));return CS(kt,Kt)}function St(kt){let Pt=2*kt,qt=Ow,Kt=Lw;for(;!kw(Pt,qt);)Pt=2*(kt=DT(kt,Kt));return CS(kt,Kt)+IT(Pt,qt)}let Mt=2*rt,It=MS,Nt=Ow,Bt=Lw;if(kw(Mt,Nt)){const kt=CS(rt,Bt),Pt=IT(Mt,Nt);return Ty(rt,It,tt),ct(kt,Pt,!1,_t,ht+rt,tt)}{const kt=PT(rt),Pt=DT(rt,Bt);let qt,Kt,nr,ir,fr=kt,br=Pt;if(pt&&(nr=tt,ir=s,Ty(fr,It,nr),Ty(br,It,ir),qt=pt(nr),Kt=pt(ir),Kt<qt)){fr=Pt,br=kt;const Ir=qt;qt=Kt,Kt=Ir,nr=ir}nr||(nr=tt,Ty(fr,It,nr));const Tr=ot(nr,kw(2*fr,Nt),qt,_t+1,ht+fr);let Dr;if(Tr===2){const Ir=Et(fr);Dr=ct(Ir,St(fr)-Ir,!0,_t+1,ht+fr,nr)}else Dr=Tr&&_e(fr,nt,ot,ct,pt,ht,_t+1);if(Dr)return!0;ir=s,Ty(br,It,ir);const Rr=ot(ir,kw(2*br,Nt),Kt,_t+1,ht+br);let Nr;if(Rr===2){const Ir=Et(br);Nr=ct(Ir,St(br)-Ir,!0,_t+1,ht+br,ir)}else Nr=Rr&&_e(br,nt,ot,ct,pt,ht,_t+1);return!!Nr}}}(),KN=function(){const tt=new Sy,s=new Sy,o=new et.yGw,a=new My,_e=new My;return function rt(nt,ot,ct,pt,ht=null){let _t=2*nt,Et=MS,St=Ow,Mt=Lw;if(ht===null&&(ct.boundingBox||ct.computeBoundingBox(),a.set(ct.boundingBox.min,ct.boundingBox.max,pt),ht=a),!kw(_t,St)){const It=nt+8,Nt=Mt[nt+6];return Ty(It,Et,TS),ht.intersectsBox(TS)&&rt(It,ot,ct,pt,ht)?!0:(Ty(Nt,Et,TS),!(!ht.intersectsBox(TS)||!rt(Nt,ot,ct,pt,ht)))}{const It=ot,Nt=It.index,Bt=It.attributes.position,kt=ct.index,Pt=ct.attributes.position,qt=CS(nt,Mt),Kt=IT(_t,St);if(o.copy(pt).invert(),ct.boundsTree)return Ty(nt,Et,_e),_e.matrix.copy(o),_e.needsUpdate=!0,ct.boundsTree.shapecast({intersectsBounds:ir=>_e.intersectsBox(ir),intersectsTriangle:ir=>{ir.a.applyMatrix4(pt),ir.b.applyMatrix4(pt),ir.c.applyMatrix4(pt),ir.needsUpdate=!0;for(let fr=3*qt,br=3*(Kt+qt);fr<br;fr+=3)if(Ry(s,fr,Nt,Bt),s.needsUpdate=!0,ir.intersectsTriangle(s))return!0;return!1}});for(let nr=3*qt,ir=Kt+3*qt;nr<ir;nr+=3){Ry(tt,nr,Nt,Bt),tt.a.applyMatrix4(o),tt.b.applyMatrix4(o),tt.c.applyMatrix4(o),tt.needsUpdate=!0;for(let fr=0,br=kt.count;fr<br;fr+=3)if(Ry(s,fr,kt,Pt),s.needsUpdate=!0,tt.intersectsTriangle(s))return!0}}}}();function VI(tt,s,o,a){return Ty(tt,s,TS),o.intersectBox(TS,a)}const Z2=[];let GI,MS,Ow,Lw;function BT(tt){GI&&Z2.push(GI),GI=tt,MS=new Float32Array(tt),Ow=new Uint16Array(tt),Lw=new Uint32Array(tt)}function QI(){GI=null,MS=null,Ow=null,Lw=null,Z2.length&&BT(Z2.pop())}const eD=Symbol("skip tree generation"),tD=new et.ZzF,rD=new et.ZzF,RS=new et.yGw,wx=new My,kT=new My,OT=new et.Pa4,HI=new et.Pa4,XN=new et.Pa4,JN=new et.Pa4,ZN=new et.Pa4,I3=new et.ZzF,Iy=new R3(()=>new Sy);class Zp{static serialize(s,o={}){if(o.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),Zp.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0||arguments[2]});o={cloneBuffers:!0,...o};const a=s.geometry,_e=s._roots,rt=a.getIndex();let nt;return nt=o.cloneBuffers?{roots:_e.map(ot=>ot.slice()),index:rt.array.slice()}:{roots:_e,index:rt.array},nt}static deserialize(s,o,a={}){if(typeof a=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),Zp.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0||arguments[2]});a={setIndex:!0,...a};const{index:_e,roots:rt}=s,nt=new Zp(o,{...a,[eD]:!0});if(nt._roots=rt,a.setIndex){const ot=o.getIndex();if(ot===null){const ct=new et.TlE(s.index,1,!1);o.setIndex(ct)}else ot.array!==_e&&(ot.array.set(_e),ot.needsUpdate=!0)}return nt}constructor(s,o={}){if(!s.isBufferGeometry)throw new Error("MeshBVH: Only BufferGeometries are supported.");if(s.index&&s.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.");if((o=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[eD]:!1},o)).useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,o[eD]||(this._roots=function(a,_e){const rt=function(St,Mt){function It(Ir){br&&br(Ir/Tr)}function Nt(Ir,kr,Hr,Lr=null,en=0){if(!Dr&&en>=Kt&&(Dr=!0,nr&&(console.warn(`MeshBVH: Max depth of ${Kt} reached when generating BVH. Consider increasing maxDepth.`),console.warn(St))),Hr<=ir||en>=Kt)return It(kr+Hr),Ir.offset=kr,Ir.count=Hr,Ir;const vn=function(pn,Fn,Gn,Qn,Yn,bs){let Cn=-1,eo=0;if(bs===0)Cn=y3(Fn),Cn!==-1&&(eo=(Fn[Cn]+Fn[Cn+3])/2);else if(bs===1)Cn=y3(pn),Cn!==-1&&(eo=function(vo,to,zo,Sl){let yn=0;for(let qn=to,Wn=to+zo;qn<Wn;qn++)yn+=vo[6*qn+2*Sl];return yn/zo}(Gn,Qn,Yn,Cn));else if(bs===2){const vo=RT(pn);let to=W2*Yn;const zo=6*Qn,Sl=6*(Qn+Yn);for(let yn=0;yn<3;yn++){const qn=Fn[yn],Wn=(Fn[yn+3]-qn)/32;if(Yn<8){const ro=[...Bw];ro.length=Yn;let yl=0;for(let Qr=zo;Qr<Sl;Qr+=6,yl++){const Sr=ro[yl];Sr.candidate=Gn[Qr+2*yn],Sr.count=0;const{bounds:Xr,leftCacheBounds:un,rightCacheBounds:Kr}=Sr;for(let _n=0;_n<3;_n++)Kr[_n]=1/0,Kr[_n+3]=-1/0,un[_n]=1/0,un[_n+3]=-1/0,Xr[_n]=1/0,Xr[_n+3]=-1/0;NI(Qr,Gn,Xr)}ro.sort(qN);let xr=Yn;for(let Qr=0;Qr<xr;Qr++){const Sr=ro[Qr];for(;Qr+1<xr&&ro[Qr+1].candidate===Sr.candidate;)ro.splice(Qr+1,1),xr--}for(let Qr=zo;Qr<Sl;Qr+=6){const Sr=Gn[Qr+2*yn];for(let Xr=0;Xr<xr;Xr++){const un=ro[Xr];Sr>=un.candidate?NI(Qr,Gn,un.rightCacheBounds):(NI(Qr,Gn,un.leftCacheBounds),un.count++)}}for(let Qr=0;Qr<xr;Qr++){const Sr=ro[Qr],Xr=Sr.count,un=Yn-Sr.count,Kr=Sr.leftCacheBounds,_n=Sr.rightCacheBounds;let Jn=0;Xr!==0&&(Jn=RT(Kr)/vo);let us=0;un!==0&&(us=RT(_n)/vo);const _s=1+W2*(Jn*Xr+us*un);_s<to&&(Cn=yn,to=_s,eo=Sr.candidate)}}else{for(let xr=0;xr<32;xr++){const Qr=Bw[xr];Qr.count=0,Qr.candidate=qn+Wn+xr*Wn;const Sr=Qr.bounds;for(let Xr=0;Xr<3;Xr++)Sr[Xr]=1/0,Sr[Xr+3]=-1/0}for(let xr=zo;xr<Sl;xr+=6){let Qr=~~((Gn[xr+2*yn]-qn)/Wn);Qr>=32&&(Qr=31);const Sr=Bw[Qr];Sr.count++,NI(xr,Gn,Sr.bounds)}const ro=Bw[31];A3(ro.bounds,ro.rightCacheBounds);for(let xr=30;xr>=0;xr--){const Qr=Bw[xr],Sr=Bw[xr+1];b3(Qr.bounds,Sr.rightCacheBounds,Qr.rightCacheBounds)}let yl=0;for(let xr=0;xr<31;xr++){const Qr=Bw[xr],Sr=Qr.count,Xr=Qr.bounds,un=Bw[xr+1].rightCacheBounds;Sr!==0&&(yl===0?A3(Xr,FI):b3(Xr,FI,FI)),yl+=Sr;let Kr=0,_n=0;yl!==0&&(Kr=RT(FI)/vo);const Jn=Yn-yl;Jn!==0&&(_n=RT(un)/vo);const us=1+W2*(Kr*yl+_n*Jn);us<to&&(Cn=yn,to=us,eo=Qr.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${bs} used.`);return{axis:Cn,pos:eo}}(Ir.boundingData,Lr,Pt,kr,Hr,fr);if(vn.axis===-1)return It(kr+Hr),Ir.offset=kr,Ir.count=Hr,Ir;const wn=function(pn,Fn,Gn,Qn,Yn){let bs=Gn,Cn=Gn+Qn-1;const eo=Yn.pos,vo=2*Yn.axis;for(;;){for(;bs<=Cn&&Fn[6*bs+vo]<eo;)bs++;for(;bs<=Cn&&Fn[6*Cn+vo]>=eo;)Cn--;if(!(bs<Cn))return bs;for(let to=0;to<3;to++){let zo=pn[3*bs+to];pn[3*bs+to]=pn[3*Cn+to],pn[3*Cn+to]=zo;let Sl=Fn[6*bs+2*to+0];Fn[6*bs+2*to+0]=Fn[6*Cn+2*to+0],Fn[6*Cn+2*to+0]=Sl;let yn=Fn[6*bs+2*to+1];Fn[6*bs+2*to+1]=Fn[6*Cn+2*to+1],Fn[6*Cn+2*to+1]=yn}bs++,Cn--}}(qt,Pt,kr,Hr,vn);if(wn===kr||wn===kr+Hr)It(kr+Hr),Ir.offset=kr,Ir.count=Hr;else{Ir.splitAxis=vn.axis;const pn=new LI,Fn=kr,Gn=wn-kr;Ir.left=pn,pn.boundingData=new Float32Array(6),K2(Pt,Fn,Gn,pn.boundingData,kt),Nt(pn,Fn,Gn,kt,en+1);const Qn=new LI,Yn=wn,bs=Hr-Gn;Ir.right=Qn,Qn.boundingData=new Float32Array(6),K2(Pt,Yn,bs,Qn.boundingData,kt),Nt(Qn,Yn,bs,kt,en+1)}return Ir}(function(Ir,kr){if(!Ir.index){const Hr=Ir.attributes.position.count,Lr=kr.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;let en;en=Hr>65535?new Uint32Array(new Lr(4*Hr)):new Uint16Array(new Lr(2*Hr)),Ir.setIndex(new et.TlE(en,1));for(let vn=0;vn<Hr;vn++)en[vn]=vn}})(St,Mt);const Bt=new Float32Array(6),kt=new Float32Array(6),Pt=function(Ir,kr){const Hr=Ir.attributes.position,Lr=Hr.array,en=Ir.index.array,vn=en.length/3,wn=new Float32Array(6*vn),pn=Hr.offset||0;let Fn=3;Hr.isInterleavedBufferAttribute&&(Fn=Hr.data.stride);for(let Gn=0;Gn<vn;Gn++){const Qn=3*Gn,Yn=6*Gn,bs=en[Qn+0]*Fn+pn,Cn=en[Qn+1]*Fn+pn,eo=en[Qn+2]*Fn+pn;for(let vo=0;vo<3;vo++){const to=Lr[bs+vo],zo=Lr[Cn+vo],Sl=Lr[eo+vo];let yn=to;zo<yn&&(yn=zo),Sl<yn&&(yn=Sl);let qn=to;zo>qn&&(qn=zo),Sl>qn&&(qn=Sl);const Wn=(qn-yn)/2,ro=2*vo;wn[Yn+ro+0]=yn+Wn,wn[Yn+ro+1]=Wn+(Math.abs(yn)+Wn)*HN,yn<kr[vo]&&(kr[vo]=yn),qn>kr[vo+3]&&(kr[vo+3]=qn)}}return wn}(St,Bt),qt=St.index.array,Kt=Mt.maxDepth,nr=Mt.verbose,ir=Mt.maxLeafTris,fr=Mt.strategy,br=Mt.onProgress,Tr=St.index.count/3;let Dr=!1;const Rr=[],Nr=function(Ir){if(!Ir.groups||!Ir.groups.length)return[{offset:0,count:Ir.index.count/3}];const kr=[],Hr=new Set;for(const en of Ir.groups)Hr.add(en.start),Hr.add(en.start+en.count);const Lr=Array.from(Hr.values()).sort((en,vn)=>en-vn);for(let en=0;en<Lr.length-1;en++){const vn=Lr[en],wn=Lr[en+1];kr.push({offset:vn/3,count:(wn-vn)/3})}return kr}(St);if(Nr.length===1){const Ir=Nr[0],kr=new LI;kr.boundingData=Bt,function(Hr,Lr,en,vn){let wn=1/0,pn=1/0,Fn=1/0,Gn=-1/0,Qn=-1/0,Yn=-1/0;for(let bs=6*Lr,Cn=6*(Lr+en);bs<Cn;bs+=6){const eo=Hr[bs+0];eo<wn&&(wn=eo),eo>Gn&&(Gn=eo);const vo=Hr[bs+2];vo<pn&&(pn=vo),vo>Qn&&(Qn=vo);const to=Hr[bs+4];to<Fn&&(Fn=to),to>Yn&&(Yn=to)}vn[0]=wn,vn[1]=pn,vn[2]=Fn,vn[3]=Gn,vn[4]=Qn,vn[5]=Yn}(Pt,Ir.offset,Ir.count,kt),Nt(kr,Ir.offset,Ir.count,kt),Rr.push(kr)}else for(let Ir of Nr){const kr=new LI;kr.boundingData=new Float32Array(6),K2(Pt,Ir.offset,Ir.count,kr.boundingData,kt),Nt(kr,Ir.offset,Ir.count,kt),Rr.push(kr)}return Rr}(a,_e);let nt,ot,ct;const pt=[],ht=_e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let St=0;St<rt.length;St++){const Mt=rt[St],It=new ht(32*_t(Mt));nt=new Float32Array(It),ot=new Uint32Array(It),ct=new Uint16Array(It),Et(0,Mt),pt.push(It)}return pt;function _t(St){return St.count?1:1+_t(St.left)+_t(St.right)}function Et(St,Mt){const It=St/4,Nt=St/2,Bt=!!Mt.count,kt=Mt.boundingData;for(let Pt=0;Pt<6;Pt++)nt[It+Pt]=kt[Pt];if(Bt){const Pt=Mt.offset,qt=Mt.count;return ot[It+6]=Pt,ct[Nt+14]=qt,ct[Nt+15]=Y2,St+32}{const Pt=Mt.left,qt=Mt.right,Kt=Mt.splitAxis;let nr;if(nr=Et(St+32,Pt),nr/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return ot[It+6]=nr/4,nr=Et(nr,qt),ot[It+7]=Kt,nr}}}(s,o),!s.boundingBox&&o.setBoundingBox&&(s.boundingBox=this.getBoundingBox(new et.ZzF))),this.geometry=s}refit(s=null){s&&Array.isArray(s)&&(s=new Set(s));const o=this.geometry,a=o.index.array,_e=o.attributes.position,rt=_e.array,nt=_e.offset||0;let ot,ct,pt,ht,_t=3;_e.isInterleavedBufferAttribute&&(_t=_e.data.stride);let Et=0;const St=this._roots;for(let It=0,Nt=St.length;It<Nt;It++)ot=St[It],ct=new Uint32Array(ot),pt=new Uint16Array(ot),ht=new Float32Array(ot),Mt(0,Et),Et+=ot.byteLength;function Mt(It,Nt,Bt=!1){const kt=2*It;if(pt[kt+15]===Y2){const Pt=ct[It+6];let qt=1/0,Kt=1/0,nr=1/0,ir=-1/0,fr=-1/0,br=-1/0;for(let Tr=3*Pt,Dr=3*(Pt+pt[kt+14]);Tr<Dr;Tr++){const Rr=a[Tr]*_t+nt,Nr=rt[Rr+0],Ir=rt[Rr+1],kr=rt[Rr+2];Nr<qt&&(qt=Nr),Nr>ir&&(ir=Nr),Ir<Kt&&(Kt=Ir),Ir>fr&&(fr=Ir),kr<nr&&(nr=kr),kr>br&&(br=kr)}return(ht[It+0]!==qt||ht[It+1]!==Kt||ht[It+2]!==nr||ht[It+3]!==ir||ht[It+4]!==fr||ht[It+5]!==br)&&(ht[It+0]=qt,ht[It+1]=Kt,ht[It+2]=nr,ht[It+3]=ir,ht[It+4]=fr,ht[It+5]=br,!0)}{const Pt=It+8,qt=ct[It+6],Kt=Pt+Nt,nr=qt+Nt;let ir=Bt,fr=!1,br=!1;s?ir||(fr=s.has(Kt),br=s.has(nr),ir=!fr&&!br):(fr=!0,br=!0);const Tr=ir||br;let Dr=!1;(ir||fr)&&(Dr=Mt(Pt,Nt,ir));let Rr=!1;Tr&&(Rr=Mt(qt,Nt,ir));const Nr=Dr||Rr;if(Nr)for(let Ir=0;Ir<3;Ir++){const kr=Pt+Ir,Hr=qt+Ir,Lr=ht[kr],en=ht[kr+3],vn=ht[Hr],wn=ht[Hr+3];ht[It+Ir]=Lr<vn?Lr:vn,ht[It+Ir+3]=en>wn?en:wn}return Nr}}}traverse(s,o=0){const a=this._roots[o],_e=new Uint32Array(a),rt=new Uint16Array(a);(function nt(ot,ct=0){const pt=2*ot,ht=rt[pt+15]===Y2;if(ht){const _t=_e[ot+6],Et=rt[pt+14];s(ct,ht,new Float32Array(a,4*ot,6),_t,Et)}else{const _t=ot+8,Et=_e[ot+6],St=_e[ot+7];s(ct,ht,new Float32Array(a,4*ot,6),St)||(nt(_t,ct+1),nt(Et,ct+1))}})(0)}raycast(s,o=et.Wl3){const a=this._roots,_e=this.geometry,rt=[],nt=o.isMaterial,ot=Array.isArray(o),ct=_e.groups,pt=nt?o.side:o;for(let ht=0,_t=a.length;ht<_t;ht++){const Et=ot?o[ct[ht].materialIndex].side:pt,St=rt.length;if(BT(a[ht]),X2(0,_e,Et,s,rt),QI(),ot){const Mt=ct[ht].materialIndex;for(let It=St,Nt=rt.length;It<Nt;It++)rt[It].face.materialIndex=Mt}}return rt}raycastFirst(s,o=et.Wl3){const a=this._roots,_e=this.geometry,rt=o.isMaterial,nt=Array.isArray(o);let ot=null;const ct=_e.groups,pt=rt?o.side:o;for(let ht=0,_t=a.length;ht<_t;ht++){const Et=nt?o[ct[ht].materialIndex].side:pt;BT(a[ht]);const St=J2(0,_e,Et,s);QI(),St!=null&&(ot==null||St.distance<ot.distance)&&(ot=St,nt&&(St.face.materialIndex=ct[ht].materialIndex))}return ot}intersectsGeometry(s,o){const a=this.geometry;let _e=!1;for(const rt of this._roots)if(BT(rt),_e=KN(0,a,s,o),QI(),_e)break;return _e}shapecast(s,o,a){const _e=this.geometry;if(s instanceof Function){if(o){const Et=o;o=(St,Mt,It,Nt)=>{const Bt=3*Mt;return Et(St,Bt,Bt+1,Bt+2,It,Nt)}}s={boundsTraverseOrder:a,intersectsBounds:s,intersectsTriangle:o,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}const rt=Iy.getPrimitive();let{boundsTraverseOrder:nt,intersectsBounds:ot,intersectsRange:ct,intersectsTriangle:pt}=s;if(ct&&pt){const Et=ct;ct=(St,Mt,It,Nt,Bt)=>!!Et(St,Mt,It,Nt,Bt)||M3(St,Mt,_e,pt,It,Nt,rt)}else ct||(ct=pt?(Et,St,Mt,It)=>M3(Et,St,_e,pt,Mt,It,rt):(Et,St,Mt)=>Mt);let ht=!1,_t=0;for(const Et of this._roots){if(BT(Et),ht=YN(0,_e,ot,ct,nt,_t),QI(),ht)break;_t+=Et.byteLength}return Iy.releasePrimitive(rt),ht}bvhcast(s,o,a){let{intersectsRanges:_e,intersectsTriangles:rt}=a;const nt=this.geometry.index,ot=this.geometry.attributes.position,ct=s.geometry.index,pt=s.geometry.attributes.position;RS.copy(o).invert();const ht=Iy.getPrimitive(),_t=Iy.getPrimitive();if(rt){let Mt=function(It,Nt,Bt,kt,Pt,qt,Kt,nr){for(let ir=Bt,fr=Bt+kt;ir<fr;ir++){Ry(_t,3*ir,ct,pt),_t.a.applyMatrix4(o),_t.b.applyMatrix4(o),_t.c.applyMatrix4(o),_t.needsUpdate=!0;for(let br=It,Tr=It+Nt;br<Tr;br++)if(Ry(ht,3*br,nt,ot),ht.needsUpdate=!0,rt(ht,_t,br,ir,Pt,qt,Kt,nr))return!0}return!1};var St=Mt;if(_e){const It=_e;_e=function(Nt,Bt,kt,Pt,qt,Kt,nr,ir){return!!It(Nt,Bt,kt,Pt,qt,Kt,nr,ir)||Mt(Nt,Bt,kt,Pt,qt,Kt,nr,ir)}}else _e=Mt}s.getBoundingBox(rD),rD.applyMatrix4(o);const Et=this.shapecast({intersectsBounds:Mt=>rD.intersectsBox(Mt),intersectsRange:(Mt,It,Nt,Bt,kt,Pt)=>(tD.copy(Pt),tD.applyMatrix4(RS),s.shapecast({intersectsBounds:qt=>tD.intersectsBox(qt),intersectsRange:(qt,Kt,nr,ir,fr)=>_e(Mt,It,qt,Kt,Bt,kt,ir,fr)}))});return Iy.releasePrimitive(ht),Iy.releasePrimitive(_t),Et}intersectsBox(s,o){return wx.set(s.min,s.max,o),wx.needsUpdate=!0,this.shapecast({intersectsBounds:a=>wx.intersectsBox(a),intersectsTriangle:a=>wx.intersectsTriangle(a)})}intersectsSphere(s){return this.shapecast({intersectsBounds:o=>s.intersectsBox(o),intersectsTriangle:o=>o.intersectsSphere(s)})}closestPointToGeometry(s,o,a={},_e={},rt=0,nt=1/0){s.boundingBox||s.computeBoundingBox(),wx.set(s.boundingBox.min,s.boundingBox.max,o),wx.needsUpdate=!0;const ot=this.geometry,ct=ot.attributes.position,pt=ot.index,ht=s.attributes.position,_t=s.index,Et=Iy.getPrimitive(),St=Iy.getPrimitive();let Mt=HI,It=XN,Nt=null,Bt=null;_e&&(Nt=JN,Bt=ZN);let kt=1/0,Pt=null,qt=null;return RS.copy(o).invert(),kT.matrix.copy(RS),this.shapecast({boundsTraverseOrder:Kt=>wx.distanceToBox(Kt),intersectsBounds:(Kt,nr,ir)=>ir<kt&&ir<nt&&(nr&&(kT.min.copy(Kt.min),kT.max.copy(Kt.max),kT.needsUpdate=!0),!0),intersectsRange:(Kt,nr)=>{if(s.boundsTree)return s.boundsTree.shapecast({boundsTraverseOrder:ir=>kT.distanceToBox(ir),intersectsBounds:(ir,fr,br)=>br<kt&&br<nt,intersectsRange:(ir,fr)=>{for(let br=3*ir,Tr=3*(ir+fr);br<Tr;br+=3){Ry(St,br,_t,ht),St.a.applyMatrix4(o),St.b.applyMatrix4(o),St.c.applyMatrix4(o),St.needsUpdate=!0;for(let Dr=3*Kt,Rr=3*(Kt+nr);Dr<Rr;Dr+=3){Ry(Et,Dr,pt,ct),Et.needsUpdate=!0;const Nr=Et.distanceToTriangle(St,Mt,Nt);if(Nr<kt&&(It.copy(Mt),Bt&&Bt.copy(Nt),kt=Nr,Pt=Dr/3,qt=br/3),Nr<rt)return!0}}}});for(let ir=0,fr=_t?_t.count:ht.count;ir<fr;ir+=3){Ry(St,ir,_t,ht),St.a.applyMatrix4(o),St.b.applyMatrix4(o),St.c.applyMatrix4(o),St.needsUpdate=!0;for(let br=3*Kt,Tr=3*(Kt+nr);br<Tr;br+=3){Ry(Et,br,pt,ct),Et.needsUpdate=!0;const Dr=Et.distanceToTriangle(St,Mt,Nt);if(Dr<kt&&(It.copy(Mt),Bt&&Bt.copy(Nt),kt=Dr,Pt=br/3,qt=ir/3),Dr<rt)return!0}}}}),Iy.releasePrimitive(Et),Iy.releasePrimitive(St),kt===1/0?null:(a.point?a.point.copy(It):a.point=It.clone(),a.distance=kt,a.faceIndex=Pt,_e&&(_e.point?_e.point.copy(Bt):_e.point=Bt.clone(),_e.point.applyMatrix4(RS),It.applyMatrix4(RS),_e.distance=It.sub(_e.point).length(),_e.faceIndex=qt),a)}closestPointToPoint(s,o={},a=0,_e=1/0){const rt=a*a,nt=_e*_e;let ot=1/0,ct=null;if(this.shapecast({boundsTraverseOrder:ht=>(OT.copy(s).clamp(ht.min,ht.max),OT.distanceToSquared(s)),intersectsBounds:(ht,_t,Et)=>Et<ot&&Et<nt,intersectsTriangle:(ht,_t)=>{ht.closestPointToPoint(s,OT);const Et=s.distanceToSquared(OT);return Et<ot&&(HI.copy(OT),ot=Et,ct=_t),Et<rt}}),ot===1/0)return null;const pt=Math.sqrt(ot);return o.point?o.point.copy(HI):o.point=HI.clone(),o.distance=pt,o.faceIndex=ct,o}getBoundingBox(s){return s.makeEmpty(),this._roots.forEach(o=>{Ty(0,new Float32Array(o),I3),s.union(I3)}),s}}const P3=Zp.prototype.raycast;Zp.prototype.raycast=function(...tt){if(tt[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycast" has changed. See docs for new signature.');const[s,o,a,_e]=tt;return P3.call(this,a,s.material).forEach(rt=>{(rt=T3(rt,s,o))&&_e.push(rt)}),_e}return P3.apply(this,tt)};const D3=Zp.prototype.raycastFirst;Zp.prototype.raycastFirst=function(...tt){if(tt[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycastFirst" has changed. See docs for new signature.');const[s,o,a]=tt;return T3(D3.call(this,a,s.material),s,o)}return D3.apply(this,tt)};const B3=Zp.prototype.closestPointToPoint;Zp.prototype.closestPointToPoint=function(...tt){if(tt[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "closestPointToPoint" has changed. See docs for new signature.'),tt.unshift();const s=tt[1],o={};return tt[1]=o,B3.apply(this,tt),s&&s.copy(o.point),o.distance}return B3.apply(this,tt)};const k3=Zp.prototype.closestPointToGeometry;Zp.prototype.closestPointToGeometry=function(...tt){const s=tt[2],o=tt[3];if(s&&s.isVector3||o&&o.isVector3){console.warn('MeshBVH: The function signature and results frame for "closestPointToGeometry" has changed. See docs for new signature.');const a={},_e={},rt=tt[1];return tt[2]=a,tt[3]=_e,k3.apply(this,tt),s&&s.copy(a.point),o&&o.copy(_e.point).applyMatrix4(rt),a.distance}return k3.apply(this,tt)};const O3=Zp.prototype.refit;Zp.prototype.refit=function(...tt){const s=tt[0],o=tt[1];if(o&&(o instanceof Set||Array.isArray(o))){console.warn('MeshBVH: The function signature for "refit" has changed. See docs for new signature.');const a=new Set;o.forEach(_e=>a.add(_e)),s&&s.forEach(_e=>a.add(_e)),O3.call(this,a)}else O3.apply(this,tt)},["intersectsGeometry","shapecast","intersectsBox","intersectsSphere"].forEach(tt=>{const s=Zp.prototype[tt];Zp.prototype[tt]=function(...o){return(o[0]===null||o[0].isMesh)&&(o.shift(),console.warn(`MeshBVH: The function signature for "${tt}" has changed and no longer takes Mesh. See docs for new signature.`)),s.apply(this,o)}});const nD=[new et.Pa4,new et.Pa4,new et.Pa4];function iD(tt){return~~(1e4*tt)}function L3(tt){return`${iD(tt.x)},${iD(tt.y)},${iD(tt.z)}`}class eF{constructor(s=null){this.data=null,this.unmatchedEdges=null,this.matchedEdges=null,this.useDrawRange=!0,s&&this.updateFrom(s)}getSiblingTriangleIndex(s,o){const a=this.data[3*s+o];return a===-1?-1:~~(a/3)}getSiblingEdgeIndex(s,o){const a=this.data[3*s+o];return a===-1?-1:a%3}updateFrom(s){const o=new Map,{attributes:a}=s,_e=s.index,rt=a.position;let nt=_e?_e.count/3:rt.count/3;const ot=nt;let ct=0;this.useDrawRange&&(ct=s.drawRange.start,s.drawRange.count!==1/0&&(nt=~~(s.drawRange.count/3)));let pt=this.data;(!pt||pt.length<3*ot)&&(pt=new Int32Array(3*ot)),pt.fill(-1);let ht=0,_t=0;for(let Et=0;Et<nt;Et++){const St=3*Et+ct;for(let Mt=0;Mt<3;Mt++){let It=St+Mt;_e&&(It=_e.getX(It)),nD[Mt].fromBufferAttribute(rt,It)}for(let Mt=0;Mt<3;Mt++){const It=(Mt+1)%3,Nt=nD[Mt],Bt=nD[It],kt=L3(Nt),Pt=L3(Bt),qt=`${Pt}_${kt}`;if(o.has(qt)){const Kt=o.get(qt);pt[St+Mt]=Kt,pt[Kt]=St+Mt,o.delete(qt),ht--,_t++}else{const Kt=`${kt}_${Pt}`;o.set(Kt,St+Mt),ht++}}}this.matchedEdges=_t,this.unmatchedEdges=ht,this.data=pt}}class qI extends et.Kj0{constructor(...s){super(...s),this.isBrush=!0,this._previousMatrix=new et.yGw,this._previousMatrix.elements.fill(0)}markUpdated(){this._previousMatrix.copy(this.matrix)}isDirty(){const{matrix:s,_previousMatrix:o}=this,a=s.elements,_e=o.elements;for(let rt=0;rt<16;rt++)if(a[rt]!==_e[rt])return!0;return!1}prepareGeometry(){const s=this.geometry,o=s.attributes;if(f3())for(const a in o){const _e=o[a];if(_e.isInterleavedBufferAttribute)throw new Error("Brush: InterleavedBufferAttributes are not supported.");_e.array=jN(_e.array)}if(s.boundsTree||(s.boundsTree=new Zp(s,{maxLeafTris:3}),s.halfEdges&&s.halfEdges.updateFrom(s)),s.halfEdges||(s.halfEdges=new eF(s)),!s.groupIndices){const a=s.index.count/3,_e=new Uint16Array(a),rt=s.groups;for(let nt=0,ot=rt.length;nt<ot;nt++){const{start:ct,count:pt}=rt[nt];for(let ht=ct/3,_t=(ct+pt)/3;ht<_t;ht++)_e[ht]=nt}s.groupIndices=_e}}disposeCacheData(){const{geometry:s}=this;s.halfEdges=null,s.boundsTree=null,s.groupIndices=null}}function N3(tt,s){let o=s;return Array.isArray(s)||(o=[],tt.forEach(a=>{o[a.materialIndex]=s})),o}class tF{constructor(){this.triangleSplitter=new $N,this.attributeData=new zN,this.attributes=["position","uv","normal"],this.useGroups=!0,this.debug=new GN}evaluate(s,o,a,_e=new qI){s.prepareGeometry(),o.prepareGeometry();const{triangleSplitter:rt,attributeData:nt,attributes:ot,useGroups:ct,debug:pt}=this,ht=_e.geometry,_t=s.geometry.attributes;for(let Bt=0,kt=ot.length;Bt<kt;Bt++){const Pt=ot[Bt],qt=_t[Pt];nt.initializeArray(Pt,qt.array.constructor)}for(const Bt in nt.attributes)ot.includes(Bt)||nt.delete(Bt);for(const Bt in ht.attributes)ot.includes(Bt)||(ht.deleteAttribute(Bt),ht.dispose());nt.clear(),pt.enabled&&(pt.reset(),l3(pt)),function(Bt,kt,Pt,qt,Kt,nr){const{useGroups:ir=!0}=nr,{aIntersections:fr,bIntersections:br}=function(Dr,Rr){const Nr=new n3,Ir=new n3;return i3.copy(Dr.matrixWorld).invert().multiply(Rr.matrixWorld),Dr.geometry.boundsTree.bvhcast(Rr.geometry.boundsTree,i3,{intersectsTriangles:(kr,Hr,Lr,en)=>(kr.intersectsTriangle(Hr,G2)&&G2.distance()>1e-5&&(Nr.add(Lr,en),Ir.add(en,Lr),DI&&(DI.addEdge(G2),DI.addIntersectingTriangles(Lr,kr,en,Hr))),!1)}),{aIntersections:Nr,bIntersections:Ir}}(Bt,kt);let Tr;Tr=ir?0:-1,_3(Bt,kt,fr,Pt,!1,Kt,Tr),v3(Bt,kt,fr,Pt,!1,qt,Kt,Tr),Tr=ir?Bt.geometry.groups.length||1:-1,_3(kt,Bt,br,Pt,!0,Kt,Tr),v3(kt,Bt,br,Pt,!0,qt,Kt,Tr)}(s,o,a,rt,nt,{useGroups:ct}),pt.enabled&&l3(null);const Et=ct&&s.geometry.groups.length!==0?s.geometry.groups.map(Bt=>({...Bt})):[{start:0,count:1/0,materialIndex:0}],St=ct&&o.geometry.groups.length!==0?o.geometry.groups.map(Bt=>({...Bt})):[{start:0,count:1/0,materialIndex:0}],Mt=N3(Et,s.material),It=N3(St,o.material);St.forEach(Bt=>{Bt.materialIndex+=Mt.length}),function(Bt,kt,Pt,qt){let Kt=!1,nr=-1;const ir=qt.groupCount,fr=Bt.attributes,br=qt.groupAttributes[0];for(const Dr in br){const Rr=qt.getTotalLength(Dr,ir),Nr=br[Dr].type;let Ir=fr[Dr];if(!Ir||Ir.array.length<Rr){const Hr=kt.attributes[Dr];Ir=new et.TlE(new Nr(Rr),Hr.itemSize,Hr.normalized),Bt.setAttribute(Dr,Ir),Kt=!0}let kr=0;for(let Hr=0;Hr<ir;Hr++){const{array:Lr,type:en,length:vn}=qt.groupAttributes[Hr][Dr],wn=new en(Lr.buffer,0,vn);Ir.array.set(wn,kr),kr+=wn.length}Ir.needsUpdate=!0,nr=Rr/Ir.itemSize}Bt.setDrawRange(0,nr),Bt.clearGroups();let Tr=0;for(let Dr=0;Dr<ir;Dr++){const Rr=qt.getGroupArray("position",Dr).length/3;if(Rr!==0){const Nr=Pt[Dr];Bt.addGroup(Tr,Rr,Nr.materialIndex),Tr+=Rr}}if(Bt.index){const Dr=Bt.index.array;if(Dr.length<nr)Bt.index=null,Kt=!0;else for(let Rr=0,Nr=Dr.length;Rr<Nr;Rr++)Dr[Rr]=Rr}Bt.boundsTree=null,Kt&&Bt.dispose()}(ht,s.geometry,[...Et,...St],nt);const Nt=ht.groups;if(ct){const Bt=new Map,kt=[...Mt,...It];let Pt=0;for(let qt=0,Kt=kt.length;qt<Kt;qt++)Nt.find(nr=>nr.materialIndex===qt)?(Bt.set(qt,Pt),Pt++):kt[qt]=null;for(let qt=0,Kt=Nt.length;qt<Kt;qt++){const nr=Nt[qt];nr.materialIndex=Bt.get(nr.materialIndex)}_e.material=kt.filter(qt=>qt)}return _e}evaluateHierarchy(s,o=new qI){s.updateMatrixWorld(!0);const a=(rt,nt)=>{const ot=rt.children;for(let ct=0,pt=ot.length;ct<pt;ct++){const ht=ot[ct];ht.isOperationGroup?a(ht,nt):nt(ht)}},_e=rt=>{const nt=rt.children;let ot=!1;for(let pt=0,ht=nt.length;pt<ht;pt++){const _t=nt[pt];ot=_e(_t)||ot}const ct=rt.isDirty();if(ct&&rt.markUpdated(),ot&&!rt.isOperationGroup){let pt;return a(rt,ht=>{pt=pt?this.evaluate(pt,ht,ht.operation):this.evaluate(rt,ht,ht.operation)}),rt._cachedGeometry=pt.geometry,rt._cachedMaterials=pt.material,!0}return ot||ct};return _e(s),o.geometry=s._cachedGeometry,o.material=s._cachedMaterials,o}reset(){this.triangleSplitter.reset()}}const F3={union:0,subtract:1,intersect:4,difference:3};function U3(tt,s){const o=new tF;o.useGroups=!0,o.attributes=["position","normal","uv"],tt.forEach(rt=>{for(const nt of[...o.attributes])rt[0].geometry.getAttribute(nt)||o.attributes.splice(o.attributes.indexOf(nt),1)});let a=new qI(new et._12(.01,.01,2,2));tt.forEach(([rt,nt])=>{if(!Object.keys(F3).includes(nt))return void console.error(`Unknown operation ${nt}`);rt.updateMatrix(),rt.updateMatrixWorld();const ot=new qI;ot.geometry=rt.geometry,ot.material=rt.material,rt.matrixWorld.decompose(ot.position,ot.quaternion,ot.scale),ot.updateMatrix(),ot.updateMatrixWorld(),a=o.evaluate(a,ot,F3[nt])});const _e=a;return _e.userData._isCSGMesh=!0,_e}let WI=class extends gA{_buildCSGMesh(tt){return U3(tt)}};WI.PluginType="CSGPluginBVH",WI=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt}([Ao("CSG Plugin (BVH)")],WI);var $3=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};const rF=new et.Pa4(0,0,1),j3=new et.USm,nF=new et._fP,iF=new et._fP(-Math.sqrt(.5),0,0,Math.sqrt(.5)),IS=new et._fP,sF={type:"change"};let LT=class extends it{constructor(tt){super(),this.enabled=!1,this.lastOrder="XYZ",this.dampingFactor=.05,this.lastQuaternion=new et._fP,this.onDeviceOrientationChangeEvent=s=>{this.deviceOrientation=s},this.onScreenOrientationChangeEvent=()=>{this.screenOrientation=screen.orientation},this._initQuaternion=new et._fP,this._initQuaternionInvert=new et._fP,this._initQuaternionDest=new et._fP,this._lastTime=-1,window.isSecureContext===!1&&console.error("DeviceOrientationControls2: DeviceOrientationEvent is only available in secure contexts (https)"),this.object=tt,this.lastOrder=this.object.rotation.order,this.object.rotation.reorder("YXZ"),this.connect()}connect(){this.onScreenOrientationChangeEvent(),window.DeviceOrientationEvent!==void 0&&typeof window.DeviceOrientationEvent.requestPermission=="function"?window.DeviceOrientationEvent.requestPermission().then(tt=>{tt=="granted"&&(window.addEventListener("orientationchange",this.onScreenOrientationChangeEvent),window.addEventListener("deviceorientation",this.onDeviceOrientationChangeEvent))}).catch(tt=>{console.error("DeviceOrientationControls2: Unable to use DeviceOrientation API:",tt)}):(window.addEventListener("orientationchange",this.onScreenOrientationChangeEvent),window.addEventListener("deviceorientation",this.onDeviceOrientationChangeEvent)),this.enabled=!0,this._initQuaternion.copy(this.object.quaternion),this._initQuaternionInvert.copy(this.object.quaternion).invert()}disconnect(){window.removeEventListener("orientationchange",this.onScreenOrientationChangeEvent),window.removeEventListener("deviceorientation",this.onDeviceOrientationChangeEvent),this._initQuaternion.identity(),this._initQuaternionInvert.identity(),this._initQuaternionDest=new et._fP,this.object.rotation.reorder(this.lastOrder),this.lastOrder="XYZ",this.enabled=!1}update(){if(!this.enabled)return;const tt=this.deviceOrientation;if(tt){const s=tt.alpha!==null?et.M8C.degToRad(tt.alpha):0,o=tt.beta!==null?et.M8C.degToRad(tt.beta):0,a=tt.gamma!==null?et.M8C.degToRad(tt.gamma):0,_e=this.screenOrientation?et.M8C.degToRad(this.screenOrientation.angle):0;this.setObjectQuaternion(s,o,a,_e),8*(1-this.lastQuaternion.dot(this.object.quaternion))>1e-6&&(this.lastQuaternion.copy(this.object.quaternion),this.dispatchEvent(sF))}}dispose(){this.disconnect()}setObjectQuaternion(tt,s,o,a){const _e=bo()/1e3;j3.set(s,tt,-o,"YXZ"),IS.setFromEuler(j3),IS.multiply(iF),IS.multiply(nF.setFromAxisAngle(rF,-a)),this._initQuaternionDest.__init||(this._initQuaternionDest.copy(IS).invert(),this._initQuaternionDest.__init=!0),IS.premultiply(this._initQuaternionDest),this.object.quaternion.slerp(IS,this.dampingFactor/(Math.min(1,_e-this._lastTime)/(1/60))),this._lastTime=_e}};$3([Yr(),gs("Damping",[0,1],.01)],LT.prototype,"dampingFactor",void 0),LT=$3([Ao("Device Orientation Controls")],LT);class sD extends io{constructor(){super(...arguments),this.enabled=!0,this.toJSON=void 0,this._cameraChanged=s=>{var o,a,_e,rt;(a=(o=s.lastCamera)===null||o===void 0?void 0:o.removeControlsCtor)===null||a===void 0||a.call(o,this.controlsKey),(rt=(_e=s.camera)===null||_e===void 0?void 0:_e.setControlsCtor)===null||rt===void 0||rt.call(_e,this.controlsKey,this._controlsCtor)}}async onAdded(s){await super.onAdded(s),this._cameraChanged({camera:s.scene.activeCamera}),s.scene.addEventListener("activeCameraChange",this._cameraChanged)}async onRemove(s){return this._cameraChanged({lastCamera:s.scene.activeCamera}),s.scene.removeEventListener("activeCameraChange",this._cameraChanged),super.onRemove(s)}}class oD extends sD{constructor(){super(...arguments),this.controlsKey="deviceOrientation",this._controlsCtor=(s,o)=>new LT(s)}}oD.PluginType="DeviceOrientationControlsPlugin";var Em=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};const z3=new et.Pa4,aD=new et.$V,lD=new et.Pa4,oF={type:"change"};let Ep=class extends it{constructor(tt,s){super(),this.enabled=!0,this.enableKeys=!0,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.mouseDragOn=!1,this.autoSpeedFactor=0,this.mouseX=0,this.mouseY=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.moveUp=!1,this.moveDown=!1,this.viewHalfX=0,this.viewHalfY=0,this.lat=0,this.lon=0,this.targetPosition=new et.Pa4,this._lastTime=-1,this.object=tt,this.domElement=s,this.onMouseMove=this.onMouseMove.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("mousemove",this.onMouseMove),this.domElement.addEventListener("mousedown",this.onMouseDown),this.domElement.addEventListener("mouseup",this.onMouseUp),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),this.handleResize(),this.setOrientation()}setOrientation(){const tt=this.object.quaternion;z3.set(0,0,-1).applyQuaternion(tt),aD.setFromVector3(z3),this.lat=90-et.M8C.radToDeg(aD.phi),this.lon=et.M8C.radToDeg(aD.theta)}handleResize(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)}onMouseDown(tt){if(this.domElement!==document&&this.domElement.focus(),this.activeLook)switch(tt.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0}onMouseUp(tt){if(this.activeLook)switch(tt.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1}onMouseMove(tt){this.domElement===document?(this.mouseX=tt.pageX-this.viewHalfX,this.mouseY=tt.pageY-this.viewHalfY):(this.mouseX=tt.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=tt.pageY-this.domElement.offsetTop-this.viewHalfY)}onKeyDown(tt){if(this.enableKeys)switch(tt.code){case"ArrowUp":case"KeyW":this.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.moveRight=!0;break;case"KeyR":this.moveUp=!0;break;case"KeyF":this.moveDown=!0}}onKeyUp(tt){if(this.enableKeys)switch(tt.code){case"ArrowUp":case"KeyW":this.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.moveRight=!1;break;case"KeyR":this.moveUp=!1;break;case"KeyF":this.moveDown=!1}}lookAt(tt,s,o){return tt.isVector3?lD.copy(tt):s===void 0||o===void 0?console.error("FirstPersonControls2.lookAt: y and z parameters are required"):lD.set(tt,s,o),this.object.lookAt(lD),this.setOrientation(),this}update(){const tt=bo(),s=(this._lastTime<0?16:Math.min(tt-this._lastTime,1e3))/1e3;if(this._lastTime=tt,!this.enabled)return;if(this.heightSpeed){const ct=et.M8C.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=s*(ct*this.heightCoef)}else this.autoSpeedFactor=0;const o=s*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(o+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(o),this.moveLeft&&this.object.translateX(-o),this.moveRight&&this.object.translateX(o),this.moveUp&&this.object.translateY(o),this.moveDown&&this.object.translateY(-o);let a=s*this.lookSpeed;this.activeLook||(a=0);let _e=1;this.constrainVertical&&(_e=Math.PI/(this.verticalMax-this.verticalMin)),this.lon-=this.mouseX*a,this.lookVertical&&(this.lat-=this.mouseY*a*_e),this.lat=Math.max(-85,Math.min(85,this.lat));let rt=et.M8C.degToRad(90-this.lat);const nt=et.M8C.degToRad(this.lon);this.constrainVertical&&(rt=et.M8C.mapLinear(rt,0,Math.PI,this.verticalMin,this.verticalMax));const ot=this.object.position;this.targetPosition.setFromSphericalCoords(1,rt,nt).add(ot),this.object.lookAt(this.targetPosition),this.dispatchEvent(oF)}dispose(){this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("mousedown",this.onMouseDown),this.domElement.removeEventListener("mousemove",this.onMouseMove),this.domElement.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)}onContextMenu(tt){this.enableKeys&&tt.preventDefault()}};Em([Yr(),ds()],Ep.prototype,"enabled",void 0),Em([Yr(),ds()],Ep.prototype,"enableKeys",void 0),Em([Yr(),yo()],Ep.prototype,"movementSpeed",void 0),Em([Yr(),yo()],Ep.prototype,"lookSpeed",void 0),Em([Yr(),ds()],Ep.prototype,"lookVertical",void 0),Em([Yr(),ds()],Ep.prototype,"autoForward",void 0),Em([Yr(),ds()],Ep.prototype,"activeLook",void 0),Em([Yr(),ds()],Ep.prototype,"heightSpeed",void 0),Em([Yr(),yo()],Ep.prototype,"heightCoef",void 0),Em([Yr(),yo()],Ep.prototype,"heightMin",void 0),Em([Yr(),yo()],Ep.prototype,"heightMax",void 0),Em([Yr(),ds()],Ep.prototype,"constrainVertical",void 0),Em([Yr(),yo()],Ep.prototype,"verticalMin",void 0),Em([Yr(),yo()],Ep.prototype,"verticalMax",void 0),Em([Yr(),ds()],Ep.prototype,"mouseDragOn",void 0),Ep=Em([Ao("First Person Controls")],Ep);class uD extends sD{constructor(){super(...arguments),this.controlsKey="firstPerson",this._controlsCtor=(s,o)=>new Ep(s,o)}}uD.PluginType="FirstPersonControlsPlugin";var PS=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};const DS=new et.USm(0,0,0,"YXZ"),BS=new et.Pa4,aF={type:"change"},lF={type:"lock"},uF={type:"unlock"},V3=Math.PI/2;let yA=class extends it{constructor(tt,s){super(),this.isLocked=!1,this.enabled=!0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,this.autoLockOnClick=!0,this._movementX=0,this._movementY=0,this._forwardDirection=new et.Pa4(0,0,-1),this.domElement=s,this.object=tt,this.onElementClick=this.onElementClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onPointerlockChange=this.onPointerlockChange.bind(this),this.onPointerlockError=this.onPointerlockError.bind(this),this.connect()}onElementClick(tt){this.isLocked||this.autoLockOnClick&&(tt.preventDefault(),this.lock())}onMouseMove(tt){this.isLocked&&(this._movementX+=tt.movementX||tt.mozMovementX||tt.webkitMovementX||0,this._movementY+=tt.movementY||tt.mozMovementY||tt.webkitMovementY||0)}onPointerlockChange(){this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(lF),this.isLocked=!0):(this.dispatchEvent(uF),this.isLocked=!1)}onPointerlockError(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}connect(){this.domElement.ownerDocument.addEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.addEventListener("click",this.onElementClick)}disconnect(){this.domElement.ownerDocument.removeEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.removeEventListener("click",this.onElementClick)}dispose(){this.disconnect()}getDirection(tt){return tt.copy(this._forwardDirection).applyQuaternion(this.object.quaternion)}moveForward(tt){BS.setFromMatrixColumn(this.object.matrix,0),BS.crossVectors(this.object.up,BS),this.object.position.addScaledVector(BS,tt)}moveRight(tt){BS.setFromMatrixColumn(this.object.matrix,0),this.object.position.addScaledVector(BS,tt)}lock(){this.domElement.requestPointerLock()}unlock(){this.domElement.ownerDocument.exitPointerLock()}update(){DS.setFromQuaternion(this.object.quaternion),DS.y-=.002*this._movementX*this.pointerSpeed,DS.x-=.002*this._movementY*this.pointerSpeed,this._movementX=0,this._movementY=0,DS.x=Math.max(V3-this.maxPolarAngle,Math.min(V3-this.minPolarAngle,DS.x)),this.object.quaternion.setFromEuler(DS),this.dispatchEvent(aF)}};PS([ds(),Yr()],yA.prototype,"enabled",void 0),PS([yo(),Yr()],yA.prototype,"minPolarAngle",void 0),PS([yo(),Yr()],yA.prototype,"maxPolarAngle",void 0),PS([yo(),Yr()],yA.prototype,"pointerSpeed",void 0),PS([ds(),Yr()],yA.prototype,"autoLockOnClick",void 0),yA=PS([Ao("Pointer Lock Controls")],yA);class cD extends sD{constructor(){super(...arguments),this.controlsKey="pointerLock",this._controlsCtor=(s,o)=>new yA(s,o.ownerDocument?o:o.documentElement)}}cD.PluginType="PointerLockControlsPlugin";var cF=__webpackgi_require__(819);class M_{static _initialize(){this._inited=!0,Jv(Zt`
          #customContextMenu {
            background: #2c2c2e99;
            backdrop-filter: blur(8px);
            border: 0.5px solid rgba(20, 20, 20, 0.3);
            width: auto;
            height: auto;
            position: absolute;
            display: flex;
            flex-direction: column;
            z-index: 9999;
            padding: 0.35rem 0.20rem;
            border-radius: 0.375rem;
            min-width: 6rem;
            pointer-events: auto;
            box-shadow: 0px 2px 10px rgba(12, 12, 12, 0.2);
          }

          .customContextMenuItems {
            color: white;
            font-size: 0.65rem;
            font-family: "Roboto Mono", "Source Code Pro", Menlo, Courier, monospace;
            background-color: transparent;
            cursor: pointer;
            padding: 0.12rem 0.35rem;
            border-radius: 0.25rem;
            line-height: 1rem;
            font-weight: 500;
          }

          .customContextMenuItems:hover {
            color: white;
            background-color: #017AFF;
          }
        `),document.addEventListener("mouseup",s=>{this.Element&&!this.Element.contains(s.target)&&this.Remove()})}static Create(s,o,a){this._inited||this._initialize(),this.Element&&this.Remove();const _e=Ll({id:"customContextMenu",addToBody:!1});_e.style.top=a+"px",_e.style.left=o+"px";for(const[rt,nt]of Object.entries(s)){const ot=Ll({classList:["customContextMenuItems"],addToBody:!1,innerHTML:rt});_e.appendChild(ot),ot.onclick=nt}return this.Element=_e,_e}static Remove(){var s;(s=this.Element)===null||s===void 0||s.remove(),this.Element=void 0}}M_.Element=void 0,M_._inited=!1;var dF=__webpackgi_require__(665);const pF=(tt,s,o)=>{var a,_e,rt;const nt=tt.controller_,ot=(_e=(a=nt.parent)===null||a===void 0?void 0:a.children)===null||_e===void 0?void 0:_e.indexOf(nt);return!(((pt,ht)=>ht.controller_.rackController.rack===pt.controller_.parent)(tt,s)&&ot===o||(ot!==void 0&&ot>=0&&((rt=nt.parent)===null||rt===void 0||rt.remove(tt)),s.add(tt,o),0))},hF=(tt,s,o,a)=>{var _e,rt,nt,ot,ct;let pt=s.uiRef;const ht=pt==null?void 0:pt.expanded;if(pt||(pt=tt.addFolder({title:""}),pt.on("fold",Nt=>{var Bt,kt,Pt;let qt=pt.expanded;dr(s,"expanded",qt,!0),qt=(Bt=er(s.expanded))!==null&&Bt!==void 0?Bt:qt,qt!==pt.expanded&&(pt.expanded=qt),(kt=s.uiRefresh)===null||kt===void 0||kt.call(s,"postFrame",!0),qt&&((Pt=s.onExpand)===null||Pt===void 0||Pt.call(s,s))})),!pt)return pt;pt.expanded=(rt=(_e=er(s.expanded))!==null&&_e!==void 0?_e:ht)!==null&&rt!==void 0&&rt;const _t=((nt=s.children)!==null&&nt!==void 0?nt:[]).map(Nt=>Nt&&er(Nt)).flat(2).filter(Nt=>Nt);let Et=0;for(const Nt of _t){let Bt=Nt.uiRef;Bt&&Bt.controller_.viewProps.get("disposed")&&(Nt.uiRef=void 0),Bt=Nt.uiRef,Bt||(o.appendUiObject({uiConfig:Nt},pt),Bt=Nt.uiRef),Bt&&pF(Bt,pt,Et++)&&o.appendUiObject({uiConfig:Nt},pt)}let St=pt.children;for(;St.length>Et;){const Nt=St[St.length-1];pt.remove(Nt),St=pt.children}pt.controller_.props.set("title",(ot=er(s.label))!==null&&ot!==void 0?ot:"");const Mt=pt.controller_.view.containerElement,It=er(s.domChildren,[]);if((It==null?void 0:It.length)!==void 0){const Nt=[];for(let Bt=0;Bt<Mt.children.length;Bt++){const kt=Mt.children[Bt];!((ct=kt.dataset)===null||ct===void 0)&&ct.tpCustomDOM&&Nt.push(kt)}for(const Bt of Nt)Mt.removeChild(Bt);for(const Bt of It)Bt.parentElement!==Mt&&(Mt.appendChild(Bt),Bt.dataset.tpCustomDOM="true");pt.controller_.foldable.cleanUpTransition()}return pt},fF=(tt,s,o,a)=>{var _e,rt;const[nt,ot]=(_e=s.property)!==null&&_e!==void 0?_e:[void 0,void 0],ct=(rt=er(s.label))!==null&&rt!==void 0?rt:ot;let pt=s.uiRef;return pt||(pt=tt.addButton({title:""}),pt.on("click",async()=>{var ht;const _t=[];s.prompt&&_t.push(await o.prompt(...s.prompt));const Et=(ht=nt&&ot?nt[ot]:void 0)!==null&&ht!==void 0?ht:s.value;if(typeof Et=="function"){const St=()=>{o.removeEventListener("postFrame",St),Et(..._t)};o.addEventListener("postFrame",St)}else console.warn("Invalid action type for button")})),pt&&(pt.title=ct??"click me"),pt},mF=(tt,s,o,a)=>{var _e;const rt=Object.fromEntries(((_e=er(s.children))!==null&&_e!==void 0?_e:[]).map(nt=>er(nt)).flat(2).filter(nt=>nt).map(nt=>{var ot;const ct=er(nt.label);return[ct,(ot=nt.value)!==null&&ot!==void 0?ot:ct]}));return Py(tt,s,o,{options:rt,...a??{}})},gF=(tt,s,o,a)=>{var _e,rt;const nt=er(s.bounds),ot=((_e=nt==null?void 0:nt.length)!==null&&_e!==void 0?_e:0)>=2?nt[1]:1,ct=((rt=nt==null?void 0:nt.length)!==null&&rt!==void 0?rt:0)>=1?nt[0]:0,pt=s.stepSize||void 0;return Py(tt,s,o,{min:ct,max:ot,step:pt,...a??{}})},YI=(tt,s,o,a)=>{var _e,rt,nt;const ot=er(s.bounds);if(!ot||ot.length<1)return Py(tt,s,o,{...a??{}});const ct=((_e=ot.length)!==null&&_e!==void 0?_e:0)>=2?ot[1]:1,pt=((rt=ot.length)!==null&&rt!==void 0?rt:0)>=1?ot[0]:0,ht={min:pt,max:ct,step:(nt=s.stepSize)!==null&&nt!==void 0?nt:(ct-pt)/100},_t={x:ht,y:ht};s.type!=="vec3"&&s.type!=="vec4"||(_t.z=ht),s.type==="vec4"&&(_t.w=ht);const Et=s.property;if(s.value===void 0&&Et&&Et[0]&&typeof Et[0]=="object"&&Et[0][Et[1]]&&Array.isArray(Et[0][Et[1]])){const[St,Mt]=Et,It=St[Mt],Nt=It.length,Bt=new(Nt===2?et.FM8:Nt===3?et.Pa4:et.Ltg)().fromArray(It);s.value=Bt,s.property=void 0,s.onChange=[()=>{St[Mt]=Bt.toArray()},...Array.isArray(s.onChange)?s.onChange:[s.onChange]].filter(kt=>kt),s.label===void 0&&(s.label=Mt)}return Py(tt,s,o,{..._t,...a??{}})},vF=(tt,s,o,a)=>{var _e;const rt=s.property;if(s.value===void 0&&rt&&typeof rt[0]=="object"&&(!((_e=rt[0][rt[1]])===null||_e===void 0)&&_e.isColor)){const[nt,ot]=rt,ct=new ys().set(nt[ot]).convertSRGBToLinear();Object.defineProperty(s,"value",{get:()=>{const pt=nt[ot];return pt?ct.set(pt).convertLinearToSRGB().getHex():0},set:pt=>{const ht=nt[ot];ct.setHex(pt).convertSRGBToLinear(),ht.isColor?ht.copy(ct):typeof ht=="number"?nt[ot]=ct.getHex():typeof ht=="string"&&(nt[ot]="#"+ct.getHexString()),typeof(nt==null?void 0:nt.setDirty)=="function"&&nt.setDirty()}}),s.property=void 0,s.onChange=[...Array.isArray(s.onChange)?s.onChange:[s.onChange]].filter(pt=>pt),s.label===void 0&&(s.label=ot)}return(a=a??{}).view="color",er(s.inlinePicker)&&(a.picker="inline"),Py(tt,s,o,a)},Py=(tt,s,o,a)=>{var _e;let rt=er(s.property);if((s.getValue||s.setValue)&&rt&&console.error("specify either property or value, or getValue and setValue",s),rt)s.value&&console.warn("Both property and value are defined, value will be ignored",s);else if(s.value===void 0&&(s.getValue||s.setValue)&&(Object.defineProperty(s,"value",{get:()=>{var ct;return(ct=s.getValue)===null||ct===void 0?void 0:ct.call(s)},set:ct=>{var pt;return(pt=s.setValue)===null||pt===void 0?void 0:pt.call(s,ct)}}),rt=[s,"value"]),rt||s.value===void 0||(rt=[s,"value"]),!rt)return void console.error("cannot determine property",s);a=a??{};const nt={label:(_e=er(s.label))!==null&&_e!==void 0?_e:rt[1],...a};let ot=s.uiRef;if(!ot&&typeof rt[0]=="object"&&rt[0]){const[ct,pt]=rt;try{ot=s.isMonitor?tt.addMonitor(ct,pt,nt):tt.addInput(ct,pt,nt).on("change",ht=>{[s.onChange].flat().forEach(_t=>typeof _t=="function"&&(_t==null?void 0:_t(ht))),typeof(ct==null?void 0:ct.setDirty)=="function"&&ct.setDirty(ht)})}catch(ht){if(!ht.message.startsWith("No matching controller for"))throw ht;ot=void 0}}if(ot){for(const[ct,pt]of Object.entries(nt)){const ht=ot.controller_.props.value(ct);ht!==void 0&&ht.rawValue!==pt&&ot.controller_.props.set(ct,pt)}s.type==="slider"&&(nt.min!==void 0&&ot.controller_.valueController.sliderController.props.set("minValue",nt.min),nt.max!==void 0&&ot.controller_.valueController.sliderController.props.set("maxValue",nt.max)),ot.refresh()}return ot};class G3 extends it{constructor(s=!1,o=!1,a=!1,_e=!0,rt=document.body){super(),this._refreshQueue={preRender:[],postRender:[],preFrame:[],postFrame:[]},this._lastModeTime={preRender:0,postRender:0,preFrame:0,postFrame:0},this._typeGenerators={folder:hF,input:Py,slider:gF,dropdown:mF,checkbox:Py,color:vF,vec:YI,vec2:YI,vec3:YI,vec4:YI,button:fF,monitor:(ot,ct,pt,ht)=>(ct.isMonitor=!0,Py(ot,ct,pt,ht)),dummy:(ot,ct,pt,ht)=>Py(ot,ct,pt,ht)},this.alert=async ot=>alert(ot),this.confirm=async ot=>confirm(ot),this.prompt=async(ot,ct,pt=!0)=>prompt(ot,ct),this._expand=s,this._limitedOptions=a;const nt=this._createUiContainer();rt.appendChild(nt),this._pane=new dF.Pane({title:"Configuration",container:nt}),this._pane.expanded=this._expand,_e&&(this.addEventListener("postFrame",()=>this.refreshQueue("postFrame")),setTimeout(()=>{this.dispatchEvent({type:"postFrame"})},32))}refreshQueue(s){const o=this._refreshQueue[s],a=[],_e=bo(),rt=_e-this._lastModeTime[s];o.forEach(nt=>{nt[2]>.001?(nt[2]-=rt,a.push(nt)):this._refreshUiObject(nt[0],nt[1],nt[2])}),this._refreshQueue[s]=a,this._lastModeTime[s]=_e}addToRefreshQueue(s,o){var a;const _e=(a=o[0])===null||a===void 0?void 0:a.uiConfig,rt=_e==null?void 0:_e.uuid,nt=this._refreshQueue[s],ot=nt.find(ct=>ct[3]===rt);ot?ot[2]=Math.max(ot[2],o[2]):nt.push([...o,rt]),this._refreshQueue[s]=nt}dispose(){var s;(s=this._pane)===null||s===void 0||s.dispose(),this._pane=void 0}appendUiObject(s,o){s&&this._appendUiObject(s,o)}_appendUiObject(s,o){var a,_e,rt,nt;const{uiConfig:ot}=s??{};if(ot&&(!this._limitedOptions||ot.limitedUi)&&(o=o??this._pane,ot.type)){ot.uuid||(ot.uuid=Mo()),ot.uiRef&&ot.uiRefType!==ot.type&&(console.log("Removing UI object because of type mismatch",ot.uiRef),this.removeUiConfig(ot));const ct=(_e=(a=this._typeGenerators)[ot.type])===null||_e===void 0?void 0:_e.call(a,o,ot,this);ct&&(ct.hidden=(rt=er(ot.hidden))!==null&&rt!==void 0&&rt,ct.disabled=(nt=er(ot.disabled))!==null&&nt!==void 0&&nt),ot.uiRef=ct,ot.uiRefType=ct?ot.type:void 0,ot.uiRefresh=(pt="postFrame",ht=!1,_t=0)=>{var Et;return this._uiObjectRefresh(pt,(Et=s==null?void 0:s.uiConfig)!==null&&Et!==void 0?Et:ot,o,ht,_t)}}}removeUiObject(s){this.removeUiConfig(s==null?void 0:s.uiConfig)}removeUiConfig(s){var o,a;s&&s.uiRef&&((a=(o=s.uiRef).dispose)===null||a===void 0||a.call(o),s.uiRef=void 0,s.uiRefType=void 0,s.uiRefresh=void 0)}_uiObjectRefresh(s,o,a,_e,rt){(_e?dD(o,a):[{uiConfig:o,parentFolder:a}]).forEach(nt=>{const ot=[{uiConfig:nt.uiConfig},nt.parentFolder,rt];s==="immediate"?this._refreshUiObject(...ot):this.addToRefreshQueue(s,ot)})}_refreshUiObject(s,o,a=0){this._appendUiObject(s,o),a>1e-4&&console.error("no support for immediate delay")}_createUiContainer(){const s=Ll({id:"tweakpaneUiContainer",addToBody:!1});return Jv(Zt`
          :root{
            --tweakpane-ui-container-width: 300px;
          }
          @media only screen and (min-width: 1500px) {
            :root{
              --tweakpane-ui-container-width: 300px;
            }
          }
          @media only screen and (min-width: 2500px) {
            :root{
              --tweakpane-ui-container-width: 500px;
            }
          }
          #tweakpaneUiContainer {
            position: fixed;
            top: 0px;
            padding-right: 4px;
            padding-bottom: 10px;
            right: 10px;
            width: var(--tweakpane-ui-container-width);
            height: auto;
            overflow-y: scroll;
            z-index: 100;
            pointer-events: auto;
            max-height: calc(100% - 6rem);
            border-radius: 0.5rem;
            font-family: Inter, ui-sans-serif, system-ui, -apple-system, "system-ui", "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
          }
        `),s}}function dD(tt,s,o){var a;return o=o??[],tt&&(o.push({uiConfig:tt,parentFolder:s}),(a=tt.children)===null||a===void 0||a.forEach(_e=>o=dD(_e,tt.uiRef,o))),o}class pD{constructor(){pD.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(s,o,a,_e,rt,nt,ot,ct,pt){const ht=this.elements;return ht[0]=s,ht[1]=_e,ht[2]=ot,ht[3]=o,ht[4]=rt,ht[5]=ct,ht[6]=a,ht[7]=nt,ht[8]=pt,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(s){const o=this.elements,a=s.elements;return o[0]=a[0],o[1]=a[1],o[2]=a[2],o[3]=a[3],o[4]=a[4],o[5]=a[5],o[6]=a[6],o[7]=a[7],o[8]=a[8],this}extractBasis(s,o,a){return s.setFromMatrix3Column(this,0),o.setFromMatrix3Column(this,1),a.setFromMatrix3Column(this,2),this}setFromMatrix4(s){const o=s.elements;return this.set(o[0],o[4],o[8],o[1],o[5],o[9],o[2],o[6],o[10]),this}multiply(s){return this.multiplyMatrices(this,s)}premultiply(s){return this.multiplyMatrices(s,this)}multiplyMatrices(s,o){const a=s.elements,_e=o.elements,rt=this.elements,nt=a[0],ot=a[3],ct=a[6],pt=a[1],ht=a[4],_t=a[7],Et=a[2],St=a[5],Mt=a[8],It=_e[0],Nt=_e[3],Bt=_e[6],kt=_e[1],Pt=_e[4],qt=_e[7],Kt=_e[2],nr=_e[5],ir=_e[8];return rt[0]=nt*It+ot*kt+ct*Kt,rt[3]=nt*Nt+ot*Pt+ct*nr,rt[6]=nt*Bt+ot*qt+ct*ir,rt[1]=pt*It+ht*kt+_t*Kt,rt[4]=pt*Nt+ht*Pt+_t*nr,rt[7]=pt*Bt+ht*qt+_t*ir,rt[2]=Et*It+St*kt+Mt*Kt,rt[5]=Et*Nt+St*Pt+Mt*nr,rt[8]=Et*Bt+St*qt+Mt*ir,this}multiplyScalar(s){const o=this.elements;return o[0]*=s,o[3]*=s,o[6]*=s,o[1]*=s,o[4]*=s,o[7]*=s,o[2]*=s,o[5]*=s,o[8]*=s,this}determinant(){const s=this.elements,o=s[0],a=s[1],_e=s[2],rt=s[3],nt=s[4],ot=s[5],ct=s[6],pt=s[7],ht=s[8];return o*nt*ht-o*ot*pt-a*rt*ht+a*ot*ct+_e*rt*pt-_e*nt*ct}invert(){const s=this.elements,o=s[0],a=s[1],_e=s[2],rt=s[3],nt=s[4],ot=s[5],ct=s[6],pt=s[7],ht=s[8],_t=ht*nt-ot*pt,Et=ot*ct-ht*rt,St=pt*rt-nt*ct,Mt=o*_t+a*Et+_e*St;if(Mt===0)return this.set(0,0,0,0,0,0,0,0,0);const It=1/Mt;return s[0]=_t*It,s[1]=(_e*pt-ht*a)*It,s[2]=(ot*a-_e*nt)*It,s[3]=Et*It,s[4]=(ht*o-_e*ct)*It,s[5]=(_e*rt-ot*o)*It,s[6]=St*It,s[7]=(a*ct-pt*o)*It,s[8]=(nt*o-a*rt)*It,this}transpose(){let s;const o=this.elements;return s=o[1],o[1]=o[3],o[3]=s,s=o[2],o[2]=o[6],o[6]=s,s=o[5],o[5]=o[7],o[7]=s,this}getNormalMatrix(s){return this.setFromMatrix4(s).invert().transpose()}transposeIntoArray(s){const o=this.elements;return s[0]=o[0],s[1]=o[3],s[2]=o[6],s[3]=o[1],s[4]=o[4],s[5]=o[7],s[6]=o[2],s[7]=o[5],s[8]=o[8],this}setUvTransform(s,o,a,_e,rt,nt,ot){const ct=Math.cos(rt),pt=Math.sin(rt);return this.set(a*ct,a*pt,-a*(ct*nt+pt*ot)+nt+s,-_e*pt,_e*ct,-_e*(-pt*nt+ct*ot)+ot+o,0,0,1),this}scale(s,o){const a=this.elements;return a[0]*=s,a[3]*=s,a[6]*=s,a[1]*=o,a[4]*=o,a[7]*=o,this}rotate(s){const o=Math.cos(s),a=Math.sin(s),_e=this.elements,rt=_e[0],nt=_e[3],ot=_e[6],ct=_e[1],pt=_e[4],ht=_e[7];return _e[0]=o*rt+a*ct,_e[3]=o*nt+a*pt,_e[6]=o*ot+a*ht,_e[1]=-a*rt+o*ct,_e[4]=-a*nt+o*pt,_e[7]=-a*ot+o*ht,this}translate(s,o){const a=this.elements;return a[0]+=s*a[2],a[3]+=s*a[5],a[6]+=s*a[8],a[1]+=o*a[2],a[4]+=o*a[5],a[7]+=o*a[8],this}equals(s){const o=this.elements,a=s.elements;for(let _e=0;_e<9;_e++)if(o[_e]!==a[_e])return!1;return!0}fromArray(s,o=0){for(let a=0;a<9;a++)this.elements[a]=s[a+o];return this}toArray(s=[],o=0){const a=this.elements;return s[o]=a[0],s[o+1]=a[1],s[o+2]=a[2],s[o+3]=a[3],s[o+4]=a[4],s[o+5]=a[5],s[o+6]=a[6],s[o+7]=a[7],s[o+8]=a[8],s}clone(){return new this.constructor().fromArray(this.elements)}}function Q3(tt){return document.createElementNS("http://www.w3.org/1999/xhtml",tt)}let kS;class _F{constructor(s=null){this.isSource=!0,this.uuid=mn(),this.data=s,this.version=0}set needsUpdate(s){s===!0&&this.version++}toJSON(s){const o=s===void 0||typeof s=="string";if(!o&&s.images[this.uuid]!==void 0)return s.images[this.uuid];const a={uuid:this.uuid,url:""},_e=this.data;if(_e!==null){let rt;if(Array.isArray(_e)){rt=[];for(let nt=0,ot=_e.length;nt<ot;nt++)_e[nt].isDataTexture?rt.push(hD(_e[nt].image)):rt.push(hD(_e[nt]))}else rt=hD(_e);a.url=rt}return o||(s.images[this.uuid]=a),a}}function hD(tt){if(typeof HTMLImageElement<"u"&&tt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&tt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&tt instanceof ImageBitmap)return(class{static getDataURL(s,o=!1){if(/^data:/i.test(s.src)||typeof HTMLCanvasElement>"u")return s.src;let a;if(s instanceof HTMLCanvasElement)a=s;else{kS===void 0&&(kS=Q3("canvas")),kS.width=s.width,kS.height=s.height;const _e=kS.getContext("2d");s instanceof ImageData?_e.putImageData(s,0,0):_e.drawImage(s,0,0,s.width,s.height),a=kS}return!o&&(a.width>2048||a.height>2048)?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",s),a.toDataURL("image/jpeg",.6)):a.toDataURL("image/png")}static sRGBToLinear(s){if(typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap){const o=Q3("canvas");o.width=s.width,o.height=s.height;const a=o.getContext("2d");a.drawImage(s,0,0,s.width,s.height);const _e=a.getImageData(0,0,s.width,s.height),rt=_e.data;for(let nt=0;nt<rt.length;nt++)rt[nt]=255*co(rt[nt]/255);return a.putImageData(_e,0,0),o}if(s.data){const o=s.data.slice(0);for(let a=0;a<o.length;a++)o instanceof Uint8Array||o instanceof Uint8ClampedArray?o[a]=Math.floor(255*co(o[a]/255)):o[a]=co(o[a]);return{data:o,width:s.width,height:s.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),s}}).getDataURL(tt);if(tt.data){let s=[];try{s=Array.from(tt.data)}catch(o){o.message.includes("Invalid array length")?console.warn("Serializing large texture, might not be saved in JSON structure."):console.error(o),s=tt.data}return{data:s,width:tt.width,height:tt.height,type:tt.data.constructor.name}}return console.warn("THREE.Texture: Unable to serialize Texture."),{}}let yF=0;class OS extends class{addEventListener(s,o){this._listeners===void 0&&(this._listeners={});const a=this._listeners;a[s]===void 0&&(a[s]=[]),a[s].indexOf(o)===-1&&a[s].push(o)}hasEventListener(s,o){if(this._listeners===void 0)return!1;const a=this._listeners;return a[s]!==void 0&&a[s].indexOf(o)!==-1}removeEventListener(s,o){if(this._listeners===void 0)return;const a=this._listeners[s];if(a!==void 0){const _e=a.indexOf(o);_e!==-1&&a.splice(_e,1)}}dispatchEvent(s){if(this._listeners===void 0)return;const o=this._listeners[s.type];if(o!==void 0){s.target=this;const a=o.slice(0);for(let _e=0,rt=a.length;_e<rt;_e++)a[_e].call(this,s);s.target=null}}}{constructor(s=OS.DEFAULT_IMAGE,o=OS.DEFAULT_MAPPING,a=1001,_e=1001,rt=No,nt=1008,ot=1023,ct=1009,pt=1,ht=3e3){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:yF++}),this.uuid=mn(),this.name="",this.source=new _F(s),this.mipmaps=[],this.mapping=o,this.wrapS=a,this.wrapT=_e,this.magFilter=rt,this.minFilter=nt,this.anisotropy=pt,this.format=ot,this.internalFormat=null,this.type=ct,this.offset=new hn(0,0),this.repeat=new hn(1,1),this.center=new hn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new pD,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=ht,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(s){this.source.data=s}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(s){return this.name=s.name,this.source=s.source,this.mipmaps=s.mipmaps.slice(0),this.mapping=s.mapping,this.wrapS=s.wrapS,this.wrapT=s.wrapT,this.magFilter=s.magFilter,this.minFilter=s.minFilter,this.anisotropy=s.anisotropy,this.format=s.format,this.internalFormat=s.internalFormat,this.type=s.type,this.offset.copy(s.offset),this.repeat.copy(s.repeat),this.center.copy(s.center),this.rotation=s.rotation,this.matrixAutoUpdate=s.matrixAutoUpdate,this.matrix.copy(s.matrix),this.generateMipmaps=s.generateMipmaps,this.premultiplyAlpha=s.premultiplyAlpha,this.flipY=s.flipY,this.unpackAlignment=s.unpackAlignment,this.encoding=s.encoding,this.userData=JSON.parse(JSON.stringify(s.userData)),this.needsUpdate=!0,this}toJSON(s){const o=s===void 0||typeof s=="string";if(!o&&s.textures[this.uuid]!==void 0)return s.textures[this.uuid];const a={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(s).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return JSON.stringify(this.userData)!=="{}"&&(a.userData=this.userData),o||(s.textures[this.uuid]=a),a}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(s){if(this.mapping!==300)return s;if(s.applyMatrix3(this.matrix),s.x<0||s.x>1)switch(this.wrapS){case 1e3:s.x=s.x-Math.floor(s.x);break;case 1001:s.x=s.x<0?0:1;break;case 1002:Math.abs(Math.floor(s.x)%2)===1?s.x=Math.ceil(s.x)-s.x:s.x=s.x-Math.floor(s.x)}if(s.y<0||s.y>1)switch(this.wrapT){case 1e3:s.y=s.y-Math.floor(s.y);break;case 1001:s.y=s.y<0?0:1;break;case 1002:Math.abs(Math.floor(s.y)%2)===1?s.y=Math.ceil(s.y)-s.y:s.y=s.y-Math.floor(s.y)}return this.flipY&&(s.y=1-s.y),s}set needsUpdate(s){s===!0&&(this.version++,this.source.needsUpdate=!0)}}OS.DEFAULT_IMAGE=null,OS.DEFAULT_MAPPING=300;var KI=__webpackgi_require__(898),NT={};KI.Z&&KI.Z.locals&&(NT.locals=KI.Z.locals);var fD,mD=0,xx={};xx.styleTagTransform=GC(),xx.setAttributes=VC(),xx.insert=function(tt,s){(s.target||document.head).appendChild(tt)},xx.domAPI=DE(),xx.insertStyleElement=U1(),NT.use=function(tt){return xx.options=tt||{},mD++||(fD=zC()(KI.Z,xx)),NT},NT.unuse=function(){mD>0&&!--mD&&(fD(),fD=null)};var AF=NT;class gD extends G3{constructor(s=!1,o=!1,a=!1,_e=document.body){super(s,o,a,!1),this.dependencies=[os],this._preRender=()=>this.refreshQueue("preRender"),this._postRender=()=>this.refreshQueue("postRender"),this._postFrame=rt=>{this.dispatchEvent(rt),this.refreshQueue("postFrame")},this._preFrame=()=>this.refreshQueue("preFrame"),this._plugins=[],this.alert=async rt=>this._viewer?this._viewer.alert(rt):super.alert(rt),this.confirm=async rt=>this._viewer?this._viewer.confirm(rt):super.confirm(rt),this.prompt=async(rt,nt,ot=!0)=>this._viewer?this._viewer.prompt(rt,nt,ot):super.prompt(rt,nt,ot),this._pane.registerPlugin(cF),AF.use({target:_e})}async onAdded(s){this._viewer=s,this._typeGenerators.image=(o=>(a,_e,rt,nt)=>{const ot=_e.property,ct="placeholder";if(_e.value===void 0&&ot&&typeof ot[0]=="object"){const[pt,ht]=ot,_t=vT("Render Target"),Et=vT("Data Texture"),St=vT("CUBE Texture"),Mt=vT("Compressed Texture"),It={},Nt={};Object.defineProperty(_e,"value",{get:()=>{var Bt;let kt,Pt=pt[ht];if(Pt!=null&&Pt.get&&(Pt=Pt.get()),!Pt)return ct;if(Pt.isRenderTargetTexture&&!Pt.image.tp_src&&(Pt.image.tp_src=_t),Pt.isDataTexture&&!Pt.image.tp_src&&(Pt.image.tp_src=Et),Pt.isCompressedTexture&&!Pt.image.tp_src&&(Pt.image.tp_src=Mt),Pt.isTexture?(Pt.image&&(Pt.image instanceof ImageBitmap||Pt.image instanceof HTMLImageElement||Pt.image instanceof HTMLVideoElement)&&!Pt.image.tp_src&&(Pt.image.tp_src=k_(Pt.image,160)),Pt.image&&(kt=Pt.image.tp_src_uuid,kt=kt?It[kt]:void 0,kt||(kt=Pt.image.tp_src||Pt.image.src))):typeof Pt=="string"?kt=Pt:Pt.domainMin?(kt=Pt.texture,Pt.texture.image&&!Pt.texture.image.tp_src&&(Pt.texture.image.tp_src=St),Pt.texture.image&&(kt=Pt.texture.image.tp_src_uuid,kt=kt?It[kt]:void 0,kt||(kt=Pt.texture.image.tp_src||Pt.texture.image.src))):Pt&&console.error("unknown value",Pt),kt||(kt=ct),Pt.image&&!Pt.image.tp_src_uuid){const qt=Mo();Pt.image.tp_src_uuid=qt,Nt[kt]=qt}return typeof kt=="string"&&(kt=(Bt=It[kt])!==null&&Bt!==void 0?Bt:kt),kt},set:Bt=>{var kt,Pt,qt,Kt,nr,ir,fr,br,Tr,Dr,Rr;const Nr=pt[ht],Ir=Hr=>{var Lr;pt[ht]=Hr,Hr!=null&&Hr.isTexture&&(Hr.flipY=Hr.isDataTexture?Hr.flipY:(Lr=Nr==null?void 0:Nr.flipY)===null||Lr===void 0||Lr)};if(typeof Bt=="string")return void(typeof Nr=="string"&&Ir(Bt));if(!Bt)return void(_e.value=ct);if(Bt.isPlaceholder)return void(Nr&&(Ir(typeof Nr=="string"?"":null),typeof(pt==null?void 0:pt.setDirty)=="function"&&pt.setDirty()));let kr=Bt.tp_src_uuid;if(kr||(kr=(kt=Bt.src)!==null&&kt!==void 0?kt:Bt.tp_src,kr=(Pt=Nt[kr])!==null&&Pt!==void 0?Pt:kr,delete Nt[kr],Bt.tp_src_uuid=kr),kr&&(It[kr]=Bt),typeof Nr!="string"){if(!((Nr==null?void 0:Nr.image)===Bt||((qt=Nr==null?void 0:Nr.image)===null||qt===void 0?void 0:qt.src)===Bt.src||((Kt=Nr==null?void 0:Nr.image)===null||Kt===void 0?void 0:Kt.tp_src)===Bt.tp_src&&Bt.tp_src!=null||((nr=Nr==null?void 0:Nr.image)===null||nr===void 0?void 0:nr.tp_src)===Bt.src&&Bt.src!=null||((ir=Nr==null?void 0:Nr.image)===null||ir===void 0?void 0:ir.src)===Bt.tp_src&&Bt.tp_src!=null))if(Bt instanceof File){const Hr=o==null?void 0:o.getPlugin(os);if(!Hr)throw"Viewer or AssetManagerPlugin not found";(fr=Hr.importer)===null||fr===void 0||fr.importSingle({file:Bt,path:Bt.src}).then(Lr=>{var en,vn,wn,pn;if(Lr){Lr.isDataTexture&&(Lr.needsUpdate=!0);const Fn=(wn=(vn=(en=Bt.src)===null||en===void 0?void 0:en.split("?"))===null||vn===void 0?void 0:vn[0])===null||wn===void 0?void 0:wn.split(".").pop();Lr.userData&&(Lr.userData.mimeType||(Lr.userData.mimeType="image/"+(["jpg","jpeg"].includes(Fn)?"jpeg":"png"))),Ir(Lr),[_e.onChange].flat().forEach(Gn=>typeof Gn=="function"&&(Gn==null?void 0:Gn())),typeof(pt==null?void 0:pt.setDirty)=="function"&&pt.setDirty(),(pn=_e.uiRefresh)===null||pn===void 0||pn.call(_e,"postFrame",!1)}})}else{const Hr=new OS(Bt);Hr.assetType="texture",Hr.needsUpdate=!0;const Lr=(Dr=(Tr=(br=Bt.src)===null||br===void 0?void 0:br.split("?"))===null||Tr===void 0?void 0:Tr[0])===null||Dr===void 0?void 0:Dr.split(".").pop();Hr.userData.mimeType||(Hr.userData.mimeType="image/"+(["jpg","jpeg"].includes(Lr)?"jpeg":"png")),Ir(Hr);const en=["normalMap","aoMap","emissiveMap","roughnessMap","metalnessMap","displacementMap","bumpMap","alphaMap"].includes(ht);Hr.encoding=en?et.rnI:et.knz,Hr.wrapS=et.rpg,Hr.wrapT=et.rpg,[_e.onChange].flat().forEach(vn=>typeof vn=="function"&&(vn==null?void 0:vn())),typeof(pt==null?void 0:pt.setDirty)=="function"&&pt.setDirty(),(Rr=_e.uiRefresh)===null||Rr===void 0||Rr.call(_e,"postFrame",!1)}}else Ir(kr)}}),_e.property=void 0,_e.label===void 0&&(_e.label=ht)}return(nt=nt??{}).extensions=[".jpg",".png",".svg",".hdr",".exr",".jpeg",".bmp",".gif",".webp",".cube"],nt.imageFit===void 0&&(nt.imageFit="contain"),nt.clickCallback===void 0&&(nt.clickCallback=(pt,ht)=>{var _t;const Et=pt==null?void 0:pt.target,St=Et==null?void 0:Et.getBoundingClientRect();if(!St)return void ht.click();const Mt=_e.uiRef.controller_.valueController.value.rawValue,It=Mt===ct||Mt!=null&&Mt.isPlaceholder?{}:{"remove image":()=>{var Bt;_e.uiRef.controller_.valueController.value.setRawValue("");const[kt,Pt]=ot||[_e,"value"],qt=typeof kt[Pt]=="string";kt[Pt]=qt?"":null,[_e.onChange].flat().forEach(Kt=>typeof Kt=="function"&&(Kt==null?void 0:Kt())),typeof(kt==null?void 0:kt.setDirty)=="function"&&kt.setDirty(),(Bt=_e.uiRefresh)===null||Bt===void 0||Bt.call(_e,"postFrame",!1),M_.Remove()},"download image":()=>{var Bt,kt,Pt;const[qt,Kt]=ot||[_e,"value"];let nr=(kt=(Bt=qt[Kt])===null||Bt===void 0?void 0:Bt.image)!==null&&kt!==void 0?kt:_e.uiRef.controller_.valueController.value.rawValue;nr&&(nr instanceof ImageBitmap||nr instanceof HTMLImageElement||nr instanceof HTMLVideoElement)&&!nr.src&&(nr=k_(nr));const ir=document.createElement("a");document.body.appendChild(ir),ir.style.display="none",ir.href=(Pt=nr==null?void 0:nr.src)!==null&&Pt!==void 0?Pt:nr,ir.download="image.png",ir.click(),document.body.removeChild(ir),M_.Remove()}},Nt=M_.Create({...It,"set/replace image":()=>{ht.click(),M_.Remove()},"from url":async()=>{var Bt,kt;let Pt="";if(Pt&&(Pt.startsWith("http")||Pt.startsWith("data:image"))||(Pt=""),Pt=await rt.prompt("Load texture: Enter Image/Texture URL",Pt,!0),!Pt||!Pt.startsWith("http")&&!Pt.startsWith("data:image"))return Pt!==null&&await rt.alert("Loading Image: Invalid URL"),void M_.Remove();const[qt,Kt]=ot||[_e,"value"],nr=qt[Kt];if(typeof nr=="string")qt[Kt]=Pt,[_e.onChange].flat().forEach(ir=>typeof ir=="function"&&(ir==null?void 0:ir())),typeof(qt==null?void 0:qt.setDirty)=="function"&&qt.setDirty(),(Bt=_e.uiRefresh)===null||Bt===void 0||Bt.call(_e,"postFrame",!1);else{const ir=o==null?void 0:o.getPlugin(os);if(!ir)throw"Viewer or AssetManagerPlugin not found";(kt=ir.importer)===null||kt===void 0||kt.importSinglePath(Pt).then(fr=>{var br;if(fr){fr.isDataTexture?fr.needsUpdate=!0:fr&&(nr==null?void 0:nr.flipY)!==void 0&&(fr.flipY=nr.flipY),qt[Kt]=fr;const Tr=["normalMap","aoMap","emissiveMap","roughnessMap","metalnessMap","displacementMap","bumpMap","alphaMap"].includes(Kt);fr.encoding=Tr?et.rnI:et.knz,[_e.onChange].flat().forEach(Dr=>typeof Dr=="function"&&(Dr==null?void 0:Dr())),typeof(qt==null?void 0:qt.setDirty)=="function"&&qt.setDirty(),(br=_e.uiRefresh)===null||br===void 0||br.call(_e,"postFrame",!1)}})}M_.Remove()},cancel:()=>{M_.Remove()}},2,St.height+8);(_t=Et.parentElement)===null||_t===void 0||_t.appendChild(Nt),St.y>.7*document.body.clientHeight&&(Nt.style.top="auto",Nt.style.bottom=St.height+8+"px")}),nt.view="input-image",Py(a,_e,rt,nt)})(this._viewer),s.addEventListener("preRender",this._preRender),s.addEventListener("postRender",this._postRender),s.addEventListener("preFrame",this._preFrame),s.addEventListener("postFrame",this._postFrame)}async onDispose(s){this.dispose()}async onRemove(s){this._viewer=void 0,s.removeEventListener("preRender",this._preRender),s.removeEventListener("postRender",this._postRender),s.removeEventListener("preFrame",this._preFrame),s.removeEventListener("postFrame",this._postFrame),this.dispose()}setupPluginUi(s){var o;const a=(o=this._viewer)===null||o===void 0?void 0:o.getPlugin(s);if(!a)return void console.warn("plugin not found:",s);this._plugins.push(a),a.uiConfig&&(a.uiConfig.limitedUi=!0),a.uiConfig&&a.uiConfig.hidden===void 0&&(a.uiConfig.hidden=!1),this._appendUiObject(a);const _e=a.uiConfig;if(_e!=null&&_e.uiRef&&a.toJSON){const rt=_e.uiRef.controller_.view.element,nt=Ll({innerHTML:"&#8942;",classList:["pluginOptionsButton"],elementTag:"button"});nt.onclick=ot=>{const ct={};typeof a.toJSON=="function"&&(ct["download preset"]=async()=>{var ht,_t;const Et=(_t=(ht=this._viewer)===null||ht===void 0?void 0:ht.getPlugin(os))===null||_t===void 0?void 0:_t.exportPluginPreset(a);await Nu(new Blob([JSON.stringify(Et,null,2)],{type:"application/json"}),"preset."+a.constructor.PluginType+".json"),M_.Remove()}),typeof a.fromJSON=="function"&&(ct["upload preset"]=async()=>{var ht,_t;M_.Remove();const Et=await B_(!1,!1);if(Et.length===0)return;const St=Et[0],Mt=await St.text(),It=JSON.parse(Mt);await((_t=(ht=this._viewer)===null||ht===void 0?void 0:ht.getPlugin(os))===null||_t===void 0?void 0:_t.importPluginPreset(It,a))});const pt=M_.Create(ct,rt.clientWidth-120,12);rt.append(pt),ot.preventDefault()},rt.appendChild(nt)}return _e}setupPlugins(...s){s.forEach(o=>this.setupPluginUi(o))}refreshPluginsEnabled(){this._plugins.forEach(s=>{var o;const a=s.uiConfig;a&&(er(a.hidden)!==!0?(o=a.uiRefresh)===null||o===void 0||o.call(a,"postFrame",!0):a.uiRef&&(a.uiRef.hidden=!0))})}}gD.PluginType="TweakpaneUi";class XI extends io{constructor(){super(...arguments),this.enabled=!0,this.toJSON=void 0,this.bgUIConfig={label:"Color",type:"color",inlinePicker:!0,onChange:()=>{if(!this._viewer)return;const s=new ys(this.bgUIConfig.value||16777215).convertSRGBToLinear();this._viewer.setBackground(s.getHex())},expanded:!0,limitedUi:!0},this.uiConfig={label:"Background / Environment",type:"folder",expanded:!1,limitedUi:!0,children:[this.bgUIConfig,{label:"Image",property:[this,"sceneBackground"],type:"image",limitedUi:!0},{label:"EnvMap BG",type:"checkbox",property:[this,"envmapBg"]},()=>({type:"slider",label:"BG Intensity",property:[this._viewer,"backgroundIntensity"],bounds:[0,16]}),{label:"Set Transparent BG",type:"button",hidden:()=>!this._viewer||this._viewer.useRgbm,value:()=>{var s;(s=this._viewer)===null||s===void 0||s.setBackground(null)}},{label:"Environment",property:[this,"sceneEnvironment"],type:"image",limitedUi:!0},{type:"slider",label:"Env Rotation",property:[this,"sceneEnvironmentRotation"],bounds:[0,2*Math.PI],limitedUi:!0},{type:"slider",label:"Env Intensity",property:[this,"sceneEnvironmentIntensity"],bounds:[0,4],limitedUi:!0}]}}get sceneBackground(){var s;const o=(s=this._viewer)===null||s===void 0?void 0:s.getBackground();return o&&(o.isTexture||o.assetType==="texture")?o:null}set sceneBackground(s){var o,a;s?(o=this._viewer)===null||o===void 0||o.setBackground(s):(a=this._viewer)===null||a===void 0||a.setBackground(this.bgUIConfig.value)}get sceneEnvironment(){var s;return(s=this._viewer)===null||s===void 0?void 0:s.scene.getEnvironment()}set sceneEnvironment(s){var o;(o=this._viewer)===null||o===void 0||o.scene.setEnvironment(s)}get sceneEnvironmentRotation(){var s,o,a;return(a=(o=(s=this._viewer)===null||s===void 0?void 0:s.scene.getEnvironment())===null||o===void 0?void 0:o.rotation)!==null&&a!==void 0?a:0}set sceneEnvironmentRotation(s){var o,a;const _e=(o=this._viewer)===null||o===void 0?void 0:o.scene.getEnvironment();_e&&(_e.rotation=s,(a=this._viewer)===null||a===void 0||a.scene.setDirty())}get sceneEnvironmentIntensity(){var s,o;return(o=(s=this._viewer)===null||s===void 0?void 0:s.scene.envMapIntensity)!==null&&o!==void 0?o:1}set sceneEnvironmentIntensity(s){var o;!((o=this._viewer)===null||o===void 0)&&o.scene&&(this._viewer.scene.envMapIntensity=s)}get envmapBg(){var s;return((s=this._viewer)===null||s===void 0?void 0:s.getBackground(!0))===Rv}set envmapBg(s){if(this._viewer)if(s){const o=this._viewer.getBackground(!0);o&&o!==Rv&&(this.lastBgVal=o),this._viewer.setBackground(Rv)}else this._viewer.getBackground()===this._viewer.scene.getEnvironment()&&this._viewer.setBackground(this.lastBgVal||this.bgUIConfig.value)}async onAdded(s){var o;await super.onAdded(s);const a=s.getBackground();this.bgUIConfig.value=typeof a=="string"&&a!==Rv||typeof a=="number"||!((o=a)===null||o===void 0)&&o.isColor?"#"+new ys(a).getHexString():"#000000",this.lastBgVal=a}}XI.PluginType="SimpleBackgroundEnvUiPlugin1";class JI extends io{constructor(){super(),this.enabled=!0,this.toJSON=void 0,this._uiConfig={type:"folder",label:"Scene Objects",children:[],onExpand:()=>{var s,o;(o=(s=this._uiConfig).uiRefresh)===null||o===void 0||o.call(s,"postFrame",!0)}},this._clearSceneButton={type:"button",label:"Clear Scene",value:()=>{var s;(s=this._viewer)===null||s===void 0||s.scene.disposeSceneModels()}},this._sceneUpdate=this._sceneUpdate.bind(this)}async onAdded(s){await super.onAdded(s),s.scene.addEventListener("sceneUpdate",this._sceneUpdate)}async onRemove(s){return s.scene.removeEventListener("sceneUpdate",this._sceneUpdate),super.onRemove(s)}setDirty(){var s;(s=this._viewer)===null||s===void 0||s.setDirty()}get uiConfig(){var s,o,a;return this._viewer?(this._uiConfig.children=[this._clearSceneButton],this._uiConfig.children.push(...(a=(o=(s=this._viewer)===null||s===void 0?void 0:s.scene.modelRoot.modelObject.children)===null||o===void 0?void 0:o.map(_e=>_e.assetType==="light"?null:_e.uiConfig).filter(_e=>_e!=null))!==null&&a!==void 0?a:[]),this._uiConfig):this._uiConfig}_sceneUpdate(){var s,o;(o=(s=this._uiConfig)===null||s===void 0?void 0:s.uiRefresh)===null||o===void 0||o.call(s,"postFrame",!0)}}JI.PluginType="SimpleUi";var bF=__webpackgi_require__(1),wF=__webpackgi_require__.n(bF)();class ZI extends io{constructor(s=!0){super(),this.enabled=!0,this.toJSON=void 0,this.treeView=void 0,this.hierarchyDiv=Ll({innerHTML:"",id:"tpHierarchyContainer",addToBody:!1}),this._uiConfig={type:"folder",label:"Hierarchy",children:[]},this._buildData=(o,a)=>(o.push({text:a.name||"unnamed",id:a.uuid,children:a.children.reduce(this._buildData,[])}),o),this._findVisible=(o,a)=>(a.visible&&(a.children.length<1?o.push(a.uuid):o.push(...a.children.reduce(this._findVisible,[]))),o),this._setVisible=o=>{var a,_e,rt;const nt=(a=this._viewer)===null||a===void 0?void 0:a.scene.modelRoot;if(!nt||o==null)return;const ot=new Set;nt.traverse(ct=>{ct!==nt&&(ct.visible=o.includes(ct.uuid),ct.visible&&ct.traverseAncestors(pt=>ot.add(pt)))}),ot.forEach(ct=>ct.visible=!0),(rt=(_e=this._viewer)===null||_e===void 0?void 0:_e.scene)===null||rt===void 0||rt.setDirty({sceneUpdate:!0,fromHierarchyPlugin:!0,updateGround:!1})},this.enabled=s,this.reset=this.reset.bind(this),Jv(Zt`
#tpHierarchyContainer{
  width: 100%;
  height: auto;
  background-color: transparent;
  color: #e9e9ed;
  margin-top: 0;
}
`)}reset(s){var o;if(s!=null&&s.fromHierarchyPlugin||!(s!=null&&s.hierarchyChanged))return;for(;this.hierarchyDiv.firstChild;)this.hierarchyDiv.firstChild.remove();const a=(o=this._viewer)===null||o===void 0?void 0:o.scene.modelRoot;if(!a)return;const _e=a.children.reduce(this._buildData,[]),rt=a.children.reduce(this._findVisible,[]);let nt=!1;return new Promise((ot,ct)=>{this.treeView=new wF(this.hierarchyDiv,{closeDepth:1,data:_e,loaded:function(){this.values=rt,ot()},onChange:()=>{nt?mu(200).then(()=>{this.treeView&&this._setVisible(this.treeView.values)}):nt=!0},onItemLabelClick:pt=>{var ht;const _t=(ht=this._viewer)===null||ht===void 0?void 0:ht.scene.modelRoot.modelObject.getObjectByProperty("uuid",pt);_t&&a.visible&&_t.dispatchEvent({type:"select",value:_t,ui:!0})}})})}async onAdded(s){await super.onAdded(s),this.reset(),s.scene.addEventListener("sceneUpdate",this.reset)}async onRemove(s){return s.scene.removeEventListener("sceneUpdate",this.reset),super.onRemove(s)}async onDispose(s){return super.onDispose(s)}get uiConfig(){return this._uiConfig.domChildren||(this._uiConfig.domChildren=[this.hierarchyDiv]),this._uiConfig}}ZI.PluginType="HierarchyUiPlugin";class eP extends io{constructor(){super(),this.toJSON=void 0,this.enabled=!0,this.uiConfig={type:"folder",label:"Lights",children:[{type:"button",label:"Add Directional Light",value:()=>{if(!this._viewer)return;const s=new c_;s.position.set(0,0,0),s.target.position.set(0,0,-1).normalize(),s.intensity=2,s.shadow.mapSize.set(1024,1024),this._viewer.scene.addLight(s)}}],limitedUi:!0},this.dependencies=[os],this._sceneUpdate=s=>{var o,a,_e;if(!s.hierarchyChanged)return;const rt=[];(o=this._viewer)===null||o===void 0||o.traverseSceneObjects(nt=>{if(!nt.lightObject)return;const ot=nt.uiConfig;ot&&!rt.includes(ot)&&rt.push(ot)}),[...this.uiConfig.children].forEach(nt=>{var ot;((ot=nt)===null||ot===void 0?void 0:ot.type)==="button"||rt.includes(nt)||this.uiConfig.children.splice(this.uiConfig.children.indexOf(nt),1)}),rt.forEach(nt=>{this.uiConfig.children.includes(nt)||this.uiConfig.children.push(nt)}),(_e=(a=this.uiConfig).uiRefresh)===null||_e===void 0||_e.call(a,"postFrame",!0)}}async onAdded(s){await super.onAdded(s),s.scene.addEventListener("sceneUpdate",this._sceneUpdate)}async onRemove(s){return s.scene.removeEventListener("sceneUpdate",this._sceneUpdate),super.onRemove(s)}}eP.PluginType="SimpleLightsUi";class tP extends io{constructor(){super(),this.toJSON=void 0,this.enabled=!0,this.uiConfig={type:"folder",label:"Cameras (Loaded)",children:[{type:"button",label:"Add Camera",hidden:!0}],limitedUi:!0},this.dependencies=[os],this._sceneUpdate=s=>{var o,a,_e;if(!s.hierarchyChanged)return;const rt=[];(o=this._viewer)===null||o===void 0||o.traverseSceneObjects(nt=>{if(!nt.cameraObject)return;const ot=nt.uiConfig;ot&&!rt.includes(ot)&&rt.push(ot)}),[...this.uiConfig.children].forEach(nt=>{var ot;((ot=nt)===null||ot===void 0?void 0:ot.type)==="button"||rt.includes(nt)||this.uiConfig.children.splice(this.uiConfig.children.indexOf(nt),1)}),rt.forEach(nt=>{this.uiConfig.children.includes(nt)||this.uiConfig.children.push(nt)}),(_e=(a=this.uiConfig).uiRefresh)===null||_e===void 0||_e.call(a,"postFrame",!0)}}async onAdded(s){await super.onAdded(s),s.scene.addEventListener("sceneUpdate",this._sceneUpdate)}async onRemove(s){return s.scene.removeEventListener("sceneUpdate",this._sceneUpdate),super.onRemove(s)}}tP.PluginType="SimpleSceneCamerasUi";var FT,rP=function(tt,s,o,a){var _e,rt=arguments.length,nt=rt<3?s:a===null?a=Object.getOwnPropertyDescriptor(s,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")nt=Reflect.decorate(tt,s,o,a);else for(var ot=tt.length-1;ot>=0;ot--)(_e=tt[ot])&&(nt=(rt<3?_e(nt):rt>3?_e(s,o,nt):_e(s,o))||nt);return rt>3&&nt&&Object.defineProperty(s,o,nt),nt};let AA=FT=class extends io{constructor(){super(),this.enabled=!0,this.width=0,this.height=0,this.scale=1,this._sizeChanged=this._sizeChanged.bind(this),this._refresh=this._refresh.bind(this)}refreshSize(){this._sizeChanged()}_sizeChanged(){var tt;if(!this._viewer)return;const s={width:Math.round(this.width),height:Math.round(this.height)},o=this._viewer.container.getBoundingClientRect();s.width>=o.width&&delete s.width,s.height>=o.height&&delete s.height,(tt=this._viewer)===null||tt===void 0||tt.setSize(s),this._viewer.renderer.displayCanvasScaling=this.scale}async onAdded(tt){await super.onAdded(tt);const s=tt.canvas.clientWidth,o=tt.canvas.clientHeight,a=tt.renderer.displayCanvasScaling;this.width=s,this.height=o,this.scale=a,tt.renderer.addEventListener("resize",this._refresh),this.addEventListener("deserialize",this._sizeChanged),this._refresh()}async onRemove(tt){return this.removeEventListener("deserialize",this._sizeChanged),tt.renderer.removeEventListener("resize",this._refresh),super.onRemove(tt)}_refresh(){var tt,s;(s=(tt=this.uiConfig)===null||tt===void 0?void 0:tt.uiRefresh)===null||s===void 0||s.call(tt,"postFrame",!0)}};AA.PluginType="RendererParamsUiPlugin",rP([Yr(),vr(FT.prototype._sizeChanged),gs("Width",void 0,1,tt=>({bounds:()=>{var s;return[10,((s=tt._viewer)===null||s===void 0?void 0:s.container.getBoundingClientRect().width)||1024]}}))],AA.prototype,"width",void 0),rP([Yr(),vr(FT.prototype._sizeChanged),gs("Height",void 0,1,tt=>({bounds:()=>{var s;return[10,((s=tt._viewer)===null||s===void 0?void 0:s.container.getBoundingClientRect().height)||1024]}}))],AA.prototype,"height",void 0),rP([Yr(),vr(FT.prototype._sizeChanged),gs("Scale",[.25,4],.25,{limitedUi:!0})],AA.prototype,"scale",void 0),AA=FT=rP([Ao("Renderer")],AA);class nP extends io{constructor(){super(),this.enabled=!0,this.serializeWithViewer=!1,this._refresh=this._refresh.bind(this)}async onAdded(s){await super.onAdded(s),s.scene.addEventListener("activeCameraChange",this._refresh),s.scene.addEventListener("sceneUpdate",this._refresh)}async onRemove(s){return s.scene.removeEventListener("activeCameraChange",this._refresh),s.scene.removeEventListener("sceneUpdate",this._refresh),super.onRemove(s)}toJSON(s){var o;const a=super.toJSON(s);return a.activeCamera=(o=this._viewer)===null||o===void 0?void 0:o.scene.activeCamera.toJSON(),a}fromJSON(s,o){var a;return s.activeCamera&&((a=this._viewer)===null||a===void 0||a.scene.activeCamera.fromJSON(s.activeCamera),delete(s={...s}).activeCamera),super.fromJSON(s,o)}_refresh(){var s,o;this._viewer&&((o=(s=this.uiConfig).uiRefresh)===null||o===void 0||o.call(s,"postFrame",!0))}get uiConfig(){var s;return((s=this._viewer)===null||s===void 0?void 0:s.scene.activeCamera.uiConfig)||{}}}nP.PluginType="CameraUiPlugin";var xF={create:tt=>{let s="button"+(tt.type?" "+tt.type:""),o=Ks.createDiv(s,tt.text);return o.addEventListener("click",tt.onClick),o}};let Qm={createElement:(tt,s,o,a)=>{let _e=document.createElement(tt);if(s&&(_e.className=s),o&&(_e.innerHTML=o),a)for(let rt in a)_e.setAttribute(rt,a[rt]);return _e},createDiv:(tt,s,o)=>Qm.createElement("div",tt,s,o),createDomTree:tt=>{if(!tt||!tt.hasOwnProperty("dom"))return tt;let s=tt.dom;if(tt.children)for(let o in tt.children)tt.children[o]&&s.appendChild(Qm.createDomTree(tt.children[o]));return s},removeElement:tt=>{tt!=null&&tt.parentNode.removeChild(tt)},appendToBody:tt=>{document.body.appendChild(tt)},makeIconHTML:tt=>{let s="";return tt=="ok"&&(s="#tick"),tt=="error"&&(s="#cancel"),tt=="info"&&(s="#info-button"),tt=="caution"&&(s="#danger"),tt=="min"&&(s="#line"),tt=="close"&&(s="#close"),`<svg class="icon ${tt}"><use xlink:href="${s}" /></svg>`},makeNftContent:tt=>{let s=null;if(tt.type){let o=null;o=typeof tt.content=="string"?Qm.createDiv("inner-content",tt.content):Qm.createDomTree({dom:Qm.createDiv("inner-content"),children:[tt.content]}),s=tt.type=="text"?Qm.createDomTree({dom:Qm.createDiv("content text"),children:[o]}):Qm.createDomTree({dom:Qm.createDiv("content"),children:[Qm.createDiv("state",Qm.makeIconHTML(tt.type)),o]})}else typeof tt.content=="string"&&(s=Qm.createDiv("content",tt.content));return s},standardizeButtons:(tt,s)=>{let o=[];if(s.buttons===void 0)return s.type!="caution"&&s.type!="info"||o.push({key:27,text:"Cancel",onClick:tt.close.bind(tt,"cancel")}),o.push({key:13,text:"OK",type:"main",onClick:tt.close.bind(tt,"ok")}),o;o=s.buttons,o.constructor!==Array&&(o=[o]);for(let a in o)!o[a].onClick&&(o[a].onClick=tt.close.bind(tt,o[a].id));return o},makeButtons:tt=>{let s=[];if(tt)for(let o in tt)s.push(xF.create({text:tt[o].text?tt[o].text:"OK",type:tt[o].normal?null:"main",onClick:tt[o].onClick}));return Qm.createDomTree({dom:Qm.createDiv("button-wrapper"),children:s})},bindButtonKeyEvents:tt=>{let s=o=>{for(let a in tt)if(tt[a].key===o.keyCode)return void tt[a].onClick()};return window.addEventListener("keydown",s),s},unbindButtonKeyEvents:tt=>{window.removeEventListener("keydown",tt)}};var Ks=Qm,Zu=__webpackgi_require__(476),_h={"wwise-overlay-in-1":{opacity:"0"},"wwise-overlay-in-2":{opacity:"1"},"wwise-overlay-out-1":{opacity:"0"},"wwise-pop-in-1":{transform:"scale(0.5, 0.5)","margin-top":"50px",opacity:".5"},"wwise-pop-in-2":{transform:"scale(1, 1)","margin-top":"0",opacity:"1"},"wwise-pop-in-3":{transform:"scale(1.05, 1.05)"},"wwise-pop-in-4":{transform:"scale(1, 1)"},"wwise-pop-out-1":{transform:"scale(0.25, 0.25)","margin-top":"50px",opacity:"0"},"wwise-flip-in-1":{transform:"rotateX(60deg) scaleX(.5)",opacity:".2"},"wwise-flip-in-2":{transform:"none",opacity:"1"},"wwise-flip-out-1":{transform:"rotateX(60deg) scaleX(.5)",opacity:"0"},"wwise-top-in-1":{transform:"translateY(-30vh)",opacity:".5"},"wwise-top-in-2":{transform:"none",opacity:"1"},"wwise-top-out-1":{transform:"translateY(-30vh)",opacity:"0"},"wwise-bottom-in-1":{transform:"translateY(30vh)",opacity:".5"},"wwise-bottom-in-2":{transform:"none",opacity:"1"},"wwise-bottom-out-1":{transform:"translateY(30vh)",opacity:"0"},"wwise-left-in-1":{transform:"translateX(-30vw)",opacity:".5"},"wwise-left-in-2":{transform:"none",opacity:"1"},"wwise-left-out-1":{transform:"translateX(-30vw)",opacity:"0"},"wwise-right-in-1":{transform:"translateX(30vw)",opacity:".5"},"wwise-right-in-2":{transform:"none",opacity:"1"},"wwise-right-out-1":{transform:"translateX(30vw)",opacity:"0"},"wwise-min-in-1":{"margin-top":"0",transform:"rotateX(-60deg) scale(0.2, 1.8) translateY(80vh)",opacity:".2"},"wwise-min-in-2":{transform:"none",opacity:"1"},"wwise-min-out-1":{"margin-top":"30vh",transform:"rotateX(-60deg) scale(0.05, 2) translateY(30vh)",opacity:"0"}};let M0={};M0.overlay_in=[new Zu.Frame(_h["wwise-overlay-in-1"],0),new Zu.Frame(_h["wwise-overlay-in-2"],400)],M0.overlay_out=[new Zu.Frame(_h["wwise-overlay-out-1"],300)],M0.pop_in=[new Zu.Frame(_h["wwise-pop-in-1"],0),new Zu.Frame(_h["wwise-pop-in-2"],{duration:200,"timing-function":"ease-in"}),new Zu.Frame(_h["wwise-pop-in-3"],{duration:100,"timing-function":"linear"}),new Zu.Frame(_h["wwise-pop-in-4"],{duration:100,"timing-function":"linear"})],M0.pop_out=[new Zu.Frame(_h["wwise-pop-out-1"],{duration:250,"timing-function":"ease-in"})],M0.flip_in=[new Zu.Frame(_h["wwise-flip-in-1"],0),new Zu.Frame(_h["wwise-flip-in-2"],500)],M0.flip_out=[new Zu.Frame(_h["wwise-flip-out-1"],400)],M0.min_in=[new Zu.Frame(_h["wwise-min-in-1"],0),new Zu.Frame(_h["wwise-min-in-2"],350)],M0.min_out=[new Zu.Frame(_h["wwise-min-out-1"],400)];let H3=["top","bottom","left","right"];for(let tt in H3){let s=H3[tt];M0[s+"_in"]=[new Zu.Frame(_h["wwise-"+s+"-in-1"],0),new Zu.Frame(_h["wwise-"+s+"-in-2"],{duration:400,"timing-function":"ease-out"})],M0[s+"_out"]=[new Zu.Frame(_h["wwise-"+s+"-out-1"],{duration:400,"timing-function":"ease-in"})]}var iP=M0;let EF={animation:"pop",topbar:{showClose:!0,showMin:!1},keepOverlay:!1,position:"center",overlay:!1,clickOverlayToClose:!0,removeBackground:!1,noRadius:!1,zIndex:null};class vD{static create(s,o){let a=s.getElementsByClassName("title")[0];a&&(a=a.innerHTML);let _e=s.getElementsByClassName("content")[0];return _e&&(_e=_e.innerHTML),Ks.removeElement(s),o.title=a,o.content=_e,new vD(o)}constructor(s){this.options=JSON.parse(JSON.stringify(EF));for(let ct in s)s[ct]!=null&&(this.options[ct]=s[ct]);let o=this.options.position;if(o.indexOf(" ")==-1&&(o=="left"||o=="right"?o+=" center":o=o=="top"||o=="bottom"?"center "+o:o+" "+o),this.options.position=o,this.options.overlay){let ct=document.getElementsByClassName("wwise-overlay");ct.length?(this.overlay=ct[0],this.hasOverlay=!0):(this.overlay=Ks.createDiv("wwise-overlay"),this.options.zIndex&&(this.overlay.style.zIndex=this.options.zIndex)),this.overlayClickHandler=this.close.bind(this,void 0)}else this.options.clickOverlayToClose=!1;let a="content";if(this.options.topbar){let ct=[];this.options.topbar.showMin&&(ct.push(Ks.createDiv(null,Ks.makeIconHTML("min"))),ct[ct.length-1].addEventListener("click",this.min.bind(this))),this.options.topbar.showClose&&(ct.push(Ks.createDiv(null,Ks.makeIconHTML("close"))),ct[ct.length-1].addEventListener("click",this.close.bind(this,void 0)));let pt=null;pt=typeof this.options.title=="string"?Ks.createDiv("title",this.options.title):Ks.createDomTree({dom:Ks.createDiv("title"),children:[this.options.title]}),this.topbar=Ks.createDomTree({dom:Ks.createDiv("topbar"),children:[{dom:Ks.createDiv("control"),children:ct.map(ht=>({dom:ht}))},{dom:pt},{dom:Ks.createDiv("clear")}]})}else a+=" no-topbar";typeof this.options.content=="string"?this.content=Ks.createDomTree({dom:Ks.createDiv(a,this.options.content)}):this.content=Ks.createDomTree({dom:Ks.createDiv(a),children:[this.options.content]}),this.options.removeBackground&&(this.content.style.background="initial"),this.window=Ks.createDomTree({dom:Ks.createDiv("wwise"+(this.options.noRadius?" no-radius":"")),children:[this.topbar,this.content]});let _e=Ks.createDiv("wwise-wrapper");this.options.zIndex&&(_e.style.zIndex=this.options.zIndex),this.wrapper=Ks.createDomTree({dom:_e,children:[this.window]}),this.dom=Ks.createDomTree({dom:Ks.createDiv(),children:[this.wrapper]});let rt=this.options.position.split(" "),nt=-50,ot=-50;if(rt[0]=="left"?(nt=0,this.wrapper.classList.add("left")):rt[0]=="right"?(nt=-100,this.wrapper.classList.add("right")):rt[0]=="center"?this.wrapper.classList.add("h-center"):this.wrapper.style.left=rt[0],rt[1]=="top"?(ot=0,this.wrapper.classList.add("top")):rt[1]=="bottom"?(ot=-100,this.wrapper.classList.add("bottom")):rt[1]=="center"?this.wrapper.classList.add("v-center"):this.wrapper.style.top=o[1],this.window.style.transform=`translate(${nt}%, ${ot}%)`,this.options.style)for(let ct in this.options.style)this.window.style[ct]=this.options.style[ct];this.options.margin&&(this.wrapper.style.margin=this.options.margin),this.options.draggable&&this.draggable()}open(s){if(this.opened)return;this.promise=new Promise(a=>{this.promiseResolve=a}),this.appendDoms(),this.opened=!0,this.options.clickOverlayToClose&&(this.overlay.addEventListener("click",this.overlayClickHandler),this.overlay.addEventListener("touchstart",this.overlayClickHandler));let o=s?"min":this.options.animation;if(o){o!="min"&&o!="flip"||this.dom.classList.add("wwise-perspective");let a=[new Zu.Queue(this.wrapper,iP[o+"_in"],{instant:!0,applyOnEnd:!0}).getPromise()];return this.options.overlay&&!this.hasOverlay&&a.push(new Zu.Queue(this.overlay,iP.overlay_in,{instant:!0,applyOnEnd:!0}).getPromise()),Promise.all(a).then(()=>{this.dom.classList.remove("wwise-perspective")})}return Promise.resolve()}close(s){if(!this.opened)return;this.opened=!1;let o=s?"min":this.options.animation;if(this.overlay&&(this.overlay.removeEventListener("click",this.overlayClickHandler),this.overlay.removeEventListener("touchstart",this.overlayClickHandler)),o){o!="min"&&o!="flip"||this.dom.classList.add("wwise-perspective");let a=[new Zu.Queue(this.wrapper,iP[o+"_out"],{instant:!0,applyOnEnd:!0}).getPromise()];return this.options.overlay&&!this.options.keepOverlay&&a.push(new Zu.Queue(this.overlay,iP.overlay_out,{instant:!0,applyOnEnd:!0}).getPromise()),Promise.all(a).then(()=>{this.removeDoms(),this.dom.classList.remove("wwise-perspective"),this.promiseResolve()})}return this.removeDoms(),this.promiseResolve(),Promise.resolve()}min(){return this.close(!0)}resume(){return this.open(!0)}getPromise(){return this.promise}appendDoms(){this.options.overlay&&!this.hasOverlay&&(Ks.appendToBody(this.overlay),document.body.classList.add("wwise-no-scroll"),this.overlay.addEventListener("touchstart",s=>{s.preventDefault()})),Ks.appendToBody(this.dom)}removeDoms(){Ks.removeElement(this.dom),!this.options.keepOverlay&&this.overlay&&(Ks.removeElement(this.overlay),document.body.classList.remove("wwise-no-scroll"))}draggable(s=!0){this.topbar&&(s?(this.draggableMouseMoveHandler=this.handleDraggableMouseMove.bind(this),this.draggableMouseDownHandler=this.handleDraggableMouseDown.bind(this),this.draggableMouseUpHandler=this.handleDraggableMouseUp.bind(this),this.draggableMouseOutHandler=this.handleDraggableMouseOut.bind(this),window.addEventListener("mousemove",this.draggableMouseMoveHandler),window.addEventListener("mouseout",this.draggableMouseOutHandler),this.topbar.addEventListener("mousedown",this.draggableMouseDownHandler),window.addEventListener("mouseup",this.draggableMouseUpHandler)):(window.removeEventListener("mousemove",this.draggableMouseMoveHandler),window.removeEventListener("mouseout",this.draggableMouseOutHandler),this.topbar.removeEventListener("mousedown",this.draggableMouseDownHandler),window.removeEventListener("mouseup",this.draggableMouseUpHandler)))}handleDraggableMouseMove(s){if(this.inDragging){let o={x:s.clientX-this.dragPrev.x,y:s.clientY-this.dragPrev.y},a=window.getComputedStyle(this.wrapper),_e=this.options.draggable,rt=parseFloat(a.left),nt=parseFloat(a.top);if(a.left.indexOf("%")!=-1){rt=a.left,rt=rt.substr(0,rt.length-1),rt=parseInt(rt);let ot=window,ct=document,pt=ct.documentElement,ht=ct.getElementsByTagName("body")[0];rt=rt*(ot.innerWidth||pt.clientWidth||ht.clientWidth)/100}if(a.top.indexOf("%")!=-1){nt=a.top,nt=nt.substr(0,nt.length-1),nt=parseInt(nt);let ot=window,ct=document,pt=ct.documentElement,ht=ct.getElementsByTagName("body")[0];nt=nt*(ot.innerHeight||pt.clientHeight||ht.clientHeight)/100}_e!=1&&_e!="horizontal"||(this.wrapper.style.left=rt+o.x+"px"),_e!=1&&_e!="vertical"||(this.wrapper.style.top=nt+o.y+"px"),this.dragPrev={x:s.clientX,y:s.clientY}}}handleDraggableMouseDown(s){this.inDragging=!0,this.dragPrev={x:s.clientX,y:s.clientY}}handleDraggableMouseUp(s){this.inDragging=!1}handleDraggableMouseOut(s){let o=s.relatedTarget;o&&o.nodeName!="HTML"||(this.inDragging=!1)}}var SF=vD,_D=class{constructor(tt){let s=this.options=tt;!s.type&&(s.type="ok");let o={topbar:!1};o.content=this.constructContent({type:s.type,title:s.title,text:s.text,content:s.content,buttons:s.buttons}),o.overlay=!0,o.keepOverlay=s.keepOverlay,o.clickOverlayToClose=!1,o.animation=s.animation,o.zIndex=s.zIndex,this.wwise=new SF(o)}constructContent(tt){let s=Ks.createDiv("modal"),o=Ks.createDomTree({dom:Ks.createDiv("main "+tt.type),children:[Ks.createDiv(null,Ks.makeIconHTML(tt.type)),Ks.createDiv("title",tt.title),Ks.createDiv("text",tt.text)]});this.buttonArr=Ks.standardizeButtons(this,tt);let a=Ks.makeButtons(this.buttonArr),_e=null;tt.content&&(_e=typeof tt.content=="string"?Ks.createDiv(null,tt.content):tt.content);let rt=null;return a.innerHTML&&(rt=Ks.createDomTree({dom:Ks.createDiv("operation "+tt.type),children:[a]})),_e||rt||o.classList.add("no-op"),Ks.createDomTree({dom:s,children:[o,_e,rt]})}open(){if(this.wwise.opened)return;let tt=this.wwise.open();return this.value=void 0,this.promise=new Promise(s=>{this.promiseResolve=s}),this.wwise.getPromise().then(this.handlePromiseResolve.bind(this)),this.keyHandler=Ks.bindButtonKeyEvents(this.buttonArr),this.options.closeAfter&&window.setTimeout(()=>{this.close("timer")},this.options.closeAfter),tt}close(tt){if(this.wwise.opened)return this.value=tt,Ks.unbindButtonKeyEvents(this.keyHandler),this.wwise.close()}getPromise(){return this.promise}handlePromiseResolve(){this.promiseResolve(this.value)}};let CF={showCancel:!1,okText:"OK",cancelText:"Cancel",placeholder:"",validator:null},TF={type:"info",keepOverlay:!1,title:"Input",text:"",zIndex:null};var sP=__webpackgi_require__(513),UT={};sP.Z&&sP.Z.locals&&(UT.locals=sP.Z.locals);var yD,AD=0,Ex={};Ex.styleTagTransform=GC(),Ex.setAttributes=VC(),Ex.insert=function(tt,s){(s.target||document.head).appendChild(tt)},Ex.domAPI=DE(),Ex.insertStyleElement=U1(),UT.use=function(tt){return Ex.options=tt||{},AD++||(yD=zC()(sP.Z,Ex)),UT},UT.unuse=function(){AD>0&&!--AD&&(yD(),yD=null)};var MF=UT;class bD extends io{constructor(){super(...arguments),this.enabled=!0,this.toJSON=void 0,this._previousMappings={}}async onAdded(s){await super.onAdded(s),this._previousMappings={alert:s.alert,confirm:s.confirm,prompt:s.prompt},Ks.appendToBody=o=>{s.container.appendChild(o)},Ks.makeIconHTML=o=>"",MF.use({target:s.container}),s.alert=async o=>{const a=o==null?void 0:o.split(":")[0],_e=new _D({type:"info",title:a??"&ndsp;",text:(o==null?void 0:o.replace(a+":",""))||"",buttons:[{key:13,text:"OK",type:"main",id:"ok"}],animation:"overlay"});return _e.open(),_e.getPromise()},s.confirm=async o=>{const a=o==null?void 0:o.split(":")[0],_e=new _D({type:"info",title:a??"&ndsp;",text:(o==null?void 0:o.replace(a||"","").replace(":",""))||"",buttons:[{id:"no",key:27,text:"No",normal:!0},{id:"yes",key:13,text:"Yes"}],animation:"overlay"});return _e.open(),await _e.getPromise()==="yes"},s.prompt=async(o,a,_e=!0)=>{const rt=o==null?void 0:o.split(":")[0],nt=new class{constructor(ot){this.options=JSON.parse(JSON.stringify(CF));for(let _t in ot)ot[_t]!=null&&(this.options[_t]=ot[_t]);let ct=this.options,pt=JSON.parse(JSON.stringify(TF));for(let _t in pt)ct.hasOwnProperty(_t)&&(pt[_t]=ct[_t]);let ht=[];ct.showCancel&&ht.push({key:27,text:ct.cancelText,normal:!0,onClick:this.handleCancel.bind(this)}),ht.push({key:13,text:ct.okText,onClick:this.handleOk.bind(this)}),pt.buttons=ht,this.input=Ks.createElement("input","input",null,{placeholder:ct.placeholder}),this.error=Ks.createDiv("error"),pt.content=Ks.createDomTree({dom:Ks.createDiv("input-wrapper"),children:[this.input,this.error]}),this.modal=new _D(pt)}handleCancel(){this.close().then(this.promiseReject.bind(this))}handleOk(){this.options.validator?this.options.validator(this.input.value).then(()=>{this.close().then(this.promiseResolve.bind(this,this.input.value))},ot=>{this.error.innerText=ot}):this.close().then(this.promiseResolve.bind(this,this.input.value))}open(){if(this.modal.wwise.opened)return;let ot=this.modal.open();return this.input.value="",this.error.innerText="",this.input.focus(),this.promise=new Promise((ct,pt)=>{this.promiseResolve=ct,this.promiseReject=pt}),ot}close(){if(this.modal.wwise.opened)return this.modal.close()}getPromise(){return this.promise}}({type:"info",title:rt??"&ndsp;",placeholder:a??"",showCancel:_e,animation:"overlay",text:(o==null?void 0:o.replace(rt||"","").replace(":",""))||""});return nt.open(),await nt.getPromise().catch(async()=>null)}}async onRemove(s){return s.alert=this._previousMappings.alert,s.confirm=this._previousMappings.confirm,s.prompt=this._previousMappings.prompt,super.onRemove(s)}}bD.PluginType="WindowiseDialogPlugin";var RF=yI({defaultModifiers:[w2,E2,S2,bI]}),IF=__webpackgi_require__(388),PF=__webpackgi_require__.n(IF);function DF(tt){const s=[];tt.traverse(_e=>{_e.geometry&&s.push(_e)});const o={},a={};s.forEach(_e=>{var rt;if(!o[_e.geometry.uuid]){const ct=_e.geometry.toJSON().data,pt=ct?PF()({a:ct.attributes||{},b:ct.index||[]}):"";o[_e.geometry.uuid]=pt}const nt=o[_e.geometry.uuid],ot=(rt=a[nt])!==null&&rt!==void 0?rt:a[nt]=[];ot.includes(_e)||ot.push(_e)}),Object.values(a).forEach(_e=>{if(_e.length<2)return;const rt=_e[0].geometry;_e.forEach((nt,ot)=>{ot<1||(nt.geometry.dispose(),nt.geometry=rt)})})}const bA=new et.Pa4,Sx=new et.Pa4,oP=new et.Pa4,wD=new et.Pa4,aP=new et.Pa4,LS=new et.Pa4;let xD=1;const BF=new et.Pa4(0,1,0);class kF extends Xv{constructor(s,o){super(s,o),this.targetOffset=new et.Pa4(0,0,0);const a=this.update;this.update=()=>this._update(a)}_update(s){this.target.add(this.targetOffset),bA.copy(this.object.position).sub(this.target),xD=bA.length(),LS.copy(this.target);const o=s();return LS.sub(this.target),bA.copy(this.object.position).sub(this.target),xD/=bA.length(),this.target.add(LS),this.object.position.copy(this.target).add(bA),bA.normalize(),Sx.crossVectors(BF,bA).normalize(),oP.crossVectors(bA,Sx).normalize(),wD.crossVectors(Sx,oP).normalize().negate(),Sx.length()>.1&&this.object.up.crossVectors(bA.clone().normalize(),Sx),this.enablePan&&(aP.set(0,0,0).addScaledVector(Sx,LS.x).addScaledVector(oP,LS.y).addScaledVector(wD,LS.z),this.targetOffset.add(aP),this.targetOffset.multiplyScalar(1/xD)),aP.set(0,0,0).addScaledVector(Sx,-this.targetOffset.x).addScaledVector(oP,-this.targetOffset.y).addScaledVector(wD,-this.targetOffset.z),this.object.lookAt(aP.add(this.target)),this.object.updateMatrixWorld(),this.object.isCamera&&this.object.updateProjectionMatrix(),this.target.sub(this.targetOffset),o}}class OF extends oC{constructor(){super(),this.boundingScaleMultiplier=1.2,this._initGeometry(new et.cJO(1,0))}}function ED(tt,s){var o,a;const _e=Array.from(((o=tt.access)!==null&&o!==void 0?o:"").split(".")),rt=_e.pop();let nt=(a=tt.targetObject)!==null&&a!==void 0?a:s;if(!rt||rt.length===0)return{key:void 0,tar:nt};if(nt=Ft(_e,nt),nt&&!(rt in nt))throw console.error("invalid key",rt,nt,s,tt),"";return{key:rt,tar:nt}}function SD(tt,s,o,a){const{key:_e,tar:rt}=ED(tt,s);return _e&&rt?g1(rt,_e,()=>{var nt;o&&(!((nt=tt.updater)===null||nt===void 0)&&nt.length)&&tt.updater.forEach(ot=>o[ot]()),a==null||a()}):nt=>console.warn("Unable to set ",nt,_e,rt,tt,s)}async function lP(tt,s,o){var a,_e,rt,nt;const{key:ot,tar:ct}=ED(s,tt),pt=s.animSet?[q3(ct,s.animSet,o,(a=s.animSetParallel)!==null&&a!==void 0&&a)]:[];if(ot&&ct){const ht=(nt=s.updater)!==null&&nt!==void 0?nt:[],_t=async()=>v1(ct,ot,{...s,onUpdate:Et=>{var St;(St=s.onUpdate)===null||St===void 0||St.call(s,Et),ht.forEach(Mt=>{var It;return(It=o[Mt])===null||It===void 0?void 0:It.call(o)})}});s.delay?pt.push(mu(s.delay).then(_t)):pt.push(_t())}else(s.duration||s.delay)&&pt.push(mu(((_e=s.delay)!==null&&_e!==void 0?_e:0)+((rt=s.duration)!==null&&rt!==void 0?rt:0)));return pt.length===1?pt[0]:Promise.all(pt)}async function q3(tt,s,o,a=!1){if(a)return Promise.all(s.map(async _e=>lP(tt,_e,o)));for(const _e of s)await lP(tt,_e,o)}function W3(tt,s,o,a){var _e,rt,nt,ot,ct,pt,ht;if(!tt)return;s||(s=[]);const _t=a??{},Et=tt;for(let St=0,Mt=s.length;St<Mt;St++){const It=s[St];if(It.uiRef){const Bt=(ct=Et==null?void 0:Et.indexOf(It.uiRef))!==null&&ct!==void 0?ct:-1;Bt!==St&&(Bt>=0&&(Et==null||Et.splice(Bt,1)),Et==null||Et.splice(St,0,It.uiRef))}else{It.uiRef={type:"folder",label:(_e=It.name)!==null&&_e!==void 0?_e:"Animation "+St,children:[]};const Bt=[{type:"button",label:"animate",value:()=>{lP(o,It,_t).then(()=>{var kt;return console.log(((kt=It.uiRef)===null||kt===void 0?void 0:kt.label)+" finished")})}}];It.access!==void 0&&Bt.push({type:"input",property:[It,"access"]}),It.from!==void 0&&Bt.push({type:(rt=It.uiObjectType)!==null&&rt!==void 0?rt:"input",property:[It,"from"],onChange:()=>{var kt;SD(It,o)(It.from),(kt=It.updater)===null||kt===void 0||kt.forEach(Pt=>Pt in _t&&_t[Pt]())}}),It.to!==void 0&&Bt.push({type:(nt=It.uiObjectType)!==null&&nt!==void 0?nt:"input",property:[It,"to"],onChange:()=>{var kt;SD(It,o)(It.to),(kt=It.updater)===null||kt===void 0||kt.forEach(Pt=>Pt in _t&&_t[Pt]())}}),It.duration!==void 0&&Bt.push({type:"input",property:[It,"duration"]}),It.animSet&&(It.animSetParallel||(It.animSetParallel=!1),Bt.push({type:"input",label:"run parallel",property:[It,"animSetParallel"]})),It.animSet&&Bt.push({type:"folder",label:"AnimSet",expanded:!1,children:[],animSetContainer:!0}),(ot=It.uiRef.children)===null||ot===void 0||ot.push(...Bt),Et==null||Et.splice(St,0,It.uiRef)}const Nt=(pt=It.uiRef.children)===null||pt===void 0?void 0:pt.map(Bt=>er(Bt)).flat(2).find(Bt=>Bt==null?void 0:Bt.animSetContainer);It.animSet&&Nt&&W3(Nt.children,It.animSet,(ht=It.targetObject)!==null&&ht!==void 0?ht:o,a)}}function Y3(tt,s){return s?tt*(1e3/s):0}function LF(tt){var s,o=tt.from,a=o===void 0?0:o,_e=tt.velocity,rt=_e===void 0?0:_e,nt=tt.min,ot=tt.max,ct=tt.power,pt=ct===void 0?.8:ct,ht=tt.timeConstant,_t=ht===void 0?750:ht,Et=tt.bounceStiffness,St=Et===void 0?500:Et,Mt=tt.bounceDamping,It=Mt===void 0?10:Mt,Nt=tt.restDelta,Bt=Nt===void 0?1:Nt,kt=tt.modifyTarget,Pt=tt.driver,qt=tt.onUpdate,Kt=tt.onComplete;function nr(kr){return nt!==void 0&&kr<nt||ot!==void 0&&kr>ot}function ir(kr){return nt===void 0?ot:ot===void 0||Math.abs(nt-kr)<Math.abs(ot-kr)?nt:ot}function fr(kr){s==null||s.stop(),s=iw(fu(fu({},kr),{driver:Pt,onUpdate:function(Hr){var Lr;qt==null||qt(Hr),(Lr=kr.onUpdate)===null||Lr===void 0||Lr.call(kr,Hr)},onComplete:Kt}))}function br(kr){fr(fu({type:"spring",stiffness:St,damping:It,restDelta:Bt},kr))}if(nr(a))br({from:a,velocity:rt,to:ir(a)});else{var Tr=pt*rt+a;kt!==void 0&&(Tr=kt(Tr));var Dr,Rr,Nr=ir(Tr),Ir=Nr===nt?-1:1;fr({type:"decay",from:a,velocity:rt,timeConstant:_t,power:pt,restDelta:Bt,modifyTarget:kt,onUpdate:nr(Tr)?function(kr){Dr=Rr,Rr=kr,rt=Y3(kr-Dr,_E().delta),(Ir===1&&kr>Nr||Ir===-1&&kr<Nr)&&br({from:kr,to:Nr,velocity:rt})}:void 0})}return{stop:function(){return s==null?void 0:s.stop()}}}var K3=function(tt){return 180*tt/Math.PI},NF=function(tt,s){return s===void 0&&(s=d1),K3(Math.atan2(s.y-tt.y,s.x-tt.x))},FF=function(tt,s){var o=!0;return s===void 0&&(s=tt,o=!1),function(a){return o?a-tt+s:(tt=a,o=!0,s)}},UF=function(tt){return tt},CD=function(tt){return tt===void 0&&(tt=UF),function(s,o,a){var _e=o-a,rt=-(0-s+1)*(0-tt(Math.abs(_e)));return _e<=0?o+rt:o-rt}},$F=CD(),jF=CD(Math.sqrt),X3=function(tt){return tt*Math.PI/180},uP=function(tt){return tt.hasOwnProperty("x")&&tt.hasOwnProperty("y")},TD=function(tt){return uP(tt)&&tt.hasOwnProperty("z")},cP=function(tt,s){return Math.abs(tt-s)};function zF(tt,s){if(lE(tt)&&lE(s))return cP(tt,s);if(uP(tt)&&uP(s)){var o=cP(tt.x,s.x),a=cP(tt.y,s.y),_e=TD(tt)&&TD(s)?cP(tt.z,s.z):0;return Math.sqrt(Math.pow(o,2)+Math.pow(a,2)+Math.pow(_e,2))}}var VF=function(tt,s,o){return s=X3(s),{x:o*Math.cos(s)+tt.x,y:o*Math.sin(s)+tt.y}},J3=function(tt,s){return s===void 0&&(s=2),s=Math.pow(10,s),Math.round(tt*s)/s},Z3=function(tt,s,o,a){return a===void 0&&(a=0),J3(tt+o*(s-tt)/Math.max(a,o))},GF=function(tt){tt===void 0&&(tt=50);var s=0,o=0;return function(a){var _e=_E().timestamp,rt=_e!==o?_e-o:0,nt=rt?Z3(s,a,rt,tt):s;return o=_e,s=nt,nt}},QF=function(tt){if(typeof tt=="number")return function(a){return Math.round(a/tt)*tt};var s=0,o=tt.length;return function(a){var _e=Math.abs(tt[0]-a);for(s=1;s<o;s++){var rt=tt[s],nt=Math.abs(rt-a);if(nt===0)return rt;if(nt>_e)return tt[s-1];if(s===o-1)return rt;_e=nt}}};function HF(tt,s){return tt/(1e3/s)}var qF=function(tt,s,o){var a=s-tt;return((o-tt)%a+a)%a+tt},eL=function(tt,s){return 1-3*s+3*tt},tL=function(tt,s){return 3*s-6*tt},rL=function(tt){return 3*tt},dP=function(tt,s,o){return((eL(s,o)*tt+tL(s,o))*tt+rL(s))*tt},nL=function(tt,s,o){return 3*eL(s,o)*tt*tt+2*tL(s,o)*tt+rL(s)},pP=.1;function WF(tt,s,o,a){if(tt===s&&o===a)return o1;for(var _e=new Float32Array(11),rt=0;rt<11;++rt)_e[rt]=dP(rt*pP,tt,o);return function(nt){return nt===0||nt===1?nt:dP(function(ot){for(var ct=0,pt=1;pt!==10&&_e[pt]<=ot;++pt)ct+=pP;--pt;var ht=ct+(ot-_e[pt])/(_e[pt+1]-_e[pt])*pP,_t=nL(ht,tt,o);return _t>=.001?function(Et,St,Mt,It){for(var Nt=0;Nt<8;++Nt){var Bt=nL(St,Mt,It);if(Bt===0)return St;St-=(dP(St,Mt,It)-Et)/Bt}return St}(ot,ht,tt,o):_t===0?ht:function(Et,St,Mt,It,Nt){var Bt,kt,Pt=0;do(Bt=dP(kt=St+(Mt-St)/2,It,Nt)-Et)>0?Mt=kt:St=kt;while(Math.abs(Bt)>1e-7&&++Pt<10);return kt}(ot,ct,ct+pP,tt,o)}(nt),s,a)}}var YF=function(tt,s){return s===void 0&&(s="end"),function(o){var a=(o=s==="end"?Math.min(o,.999):Math.max(o,.001))*tt,_e=s==="end"?Math.floor(a):Math.ceil(a);return J0(0,1,_e/tt)}};async function KF(tt,{debug:s=!1,ground:o=!0,bloom:a=!0,depthTonemap:_e=!1,importPopup:rt=!0,caching:nt=!0}){const ot=new _g(tt);ot.enabled=!1,s&&await ot.addPlugin(Ov),await ot.addPlugin(os,void 0,void 0,{storage:nt&&window.caches?await window.caches.open("webgi-cache-storage"):void 0}),await ot.addPlugin(uT),await ot.addPlugin(s2),rt&&await ot.addPlugin(m0),await ot.addPlugin(bD),await ot.addPlugin(aT),await ot.addPlugin(go),await ot.addPlugin(A_),await ot.addPlugin(sT),await ot.addPlugin(Yp),await ot.addPlugin(tS),await ot.addPlugin(iT),await ot.addPlugin(Jw),await ot.addPlugin(Wo,aC,!1,!0),await GE(ot,{ground:o,bloom:a,depthTonemap:_e}),await ot.addPlugin(TI,!1),await ot.addPlugin(S0,!1),await ot.addPlugin(lS,!1),await ot.addPlugin(Cw,!1),await ot.addPlugin(oD),await ot.addPlugin(uD),await ot.addPlugin(cD),await ot.addPlugin(fA,!1),await ot.addPlugin(xy),await ot.addPlugin(Hv),await ot.addPlugin(qv),await ot.addPlugin(vx),await ot.addPlugin(Rw),await ot.addPlugin(Mw),await ot.addPlugin(_y),await ot.addPlugin(bm),await ot.addPlugin(ZI),await ot.addPlugin(JI),await ot.addPlugin(eP),await ot.addPlugin(tP),await ot.addPlugin(AA),await ot.addPlugin(nP),await ot.addPlugin(XI);const ct=await ot.addPlugin(new gD(!Nw()));return ot.renderer.refreshPipeline(),ot.scene.addEventListener("textureAdded",pt=>{pt.texture&&ot.scene.setEnvironment(pt.texture)}),ct.setupPluginUi(hu),ct.setupPluginUi(AA),ct.setupPluginUi(nP),ct.setupPluginUi(Jw),ct.setupPluginUi(XI),ct.setupPluginUi(uT),ct.setupPluginUi(Gl),ct.setupPluginUi(a0),ct.setupPluginUi(Rw),ct.setupPluginUi(vx),ct.setupPluginUi(ZI),ct.setupPluginUi(Mw),ct.setupPluginUi(ru),ct.setupPluginUi(Wo),o&&ct.setupPluginUi(_m),ct.setupPluginUi(Qx),ct.setupPluginUi(gu),ct.setupPluginUi(_y),ct.setupPluginUi(j1),ct.setupPluginUi(jE),ct.setupPluginUi(VE),ct.setupPluginUi(FE),ct.setupPluginUi(UE),ct.setupPluginUi(c0),ct.setupPluginUi(qx),ct.setupPluginUi(lS),ct.setupPluginUi(Cw),ct.setupPluginUi(JI),ct.setupPluginUi(xy),ct.setupPluginUi(Hv),ct.setupPluginUi(_p),ct.setupPluginUi(eP),ct.setupPluginUi(tP),ct.setupPluginUi(km),ct.setupPluginUi(yp),a&&ct.setupPluginUi(iy),ct.setupPluginUi(bm),ct.setupPluginUi(Am),ct.setupPluginUi(I1),ct.setupPluginUi(wm),ct.setupPluginUi(TI),ct.setupPluginUi(qv),ct.setupPluginUi(i0),ct.setupPluginUi(R1),ct.setupPluginUi(h0),ct.setupPluginUi(lp),ct.setupPluginUi(S0),ct.setupPluginUi(m0),ct.setupPluginUi(xm),ct.setupPluginUi(fA),ot.enabled=!0,ot}})();__webpackgi_exports__.LY2;__webpackgi_exports__.HRj;__webpackgi_exports__.li4;__webpackgi_exports__.FO5;__webpackgi_exports__.Nlh;__webpackgi_exports__.QvI;__webpackgi_exports__.JHp;__webpackgi_exports__.bGH;__webpackgi_exports__.NDo;__webpackgi_exports__.gSk;__webpackgi_exports__.WMw;__webpackgi_exports__.OTo;__webpackgi_exports__.Se2;__webpackgi_exports__.cum;__webpackgi_exports__.Mig;__webpackgi_exports__.B$7;__webpackgi_exports__.i_9;__webpackgi_exports__.m7l;__webpackgi_exports__.sYA;__webpackgi_exports__.Xcj;__webpackgi_exports__.mzJ;__webpackgi_exports__.ZZA;__webpackgi_exports__.$Ph;__webpackgi_exports__.T__;__webpackgi_exports__.HkE;__webpackgi_exports__.tGC;__webpackgi_exports__.g1S;__webpackgi_exports__.I$C;__webpackgi_exports__.QIH;__webpackgi_exports__._JE;var __webpackgi_exports__AssetManagerPlugin=__webpackgi_exports__.ksm;__webpackgi_exports__.jl_;__webpackgi_exports__.b7R;__webpackgi_exports__.BDV;__webpackgi_exports__.Ea_;__webpackgi_exports__.qff;__webpackgi_exports__.tmC;__webpackgi_exports__.BON;__webpackgi_exports__.P40;__webpackgi_exports__.wLL;__webpackgi_exports__.iHO;__webpackgi_exports__.BbS;__webpackgi_exports__.kqm;__webpackgi_exports__.Hmr;__webpackgi_exports__.SJI;__webpackgi_exports__.mTL;__webpackgi_exports__.y8_;__webpackgi_exports__._Li;__webpackgi_exports__.g56;__webpackgi_exports__.bj3;__webpackgi_exports__.z81;__webpackgi_exports__._MY;__webpackgi_exports__.yEv;var __webpackgi_exports__BloomPlugin=__webpackgi_exports__.dFZ;__webpackgi_exports__.N$j;__webpackgi_exports__._YM;__webpackgi_exports__.TUj;__webpackgi_exports__.ZzF;__webpackgi_exports__.qzb;__webpackgi_exports__.GQ;__webpackgi_exports__.nvb;__webpackgi_exports__.DvJ;__webpackgi_exports__.fQA;__webpackgi_exports__.cPz;__webpackgi_exports__.TlE;__webpackgi_exports__.u9r;__webpackgi_exports__.s4_;__webpackgi_exports__.T95;__webpackgi_exports__.F5w;__webpackgi_exports__.NlP;__webpackgi_exports__.$8Z;__webpackgi_exports__.YYN;__webpackgi_exports__.CtF;__webpackgi_exports__.V1s;__webpackgi_exports__.jOv;__webpackgi_exports__.Rki;__webpackgi_exports__.pzV;__webpackgi_exports__.itZ;__webpackgi_exports__.qKx;__webpackgi_exports__.vlJ;__webpackgi_exports__.nPO;__webpackgi_exports__.zcQ;__webpackgi_exports__.GH1;__webpackgi_exports__.ROQ;__webpackgi_exports__.YN5;__webpackgi_exports__.BVQ;__webpackgi_exports__.YT8;__webpackgi_exports__._DE;__webpackgi_exports__.YGz;__webpackgi_exports__.trn;__webpackgi_exports__.zf8;__webpackgi_exports__.uWy;__webpackgi_exports__.wYQ;__webpackgi_exports__.SUY;__webpackgi_exports__.Ilk;__webpackgi_exports__.R2R;__webpackgi_exports__.epp;__webpackgi_exports__.xmJ;__webpackgi_exports__.GD$;__webpackgi_exports__.EB7;__webpackgi_exports__.DqL;__webpackgi_exports__._3;__webpackgi_exports__.b_z;__webpackgi_exports__.OCn;__webpackgi_exports__._am;__webpackgi_exports__.kB7;__webpackgi_exports__.fY$;__webpackgi_exports__.vxC;__webpackgi_exports__.BtG;__webpackgi_exports__.cBK;__webpackgi_exports__.g8_;__webpackgi_exports__.AXT;__webpackgi_exports__.yj7;__webpackgi_exports__.dYG;__webpackgi_exports__.tm_;__webpackgi_exports__.S2y;__webpackgi_exports__.B02;__webpackgi_exports__.PeU;__webpackgi_exports__.Hyl;__webpackgi_exports__.Wqd;__webpackgi_exports__.Xaj;__webpackgi_exports__.DUb;__webpackgi_exports__.dZ3;__webpackgi_exports__.m_w;__webpackgi_exports__.fHI;__webpackgi_exports__.LBq;__webpackgi_exports__.dHf;__webpackgi_exports__.Qww;__webpackgi_exports__.CGV;__webpackgi_exports__.JUT;__webpackgi_exports__.p3g;__webpackgi_exports__.IEO;__webpackgi_exports__.CN8;__webpackgi_exports__.zob;__webpackgi_exports__.yxD;__webpackgi_exports__.CUS;__webpackgi_exports__.A5E;__webpackgi_exports__.zqG;__webpackgi_exports__.PfX;__webpackgi_exports__.Q1o;__webpackgi_exports__.jfJ;__webpackgi_exports__.T_J;__webpackgi_exports__.tEQ;__webpackgi_exports__.gb4;__webpackgi_exports__.qkB;__webpackgi_exports__.cvk;__webpackgi_exports__.HWo;__webpackgi_exports__.brP;__webpackgi_exports__.$YQ;__webpackgi_exports__.X8d;__webpackgi_exports__.Zdt;__webpackgi_exports__.yNB;__webpackgi_exports__.h7x;__webpackgi_exports__.Ox3;__webpackgi_exports__.qtn;__webpackgi_exports__.cBI;__webpackgi_exports__.cU9;__webpackgi_exports__.DT1;__webpackgi_exports__.Kgo;__webpackgi_exports__.ehD;__webpackgi_exports__.fhJ;__webpackgi_exports__.y1s;__webpackgi_exports__.fSK;__webpackgi_exports__.Vdb;__webpackgi_exports__.l8J;__webpackgi_exports__.dj0;__webpackgi_exports__.QM0;__webpackgi_exports__.OIS;__webpackgi_exports__.q8b;__webpackgi_exports__.TOt;__webpackgi_exports__.xaN;__webpackgi_exports__.Ny0;__webpackgi_exports__.NeD;__webpackgi_exports__.Zof;__webpackgi_exports__.eD;__webpackgi_exports__.jwo;__webpackgi_exports__.dSO;__webpackgi_exports__.Bf4;__webpackgi_exports__.USm;__webpackgi_exports__.pBf;__webpackgi_exports__.$Vf;__webpackgi_exports__.O7d;__webpackgi_exports__.ksq;__webpackgi_exports__.gXf;__webpackgi_exports__.hH6;__webpackgi_exports__.kpi;__webpackgi_exports__.DwZ;__webpackgi_exports__.kN3;__webpackgi_exports__.e62;__webpackgi_exports__.a$l;__webpackgi_exports__.OM3;__webpackgi_exports__.VzW;__webpackgi_exports__.ybr;__webpackgi_exports__.yo9;__webpackgi_exports__.$Bt;__webpackgi_exports__.Wzm;__webpackgi_exports__.Wl3;__webpackgi_exports__.iWj;__webpackgi_exports__.DNz;var __webpackgi_exports__GBufferPlugin=__webpackgi_exports__.m1M;__webpackgi_exports__.ylh;__webpackgi_exports__.v9Y;__webpackgi_exports__.LSk;__webpackgi_exports__.LHE;__webpackgi_exports__.KE0;__webpackgi_exports__.KCF;__webpackgi_exports__.a4n;__webpackgi_exports__.zIH;__webpackgi_exports__.Hfk;__webpackgi_exports__.png;__webpackgi_exports__.tAj;__webpackgi_exports__.Eb_;__webpackgi_exports__.BT2;__webpackgi_exports__._8p;__webpackgi_exports__.V5Z;var __webpackgi_exports__GammaCorrectionPlugin=__webpackgi_exports__.s5b;__webpackgi_exports__.hkn;__webpackgi_exports__.GFY;__webpackgi_exports__.w$m;__webpackgi_exports__.ksN;__webpackgi_exports__.j4z;__webpackgi_exports__.OAl;__webpackgi_exports__.VLJ;__webpackgi_exports__.C73;__webpackgi_exports__.ZAu;__webpackgi_exports__.ibP;__webpackgi_exports__._fI;__webpackgi_exports__.hUN;__webpackgi_exports__.cLu;__webpackgi_exports__.vmT;__webpackgi_exports__.Qpg;__webpackgi_exports__.So8;__webpackgi_exports__.eOv;__webpackgi_exports__.Wjw;__webpackgi_exports__.cJO;__webpackgi_exports__.QRU;__webpackgi_exports__.S3k;__webpackgi_exports__.PpQ;__webpackgi_exports__.AHu;__webpackgi_exports__.q_9;__webpackgi_exports__.ZRs;__webpackgi_exports__.oqc;__webpackgi_exports__.T_x;__webpackgi_exports__.lb7;__webpackgi_exports__.L5s;__webpackgi_exports__.$TI;__webpackgi_exports__.SPe;__webpackgi_exports__.aVm;__webpackgi_exports__.j87;__webpackgi_exports__.RNb;__webpackgi_exports__.Kz5;__webpackgi_exports__.vpT;__webpackgi_exports__.kB5;__webpackgi_exports__._C8;__webpackgi_exports__.Syv;__webpackgi_exports__.NMF;__webpackgi_exports__.pIN;__webpackgi_exports__.eMJ;__webpackgi_exports__.rN7;__webpackgi_exports__.iUp;__webpackgi_exports__.GFd;__webpackgi_exports__.x5V;__webpackgi_exports__.tUh;__webpackgi_exports__.z8B;__webpackgi_exports__.vcl;__webpackgi_exports__.GZb;__webpackgi_exports__.p7y;__webpackgi_exports__.S9g;__webpackgi_exports__.Zr5;__webpackgi_exports__.vCF;__webpackgi_exports__.yt0;__webpackgi_exports__.uXU;__webpackgi_exports__._kC;__webpackgi_exports__.lk7;__webpackgi_exports__.USc;__webpackgi_exports__.x12;__webpackgi_exports__.Zzh;__webpackgi_exports__.nls;__webpackgi_exports__.g_z;__webpackgi_exports__.U7;__webpackgi_exports__.FT0;__webpackgi_exports__.blk;__webpackgi_exports__.ejS;__webpackgi_exports__.rnI;__webpackgi_exports__.wem;__webpackgi_exports__.lfu;__webpackgi_exports__.FDw;__webpackgi_exports__.lRj;__webpackgi_exports__.D1R;__webpackgi_exports__.qyh;__webpackgi_exports__.GUF;__webpackgi_exports__.EoG;__webpackgi_exports__.aNw;__webpackgi_exports__.Zp0;__webpackgi_exports__.lLk;__webpackgi_exports__.jAl;__webpackgi_exports__.uEv;__webpackgi_exports__.YKA;__webpackgi_exports__.cRx;__webpackgi_exports__.Y8D;__webpackgi_exports__.RsA;__webpackgi_exports__.Y0m;__webpackgi_exports__.F5T;__webpackgi_exports__.EDU;__webpackgi_exports__.z$Q;__webpackgi_exports__.KA8;__webpackgi_exports__.XUj;__webpackgi_exports__.Me$;__webpackgi_exports__.u7G;__webpackgi_exports__.PEk;__webpackgi_exports__.BG4;__webpackgi_exports__.M8C;__webpackgi_exports__.Vkp;__webpackgi_exports__.yGw;__webpackgi_exports__.Sm8;__webpackgi_exports__.Kj0;__webpackgi_exports__.vBJ;__webpackgi_exports__.QfV;__webpackgi_exports__.lRF;__webpackgi_exports__.Lun;__webpackgi_exports__.YBo;__webpackgi_exports__.kaV;__webpackgi_exports__.RSm;__webpackgi_exports__.xoR;__webpackgi_exports__.EJi;__webpackgi_exports__.Wid;__webpackgi_exports__.iuj;__webpackgi_exports__.IKL;__webpackgi_exports__.r_;__webpackgi_exports__.OoA;__webpackgi_exports__.qhX;__webpackgi_exports__.qPT;__webpackgi_exports__.M5h;__webpackgi_exports__.Ns1;__webpackgi_exports__.TyD;__webpackgi_exports__.vZf;__webpackgi_exports__.HTd;__webpackgi_exports__.aH4;__webpackgi_exports__.YLQ;__webpackgi_exports__.BVF;__webpackgi_exports__.MyG;__webpackgi_exports__.jFi;__webpackgi_exports__.aCh;__webpackgi_exports__.uL9;__webpackgi_exports__.TNj;__webpackgi_exports__.IFH;__webpackgi_exports__.bdR;__webpackgi_exports__.kM_;__webpackgi_exports__.M6v;__webpackgi_exports__.RvT;__webpackgi_exports__.dUE;__webpackgi_exports__.oe_;__webpackgi_exports__.BuN;__webpackgi_exports__.Tme;__webpackgi_exports__.N9P;__webpackgi_exports__.Gql;__webpackgi_exports__.$XY;__webpackgi_exports__.O9d;__webpackgi_exports__.zEO;__webpackgi_exports__.qfx;__webpackgi_exports__.PA7;__webpackgi_exports__.REq;__webpackgi_exports__.pQR;__webpackgi_exports__.ghN;__webpackgi_exports__.Hy8;__webpackgi_exports__.Wpd;__webpackgi_exports__.LgZ;__webpackgi_exports__.iWC;__webpackgi_exports__.mqn;__webpackgi_exports__.SKe;__webpackgi_exports__.iKG;__webpackgi_exports__._iA;__webpackgi_exports__.ntZ;__webpackgi_exports__.anP;__webpackgi_exports__.X2e;__webpackgi_exports__.FCo;__webpackgi_exports__.y$t;__webpackgi_exports__.cPb;__webpackgi_exports__.lmx;__webpackgi_exports__.JOQ;__webpackgi_exports__.BKK;__webpackgi_exports__._12;__webpackgi_exports__.tJx;__webpackgi_exports__.cek;__webpackgi_exports__.qD0;__webpackgi_exports__.xG9;__webpackgi_exports__.wI8;__webpackgi_exports__.Sgv;__webpackgi_exports__.woe;__webpackgi_exports__.UY4;__webpackgi_exports__.aq0;__webpackgi_exports__.ujx;__webpackgi_exports__.Uol;__webpackgi_exports__.JiH;__webpackgi_exports__.VYz;__webpackgi_exports__._Pm;var __webpackgi_exports__ProgressivePlugin=__webpackgi_exports__.EsW;__webpackgi_exports__.iUV;__webpackgi_exports__.tf;__webpackgi_exports__.ZQ6;__webpackgi_exports__.mXe;__webpackgi_exports__._fP;__webpackgi_exports__.iLg;__webpackgi_exports__.zbs;__webpackgi_exports__.UZH;__webpackgi_exports__.mSO;__webpackgi_exports__.wk1;__webpackgi_exports__.E2K;__webpackgi_exports__.FUD;__webpackgi_exports__.pKu;__webpackgi_exports__.GG6;__webpackgi_exports__.Gih;__webpackgi_exports__.iiP;__webpackgi_exports__.SvJ;__webpackgi_exports__.ptH;__webpackgi_exports__.jZA;__webpackgi_exports__.y2t;__webpackgi_exports__.gi4;__webpackgi_exports__.Djp;__webpackgi_exports__.BG$;__webpackgi_exports__.NYV;__webpackgi_exports__.xJs;__webpackgi_exports__.bsb;__webpackgi_exports__.ekQ;__webpackgi_exports__.CaW;__webpackgi_exports__.eaV;__webpackgi_exports__.BFQ;__webpackgi_exports__.v3W;__webpackgi_exports__.ILR;__webpackgi_exports__.UCm;__webpackgi_exports__.Inb;__webpackgi_exports__.U1$;__webpackgi_exports__.LgE;__webpackgi_exports__.fto;__webpackgi_exports__.l0P;__webpackgi_exports__.vCx;__webpackgi_exports__._AM;__webpackgi_exports__.wuA;__webpackgi_exports__.av9;__webpackgi_exports__.CtA;__webpackgi_exports__.BvQ;__webpackgi_exports__.FZJ;__webpackgi_exports__.FIo;__webpackgi_exports__.zHn;__webpackgi_exports__.iMs;__webpackgi_exports__.T_f;__webpackgi_exports__.hEm;__webpackgi_exports__.D9w;__webpackgi_exports__.sHH;__webpackgi_exports__.CdI;__webpackgi_exports__.rkc;__webpackgi_exports__.rpg;__webpackgi_exports__.ce8;__webpackgi_exports__.rOj;__webpackgi_exports__.P6m;__webpackgi_exports__.JA6;__webpackgi_exports__.V4E;__webpackgi_exports__.o8S;__webpackgi_exports__.flB;__webpackgi_exports__.DUH;__webpackgi_exports__.KI_;var __webpackgi_exports__SSAOPlugin=__webpackgi_exports__.iLN;__webpackgi_exports__.jsw;__webpackgi_exports__.srG;var __webpackgi_exports__SSRPlugin=__webpackgi_exports__.i6Z;__webpackgi_exports__.vfv;__webpackgi_exports__.xsS;__webpackgi_exports__.or;__webpackgi_exports__.EQj;__webpackgi_exports__.ov0;__webpackgi_exports__.WdD;__webpackgi_exports__.Vj0;__webpackgi_exports__.jyz;__webpackgi_exports__.mTM;__webpackgi_exports__.Mn1;__webpackgi_exports__.Hlq;__webpackgi_exports__.Fi7;__webpackgi_exports__.Tn7;__webpackgi_exports__.bnF;__webpackgi_exports__.HW6;__webpackgi_exports__.oa8;__webpackgi_exports__.T_1;__webpackgi_exports__.zHJ;__webpackgi_exports__.iDF;__webpackgi_exports__.iAb;__webpackgi_exports__.d4E;__webpackgi_exports__.lBg;__webpackgi_exports__.JeJ;__webpackgi_exports__.FKY;__webpackgi_exports__.zlZ;__webpackgi_exports__.vkg;__webpackgi_exports__.brh;__webpackgi_exports__.kZK;__webpackgi_exports__.puG;__webpackgi_exports__.OdW;__webpackgi_exports__._YX;__webpackgi_exports__.TUv;__webpackgi_exports__.Hw6;__webpackgi_exports__.aLr;__webpackgi_exports__.Aip;__webpackgi_exports__.xo$;__webpackgi_exports__.bIn;__webpackgi_exports__.$V;__webpackgi_exports__.lDi;__webpackgi_exports__.gti;__webpackgi_exports__.PMe;__webpackgi_exports__.iwP;__webpackgi_exports__.FvO;__webpackgi_exports__.jyi;__webpackgi_exports__.xeV;__webpackgi_exports__.k74;__webpackgi_exports__.RlZ;__webpackgi_exports__.KhW;__webpackgi_exports__.HgB;__webpackgi_exports__.W2J;__webpackgi_exports__.JWc;__webpackgi_exports__.u37;__webpackgi_exports__.Z6B;__webpackgi_exports__.QZ1;__webpackgi_exports__.Ir4;__webpackgi_exports__.NwF;__webpackgi_exports__.Wbm;__webpackgi_exports__.N4l;__webpackgi_exports__.ej9;__webpackgi_exports__.QmN;__webpackgi_exports__.IOt;__webpackgi_exports__.NOD;__webpackgi_exports__.L5g;__webpackgi_exports__.H$k;__webpackgi_exports__.cuP;__webpackgi_exports__.xEZ;__webpackgi_exports__.dpR;__webpackgi_exports__.wOD;__webpackgi_exports__.KNb;var __webpackgi_exports__TonemapPlugin=__webpackgi_exports__.IiN;__webpackgi_exports__.Cne;__webpackgi_exports__.XvJ;__webpackgi_exports__.XZw;__webpackgi_exports__.FE5;__webpackgi_exports__.lVp;__webpackgi_exports__.CJI;__webpackgi_exports__.z$h;__webpackgi_exports__.UlW;__webpackgi_exports__.WwZ;__webpackgi_exports__.Lcc;__webpackgi_exports__.WXh;__webpackgi_exports__.Vjr;__webpackgi_exports__.LuM;__webpackgi_exports__.LP5;__webpackgi_exports__.xfE;__webpackgi_exports__.qlB;__webpackgi_exports__.lCJ;__webpackgi_exports__.WTc;__webpackgi_exports__.rAo;__webpackgi_exports__.LZj;__webpackgi_exports__.xWb;__webpackgi_exports__.gH0;__webpackgi_exports__.rBU;__webpackgi_exports__.rDY;__webpackgi_exports__.ywz;__webpackgi_exports__.wJv;__webpackgi_exports__.JQ4;__webpackgi_exports__.k0A;__webpackgi_exports__.irR;__webpackgi_exports__.LsT;__webpackgi_exports__.q5h;__webpackgi_exports__.TKh;__webpackgi_exports__.tyg;__webpackgi_exports__.Ro5;__webpackgi_exports__.dwk;__webpackgi_exports__.FM8;__webpackgi_exports__.Pa4;__webpackgi_exports__.Ltg;__webpackgi_exports__.yC1;__webpackgi_exports__.lHq;__webpackgi_exports__.fO1;var __webpackgi_exports__ViewerApp=__webpackgi_exports__.oMA;__webpackgi_exports__.JzW;__webpackgi_exports__.QEt;__webpackgi_exports__.b5g;__webpackgi_exports__.Ywn;__webpackgi_exports__.GVz;__webpackgi_exports__.oAp;__webpackgi_exports__.kFz;__webpackgi_exports__.p7A;__webpackgi_exports__.dd2;__webpackgi_exports__.CP7;__webpackgi_exports__.fQK;__webpackgi_exports__.Wd$;__webpackgi_exports__.t1_;__webpackgi_exports__.Uk6;__webpackgi_exports__._sL;__webpackgi_exports__.Pnf;__webpackgi_exports__.c8b;__webpackgi_exports__._lf;__webpackgi_exports__.ad5;__webpackgi_exports__.sZV;__webpackgi_exports__.TfA;__webpackgi_exports__.sKX;__webpackgi_exports__.UdM;__webpackgi_exports__.P0y;__webpackgi_exports__.L_r;__webpackgi_exports__.Bve;__webpackgi_exports__.UeO;__webpackgi_exports__.$nx;__webpackgi_exports__.Bk6;__webpackgi_exports__.y4l;__webpackgi_exports__.pQ0;__webpackgi_exports__.wXW;__webpackgi_exports__.r5x;__webpackgi_exports__.MSI;__webpackgi_exports__.EUu;__webpackgi_exports__.jtH;__webpackgi_exports__.T0T;__webpackgi_exports__.gAb;__webpackgi_exports__.iwT;__webpackgi_exports__.je_;__webpackgi_exports__.wBP;__webpackgi_exports__.LU2;__webpackgi_exports__.wQL;__webpackgi_exports__.Zs7;__webpackgi_exports__.x7s;__webpackgi_exports__.Mnd;__webpackgi_exports__.A0_;__webpackgi_exports__.d73;__webpackgi_exports__.HCD;__webpackgi_exports__.RG9;__webpackgi_exports__.G2P;__webpackgi_exports__.XLf;__webpackgi_exports__.CGN;__webpackgi_exports__.mvg;__webpackgi_exports__.Hiy;__webpackgi_exports__.XMc;__webpackgi_exports__.N7M;__webpackgi_exports__.iv;__webpackgi_exports__.n55;__webpackgi_exports__.IaC;__webpackgi_exports__.h9t;__webpackgi_exports__.yDW;__webpackgi_exports__.gJv;__webpackgi_exports__.l$g;__webpackgi_exports__.vQi;__webpackgi_exports__.$MY;__webpackgi_exports__.wJl;__webpackgi_exports__.Z7Y;__webpackgi_exports__.X7D;__webpackgi_exports__.BnX;__webpackgi_exports__.uZ5;__webpackgi_exports__.zVI;__webpackgi_exports__.DpF;__webpackgi_exports__.nNb;__webpackgi_exports__.cqZ;__webpackgi_exports__.pKN;__webpackgi_exports__.d_$;__webpackgi_exports__.DdI;__webpackgi_exports__.rrX;__webpackgi_exports__.KlC;__webpackgi_exports__.KVn;__webpackgi_exports__.oau;__webpackgi_exports__.aw9;__webpackgi_exports__.Aap;__webpackgi_exports__.Dxg;__webpackgi_exports__.MjT;__webpackgi_exports__.F7Q;__webpackgi_exports__.IFq;__webpackgi_exports__.IJl;__webpackgi_exports__.O5A;__webpackgi_exports__.wCn;__webpackgi_exports__.gGT;__webpackgi_exports__.pEc;__webpackgi_exports__.Bi6;__webpackgi_exports__.fi_;__webpackgi_exports__.TT;__webpackgi_exports__.q2Z;__webpackgi_exports__.NyK;__webpackgi_exports__.bgu;__webpackgi_exports__.kcS;__webpackgi_exports__.rRN;__webpackgi_exports__.ivY;__webpackgi_exports__._s1;__webpackgi_exports__._HO;__webpackgi_exports__.tpL;__webpackgi_exports__.DMK;__webpackgi_exports__.LjN;__webpackgi_exports__.iFs;__webpackgi_exports__.qTg;__webpackgi_exports__.Wtl;__webpackgi_exports__.DmK;__webpackgi_exports__.Htt;__webpackgi_exports__.Hx7;__webpackgi_exports__.imt;__webpackgi_exports__.US6;__webpackgi_exports__.vZs;__webpackgi_exports__.TE$;__webpackgi_exports__.lmu;__webpackgi_exports__.SvO;__webpackgi_exports__.YQY;__webpackgi_exports__.mZN;__webpackgi_exports__.VvG;__webpackgi_exports__.omp;__webpackgi_exports__.utz;__webpackgi_exports__.TFV;__webpackgi_exports__.hrz;__webpackgi_exports__.JKM;__webpackgi_exports__.jZf;__webpackgi_exports__.RjL;__webpackgi_exports__.RRI;__webpackgi_exports__.RUq;__webpackgi_exports__._t4;__webpackgi_exports__.YHh;__webpackgi_exports__.R8g;__webpackgi_exports__.Bbl;__webpackgi_exports__.V9r;__webpackgi_exports__.PZ2;__webpackgi_exports__.w7A;__webpackgi_exports__.N6S;__webpackgi_exports__.Uxp;__webpackgi_exports__.tAz;__webpackgi_exports__.R$F;__webpackgi_exports__.N33;__webpackgi_exports__.gw2;__webpackgi_exports__.KlU;__webpackgi_exports__.wo6;__webpackgi_exports__.H4P;__webpackgi_exports__.swA;__webpackgi_exports__._Z3;__webpackgi_exports__.ivc;__webpackgi_exports__.rZ1;__webpackgi_exports__.CpZ;__webpackgi_exports__.dyc;__webpackgi_exports__.MxZ;__webpackgi_exports__.btp;__webpackgi_exports__.mXy;__webpackgi_exports__.Ej0;__webpackgi_exports__.ep4;__webpackgi_exports__.DQP;__webpackgi_exports__.VNr;__webpackgi_exports__.V7q;__webpackgi_exports__.zEk;__webpackgi_exports__.qfq;__webpackgi_exports__.piB;__webpackgi_exports__.IIc;__webpackgi_exports__.rrF;__webpackgi_exports__.naq;__webpackgi_exports__.sXR;__webpackgi_exports__.p5I;__webpackgi_exports__.wps;__webpackgi_exports__.wuo;__webpackgi_exports__.GpE;__webpackgi_exports__.F4b;__webpackgi_exports__.t$v;__webpackgi_exports__.tdn;__webpackgi_exports__.Y9t;__webpackgi_exports__.GEo;__webpackgi_exports__.DH3;__webpackgi_exports__.uxM;__webpackgi_exports__.zH3;__webpackgi_exports__.MLs;__webpackgi_exports__.xXG;__webpackgi_exports__.YM4;__webpackgi_exports__.B3r;__webpackgi_exports__.iAx;__webpackgi_exports__.lDn;__webpackgi_exports__.oaQ;__webpackgi_exports__.CD7;__webpackgi_exports__.Rc0;__webpackgi_exports__.iPG;var __webpackgi_exports__mobileAndTabletCheck=__webpackgi_exports__.TIc;__webpackgi_exports__.xsC;__webpackgi_exports__.zOc;__webpackgi_exports__.r46;__webpackgi_exports__.z2C;__webpackgi_exports__._X$;__webpackgi_exports__._yn;__webpackgi_exports__.Dyg;__webpackgi_exports__.cUc;__webpackgi_exports__.zGw;__webpackgi_exports__.Ctq;__webpackgi_exports__.$ch;__webpackgi_exports__.k5b;__webpackgi_exports__.kZl;__webpackgi_exports__.OCg;__webpackgi_exports__.YjH;__webpackgi_exports__.Ui8;__webpackgi_exports__.YD2;__webpackgi_exports__.vi9;__webpackgi_exports__.ij3;__webpackgi_exports__.YPW;__webpackgi_exports__.Bg1;__webpackgi_exports__.kon;__webpackgi_exports__.M3g;__webpackgi_exports__.F2z;__webpackgi_exports__.pJF;__webpackgi_exports__.knz;__webpackgi_exports__.Ejo;__webpackgi_exports__.BgY;__webpackgi_exports__.qCG;__webpackgi_exports__.HD9;__webpackgi_exports__.fEB;__webpackgi_exports__.Udc;__webpackgi_exports__.ZQg;__webpackgi_exports__.ofC;__webpackgi_exports__.yRy;__webpackgi_exports__._NL;__webpackgi_exports__.LCA;__webpackgi_exports__.j1w;__webpackgi_exports__.i8J;__webpackgi_exports__.p7C;__webpackgi_exports__.ZAS;__webpackgi_exports__.ipH;__webpackgi_exports__.$TF;__webpackgi_exports__.uZI;__webpackgi_exports__.VWG;__webpackgi_exports__.pQ7;__webpackgi_exports__.STw;__webpackgi_exports__.jc8;__webpackgi_exports__.BL_;__webpackgi_exports__.S6;__webpackgi_exports__.T8U;__webpackgi_exports__.TD6;__webpackgi_exports__.akS;__webpackgi_exports__.QKE;__webpackgi_exports__.dKx;__webpackgi_exports__.OvX;__webpackgi_exports__.VsW;__webpackgi_exports__.YMc;__webpackgi_exports__.aPg;__webpackgi_exports__.LFn;__webpackgi_exports__.wey;__webpackgi_exports__.MaE;__webpackgi_exports__.s4x;__webpackgi_exports__.FJA;__webpackgi_exports__.vIA;__webpackgi_exports__.Spv;__webpackgi_exports__.w8l;__webpackgi_exports__.riG;__webpackgi_exports__.Kbh;__webpackgi_exports__.t8K;__webpackgi_exports__.Q7n;__webpackgi_exports__.KGF;__webpackgi_exports__.e5;__webpackgi_exports__.Rik;__webpackgi_exports__.GZo;__webpackgi_exports__.Bds;__webpackgi_exports__.HTu;__webpackgi_exports__.cTq;__webpackgi_exports__.X_Y;__webpackgi_exports__.dA8;__webpackgi_exports__.bwS;__webpackgi_exports__.Lks;__webpackgi_exports__.Rvq;__webpackgi_exports__.P4F;__webpackgi_exports__.Pd0;__webpackgi_exports__.Pjo;__webpackgi_exports__.Tum;__webpackgi_exports__.dRH;__webpackgi_exports__.RX0;__webpackgi_exports__.reQ;__webpackgi_exports__.cWm;__webpackgi_exports__.NC9;__webpackgi_exports__.$Re;__webpackgi_exports__.Xo9;__webpackgi_exports__.LNO;__webpackgi_exports__.iZP;function _assertThisInitialized($){if($===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $}function _inheritsLoose($,j){$.prototype=Object.create(j.prototype),$.prototype.constructor=$,$.__proto__=j}/*!
 * GSAP 3.11.4
 * https://greensock.com
 *
 * @license Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var _config={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},_defaults$1={duration:.5,overwrite:!1,delay:0},_suppressOverwrites$1,_reverting$1,_context$2,_bigNum$1=1e8,_tinyNum=1/_bigNum$1,_2PI=Math.PI*2,_HALF_PI=_2PI/4,_gsID=0,_sqrt=Math.sqrt,_cos=Math.cos,_sin=Math.sin,_isString$1=function $(j){return typeof j=="string"},_isFunction$1=function $(j){return typeof j=="function"},_isNumber$1=function $(j){return typeof j=="number"},_isUndefined=function $(j){return typeof j>"u"},_isObject$1=function $(j){return typeof j=="object"},_isNotFalse=function $(j){return j!==!1},_windowExists$2=function $(){return typeof window<"u"},_isFuncOrString=function $(j){return _isFunction$1(j)||_isString$1(j)},_isTypedArray=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},_isArray=Array.isArray,_strictNumExp=/(?:-?\.?\d|\.)+/gi,_numExp=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,_numWithUnitExp=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,_complexStringNumExp=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,_relExp=/[+-]=-?[.\d]+/,_delimitedValueExp=/[^,'"\[\]\s]+/gi,_unitExp=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,_globalTimeline,_win$3,_coreInitted$2,_doc$3,_globals={},_installScope={},_coreReady,_install=function $(j){return(_installScope=_merge(j,_globals))&&gsap$2},_missingPlugin=function $(j,it){return console.warn("Invalid property",j,"set to",it,"Missing plugin? gsap.registerPlugin()")},_warn=function $(j,it){return!it&&console.warn(j)},_addGlobal=function $(j,it){return j&&(_globals[j]=it)&&_installScope&&(_installScope[j]=it)||_globals},_emptyFunc=function $(){return 0},_startAtRevertConfig={suppressEvents:!0,isStart:!0,kill:!1},_revertConfigNoKill={suppressEvents:!0,kill:!1},_revertConfig={suppressEvents:!0},_reservedProps={},_lazyTweens=[],_lazyLookup={},_lastRenderedFrame,_plugins={},_effects={},_nextGCFrame=30,_harnessPlugins=[],_callbackNames="",_harness=function $(j){var it=j[0],et,ut;if(_isObject$1(it)||_isFunction$1(it)||(j=[j]),!(et=(it._gsap||{}).harness)){for(ut=_harnessPlugins.length;ut--&&!_harnessPlugins[ut].targetTest(it););et=_harnessPlugins[ut]}for(ut=j.length;ut--;)j[ut]&&(j[ut]._gsap||(j[ut]._gsap=new GSCache(j[ut],et)))||j.splice(ut,1);return j},_getCache=function $(j){return j._gsap||_harness(toArray(j))[0]._gsap},_getProperty=function $(j,it,et){return(et=j[it])&&_isFunction$1(et)?j[it]():_isUndefined(et)&&j.getAttribute&&j.getAttribute(it)||et},_forEachName=function $(j,it){return(j=j.split(",")).forEach(it)||j},_round$1=function $(j){return Math.round(j*1e5)/1e5||0},_roundPrecise=function $(j){return Math.round(j*1e7)/1e7||0},_parseRelative=function $(j,it){var et=it.charAt(0),ut=parseFloat(it.substr(2));return j=parseFloat(j),et==="+"?j+ut:et==="-"?j-ut:et==="*"?j*ut:j/ut},_arrayContainsAny=function $(j,it){for(var et=it.length,ut=0;j.indexOf(it[ut])<0&&++ut<et;);return ut<et},_lazyRender=function $(){var j=_lazyTweens.length,it=_lazyTweens.slice(0),et,ut;for(_lazyLookup={},_lazyTweens.length=0,et=0;et<j;et++)ut=it[et],ut&&ut._lazy&&(ut.render(ut._lazy[0],ut._lazy[1],!0)._lazy=0)},_lazySafeRender=function $(j,it,et,ut){_lazyTweens.length&&!_reverting$1&&_lazyRender(),j.render(it,et,ut||_reverting$1&&it<0&&(j._initted||j._startAt)),_lazyTweens.length&&!_reverting$1&&_lazyRender()},_numericIfPossible=function $(j){var it=parseFloat(j);return(it||it===0)&&(j+"").match(_delimitedValueExp).length<2?it:_isString$1(j)?j.trim():j},_passThrough$1=function $(j){return j},_setDefaults$1=function $(j,it){for(var et in it)et in j||(j[et]=it[et]);return j},_setKeyframeDefaults=function $(j){return function(it,et){for(var ut in et)ut in it||ut==="duration"&&j||ut==="ease"||(it[ut]=et[ut])}},_merge=function $(j,it){for(var et in it)j[et]=it[et];return j},_mergeDeep=function $(j,it){for(var et in it)et!=="__proto__"&&et!=="constructor"&&et!=="prototype"&&(j[et]=_isObject$1(it[et])?$(j[et]||(j[et]={}),it[et]):it[et]);return j},_copyExcluding=function $(j,it){var et={},ut;for(ut in j)ut in it||(et[ut]=j[ut]);return et},_inheritDefaults=function $(j){var it=j.parent||_globalTimeline,et=j.keyframes?_setKeyframeDefaults(_isArray(j.keyframes)):_setDefaults$1;if(_isNotFalse(j.inherit))for(;it;)et(j,it.vars.defaults),it=it.parent||it._dp;return j},_arraysMatch=function $(j,it){for(var et=j.length,ut=et===it.length;ut&&et--&&j[et]===it[et];);return et<0},_addLinkedListItem=function $(j,it,et,ut,dt){et===void 0&&(et="_first"),ut===void 0&&(ut="_last");var mt=j[ut],yt;if(dt)for(yt=it[dt];mt&&mt[dt]>yt;)mt=mt._prev;return mt?(it._next=mt._next,mt._next=it):(it._next=j[et],j[et]=it),it._next?it._next._prev=it:j[ut]=it,it._prev=mt,it.parent=it._dp=j,it},_removeLinkedListItem=function $(j,it,et,ut){et===void 0&&(et="_first"),ut===void 0&&(ut="_last");var dt=it._prev,mt=it._next;dt?dt._next=mt:j[et]===it&&(j[et]=mt),mt?mt._prev=dt:j[ut]===it&&(j[ut]=dt),it._next=it._prev=it.parent=null},_removeFromParent=function $(j,it){j.parent&&(!it||j.parent.autoRemoveChildren)&&j.parent.remove(j),j._act=0},_uncache=function $(j,it){if(j&&(!it||it._end>j._dur||it._start<0))for(var et=j;et;)et._dirty=1,et=et.parent;return j},_recacheAncestors=function $(j){for(var it=j.parent;it&&it.parent;)it._dirty=1,it.totalDuration(),it=it.parent;return j},_rewindStartAt=function $(j,it,et,ut){return j._startAt&&(_reverting$1?j._startAt.revert(_revertConfigNoKill):j.vars.immediateRender&&!j.vars.autoRevert||j._startAt.render(it,!0,ut))},_hasNoPausedAncestors=function $(j){return!j||j._ts&&$(j.parent)},_elapsedCycleDuration=function $(j){return j._repeat?_animationCycle(j._tTime,j=j.duration()+j._rDelay)*j:0},_animationCycle=function $(j,it){var et=Math.floor(j/=it);return j&&et===j?et-1:et},_parentToChildTotalTime=function $(j,it){return(j-it._start)*it._ts+(it._ts>=0?0:it._dirty?it.totalDuration():it._tDur)},_setEnd=function $(j){return j._end=_roundPrecise(j._start+(j._tDur/Math.abs(j._ts||j._rts||_tinyNum)||0))},_alignPlayhead=function $(j,it){var et=j._dp;return et&&et.smoothChildTiming&&j._ts&&(j._start=_roundPrecise(et._time-(j._ts>0?it/j._ts:((j._dirty?j.totalDuration():j._tDur)-it)/-j._ts)),_setEnd(j),et._dirty||_uncache(et,j)),j},_postAddChecks=function $(j,it){var et;if((it._time||it._initted&&!it._dur)&&(et=_parentToChildTotalTime(j.rawTime(),it),(!it._dur||_clamp$1(0,it.totalDuration(),et)-it._tTime>_tinyNum)&&it.render(et,!0)),_uncache(j,it)._dp&&j._initted&&j._time>=j._dur&&j._ts){if(j._dur<j.duration())for(et=j;et._dp;)et.rawTime()>=0&&et.totalTime(et._tTime),et=et._dp;j._zTime=-_tinyNum}},_addToTimeline=function $(j,it,et,ut){return it.parent&&_removeFromParent(it),it._start=_roundPrecise((_isNumber$1(et)?et:et||j!==_globalTimeline?_parsePosition$1(j,et,it):j._time)+it._delay),it._end=_roundPrecise(it._start+(it.totalDuration()/Math.abs(it.timeScale())||0)),_addLinkedListItem(j,it,"_first","_last",j._sort?"_start":0),_isFromOrFromStart(it)||(j._recent=it),ut||_postAddChecks(j,it),j._ts<0&&_alignPlayhead(j,j._tTime),j},_scrollTrigger=function $(j,it){return(_globals.ScrollTrigger||_missingPlugin("scrollTrigger",it))&&_globals.ScrollTrigger.create(it,j)},_attemptInitTween=function $(j,it,et,ut,dt){if(_initTween(j,it,dt),!j._initted)return 1;if(!et&&j._pt&&!_reverting$1&&(j._dur&&j.vars.lazy!==!1||!j._dur&&j.vars.lazy)&&_lastRenderedFrame!==_ticker.frame)return _lazyTweens.push(j),j._lazy=[dt,ut],1},_parentPlayheadIsBeforeStart=function $(j){var it=j.parent;return it&&it._ts&&it._initted&&!it._lock&&(it.rawTime()<0||$(it))},_isFromOrFromStart=function $(j){var it=j.data;return it==="isFromStart"||it==="isStart"},_renderZeroDurationTween=function $(j,it,et,ut){var dt=j.ratio,mt=it<0||!it&&(!j._start&&_parentPlayheadIsBeforeStart(j)&&!(!j._initted&&_isFromOrFromStart(j))||(j._ts<0||j._dp._ts<0)&&!_isFromOrFromStart(j))?0:1,yt=j._rDelay,bt=0,Rt,jt,Vt;if(yt&&j._repeat&&(bt=_clamp$1(0,j._tDur,it),jt=_animationCycle(bt,yt),j._yoyo&&jt&1&&(mt=1-mt),jt!==_animationCycle(j._tTime,yt)&&(dt=1-mt,j.vars.repeatRefresh&&j._initted&&j.invalidate())),mt!==dt||_reverting$1||ut||j._zTime===_tinyNum||!it&&j._zTime){if(!j._initted&&_attemptInitTween(j,it,ut,et,bt))return;for(Vt=j._zTime,j._zTime=it||(et?_tinyNum:0),et||(et=it&&!Vt),j.ratio=mt,j._from&&(mt=1-mt),j._time=0,j._tTime=bt,Rt=j._pt;Rt;)Rt.r(mt,Rt.d),Rt=Rt._next;it<0&&_rewindStartAt(j,it,et,!0),j._onUpdate&&!et&&_callback$1(j,"onUpdate"),bt&&j._repeat&&!et&&j.parent&&_callback$1(j,"onRepeat"),(it>=j._tDur||it<0)&&j.ratio===mt&&(mt&&_removeFromParent(j,1),!et&&!_reverting$1&&(_callback$1(j,mt?"onComplete":"onReverseComplete",!0),j._prom&&j._prom()))}else j._zTime||(j._zTime=it)},_findNextPauseTween=function $(j,it,et){var ut;if(et>it)for(ut=j._first;ut&&ut._start<=et;){if(ut.data==="isPause"&&ut._start>it)return ut;ut=ut._next}else for(ut=j._last;ut&&ut._start>=et;){if(ut.data==="isPause"&&ut._start<it)return ut;ut=ut._prev}},_setDuration=function $(j,it,et,ut){var dt=j._repeat,mt=_roundPrecise(it)||0,yt=j._tTime/j._tDur;return yt&&!ut&&(j._time*=mt/j._dur),j._dur=mt,j._tDur=dt?dt<0?1e10:_roundPrecise(mt*(dt+1)+j._rDelay*dt):mt,yt>0&&!ut&&_alignPlayhead(j,j._tTime=j._tDur*yt),j.parent&&_setEnd(j),et||_uncache(j.parent,j),j},_onUpdateTotalDuration=function $(j){return j instanceof Timeline?_uncache(j):_setDuration(j,j._dur)},_zeroPosition={_start:0,endTime:_emptyFunc,totalDuration:_emptyFunc},_parsePosition$1=function $(j,it,et){var ut=j.labels,dt=j._recent||_zeroPosition,mt=j.duration()>=_bigNum$1?dt.endTime(!1):j._dur,yt,bt,Rt;return _isString$1(it)&&(isNaN(it)||it in ut)?(bt=it.charAt(0),Rt=it.substr(-1)==="%",yt=it.indexOf("="),bt==="<"||bt===">"?(yt>=0&&(it=it.replace(/=/,"")),(bt==="<"?dt._start:dt.endTime(dt._repeat>=0))+(parseFloat(it.substr(1))||0)*(Rt?(yt<0?dt:et).totalDuration()/100:1)):yt<0?(it in ut||(ut[it]=mt),ut[it]):(bt=parseFloat(it.charAt(yt-1)+it.substr(yt+1)),Rt&&et&&(bt=bt/100*(_isArray(et)?et[0]:et).totalDuration()),yt>1?$(j,it.substr(0,yt-1),et)+bt:mt+bt)):it==null?mt:+it},_createTweenType=function $(j,it,et){var ut=_isNumber$1(it[1]),dt=(ut?2:1)+(j<2?0:1),mt=it[dt],yt,bt;if(ut&&(mt.duration=it[1]),mt.parent=et,j){for(yt=mt,bt=et;bt&&!("immediateRender"in yt);)yt=bt.vars.defaults||{},bt=_isNotFalse(bt.vars.inherit)&&bt.parent;mt.immediateRender=_isNotFalse(yt.immediateRender),j<2?mt.runBackwards=1:mt.startAt=it[dt-1]}return new Tween(it[0],mt,it[dt+1])},_conditionalReturn=function $(j,it){return j||j===0?it(j):it},_clamp$1=function $(j,it,et){return et<j?j:et>it?it:et},getUnit=function $(j,it){return!_isString$1(j)||!(it=_unitExp.exec(j))?"":it[1]},clamp=function $(j,it,et){return _conditionalReturn(et,function(ut){return _clamp$1(j,it,ut)})},_slice=[].slice,_isArrayLike=function $(j,it){return j&&_isObject$1(j)&&"length"in j&&(!it&&!j.length||j.length-1 in j&&_isObject$1(j[0]))&&!j.nodeType&&j!==_win$3},_flatten=function $(j,it,et){return et===void 0&&(et=[]),j.forEach(function(ut){var dt;return _isString$1(ut)&&!it||_isArrayLike(ut,1)?(dt=et).push.apply(dt,toArray(ut)):et.push(ut)})||et},toArray=function $(j,it,et){return _context$2&&!it&&_context$2.selector?_context$2.selector(j):_isString$1(j)&&!et&&(_coreInitted$2||!_wake())?_slice.call((it||_doc$3).querySelectorAll(j),0):_isArray(j)?_flatten(j,et):_isArrayLike(j)?_slice.call(j,0):j?[j]:[]},selector$1=function $(j){return j=toArray(j)[0]||_warn("Invalid scope")||{},function(it){var et=j.current||j.nativeElement||j;return toArray(it,et.querySelectorAll?et:et===j?_warn("Invalid scope")||_doc$3.createElement("div"):j)}},shuffle=function $(j){return j.sort(function(){return .5-Math.random()})},distribute=function $(j){if(_isFunction$1(j))return j;var it=_isObject$1(j)?j:{each:j},et=_parseEase(it.ease),ut=it.from||0,dt=parseFloat(it.base)||0,mt={},yt=ut>0&&ut<1,bt=isNaN(ut)||yt,Rt=it.axis,jt=ut,Vt=ut;return _isString$1(ut)?jt=Vt={center:.5,edges:.5,end:1}[ut]||0:!yt&&bt&&(jt=ut[0],Vt=ut[1]),function(zt,Jt,rr){var Yt=(rr||it).length,dr=mt[Yt],Ft,Ht,er,pr,or,ar,Wt,Zt,sr;if(!dr){if(sr=it.grid==="auto"?0:(it.grid||[1,_bigNum$1])[1],!sr){for(Wt=-_bigNum$1;Wt<(Wt=rr[sr++].getBoundingClientRect().left)&&sr<Yt;);sr--}for(dr=mt[Yt]=[],Ft=bt?Math.min(sr,Yt)*jt-.5:ut%sr,Ht=sr===_bigNum$1?0:bt?Yt*Vt/sr-.5:ut/sr|0,Wt=0,Zt=_bigNum$1,ar=0;ar<Yt;ar++)er=ar%sr-Ft,pr=Ht-(ar/sr|0),dr[ar]=or=Rt?Math.abs(Rt==="y"?pr:er):_sqrt(er*er+pr*pr),or>Wt&&(Wt=or),or<Zt&&(Zt=or);ut==="random"&&shuffle(dr),dr.max=Wt-Zt,dr.min=Zt,dr.v=Yt=(parseFloat(it.amount)||parseFloat(it.each)*(sr>Yt?Yt-1:Rt?Rt==="y"?Yt/sr:sr:Math.max(sr,Yt/sr))||0)*(ut==="edges"?-1:1),dr.b=Yt<0?dt-Yt:dt,dr.u=getUnit(it.amount||it.each)||0,et=et&&Yt<0?_invertEase(et):et}return Yt=(dr[zt]-dr.min)/dr.max||0,_roundPrecise(dr.b+(et?et(Yt):Yt)*dr.v)+dr.u}},_roundModifier=function $(j){var it=Math.pow(10,((j+"").split(".")[1]||"").length);return function(et){var ut=_roundPrecise(Math.round(parseFloat(et)/j)*j*it);return(ut-ut%1)/it+(_isNumber$1(et)?0:getUnit(et))}},snap=function $(j,it){var et=_isArray(j),ut,dt;return!et&&_isObject$1(j)&&(ut=et=j.radius||_bigNum$1,j.values?(j=toArray(j.values),(dt=!_isNumber$1(j[0]))&&(ut*=ut)):j=_roundModifier(j.increment)),_conditionalReturn(it,et?_isFunction$1(j)?function(mt){return dt=j(mt),Math.abs(dt-mt)<=ut?dt:mt}:function(mt){for(var yt=parseFloat(dt?mt.x:mt),bt=parseFloat(dt?mt.y:0),Rt=_bigNum$1,jt=0,Vt=j.length,zt,Jt;Vt--;)dt?(zt=j[Vt].x-yt,Jt=j[Vt].y-bt,zt=zt*zt+Jt*Jt):zt=Math.abs(j[Vt]-yt),zt<Rt&&(Rt=zt,jt=Vt);return jt=!ut||Rt<=ut?j[jt]:mt,dt||jt===mt||_isNumber$1(mt)?jt:jt+getUnit(mt)}:_roundModifier(j))},random=function $(j,it,et,ut){return _conditionalReturn(_isArray(j)?!it:et===!0?!!(et=0):!ut,function(){return _isArray(j)?j[~~(Math.random()*j.length)]:(et=et||1e-5)&&(ut=et<1?Math.pow(10,(et+"").length-2):1)&&Math.floor(Math.round((j-et/2+Math.random()*(it-j+et*.99))/et)*et*ut)/ut})},pipe=function $(){for(var j=arguments.length,it=new Array(j),et=0;et<j;et++)it[et]=arguments[et];return function(ut){return it.reduce(function(dt,mt){return mt(dt)},ut)}},unitize=function $(j,it){return function(et){return j(parseFloat(et))+(it||getUnit(et))}},normalize$1=function $(j,it,et){return mapRange(j,it,0,1,et)},_wrapArray=function $(j,it,et){return _conditionalReturn(et,function(ut){return j[~~it(ut)]})},wrap=function $(j,it,et){var ut=it-j;return _isArray(j)?_wrapArray(j,$(0,j.length),it):_conditionalReturn(et,function(dt){return(ut+(dt-j)%ut)%ut+j})},wrapYoyo=function $(j,it,et){var ut=it-j,dt=ut*2;return _isArray(j)?_wrapArray(j,$(0,j.length-1),it):_conditionalReturn(et,function(mt){return mt=(dt+(mt-j)%dt)%dt||0,j+(mt>ut?dt-mt:mt)})},_replaceRandom=function $(j){for(var it=0,et="",ut,dt,mt,yt;~(ut=j.indexOf("random(",it));)mt=j.indexOf(")",ut),yt=j.charAt(ut+7)==="[",dt=j.substr(ut+7,mt-ut-7).match(yt?_delimitedValueExp:_strictNumExp),et+=j.substr(it,ut-it)+random(yt?dt:+dt[0],yt?0:+dt[1],+dt[2]||1e-5),it=mt+1;return et+j.substr(it,j.length-it)},mapRange=function $(j,it,et,ut,dt){var mt=it-j,yt=ut-et;return _conditionalReturn(dt,function(bt){return et+((bt-j)/mt*yt||0)})},interpolate=function $(j,it,et,ut){var dt=isNaN(j+it)?0:function(Jt){return(1-Jt)*j+Jt*it};if(!dt){var mt=_isString$1(j),yt={},bt,Rt,jt,Vt,zt;if(et===!0&&(ut=1)&&(et=null),mt)j={p:j},it={p:it};else if(_isArray(j)&&!_isArray(it)){for(jt=[],Vt=j.length,zt=Vt-2,Rt=1;Rt<Vt;Rt++)jt.push($(j[Rt-1],j[Rt]));Vt--,dt=function(rr){rr*=Vt;var Yt=Math.min(zt,~~rr);return jt[Yt](rr-Yt)},et=it}else ut||(j=_merge(_isArray(j)?[]:{},j));if(!jt){for(bt in it)_addPropTween.call(yt,j,bt,"get",it[bt]);dt=function(rr){return _renderPropTweens(rr,yt)||(mt?j.p:j)}}}return _conditionalReturn(et,dt)},_getLabelInDirection=function $(j,it,et){var ut=j.labels,dt=_bigNum$1,mt,yt,bt;for(mt in ut)yt=ut[mt]-it,yt<0==!!et&&yt&&dt>(yt=Math.abs(yt))&&(bt=mt,dt=yt);return bt},_callback$1=function $(j,it,et){var ut=j.vars,dt=ut[it],mt=_context$2,yt=j._ctx,bt,Rt,jt;if(dt)return bt=ut[it+"Params"],Rt=ut.callbackScope||j,et&&_lazyTweens.length&&_lazyRender(),yt&&(_context$2=yt),jt=bt?dt.apply(Rt,bt):dt.call(Rt),_context$2=mt,jt},_interrupt=function $(j){return _removeFromParent(j),j.scrollTrigger&&j.scrollTrigger.kill(!!_reverting$1),j.progress()<1&&_callback$1(j,"onInterrupt"),j},_quickTween,_createPlugin=function $(j){j=!j.name&&j.default||j;var it=j.name,et=_isFunction$1(j),ut=it&&!et&&j.init?function(){this._props=[]}:j,dt={init:_emptyFunc,render:_renderPropTweens,add:_addPropTween,kill:_killPropTweensOf,modifier:_addPluginModifier,rawVars:0},mt={targetTest:0,get:0,getSetter:_getSetter,aliases:{},register:0};if(_wake(),j!==ut){if(_plugins[it])return;_setDefaults$1(ut,_setDefaults$1(_copyExcluding(j,dt),mt)),_merge(ut.prototype,_merge(dt,_copyExcluding(j,mt))),_plugins[ut.prop=it]=ut,j.targetTest&&(_harnessPlugins.push(ut),_reservedProps[it]=1),it=(it==="css"?"CSS":it.charAt(0).toUpperCase()+it.substr(1))+"Plugin"}_addGlobal(it,ut),j.register&&j.register(gsap$2,ut,PropTween)},_255=255,_colorLookup={aqua:[0,_255,_255],lime:[0,_255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,_255],navy:[0,0,128],white:[_255,_255,_255],olive:[128,128,0],yellow:[_255,_255,0],orange:[_255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[_255,0,0],pink:[_255,192,203],cyan:[0,_255,_255],transparent:[_255,_255,_255,0]},_hue=function $(j,it,et){return j+=j<0?1:j>1?-1:0,(j*6<1?it+(et-it)*j*6:j<.5?et:j*3<2?it+(et-it)*(2/3-j)*6:it)*_255+.5|0},splitColor=function $(j,it,et){var ut=j?_isNumber$1(j)?[j>>16,j>>8&_255,j&_255]:0:_colorLookup.black,dt,mt,yt,bt,Rt,jt,Vt,zt,Jt,rr;if(!ut){if(j.substr(-1)===","&&(j=j.substr(0,j.length-1)),_colorLookup[j])ut=_colorLookup[j];else if(j.charAt(0)==="#"){if(j.length<6&&(dt=j.charAt(1),mt=j.charAt(2),yt=j.charAt(3),j="#"+dt+dt+mt+mt+yt+yt+(j.length===5?j.charAt(4)+j.charAt(4):"")),j.length===9)return ut=parseInt(j.substr(1,6),16),[ut>>16,ut>>8&_255,ut&_255,parseInt(j.substr(7),16)/255];j=parseInt(j.substr(1),16),ut=[j>>16,j>>8&_255,j&_255]}else if(j.substr(0,3)==="hsl"){if(ut=rr=j.match(_strictNumExp),!it)bt=+ut[0]%360/360,Rt=+ut[1]/100,jt=+ut[2]/100,mt=jt<=.5?jt*(Rt+1):jt+Rt-jt*Rt,dt=jt*2-mt,ut.length>3&&(ut[3]*=1),ut[0]=_hue(bt+1/3,dt,mt),ut[1]=_hue(bt,dt,mt),ut[2]=_hue(bt-1/3,dt,mt);else if(~j.indexOf("="))return ut=j.match(_numExp),et&&ut.length<4&&(ut[3]=1),ut}else ut=j.match(_strictNumExp)||_colorLookup.transparent;ut=ut.map(Number)}return it&&!rr&&(dt=ut[0]/_255,mt=ut[1]/_255,yt=ut[2]/_255,Vt=Math.max(dt,mt,yt),zt=Math.min(dt,mt,yt),jt=(Vt+zt)/2,Vt===zt?bt=Rt=0:(Jt=Vt-zt,Rt=jt>.5?Jt/(2-Vt-zt):Jt/(Vt+zt),bt=Vt===dt?(mt-yt)/Jt+(mt<yt?6:0):Vt===mt?(yt-dt)/Jt+2:(dt-mt)/Jt+4,bt*=60),ut[0]=~~(bt+.5),ut[1]=~~(Rt*100+.5),ut[2]=~~(jt*100+.5)),et&&ut.length<4&&(ut[3]=1),ut},_colorOrderData=function $(j){var it=[],et=[],ut=-1;return j.split(_colorExp).forEach(function(dt){var mt=dt.match(_numWithUnitExp)||[];it.push.apply(it,mt),et.push(ut+=mt.length+1)}),it.c=et,it},_formatColors=function $(j,it,et){var ut="",dt=(j+ut).match(_colorExp),mt=it?"hsla(":"rgba(",yt=0,bt,Rt,jt,Vt;if(!dt)return j;if(dt=dt.map(function(zt){return(zt=splitColor(zt,it,1))&&mt+(it?zt[0]+","+zt[1]+"%,"+zt[2]+"%,"+zt[3]:zt.join(","))+")"}),et&&(jt=_colorOrderData(j),bt=et.c,bt.join(ut)!==jt.c.join(ut)))for(Rt=j.replace(_colorExp,"1").split(_numWithUnitExp),Vt=Rt.length-1;yt<Vt;yt++)ut+=Rt[yt]+(~bt.indexOf(yt)?dt.shift()||mt+"0,0,0,0)":(jt.length?jt:dt.length?dt:et).shift());if(!Rt)for(Rt=j.split(_colorExp),Vt=Rt.length-1;yt<Vt;yt++)ut+=Rt[yt]+dt[yt];return ut+Rt[Vt]},_colorExp=function(){var $="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",j;for(j in _colorLookup)$+="|"+j+"\\b";return new RegExp($+")","gi")}(),_hslExp=/hsl[a]?\(/,_colorStringFilter=function $(j){var it=j.join(" "),et;if(_colorExp.lastIndex=0,_colorExp.test(it))return et=_hslExp.test(it),j[1]=_formatColors(j[1],et),j[0]=_formatColors(j[0],et,_colorOrderData(j[1])),!0},_tickerActive,_ticker=function(){var $=Date.now,j=500,it=33,et=$(),ut=et,dt=1e3/240,mt=dt,yt=[],bt,Rt,jt,Vt,zt,Jt,rr=function Yt(dr){var Ft=$()-ut,Ht=dr===!0,er,pr,or,ar;if(Ft>j&&(et+=Ft-it),ut+=Ft,or=ut-et,er=or-mt,(er>0||Ht)&&(ar=++Vt.frame,zt=or-Vt.time*1e3,Vt.time=or=or/1e3,mt+=er+(er>=dt?4:dt-er),pr=1),Ht||(bt=Rt(Yt)),pr)for(Jt=0;Jt<yt.length;Jt++)yt[Jt](or,zt,ar,dr)};return Vt={time:0,frame:0,tick:function(){rr(!0)},deltaRatio:function(dr){return zt/(1e3/(dr||60))},wake:function(){_coreReady&&(!_coreInitted$2&&_windowExists$2()&&(_win$3=_coreInitted$2=window,_doc$3=_win$3.document||{},_globals.gsap=gsap$2,(_win$3.gsapVersions||(_win$3.gsapVersions=[])).push(gsap$2.version),_install(_installScope||_win$3.GreenSockGlobals||!_win$3.gsap&&_win$3||{}),jt=_win$3.requestAnimationFrame),bt&&Vt.sleep(),Rt=jt||function(dr){return setTimeout(dr,mt-Vt.time*1e3+1|0)},_tickerActive=1,rr(2))},sleep:function(){(jt?_win$3.cancelAnimationFrame:clearTimeout)(bt),_tickerActive=0,Rt=_emptyFunc},lagSmoothing:function(dr,Ft){j=dr||1/0,it=Math.min(Ft||33,j)},fps:function(dr){dt=1e3/(dr||240),mt=Vt.time*1e3+dt},add:function(dr,Ft,Ht){var er=Ft?function(pr,or,ar,Wt){dr(pr,or,ar,Wt),Vt.remove(er)}:dr;return Vt.remove(dr),yt[Ht?"unshift":"push"](er),_wake(),er},remove:function(dr,Ft){~(Ft=yt.indexOf(dr))&&yt.splice(Ft,1)&&Jt>=Ft&&Jt--},_listeners:yt},Vt}(),_wake=function $(){return!_tickerActive&&_ticker.wake()},_easeMap={},_customEaseExp=/^[\d.\-M][\d.\-,\s]/,_quotesExp=/["']/g,_parseObjectInString=function $(j){for(var it={},et=j.substr(1,j.length-3).split(":"),ut=et[0],dt=1,mt=et.length,yt,bt,Rt;dt<mt;dt++)bt=et[dt],yt=dt!==mt-1?bt.lastIndexOf(","):bt.length,Rt=bt.substr(0,yt),it[ut]=isNaN(Rt)?Rt.replace(_quotesExp,"").trim():+Rt,ut=bt.substr(yt+1).trim();return it},_valueInParentheses=function $(j){var it=j.indexOf("(")+1,et=j.indexOf(")"),ut=j.indexOf("(",it);return j.substring(it,~ut&&ut<et?j.indexOf(")",et+1):et)},_configEaseFromString=function $(j){var it=(j+"").split("("),et=_easeMap[it[0]];return et&&it.length>1&&et.config?et.config.apply(null,~j.indexOf("{")?[_parseObjectInString(it[1])]:_valueInParentheses(j).split(",").map(_numericIfPossible)):_easeMap._CE&&_customEaseExp.test(j)?_easeMap._CE("",j):et},_invertEase=function $(j){return function(it){return 1-j(1-it)}},_propagateYoyoEase=function $(j,it){for(var et=j._first,ut;et;)et instanceof Timeline?$(et,it):et.vars.yoyoEase&&(!et._yoyo||!et._repeat)&&et._yoyo!==it&&(et.timeline?$(et.timeline,it):(ut=et._ease,et._ease=et._yEase,et._yEase=ut,et._yoyo=it)),et=et._next},_parseEase=function $(j,it){return j&&(_isFunction$1(j)?j:_easeMap[j]||_configEaseFromString(j))||it},_insertEase=function $(j,it,et,ut){et===void 0&&(et=function(bt){return 1-it(1-bt)}),ut===void 0&&(ut=function(bt){return bt<.5?it(bt*2)/2:1-it((1-bt)*2)/2});var dt={easeIn:it,easeOut:et,easeInOut:ut},mt;return _forEachName(j,function(yt){_easeMap[yt]=_globals[yt]=dt,_easeMap[mt=yt.toLowerCase()]=et;for(var bt in dt)_easeMap[mt+(bt==="easeIn"?".in":bt==="easeOut"?".out":".inOut")]=_easeMap[yt+"."+bt]=dt[bt]}),dt},_easeInOutFromOut=function $(j){return function(it){return it<.5?(1-j(1-it*2))/2:.5+j((it-.5)*2)/2}},_configElastic=function $(j,it,et){var ut=it>=1?it:1,dt=(et||(j?.3:.45))/(it<1?it:1),mt=dt/_2PI*(Math.asin(1/ut)||0),yt=function(jt){return jt===1?1:ut*Math.pow(2,-10*jt)*_sin((jt-mt)*dt)+1},bt=j==="out"?yt:j==="in"?function(Rt){return 1-yt(1-Rt)}:_easeInOutFromOut(yt);return dt=_2PI/dt,bt.config=function(Rt,jt){return $(j,Rt,jt)},bt},_configBack=function $(j,it){it===void 0&&(it=1.70158);var et=function(mt){return mt?--mt*mt*((it+1)*mt+it)+1:0},ut=j==="out"?et:j==="in"?function(dt){return 1-et(1-dt)}:_easeInOutFromOut(et);return ut.config=function(dt){return $(j,dt)},ut};_forEachName("Linear,Quad,Cubic,Quart,Quint,Strong",function($,j){var it=j<5?j+1:j;_insertEase($+",Power"+(it-1),j?function(et){return Math.pow(et,it)}:function(et){return et},function(et){return 1-Math.pow(1-et,it)},function(et){return et<.5?Math.pow(et*2,it)/2:1-Math.pow((1-et)*2,it)/2})});_easeMap.Linear.easeNone=_easeMap.none=_easeMap.Linear.easeIn;_insertEase("Elastic",_configElastic("in"),_configElastic("out"),_configElastic());(function($,j){var it=1/j,et=2*it,ut=2.5*it,dt=function(yt){return yt<it?$*yt*yt:yt<et?$*Math.pow(yt-1.5/j,2)+.75:yt<ut?$*(yt-=2.25/j)*yt+.9375:$*Math.pow(yt-2.625/j,2)+.984375};_insertEase("Bounce",function(mt){return 1-dt(1-mt)},dt)})(7.5625,2.75);_insertEase("Expo",function($){return $?Math.pow(2,10*($-1)):0});_insertEase("Circ",function($){return-(_sqrt(1-$*$)-1)});_insertEase("Sine",function($){return $===1?1:-_cos($*_HALF_PI)+1});_insertEase("Back",_configBack("in"),_configBack("out"),_configBack());_easeMap.SteppedEase=_easeMap.steps=_globals.SteppedEase={config:function $(j,it){j===void 0&&(j=1);var et=1/j,ut=j+(it?0:1),dt=it?1:0,mt=1-_tinyNum;return function(yt){return((ut*_clamp$1(0,mt,yt)|0)+dt)*et}}};_defaults$1.ease=_easeMap["quad.out"];_forEachName("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function($){return _callbackNames+=$+","+$+"Params,"});var GSCache=function $(j,it){this.id=_gsID++,j._gsap=this,this.target=j,this.harness=it,this.get=it?it.get:_getProperty,this.set=it?it.getSetter:_getSetter},Animation=function(){function $(it){this.vars=it,this._delay=+it.delay||0,(this._repeat=it.repeat===1/0?-2:it.repeat||0)&&(this._rDelay=it.repeatDelay||0,this._yoyo=!!it.yoyo||!!it.yoyoEase),this._ts=1,_setDuration(this,+it.duration,1,1),this.data=it.data,_context$2&&(this._ctx=_context$2,_context$2.data.push(this)),_tickerActive||_ticker.wake()}var j=$.prototype;return j.delay=function(et){return et||et===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+et-this._delay),this._delay=et,this):this._delay},j.duration=function(et){return arguments.length?this.totalDuration(this._repeat>0?et+(et+this._rDelay)*this._repeat:et):this.totalDuration()&&this._dur},j.totalDuration=function(et){return arguments.length?(this._dirty=0,_setDuration(this,this._repeat<0?et:(et-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},j.totalTime=function(et,ut){if(_wake(),!arguments.length)return this._tTime;var dt=this._dp;if(dt&&dt.smoothChildTiming&&this._ts){for(_alignPlayhead(this,et),!dt._dp||dt.parent||_postAddChecks(dt,this);dt&&dt.parent;)dt.parent._time!==dt._start+(dt._ts>=0?dt._tTime/dt._ts:(dt.totalDuration()-dt._tTime)/-dt._ts)&&dt.totalTime(dt._tTime,!0),dt=dt.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&et<this._tDur||this._ts<0&&et>0||!this._tDur&&!et)&&_addToTimeline(this._dp,this,this._start-this._delay)}return(this._tTime!==et||!this._dur&&!ut||this._initted&&Math.abs(this._zTime)===_tinyNum||!et&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=et),_lazySafeRender(this,et,ut)),this},j.time=function(et,ut){return arguments.length?this.totalTime(Math.min(this.totalDuration(),et+_elapsedCycleDuration(this))%(this._dur+this._rDelay)||(et?this._dur:0),ut):this._time},j.totalProgress=function(et,ut){return arguments.length?this.totalTime(this.totalDuration()*et,ut):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},j.progress=function(et,ut){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-et:et)+_elapsedCycleDuration(this),ut):this.duration()?Math.min(1,this._time/this._dur):this.ratio},j.iteration=function(et,ut){var dt=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(et-1)*dt,ut):this._repeat?_animationCycle(this._tTime,dt)+1:1},j.timeScale=function(et){if(!arguments.length)return this._rts===-_tinyNum?0:this._rts;if(this._rts===et)return this;var ut=this.parent&&this._ts?_parentToChildTotalTime(this.parent._time,this):this._tTime;return this._rts=+et||0,this._ts=this._ps||et===-_tinyNum?0:this._rts,this.totalTime(_clamp$1(-this._delay,this._tDur,ut),!0),_setEnd(this),_recacheAncestors(this)},j.paused=function(et){return arguments.length?(this._ps!==et&&(this._ps=et,et?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(_wake(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==_tinyNum&&(this._tTime-=_tinyNum)))),this):this._ps},j.startTime=function(et){if(arguments.length){this._start=et;var ut=this.parent||this._dp;return ut&&(ut._sort||!this.parent)&&_addToTimeline(ut,this,et-this._delay),this}return this._start},j.endTime=function(et){return this._start+(_isNotFalse(et)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},j.rawTime=function(et){var ut=this.parent||this._dp;return ut?et&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?_parentToChildTotalTime(ut.rawTime(et),this):this._tTime:this._tTime},j.revert=function(et){et===void 0&&(et=_revertConfig);var ut=_reverting$1;return _reverting$1=et,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(et),this.totalTime(-.01,et.suppressEvents)),this.data!=="nested"&&et.kill!==!1&&this.kill(),_reverting$1=ut,this},j.globalTime=function(et){for(var ut=this,dt=arguments.length?et:ut.rawTime();ut;)dt=ut._start+dt/(ut._ts||1),ut=ut._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(et):dt},j.repeat=function(et){return arguments.length?(this._repeat=et===1/0?-2:et,_onUpdateTotalDuration(this)):this._repeat===-2?1/0:this._repeat},j.repeatDelay=function(et){if(arguments.length){var ut=this._time;return this._rDelay=et,_onUpdateTotalDuration(this),ut?this.time(ut):this}return this._rDelay},j.yoyo=function(et){return arguments.length?(this._yoyo=et,this):this._yoyo},j.seek=function(et,ut){return this.totalTime(_parsePosition$1(this,et),_isNotFalse(ut))},j.restart=function(et,ut){return this.play().totalTime(et?-this._delay:0,_isNotFalse(ut))},j.play=function(et,ut){return et!=null&&this.seek(et,ut),this.reversed(!1).paused(!1)},j.reverse=function(et,ut){return et!=null&&this.seek(et||this.totalDuration(),ut),this.reversed(!0).paused(!1)},j.pause=function(et,ut){return et!=null&&this.seek(et,ut),this.paused(!0)},j.resume=function(){return this.paused(!1)},j.reversed=function(et){return arguments.length?(!!et!==this.reversed()&&this.timeScale(-this._rts||(et?-_tinyNum:0)),this):this._rts<0},j.invalidate=function(){return this._initted=this._act=0,this._zTime=-_tinyNum,this},j.isActive=function(){var et=this.parent||this._dp,ut=this._start,dt;return!!(!et||this._ts&&this._initted&&et.isActive()&&(dt=et.rawTime(!0))>=ut&&dt<this.endTime(!0)-_tinyNum)},j.eventCallback=function(et,ut,dt){var mt=this.vars;return arguments.length>1?(ut?(mt[et]=ut,dt&&(mt[et+"Params"]=dt),et==="onUpdate"&&(this._onUpdate=ut)):delete mt[et],this):mt[et]},j.then=function(et){var ut=this;return new Promise(function(dt){var mt=_isFunction$1(et)?et:_passThrough$1,yt=function(){var Rt=ut.then;ut.then=null,_isFunction$1(mt)&&(mt=mt(ut))&&(mt.then||mt===ut)&&(ut.then=Rt),dt(mt),ut.then=Rt};ut._initted&&ut.totalProgress()===1&&ut._ts>=0||!ut._tTime&&ut._ts<0?yt():ut._prom=yt})},j.kill=function(){_interrupt(this)},$}();_setDefaults$1(Animation.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-_tinyNum,_prom:0,_ps:!1,_rts:1});var Timeline=function($){_inheritsLoose(j,$);function j(et,ut){var dt;return et===void 0&&(et={}),dt=$.call(this,et)||this,dt.labels={},dt.smoothChildTiming=!!et.smoothChildTiming,dt.autoRemoveChildren=!!et.autoRemoveChildren,dt._sort=_isNotFalse(et.sortChildren),_globalTimeline&&_addToTimeline(et.parent||_globalTimeline,_assertThisInitialized(dt),ut),et.reversed&&dt.reverse(),et.paused&&dt.paused(!0),et.scrollTrigger&&_scrollTrigger(_assertThisInitialized(dt),et.scrollTrigger),dt}var it=j.prototype;return it.to=function(ut,dt,mt){return _createTweenType(0,arguments,this),this},it.from=function(ut,dt,mt){return _createTweenType(1,arguments,this),this},it.fromTo=function(ut,dt,mt,yt){return _createTweenType(2,arguments,this),this},it.set=function(ut,dt,mt){return dt.duration=0,dt.parent=this,_inheritDefaults(dt).repeatDelay||(dt.repeat=0),dt.immediateRender=!!dt.immediateRender,new Tween(ut,dt,_parsePosition$1(this,mt),1),this},it.call=function(ut,dt,mt){return _addToTimeline(this,Tween.delayedCall(0,ut,dt),mt)},it.staggerTo=function(ut,dt,mt,yt,bt,Rt,jt){return mt.duration=dt,mt.stagger=mt.stagger||yt,mt.onComplete=Rt,mt.onCompleteParams=jt,mt.parent=this,new Tween(ut,mt,_parsePosition$1(this,bt)),this},it.staggerFrom=function(ut,dt,mt,yt,bt,Rt,jt){return mt.runBackwards=1,_inheritDefaults(mt).immediateRender=_isNotFalse(mt.immediateRender),this.staggerTo(ut,dt,mt,yt,bt,Rt,jt)},it.staggerFromTo=function(ut,dt,mt,yt,bt,Rt,jt,Vt){return yt.startAt=mt,_inheritDefaults(yt).immediateRender=_isNotFalse(yt.immediateRender),this.staggerTo(ut,dt,yt,bt,Rt,jt,Vt)},it.render=function(ut,dt,mt){var yt=this._time,bt=this._dirty?this.totalDuration():this._tDur,Rt=this._dur,jt=ut<=0?0:_roundPrecise(ut),Vt=this._zTime<0!=ut<0&&(this._initted||!Rt),zt,Jt,rr,Yt,dr,Ft,Ht,er,pr,or,ar,Wt;if(this!==_globalTimeline&&jt>bt&&ut>=0&&(jt=bt),jt!==this._tTime||mt||Vt){if(yt!==this._time&&Rt&&(jt+=this._time-yt,ut+=this._time-yt),zt=jt,pr=this._start,er=this._ts,Ft=!er,Vt&&(Rt||(yt=this._zTime),(ut||!dt)&&(this._zTime=ut)),this._repeat){if(ar=this._yoyo,dr=Rt+this._rDelay,this._repeat<-1&&ut<0)return this.totalTime(dr*100+ut,dt,mt);if(zt=_roundPrecise(jt%dr),jt===bt?(Yt=this._repeat,zt=Rt):(Yt=~~(jt/dr),Yt&&Yt===jt/dr&&(zt=Rt,Yt--),zt>Rt&&(zt=Rt)),or=_animationCycle(this._tTime,dr),!yt&&this._tTime&&or!==Yt&&(or=Yt),ar&&Yt&1&&(zt=Rt-zt,Wt=1),Yt!==or&&!this._lock){var Zt=ar&&or&1,sr=Zt===(ar&&Yt&1);if(Yt<or&&(Zt=!Zt),yt=Zt?0:Rt,this._lock=1,this.render(yt||(Wt?0:_roundPrecise(Yt*dr)),dt,!Rt)._lock=0,this._tTime=jt,!dt&&this.parent&&_callback$1(this,"onRepeat"),this.vars.repeatRefresh&&!Wt&&(this.invalidate()._lock=1),yt&&yt!==this._time||Ft!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(Rt=this._dur,bt=this._tDur,sr&&(this._lock=2,yt=Zt?Rt:-1e-4,this.render(yt,!0),this.vars.repeatRefresh&&!Wt&&this.invalidate()),this._lock=0,!this._ts&&!Ft)return this;_propagateYoyoEase(this,Wt)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(Ht=_findNextPauseTween(this,_roundPrecise(yt),_roundPrecise(zt)),Ht&&(jt-=zt-(zt=Ht._start))),this._tTime=jt,this._time=zt,this._act=!er,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=ut,yt=0),!yt&&zt&&!dt&&(_callback$1(this,"onStart"),this._tTime!==jt))return this;if(zt>=yt&&ut>=0)for(Jt=this._first;Jt;){if(rr=Jt._next,(Jt._act||zt>=Jt._start)&&Jt._ts&&Ht!==Jt){if(Jt.parent!==this)return this.render(ut,dt,mt);if(Jt.render(Jt._ts>0?(zt-Jt._start)*Jt._ts:(Jt._dirty?Jt.totalDuration():Jt._tDur)+(zt-Jt._start)*Jt._ts,dt,mt),zt!==this._time||!this._ts&&!Ft){Ht=0,rr&&(jt+=this._zTime=-_tinyNum);break}}Jt=rr}else{Jt=this._last;for(var tr=ut<0?ut:zt;Jt;){if(rr=Jt._prev,(Jt._act||tr<=Jt._end)&&Jt._ts&&Ht!==Jt){if(Jt.parent!==this)return this.render(ut,dt,mt);if(Jt.render(Jt._ts>0?(tr-Jt._start)*Jt._ts:(Jt._dirty?Jt.totalDuration():Jt._tDur)+(tr-Jt._start)*Jt._ts,dt,mt||_reverting$1&&(Jt._initted||Jt._startAt)),zt!==this._time||!this._ts&&!Ft){Ht=0,rr&&(jt+=this._zTime=tr?-_tinyNum:_tinyNum);break}}Jt=rr}}if(Ht&&!dt&&(this.pause(),Ht.render(zt>=yt?0:-_tinyNum)._zTime=zt>=yt?1:-1,this._ts))return this._start=pr,_setEnd(this),this.render(ut,dt,mt);this._onUpdate&&!dt&&_callback$1(this,"onUpdate",!0),(jt===bt&&this._tTime>=this.totalDuration()||!jt&&yt)&&(pr===this._start||Math.abs(er)!==Math.abs(this._ts))&&(this._lock||((ut||!Rt)&&(jt===bt&&this._ts>0||!jt&&this._ts<0)&&_removeFromParent(this,1),!dt&&!(ut<0&&!yt)&&(jt||yt||!bt)&&(_callback$1(this,jt===bt&&ut>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(jt<bt&&this.timeScale()>0)&&this._prom())))}return this},it.add=function(ut,dt){var mt=this;if(_isNumber$1(dt)||(dt=_parsePosition$1(this,dt,ut)),!(ut instanceof Animation)){if(_isArray(ut))return ut.forEach(function(yt){return mt.add(yt,dt)}),this;if(_isString$1(ut))return this.addLabel(ut,dt);if(_isFunction$1(ut))ut=Tween.delayedCall(0,ut);else return this}return this!==ut?_addToTimeline(this,ut,dt):this},it.getChildren=function(ut,dt,mt,yt){ut===void 0&&(ut=!0),dt===void 0&&(dt=!0),mt===void 0&&(mt=!0),yt===void 0&&(yt=-_bigNum$1);for(var bt=[],Rt=this._first;Rt;)Rt._start>=yt&&(Rt instanceof Tween?dt&&bt.push(Rt):(mt&&bt.push(Rt),ut&&bt.push.apply(bt,Rt.getChildren(!0,dt,mt)))),Rt=Rt._next;return bt},it.getById=function(ut){for(var dt=this.getChildren(1,1,1),mt=dt.length;mt--;)if(dt[mt].vars.id===ut)return dt[mt]},it.remove=function(ut){return _isString$1(ut)?this.removeLabel(ut):_isFunction$1(ut)?this.killTweensOf(ut):(_removeLinkedListItem(this,ut),ut===this._recent&&(this._recent=this._last),_uncache(this))},it.totalTime=function(ut,dt){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=_roundPrecise(_ticker.time-(this._ts>0?ut/this._ts:(this.totalDuration()-ut)/-this._ts))),$.prototype.totalTime.call(this,ut,dt),this._forcing=0,this):this._tTime},it.addLabel=function(ut,dt){return this.labels[ut]=_parsePosition$1(this,dt),this},it.removeLabel=function(ut){return delete this.labels[ut],this},it.addPause=function(ut,dt,mt){var yt=Tween.delayedCall(0,dt||_emptyFunc,mt);return yt.data="isPause",this._hasPause=1,_addToTimeline(this,yt,_parsePosition$1(this,ut))},it.removePause=function(ut){var dt=this._first;for(ut=_parsePosition$1(this,ut);dt;)dt._start===ut&&dt.data==="isPause"&&_removeFromParent(dt),dt=dt._next},it.killTweensOf=function(ut,dt,mt){for(var yt=this.getTweensOf(ut,mt),bt=yt.length;bt--;)_overwritingTween!==yt[bt]&&yt[bt].kill(ut,dt);return this},it.getTweensOf=function(ut,dt){for(var mt=[],yt=toArray(ut),bt=this._first,Rt=_isNumber$1(dt),jt;bt;)bt instanceof Tween?_arrayContainsAny(bt._targets,yt)&&(Rt?(!_overwritingTween||bt._initted&&bt._ts)&&bt.globalTime(0)<=dt&&bt.globalTime(bt.totalDuration())>dt:!dt||bt.isActive())&&mt.push(bt):(jt=bt.getTweensOf(yt,dt)).length&&mt.push.apply(mt,jt),bt=bt._next;return mt},it.tweenTo=function(ut,dt){dt=dt||{};var mt=this,yt=_parsePosition$1(mt,ut),bt=dt,Rt=bt.startAt,jt=bt.onStart,Vt=bt.onStartParams,zt=bt.immediateRender,Jt,rr=Tween.to(mt,_setDefaults$1({ease:dt.ease||"none",lazy:!1,immediateRender:!1,time:yt,overwrite:"auto",duration:dt.duration||Math.abs((yt-(Rt&&"time"in Rt?Rt.time:mt._time))/mt.timeScale())||_tinyNum,onStart:function(){if(mt.pause(),!Jt){var dr=dt.duration||Math.abs((yt-(Rt&&"time"in Rt?Rt.time:mt._time))/mt.timeScale());rr._dur!==dr&&_setDuration(rr,dr,0,1).render(rr._time,!0,!0),Jt=1}jt&&jt.apply(rr,Vt||[])}},dt));return zt?rr.render(0):rr},it.tweenFromTo=function(ut,dt,mt){return this.tweenTo(dt,_setDefaults$1({startAt:{time:_parsePosition$1(this,ut)}},mt))},it.recent=function(){return this._recent},it.nextLabel=function(ut){return ut===void 0&&(ut=this._time),_getLabelInDirection(this,_parsePosition$1(this,ut))},it.previousLabel=function(ut){return ut===void 0&&(ut=this._time),_getLabelInDirection(this,_parsePosition$1(this,ut),1)},it.currentLabel=function(ut){return arguments.length?this.seek(ut,!0):this.previousLabel(this._time+_tinyNum)},it.shiftChildren=function(ut,dt,mt){mt===void 0&&(mt=0);for(var yt=this._first,bt=this.labels,Rt;yt;)yt._start>=mt&&(yt._start+=ut,yt._end+=ut),yt=yt._next;if(dt)for(Rt in bt)bt[Rt]>=mt&&(bt[Rt]+=ut);return _uncache(this)},it.invalidate=function(ut){var dt=this._first;for(this._lock=0;dt;)dt.invalidate(ut),dt=dt._next;return $.prototype.invalidate.call(this,ut)},it.clear=function(ut){ut===void 0&&(ut=!0);for(var dt=this._first,mt;dt;)mt=dt._next,this.remove(dt),dt=mt;return this._dp&&(this._time=this._tTime=this._pTime=0),ut&&(this.labels={}),_uncache(this)},it.totalDuration=function(ut){var dt=0,mt=this,yt=mt._last,bt=_bigNum$1,Rt,jt,Vt;if(arguments.length)return mt.timeScale((mt._repeat<0?mt.duration():mt.totalDuration())/(mt.reversed()?-ut:ut));if(mt._dirty){for(Vt=mt.parent;yt;)Rt=yt._prev,yt._dirty&&yt.totalDuration(),jt=yt._start,jt>bt&&mt._sort&&yt._ts&&!mt._lock?(mt._lock=1,_addToTimeline(mt,yt,jt-yt._delay,1)._lock=0):bt=jt,jt<0&&yt._ts&&(dt-=jt,(!Vt&&!mt._dp||Vt&&Vt.smoothChildTiming)&&(mt._start+=jt/mt._ts,mt._time-=jt,mt._tTime-=jt),mt.shiftChildren(-jt,!1,-1/0),bt=0),yt._end>dt&&yt._ts&&(dt=yt._end),yt=Rt;_setDuration(mt,mt===_globalTimeline&&mt._time>dt?mt._time:dt,1,1),mt._dirty=0}return mt._tDur},j.updateRoot=function(ut){if(_globalTimeline._ts&&(_lazySafeRender(_globalTimeline,_parentToChildTotalTime(ut,_globalTimeline)),_lastRenderedFrame=_ticker.frame),_ticker.frame>=_nextGCFrame){_nextGCFrame+=_config.autoSleep||120;var dt=_globalTimeline._first;if((!dt||!dt._ts)&&_config.autoSleep&&_ticker._listeners.length<2){for(;dt&&!dt._ts;)dt=dt._next;dt||_ticker.sleep()}}},j}(Animation);_setDefaults$1(Timeline.prototype,{_lock:0,_hasPause:0,_forcing:0});var _addComplexStringPropTween=function $(j,it,et,ut,dt,mt,yt){var bt=new PropTween(this._pt,j,it,0,1,_renderComplexString,null,dt),Rt=0,jt=0,Vt,zt,Jt,rr,Yt,dr,Ft,Ht;for(bt.b=et,bt.e=ut,et+="",ut+="",(Ft=~ut.indexOf("random("))&&(ut=_replaceRandom(ut)),mt&&(Ht=[et,ut],mt(Ht,j,it),et=Ht[0],ut=Ht[1]),zt=et.match(_complexStringNumExp)||[];Vt=_complexStringNumExp.exec(ut);)rr=Vt[0],Yt=ut.substring(Rt,Vt.index),Jt?Jt=(Jt+1)%5:Yt.substr(-5)==="rgba("&&(Jt=1),rr!==zt[jt++]&&(dr=parseFloat(zt[jt-1])||0,bt._pt={_next:bt._pt,p:Yt||jt===1?Yt:",",s:dr,c:rr.charAt(1)==="="?_parseRelative(dr,rr)-dr:parseFloat(rr)-dr,m:Jt&&Jt<4?Math.round:0},Rt=_complexStringNumExp.lastIndex);return bt.c=Rt<ut.length?ut.substring(Rt,ut.length):"",bt.fp=yt,(_relExp.test(ut)||Ft)&&(bt.e=0),this._pt=bt,bt},_addPropTween=function $(j,it,et,ut,dt,mt,yt,bt,Rt,jt){_isFunction$1(ut)&&(ut=ut(dt||0,j,mt));var Vt=j[it],zt=et!=="get"?et:_isFunction$1(Vt)?Rt?j[it.indexOf("set")||!_isFunction$1(j["get"+it.substr(3)])?it:"get"+it.substr(3)](Rt):j[it]():Vt,Jt=_isFunction$1(Vt)?Rt?_setterFuncWithParam:_setterFunc:_setterPlain,rr;if(_isString$1(ut)&&(~ut.indexOf("random(")&&(ut=_replaceRandom(ut)),ut.charAt(1)==="="&&(rr=_parseRelative(zt,ut)+(getUnit(zt)||0),(rr||rr===0)&&(ut=rr))),!jt||zt!==ut||_forceAllPropTweens)return!isNaN(zt*ut)&&ut!==""?(rr=new PropTween(this._pt,j,it,+zt||0,ut-(zt||0),typeof Vt=="boolean"?_renderBoolean:_renderPlain,0,Jt),Rt&&(rr.fp=Rt),yt&&rr.modifier(yt,this,j),this._pt=rr):(!Vt&&!(it in j)&&_missingPlugin(it,ut),_addComplexStringPropTween.call(this,j,it,zt,ut,Jt,bt||_config.stringFilter,Rt))},_processVars=function $(j,it,et,ut,dt){if(_isFunction$1(j)&&(j=_parseFuncOrString(j,dt,it,et,ut)),!_isObject$1(j)||j.style&&j.nodeType||_isArray(j)||_isTypedArray(j))return _isString$1(j)?_parseFuncOrString(j,dt,it,et,ut):j;var mt={},yt;for(yt in j)mt[yt]=_parseFuncOrString(j[yt],dt,it,et,ut);return mt},_checkPlugin=function $(j,it,et,ut,dt,mt){var yt,bt,Rt,jt;if(_plugins[j]&&(yt=new _plugins[j]).init(dt,yt.rawVars?it[j]:_processVars(it[j],ut,dt,mt,et),et,ut,mt)!==!1&&(et._pt=bt=new PropTween(et._pt,dt,j,0,1,yt.render,yt,0,yt.priority),et!==_quickTween))for(Rt=et._ptLookup[et._targets.indexOf(dt)],jt=yt._props.length;jt--;)Rt[yt._props[jt]]=bt;return yt},_overwritingTween,_forceAllPropTweens,_initTween=function $(j,it,et){var ut=j.vars,dt=ut.ease,mt=ut.startAt,yt=ut.immediateRender,bt=ut.lazy,Rt=ut.onUpdate,jt=ut.onUpdateParams,Vt=ut.callbackScope,zt=ut.runBackwards,Jt=ut.yoyoEase,rr=ut.keyframes,Yt=ut.autoRevert,dr=j._dur,Ft=j._startAt,Ht=j._targets,er=j.parent,pr=er&&er.data==="nested"?er.vars.targets:Ht,or=j._overwrite==="auto"&&!_suppressOverwrites$1,ar=j.timeline,Wt,Zt,sr,tr,vr,Vr,hn,cn,gn,tn,Tn,qr,nn;if(ar&&(!rr||!dt)&&(dt="none"),j._ease=_parseEase(dt,_defaults$1.ease),j._yEase=Jt?_invertEase(_parseEase(Jt===!0?dt:Jt,_defaults$1.ease)):0,Jt&&j._yoyo&&!j._repeat&&(Jt=j._yEase,j._yEase=j._ease,j._ease=Jt),j._from=!ar&&!!ut.runBackwards,!ar||rr&&!ut.stagger){if(cn=Ht[0]?_getCache(Ht[0]).harness:0,qr=cn&&ut[cn.prop],Wt=_copyExcluding(ut,_reservedProps),Ft&&(Ft._zTime<0&&Ft.progress(1),it<0&&zt&&yt&&!Yt?Ft.render(-1,!0):Ft.revert(zt&&dr?_revertConfigNoKill:_startAtRevertConfig),Ft._lazy=0),mt){if(_removeFromParent(j._startAt=Tween.set(Ht,_setDefaults$1({data:"isStart",overwrite:!1,parent:er,immediateRender:!0,lazy:!Ft&&_isNotFalse(bt),startAt:null,delay:0,onUpdate:Rt,onUpdateParams:jt,callbackScope:Vt,stagger:0},mt))),j._startAt._dp=0,j._startAt._sat=j,it<0&&(_reverting$1||!yt&&!Yt)&&j._startAt.revert(_revertConfigNoKill),yt&&dr&&it<=0&&et<=0){it&&(j._zTime=it);return}}else if(zt&&dr&&!Ft){if(it&&(yt=!1),sr=_setDefaults$1({overwrite:!1,data:"isFromStart",lazy:yt&&!Ft&&_isNotFalse(bt),immediateRender:yt,stagger:0,parent:er},Wt),qr&&(sr[cn.prop]=qr),_removeFromParent(j._startAt=Tween.set(Ht,sr)),j._startAt._dp=0,j._startAt._sat=j,it<0&&(_reverting$1?j._startAt.revert(_revertConfigNoKill):j._startAt.render(-1,!0)),j._zTime=it,!yt)$(j._startAt,_tinyNum,_tinyNum);else if(!it)return}for(j._pt=j._ptCache=0,bt=dr&&_isNotFalse(bt)||bt&&!dr,Zt=0;Zt<Ht.length;Zt++){if(vr=Ht[Zt],hn=vr._gsap||_harness(Ht)[Zt]._gsap,j._ptLookup[Zt]=tn={},_lazyLookup[hn.id]&&_lazyTweens.length&&_lazyRender(),Tn=pr===Ht?Zt:pr.indexOf(vr),cn&&(gn=new cn).init(vr,qr||Wt,j,Tn,pr)!==!1&&(j._pt=tr=new PropTween(j._pt,vr,gn.name,0,1,gn.render,gn,0,gn.priority),gn._props.forEach(function(yr){tn[yr]=tr}),gn.priority&&(Vr=1)),!cn||qr)for(sr in Wt)_plugins[sr]&&(gn=_checkPlugin(sr,Wt,j,Tn,vr,pr))?gn.priority&&(Vr=1):tn[sr]=tr=_addPropTween.call(j,vr,sr,"get",Wt[sr],Tn,pr,0,ut.stringFilter);j._op&&j._op[Zt]&&j.kill(vr,j._op[Zt]),or&&j._pt&&(_overwritingTween=j,_globalTimeline.killTweensOf(vr,tn,j.globalTime(it)),nn=!j.parent,_overwritingTween=0),j._pt&&bt&&(_lazyLookup[hn.id]=1)}Vr&&_sortPropTweensByPriority(j),j._onInit&&j._onInit(j)}j._onUpdate=Rt,j._initted=(!j._op||j._pt)&&!nn,rr&&it<=0&&ar.render(_bigNum$1,!0,!0)},_updatePropTweens=function $(j,it,et,ut,dt,mt,yt){var bt=(j._pt&&j._ptCache||(j._ptCache={}))[it],Rt,jt,Vt,zt;if(!bt)for(bt=j._ptCache[it]=[],Vt=j._ptLookup,zt=j._targets.length;zt--;){if(Rt=Vt[zt][it],Rt&&Rt.d&&Rt.d._pt)for(Rt=Rt.d._pt;Rt&&Rt.p!==it&&Rt.fp!==it;)Rt=Rt._next;if(!Rt)return _forceAllPropTweens=1,j.vars[it]="+=0",_initTween(j,yt),_forceAllPropTweens=0,1;bt.push(Rt)}for(zt=bt.length;zt--;)jt=bt[zt],Rt=jt._pt||jt,Rt.s=(ut||ut===0)&&!dt?ut:Rt.s+(ut||0)+mt*Rt.c,Rt.c=et-Rt.s,jt.e&&(jt.e=_round$1(et)+getUnit(jt.e)),jt.b&&(jt.b=Rt.s+getUnit(jt.b))},_addAliasesToVars=function $(j,it){var et=j[0]?_getCache(j[0]).harness:0,ut=et&&et.aliases,dt,mt,yt,bt;if(!ut)return it;dt=_merge({},it);for(mt in ut)if(mt in dt)for(bt=ut[mt].split(","),yt=bt.length;yt--;)dt[bt[yt]]=dt[mt];return dt},_parseKeyframe=function $(j,it,et,ut){var dt=it.ease||ut||"power1.inOut",mt,yt;if(_isArray(it))yt=et[j]||(et[j]=[]),it.forEach(function(bt,Rt){return yt.push({t:Rt/(it.length-1)*100,v:bt,e:dt})});else for(mt in it)yt=et[mt]||(et[mt]=[]),mt==="ease"||yt.push({t:parseFloat(j),v:it[mt],e:dt})},_parseFuncOrString=function $(j,it,et,ut,dt){return _isFunction$1(j)?j.call(it,et,ut,dt):_isString$1(j)&&~j.indexOf("random(")?_replaceRandom(j):j},_staggerTweenProps=_callbackNames+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",_staggerPropsToSkip={};_forEachName(_staggerTweenProps+",id,stagger,delay,duration,paused,scrollTrigger",function($){return _staggerPropsToSkip[$]=1});var Tween=function($){_inheritsLoose(j,$);function j(et,ut,dt,mt){var yt;typeof ut=="number"&&(dt.duration=ut,ut=dt,dt=null),yt=$.call(this,mt?ut:_inheritDefaults(ut))||this;var bt=yt.vars,Rt=bt.duration,jt=bt.delay,Vt=bt.immediateRender,zt=bt.stagger,Jt=bt.overwrite,rr=bt.keyframes,Yt=bt.defaults,dr=bt.scrollTrigger,Ft=bt.yoyoEase,Ht=ut.parent||_globalTimeline,er=(_isArray(et)||_isTypedArray(et)?_isNumber$1(et[0]):"length"in ut)?[et]:toArray(et),pr,or,ar,Wt,Zt,sr,tr,vr;if(yt._targets=er.length?_harness(er):_warn("GSAP target "+et+" not found. https://greensock.com",!_config.nullTargetWarn)||[],yt._ptLookup=[],yt._overwrite=Jt,rr||zt||_isFuncOrString(Rt)||_isFuncOrString(jt)){if(ut=yt.vars,pr=yt.timeline=new Timeline({data:"nested",defaults:Yt||{},targets:Ht&&Ht.data==="nested"?Ht.vars.targets:er}),pr.kill(),pr.parent=pr._dp=_assertThisInitialized(yt),pr._start=0,zt||_isFuncOrString(Rt)||_isFuncOrString(jt)){if(Wt=er.length,tr=zt&&distribute(zt),_isObject$1(zt))for(Zt in zt)~_staggerTweenProps.indexOf(Zt)&&(vr||(vr={}),vr[Zt]=zt[Zt]);for(or=0;or<Wt;or++)ar=_copyExcluding(ut,_staggerPropsToSkip),ar.stagger=0,Ft&&(ar.yoyoEase=Ft),vr&&_merge(ar,vr),sr=er[or],ar.duration=+_parseFuncOrString(Rt,_assertThisInitialized(yt),or,sr,er),ar.delay=(+_parseFuncOrString(jt,_assertThisInitialized(yt),or,sr,er)||0)-yt._delay,!zt&&Wt===1&&ar.delay&&(yt._delay=jt=ar.delay,yt._start+=jt,ar.delay=0),pr.to(sr,ar,tr?tr(or,sr,er):0),pr._ease=_easeMap.none;pr.duration()?Rt=jt=0:yt.timeline=0}else if(rr){_inheritDefaults(_setDefaults$1(pr.vars.defaults,{ease:"none"})),pr._ease=_parseEase(rr.ease||ut.ease||"none");var Vr=0,hn,cn,gn;if(_isArray(rr))rr.forEach(function(tn){return pr.to(er,tn,">")}),pr.duration();else{ar={};for(Zt in rr)Zt==="ease"||Zt==="easeEach"||_parseKeyframe(Zt,rr[Zt],ar,rr.easeEach);for(Zt in ar)for(hn=ar[Zt].sort(function(tn,Tn){return tn.t-Tn.t}),Vr=0,or=0;or<hn.length;or++)cn=hn[or],gn={ease:cn.e,duration:(cn.t-(or?hn[or-1].t:0))/100*Rt},gn[Zt]=cn.v,pr.to(er,gn,Vr),Vr+=gn.duration;pr.duration()<Rt&&pr.to({},{duration:Rt-pr.duration()})}}Rt||yt.duration(Rt=pr.duration())}else yt.timeline=0;return Jt===!0&&!_suppressOverwrites$1&&(_overwritingTween=_assertThisInitialized(yt),_globalTimeline.killTweensOf(er),_overwritingTween=0),_addToTimeline(Ht,_assertThisInitialized(yt),dt),ut.reversed&&yt.reverse(),ut.paused&&yt.paused(!0),(Vt||!Rt&&!rr&&yt._start===_roundPrecise(Ht._time)&&_isNotFalse(Vt)&&_hasNoPausedAncestors(_assertThisInitialized(yt))&&Ht.data!=="nested")&&(yt._tTime=-_tinyNum,yt.render(Math.max(0,-jt)||0)),dr&&_scrollTrigger(_assertThisInitialized(yt),dr),yt}var it=j.prototype;return it.render=function(ut,dt,mt){var yt=this._time,bt=this._tDur,Rt=this._dur,jt=ut<0,Vt=ut>bt-_tinyNum&&!jt?bt:ut<_tinyNum?0:ut,zt,Jt,rr,Yt,dr,Ft,Ht,er,pr;if(!Rt)_renderZeroDurationTween(this,ut,dt,mt);else if(Vt!==this._tTime||!ut||mt||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==jt){if(zt=Vt,er=this.timeline,this._repeat){if(Yt=Rt+this._rDelay,this._repeat<-1&&jt)return this.totalTime(Yt*100+ut,dt,mt);if(zt=_roundPrecise(Vt%Yt),Vt===bt?(rr=this._repeat,zt=Rt):(rr=~~(Vt/Yt),rr&&rr===Vt/Yt&&(zt=Rt,rr--),zt>Rt&&(zt=Rt)),Ft=this._yoyo&&rr&1,Ft&&(pr=this._yEase,zt=Rt-zt),dr=_animationCycle(this._tTime,Yt),zt===yt&&!mt&&this._initted)return this._tTime=Vt,this;rr!==dr&&(er&&this._yEase&&_propagateYoyoEase(er,Ft),this.vars.repeatRefresh&&!Ft&&!this._lock&&(this._lock=mt=1,this.render(_roundPrecise(Yt*rr),!0).invalidate()._lock=0))}if(!this._initted){if(_attemptInitTween(this,jt?ut:zt,mt,dt,Vt))return this._tTime=0,this;if(yt!==this._time)return this;if(Rt!==this._dur)return this.render(ut,dt,mt)}if(this._tTime=Vt,this._time=zt,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=Ht=(pr||this._ease)(zt/Rt),this._from&&(this.ratio=Ht=1-Ht),zt&&!yt&&!dt&&(_callback$1(this,"onStart"),this._tTime!==Vt))return this;for(Jt=this._pt;Jt;)Jt.r(Ht,Jt.d),Jt=Jt._next;er&&er.render(ut<0?ut:!zt&&Ft?-_tinyNum:er._dur*er._ease(zt/this._dur),dt,mt)||this._startAt&&(this._zTime=ut),this._onUpdate&&!dt&&(jt&&_rewindStartAt(this,ut,dt,mt),_callback$1(this,"onUpdate")),this._repeat&&rr!==dr&&this.vars.onRepeat&&!dt&&this.parent&&_callback$1(this,"onRepeat"),(Vt===this._tDur||!Vt)&&this._tTime===Vt&&(jt&&!this._onUpdate&&_rewindStartAt(this,ut,!0,!0),(ut||!Rt)&&(Vt===this._tDur&&this._ts>0||!Vt&&this._ts<0)&&_removeFromParent(this,1),!dt&&!(jt&&!yt)&&(Vt||yt||Ft)&&(_callback$1(this,Vt===bt?"onComplete":"onReverseComplete",!0),this._prom&&!(Vt<bt&&this.timeScale()>0)&&this._prom()))}return this},it.targets=function(){return this._targets},it.invalidate=function(ut){return(!ut||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(ut),$.prototype.invalidate.call(this,ut)},it.resetTo=function(ut,dt,mt,yt){_tickerActive||_ticker.wake(),this._ts||this.play();var bt=Math.min(this._dur,(this._dp._time-this._start)*this._ts),Rt;return this._initted||_initTween(this,bt),Rt=this._ease(bt/this._dur),_updatePropTweens(this,ut,dt,mt,yt,Rt,bt)?this.resetTo(ut,dt,mt,yt):(_alignPlayhead(this,0),this.parent||_addLinkedListItem(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},it.kill=function(ut,dt){if(dt===void 0&&(dt="all"),!ut&&(!dt||dt==="all"))return this._lazy=this._pt=0,this.parent?_interrupt(this):this;if(this.timeline){var mt=this.timeline.totalDuration();return this.timeline.killTweensOf(ut,dt,_overwritingTween&&_overwritingTween.vars.overwrite!==!0)._first||_interrupt(this),this.parent&&mt!==this.timeline.totalDuration()&&_setDuration(this,this._dur*this.timeline._tDur/mt,0,1),this}var yt=this._targets,bt=ut?toArray(ut):yt,Rt=this._ptLookup,jt=this._pt,Vt,zt,Jt,rr,Yt,dr,Ft;if((!dt||dt==="all")&&_arraysMatch(yt,bt))return dt==="all"&&(this._pt=0),_interrupt(this);for(Vt=this._op=this._op||[],dt!=="all"&&(_isString$1(dt)&&(Yt={},_forEachName(dt,function(Ht){return Yt[Ht]=1}),dt=Yt),dt=_addAliasesToVars(yt,dt)),Ft=yt.length;Ft--;)if(~bt.indexOf(yt[Ft])){zt=Rt[Ft],dt==="all"?(Vt[Ft]=dt,rr=zt,Jt={}):(Jt=Vt[Ft]=Vt[Ft]||{},rr=dt);for(Yt in rr)dr=zt&&zt[Yt],dr&&((!("kill"in dr.d)||dr.d.kill(Yt)===!0)&&_removeLinkedListItem(this,dr,"_pt"),delete zt[Yt]),Jt!=="all"&&(Jt[Yt]=1)}return this._initted&&!this._pt&&jt&&_interrupt(this),this},j.to=function(ut,dt){return new j(ut,dt,arguments[2])},j.from=function(ut,dt){return _createTweenType(1,arguments)},j.delayedCall=function(ut,dt,mt,yt){return new j(dt,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:ut,onComplete:dt,onReverseComplete:dt,onCompleteParams:mt,onReverseCompleteParams:mt,callbackScope:yt})},j.fromTo=function(ut,dt,mt){return _createTweenType(2,arguments)},j.set=function(ut,dt){return dt.duration=0,dt.repeatDelay||(dt.repeat=0),new j(ut,dt)},j.killTweensOf=function(ut,dt,mt){return _globalTimeline.killTweensOf(ut,dt,mt)},j}(Animation);_setDefaults$1(Tween.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});_forEachName("staggerTo,staggerFrom,staggerFromTo",function($){Tween[$]=function(){var j=new Timeline,it=_slice.call(arguments,0);return it.splice($==="staggerFromTo"?5:4,0,0),j[$].apply(j,it)}});var _setterPlain=function $(j,it,et){return j[it]=et},_setterFunc=function $(j,it,et){return j[it](et)},_setterFuncWithParam=function $(j,it,et,ut){return j[it](ut.fp,et)},_setterAttribute=function $(j,it,et){return j.setAttribute(it,et)},_getSetter=function $(j,it){return _isFunction$1(j[it])?_setterFunc:_isUndefined(j[it])&&j.setAttribute?_setterAttribute:_setterPlain},_renderPlain=function $(j,it){return it.set(it.t,it.p,Math.round((it.s+it.c*j)*1e6)/1e6,it)},_renderBoolean=function $(j,it){return it.set(it.t,it.p,!!(it.s+it.c*j),it)},_renderComplexString=function $(j,it){var et=it._pt,ut="";if(!j&&it.b)ut=it.b;else if(j===1&&it.e)ut=it.e;else{for(;et;)ut=et.p+(et.m?et.m(et.s+et.c*j):Math.round((et.s+et.c*j)*1e4)/1e4)+ut,et=et._next;ut+=it.c}it.set(it.t,it.p,ut,it)},_renderPropTweens=function $(j,it){for(var et=it._pt;et;)et.r(j,et.d),et=et._next},_addPluginModifier=function $(j,it,et,ut){for(var dt=this._pt,mt;dt;)mt=dt._next,dt.p===ut&&dt.modifier(j,it,et),dt=mt},_killPropTweensOf=function $(j){for(var it=this._pt,et,ut;it;)ut=it._next,it.p===j&&!it.op||it.op===j?_removeLinkedListItem(this,it,"_pt"):it.dep||(et=1),it=ut;return!et},_setterWithModifier=function $(j,it,et,ut){ut.mSet(j,it,ut.m.call(ut.tween,et,ut.mt),ut)},_sortPropTweensByPriority=function $(j){for(var it=j._pt,et,ut,dt,mt;it;){for(et=it._next,ut=dt;ut&&ut.pr>it.pr;)ut=ut._next;(it._prev=ut?ut._prev:mt)?it._prev._next=it:dt=it,(it._next=ut)?ut._prev=it:mt=it,it=et}j._pt=dt},PropTween=function(){function $(it,et,ut,dt,mt,yt,bt,Rt,jt){this.t=et,this.s=dt,this.c=mt,this.p=ut,this.r=yt||_renderPlain,this.d=bt||this,this.set=Rt||_setterPlain,this.pr=jt||0,this._next=it,it&&(it._prev=this)}var j=$.prototype;return j.modifier=function(et,ut,dt){this.mSet=this.mSet||this.set,this.set=_setterWithModifier,this.m=et,this.mt=dt,this.tween=ut},$}();_forEachName(_callbackNames+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function($){return _reservedProps[$]=1});_globals.TweenMax=_globals.TweenLite=Tween;_globals.TimelineLite=_globals.TimelineMax=Timeline;_globalTimeline=new Timeline({sortChildren:!1,defaults:_defaults$1,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});_config.stringFilter=_colorStringFilter;var _media=[],_listeners$1={},_emptyArray$1=[],_lastMediaTime=0,_dispatch$1=function $(j){return(_listeners$1[j]||_emptyArray$1).map(function(it){return it()})},_onMediaChange=function $(){var j=Date.now(),it=[];j-_lastMediaTime>2&&(_dispatch$1("matchMediaInit"),_media.forEach(function(et){var ut=et.queries,dt=et.conditions,mt,yt,bt,Rt;for(yt in ut)mt=_win$3.matchMedia(ut[yt]).matches,mt&&(bt=1),mt!==dt[yt]&&(dt[yt]=mt,Rt=1);Rt&&(et.revert(),bt&&it.push(et))}),_dispatch$1("matchMediaRevert"),it.forEach(function(et){return et.onMatch(et)}),_lastMediaTime=j,_dispatch$1("matchMedia"))},Context=function(){function $(it,et){this.selector=et&&selector$1(et),this.data=[],this._r=[],this.isReverted=!1,it&&this.add(it)}var j=$.prototype;return j.add=function(et,ut,dt){_isFunction$1(et)&&(dt=ut,ut=et,et=_isFunction$1);var mt=this,yt=function(){var Rt=_context$2,jt=mt.selector,Vt;return Rt&&Rt!==mt&&Rt.data.push(mt),dt&&(mt.selector=selector$1(dt)),_context$2=mt,Vt=ut.apply(mt,arguments),_isFunction$1(Vt)&&mt._r.push(Vt),_context$2=Rt,mt.selector=jt,mt.isReverted=!1,Vt};return mt.last=yt,et===_isFunction$1?yt(mt):et?mt[et]=yt:yt},j.ignore=function(et){var ut=_context$2;_context$2=null,et(this),_context$2=ut},j.getTweens=function(){var et=[];return this.data.forEach(function(ut){return ut instanceof $?et.push.apply(et,ut.getTweens()):ut instanceof Tween&&!(ut.parent&&ut.parent.data==="nested")&&et.push(ut)}),et},j.clear=function(){this._r.length=this.data.length=0},j.kill=function(et,ut){var dt=this;if(et){var mt=this.getTweens();this.data.forEach(function(bt){bt.data==="isFlip"&&(bt.revert(),bt.getChildren(!0,!0,!1).forEach(function(Rt){return mt.splice(mt.indexOf(Rt),1)}))}),mt.map(function(bt){return{g:bt.globalTime(0),t:bt}}).sort(function(bt,Rt){return Rt.g-bt.g||-1}).forEach(function(bt){return bt.t.revert(et)}),this.data.forEach(function(bt){return!(bt instanceof Animation)&&bt.revert&&bt.revert(et)}),this._r.forEach(function(bt){return bt(et,dt)}),this.isReverted=!0}else this.data.forEach(function(bt){return bt.kill&&bt.kill()});if(this.clear(),ut){var yt=_media.indexOf(this);~yt&&_media.splice(yt,1)}},j.revert=function(et){this.kill(et||{})},$}(),MatchMedia=function(){function $(it){this.contexts=[],this.scope=it}var j=$.prototype;return j.add=function(et,ut,dt){_isObject$1(et)||(et={matches:et});var mt=new Context(0,dt||this.scope),yt=mt.conditions={},bt,Rt,jt;this.contexts.push(mt),ut=mt.add("onMatch",ut),mt.queries=et;for(Rt in et)Rt==="all"?jt=1:(bt=_win$3.matchMedia(et[Rt]),bt&&(_media.indexOf(mt)<0&&_media.push(mt),(yt[Rt]=bt.matches)&&(jt=1),bt.addListener?bt.addListener(_onMediaChange):bt.addEventListener("change",_onMediaChange)));return jt&&ut(mt),this},j.revert=function(et){this.kill(et||{})},j.kill=function(et){this.contexts.forEach(function(ut){return ut.kill(et,!0)})},$}(),_gsap={registerPlugin:function $(){for(var j=arguments.length,it=new Array(j),et=0;et<j;et++)it[et]=arguments[et];it.forEach(function(ut){return _createPlugin(ut)})},timeline:function $(j){return new Timeline(j)},getTweensOf:function $(j,it){return _globalTimeline.getTweensOf(j,it)},getProperty:function $(j,it,et,ut){_isString$1(j)&&(j=toArray(j)[0]);var dt=_getCache(j||{}).get,mt=et?_passThrough$1:_numericIfPossible;return et==="native"&&(et=""),j&&(it?mt((_plugins[it]&&_plugins[it].get||dt)(j,it,et,ut)):function(yt,bt,Rt){return mt((_plugins[yt]&&_plugins[yt].get||dt)(j,yt,bt,Rt))})},quickSetter:function $(j,it,et){if(j=toArray(j),j.length>1){var ut=j.map(function(jt){return gsap$2.quickSetter(jt,it,et)}),dt=ut.length;return function(jt){for(var Vt=dt;Vt--;)ut[Vt](jt)}}j=j[0]||{};var mt=_plugins[it],yt=_getCache(j),bt=yt.harness&&(yt.harness.aliases||{})[it]||it,Rt=mt?function(jt){var Vt=new mt;_quickTween._pt=0,Vt.init(j,et?jt+et:jt,_quickTween,0,[j]),Vt.render(1,Vt),_quickTween._pt&&_renderPropTweens(1,_quickTween)}:yt.set(j,bt);return mt?Rt:function(jt){return Rt(j,bt,et?jt+et:jt,yt,1)}},quickTo:function $(j,it,et){var ut,dt=gsap$2.to(j,_merge((ut={},ut[it]="+=0.1",ut.paused=!0,ut),et||{})),mt=function(bt,Rt,jt){return dt.resetTo(it,bt,Rt,jt)};return mt.tween=dt,mt},isTweening:function $(j){return _globalTimeline.getTweensOf(j,!0).length>0},defaults:function $(j){return j&&j.ease&&(j.ease=_parseEase(j.ease,_defaults$1.ease)),_mergeDeep(_defaults$1,j||{})},config:function $(j){return _mergeDeep(_config,j||{})},registerEffect:function $(j){var it=j.name,et=j.effect,ut=j.plugins,dt=j.defaults,mt=j.extendTimeline;(ut||"").split(",").forEach(function(yt){return yt&&!_plugins[yt]&&!_globals[yt]&&_warn(it+" effect requires "+yt+" plugin.")}),_effects[it]=function(yt,bt,Rt){return et(toArray(yt),_setDefaults$1(bt||{},dt),Rt)},mt&&(Timeline.prototype[it]=function(yt,bt,Rt){return this.add(_effects[it](yt,_isObject$1(bt)?bt:(Rt=bt)&&{},this),Rt)})},registerEase:function $(j,it){_easeMap[j]=_parseEase(it)},parseEase:function $(j,it){return arguments.length?_parseEase(j,it):_easeMap},getById:function $(j){return _globalTimeline.getById(j)},exportRoot:function $(j,it){j===void 0&&(j={});var et=new Timeline(j),ut,dt;for(et.smoothChildTiming=_isNotFalse(j.smoothChildTiming),_globalTimeline.remove(et),et._dp=0,et._time=et._tTime=_globalTimeline._time,ut=_globalTimeline._first;ut;)dt=ut._next,(it||!(!ut._dur&&ut instanceof Tween&&ut.vars.onComplete===ut._targets[0]))&&_addToTimeline(et,ut,ut._start-ut._delay),ut=dt;return _addToTimeline(_globalTimeline,et,0),et},context:function $(j,it){return j?new Context(j,it):_context$2},matchMedia:function $(j){return new MatchMedia(j)},matchMediaRefresh:function $(){return _media.forEach(function(j){var it=j.conditions,et,ut;for(ut in it)it[ut]&&(it[ut]=!1,et=1);et&&j.revert()})||_onMediaChange()},addEventListener:function $(j,it){var et=_listeners$1[j]||(_listeners$1[j]=[]);~et.indexOf(it)||et.push(it)},removeEventListener:function $(j,it){var et=_listeners$1[j],ut=et&&et.indexOf(it);ut>=0&&et.splice(ut,1)},utils:{wrap,wrapYoyo,distribute,random,snap,normalize:normalize$1,getUnit,clamp,splitColor,toArray,selector:selector$1,mapRange,pipe,unitize,interpolate,shuffle},install:_install,effects:_effects,ticker:_ticker,updateRoot:Timeline.updateRoot,plugins:_plugins,globalTimeline:_globalTimeline,core:{PropTween,globals:_addGlobal,Tween,Timeline,Animation,getCache:_getCache,_removeLinkedListItem,reverting:function $(){return _reverting$1},context:function $(j){return j&&_context$2&&(_context$2.data.push(j),j._ctx=_context$2),_context$2},suppressOverwrites:function $(j){return _suppressOverwrites$1=j}}};_forEachName("to,from,fromTo,delayedCall,set,killTweensOf",function($){return _gsap[$]=Tween[$]});_ticker.add(Timeline.updateRoot);_quickTween=_gsap.to({},{duration:0});var _getPluginPropTween=function $(j,it){for(var et=j._pt;et&&et.p!==it&&et.op!==it&&et.fp!==it;)et=et._next;return et},_addModifiers=function $(j,it){var et=j._targets,ut,dt,mt;for(ut in it)for(dt=et.length;dt--;)mt=j._ptLookup[dt][ut],mt&&(mt=mt.d)&&(mt._pt&&(mt=_getPluginPropTween(mt,ut)),mt&&mt.modifier&&mt.modifier(it[ut],j,et[dt],ut))},_buildModifierPlugin=function $(j,it){return{name:j,rawVars:1,init:function(ut,dt,mt){mt._onInit=function(yt){var bt,Rt;if(_isString$1(dt)&&(bt={},_forEachName(dt,function(jt){return bt[jt]=1}),dt=bt),it){bt={};for(Rt in dt)bt[Rt]=it(dt[Rt]);dt=bt}_addModifiers(yt,dt)}}}},gsap$2=_gsap.registerPlugin({name:"attr",init:function $(j,it,et,ut,dt){var mt,yt,bt;this.tween=et;for(mt in it)bt=j.getAttribute(mt)||"",yt=this.add(j,"setAttribute",(bt||0)+"",it[mt],ut,dt,0,0,mt),yt.op=mt,yt.b=bt,this._props.push(mt)},render:function $(j,it){for(var et=it._pt;et;)_reverting$1?et.set(et.t,et.p,et.b,et):et.r(j,et.d),et=et._next}},{name:"endArray",init:function $(j,it){for(var et=it.length;et--;)this.add(j,et,j[et]||0,it[et],0,0,0,0,0,1)}},_buildModifierPlugin("roundProps",_roundModifier),_buildModifierPlugin("modifiers"),_buildModifierPlugin("snap",snap))||_gsap;Tween.version=Timeline.version=gsap$2.version="3.11.4";_coreReady=1;_windowExists$2()&&_wake();_easeMap.Power0;_easeMap.Power1;_easeMap.Power2;_easeMap.Power3;_easeMap.Power4;_easeMap.Linear;_easeMap.Quad;_easeMap.Cubic;_easeMap.Quart;_easeMap.Quint;_easeMap.Strong;_easeMap.Elastic;_easeMap.Back;_easeMap.SteppedEase;_easeMap.Bounce;_easeMap.Sine;_easeMap.Expo;_easeMap.Circ;/*!
 * CSSPlugin 3.11.4
 * https://greensock.com
 *
 * Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var _win$2,_doc$2,_docElement,_pluginInitted,_tempDiv,_recentSetterPlugin,_reverting,_windowExists$1=function $(){return typeof window<"u"},_transformProps={},_RAD2DEG=180/Math.PI,_DEG2RAD=Math.PI/180,_atan2=Math.atan2,_bigNum=1e8,_capsExp$1=/([A-Z])/g,_horizontalExp=/(left|right|width|margin|padding|x)/i,_complexExp=/[\s,\(]\S/,_propertyAliases={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},_renderCSSProp=function $(j,it){return it.set(it.t,it.p,Math.round((it.s+it.c*j)*1e4)/1e4+it.u,it)},_renderPropWithEnd=function $(j,it){return it.set(it.t,it.p,j===1?it.e:Math.round((it.s+it.c*j)*1e4)/1e4+it.u,it)},_renderCSSPropWithBeginning=function $(j,it){return it.set(it.t,it.p,j?Math.round((it.s+it.c*j)*1e4)/1e4+it.u:it.b,it)},_renderRoundedCSSProp=function $(j,it){var et=it.s+it.c*j;it.set(it.t,it.p,~~(et+(et<0?-.5:.5))+it.u,it)},_renderNonTweeningValue=function $(j,it){return it.set(it.t,it.p,j?it.e:it.b,it)},_renderNonTweeningValueOnlyAtEnd=function $(j,it){return it.set(it.t,it.p,j!==1?it.b:it.e,it)},_setterCSSStyle=function $(j,it,et){return j.style[it]=et},_setterCSSProp=function $(j,it,et){return j.style.setProperty(it,et)},_setterTransform=function $(j,it,et){return j._gsap[it]=et},_setterScale=function $(j,it,et){return j._gsap.scaleX=j._gsap.scaleY=et},_setterScaleWithRender=function $(j,it,et,ut,dt){var mt=j._gsap;mt.scaleX=mt.scaleY=et,mt.renderTransform(dt,mt)},_setterTransformWithRender=function $(j,it,et,ut,dt){var mt=j._gsap;mt[it]=et,mt.renderTransform(dt,mt)},_transformProp$1="transform",_transformOriginProp=_transformProp$1+"Origin",_saveStyle=function $(j,it){var et=this,ut=this.target,dt=ut.style;if(j in _transformProps){if(this.tfm=this.tfm||{},j!=="transform"&&(j=_propertyAliases[j]||j,~j.indexOf(",")?j.split(",").forEach(function(mt){return et.tfm[mt]=_get(ut,mt)}):this.tfm[j]=ut._gsap.x?ut._gsap[j]:_get(ut,j)),this.props.indexOf(_transformProp$1)>=0)return;ut._gsap.svg&&(this.svgo=ut.getAttribute("data-svg-origin"),this.props.push(_transformOriginProp,it,"")),j=_transformProp$1}(dt||it)&&this.props.push(j,it,dt[j])},_removeIndependentTransforms=function $(j){j.translate&&(j.removeProperty("translate"),j.removeProperty("scale"),j.removeProperty("rotate"))},_revertStyle=function $(){var j=this.props,it=this.target,et=it.style,ut=it._gsap,dt,mt;for(dt=0;dt<j.length;dt+=3)j[dt+1]?it[j[dt]]=j[dt+2]:j[dt+2]?et[j[dt]]=j[dt+2]:et.removeProperty(j[dt].replace(_capsExp$1,"-$1").toLowerCase());if(this.tfm){for(mt in this.tfm)ut[mt]=this.tfm[mt];ut.svg&&(ut.renderTransform(),it.setAttribute("data-svg-origin",this.svgo||"")),dt=_reverting(),dt&&!dt.isStart&&!et[_transformProp$1]&&(_removeIndependentTransforms(et),ut.uncache=1)}},_getStyleSaver=function $(j,it){var et={target:j,props:[],revert:_revertStyle,save:_saveStyle};return it&&it.split(",").forEach(function(ut){return et.save(ut)}),et},_supports3D,_createElement=function $(j,it){var et=_doc$2.createElementNS?_doc$2.createElementNS((it||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),j):_doc$2.createElement(j);return et.style?et:_doc$2.createElement(j)},_getComputedProperty=function $(j,it,et){var ut=getComputedStyle(j);return ut[it]||ut.getPropertyValue(it.replace(_capsExp$1,"-$1").toLowerCase())||ut.getPropertyValue(it)||!et&&$(j,_checkPropPrefix(it)||it,1)||""},_prefixes="O,Moz,ms,Ms,Webkit".split(","),_checkPropPrefix=function $(j,it,et){var ut=it||_tempDiv,dt=ut.style,mt=5;if(j in dt&&!et)return j;for(j=j.charAt(0).toUpperCase()+j.substr(1);mt--&&!(_prefixes[mt]+j in dt););return mt<0?null:(mt===3?"ms":mt>=0?_prefixes[mt]:"")+j},_initCore$1=function $(){_windowExists$1()&&window.document&&(_win$2=window,_doc$2=_win$2.document,_docElement=_doc$2.documentElement,_tempDiv=_createElement("div")||{style:{}},_createElement("div"),_transformProp$1=_checkPropPrefix(_transformProp$1),_transformOriginProp=_transformProp$1+"Origin",_tempDiv.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",_supports3D=!!_checkPropPrefix("perspective"),_reverting=gsap$2.core.reverting,_pluginInitted=1)},_getBBoxHack=function $(j){var it=_createElement("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),et=this.parentNode,ut=this.nextSibling,dt=this.style.cssText,mt;if(_docElement.appendChild(it),it.appendChild(this),this.style.display="block",j)try{mt=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=$}catch{}else this._gsapBBox&&(mt=this._gsapBBox());return et&&(ut?et.insertBefore(this,ut):et.appendChild(this)),_docElement.removeChild(it),this.style.cssText=dt,mt},_getAttributeFallbacks=function $(j,it){for(var et=it.length;et--;)if(j.hasAttribute(it[et]))return j.getAttribute(it[et])},_getBBox=function $(j){var it;try{it=j.getBBox()}catch{it=_getBBoxHack.call(j,!0)}return it&&(it.width||it.height)||j.getBBox===_getBBoxHack||(it=_getBBoxHack.call(j,!0)),it&&!it.width&&!it.x&&!it.y?{x:+_getAttributeFallbacks(j,["x","cx","x1"])||0,y:+_getAttributeFallbacks(j,["y","cy","y1"])||0,width:0,height:0}:it},_isSVG=function $(j){return!!(j.getCTM&&(!j.parentNode||j.ownerSVGElement)&&_getBBox(j))},_removeProperty=function $(j,it){if(it){var et=j.style;it in _transformProps&&it!==_transformOriginProp&&(it=_transformProp$1),et.removeProperty?((it.substr(0,2)==="ms"||it.substr(0,6)==="webkit")&&(it="-"+it),et.removeProperty(it.replace(_capsExp$1,"-$1").toLowerCase())):et.removeAttribute(it)}},_addNonTweeningPT=function $(j,it,et,ut,dt,mt){var yt=new PropTween(j._pt,it,et,0,1,mt?_renderNonTweeningValueOnlyAtEnd:_renderNonTweeningValue);return j._pt=yt,yt.b=ut,yt.e=dt,j._props.push(et),yt},_nonConvertibleUnits={deg:1,rad:1,turn:1},_nonStandardLayouts={grid:1,flex:1},_convertToUnit=function $(j,it,et,ut){var dt=parseFloat(et)||0,mt=(et+"").trim().substr((dt+"").length)||"px",yt=_tempDiv.style,bt=_horizontalExp.test(it),Rt=j.tagName.toLowerCase()==="svg",jt=(Rt?"client":"offset")+(bt?"Width":"Height"),Vt=100,zt=ut==="px",Jt=ut==="%",rr,Yt,dr,Ft;return ut===mt||!dt||_nonConvertibleUnits[ut]||_nonConvertibleUnits[mt]?dt:(mt!=="px"&&!zt&&(dt=$(j,it,et,"px")),Ft=j.getCTM&&_isSVG(j),(Jt||mt==="%")&&(_transformProps[it]||~it.indexOf("adius"))?(rr=Ft?j.getBBox()[bt?"width":"height"]:j[jt],_round$1(Jt?dt/rr*Vt:dt/100*rr)):(yt[bt?"width":"height"]=Vt+(zt?mt:ut),Yt=~it.indexOf("adius")||ut==="em"&&j.appendChild&&!Rt?j:j.parentNode,Ft&&(Yt=(j.ownerSVGElement||{}).parentNode),(!Yt||Yt===_doc$2||!Yt.appendChild)&&(Yt=_doc$2.body),dr=Yt._gsap,dr&&Jt&&dr.width&&bt&&dr.time===_ticker.time&&!dr.uncache?_round$1(dt/dr.width*Vt):((Jt||mt==="%")&&!_nonStandardLayouts[_getComputedProperty(Yt,"display")]&&(yt.position=_getComputedProperty(j,"position")),Yt===j&&(yt.position="static"),Yt.appendChild(_tempDiv),rr=_tempDiv[jt],Yt.removeChild(_tempDiv),yt.position="absolute",bt&&Jt&&(dr=_getCache(Yt),dr.time=_ticker.time,dr.width=Yt[jt]),_round$1(zt?rr*dt/Vt:rr&&dt?Vt/rr*dt:0))))},_get=function $(j,it,et,ut){var dt;return _pluginInitted||_initCore$1(),it in _propertyAliases&&it!=="transform"&&(it=_propertyAliases[it],~it.indexOf(",")&&(it=it.split(",")[0])),_transformProps[it]&&it!=="transform"?(dt=_parseTransform(j,ut),dt=it!=="transformOrigin"?dt[it]:dt.svg?dt.origin:_firstTwoOnly(_getComputedProperty(j,_transformOriginProp))+" "+dt.zOrigin+"px"):(dt=j.style[it],(!dt||dt==="auto"||ut||~(dt+"").indexOf("calc("))&&(dt=_specialProps[it]&&_specialProps[it](j,it,et)||_getComputedProperty(j,it)||_getProperty(j,it)||(it==="opacity"?1:0))),et&&!~(dt+"").trim().indexOf(" ")?_convertToUnit(j,it,dt,et)+et:dt},_tweenComplexCSSString=function $(j,it,et,ut){if(!et||et==="none"){var dt=_checkPropPrefix(it,j,1),mt=dt&&_getComputedProperty(j,dt,1);mt&&mt!==et?(it=dt,et=mt):it==="borderColor"&&(et=_getComputedProperty(j,"borderTopColor"))}var yt=new PropTween(this._pt,j.style,it,0,1,_renderComplexString),bt=0,Rt=0,jt,Vt,zt,Jt,rr,Yt,dr,Ft,Ht,er,pr,or;if(yt.b=et,yt.e=ut,et+="",ut+="",ut==="auto"&&(j.style[it]=ut,ut=_getComputedProperty(j,it)||ut,j.style[it]=et),jt=[et,ut],_colorStringFilter(jt),et=jt[0],ut=jt[1],zt=et.match(_numWithUnitExp)||[],or=ut.match(_numWithUnitExp)||[],or.length){for(;Vt=_numWithUnitExp.exec(ut);)dr=Vt[0],Ht=ut.substring(bt,Vt.index),rr?rr=(rr+1)%5:(Ht.substr(-5)==="rgba("||Ht.substr(-5)==="hsla(")&&(rr=1),dr!==(Yt=zt[Rt++]||"")&&(Jt=parseFloat(Yt)||0,pr=Yt.substr((Jt+"").length),dr.charAt(1)==="="&&(dr=_parseRelative(Jt,dr)+pr),Ft=parseFloat(dr),er=dr.substr((Ft+"").length),bt=_numWithUnitExp.lastIndex-er.length,er||(er=er||_config.units[it]||pr,bt===ut.length&&(ut+=er,yt.e+=er)),pr!==er&&(Jt=_convertToUnit(j,it,Yt,er)||0),yt._pt={_next:yt._pt,p:Ht||Rt===1?Ht:",",s:Jt,c:Ft-Jt,m:rr&&rr<4||it==="zIndex"?Math.round:0});yt.c=bt<ut.length?ut.substring(bt,ut.length):""}else yt.r=it==="display"&&ut==="none"?_renderNonTweeningValueOnlyAtEnd:_renderNonTweeningValue;return _relExp.test(ut)&&(yt.e=0),this._pt=yt,yt},_keywordToPercent={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},_convertKeywordsToPercentages=function $(j){var it=j.split(" "),et=it[0],ut=it[1]||"50%";return(et==="top"||et==="bottom"||ut==="left"||ut==="right")&&(j=et,et=ut,ut=j),it[0]=_keywordToPercent[et]||et,it[1]=_keywordToPercent[ut]||ut,it.join(" ")},_renderClearProps=function $(j,it){if(it.tween&&it.tween._time===it.tween._dur){var et=it.t,ut=et.style,dt=it.u,mt=et._gsap,yt,bt,Rt;if(dt==="all"||dt===!0)ut.cssText="",bt=1;else for(dt=dt.split(","),Rt=dt.length;--Rt>-1;)yt=dt[Rt],_transformProps[yt]&&(bt=1,yt=yt==="transformOrigin"?_transformOriginProp:_transformProp$1),_removeProperty(et,yt);bt&&(_removeProperty(et,_transformProp$1),mt&&(mt.svg&&et.removeAttribute("transform"),_parseTransform(et,1),mt.uncache=1,_removeIndependentTransforms(ut)))}},_specialProps={clearProps:function $(j,it,et,ut,dt){if(dt.data!=="isFromStart"){var mt=j._pt=new PropTween(j._pt,it,et,0,0,_renderClearProps);return mt.u=ut,mt.pr=-10,mt.tween=dt,j._props.push(et),1}}},_identity2DMatrix=[1,0,0,1,0,0],_rotationalProperties={},_isNullTransform=function $(j){return j==="matrix(1, 0, 0, 1, 0, 0)"||j==="none"||!j},_getComputedTransformMatrixAsArray=function $(j){var it=_getComputedProperty(j,_transformProp$1);return _isNullTransform(it)?_identity2DMatrix:it.substr(7).match(_numExp).map(_round$1)},_getMatrix=function $(j,it){var et=j._gsap||_getCache(j),ut=j.style,dt=_getComputedTransformMatrixAsArray(j),mt,yt,bt,Rt;return et.svg&&j.getAttribute("transform")?(bt=j.transform.baseVal.consolidate().matrix,dt=[bt.a,bt.b,bt.c,bt.d,bt.e,bt.f],dt.join(",")==="1,0,0,1,0,0"?_identity2DMatrix:dt):(dt===_identity2DMatrix&&!j.offsetParent&&j!==_docElement&&!et.svg&&(bt=ut.display,ut.display="block",mt=j.parentNode,(!mt||!j.offsetParent)&&(Rt=1,yt=j.nextElementSibling,_docElement.appendChild(j)),dt=_getComputedTransformMatrixAsArray(j),bt?ut.display=bt:_removeProperty(j,"display"),Rt&&(yt?mt.insertBefore(j,yt):mt?mt.appendChild(j):_docElement.removeChild(j))),it&&dt.length>6?[dt[0],dt[1],dt[4],dt[5],dt[12],dt[13]]:dt)},_applySVGOrigin=function $(j,it,et,ut,dt,mt){var yt=j._gsap,bt=dt||_getMatrix(j,!0),Rt=yt.xOrigin||0,jt=yt.yOrigin||0,Vt=yt.xOffset||0,zt=yt.yOffset||0,Jt=bt[0],rr=bt[1],Yt=bt[2],dr=bt[3],Ft=bt[4],Ht=bt[5],er=it.split(" "),pr=parseFloat(er[0])||0,or=parseFloat(er[1])||0,ar,Wt,Zt,sr;et?bt!==_identity2DMatrix&&(Wt=Jt*dr-rr*Yt)&&(Zt=pr*(dr/Wt)+or*(-Yt/Wt)+(Yt*Ht-dr*Ft)/Wt,sr=pr*(-rr/Wt)+or*(Jt/Wt)-(Jt*Ht-rr*Ft)/Wt,pr=Zt,or=sr):(ar=_getBBox(j),pr=ar.x+(~er[0].indexOf("%")?pr/100*ar.width:pr),or=ar.y+(~(er[1]||er[0]).indexOf("%")?or/100*ar.height:or)),ut||ut!==!1&&yt.smooth?(Ft=pr-Rt,Ht=or-jt,yt.xOffset=Vt+(Ft*Jt+Ht*Yt)-Ft,yt.yOffset=zt+(Ft*rr+Ht*dr)-Ht):yt.xOffset=yt.yOffset=0,yt.xOrigin=pr,yt.yOrigin=or,yt.smooth=!!ut,yt.origin=it,yt.originIsAbsolute=!!et,j.style[_transformOriginProp]="0px 0px",mt&&(_addNonTweeningPT(mt,yt,"xOrigin",Rt,pr),_addNonTweeningPT(mt,yt,"yOrigin",jt,or),_addNonTweeningPT(mt,yt,"xOffset",Vt,yt.xOffset),_addNonTweeningPT(mt,yt,"yOffset",zt,yt.yOffset)),j.setAttribute("data-svg-origin",pr+" "+or)},_parseTransform=function $(j,it){var et=j._gsap||new GSCache(j);if("x"in et&&!it&&!et.uncache)return et;var ut=j.style,dt=et.scaleX<0,mt="px",yt="deg",bt=getComputedStyle(j),Rt=_getComputedProperty(j,_transformOriginProp)||"0",jt,Vt,zt,Jt,rr,Yt,dr,Ft,Ht,er,pr,or,ar,Wt,Zt,sr,tr,vr,Vr,hn,cn,gn,tn,Tn,qr,nn,yr,an,sn,Rn,Jr,mr;return jt=Vt=zt=Yt=dr=Ft=Ht=er=pr=0,Jt=rr=1,et.svg=!!(j.getCTM&&_isSVG(j)),bt.translate&&((bt.translate!=="none"||bt.scale!=="none"||bt.rotate!=="none")&&(ut[_transformProp$1]=(bt.translate!=="none"?"translate3d("+(bt.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(bt.rotate!=="none"?"rotate("+bt.rotate+") ":"")+(bt.scale!=="none"?"scale("+bt.scale.split(" ").join(",")+") ":"")+(bt[_transformProp$1]!=="none"?bt[_transformProp$1]:"")),ut.scale=ut.rotate=ut.translate="none"),Wt=_getMatrix(j,et.svg),et.svg&&(et.uncache?(qr=j.getBBox(),Rt=et.xOrigin-qr.x+"px "+(et.yOrigin-qr.y)+"px",Tn=""):Tn=!it&&j.getAttribute("data-svg-origin"),_applySVGOrigin(j,Tn||Rt,!!Tn||et.originIsAbsolute,et.smooth!==!1,Wt)),or=et.xOrigin||0,ar=et.yOrigin||0,Wt!==_identity2DMatrix&&(vr=Wt[0],Vr=Wt[1],hn=Wt[2],cn=Wt[3],jt=gn=Wt[4],Vt=tn=Wt[5],Wt.length===6?(Jt=Math.sqrt(vr*vr+Vr*Vr),rr=Math.sqrt(cn*cn+hn*hn),Yt=vr||Vr?_atan2(Vr,vr)*_RAD2DEG:0,Ht=hn||cn?_atan2(hn,cn)*_RAD2DEG+Yt:0,Ht&&(rr*=Math.abs(Math.cos(Ht*_DEG2RAD))),et.svg&&(jt-=or-(or*vr+ar*hn),Vt-=ar-(or*Vr+ar*cn))):(mr=Wt[6],Rn=Wt[7],yr=Wt[8],an=Wt[9],sn=Wt[10],Jr=Wt[11],jt=Wt[12],Vt=Wt[13],zt=Wt[14],Zt=_atan2(mr,sn),dr=Zt*_RAD2DEG,Zt&&(sr=Math.cos(-Zt),tr=Math.sin(-Zt),Tn=gn*sr+yr*tr,qr=tn*sr+an*tr,nn=mr*sr+sn*tr,yr=gn*-tr+yr*sr,an=tn*-tr+an*sr,sn=mr*-tr+sn*sr,Jr=Rn*-tr+Jr*sr,gn=Tn,tn=qr,mr=nn),Zt=_atan2(-hn,sn),Ft=Zt*_RAD2DEG,Zt&&(sr=Math.cos(-Zt),tr=Math.sin(-Zt),Tn=vr*sr-yr*tr,qr=Vr*sr-an*tr,nn=hn*sr-sn*tr,Jr=cn*tr+Jr*sr,vr=Tn,Vr=qr,hn=nn),Zt=_atan2(Vr,vr),Yt=Zt*_RAD2DEG,Zt&&(sr=Math.cos(Zt),tr=Math.sin(Zt),Tn=vr*sr+Vr*tr,qr=gn*sr+tn*tr,Vr=Vr*sr-vr*tr,tn=tn*sr-gn*tr,vr=Tn,gn=qr),dr&&Math.abs(dr)+Math.abs(Yt)>359.9&&(dr=Yt=0,Ft=180-Ft),Jt=_round$1(Math.sqrt(vr*vr+Vr*Vr+hn*hn)),rr=_round$1(Math.sqrt(tn*tn+mr*mr)),Zt=_atan2(gn,tn),Ht=Math.abs(Zt)>2e-4?Zt*_RAD2DEG:0,pr=Jr?1/(Jr<0?-Jr:Jr):0),et.svg&&(Tn=j.getAttribute("transform"),et.forceCSS=j.setAttribute("transform","")||!_isNullTransform(_getComputedProperty(j,_transformProp$1)),Tn&&j.setAttribute("transform",Tn))),Math.abs(Ht)>90&&Math.abs(Ht)<270&&(dt?(Jt*=-1,Ht+=Yt<=0?180:-180,Yt+=Yt<=0?180:-180):(rr*=-1,Ht+=Ht<=0?180:-180)),it=it||et.uncache,et.x=jt-((et.xPercent=jt&&(!it&&et.xPercent||(Math.round(j.offsetWidth/2)===Math.round(-jt)?-50:0)))?j.offsetWidth*et.xPercent/100:0)+mt,et.y=Vt-((et.yPercent=Vt&&(!it&&et.yPercent||(Math.round(j.offsetHeight/2)===Math.round(-Vt)?-50:0)))?j.offsetHeight*et.yPercent/100:0)+mt,et.z=zt+mt,et.scaleX=_round$1(Jt),et.scaleY=_round$1(rr),et.rotation=_round$1(Yt)+yt,et.rotationX=_round$1(dr)+yt,et.rotationY=_round$1(Ft)+yt,et.skewX=Ht+yt,et.skewY=er+yt,et.transformPerspective=pr+mt,(et.zOrigin=parseFloat(Rt.split(" ")[2])||0)&&(ut[_transformOriginProp]=_firstTwoOnly(Rt)),et.xOffset=et.yOffset=0,et.force3D=_config.force3D,et.renderTransform=et.svg?_renderSVGTransforms:_supports3D?_renderCSSTransforms:_renderNon3DTransforms,et.uncache=0,et},_firstTwoOnly=function $(j){return(j=j.split(" "))[0]+" "+j[1]},_addPxTranslate=function $(j,it,et){var ut=getUnit(it);return _round$1(parseFloat(it)+parseFloat(_convertToUnit(j,"x",et+"px",ut)))+ut},_renderNon3DTransforms=function $(j,it){it.z="0px",it.rotationY=it.rotationX="0deg",it.force3D=0,_renderCSSTransforms(j,it)},_zeroDeg="0deg",_zeroPx="0px",_endParenthesis=") ",_renderCSSTransforms=function $(j,it){var et=it||this,ut=et.xPercent,dt=et.yPercent,mt=et.x,yt=et.y,bt=et.z,Rt=et.rotation,jt=et.rotationY,Vt=et.rotationX,zt=et.skewX,Jt=et.skewY,rr=et.scaleX,Yt=et.scaleY,dr=et.transformPerspective,Ft=et.force3D,Ht=et.target,er=et.zOrigin,pr="",or=Ft==="auto"&&j&&j!==1||Ft===!0;if(er&&(Vt!==_zeroDeg||jt!==_zeroDeg)){var ar=parseFloat(jt)*_DEG2RAD,Wt=Math.sin(ar),Zt=Math.cos(ar),sr;ar=parseFloat(Vt)*_DEG2RAD,sr=Math.cos(ar),mt=_addPxTranslate(Ht,mt,Wt*sr*-er),yt=_addPxTranslate(Ht,yt,-Math.sin(ar)*-er),bt=_addPxTranslate(Ht,bt,Zt*sr*-er+er)}dr!==_zeroPx&&(pr+="perspective("+dr+_endParenthesis),(ut||dt)&&(pr+="translate("+ut+"%, "+dt+"%) "),(or||mt!==_zeroPx||yt!==_zeroPx||bt!==_zeroPx)&&(pr+=bt!==_zeroPx||or?"translate3d("+mt+", "+yt+", "+bt+") ":"translate("+mt+", "+yt+_endParenthesis),Rt!==_zeroDeg&&(pr+="rotate("+Rt+_endParenthesis),jt!==_zeroDeg&&(pr+="rotateY("+jt+_endParenthesis),Vt!==_zeroDeg&&(pr+="rotateX("+Vt+_endParenthesis),(zt!==_zeroDeg||Jt!==_zeroDeg)&&(pr+="skew("+zt+", "+Jt+_endParenthesis),(rr!==1||Yt!==1)&&(pr+="scale("+rr+", "+Yt+_endParenthesis),Ht.style[_transformProp$1]=pr||"translate(0, 0)"},_renderSVGTransforms=function $(j,it){var et=it||this,ut=et.xPercent,dt=et.yPercent,mt=et.x,yt=et.y,bt=et.rotation,Rt=et.skewX,jt=et.skewY,Vt=et.scaleX,zt=et.scaleY,Jt=et.target,rr=et.xOrigin,Yt=et.yOrigin,dr=et.xOffset,Ft=et.yOffset,Ht=et.forceCSS,er=parseFloat(mt),pr=parseFloat(yt),or,ar,Wt,Zt,sr;bt=parseFloat(bt),Rt=parseFloat(Rt),jt=parseFloat(jt),jt&&(jt=parseFloat(jt),Rt+=jt,bt+=jt),bt||Rt?(bt*=_DEG2RAD,Rt*=_DEG2RAD,or=Math.cos(bt)*Vt,ar=Math.sin(bt)*Vt,Wt=Math.sin(bt-Rt)*-zt,Zt=Math.cos(bt-Rt)*zt,Rt&&(jt*=_DEG2RAD,sr=Math.tan(Rt-jt),sr=Math.sqrt(1+sr*sr),Wt*=sr,Zt*=sr,jt&&(sr=Math.tan(jt),sr=Math.sqrt(1+sr*sr),or*=sr,ar*=sr)),or=_round$1(or),ar=_round$1(ar),Wt=_round$1(Wt),Zt=_round$1(Zt)):(or=Vt,Zt=zt,ar=Wt=0),(er&&!~(mt+"").indexOf("px")||pr&&!~(yt+"").indexOf("px"))&&(er=_convertToUnit(Jt,"x",mt,"px"),pr=_convertToUnit(Jt,"y",yt,"px")),(rr||Yt||dr||Ft)&&(er=_round$1(er+rr-(rr*or+Yt*Wt)+dr),pr=_round$1(pr+Yt-(rr*ar+Yt*Zt)+Ft)),(ut||dt)&&(sr=Jt.getBBox(),er=_round$1(er+ut/100*sr.width),pr=_round$1(pr+dt/100*sr.height)),sr="matrix("+or+","+ar+","+Wt+","+Zt+","+er+","+pr+")",Jt.setAttribute("transform",sr),Ht&&(Jt.style[_transformProp$1]=sr)},_addRotationalPropTween=function $(j,it,et,ut,dt){var mt=360,yt=_isString$1(dt),bt=parseFloat(dt)*(yt&&~dt.indexOf("rad")?_RAD2DEG:1),Rt=bt-ut,jt=ut+Rt+"deg",Vt,zt;return yt&&(Vt=dt.split("_")[1],Vt==="short"&&(Rt%=mt,Rt!==Rt%(mt/2)&&(Rt+=Rt<0?mt:-mt)),Vt==="cw"&&Rt<0?Rt=(Rt+mt*_bigNum)%mt-~~(Rt/mt)*mt:Vt==="ccw"&&Rt>0&&(Rt=(Rt-mt*_bigNum)%mt-~~(Rt/mt)*mt)),j._pt=zt=new PropTween(j._pt,it,et,ut,Rt,_renderPropWithEnd),zt.e=jt,zt.u="deg",j._props.push(et),zt},_assign=function $(j,it){for(var et in it)j[et]=it[et];return j},_addRawTransformPTs=function $(j,it,et){var ut=_assign({},et._gsap),dt="perspective,force3D,transformOrigin,svgOrigin",mt=et.style,yt,bt,Rt,jt,Vt,zt,Jt,rr;ut.svg?(Rt=et.getAttribute("transform"),et.setAttribute("transform",""),mt[_transformProp$1]=it,yt=_parseTransform(et,1),_removeProperty(et,_transformProp$1),et.setAttribute("transform",Rt)):(Rt=getComputedStyle(et)[_transformProp$1],mt[_transformProp$1]=it,yt=_parseTransform(et,1),mt[_transformProp$1]=Rt);for(bt in _transformProps)Rt=ut[bt],jt=yt[bt],Rt!==jt&&dt.indexOf(bt)<0&&(Jt=getUnit(Rt),rr=getUnit(jt),Vt=Jt!==rr?_convertToUnit(et,bt,Rt,rr):parseFloat(Rt),zt=parseFloat(jt),j._pt=new PropTween(j._pt,yt,bt,Vt,zt-Vt,_renderCSSProp),j._pt.u=rr||0,j._props.push(bt));_assign(yt,ut)};_forEachName("padding,margin,Width,Radius",function($,j){var it="Top",et="Right",ut="Bottom",dt="Left",mt=(j<3?[it,et,ut,dt]:[it+dt,it+et,ut+et,ut+dt]).map(function(yt){return j<2?$+yt:"border"+yt+$});_specialProps[j>1?"border"+$:$]=function(yt,bt,Rt,jt,Vt){var zt,Jt;if(arguments.length<4)return zt=mt.map(function(rr){return _get(yt,rr,Rt)}),Jt=zt.join(" "),Jt.split(zt[0]).length===5?zt[0]:Jt;zt=(jt+"").split(" "),Jt={},mt.forEach(function(rr,Yt){return Jt[rr]=zt[Yt]=zt[Yt]||zt[(Yt-1)/2|0]}),yt.init(bt,Jt,Vt)}});var CSSPlugin={name:"css",register:_initCore$1,targetTest:function $(j){return j.style&&j.nodeType},init:function $(j,it,et,ut,dt){var mt=this._props,yt=j.style,bt=et.vars.startAt,Rt,jt,Vt,zt,Jt,rr,Yt,dr,Ft,Ht,er,pr,or,ar,Wt,Zt;_pluginInitted||_initCore$1(),this.styles=this.styles||_getStyleSaver(j),Zt=this.styles.props,this.tween=et;for(Yt in it)if(Yt!=="autoRound"&&(jt=it[Yt],!(_plugins[Yt]&&_checkPlugin(Yt,it,et,ut,j,dt)))){if(Jt=typeof jt,rr=_specialProps[Yt],Jt==="function"&&(jt=jt.call(et,ut,j,dt),Jt=typeof jt),Jt==="string"&&~jt.indexOf("random(")&&(jt=_replaceRandom(jt)),rr)rr(this,j,Yt,jt,et)&&(Wt=1);else if(Yt.substr(0,2)==="--")Rt=(getComputedStyle(j).getPropertyValue(Yt)+"").trim(),jt+="",_colorExp.lastIndex=0,_colorExp.test(Rt)||(dr=getUnit(Rt),Ft=getUnit(jt)),Ft?dr!==Ft&&(Rt=_convertToUnit(j,Yt,Rt,Ft)+Ft):dr&&(jt+=dr),this.add(yt,"setProperty",Rt,jt,ut,dt,0,0,Yt),mt.push(Yt),Zt.push(Yt,0,yt[Yt]);else if(Jt!=="undefined"){if(bt&&Yt in bt?(Rt=typeof bt[Yt]=="function"?bt[Yt].call(et,ut,j,dt):bt[Yt],_isString$1(Rt)&&~Rt.indexOf("random(")&&(Rt=_replaceRandom(Rt)),getUnit(Rt+"")||(Rt+=_config.units[Yt]||getUnit(_get(j,Yt))||""),(Rt+"").charAt(1)==="="&&(Rt=_get(j,Yt))):Rt=_get(j,Yt),zt=parseFloat(Rt),Ht=Jt==="string"&&jt.charAt(1)==="="&&jt.substr(0,2),Ht&&(jt=jt.substr(2)),Vt=parseFloat(jt),Yt in _propertyAliases&&(Yt==="autoAlpha"&&(zt===1&&_get(j,"visibility")==="hidden"&&Vt&&(zt=0),Zt.push("visibility",0,yt.visibility),_addNonTweeningPT(this,yt,"visibility",zt?"inherit":"hidden",Vt?"inherit":"hidden",!Vt)),Yt!=="scale"&&Yt!=="transform"&&(Yt=_propertyAliases[Yt],~Yt.indexOf(",")&&(Yt=Yt.split(",")[0]))),er=Yt in _transformProps,er){if(this.styles.save(Yt),pr||(or=j._gsap,or.renderTransform&&!it.parseTransform||_parseTransform(j,it.parseTransform),ar=it.smoothOrigin!==!1&&or.smooth,pr=this._pt=new PropTween(this._pt,yt,_transformProp$1,0,1,or.renderTransform,or,0,-1),pr.dep=1),Yt==="scale")this._pt=new PropTween(this._pt,or,"scaleY",or.scaleY,(Ht?_parseRelative(or.scaleY,Ht+Vt):Vt)-or.scaleY||0,_renderCSSProp),this._pt.u=0,mt.push("scaleY",Yt),Yt+="X";else if(Yt==="transformOrigin"){Zt.push(_transformOriginProp,0,yt[_transformOriginProp]),jt=_convertKeywordsToPercentages(jt),or.svg?_applySVGOrigin(j,jt,0,ar,0,this):(Ft=parseFloat(jt.split(" ")[2])||0,Ft!==or.zOrigin&&_addNonTweeningPT(this,or,"zOrigin",or.zOrigin,Ft),_addNonTweeningPT(this,yt,Yt,_firstTwoOnly(Rt),_firstTwoOnly(jt)));continue}else if(Yt==="svgOrigin"){_applySVGOrigin(j,jt,1,ar,0,this);continue}else if(Yt in _rotationalProperties){_addRotationalPropTween(this,or,Yt,zt,Ht?_parseRelative(zt,Ht+jt):jt);continue}else if(Yt==="smoothOrigin"){_addNonTweeningPT(this,or,"smooth",or.smooth,jt);continue}else if(Yt==="force3D"){or[Yt]=jt;continue}else if(Yt==="transform"){_addRawTransformPTs(this,jt,j);continue}}else Yt in yt||(Yt=_checkPropPrefix(Yt)||Yt);if(er||(Vt||Vt===0)&&(zt||zt===0)&&!_complexExp.test(jt)&&Yt in yt)dr=(Rt+"").substr((zt+"").length),Vt||(Vt=0),Ft=getUnit(jt)||(Yt in _config.units?_config.units[Yt]:dr),dr!==Ft&&(zt=_convertToUnit(j,Yt,Rt,Ft)),this._pt=new PropTween(this._pt,er?or:yt,Yt,zt,(Ht?_parseRelative(zt,Ht+Vt):Vt)-zt,!er&&(Ft==="px"||Yt==="zIndex")&&it.autoRound!==!1?_renderRoundedCSSProp:_renderCSSProp),this._pt.u=Ft||0,dr!==Ft&&Ft!=="%"&&(this._pt.b=Rt,this._pt.r=_renderCSSPropWithBeginning);else if(Yt in yt)_tweenComplexCSSString.call(this,j,Yt,Rt,Ht?Ht+jt:jt);else if(Yt in j)this.add(j,Yt,Rt||j[Yt],Ht?Ht+jt:jt,ut,dt);else if(Yt!=="parseTransform"){_missingPlugin(Yt,jt);continue}er||(Yt in yt?Zt.push(Yt,0,yt[Yt]):Zt.push(Yt,1,Rt||j[Yt])),mt.push(Yt)}}Wt&&_sortPropTweensByPriority(this)},render:function $(j,it){if(it.tween._time||!_reverting())for(var et=it._pt;et;)et.r(j,et.d),et=et._next;else it.styles.revert()},get:_get,aliases:_propertyAliases,getSetter:function $(j,it,et){var ut=_propertyAliases[it];return ut&&ut.indexOf(",")<0&&(it=ut),it in _transformProps&&it!==_transformOriginProp&&(j._gsap.x||_get(j,"x"))?et&&_recentSetterPlugin===et?it==="scale"?_setterScale:_setterTransform:(_recentSetterPlugin=et||{})&&(it==="scale"?_setterScaleWithRender:_setterTransformWithRender):j.style&&!_isUndefined(j.style[it])?_setterCSSStyle:~it.indexOf("-")?_setterCSSProp:_getSetter(j,it)},core:{_removeProperty,_getMatrix}};gsap$2.utils.checkPrefix=_checkPropPrefix;gsap$2.core.getStyleSaver=_getStyleSaver;(function($,j,it,et){var ut=_forEachName($+","+j+","+it,function(dt){_transformProps[dt]=1});_forEachName(j,function(dt){_config.units[dt]="deg",_rotationalProperties[dt]=1}),_propertyAliases[ut[13]]=$+","+j,_forEachName(et,function(dt){var mt=dt.split(":");_propertyAliases[mt[1]]=ut[mt[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");_forEachName("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function($){_config.units[$]="px"});gsap$2.registerPlugin(CSSPlugin);var gsapWithCSS=gsap$2.registerPlugin(CSSPlugin)||gsap$2;gsapWithCSS.core.Tween;function _defineProperties$1($,j){for(var it=0;it<j.length;it++){var et=j[it];et.enumerable=et.enumerable||!1,et.configurable=!0,"value"in et&&(et.writable=!0),Object.defineProperty($,et.key,et)}}function _createClass$1($,j,it){return j&&_defineProperties$1($.prototype,j),it&&_defineProperties$1($,it),$}/*!
 * Observer 3.11.4
 * https://greensock.com
 *
 * @license Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var gsap$1,_coreInitted$1,_win$1,_doc$1,_docEl$1,_body$1,_isTouch,_pointerType,ScrollTrigger$1,_root$1,_normalizer$1,_eventTypes,_context$1,_getGSAP$1=function $(){return gsap$1||typeof window<"u"&&(gsap$1=window.gsap)&&gsap$1.registerPlugin&&gsap$1},_startup$1=1,_observers=[],_scrollers=[],_proxies=[],_getTime$1=Date.now,_bridge=function $(j,it){return it},_integrate=function $(){var j=ScrollTrigger$1.core,it=j.bridge||{},et=j._scrollers,ut=j._proxies;et.push.apply(et,_scrollers),ut.push.apply(ut,_proxies),_scrollers=et,_proxies=ut,_bridge=function(mt,yt){return it[mt](yt)}},_getProxyProp=function $(j,it){return~_proxies.indexOf(j)&&_proxies[_proxies.indexOf(j)+1][it]},_isViewport$1=function $(j){return!!~_root$1.indexOf(j)},_addListener$1=function $(j,it,et,ut,dt){return j.addEventListener(it,et,{passive:!ut,capture:!!dt})},_removeListener$1=function $(j,it,et,ut){return j.removeEventListener(it,et,!!ut)},_scrollLeft="scrollLeft",_scrollTop="scrollTop",_onScroll$1=function $(){return _normalizer$1&&_normalizer$1.isPressed||_scrollers.cache++},_scrollCacheFunc=function $(j,it){var et=function ut(dt){if(dt||dt===0){_startup$1&&(_win$1.history.scrollRestoration="manual");var mt=_normalizer$1&&_normalizer$1.isPressed;dt=ut.v=Math.round(dt)||(_normalizer$1&&_normalizer$1.iOS?1:0),j(dt),ut.cacheID=_scrollers.cache,mt&&_bridge("ss",dt)}else(it||_scrollers.cache!==ut.cacheID||_bridge("ref"))&&(ut.cacheID=_scrollers.cache,ut.v=j());return ut.v+ut.offset};return et.offset=0,j&&et},_horizontal={s:_scrollLeft,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:_scrollCacheFunc(function($){return arguments.length?_win$1.scrollTo($,_vertical.sc()):_win$1.pageXOffset||_doc$1[_scrollLeft]||_docEl$1[_scrollLeft]||_body$1[_scrollLeft]||0})},_vertical={s:_scrollTop,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:_horizontal,sc:_scrollCacheFunc(function($){return arguments.length?_win$1.scrollTo(_horizontal.sc(),$):_win$1.pageYOffset||_doc$1[_scrollTop]||_docEl$1[_scrollTop]||_body$1[_scrollTop]||0})},_getTarget=function $(j){return gsap$1.utils.toArray(j)[0]||(typeof j=="string"&&gsap$1.config().nullTargetWarn!==!1?console.warn("Element not found:",j):null)},_getScrollFunc=function $(j,it){var et=it.s,ut=it.sc;_isViewport$1(j)&&(j=_doc$1.scrollingElement||_docEl$1);var dt=_scrollers.indexOf(j),mt=ut===_vertical.sc?1:2;!~dt&&(dt=_scrollers.push(j)-1),_scrollers[dt+mt]||j.addEventListener("scroll",_onScroll$1);var yt=_scrollers[dt+mt],bt=yt||(_scrollers[dt+mt]=_scrollCacheFunc(_getProxyProp(j,et),!0)||(_isViewport$1(j)?ut:_scrollCacheFunc(function(Rt){return arguments.length?j[et]=Rt:j[et]})));return bt.target=j,yt||(bt.smooth=gsap$1.getProperty(j,"scrollBehavior")==="smooth"),bt},_getVelocityProp=function $(j,it,et){var ut=j,dt=j,mt=_getTime$1(),yt=mt,bt=it||50,Rt=Math.max(500,bt*3),jt=function(rr,Yt){var dr=_getTime$1();Yt||dr-mt>bt?(dt=ut,ut=rr,yt=mt,mt=dr):et?ut+=rr:ut=dt+(rr-dt)/(dr-yt)*(mt-yt)},Vt=function(){dt=ut=et?0:ut,yt=mt=0},zt=function(rr){var Yt=yt,dr=dt,Ft=_getTime$1();return(rr||rr===0)&&rr!==ut&&jt(rr),mt===yt||Ft-yt>Rt?0:(ut+(et?dr:-dr))/((et?Ft:mt)-Yt)*1e3};return{update:jt,reset:Vt,getVelocity:zt}},_getEvent=function $(j,it){return it&&!j._gsapAllow&&j.preventDefault(),j.changedTouches?j.changedTouches[0]:j},_getAbsoluteMax=function $(j){var it=Math.max.apply(Math,j),et=Math.min.apply(Math,j);return Math.abs(it)>=Math.abs(et)?it:et},_setScrollTrigger=function $(){ScrollTrigger$1=gsap$1.core.globals().ScrollTrigger,ScrollTrigger$1&&ScrollTrigger$1.core&&_integrate()},_initCore=function $(j){return gsap$1=j||_getGSAP$1(),gsap$1&&typeof document<"u"&&document.body&&(_win$1=window,_doc$1=document,_docEl$1=_doc$1.documentElement,_body$1=_doc$1.body,_root$1=[_win$1,_doc$1,_docEl$1,_body$1],gsap$1.utils.clamp,_context$1=gsap$1.core.context||function(){},_pointerType="onpointerenter"in _body$1?"pointer":"mouse",_isTouch=Observer.isTouch=_win$1.matchMedia&&_win$1.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in _win$1||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,_eventTypes=Observer.eventTypes=("ontouchstart"in _docEl$1?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in _docEl$1?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return _startup$1=0},500),_setScrollTrigger(),_coreInitted$1=1),_coreInitted$1};_horizontal.op=_vertical;_scrollers.cache=0;var Observer=function(){function $(it){this.init(it)}var j=$.prototype;return j.init=function(et){_coreInitted$1||_initCore(gsap$1)||console.warn("Please gsap.registerPlugin(Observer)"),ScrollTrigger$1||_setScrollTrigger();var ut=et.tolerance,dt=et.dragMinimum,mt=et.type,yt=et.target,bt=et.lineHeight,Rt=et.debounce,jt=et.preventDefault,Vt=et.onStop,zt=et.onStopDelay,Jt=et.ignore,rr=et.wheelSpeed,Yt=et.event,dr=et.onDragStart,Ft=et.onDragEnd,Ht=et.onDrag,er=et.onPress,pr=et.onRelease,or=et.onRight,ar=et.onLeft,Wt=et.onUp,Zt=et.onDown,sr=et.onChangeX,tr=et.onChangeY,vr=et.onChange,Vr=et.onToggleX,hn=et.onToggleY,cn=et.onHover,gn=et.onHoverEnd,tn=et.onMove,Tn=et.ignoreCheck,qr=et.isNormalizer,nn=et.onGestureStart,yr=et.onGestureEnd,an=et.onWheel,sn=et.onEnable,Rn=et.onDisable,Jr=et.onClick,mr=et.scrollSpeed,Ar=et.capture,jr=et.allowClicks,On=et.lockAxis,$n=et.onLockAxis;this.target=yt=_getTarget(yt)||_docEl$1,this.vars=et,Jt&&(Jt=gsap$1.utils.toArray(Jt)),ut=ut||1e-9,dt=dt||0,rr=rr||1,mr=mr||1,mt=mt||"wheel,touch,pointer",Rt=Rt!==!1,bt||(bt=parseFloat(_win$1.getComputedStyle(_body$1).lineHeight)||22);var jn,As,ps,qs,Vs,Eo,js,mn=this,uo=0,_o=0,Vl=_getScrollFunc(yt,_horizontal),Vo=_getScrollFunc(yt,_vertical),Oo=Vl(),Lo=Vo(),No=~mt.indexOf("touch")&&!~mt.indexOf("pointer")&&_eventTypes[0]==="pointerdown",eu=_isViewport$1(yt),So=yt.ownerDocument||_doc$1,co=[0,0,0],Il=[0,0,0],ga=0,Go=function(){return ga=_getTime$1()},Up=function(rs,In){return(mn.event=rs)&&Jt&&~Jt.indexOf(rs.target)||In&&No&&rs.pointerType!=="touch"||Tn&&Tn(rs,In)},ba=function(){mn._vx.reset(),mn._vy.reset(),As.pause(),Vt&&Vt(mn)},bu=function(){var rs=mn.deltaX=_getAbsoluteMax(co),In=mn.deltaY=_getAbsoluteMax(Il),Ns=Math.abs(rs)>=ut,Fs=Math.abs(In)>=ut;vr&&(Ns||Fs)&&vr(mn,rs,In,co,Il),Ns&&(or&&mn.deltaX>0&&or(mn),ar&&mn.deltaX<0&&ar(mn),sr&&sr(mn),Vr&&mn.deltaX<0!=uo<0&&Vr(mn),uo=mn.deltaX,co[0]=co[1]=co[2]=0),Fs&&(Zt&&mn.deltaY>0&&Zt(mn),Wt&&mn.deltaY<0&&Wt(mn),tr&&tr(mn),hn&&mn.deltaY<0!=_o<0&&hn(mn),_o=mn.deltaY,Il[0]=Il[1]=Il[2]=0),(qs||ps)&&(tn&&tn(mn),ps&&(Ht(mn),ps=!1),qs=!1),Eo&&!(Eo=!1)&&$n&&$n(mn),Vs&&(an(mn),Vs=!1),jn=0},Ko=function(rs,In,Ns){co[Ns]+=rs,Il[Ns]+=In,mn._vx.update(rs),mn._vy.update(In),Rt?jn||(jn=requestAnimationFrame(bu)):bu()},Lu=function(rs,In){On&&!js&&(mn.axis=js=Math.abs(rs)>Math.abs(In)?"x":"y",Eo=!0),js!=="y"&&(co[2]+=rs,mn._vx.update(rs,!0)),js!=="x"&&(Il[2]+=In,mn._vy.update(In,!0)),Rt?jn||(jn=requestAnimationFrame(bu)):bu()},$p=function(rs){if(!Up(rs,1)){rs=_getEvent(rs,jt);var In=rs.clientX,Ns=rs.clientY,Fs=In-mn.x,Ps=Ns-mn.y,Xo=mn.isDragging;mn.x=In,mn.y=Ns,(Xo||Math.abs(mn.startX-In)>=dt||Math.abs(mn.startY-Ns)>=dt)&&(Ht&&(ps=!0),Xo||(mn.isDragging=!0),Lu(Fs,Ps),Xo||dr&&dr(mn))}},ys=mn.onPress=function(Js){Up(Js,1)||(mn.axis=js=null,As.pause(),mn.isPressed=!0,Js=_getEvent(Js),uo=_o=0,mn.startX=mn.x=Js.clientX,mn.startY=mn.y=Js.clientY,mn._vx.reset(),mn._vy.reset(),_addListener$1(qr?yt:So,_eventTypes[1],$p,jt,!0),mn.deltaX=mn.deltaY=0,er&&er(mn))},Bo=function(rs){if(!Up(rs,1)){_removeListener$1(qr?yt:So,_eventTypes[1],$p,!0);var In=!isNaN(mn.y-mn.startY),Ns=mn.isDragging&&(Math.abs(mn.x-mn.startX)>3||Math.abs(mn.y-mn.startY)>3),Fs=_getEvent(rs);!Ns&&In&&(mn._vx.reset(),mn._vy.reset(),jt&&jr&&gsap$1.delayedCall(.08,function(){if(_getTime$1()-ga>300&&!rs.defaultPrevented){if(rs.target.click)rs.target.click();else if(So.createEvent){var Ps=So.createEvent("MouseEvents");Ps.initMouseEvent("click",!0,!0,_win$1,1,Fs.screenX,Fs.screenY,Fs.clientX,Fs.clientY,!1,!1,!1,!1,0,null),rs.target.dispatchEvent(Ps)}}})),mn.isDragging=mn.isGesturing=mn.isPressed=!1,Vt&&!qr&&As.restart(!0),Ft&&Ns&&Ft(mn),pr&&pr(mn,Ns)}},su=function(rs){return rs.touches&&rs.touches.length>1&&(mn.isGesturing=!0)&&nn(rs,mn.isDragging)},Ol=function(){return(mn.isGesturing=!1)||yr(mn)},pp=function(rs){if(!Up(rs)){var In=Vl(),Ns=Vo();Ko((In-Oo)*mr,(Ns-Lo)*mr,1),Oo=In,Lo=Ns,Vt&&As.restart(!0)}},_c=function(rs){if(!Up(rs)){rs=_getEvent(rs,jt),an&&(Vs=!0);var In=(rs.deltaMode===1?bt:rs.deltaMode===2?_win$1.innerHeight:1)*rr;Ko(rs.deltaX*In,rs.deltaY*In,0),Vt&&!qr&&As.restart(!0)}},Cp=function(rs){if(!Up(rs)){var In=rs.clientX,Ns=rs.clientY,Fs=In-mn.x,Ps=Ns-mn.y;mn.x=In,mn.y=Ns,qs=!0,(Fs||Ps)&&Lu(Fs,Ps)}},Yr=function(rs){mn.event=rs,cn(mn)},Cl=function(rs){mn.event=rs,gn(mn)},_d=function(rs){return Up(rs)||_getEvent(rs,jt)&&Jr(mn)};As=mn._dc=gsap$1.delayedCall(zt||.25,ba).pause(),mn.deltaX=mn.deltaY=0,mn._vx=_getVelocityProp(0,50,!0),mn._vy=_getVelocityProp(0,50,!0),mn.scrollX=Vl,mn.scrollY=Vo,mn.isDragging=mn.isGesturing=mn.isPressed=!1,_context$1(this),mn.enable=function(Js){return mn.isEnabled||(_addListener$1(eu?So:yt,"scroll",_onScroll$1),mt.indexOf("scroll")>=0&&_addListener$1(eu?So:yt,"scroll",pp,jt,Ar),mt.indexOf("wheel")>=0&&_addListener$1(yt,"wheel",_c,jt,Ar),(mt.indexOf("touch")>=0&&_isTouch||mt.indexOf("pointer")>=0)&&(_addListener$1(yt,_eventTypes[0],ys,jt,Ar),_addListener$1(So,_eventTypes[2],Bo),_addListener$1(So,_eventTypes[3],Bo),jr&&_addListener$1(yt,"click",Go,!1,!0),Jr&&_addListener$1(yt,"click",_d),nn&&_addListener$1(So,"gesturestart",su),yr&&_addListener$1(So,"gestureend",Ol),cn&&_addListener$1(yt,_pointerType+"enter",Yr),gn&&_addListener$1(yt,_pointerType+"leave",Cl),tn&&_addListener$1(yt,_pointerType+"move",Cp)),mn.isEnabled=!0,Js&&Js.type&&ys(Js),sn&&sn(mn)),mn},mn.disable=function(){mn.isEnabled&&(_observers.filter(function(Js){return Js!==mn&&_isViewport$1(Js.target)}).length||_removeListener$1(eu?So:yt,"scroll",_onScroll$1),mn.isPressed&&(mn._vx.reset(),mn._vy.reset(),_removeListener$1(qr?yt:So,_eventTypes[1],$p,!0)),_removeListener$1(eu?So:yt,"scroll",pp,Ar),_removeListener$1(yt,"wheel",_c,Ar),_removeListener$1(yt,_eventTypes[0],ys,Ar),_removeListener$1(So,_eventTypes[2],Bo),_removeListener$1(So,_eventTypes[3],Bo),_removeListener$1(yt,"click",Go,!0),_removeListener$1(yt,"click",_d),_removeListener$1(So,"gesturestart",su),_removeListener$1(So,"gestureend",Ol),_removeListener$1(yt,_pointerType+"enter",Yr),_removeListener$1(yt,_pointerType+"leave",Cl),_removeListener$1(yt,_pointerType+"move",Cp),mn.isEnabled=mn.isPressed=mn.isDragging=!1,Rn&&Rn(mn))},mn.kill=mn.revert=function(){mn.disable();var Js=_observers.indexOf(mn);Js>=0&&_observers.splice(Js,1),_normalizer$1===mn&&(_normalizer$1=0)},_observers.push(mn),qr&&_isViewport$1(yt)&&(_normalizer$1=mn),mn.enable(Yt)},_createClass$1($,[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}]),$}();Observer.version="3.11.4";Observer.create=function($){return new Observer($)};Observer.register=_initCore;Observer.getAll=function(){return _observers.slice()};Observer.getById=function($){return _observers.filter(function(j){return j.vars.id===$})[0]};_getGSAP$1()&&gsap$1.registerPlugin(Observer);/*!
 * ScrollTrigger 3.11.4
 * https://greensock.com
 *
 * @license Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var gsap,_coreInitted,_win,_doc,_docEl,_body,_root,_resizeDelay,_toArray,_clamp,_time2,_syncInterval,_refreshing,_pointerIsDown,_transformProp,_i,_prevWidth,_prevHeight,_autoRefresh,_sort,_suppressOverwrites,_ignoreResize,_normalizer,_ignoreMobileResize,_baseScreenHeight,_baseScreenWidth,_fixIOSBug,_context,_scrollRestoration,_limitCallbacks,_startup=1,_getTime=Date.now,_time1=_getTime(),_lastScrollTime=0,_enabled=0,_pointerDownHandler=function $(){return _pointerIsDown=1},_pointerUpHandler=function $(){return _pointerIsDown=0},_passThrough=function $(j){return j},_round=function $(j){return Math.round(j*1e5)/1e5||0},_windowExists=function $(){return typeof window<"u"},_getGSAP=function $(){return gsap||_windowExists()&&(gsap=window.gsap)&&gsap.registerPlugin&&gsap},_isViewport=function $(j){return!!~_root.indexOf(j)},_getBoundsFunc=function $(j){return _getProxyProp(j,"getBoundingClientRect")||(_isViewport(j)?function(){return _winOffsets.width=_win.innerWidth,_winOffsets.height=_win.innerHeight,_winOffsets}:function(){return _getBounds(j)})},_getSizeFunc=function $(j,it,et){var ut=et.d,dt=et.d2,mt=et.a;return(mt=_getProxyProp(j,"getBoundingClientRect"))?function(){return mt()[ut]}:function(){return(it?_win["inner"+dt]:j["client"+dt])||0}},_getOffsetsFunc=function $(j,it){return!it||~_proxies.indexOf(j)?_getBoundsFunc(j):function(){return _winOffsets}},_maxScroll=function $(j,it){var et=it.s,ut=it.d2,dt=it.d,mt=it.a;return(et="scroll"+ut)&&(mt=_getProxyProp(j,et))?mt()-_getBoundsFunc(j)()[dt]:_isViewport(j)?(_docEl[et]||_body[et])-(_win["inner"+ut]||_docEl["client"+ut]||_body["client"+ut]):j[et]-j["offset"+ut]},_iterateAutoRefresh=function $(j,it){for(var et=0;et<_autoRefresh.length;et+=3)(!it||~it.indexOf(_autoRefresh[et+1]))&&j(_autoRefresh[et],_autoRefresh[et+1],_autoRefresh[et+2])},_isString=function $(j){return typeof j=="string"},_isFunction=function $(j){return typeof j=="function"},_isNumber=function $(j){return typeof j=="number"},_isObject=function $(j){return typeof j=="object"},_endAnimation=function $(j,it,et){return j&&j.progress(it?0:1)&&et&&j.pause()},_callback=function $(j,it){if(j.enabled){var et=it(j);et&&et.totalTime&&(j.callbackAnimation=et)}},_abs=Math.abs,_left="left",_top="top",_right="right",_bottom="bottom",_width="width",_height="height",_Right="Right",_Left="Left",_Top="Top",_Bottom="Bottom",_padding="padding",_margin="margin",_Width="Width",_Height="Height",_px="px",_getComputedStyle=function $(j){return _win.getComputedStyle(j)},_makePositionable=function $(j){var it=_getComputedStyle(j).position;j.style.position=it==="absolute"||it==="fixed"?it:"relative"},_setDefaults=function $(j,it){for(var et in it)et in j||(j[et]=it[et]);return j},_getBounds=function $(j,it){var et=it&&_getComputedStyle(j)[_transformProp]!=="matrix(1, 0, 0, 1, 0, 0)"&&gsap.to(j,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),ut=j.getBoundingClientRect();return et&&et.progress(0).kill(),ut},_getSize=function $(j,it){var et=it.d2;return j["offset"+et]||j["client"+et]||0},_getLabelRatioArray=function $(j){var it=[],et=j.labels,ut=j.duration(),dt;for(dt in et)it.push(et[dt]/ut);return it},_getClosestLabel=function $(j){return function(it){return gsap.utils.snap(_getLabelRatioArray(j),it)}},_snapDirectional=function $(j){var it=gsap.utils.snap(j),et=Array.isArray(j)&&j.slice(0).sort(function(ut,dt){return ut-dt});return et?function(ut,dt,mt){mt===void 0&&(mt=.001);var yt;if(!dt)return it(ut);if(dt>0){for(ut-=mt,yt=0;yt<et.length;yt++)if(et[yt]>=ut)return et[yt];return et[yt-1]}else for(yt=et.length,ut+=mt;yt--;)if(et[yt]<=ut)return et[yt];return et[0]}:function(ut,dt,mt){mt===void 0&&(mt=.001);var yt=it(ut);return!dt||Math.abs(yt-ut)<mt||yt-ut<0==dt<0?yt:it(dt<0?ut-j:ut+j)}},_getLabelAtDirection=function $(j){return function(it,et){return _snapDirectional(_getLabelRatioArray(j))(it,et.direction)}},_multiListener=function $(j,it,et,ut){return et.split(",").forEach(function(dt){return j(it,dt,ut)})},_addListener=function $(j,it,et,ut,dt){return j.addEventListener(it,et,{passive:!ut,capture:!!dt})},_removeListener=function $(j,it,et,ut){return j.removeEventListener(it,et,!!ut)},_wheelListener=function $(j,it,et){return et&&et.wheelHandler&&j(it,"wheel",et)},_markerDefaults={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},_defaults={toggleActions:"play",anticipatePin:0},_keywords={top:0,left:0,center:.5,bottom:1,right:1},_offsetToPx=function $(j,it){if(_isString(j)){var et=j.indexOf("="),ut=~et?+(j.charAt(et-1)+1)*parseFloat(j.substr(et+1)):0;~et&&(j.indexOf("%")>et&&(ut*=it/100),j=j.substr(0,et-1)),j=ut+(j in _keywords?_keywords[j]*it:~j.indexOf("%")?parseFloat(j)*it/100:parseFloat(j)||0)}return j},_createMarker=function $(j,it,et,ut,dt,mt,yt,bt){var Rt=dt.startColor,jt=dt.endColor,Vt=dt.fontSize,zt=dt.indent,Jt=dt.fontWeight,rr=_doc.createElement("div"),Yt=_isViewport(et)||_getProxyProp(et,"pinType")==="fixed",dr=j.indexOf("scroller")!==-1,Ft=Yt?_body:et,Ht=j.indexOf("start")!==-1,er=Ht?Rt:jt,pr="border-color:"+er+";font-size:"+Vt+";color:"+er+";font-weight:"+Jt+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return pr+="position:"+((dr||bt)&&Yt?"fixed;":"absolute;"),(dr||bt||!Yt)&&(pr+=(ut===_vertical?_right:_bottom)+":"+(mt+parseFloat(zt))+"px;"),yt&&(pr+="box-sizing:border-box;text-align:left;width:"+yt.offsetWidth+"px;"),rr._isStart=Ht,rr.setAttribute("class","gsap-marker-"+j+(it?" marker-"+it:"")),rr.style.cssText=pr,rr.innerText=it||it===0?j+"-"+it:j,Ft.children[0]?Ft.insertBefore(rr,Ft.children[0]):Ft.appendChild(rr),rr._offset=rr["offset"+ut.op.d2],_positionMarker(rr,0,ut,Ht),rr},_positionMarker=function $(j,it,et,ut){var dt={display:"block"},mt=et[ut?"os2":"p2"],yt=et[ut?"p2":"os2"];j._isFlipped=ut,dt[et.a+"Percent"]=ut?-100:0,dt[et.a]=ut?"1px":0,dt["border"+mt+_Width]=1,dt["border"+yt+_Width]=0,dt[et.p]=it+"px",gsap.set(j,dt)},_triggers=[],_ids={},_rafID,_sync=function $(){return _getTime()-_lastScrollTime>34&&(_rafID||(_rafID=requestAnimationFrame(_updateAll)))},_onScroll=function $(){(!_normalizer||!_normalizer.isPressed||_normalizer.startX>_body.clientWidth)&&(_scrollers.cache++,_normalizer?_rafID||(_rafID=requestAnimationFrame(_updateAll)):_updateAll(),_lastScrollTime||_dispatch("scrollStart"),_lastScrollTime=_getTime())},_setBaseDimensions=function $(){_baseScreenWidth=_win.innerWidth,_baseScreenHeight=_win.innerHeight},_onResize=function $(){_scrollers.cache++,!_refreshing&&!_ignoreResize&&!_doc.fullscreenElement&&!_doc.webkitFullscreenElement&&(!_ignoreMobileResize||_baseScreenWidth!==_win.innerWidth||Math.abs(_win.innerHeight-_baseScreenHeight)>_win.innerHeight*.25)&&_resizeDelay.restart(!0)},_listeners={},_emptyArray=[],_softRefresh=function $(){return _removeListener(ScrollTrigger,"scrollEnd",$)||_refreshAll(!0)},_dispatch=function $(j){return _listeners[j]&&_listeners[j].map(function(it){return it()})||_emptyArray},_savedStyles=[],_revertRecorded=function $(j){for(var it=0;it<_savedStyles.length;it+=5)(!j||_savedStyles[it+4]&&_savedStyles[it+4].query===j)&&(_savedStyles[it].style.cssText=_savedStyles[it+1],_savedStyles[it].getBBox&&_savedStyles[it].setAttribute("transform",_savedStyles[it+2]||""),_savedStyles[it+3].uncache=1)},_revertAll=function $(j,it){var et;for(_i=0;_i<_triggers.length;_i++)et=_triggers[_i],et&&(!it||et._ctx===it)&&(j?et.kill(1):et.revert(!0,!0));it&&_revertRecorded(it),it||_dispatch("revert")},_clearScrollMemory=function $(j,it){_scrollers.cache++,(it||!_refreshingAll)&&_scrollers.forEach(function(et){return _isFunction(et)&&et.cacheID++&&(et.rec=0)}),_isString(j)&&(_win.history.scrollRestoration=_scrollRestoration=j)},_refreshingAll,_refreshID=0,_queueRefreshID,_queueRefreshAll=function $(){if(_queueRefreshID!==_refreshID){var j=_queueRefreshID=_refreshID;requestAnimationFrame(function(){return j===_refreshID&&_refreshAll(!0)})}},_refreshAll=function $(j,it){if(_lastScrollTime&&!j){_addListener(ScrollTrigger,"scrollEnd",_softRefresh);return}_refreshingAll=ScrollTrigger.isRefreshing=!0,_scrollers.forEach(function(ut){return _isFunction(ut)&&ut.cacheID++&&(ut.rec=ut())});var et=_dispatch("refreshInit");_sort&&ScrollTrigger.sort(),it||_revertAll(),_scrollers.forEach(function(ut){_isFunction(ut)&&(ut.smooth&&(ut.target.style.scrollBehavior="auto"),ut(0))}),_triggers.slice(0).forEach(function(ut){return ut.refresh()}),_triggers.forEach(function(ut,dt){if(ut._subPinOffset&&ut.pin){var mt=ut.vars.horizontal?"offsetWidth":"offsetHeight",yt=ut.pin[mt];ut.revert(!0,1),ut.adjustPinSpacing(ut.pin[mt]-yt),ut.revert(!1,1)}}),_triggers.forEach(function(ut){return ut.vars.end==="max"&&ut.setPositions(ut.start,Math.max(ut.start+1,_maxScroll(ut.scroller,ut._dir)))}),et.forEach(function(ut){return ut&&ut.render&&ut.render(-1)}),_scrollers.forEach(function(ut){_isFunction(ut)&&(ut.smooth&&requestAnimationFrame(function(){return ut.target.style.scrollBehavior="smooth"}),ut.rec&&ut(ut.rec))}),_clearScrollMemory(_scrollRestoration,1),_resizeDelay.pause(),_refreshID++,_updateAll(2),_triggers.forEach(function(ut){return _isFunction(ut.vars.onRefresh)&&ut.vars.onRefresh(ut)}),_refreshingAll=ScrollTrigger.isRefreshing=!1,_dispatch("refresh")},_lastScroll=0,_direction=1,_primary,_updateAll=function $(j){if(!_refreshingAll||j===2){ScrollTrigger.isUpdating=!0,_primary&&_primary.update(0);var it=_triggers.length,et=_getTime(),ut=et-_time1>=50,dt=it&&_triggers[0].scroll();if(_direction=_lastScroll>dt?-1:1,_lastScroll=dt,ut&&(_lastScrollTime&&!_pointerIsDown&&et-_lastScrollTime>200&&(_lastScrollTime=0,_dispatch("scrollEnd")),_time2=_time1,_time1=et),_direction<0){for(_i=it;_i-- >0;)_triggers[_i]&&_triggers[_i].update(0,ut);_direction=1}else for(_i=0;_i<it;_i++)_triggers[_i]&&_triggers[_i].update(0,ut);ScrollTrigger.isUpdating=!1}_rafID=0},_propNamesToCopy=[_left,_top,_bottom,_right,_margin+_Bottom,_margin+_Right,_margin+_Top,_margin+_Left,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],_stateProps=_propNamesToCopy.concat([_width,_height,"boxSizing","max"+_Width,"max"+_Height,"position",_margin,_padding,_padding+_Top,_padding+_Right,_padding+_Bottom,_padding+_Left]),_swapPinOut=function $(j,it,et){_setState(et);var ut=j._gsap;if(ut.spacerIsNative)_setState(ut.spacerState);else if(j._gsap.swappedIn){var dt=it.parentNode;dt&&(dt.insertBefore(j,it),dt.removeChild(it))}j._gsap.swappedIn=!1},_swapPinIn=function $(j,it,et,ut){if(!j._gsap.swappedIn){for(var dt=_propNamesToCopy.length,mt=it.style,yt=j.style,bt;dt--;)bt=_propNamesToCopy[dt],mt[bt]=et[bt];mt.position=et.position==="absolute"?"absolute":"relative",et.display==="inline"&&(mt.display="inline-block"),yt[_bottom]=yt[_right]="auto",mt.flexBasis=et.flexBasis||"auto",mt.overflow="visible",mt.boxSizing="border-box",mt[_width]=_getSize(j,_horizontal)+_px,mt[_height]=_getSize(j,_vertical)+_px,mt[_padding]=yt[_margin]=yt[_top]=yt[_left]="0",_setState(ut),yt[_width]=yt["max"+_Width]=et[_width],yt[_height]=yt["max"+_Height]=et[_height],yt[_padding]=et[_padding],j.parentNode!==it&&(j.parentNode.insertBefore(it,j),it.appendChild(j)),j._gsap.swappedIn=!0}},_capsExp=/([A-Z])/g,_setState=function $(j){if(j){var it=j.t.style,et=j.length,ut=0,dt,mt;for((j.t._gsap||gsap.core.getCache(j.t)).uncache=1;ut<et;ut+=2)mt=j[ut+1],dt=j[ut],mt?it[dt]=mt:it[dt]&&it.removeProperty(dt.replace(_capsExp,"-$1").toLowerCase())}},_getState=function $(j){for(var it=_stateProps.length,et=j.style,ut=[],dt=0;dt<it;dt++)ut.push(_stateProps[dt],et[_stateProps[dt]]);return ut.t=j,ut},_copyState=function $(j,it,et){for(var ut=[],dt=j.length,mt=et?8:0,yt;mt<dt;mt+=2)yt=j[mt],ut.push(yt,yt in it?it[yt]:j[mt+1]);return ut.t=j.t,ut},_winOffsets={left:0,top:0},_parsePosition=function $(j,it,et,ut,dt,mt,yt,bt,Rt,jt,Vt,zt,Jt){_isFunction(j)&&(j=j(bt)),_isString(j)&&j.substr(0,3)==="max"&&(j=zt+(j.charAt(4)==="="?_offsetToPx("0"+j.substr(3),et):0));var rr=Jt?Jt.time():0,Yt,dr,Ft;if(Jt&&Jt.seek(0),_isNumber(j))yt&&_positionMarker(yt,et,ut,!0);else{_isFunction(it)&&(it=it(bt));var Ht=(j||"0").split(" "),er,pr,or,ar;Ft=_getTarget(it)||_body,er=_getBounds(Ft)||{},(!er||!er.left&&!er.top)&&_getComputedStyle(Ft).display==="none"&&(ar=Ft.style.display,Ft.style.display="block",er=_getBounds(Ft),ar?Ft.style.display=ar:Ft.style.removeProperty("display")),pr=_offsetToPx(Ht[0],er[ut.d]),or=_offsetToPx(Ht[1]||"0",et),j=er[ut.p]-Rt[ut.p]-jt+pr+dt-or,yt&&_positionMarker(yt,or,ut,et-or<20||yt._isStart&&or>20),et-=et-or}if(mt){var Wt=j+et,Zt=mt._isStart;Yt="scroll"+ut.d2,_positionMarker(mt,Wt,ut,Zt&&Wt>20||!Zt&&(Vt?Math.max(_body[Yt],_docEl[Yt]):mt.parentNode[Yt])<=Wt+1),Vt&&(Rt=_getBounds(yt),Vt&&(mt.style[ut.op.p]=Rt[ut.op.p]-ut.op.m-mt._offset+_px))}return Jt&&Ft&&(Yt=_getBounds(Ft),Jt.seek(zt),dr=_getBounds(Ft),Jt._caScrollDist=Yt[ut.p]-dr[ut.p],j=j/Jt._caScrollDist*zt),Jt&&Jt.seek(rr),Jt?j:Math.round(j)},_prefixExp=/(webkit|moz|length|cssText|inset)/i,_reparent=function $(j,it,et,ut){if(j.parentNode!==it){var dt=j.style,mt,yt;if(it===_body){j._stOrig=dt.cssText,yt=_getComputedStyle(j);for(mt in yt)!+mt&&!_prefixExp.test(mt)&&yt[mt]&&typeof dt[mt]=="string"&&mt!=="0"&&(dt[mt]=yt[mt]);dt.top=et,dt.left=ut}else dt.cssText=j._stOrig;gsap.core.getCache(j).uncache=1,it.appendChild(j)}},_getTweenCreator=function $(j,it){var et=_getScrollFunc(j,it),ut="_scroll"+it.p2,dt,mt,yt=function bt(Rt,jt,Vt,zt,Jt){var rr=bt.tween,Yt=jt.onComplete,dr={};return Vt=Vt||et(),Jt=zt&&Jt||0,zt=zt||Rt-Vt,rr&&rr.kill(),dt=Math.round(Vt),jt[ut]=Rt,jt.modifiers=dr,dr[ut]=function(Ft){return Ft=Math.round(et()),Ft!==dt&&Ft!==mt&&Math.abs(Ft-dt)>3&&Math.abs(Ft-mt)>3?(rr.kill(),bt.tween=0):Ft=Vt+zt*rr.ratio+Jt*rr.ratio*rr.ratio,mt=dt,dt=Math.round(Ft)},jt.onUpdate=function(){_scrollers.cache++,_updateAll()},jt.onComplete=function(){bt.tween=0,Yt&&Yt.call(rr)},rr=bt.tween=gsap.to(j,jt),rr};return j[ut]=et,et.wheelHandler=function(){return yt.tween&&yt.tween.kill()&&(yt.tween=0)},_addListener(j,"wheel",et.wheelHandler),yt},ScrollTrigger=function(){function $(it,et){_coreInitted||$.register(gsap)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),this.init(it,et)}var j=$.prototype;return j.init=function(et,ut){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),!_enabled){this.update=this.refresh=this.kill=_passThrough;return}et=_setDefaults(_isString(et)||_isNumber(et)||et.nodeType?{trigger:et}:et,_defaults);var dt=et,mt=dt.onUpdate,yt=dt.toggleClass,bt=dt.id,Rt=dt.onToggle,jt=dt.onRefresh,Vt=dt.scrub,zt=dt.trigger,Jt=dt.pin,rr=dt.pinSpacing,Yt=dt.invalidateOnRefresh,dr=dt.anticipatePin,Ft=dt.onScrubComplete,Ht=dt.onSnapComplete,er=dt.once,pr=dt.snap,or=dt.pinReparent,ar=dt.pinSpacer,Wt=dt.containerAnimation,Zt=dt.fastScrollEnd,sr=dt.preventOverlaps,tr=et.horizontal||et.containerAnimation&&et.horizontal!==!1?_horizontal:_vertical,vr=!Vt&&Vt!==0,Vr=_getTarget(et.scroller||_win),hn=gsap.core.getCache(Vr),cn=_isViewport(Vr),gn=("pinType"in et?et.pinType:_getProxyProp(Vr,"pinType")||cn&&"fixed")==="fixed",tn=[et.onEnter,et.onLeave,et.onEnterBack,et.onLeaveBack],Tn=vr&&et.toggleActions.split(" "),qr="markers"in et?et.markers:_defaults.markers,nn=cn?0:parseFloat(_getComputedStyle(Vr)["border"+tr.p2+_Width])||0,yr=this,an=et.onRefreshInit&&function(){return et.onRefreshInit(yr)},sn=_getSizeFunc(Vr,cn,tr),Rn=_getOffsetsFunc(Vr,cn),Jr=0,mr=0,Ar=_getScrollFunc(Vr,tr),jr,On,$n,jn,As,ps,qs,Vs,Eo,js,mn,uo,_o,Vl,Vo,Oo,Lo,No,eu,So,co,Il,ga,Go,Up,ba,bu,Ko,Lu,$p,ys,Bo,su,Ol,pp,_c,Cp,Yr,Cl;if(_context(yr),yr._dir=tr,dr*=45,yr.scroller=Vr,yr.scroll=Wt?Wt.time.bind(Wt):Ar,jn=Ar(),yr.vars=et,ut=ut||et.animation,"refreshPriority"in et&&(_sort=1,et.refreshPriority===-9999&&(_primary=yr)),hn.tweenScroll=hn.tweenScroll||{top:_getTweenCreator(Vr,_vertical),left:_getTweenCreator(Vr,_horizontal)},yr.tweenTo=jr=hn.tweenScroll[tr.p],yr.scrubDuration=function(In){Bo=_isNumber(In)&&In,Bo?ys?ys.duration(In):ys=gsap.to(ut,{ease:"expo",totalProgress:"+=0.001",duration:Bo,paused:!0,onComplete:function(){return Ft&&Ft(yr)}}):(ys&&ys.progress(1).kill(),ys=0)},ut&&(ut.vars.lazy=!1,ut._initted||ut.vars.immediateRender!==!1&&et.immediateRender!==!1&&ut.duration()&&ut.render(0,!0,!0),yr.animation=ut.pause(),ut.scrollTrigger=yr,yr.scrubDuration(Vt),Lu=0,bt||(bt=ut.vars.id)),_triggers.push(yr),pr&&((!_isObject(pr)||pr.push)&&(pr={snapTo:pr}),"scrollBehavior"in _body.style&&gsap.set(cn?[_body,_docEl]:Vr,{scrollBehavior:"auto"}),_scrollers.forEach(function(In){return _isFunction(In)&&In.target===(cn?_doc.scrollingElement||_docEl:Vr)&&(In.smooth=!1)}),$n=_isFunction(pr.snapTo)?pr.snapTo:pr.snapTo==="labels"?_getClosestLabel(ut):pr.snapTo==="labelsDirectional"?_getLabelAtDirection(ut):pr.directional!==!1?function(In,Ns){return _snapDirectional(pr.snapTo)(In,_getTime()-mr<500?0:Ns.direction)}:gsap.utils.snap(pr.snapTo),su=pr.duration||{min:.1,max:2},su=_isObject(su)?_clamp(su.min,su.max):_clamp(su,su),Ol=gsap.delayedCall(pr.delay||Bo/2||.1,function(){var In=Ar(),Ns=_getTime()-mr<500,Fs=jr.tween;if((Ns||Math.abs(yr.getVelocity())<10)&&!Fs&&!_pointerIsDown&&Jr!==In){var Ps=(In-ps)/_o,Xo=ut&&!vr?ut.totalProgress():Ps,oo=Ns?0:(Xo-$p)/(_getTime()-_time2)*1e3||0,Uo=gsap.utils.clamp(-Ps,1-Ps,_abs(oo/2)*oo/.185),Jo=Ps+(pr.inertia===!1?0:Uo),ep=_clamp(0,1,$n(Jo,yr)),po=Math.round(ps+ep*_o),tu=pr,Tp=tu.onStart,Zo=tu.onInterrupt,To=tu.onComplete;if(In<=qs&&In>=ps&&po!==In){if(Fs&&!Fs._initted&&Fs.data<=_abs(po-In))return;pr.inertia===!1&&(Uo=ep-Ps),jr(po,{duration:su(_abs(Math.max(_abs(Jo-Xo),_abs(ep-Xo))*.185/oo/.05||0)),ease:pr.ease||"power3",data:_abs(po-In),onInterrupt:function(){return Ol.restart(!0)&&Zo&&Zo(yr)},onComplete:function(){yr.update(),Jr=Ar(),Lu=$p=ut&&!vr?ut.totalProgress():yr.progress,Ht&&Ht(yr),To&&To(yr)}},In,Uo*_o,po-In-Uo*_o),Tp&&Tp(yr,jr.tween)}}else yr.isActive&&Jr!==In&&Ol.restart(!0)}).pause()),bt&&(_ids[bt]=yr),zt=yr.trigger=_getTarget(zt||Jt),Cl=zt&&zt._gsap&&zt._gsap.stRevert,Cl&&(Cl=Cl(yr)),Jt=Jt===!0?zt:_getTarget(Jt),_isString(yt)&&(yt={targets:zt,className:yt}),Jt&&(rr===!1||rr===_margin||(rr=!rr&&Jt.parentNode&&Jt.parentNode.style&&_getComputedStyle(Jt.parentNode).display==="flex"?!1:_padding),yr.pin=Jt,On=gsap.core.getCache(Jt),On.spacer?Vl=On.pinState:(ar&&(ar=_getTarget(ar),ar&&!ar.nodeType&&(ar=ar.current||ar.nativeElement),On.spacerIsNative=!!ar,ar&&(On.spacerState=_getState(ar))),On.spacer=Lo=ar||_doc.createElement("div"),Lo.classList.add("pin-spacer"),bt&&Lo.classList.add("pin-spacer-"+bt),On.pinState=Vl=_getState(Jt)),et.force3D!==!1&&gsap.set(Jt,{force3D:!0}),yr.spacer=Lo=On.spacer,Ko=_getComputedStyle(Jt),ga=Ko[rr+tr.os2],eu=gsap.getProperty(Jt),So=gsap.quickSetter(Jt,tr.a,_px),_swapPinIn(Jt,Lo,Ko),Oo=_getState(Jt)),qr){uo=_isObject(qr)?_setDefaults(qr,_markerDefaults):_markerDefaults,js=_createMarker("scroller-start",bt,Vr,tr,uo,0),mn=_createMarker("scroller-end",bt,Vr,tr,uo,0,js),No=js["offset"+tr.op.d2];var _d=_getTarget(_getProxyProp(Vr,"content")||Vr);Vs=this.markerStart=_createMarker("start",bt,_d,tr,uo,No,0,Wt),Eo=this.markerEnd=_createMarker("end",bt,_d,tr,uo,No,0,Wt),Wt&&(Yr=gsap.quickSetter([Vs,Eo],tr.a,_px)),!gn&&!(_proxies.length&&_getProxyProp(Vr,"fixedMarkers")===!0)&&(_makePositionable(cn?_body:Vr),gsap.set([js,mn],{force3D:!0}),Up=gsap.quickSetter(js,tr.a,_px),bu=gsap.quickSetter(mn,tr.a,_px))}if(Wt){var Js=Wt.vars.onUpdate,rs=Wt.vars.onUpdateParams;Wt.eventCallback("onUpdate",function(){yr.update(0,0,1),Js&&Js.apply(rs||[])})}yr.previous=function(){return _triggers[_triggers.indexOf(yr)-1]},yr.next=function(){return _triggers[_triggers.indexOf(yr)+1]},yr.revert=function(In,Ns){if(!Ns)return yr.kill(!0);var Fs=In!==!1||!yr.enabled,Ps=_refreshing;Fs!==yr.isReverted&&(Fs&&(_c=Math.max(Ar(),yr.scroll.rec||0),pp=yr.progress,Cp=ut&&ut.progress()),Vs&&[Vs,Eo,js,mn].forEach(function(Xo){return Xo.style.display=Fs?"none":"block"}),Fs&&(_refreshing=1,yr.update(Fs)),Jt&&(!or||!yr.isActive)&&(Fs?_swapPinOut(Jt,Lo,Vl):_swapPinIn(Jt,Lo,_getComputedStyle(Jt),Go)),Fs||yr.update(Fs),_refreshing=Ps,yr.isReverted=Fs)},yr.refresh=function(In,Ns){if(!((_refreshing||!yr.enabled)&&!Ns)){if(Jt&&In&&_lastScrollTime){_addListener($,"scrollEnd",_softRefresh);return}!_refreshingAll&&an&&an(yr),_refreshing=1,mr=_getTime(),jr.tween&&(jr.tween.kill(),jr.tween=0),ys&&ys.pause(),Yt&&ut&&ut.revert({kill:!1}).invalidate(),yr.isReverted||yr.revert(!0,!0),yr._subPinOffset=!1;for(var Fs=sn(),Ps=Rn(),Xo=Wt?Wt.duration():_maxScroll(Vr,tr),oo=0,Uo=0,Jo=et.end,ep=et.endTrigger||zt,po=et.start||(et.start===0||!zt?0:Jt?"0 0":"0 100%"),tu=yr.pinnedContainer=et.pinnedContainer&&_getTarget(et.pinnedContainer),Tp=zt&&Math.max(0,_triggers.indexOf(yr))||0,Zo=Tp,To,Al,Co,wu,Mo,xl,Pl,ds,Hm,gs,ou;Zo--;)xl=_triggers[Zo],xl.end||xl.refresh(0,1)||(_refreshing=1),Pl=xl.pin,Pl&&(Pl===zt||Pl===Jt)&&!xl.isReverted&&(gs||(gs=[]),gs.unshift(xl),xl.revert(!0,!0)),xl!==_triggers[Zo]&&(Tp--,Zo--);for(_isFunction(po)&&(po=po(yr)),ps=_parsePosition(po,zt,Fs,tr,Ar(),Vs,js,yr,Ps,nn,gn,Xo,Wt)||(Jt?-.001:0),_isFunction(Jo)&&(Jo=Jo(yr)),_isString(Jo)&&!Jo.indexOf("+=")&&(~Jo.indexOf(" ")?Jo=(_isString(po)?po.split(" ")[0]:"")+Jo:(oo=_offsetToPx(Jo.substr(2),Fs),Jo=_isString(po)?po:ps+oo,ep=zt)),qs=Math.max(ps,_parsePosition(Jo||(ep?"100% 0":Xo),ep,Fs,tr,Ar()+oo,Eo,mn,yr,Ps,nn,gn,Xo,Wt))||-.001,_o=qs-ps||(ps-=.01)&&.001,oo=0,Zo=Tp;Zo--;)xl=_triggers[Zo],Pl=xl.pin,Pl&&xl.start-xl._pinPush<=ps&&!Wt&&xl.end>0&&(To=xl.end-xl.start,(Pl===zt&&xl.start-xl._pinPush<ps||Pl===tu)&&!_isNumber(po)&&(oo+=To*(1-xl.progress)),Pl===Jt&&(Uo+=To));if(ps+=oo,qs+=oo,yr._pinPush=Uo,Vs&&oo&&(To={},To[tr.a]="+="+oo,tu&&(To[tr.p]="-="+Ar()),gsap.set([Vs,Eo],To)),Jt)To=_getComputedStyle(Jt),wu=tr===_vertical,Co=Ar(),co=parseFloat(eu(tr.a))+Uo,!Xo&&qs>1&&(ou=(cn?_doc.scrollingElement||_docEl:Vr).style,ou={style:ou,value:ou["overflow"+tr.a.toUpperCase()]},ou["overflow"+tr.a.toUpperCase()]="scroll"),_swapPinIn(Jt,Lo,To),Oo=_getState(Jt),Al=_getBounds(Jt,!0),ds=gn&&_getScrollFunc(Vr,wu?_horizontal:_vertical)(),rr&&(Go=[rr+tr.os2,_o+Uo+_px],Go.t=Lo,Zo=rr===_padding?_getSize(Jt,tr)+_o+Uo:0,Zo&&Go.push(tr.d,Zo+_px),_setState(Go),tu&&_triggers.forEach(function(Mp){Mp.pin===tu&&Mp.vars.pinSpacing!==!1&&(Mp._subPinOffset=!0)}),gn&&Ar(_c)),gn&&(Mo={top:Al.top+(wu?Co-ps:ds)+_px,left:Al.left+(wu?ds:Co-ps)+_px,boxSizing:"border-box",position:"fixed"},Mo[_width]=Mo["max"+_Width]=Math.ceil(Al.width)+_px,Mo[_height]=Mo["max"+_Height]=Math.ceil(Al.height)+_px,Mo[_margin]=Mo[_margin+_Top]=Mo[_margin+_Right]=Mo[_margin+_Bottom]=Mo[_margin+_Left]="0",Mo[_padding]=To[_padding],Mo[_padding+_Top]=To[_padding+_Top],Mo[_padding+_Right]=To[_padding+_Right],Mo[_padding+_Bottom]=To[_padding+_Bottom],Mo[_padding+_Left]=To[_padding+_Left],Vo=_copyState(Vl,Mo,or),_refreshingAll&&Ar(0)),ut?(Hm=ut._initted,_suppressOverwrites(1),ut.render(ut.duration(),!0,!0),Il=eu(tr.a)-co+_o+Uo,ba=Math.abs(_o-Il)>1,gn&&ba&&Vo.splice(Vo.length-2,2),ut.render(0,!0,!0),Hm||ut.invalidate(!0),ut.parent||ut.totalTime(ut.totalTime()),_suppressOverwrites(0)):Il=_o,ou&&(ou.value?ou.style["overflow"+tr.a.toUpperCase()]=ou.value:ou.style.removeProperty("overflow-"+tr.a));else if(zt&&Ar()&&!Wt)for(Al=zt.parentNode;Al&&Al!==_body;)Al._pinOffset&&(ps-=Al._pinOffset,qs-=Al._pinOffset),Al=Al.parentNode;gs&&gs.forEach(function(Mp){return Mp.revert(!1,!0)}),yr.start=ps,yr.end=qs,jn=As=_refreshingAll?_c:Ar(),!Wt&&!_refreshingAll&&(jn<_c&&Ar(_c),yr.scroll.rec=0),yr.revert(!1,!0),Ol&&(Jr=-1,yr.isActive&&Ar(ps+_o*pp),Ol.restart(!0)),_refreshing=0,ut&&vr&&(ut._initted||Cp)&&ut.progress()!==Cp&&ut.progress(Cp,!0).render(ut.time(),!0,!0),(pp!==yr.progress||Wt)&&(ut&&!vr&&ut.totalProgress(pp,!0),yr.progress=(jn-ps)/_o===pp?0:pp),Jt&&rr&&(Lo._pinOffset=Math.round(yr.progress*Il)),jt&&!_refreshingAll&&jt(yr)}},yr.getVelocity=function(){return(Ar()-As)/(_getTime()-_time2)*1e3||0},yr.endAnimation=function(){_endAnimation(yr.callbackAnimation),ut&&(ys?ys.progress(1):ut.paused()?vr||_endAnimation(ut,yr.direction<0,1):_endAnimation(ut,ut.reversed()))},yr.labelToScroll=function(In){return ut&&ut.labels&&(ps||yr.refresh()||ps)+ut.labels[In]/ut.duration()*_o||0},yr.getTrailing=function(In){var Ns=_triggers.indexOf(yr),Fs=yr.direction>0?_triggers.slice(0,Ns).reverse():_triggers.slice(Ns+1);return(_isString(In)?Fs.filter(function(Ps){return Ps.vars.preventOverlaps===In}):Fs).filter(function(Ps){return yr.direction>0?Ps.end<=ps:Ps.start>=qs})},yr.update=function(In,Ns,Fs){if(!(Wt&&!Fs&&!In)){var Ps=_refreshingAll?_c:yr.scroll(),Xo=In?0:(Ps-ps)/_o,oo=Xo<0?0:Xo>1?1:Xo||0,Uo=yr.progress,Jo,ep,po,tu,Tp,Zo,To,Al;if(Ns&&(As=jn,jn=Wt?Ar():Ps,pr&&($p=Lu,Lu=ut&&!vr?ut.totalProgress():oo)),dr&&!oo&&Jt&&!_refreshing&&!_startup&&_lastScrollTime&&ps<Ps+(Ps-As)/(_getTime()-_time2)*dr&&(oo=1e-4),oo!==Uo&&yr.enabled){if(Jo=yr.isActive=!!oo&&oo<1,ep=!!Uo&&Uo<1,Zo=Jo!==ep,Tp=Zo||!!oo!=!!Uo,yr.direction=oo>Uo?1:-1,yr.progress=oo,Tp&&!_refreshing&&(po=oo&&!Uo?0:oo===1?1:Uo===1?2:3,vr&&(tu=!Zo&&Tn[po+1]!=="none"&&Tn[po+1]||Tn[po],Al=ut&&(tu==="complete"||tu==="reset"||tu in ut))),sr&&(Zo||Al)&&(Al||Vt||!ut)&&(_isFunction(sr)?sr(yr):yr.getTrailing(sr).forEach(function(xl){return xl.endAnimation()})),vr||(ys&&!_refreshing&&!_startup?(ys._dp._time-ys._start!==ys._time&&ys.render(ys._dp._time-ys._start),ys.resetTo?ys.resetTo("totalProgress",oo,ut._tTime/ut._tDur):(ys.vars.totalProgress=oo,ys.invalidate().restart())):ut&&ut.totalProgress(oo,!!_refreshing)),Jt){if(In&&rr&&(Lo.style[rr+tr.os2]=ga),!gn)So(_round(co+Il*oo));else if(Tp){if(To=!In&&oo>Uo&&qs+1>Ps&&Ps+1>=_maxScroll(Vr,tr),or)if(!In&&(Jo||To)){var Co=_getBounds(Jt,!0),wu=Ps-ps;_reparent(Jt,_body,Co.top+(tr===_vertical?wu:0)+_px,Co.left+(tr===_vertical?0:wu)+_px)}else _reparent(Jt,Lo);_setState(Jo||To?Vo:Oo),ba&&oo<1&&Jo||So(co+(oo===1&&!To?Il:0))}}pr&&!jr.tween&&!_refreshing&&!_startup&&Ol.restart(!0),yt&&(Zo||er&&oo&&(oo<1||!_limitCallbacks))&&_toArray(yt.targets).forEach(function(xl){return xl.classList[Jo||er?"add":"remove"](yt.className)}),mt&&!vr&&!In&&mt(yr),Tp&&!_refreshing?(vr&&(Al&&(tu==="complete"?ut.pause().totalProgress(1):tu==="reset"?ut.restart(!0).pause():tu==="restart"?ut.restart(!0):ut[tu]()),mt&&mt(yr)),(Zo||!_limitCallbacks)&&(Rt&&Zo&&_callback(yr,Rt),tn[po]&&_callback(yr,tn[po]),er&&(oo===1?yr.kill(!1,1):tn[po]=0),Zo||(po=oo===1?1:3,tn[po]&&_callback(yr,tn[po]))),Zt&&!Jo&&Math.abs(yr.getVelocity())>(_isNumber(Zt)?Zt:2500)&&(_endAnimation(yr.callbackAnimation),ys?ys.progress(1):_endAnimation(ut,tu==="reverse"?1:!oo,1))):vr&&mt&&!_refreshing&&mt(yr)}if(bu){var Mo=Wt?Ps/Wt.duration()*(Wt._caScrollDist||0):Ps;Up(Mo+(js._isFlipped?1:0)),bu(Mo)}Yr&&Yr(-Ps/Wt.duration()*(Wt._caScrollDist||0))}},yr.enable=function(In,Ns){yr.enabled||(yr.enabled=!0,_addListener(Vr,"resize",_onResize),_addListener(cn?_doc:Vr,"scroll",_onScroll),an&&_addListener($,"refreshInit",an),In!==!1&&(yr.progress=pp=0,jn=As=Jr=Ar()),Ns!==!1&&yr.refresh())},yr.getTween=function(In){return In&&jr?jr.tween:ys},yr.setPositions=function(In,Ns){Jt&&(co+=In-ps,Il+=Ns-In-_o,rr===_padding&&yr.adjustPinSpacing(Ns-In-_o)),yr.start=ps=In,yr.end=qs=Ns,_o=Ns-In,yr.update()},yr.adjustPinSpacing=function(In){if(Go){var Ns=Go.indexOf(tr.d)+1;Go[Ns]=parseFloat(Go[Ns])+In+_px,Go[1]=parseFloat(Go[1])+In+_px,_setState(Go)}},yr.disable=function(In,Ns){if(yr.enabled&&(In!==!1&&yr.revert(!0,!0),yr.enabled=yr.isActive=!1,Ns||ys&&ys.pause(),_c=0,On&&(On.uncache=1),an&&_removeListener($,"refreshInit",an),Ol&&(Ol.pause(),jr.tween&&jr.tween.kill()&&(jr.tween=0)),!cn)){for(var Fs=_triggers.length;Fs--;)if(_triggers[Fs].scroller===Vr&&_triggers[Fs]!==yr)return;_removeListener(Vr,"resize",_onResize),_removeListener(Vr,"scroll",_onScroll)}},yr.kill=function(In,Ns){yr.disable(In,Ns),ys&&!Ns&&ys.kill(),bt&&delete _ids[bt];var Fs=_triggers.indexOf(yr);Fs>=0&&_triggers.splice(Fs,1),Fs===_i&&_direction>0&&_i--,Fs=0,_triggers.forEach(function(Ps){return Ps.scroller===yr.scroller&&(Fs=1)}),Fs||_refreshingAll||(yr.scroll.rec=0),ut&&(ut.scrollTrigger=null,In&&ut.revert({kill:!1}),Ns||ut.kill()),Vs&&[Vs,Eo,js,mn].forEach(function(Ps){return Ps.parentNode&&Ps.parentNode.removeChild(Ps)}),_primary===yr&&(_primary=0),Jt&&(On&&(On.uncache=1),Fs=0,_triggers.forEach(function(Ps){return Ps.pin===Jt&&Fs++}),Fs||(On.spacer=0)),et.onKill&&et.onKill(yr)},yr.enable(!1,!1),Cl&&Cl(yr),!ut||!ut.add||_o?yr.refresh():gsap.delayedCall(.01,function(){return ps||qs||yr.refresh()})&&(_o=.01)&&(ps=qs=0),Jt&&_queueRefreshAll()},$.register=function(et){return _coreInitted||(gsap=et||_getGSAP(),_windowExists()&&window.document&&$.enable(),_coreInitted=_enabled),_coreInitted},$.defaults=function(et){if(et)for(var ut in et)_defaults[ut]=et[ut];return _defaults},$.disable=function(et,ut){_enabled=0,_triggers.forEach(function(mt){return mt[ut?"kill":"disable"](et)}),_removeListener(_win,"wheel",_onScroll),_removeListener(_doc,"scroll",_onScroll),clearInterval(_syncInterval),_removeListener(_doc,"touchcancel",_passThrough),_removeListener(_body,"touchstart",_passThrough),_multiListener(_removeListener,_doc,"pointerdown,touchstart,mousedown",_pointerDownHandler),_multiListener(_removeListener,_doc,"pointerup,touchend,mouseup",_pointerUpHandler),_resizeDelay.kill(),_iterateAutoRefresh(_removeListener);for(var dt=0;dt<_scrollers.length;dt+=3)_wheelListener(_removeListener,_scrollers[dt],_scrollers[dt+1]),_wheelListener(_removeListener,_scrollers[dt],_scrollers[dt+2])},$.enable=function(){if(_win=window,_doc=document,_docEl=_doc.documentElement,_body=_doc.body,gsap&&(_toArray=gsap.utils.toArray,_clamp=gsap.utils.clamp,_context=gsap.core.context||_passThrough,_suppressOverwrites=gsap.core.suppressOverwrites||_passThrough,_scrollRestoration=_win.history.scrollRestoration||"auto",gsap.core.globals("ScrollTrigger",$),_body)){_enabled=1,Observer.register(gsap),$.isTouch=Observer.isTouch,_fixIOSBug=Observer.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),_addListener(_win,"wheel",_onScroll),_root=[_win,_doc,_docEl,_body],gsap.matchMedia?($.matchMedia=function(bt){var Rt=gsap.matchMedia(),jt;for(jt in bt)Rt.add(jt,bt[jt]);return Rt},gsap.addEventListener("matchMediaInit",function(){return _revertAll()}),gsap.addEventListener("matchMediaRevert",function(){return _revertRecorded()}),gsap.addEventListener("matchMedia",function(){_refreshAll(0,1),_dispatch("matchMedia")}),gsap.matchMedia("(orientation: portrait)",function(){return _setBaseDimensions(),_setBaseDimensions})):console.warn("Requires GSAP 3.11.0 or later"),_setBaseDimensions(),_addListener(_doc,"scroll",_onScroll);var et=_body.style,ut=et.borderTopStyle,dt=gsap.core.Animation.prototype,mt,yt;for(dt.revert||Object.defineProperty(dt,"revert",{value:function(){return this.time(-.01,!0)}}),et.borderTopStyle="solid",mt=_getBounds(_body),_vertical.m=Math.round(mt.top+_vertical.sc())||0,_horizontal.m=Math.round(mt.left+_horizontal.sc())||0,ut?et.borderTopStyle=ut:et.removeProperty("border-top-style"),_syncInterval=setInterval(_sync,250),gsap.delayedCall(.5,function(){return _startup=0}),_addListener(_doc,"touchcancel",_passThrough),_addListener(_body,"touchstart",_passThrough),_multiListener(_addListener,_doc,"pointerdown,touchstart,mousedown",_pointerDownHandler),_multiListener(_addListener,_doc,"pointerup,touchend,mouseup",_pointerUpHandler),_transformProp=gsap.utils.checkPrefix("transform"),_stateProps.push(_transformProp),_coreInitted=_getTime(),_resizeDelay=gsap.delayedCall(.2,_refreshAll).pause(),_autoRefresh=[_doc,"visibilitychange",function(){var bt=_win.innerWidth,Rt=_win.innerHeight;_doc.hidden?(_prevWidth=bt,_prevHeight=Rt):(_prevWidth!==bt||_prevHeight!==Rt)&&_onResize()},_doc,"DOMContentLoaded",_refreshAll,_win,"load",_refreshAll,_win,"resize",_onResize],_iterateAutoRefresh(_addListener),_triggers.forEach(function(bt){return bt.enable(0,1)}),yt=0;yt<_scrollers.length;yt+=3)_wheelListener(_removeListener,_scrollers[yt],_scrollers[yt+1]),_wheelListener(_removeListener,_scrollers[yt],_scrollers[yt+2])}},$.config=function(et){"limitCallbacks"in et&&(_limitCallbacks=!!et.limitCallbacks);var ut=et.syncInterval;ut&&clearInterval(_syncInterval)||(_syncInterval=ut)&&setInterval(_sync,ut),"ignoreMobileResize"in et&&(_ignoreMobileResize=$.isTouch===1&&et.ignoreMobileResize),"autoRefreshEvents"in et&&(_iterateAutoRefresh(_removeListener)||_iterateAutoRefresh(_addListener,et.autoRefreshEvents||"none"),_ignoreResize=(et.autoRefreshEvents+"").indexOf("resize")===-1)},$.scrollerProxy=function(et,ut){var dt=_getTarget(et),mt=_scrollers.indexOf(dt),yt=_isViewport(dt);~mt&&_scrollers.splice(mt,yt?6:2),ut&&(yt?_proxies.unshift(_win,ut,_body,ut,_docEl,ut):_proxies.unshift(dt,ut))},$.clearMatchMedia=function(et){_triggers.forEach(function(ut){return ut._ctx&&ut._ctx.query===et&&ut._ctx.kill(!0,!0)})},$.isInViewport=function(et,ut,dt){var mt=(_isString(et)?_getTarget(et):et).getBoundingClientRect(),yt=mt[dt?_width:_height]*ut||0;return dt?mt.right-yt>0&&mt.left+yt<_win.innerWidth:mt.bottom-yt>0&&mt.top+yt<_win.innerHeight},$.positionInViewport=function(et,ut,dt){_isString(et)&&(et=_getTarget(et));var mt=et.getBoundingClientRect(),yt=mt[dt?_width:_height],bt=ut==null?yt/2:ut in _keywords?_keywords[ut]*yt:~ut.indexOf("%")?parseFloat(ut)*yt/100:parseFloat(ut)||0;return dt?(mt.left+bt)/_win.innerWidth:(mt.top+bt)/_win.innerHeight},$.killAll=function(et){if(_triggers.slice(0).forEach(function(dt){return dt.vars.id!=="ScrollSmoother"&&dt.kill()}),et!==!0){var ut=_listeners.killAll||[];_listeners={},ut.forEach(function(dt){return dt()})}},$}();ScrollTrigger.version="3.11.4";ScrollTrigger.saveStyles=function($){return $?_toArray($).forEach(function(j){if(j&&j.style){var it=_savedStyles.indexOf(j);it>=0&&_savedStyles.splice(it,5),_savedStyles.push(j,j.style.cssText,j.getBBox&&j.getAttribute("transform"),gsap.core.getCache(j),_context())}}):_savedStyles};ScrollTrigger.revert=function($,j){return _revertAll(!$,j)};ScrollTrigger.create=function($,j){return new ScrollTrigger($,j)};ScrollTrigger.refresh=function($){return $?_onResize():(_coreInitted||ScrollTrigger.register())&&_refreshAll(!0)};ScrollTrigger.update=function($){return++_scrollers.cache&&_updateAll($===!0?2:0)};ScrollTrigger.clearScrollMemory=_clearScrollMemory;ScrollTrigger.maxScroll=function($,j){return _maxScroll($,j?_horizontal:_vertical)};ScrollTrigger.getScrollFunc=function($,j){return _getScrollFunc(_getTarget($),j?_horizontal:_vertical)};ScrollTrigger.getById=function($){return _ids[$]};ScrollTrigger.getAll=function(){return _triggers.filter(function($){return $.vars.id!=="ScrollSmoother"})};ScrollTrigger.isScrolling=function(){return!!_lastScrollTime};ScrollTrigger.snapDirectional=_snapDirectional;ScrollTrigger.addEventListener=function($,j){var it=_listeners[$]||(_listeners[$]=[]);~it.indexOf(j)||it.push(j)};ScrollTrigger.removeEventListener=function($,j){var it=_listeners[$],et=it&&it.indexOf(j);et>=0&&it.splice(et,1)};ScrollTrigger.batch=function($,j){var it=[],et={},ut=j.interval||.016,dt=j.batchMax||1e9,mt=function(Rt,jt){var Vt=[],zt=[],Jt=gsap.delayedCall(ut,function(){jt(Vt,zt),Vt=[],zt=[]}).pause();return function(rr){Vt.length||Jt.restart(!0),Vt.push(rr.trigger),zt.push(rr),dt<=Vt.length&&Jt.progress(1)}},yt;for(yt in j)et[yt]=yt.substr(0,2)==="on"&&_isFunction(j[yt])&&yt!=="onRefreshInit"?mt(yt,j[yt]):j[yt];return _isFunction(dt)&&(dt=dt(),_addListener(ScrollTrigger,"refresh",function(){return dt=j.batchMax()})),_toArray($).forEach(function(bt){var Rt={};for(yt in et)Rt[yt]=et[yt];Rt.trigger=bt,it.push(ScrollTrigger.create(Rt))}),it};var _clampScrollAndGetDurationMultiplier=function $(j,it,et,ut){return it>ut?j(ut):it<0&&j(0),et>ut?(ut-it)/(et-it):et<0?it/(it-et):1},_allowNativePanning=function $(j,it){it===!0?j.style.removeProperty("touch-action"):j.style.touchAction=it===!0?"auto":it?"pan-"+it+(Observer.isTouch?" pinch-zoom":""):"none",j===_docEl&&$(_body,it)},_overflow={auto:1,scroll:1},_nestedScroll=function $(j){var it=j.event,et=j.target,ut=j.axis,dt=(it.changedTouches?it.changedTouches[0]:it).target,mt=dt._gsap||gsap.core.getCache(dt),yt=_getTime(),bt;if(!mt._isScrollT||yt-mt._isScrollT>2e3){for(;dt&&dt!==_body&&(dt.scrollHeight<=dt.clientHeight&&dt.scrollWidth<=dt.clientWidth||!(_overflow[(bt=_getComputedStyle(dt)).overflowY]||_overflow[bt.overflowX]));)dt=dt.parentNode;mt._isScroll=dt&&dt!==et&&!_isViewport(dt)&&(_overflow[(bt=_getComputedStyle(dt)).overflowY]||_overflow[bt.overflowX]),mt._isScrollT=yt}(mt._isScroll||ut==="x")&&(it.stopPropagation(),it._gsapAllow=!0)},_inputObserver=function $(j,it,et,ut){return Observer.create({target:j,capture:!0,debounce:!1,lockAxis:!0,type:it,onWheel:ut=ut&&_nestedScroll,onPress:ut,onDrag:ut,onScroll:ut,onEnable:function(){return et&&_addListener(_doc,Observer.eventTypes[0],_captureInputs,!1,!0)},onDisable:function(){return _removeListener(_doc,Observer.eventTypes[0],_captureInputs,!0)}})},_inputExp=/(input|label|select|textarea)/i,_inputIsFocused,_captureInputs=function $(j){var it=_inputExp.test(j.target.tagName);(it||_inputIsFocused)&&(j._gsapAllow=!0,_inputIsFocused=it)},_getScrollNormalizer=function $(j){_isObject(j)||(j={}),j.preventDefault=j.isNormalizer=j.allowClicks=!0,j.type||(j.type="wheel,touch"),j.debounce=!!j.debounce,j.id=j.id||"normalizer";var it=j,et=it.normalizeScrollX,ut=it.momentum,dt=it.allowNestedScroll,mt,yt,bt=_getTarget(j.target)||_docEl,Rt=gsap.core.globals().ScrollSmoother,jt=Rt&&Rt.get(),Vt=_fixIOSBug&&(j.content&&_getTarget(j.content)||jt&&j.content!==!1&&!jt.smooth()&&jt.content()),zt=_getScrollFunc(bt,_vertical),Jt=_getScrollFunc(bt,_horizontal),rr=1,Yt=(Observer.isTouch&&_win.visualViewport?_win.visualViewport.scale*_win.visualViewport.width:_win.outerWidth)/_win.innerWidth,dr=0,Ft=_isFunction(ut)?function(){return ut(mt)}:function(){return ut||2.8},Ht,er,pr=_inputObserver(bt,j.type,!0,dt),or=function(){return er=!1},ar=_passThrough,Wt=_passThrough,Zt=function(){yt=_maxScroll(bt,_vertical),Wt=_clamp(_fixIOSBug?1:0,yt),et&&(ar=_clamp(0,_maxScroll(bt,_horizontal))),Ht=_refreshID},sr=function(){Vt._gsap.y=_round(parseFloat(Vt._gsap.y)+zt.offset)+"px",Vt.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(Vt._gsap.y)+", 0, 1)",zt.offset=zt.cacheID=0},tr=function(){if(er){requestAnimationFrame(or);var Tn=_round(mt.deltaY/2),qr=Wt(zt.v-Tn);if(Vt&&qr!==zt.v+zt.offset){zt.offset=qr-zt.v;var nn=_round((parseFloat(Vt&&Vt._gsap.y)||0)-zt.offset);Vt.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+nn+", 0, 1)",Vt._gsap.y=nn+"px",zt.cacheID=_scrollers.cache,_updateAll()}return!0}zt.offset&&sr(),er=!0},vr,Vr,hn,cn,gn=function(){Zt(),vr.isActive()&&vr.vars.scrollY>yt&&(zt()>yt?vr.progress(1)&&zt(yt):vr.resetTo("scrollY",yt))};return Vt&&gsap.set(Vt,{y:"+=0"}),j.ignoreCheck=function(tn){return _fixIOSBug&&tn.type==="touchmove"&&tr()||rr>1.05&&tn.type!=="touchstart"||mt.isGesturing||tn.touches&&tn.touches.length>1},j.onPress=function(){var tn=rr;rr=_round((_win.visualViewport&&_win.visualViewport.scale||1)/Yt),vr.pause(),tn!==rr&&_allowNativePanning(bt,rr>1.01?!0:et?!1:"x"),Vr=Jt(),hn=zt(),Zt(),Ht=_refreshID},j.onRelease=j.onGestureStart=function(tn,Tn){if(zt.offset&&sr(),!Tn)cn.restart(!0);else{_scrollers.cache++;var qr=Ft(),nn,yr;et&&(nn=Jt(),yr=nn+qr*.05*-tn.velocityX/.227,qr*=_clampScrollAndGetDurationMultiplier(Jt,nn,yr,_maxScroll(bt,_horizontal)),vr.vars.scrollX=ar(yr)),nn=zt(),yr=nn+qr*.05*-tn.velocityY/.227,qr*=_clampScrollAndGetDurationMultiplier(zt,nn,yr,_maxScroll(bt,_vertical)),vr.vars.scrollY=Wt(yr),vr.invalidate().duration(qr).play(.01),(_fixIOSBug&&vr.vars.scrollY>=yt||nn>=yt-1)&&gsap.to({},{onUpdate:gn,duration:qr})}},j.onWheel=function(){vr._ts&&vr.pause(),_getTime()-dr>1e3&&(Ht=0,dr=_getTime())},j.onChange=function(tn,Tn,qr,nn,yr){if(_refreshID!==Ht&&Zt(),Tn&&et&&Jt(ar(nn[2]===Tn?Vr+(tn.startX-tn.x):Jt()+Tn-nn[1])),qr){zt.offset&&sr();var an=yr[2]===qr,sn=an?hn+tn.startY-tn.y:zt()+qr-yr[1],Rn=Wt(sn);an&&sn!==Rn&&(hn+=Rn-sn),zt(Rn)}(qr||Tn)&&_updateAll()},j.onEnable=function(){_allowNativePanning(bt,et?!1:"x"),ScrollTrigger.addEventListener("refresh",gn),_addListener(_win,"resize",gn),zt.smooth&&(zt.target.style.scrollBehavior="auto",zt.smooth=Jt.smooth=!1),pr.enable()},j.onDisable=function(){_allowNativePanning(bt,!0),_removeListener(_win,"resize",gn),ScrollTrigger.removeEventListener("refresh",gn),pr.kill()},j.lockAxis=j.lockAxis!==!1,mt=new Observer(j),mt.iOS=_fixIOSBug,_fixIOSBug&&!zt()&&zt(1),_fixIOSBug&&gsap.ticker.add(_passThrough),cn=mt._dc,vr=gsap.to(mt,{ease:"power4",paused:!0,scrollX:et?"+=0.1":"+=0",scrollY:"+=0.1",onComplete:cn.vars.onComplete}),mt};ScrollTrigger.sort=function($){return _triggers.sort($||function(j,it){return(j.vars.refreshPriority||0)*-1e6+j.start-(it.start+(it.vars.refreshPriority||0)*-1e6)})};ScrollTrigger.observe=function($){return new Observer($)};ScrollTrigger.normalizeScroll=function($){if(typeof $>"u")return _normalizer;if($===!0&&_normalizer)return _normalizer.enable();if($===!1)return _normalizer&&_normalizer.kill();var j=$ instanceof Observer?$:_getScrollNormalizer($);return _normalizer&&_normalizer.target===j.target&&_normalizer.kill(),_isViewport(j.target)&&(_normalizer=j),j};ScrollTrigger.core={_getVelocityProp,_inputObserver,_scrollers,_proxies,bridge:{ss:function $(){_lastScrollTime||_dispatch("scrollStart"),_lastScrollTime=_getTime()},ref:function $(){return _refreshing}}};_getGSAP()&&gsap.registerPlugin(ScrollTrigger);const scrollAnimation=($,j,it,et)=>{gsapWithCSS.timeline().to($,{x:it?20:10,y:3,z:10,scrollTrigger:{trigger:".display-section",start:"top bottom",end:"top top",scrub:2,immediateRender:!1},onUpdate:et}).to(j,{x:it?0:.56,y:it?.02:.6,z:it?-.06:0,scrollTrigger:{trigger:".display-section",start:"top bottom",end:"top top",scrub:2,immediateRender:!1}}).to(".display-section",{opacity:1,scrollTrigger:{trigger:".display-section",start:"top bottom",end:"top top",scrub:2,immediateRender:!1}})};gsapWithCSS.registerPlugin(ScrollTrigger);const WebGiViewer=reactExports.forwardRef(($,j)=>{const it=reactExports.useRef(null),[et,ut]=reactExports.useState(null),[dt,mt]=reactExports.useState(null),[yt,bt]=reactExports.useState(null),[Rt,jt]=reactExports.useState(null),Vt=reactExports.useRef(),[zt,Jt]=reactExports.useState(!1),[rr,Yt]=reactExports.useState(null);reactExports.useImperativeHandle(j,()=>({triggerPreview(){Jt(!0),Vt.current.style.pointerEvents="all",$.contentRef.current.style.opacity="0",gsapWithCSS.to(Rt,{x:rr?20:10,y:rr?3:2,z:10,duration:1,onUpdate:()=>{et.setDirty(),yt.positionTargetUpdated(!0)}}),gsapWithCSS.to(dt,{x:.11,y:0,z:0,duration:2}),et.scene.activeCamera.setCameraOptions({controlsEnabled:!0})}}));const dr=reactExports.useCallback((er,pr,or,ar)=>{er&&pr&&ar&&scrollAnimation(er,pr,or,ar)}),Ft=reactExports.useCallback(async()=>{const er=new __webpackgi_exports__ViewerApp({canvas:it.current});ut(er);const pr=__webpackgi_exports__mobileAndTabletCheck();Yt(pr);const or=await er.addPlugin(__webpackgi_exports__AssetManagerPlugin),ar=er.scene.activeCamera,Wt=ar.position,Zt=ar.target;bt(ar),jt(Wt),mt(Zt),await er.addPlugin(__webpackgi_exports__GBufferPlugin),await er.addPlugin(new __webpackgi_exports__ProgressivePlugin(32)),await er.addPlugin(new __webpackgi_exports__TonemapPlugin(!0)),await er.addPlugin(__webpackgi_exports__GammaCorrectionPlugin),await er.addPlugin(__webpackgi_exports__SSRPlugin),await er.addPlugin(__webpackgi_exports__SSAOPlugin),await er.addPlugin(__webpackgi_exports__BloomPlugin),er.renderer.refreshPipeline(),await or.addFromPath("scenes.glb"),er.getPlugin(__webpackgi_exports__TonemapPlugin).config.clipBackground=!0,er.scene.activeCamera.setCameraOptions({controlsEnabled:!0}),pr&&(Wt.set(30,3,10),Zt.set(0,1,0),$.contentRef.current.className="mobile-or-tablet"),window.scrollTo(0,0);let sr=!0;const tr=()=>{sr=!0,er.setDirty()};er.addEventListener("preFrame",()=>{sr&&(ar.positionTargetUpdated(!0),sr=!1)}),dr(Wt,Zt,pr,tr)},[]);reactExports.useEffect(()=>{Ft()},[]);const Ht=reactExports.useCallback(()=>{Vt.current.style.pointerEvents="none",$.contentRef.current.style.opacity="1",et.scene.activeCamera.setCameraOptions({controlsEnabled:!1}),Jt(!1),gsapWithCSS.to(Rt,{x:rr?20:2,y:rr?3:5,z:rr?10:.01,scrollTrigger:{trigger:".display-section",start:"top bottom",end:"top top",scrub:2,immediateRender:!1},onUpdate:()=>{et.setDirty(),yt.positionTargetUpdated(!0)}}),gsapWithCSS.to(dt,{x:rr?0:-.55,y:rr?.02:.6,z:rr?-.06:0,scrollTrigger:{trigger:".display-section",start:"top bottom",end:"top top",scrub:1,immediateRender:!1}})},[Vt,et,Rt,yt,dt]);return jsxs("div",{ref:Vt,id:"webgi-canvas-container",children:[jsx("canvas",{id:"webgi-canvas",ref:it}),zt&&jsx("button",{className:"button",onClick:Ht,children:"Exit"})]})});var dist={},click$1={},build$1={},ansiStyles={exports:{}};ansiStyles.exports;(function($){const it=(dt=0)=>mt=>`\x1B[${38+dt};5;${mt}m`,et=(dt=0)=>(mt,yt,bt)=>`\x1B[${38+dt};2;${mt};${yt};${bt}m`;function ut(){const dt=new Map,mt={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};mt.color.gray=mt.color.blackBright,mt.bgColor.bgGray=mt.bgColor.bgBlackBright,mt.color.grey=mt.color.blackBright,mt.bgColor.bgGrey=mt.bgColor.bgBlackBright;for(const[yt,bt]of Object.entries(mt)){for(const[Rt,jt]of Object.entries(bt))mt[Rt]={open:`\x1B[${jt[0]}m`,close:`\x1B[${jt[1]}m`},bt[Rt]=mt[Rt],dt.set(jt[0],jt[1]);Object.defineProperty(mt,yt,{value:bt,enumerable:!1})}return Object.defineProperty(mt,"codes",{value:dt,enumerable:!1}),mt.color.close="\x1B[39m",mt.bgColor.close="\x1B[49m",mt.color.ansi256=it(),mt.color.ansi16m=et(),mt.bgColor.ansi256=it(10),mt.bgColor.ansi16m=et(10),Object.defineProperties(mt,{rgbToAnsi256:{value:(yt,bt,Rt)=>yt===bt&&bt===Rt?yt<8?16:yt>248?231:Math.round((yt-8)/247*24)+232:16+36*Math.round(yt/255*5)+6*Math.round(bt/255*5)+Math.round(Rt/255*5),enumerable:!1},hexToRgb:{value:yt=>{const bt=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(yt.toString(16));if(!bt)return[0,0,0];let{colorString:Rt}=bt.groups;Rt.length===3&&(Rt=Rt.split("").map(Vt=>Vt+Vt).join(""));const jt=Number.parseInt(Rt,16);return[jt>>16&255,jt>>8&255,jt&255]},enumerable:!1},hexToAnsi256:{value:yt=>mt.rgbToAnsi256(...mt.hexToRgb(yt)),enumerable:!1}}),mt}Object.defineProperty($,"exports",{enumerable:!0,get:ut})})(ansiStyles);var ansiStylesExports=ansiStyles.exports,collections={};Object.defineProperty(collections,"__esModule",{value:!0});collections.printIteratorEntries=printIteratorEntries;collections.printIteratorValues=printIteratorValues;collections.printListItems=printListItems;collections.printObjectProperties=printObjectProperties;const getKeysOfEnumerableProperties=($,j)=>{const it=Object.keys($).sort(j);return Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols($).forEach(et=>{Object.getOwnPropertyDescriptor($,et).enumerable&&it.push(et)}),it};function printIteratorEntries($,j,it,et,ut,dt,mt=": "){let yt="",bt=$.next();if(!bt.done){yt+=j.spacingOuter;const Rt=it+j.indent;for(;!bt.done;){const jt=dt(bt.value[0],j,Rt,et,ut),Vt=dt(bt.value[1],j,Rt,et,ut);yt+=Rt+jt+mt+Vt,bt=$.next(),bt.done?j.min||(yt+=","):yt+=","+j.spacingInner}yt+=j.spacingOuter+it}return yt}function printIteratorValues($,j,it,et,ut,dt){let mt="",yt=$.next();if(!yt.done){mt+=j.spacingOuter;const bt=it+j.indent;for(;!yt.done;)mt+=bt+dt(yt.value,j,bt,et,ut),yt=$.next(),yt.done?j.min||(mt+=","):mt+=","+j.spacingInner;mt+=j.spacingOuter+it}return mt}function printListItems($,j,it,et,ut,dt){let mt="";if($.length){mt+=j.spacingOuter;const yt=it+j.indent;for(let bt=0;bt<$.length;bt++)mt+=yt,bt in $&&(mt+=dt($[bt],j,yt,et,ut)),bt<$.length-1?mt+=","+j.spacingInner:j.min||(mt+=",");mt+=j.spacingOuter+it}return mt}function printObjectProperties($,j,it,et,ut,dt){let mt="";const yt=getKeysOfEnumerableProperties($,j.compareKeys);if(yt.length){mt+=j.spacingOuter;const bt=it+j.indent;for(let Rt=0;Rt<yt.length;Rt++){const jt=yt[Rt],Vt=dt(jt,j,bt,et,ut),zt=dt($[jt],j,bt,et,ut);mt+=bt+Vt+": "+zt,Rt<yt.length-1?mt+=","+j.spacingInner:j.min||(mt+=",")}mt+=j.spacingOuter+it}return mt}var AsymmetricMatcher={};Object.defineProperty(AsymmetricMatcher,"__esModule",{value:!0});AsymmetricMatcher.test=AsymmetricMatcher.serialize=AsymmetricMatcher.default=void 0;var _collections$3=collections,global$2=function(){return typeof globalThis<"u"?globalThis:typeof global$2<"u"?global$2:typeof self<"u"?self:typeof window<"u"?window:Function("return this")()}(),Symbol$2=global$2["jest-symbol-do-not-touch"]||global$2.Symbol;const asymmetricMatcher=typeof Symbol$2=="function"&&Symbol$2.for?Symbol$2.for("jest.asymmetricMatcher"):1267621,SPACE$2=" ",serialize$6=($,j,it,et,ut,dt)=>{const mt=$.toString();return mt==="ArrayContaining"||mt==="ArrayNotContaining"?++et>j.maxDepth?"["+mt+"]":mt+SPACE$2+"["+(0,_collections$3.printListItems)($.sample,j,it,et,ut,dt)+"]":mt==="ObjectContaining"||mt==="ObjectNotContaining"?++et>j.maxDepth?"["+mt+"]":mt+SPACE$2+"{"+(0,_collections$3.printObjectProperties)($.sample,j,it,et,ut,dt)+"}":mt==="StringMatching"||mt==="StringNotMatching"||mt==="StringContaining"||mt==="StringNotContaining"?mt+SPACE$2+dt($.sample,j,it,et,ut):$.toAsymmetricMatcher()};AsymmetricMatcher.serialize=serialize$6;const test$6=$=>$&&$.$$typeof===asymmetricMatcher;AsymmetricMatcher.test=test$6;const plugin$6={serialize:serialize$6,test:test$6};var _default$2p=plugin$6;AsymmetricMatcher.default=_default$2p;var ConvertAnsi={},ansiRegex=({onlyFirst:$=!1}={})=>{const j=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(j,$?void 0:"g")};Object.defineProperty(ConvertAnsi,"__esModule",{value:!0});ConvertAnsi.test=ConvertAnsi.serialize=ConvertAnsi.default=void 0;var _ansiRegex=_interopRequireDefault$d(ansiRegex),_ansiStyles$1=_interopRequireDefault$d(ansiStylesExports);function _interopRequireDefault$d($){return $&&$.__esModule?$:{default:$}}const toHumanReadableAnsi=$=>$.replace((0,_ansiRegex.default)(),j=>{switch(j){case _ansiStyles$1.default.red.close:case _ansiStyles$1.default.green.close:case _ansiStyles$1.default.cyan.close:case _ansiStyles$1.default.gray.close:case _ansiStyles$1.default.white.close:case _ansiStyles$1.default.yellow.close:case _ansiStyles$1.default.bgRed.close:case _ansiStyles$1.default.bgGreen.close:case _ansiStyles$1.default.bgYellow.close:case _ansiStyles$1.default.inverse.close:case _ansiStyles$1.default.dim.close:case _ansiStyles$1.default.bold.close:case _ansiStyles$1.default.reset.open:case _ansiStyles$1.default.reset.close:return"</>";case _ansiStyles$1.default.red.open:return"<red>";case _ansiStyles$1.default.green.open:return"<green>";case _ansiStyles$1.default.cyan.open:return"<cyan>";case _ansiStyles$1.default.gray.open:return"<gray>";case _ansiStyles$1.default.white.open:return"<white>";case _ansiStyles$1.default.yellow.open:return"<yellow>";case _ansiStyles$1.default.bgRed.open:return"<bgRed>";case _ansiStyles$1.default.bgGreen.open:return"<bgGreen>";case _ansiStyles$1.default.bgYellow.open:return"<bgYellow>";case _ansiStyles$1.default.inverse.open:return"<inverse>";case _ansiStyles$1.default.dim.open:return"<dim>";case _ansiStyles$1.default.bold.open:return"<bold>";default:return""}}),test$5=$=>typeof $=="string"&&!!$.match((0,_ansiRegex.default)());ConvertAnsi.test=test$5;const serialize$5=($,j,it,et,ut,dt)=>dt(toHumanReadableAnsi($),j,it,et,ut);ConvertAnsi.serialize=serialize$5;const plugin$5={serialize:serialize$5,test:test$5};var _default$2o=plugin$5;ConvertAnsi.default=_default$2o;var DOMCollection$1={};Object.defineProperty(DOMCollection$1,"__esModule",{value:!0});DOMCollection$1.test=DOMCollection$1.serialize=DOMCollection$1.default=void 0;var _collections$2=collections;const SPACE$1=" ",OBJECT_NAMES=["DOMStringMap","NamedNodeMap"],ARRAY_REGEXP=/^(HTML\w*Collection|NodeList)$/,testName=$=>OBJECT_NAMES.indexOf($)!==-1||ARRAY_REGEXP.test($),test$4=$=>$&&$.constructor&&!!$.constructor.name&&testName($.constructor.name);DOMCollection$1.test=test$4;const isNamedNodeMap=$=>$.constructor.name==="NamedNodeMap",serialize$4=($,j,it,et,ut,dt)=>{const mt=$.constructor.name;return++et>j.maxDepth?"["+mt+"]":(j.min?"":mt+SPACE$1)+(OBJECT_NAMES.indexOf(mt)!==-1?"{"+(0,_collections$2.printObjectProperties)(isNamedNodeMap($)?Array.from($).reduce((yt,bt)=>(yt[bt.name]=bt.value,yt),{}):{...$},j,it,et,ut,dt)+"}":"["+(0,_collections$2.printListItems)(Array.from($),j,it,et,ut,dt)+"]")};DOMCollection$1.serialize=serialize$4;const plugin$4={serialize:serialize$4,test:test$4};var _default$2n=plugin$4;DOMCollection$1.default=_default$2n;var DOMElement={},markup={},escapeHTML$2={};Object.defineProperty(escapeHTML$2,"__esModule",{value:!0});escapeHTML$2.default=escapeHTML$1;function escapeHTML$1($){return $.replace(/</g,"&lt;").replace(/>/g,"&gt;")}Object.defineProperty(markup,"__esModule",{value:!0});markup.printText=markup.printProps=markup.printElementAsLeaf=markup.printElement=markup.printComment=markup.printChildren=void 0;var _escapeHTML=_interopRequireDefault$c(escapeHTML$2);function _interopRequireDefault$c($){return $&&$.__esModule?$:{default:$}}const printProps$1=($,j,it,et,ut,dt,mt)=>{const yt=et+it.indent,bt=it.colors;return $.map(Rt=>{const jt=j[Rt];let Vt=mt(jt,it,yt,ut,dt);return typeof jt!="string"&&(Vt.indexOf(`
`)!==-1&&(Vt=it.spacingOuter+yt+Vt+it.spacingOuter+et),Vt="{"+Vt+"}"),it.spacingInner+et+bt.prop.open+Rt+bt.prop.close+"="+bt.value.open+Vt+bt.value.close}).join("")};markup.printProps=printProps$1;const printChildren$1=($,j,it,et,ut,dt)=>$.map(mt=>j.spacingOuter+it+(typeof mt=="string"?printText$1(mt,j):dt(mt,j,it,et,ut))).join("");markup.printChildren=printChildren$1;const printText$1=($,j)=>{const it=j.colors.content;return it.open+(0,_escapeHTML.default)($)+it.close};markup.printText=printText$1;const printComment$1=($,j)=>{const it=j.colors.comment;return it.open+"<!--"+(0,_escapeHTML.default)($)+"-->"+it.close};markup.printComment=printComment$1;const printElement$1=($,j,it,et,ut)=>{const dt=et.colors.tag;return dt.open+"<"+$+(j&&dt.close+j+et.spacingOuter+ut+dt.open)+(it?">"+dt.close+it+et.spacingOuter+ut+dt.open+"</"+$:(j&&!et.min?"":" ")+"/")+">"+dt.close};markup.printElement=printElement$1;const printElementAsLeaf$1=($,j)=>{const it=j.colors.tag;return it.open+"<"+$+it.close+" …"+it.open+" />"+it.close};markup.printElementAsLeaf=printElementAsLeaf$1;Object.defineProperty(DOMElement,"__esModule",{value:!0});DOMElement.test=DOMElement.serialize=DOMElement.default=void 0;var _markup$2=markup;const ELEMENT_NODE$2=1,TEXT_NODE$3=3,COMMENT_NODE$2=8,FRAGMENT_NODE$1=11,ELEMENT_REGEXP$1=/^((HTML|SVG)\w*)?Element$/,testHasAttribute=$=>{try{return typeof $.hasAttribute=="function"&&$.hasAttribute("is")}catch{return!1}},testNode$1=$=>{const j=$.constructor.name,{nodeType:it,tagName:et}=$,ut=typeof et=="string"&&et.includes("-")||testHasAttribute($);return it===ELEMENT_NODE$2&&(ELEMENT_REGEXP$1.test(j)||ut)||it===TEXT_NODE$3&&j==="Text"||it===COMMENT_NODE$2&&j==="Comment"||it===FRAGMENT_NODE$1&&j==="DocumentFragment"},test$3=$=>{var j;return($==null||(j=$.constructor)===null||j===void 0?void 0:j.name)&&testNode$1($)};DOMElement.test=test$3;function nodeIsText$1($){return $.nodeType===TEXT_NODE$3}function nodeIsComment$1($){return $.nodeType===COMMENT_NODE$2}function nodeIsFragment$1($){return $.nodeType===FRAGMENT_NODE$1}const serialize$3=($,j,it,et,ut,dt)=>{if(nodeIsText$1($))return(0,_markup$2.printText)($.data,j);if(nodeIsComment$1($))return(0,_markup$2.printComment)($.data,j);const mt=nodeIsFragment$1($)?"DocumentFragment":$.tagName.toLowerCase();return++et>j.maxDepth?(0,_markup$2.printElementAsLeaf)(mt,j):(0,_markup$2.printElement)(mt,(0,_markup$2.printProps)(nodeIsFragment$1($)?[]:Array.from($.attributes).map(yt=>yt.name).sort(),nodeIsFragment$1($)?{}:Array.from($.attributes).reduce((yt,bt)=>(yt[bt.name]=bt.value,yt),{}),j,it+j.indent,et,ut,dt),(0,_markup$2.printChildren)(Array.prototype.slice.call($.childNodes||$.children),j,it+j.indent,et,ut,dt),j,it)};DOMElement.serialize=serialize$3;const plugin$3={serialize:serialize$3,test:test$3};var _default$2m=plugin$3;DOMElement.default=_default$2m;var Immutable={};Object.defineProperty(Immutable,"__esModule",{value:!0});Immutable.test=Immutable.serialize=Immutable.default=void 0;var _collections$1=collections;const IS_ITERABLE_SENTINEL="@@__IMMUTABLE_ITERABLE__@@",IS_LIST_SENTINEL="@@__IMMUTABLE_LIST__@@",IS_KEYED_SENTINEL="@@__IMMUTABLE_KEYED__@@",IS_MAP_SENTINEL="@@__IMMUTABLE_MAP__@@",IS_ORDERED_SENTINEL="@@__IMMUTABLE_ORDERED__@@",IS_RECORD_SENTINEL="@@__IMMUTABLE_RECORD__@@",IS_SEQ_SENTINEL="@@__IMMUTABLE_SEQ__@@",IS_SET_SENTINEL="@@__IMMUTABLE_SET__@@",IS_STACK_SENTINEL="@@__IMMUTABLE_STACK__@@",getImmutableName=$=>"Immutable."+$,printAsLeaf=$=>"["+$+"]",SPACE=" ",LAZY="…",printImmutableEntries=($,j,it,et,ut,dt,mt)=>++et>j.maxDepth?printAsLeaf(getImmutableName(mt)):getImmutableName(mt)+SPACE+"{"+(0,_collections$1.printIteratorEntries)($.entries(),j,it,et,ut,dt)+"}";function getRecordEntries($){let j=0;return{next(){if(j<$._keys.length){const it=$._keys[j++];return{done:!1,value:[it,$.get(it)]}}return{done:!0,value:void 0}}}}const printImmutableRecord=($,j,it,et,ut,dt)=>{const mt=getImmutableName($._name||"Record");return++et>j.maxDepth?printAsLeaf(mt):mt+SPACE+"{"+(0,_collections$1.printIteratorEntries)(getRecordEntries($),j,it,et,ut,dt)+"}"},printImmutableSeq=($,j,it,et,ut,dt)=>{const mt=getImmutableName("Seq");return++et>j.maxDepth?printAsLeaf(mt):$[IS_KEYED_SENTINEL]?mt+SPACE+"{"+($._iter||$._object?(0,_collections$1.printIteratorEntries)($.entries(),j,it,et,ut,dt):LAZY)+"}":mt+SPACE+"["+($._iter||$._array||$._collection||$._iterable?(0,_collections$1.printIteratorValues)($.values(),j,it,et,ut,dt):LAZY)+"]"},printImmutableValues=($,j,it,et,ut,dt,mt)=>++et>j.maxDepth?printAsLeaf(getImmutableName(mt)):getImmutableName(mt)+SPACE+"["+(0,_collections$1.printIteratorValues)($.values(),j,it,et,ut,dt)+"]",serialize$2=($,j,it,et,ut,dt)=>$[IS_MAP_SENTINEL]?printImmutableEntries($,j,it,et,ut,dt,$[IS_ORDERED_SENTINEL]?"OrderedMap":"Map"):$[IS_LIST_SENTINEL]?printImmutableValues($,j,it,et,ut,dt,"List"):$[IS_SET_SENTINEL]?printImmutableValues($,j,it,et,ut,dt,$[IS_ORDERED_SENTINEL]?"OrderedSet":"Set"):$[IS_STACK_SENTINEL]?printImmutableValues($,j,it,et,ut,dt,"Stack"):$[IS_SEQ_SENTINEL]?printImmutableSeq($,j,it,et,ut,dt):printImmutableRecord($,j,it,et,ut,dt);Immutable.serialize=serialize$2;const test$2=$=>$&&($[IS_ITERABLE_SENTINEL]===!0||$[IS_RECORD_SENTINEL]===!0);Immutable.test=test$2;const plugin$2={serialize:serialize$2,test:test$2};var _default$2l=plugin$2;Immutable.default=_default$2l;var ReactElement={},reactIs={exports:{}},reactIs_production_min={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b=60103,c=60106,d=60107,e=60108,f=60114,g$3=60109,h=60110,k$1=60112,l=60113,m=60120,n=60115,p=60116,q=60121,r=60122,u=60117,v=60129,w=60131;if(typeof Symbol=="function"&&Symbol.for){var x=Symbol.for;b=x("react.element"),c=x("react.portal"),d=x("react.fragment"),e=x("react.strict_mode"),f=x("react.profiler"),g$3=x("react.provider"),h=x("react.context"),k$1=x("react.forward_ref"),l=x("react.suspense"),m=x("react.suspense_list"),n=x("react.memo"),p=x("react.lazy"),q=x("react.block"),r=x("react.server.block"),u=x("react.fundamental"),v=x("react.debug_trace_mode"),w=x("react.legacy_hidden")}function y($){if(typeof $=="object"&&$!==null){var j=$.$$typeof;switch(j){case b:switch($=$.type,$){case d:case f:case e:case l:case m:return $;default:switch($=$&&$.$$typeof,$){case h:case k$1:case p:case n:case g$3:return $;default:return j}}case c:return j}}}var z=g$3,A=b,B=k$1,C=d,D=p,E=n,F=c,G=f,H=e,I=l;reactIs_production_min.ContextConsumer=h;reactIs_production_min.ContextProvider=z;reactIs_production_min.Element=A;reactIs_production_min.ForwardRef=B;reactIs_production_min.Fragment=C;reactIs_production_min.Lazy=D;reactIs_production_min.Memo=E;reactIs_production_min.Portal=F;reactIs_production_min.Profiler=G;reactIs_production_min.StrictMode=H;reactIs_production_min.Suspense=I;reactIs_production_min.isAsyncMode=function(){return!1};reactIs_production_min.isConcurrentMode=function(){return!1};reactIs_production_min.isContextConsumer=function($){return y($)===h};reactIs_production_min.isContextProvider=function($){return y($)===g$3};reactIs_production_min.isElement=function($){return typeof $=="object"&&$!==null&&$.$$typeof===b};reactIs_production_min.isForwardRef=function($){return y($)===k$1};reactIs_production_min.isFragment=function($){return y($)===d};reactIs_production_min.isLazy=function($){return y($)===p};reactIs_production_min.isMemo=function($){return y($)===n};reactIs_production_min.isPortal=function($){return y($)===c};reactIs_production_min.isProfiler=function($){return y($)===f};reactIs_production_min.isStrictMode=function($){return y($)===e};reactIs_production_min.isSuspense=function($){return y($)===l};reactIs_production_min.isValidElementType=function($){return typeof $=="string"||typeof $=="function"||$===d||$===f||$===v||$===e||$===l||$===m||$===w||typeof $=="object"&&$!==null&&($.$$typeof===p||$.$$typeof===n||$.$$typeof===g$3||$.$$typeof===h||$.$$typeof===k$1||$.$$typeof===u||$.$$typeof===q||$[0]===r)};reactIs_production_min.typeOf=y;reactIs.exports=reactIs_production_min;var reactIsExports=reactIs.exports;Object.defineProperty(ReactElement,"__esModule",{value:!0});ReactElement.test=ReactElement.serialize=ReactElement.default=void 0;var ReactIs=_interopRequireWildcard$2(reactIsExports),_markup$1=markup;function _getRequireWildcardCache$2($){if(typeof WeakMap!="function")return null;var j=new WeakMap,it=new WeakMap;return(_getRequireWildcardCache$2=function(et){return et?it:j})($)}function _interopRequireWildcard$2($,j){if(!j&&$&&$.__esModule)return $;if($===null||typeof $!="object"&&typeof $!="function")return{default:$};var it=_getRequireWildcardCache$2(j);if(it&&it.has($))return it.get($);var et={},ut=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var dt in $)if(dt!=="default"&&Object.prototype.hasOwnProperty.call($,dt)){var mt=ut?Object.getOwnPropertyDescriptor($,dt):null;mt&&(mt.get||mt.set)?Object.defineProperty(et,dt,mt):et[dt]=$[dt]}return et.default=$,it&&it.set($,et),et}const getChildren=($,j=[])=>(Array.isArray($)?$.forEach(it=>{getChildren(it,j)}):$!=null&&$!==!1&&j.push($),j),getType=$=>{const j=$.type;if(typeof j=="string")return j;if(typeof j=="function")return j.displayName||j.name||"Unknown";if(ReactIs.isFragment($))return"React.Fragment";if(ReactIs.isSuspense($))return"React.Suspense";if(typeof j=="object"&&j!==null){if(ReactIs.isContextProvider($))return"Context.Provider";if(ReactIs.isContextConsumer($))return"Context.Consumer";if(ReactIs.isForwardRef($)){if(j.displayName)return j.displayName;const it=j.render.displayName||j.render.name||"";return it!==""?"ForwardRef("+it+")":"ForwardRef"}if(ReactIs.isMemo($)){const it=j.displayName||j.type.displayName||j.type.name||"";return it!==""?"Memo("+it+")":"Memo"}}return"UNDEFINED"},getPropKeys$1=$=>{const{props:j}=$;return Object.keys(j).filter(it=>it!=="children"&&j[it]!==void 0).sort()},serialize$1=($,j,it,et,ut,dt)=>++et>j.maxDepth?(0,_markup$1.printElementAsLeaf)(getType($),j):(0,_markup$1.printElement)(getType($),(0,_markup$1.printProps)(getPropKeys$1($),$.props,j,it+j.indent,et,ut,dt),(0,_markup$1.printChildren)(getChildren($.props.children),j,it+j.indent,et,ut,dt),j,it);ReactElement.serialize=serialize$1;const test$1=$=>$!=null&&ReactIs.isElement($);ReactElement.test=test$1;const plugin$1={serialize:serialize$1,test:test$1};var _default$2k=plugin$1;ReactElement.default=_default$2k;var ReactTestComponent={};Object.defineProperty(ReactTestComponent,"__esModule",{value:!0});ReactTestComponent.test=ReactTestComponent.serialize=ReactTestComponent.default=void 0;var _markup=markup,global$1=function(){return typeof globalThis<"u"?globalThis:typeof global$1<"u"?global$1:typeof self<"u"?self:typeof window<"u"?window:Function("return this")()}(),Symbol$1=global$1["jest-symbol-do-not-touch"]||global$1.Symbol;const testSymbol=typeof Symbol$1=="function"&&Symbol$1.for?Symbol$1.for("react.test.json"):245830487,getPropKeys=$=>{const{props:j}=$;return j?Object.keys(j).filter(it=>j[it]!==void 0).sort():[]},serialize=($,j,it,et,ut,dt)=>++et>j.maxDepth?(0,_markup.printElementAsLeaf)($.type,j):(0,_markup.printElement)($.type,$.props?(0,_markup.printProps)(getPropKeys($),$.props,j,it+j.indent,et,ut,dt):"",$.children?(0,_markup.printChildren)($.children,j,it+j.indent,et,ut,dt):"",j,it);ReactTestComponent.serialize=serialize;const test=$=>$&&$.$$typeof===testSymbol;ReactTestComponent.test=test;const plugin={serialize,test};var _default$2j=plugin;ReactTestComponent.default=_default$2j;Object.defineProperty(build$1,"__esModule",{value:!0});var default_1=build$1.default=DEFAULT_OPTIONS_1=build$1.DEFAULT_OPTIONS=void 0,format_1=build$1.format=format,plugins_1=build$1.plugins=void 0,_ansiStyles=_interopRequireDefault$b(ansiStylesExports),_collections=collections,_AsymmetricMatcher=_interopRequireDefault$b(AsymmetricMatcher),_ConvertAnsi=_interopRequireDefault$b(ConvertAnsi),_DOMCollection=_interopRequireDefault$b(DOMCollection$1),_DOMElement=_interopRequireDefault$b(DOMElement),_Immutable=_interopRequireDefault$b(Immutable),_ReactElement=_interopRequireDefault$b(ReactElement),_ReactTestComponent=_interopRequireDefault$b(ReactTestComponent);function _interopRequireDefault$b($){return $&&$.__esModule?$:{default:$}}const toString$1=Object.prototype.toString,toISOString=Date.prototype.toISOString,errorToString=Error.prototype.toString,regExpToString=RegExp.prototype.toString,getConstructorName=$=>typeof $.constructor=="function"&&$.constructor.name||"Object",isWindow=$=>typeof window<"u"&&$===window,SYMBOL_REGEXP=/^Symbol\((.*)\)(.*)$/,NEWLINE_REGEXP=/\n/gi;class PrettyFormatPluginError extends Error{constructor(j,it){super(j),this.stack=it,this.name=this.constructor.name}}function isToStringedArrayType($){return $==="[object Array]"||$==="[object ArrayBuffer]"||$==="[object DataView]"||$==="[object Float32Array]"||$==="[object Float64Array]"||$==="[object Int8Array]"||$==="[object Int16Array]"||$==="[object Int32Array]"||$==="[object Uint8Array]"||$==="[object Uint8ClampedArray]"||$==="[object Uint16Array]"||$==="[object Uint32Array]"}function printNumber($){return Object.is($,-0)?"-0":String($)}function printBigInt($){return`${$}n`}function printFunction($,j){return j?"[Function "+($.name||"anonymous")+"]":"[Function]"}function printSymbol($){return String($).replace(SYMBOL_REGEXP,"Symbol($1)")}function printError($){return"["+errorToString.call($)+"]"}function printBasicValue($,j,it,et){if($===!0||$===!1)return""+$;if($===void 0)return"undefined";if($===null)return"null";const ut=typeof $;if(ut==="number")return printNumber($);if(ut==="bigint")return printBigInt($);if(ut==="string")return et?'"'+$.replace(/"|\\/g,"\\$&")+'"':'"'+$+'"';if(ut==="function")return printFunction($,j);if(ut==="symbol")return printSymbol($);const dt=toString$1.call($);return dt==="[object WeakMap]"?"WeakMap {}":dt==="[object WeakSet]"?"WeakSet {}":dt==="[object Function]"||dt==="[object GeneratorFunction]"?printFunction($,j):dt==="[object Symbol]"?printSymbol($):dt==="[object Date]"?isNaN(+$)?"Date { NaN }":toISOString.call($):dt==="[object Error]"?printError($):dt==="[object RegExp]"?it?regExpToString.call($).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&"):regExpToString.call($):$ instanceof Error?printError($):null}function printComplexValue($,j,it,et,ut,dt){if(ut.indexOf($)!==-1)return"[Circular]";ut=ut.slice(),ut.push($);const mt=++et>j.maxDepth,yt=j.min;if(j.callToJSON&&!mt&&$.toJSON&&typeof $.toJSON=="function"&&!dt)return printer($.toJSON(),j,it,et,ut,!0);const bt=toString$1.call($);return bt==="[object Arguments]"?mt?"[Arguments]":(yt?"":"Arguments ")+"["+(0,_collections.printListItems)($,j,it,et,ut,printer)+"]":isToStringedArrayType(bt)?mt?"["+$.constructor.name+"]":(yt||!j.printBasicPrototype&&$.constructor.name==="Array"?"":$.constructor.name+" ")+"["+(0,_collections.printListItems)($,j,it,et,ut,printer)+"]":bt==="[object Map]"?mt?"[Map]":"Map {"+(0,_collections.printIteratorEntries)($.entries(),j,it,et,ut,printer," => ")+"}":bt==="[object Set]"?mt?"[Set]":"Set {"+(0,_collections.printIteratorValues)($.values(),j,it,et,ut,printer)+"}":mt||isWindow($)?"["+getConstructorName($)+"]":(yt||!j.printBasicPrototype&&getConstructorName($)==="Object"?"":getConstructorName($)+" ")+"{"+(0,_collections.printObjectProperties)($,j,it,et,ut,printer)+"}"}function isNewPlugin($){return $.serialize!=null}function printPlugin($,j,it,et,ut,dt){let mt;try{mt=isNewPlugin($)?$.serialize(j,it,et,ut,dt,printer):$.print(j,yt=>printer(yt,it,et,ut,dt),yt=>{const bt=et+it.indent;return bt+yt.replace(NEWLINE_REGEXP,`
`+bt)},{edgeSpacing:it.spacingOuter,min:it.min,spacing:it.spacingInner},it.colors)}catch(yt){throw new PrettyFormatPluginError(yt.message,yt.stack)}if(typeof mt!="string")throw new Error(`pretty-format: Plugin must return type "string" but instead returned "${typeof mt}".`);return mt}function findPlugin($,j){for(let it=0;it<$.length;it++)try{if($[it].test(j))return $[it]}catch(et){throw new PrettyFormatPluginError(et.message,et.stack)}return null}function printer($,j,it,et,ut,dt){const mt=findPlugin(j.plugins,$);if(mt!==null)return printPlugin(mt,$,j,it,et,ut);const yt=printBasicValue($,j.printFunctionName,j.escapeRegex,j.escapeString);return yt!==null?yt:printComplexValue($,j,it,et,ut,dt)}const DEFAULT_THEME={comment:"gray",content:"reset",prop:"yellow",tag:"cyan",value:"green"},DEFAULT_THEME_KEYS=Object.keys(DEFAULT_THEME),DEFAULT_OPTIONS={callToJSON:!0,compareKeys:void 0,escapeRegex:!1,escapeString:!0,highlight:!1,indent:2,maxDepth:1/0,min:!1,plugins:[],printBasicPrototype:!0,printFunctionName:!0,theme:DEFAULT_THEME};var DEFAULT_OPTIONS_1=build$1.DEFAULT_OPTIONS=DEFAULT_OPTIONS;function validateOptions($){if(Object.keys($).forEach(j=>{if(!DEFAULT_OPTIONS.hasOwnProperty(j))throw new Error(`pretty-format: Unknown option "${j}".`)}),$.min&&$.indent!==void 0&&$.indent!==0)throw new Error('pretty-format: Options "min" and "indent" cannot be used together.');if($.theme!==void 0){if($.theme===null)throw new Error('pretty-format: Option "theme" must not be null.');if(typeof $.theme!="object")throw new Error(`pretty-format: Option "theme" must be of type "object" but instead received "${typeof $.theme}".`)}}const getColorsHighlight=$=>DEFAULT_THEME_KEYS.reduce((j,it)=>{const et=$.theme&&$.theme[it]!==void 0?$.theme[it]:DEFAULT_THEME[it],ut=et&&_ansiStyles.default[et];if(ut&&typeof ut.close=="string"&&typeof ut.open=="string")j[it]=ut;else throw new Error(`pretty-format: Option "theme" has a key "${it}" whose value "${et}" is undefined in ansi-styles.`);return j},Object.create(null)),getColorsEmpty=()=>DEFAULT_THEME_KEYS.reduce(($,j)=>($[j]={close:"",open:""},$),Object.create(null)),getPrintFunctionName=$=>$&&$.printFunctionName!==void 0?$.printFunctionName:DEFAULT_OPTIONS.printFunctionName,getEscapeRegex=$=>$&&$.escapeRegex!==void 0?$.escapeRegex:DEFAULT_OPTIONS.escapeRegex,getEscapeString=$=>$&&$.escapeString!==void 0?$.escapeString:DEFAULT_OPTIONS.escapeString,getConfig$1=$=>{var j;return{callToJSON:$&&$.callToJSON!==void 0?$.callToJSON:DEFAULT_OPTIONS.callToJSON,colors:$&&$.highlight?getColorsHighlight($):getColorsEmpty(),compareKeys:$&&typeof $.compareKeys=="function"?$.compareKeys:DEFAULT_OPTIONS.compareKeys,escapeRegex:getEscapeRegex($),escapeString:getEscapeString($),indent:$&&$.min?"":createIndent($&&$.indent!==void 0?$.indent:DEFAULT_OPTIONS.indent),maxDepth:$&&$.maxDepth!==void 0?$.maxDepth:DEFAULT_OPTIONS.maxDepth,min:$&&$.min!==void 0?$.min:DEFAULT_OPTIONS.min,plugins:$&&$.plugins!==void 0?$.plugins:DEFAULT_OPTIONS.plugins,printBasicPrototype:(j=$==null?void 0:$.printBasicPrototype)!==null&&j!==void 0?j:!0,printFunctionName:getPrintFunctionName($),spacingInner:$&&$.min?" ":`
`,spacingOuter:$&&$.min?"":`
`}};function createIndent($){return new Array($+1).join(" ")}function format($,j){if(j&&(validateOptions(j),j.plugins)){const et=findPlugin(j.plugins,$);if(et!==null)return printPlugin(et,$,getConfig$1(j),"",0,[])}const it=printBasicValue($,getPrintFunctionName(j),getEscapeRegex(j),getEscapeString(j));return it!==null?it:printComplexValue($,getConfig$1(j),"",0,[])}const plugins$2={AsymmetricMatcher:_AsymmetricMatcher.default,ConvertAnsi:_ConvertAnsi.default,DOMCollection:_DOMCollection.default,DOMElement:_DOMElement.default,Immutable:_Immutable.default,ReactElement:_ReactElement.default,ReactTestComponent:_ReactTestComponent.default};plugins_1=build$1.plugins=plugins$2;var _default$2i=format;default_1=build$1.default=_default$2i;const index$1=_mergeNamespaces({__proto__:null,get DEFAULT_OPTIONS(){return DEFAULT_OPTIONS_1},get default(){return default_1},format:format_1,get plugins(){return plugins_1}},[build$1]);var toStr$a=Object.prototype.toString;function isCallable$2($){return typeof $=="function"||toStr$a.call($)==="[object Function]"}function toInteger($){var j=Number($);return isNaN(j)?0:j===0||!isFinite(j)?j:(j>0?1:-1)*Math.floor(Math.abs(j))}var maxSafeInteger=Math.pow(2,53)-1;function toLength($){var j=toInteger($);return Math.min(Math.max(j,0),maxSafeInteger)}function arrayFrom($,j){var it=Array,et=Object($);if($==null)throw new TypeError("Array.from requires an array-like object - not null or undefined");if(typeof j<"u"&&!isCallable$2(j))throw new TypeError("Array.from: when provided, the second argument must be a function");for(var ut=toLength(et.length),dt=isCallable$2(it)?Object(new it(ut)):new Array(ut),mt=0,yt;mt<ut;)yt=et[mt],j?dt[mt]=j(yt,mt):dt[mt]=yt,mt+=1;return dt.length=ut,dt}function _typeof$2($){"@babel/helpers - typeof";return _typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},_typeof$2($)}function _classCallCheck($,j){if(!($ instanceof j))throw new TypeError("Cannot call a class as a function")}function _defineProperties($,j){for(var it=0;it<j.length;it++){var et=j[it];et.enumerable=et.enumerable||!1,et.configurable=!0,"value"in et&&(et.writable=!0),Object.defineProperty($,_toPropertyKey$1(et.key),et)}}function _createClass($,j,it){return j&&_defineProperties($.prototype,j),it&&_defineProperties($,it),Object.defineProperty($,"prototype",{writable:!1}),$}function _defineProperty$2($,j,it){return j=_toPropertyKey$1(j),j in $?Object.defineProperty($,j,{value:it,enumerable:!0,configurable:!0,writable:!0}):$[j]=it,$}function _toPropertyKey$1($){var j=_toPrimitive$1($,"string");return _typeof$2(j)==="symbol"?j:String(j)}function _toPrimitive$1($,j){if(_typeof$2($)!=="object"||$===null)return $;var it=$[Symbol.toPrimitive];if(it!==void 0){var et=it.call($,j||"default");if(_typeof$2(et)!=="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return(j==="string"?String:Number)($)}var SetLike=function(){function $(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];_classCallCheck(this,$),_defineProperty$2(this,"items",void 0),this.items=j}return _createClass($,[{key:"add",value:function(it){return this.has(it)===!1&&this.items.push(it),this}},{key:"clear",value:function(){this.items=[]}},{key:"delete",value:function(it){var et=this.items.length;return this.items=this.items.filter(function(ut){return ut!==it}),et!==this.items.length}},{key:"forEach",value:function(it){var et=this;this.items.forEach(function(ut){it(ut,ut,et)})}},{key:"has",value:function(it){return this.items.indexOf(it)!==-1}},{key:"size",get:function(){return this.items.length}}]),$}();const SetLike$1=typeof Set>"u"?Set:SetLike;function getLocalName($){var j;return(j=$.localName)!==null&&j!==void 0?j:$.tagName.toLowerCase()}var localNameToRoleMappings={article:"article",aside:"complementary",button:"button",datalist:"listbox",dd:"definition",details:"group",dialog:"dialog",dt:"term",fieldset:"group",figure:"figure",form:"form",footer:"contentinfo",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading",header:"banner",hr:"separator",html:"document",legend:"legend",li:"listitem",math:"math",main:"main",menu:"list",nav:"navigation",ol:"list",optgroup:"group",option:"option",output:"status",progress:"progressbar",section:"region",summary:"button",table:"table",tbody:"rowgroup",textarea:"textbox",tfoot:"rowgroup",td:"cell",th:"columnheader",thead:"rowgroup",tr:"row",ul:"list"},prohibitedAttributes={caption:new Set(["aria-label","aria-labelledby"]),code:new Set(["aria-label","aria-labelledby"]),deletion:new Set(["aria-label","aria-labelledby"]),emphasis:new Set(["aria-label","aria-labelledby"]),generic:new Set(["aria-label","aria-labelledby","aria-roledescription"]),insertion:new Set(["aria-label","aria-labelledby"]),paragraph:new Set(["aria-label","aria-labelledby"]),presentation:new Set(["aria-label","aria-labelledby"]),strong:new Set(["aria-label","aria-labelledby"]),subscript:new Set(["aria-label","aria-labelledby"]),superscript:new Set(["aria-label","aria-labelledby"])};function hasGlobalAriaAttributes($,j){return["aria-atomic","aria-busy","aria-controls","aria-current","aria-describedby","aria-details","aria-dropeffect","aria-flowto","aria-grabbed","aria-hidden","aria-keyshortcuts","aria-label","aria-labelledby","aria-live","aria-owns","aria-relevant","aria-roledescription"].some(function(it){var et;return $.hasAttribute(it)&&!((et=prohibitedAttributes[j])!==null&&et!==void 0&&et.has(it))})}function ignorePresentationalRole($,j){return hasGlobalAriaAttributes($,j)}function getRole($){var j=getExplicitRole($);if(j===null||j==="presentation"){var it=getImplicitRole($);if(j!=="presentation"||ignorePresentationalRole($,it||""))return it}return j}function getImplicitRole($){var j=localNameToRoleMappings[getLocalName($)];if(j!==void 0)return j;switch(getLocalName($)){case"a":case"area":case"link":if($.hasAttribute("href"))return"link";break;case"img":return $.getAttribute("alt")===""&&!ignorePresentationalRole($,"img")?"presentation":"img";case"input":{var it=$,et=it.type;switch(et){case"button":case"image":case"reset":case"submit":return"button";case"checkbox":case"radio":return et;case"range":return"slider";case"email":case"tel":case"text":case"url":return $.hasAttribute("list")?"combobox":"textbox";case"search":return $.hasAttribute("list")?"combobox":"searchbox";case"number":return"spinbutton";default:return null}}case"select":return $.hasAttribute("multiple")||$.size>1?"listbox":"combobox"}return null}function getExplicitRole($){var j=$.getAttribute("role");if(j!==null){var it=j.trim().split(" ")[0];if(it.length>0)return it}return null}function isElement$1($){return $!==null&&$.nodeType===$.ELEMENT_NODE}function isHTMLTableCaptionElement($){return isElement$1($)&&getLocalName($)==="caption"}function isHTMLInputElement($){return isElement$1($)&&getLocalName($)==="input"}function isHTMLOptGroupElement($){return isElement$1($)&&getLocalName($)==="optgroup"}function isHTMLSelectElement($){return isElement$1($)&&getLocalName($)==="select"}function isHTMLTableElement($){return isElement$1($)&&getLocalName($)==="table"}function isHTMLTextAreaElement($){return isElement$1($)&&getLocalName($)==="textarea"}function safeWindow($){var j=$.ownerDocument===null?$:$.ownerDocument,it=j.defaultView;if(it===null)throw new TypeError("no window available");return it}function isHTMLFieldSetElement($){return isElement$1($)&&getLocalName($)==="fieldset"}function isHTMLLegendElement($){return isElement$1($)&&getLocalName($)==="legend"}function isHTMLSlotElement($){return isElement$1($)&&getLocalName($)==="slot"}function isSVGElement($){return isElement$1($)&&$.ownerSVGElement!==void 0}function isSVGSVGElement($){return isElement$1($)&&getLocalName($)==="svg"}function isSVGTitleElement($){return isSVGElement($)&&getLocalName($)==="title"}function queryIdRefs($,j){if(isElement$1($)&&$.hasAttribute(j)){var it=$.getAttribute(j).split(" "),et=$.getRootNode?$.getRootNode():$.ownerDocument;return it.map(function(ut){return et.getElementById(ut)}).filter(function(ut){return ut!==null})}return[]}function hasAnyConcreteRoles($,j){return isElement$1($)?j.indexOf(getRole($))!==-1:!1}function asFlatString($){return $.trim().replace(/\s\s+/g," ")}function isHidden($,j){if(!isElement$1($))return!1;if($.hasAttribute("hidden")||$.getAttribute("aria-hidden")==="true")return!0;var it=j($);return it.getPropertyValue("display")==="none"||it.getPropertyValue("visibility")==="hidden"}function isControl($){return hasAnyConcreteRoles($,["button","combobox","listbox","textbox"])||hasAbstractRole($,"range")}function hasAbstractRole($,j){if(!isElement$1($))return!1;switch(j){case"range":return hasAnyConcreteRoles($,["meter","progressbar","scrollbar","slider","spinbutton"]);default:throw new TypeError("No knowledge about abstract role '".concat(j,"'. This is likely a bug :("))}}function querySelectorAllSubtree($,j){var it=arrayFrom($.querySelectorAll(j));return queryIdRefs($,"aria-owns").forEach(function(et){it.push.apply(it,arrayFrom(et.querySelectorAll(j)))}),it}function querySelectedOptions($){return isHTMLSelectElement($)?$.selectedOptions||querySelectorAllSubtree($,"[selected]"):querySelectorAllSubtree($,'[aria-selected="true"]')}function isMarkedPresentational($){return hasAnyConcreteRoles($,["none","presentation"])}function isNativeHostLanguageTextAlternativeElement($){return isHTMLTableCaptionElement($)}function allowsNameFromContent($){return hasAnyConcreteRoles($,["button","cell","checkbox","columnheader","gridcell","heading","label","legend","link","menuitem","menuitemcheckbox","menuitemradio","option","radio","row","rowheader","switch","tab","tooltip","treeitem"])}function isDescendantOfNativeHostLanguageTextAlternativeElement($){return!1}function getValueOfTextbox($){return isHTMLInputElement($)||isHTMLTextAreaElement($)?$.value:$.textContent||""}function getTextualContent($){var j=$.getPropertyValue("content");return/^["'].*["']$/.test(j)?j.slice(1,-1):""}function isLabelableElement($){var j=getLocalName($);return j==="button"||j==="input"&&$.getAttribute("type")!=="hidden"||j==="meter"||j==="output"||j==="progress"||j==="select"||j==="textarea"}function findLabelableElement($){if(isLabelableElement($))return $;var j=null;return $.childNodes.forEach(function(it){if(j===null&&isElement$1(it)){var et=findLabelableElement(it);et!==null&&(j=et)}}),j}function getControlOfLabel($){if($.control!==void 0)return $.control;var j=$.getAttribute("for");return j!==null?$.ownerDocument.getElementById(j):findLabelableElement($)}function getLabels$1($){var j=$.labels;if(j===null)return j;if(j!==void 0)return arrayFrom(j);if(!isLabelableElement($))return null;var it=$.ownerDocument;return arrayFrom(it.querySelectorAll("label")).filter(function(et){return getControlOfLabel(et)===$})}function getSlotContents($){var j=$.assignedNodes();return j.length===0?arrayFrom($.childNodes):j}function computeTextAlternative($){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},it=new SetLike$1,et=safeWindow($),ut=j.compute,dt=ut===void 0?"name":ut,mt=j.computedStyleSupportsPseudoElements,yt=mt===void 0?j.getComputedStyle!==void 0:mt,bt=j.getComputedStyle,Rt=bt===void 0?et.getComputedStyle.bind(et):bt,jt=j.hidden,Vt=jt===void 0?!1:jt;function zt(Ft,Ht){var er="";if(isElement$1(Ft)&&yt){var pr=Rt(Ft,"::before"),or=getTextualContent(pr);er="".concat(or," ").concat(er)}var ar=isHTMLSlotElement(Ft)?getSlotContents(Ft):arrayFrom(Ft.childNodes).concat(queryIdRefs(Ft,"aria-owns"));if(ar.forEach(function(sr){var tr=dr(sr,{isEmbeddedInLabel:Ht.isEmbeddedInLabel,isReferenced:!1,recursion:!0}),vr=isElement$1(sr)?Rt(sr).getPropertyValue("display"):"inline",Vr=vr!=="inline"?" ":"";er+="".concat(Vr).concat(tr).concat(Vr)}),isElement$1(Ft)&&yt){var Wt=Rt(Ft,"::after"),Zt=getTextualContent(Wt);er="".concat(er," ").concat(Zt)}return er.trim()}function Jt(Ft,Ht){var er=Ft.getAttributeNode(Ht);return er!==null&&!it.has(er)&&er.value.trim()!==""?(it.add(er),er.value):null}function rr(Ft){return isElement$1(Ft)?Jt(Ft,"title"):null}function Yt(Ft){if(!isElement$1(Ft))return null;if(isHTMLFieldSetElement(Ft)){it.add(Ft);for(var Ht=arrayFrom(Ft.childNodes),er=0;er<Ht.length;er+=1){var pr=Ht[er];if(isHTMLLegendElement(pr))return dr(pr,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(isHTMLTableElement(Ft)){it.add(Ft);for(var or=arrayFrom(Ft.childNodes),ar=0;ar<or.length;ar+=1){var Wt=or[ar];if(isHTMLTableCaptionElement(Wt))return dr(Wt,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(isSVGSVGElement(Ft)){it.add(Ft);for(var Zt=arrayFrom(Ft.childNodes),sr=0;sr<Zt.length;sr+=1){var tr=Zt[sr];if(isSVGTitleElement(tr))return tr.textContent}return null}else if(getLocalName(Ft)==="img"||getLocalName(Ft)==="area"){var vr=Jt(Ft,"alt");if(vr!==null)return vr}else if(isHTMLOptGroupElement(Ft)){var Vr=Jt(Ft,"label");if(Vr!==null)return Vr}if(isHTMLInputElement(Ft)&&(Ft.type==="button"||Ft.type==="submit"||Ft.type==="reset")){var hn=Jt(Ft,"value");if(hn!==null)return hn;if(Ft.type==="submit")return"Submit";if(Ft.type==="reset")return"Reset"}var cn=getLabels$1(Ft);if(cn!==null&&cn.length!==0)return it.add(Ft),arrayFrom(cn).map(function(qr){return dr(qr,{isEmbeddedInLabel:!0,isReferenced:!1,recursion:!0})}).filter(function(qr){return qr.length>0}).join(" ");if(isHTMLInputElement(Ft)&&Ft.type==="image"){var gn=Jt(Ft,"alt");if(gn!==null)return gn;var tn=Jt(Ft,"title");return tn!==null?tn:"Submit Query"}if(hasAnyConcreteRoles(Ft,["button"])){var Tn=zt(Ft,{isEmbeddedInLabel:!1,isReferenced:!1});if(Tn!=="")return Tn}return null}function dr(Ft,Ht){if(it.has(Ft))return"";if(!Vt&&isHidden(Ft,Rt)&&!Ht.isReferenced)return it.add(Ft),"";var er=isElement$1(Ft)?Ft.getAttributeNode("aria-labelledby"):null,pr=er!==null&&!it.has(er)?queryIdRefs(Ft,"aria-labelledby"):[];if(dt==="name"&&!Ht.isReferenced&&pr.length>0)return it.add(er),pr.map(function(vr){return dr(vr,{isEmbeddedInLabel:Ht.isEmbeddedInLabel,isReferenced:!0,recursion:!1})}).join(" ");var or=Ht.recursion&&isControl(Ft)&&dt==="name";if(!or){var ar=(isElement$1(Ft)&&Ft.getAttribute("aria-label")||"").trim();if(ar!==""&&dt==="name")return it.add(Ft),ar;if(!isMarkedPresentational(Ft)){var Wt=Yt(Ft);if(Wt!==null)return it.add(Ft),Wt}}if(hasAnyConcreteRoles(Ft,["menu"]))return it.add(Ft),"";if(or||Ht.isEmbeddedInLabel||Ht.isReferenced){if(hasAnyConcreteRoles(Ft,["combobox","listbox"])){it.add(Ft);var Zt=querySelectedOptions(Ft);return Zt.length===0?isHTMLInputElement(Ft)?Ft.value:"":arrayFrom(Zt).map(function(vr){return dr(vr,{isEmbeddedInLabel:Ht.isEmbeddedInLabel,isReferenced:!1,recursion:!0})}).join(" ")}if(hasAbstractRole(Ft,"range"))return it.add(Ft),Ft.hasAttribute("aria-valuetext")?Ft.getAttribute("aria-valuetext"):Ft.hasAttribute("aria-valuenow")?Ft.getAttribute("aria-valuenow"):Ft.getAttribute("value")||"";if(hasAnyConcreteRoles(Ft,["textbox"]))return it.add(Ft),getValueOfTextbox(Ft)}if(allowsNameFromContent(Ft)||isElement$1(Ft)&&Ht.isReferenced||isNativeHostLanguageTextAlternativeElement(Ft)||isDescendantOfNativeHostLanguageTextAlternativeElement()){var sr=zt(Ft,{isEmbeddedInLabel:Ht.isEmbeddedInLabel,isReferenced:!1});if(sr!=="")return it.add(Ft),sr}if(Ft.nodeType===Ft.TEXT_NODE)return it.add(Ft),Ft.textContent||"";if(Ht.recursion)return it.add(Ft),zt(Ft,{isEmbeddedInLabel:Ht.isEmbeddedInLabel,isReferenced:!1});var tr=rr(Ft);return tr!==null?(it.add(Ft),tr):(it.add(Ft),"")}return asFlatString(dr($,{isEmbeddedInLabel:!1,isReferenced:dt==="description",recursion:!1}))}function _typeof$1($){"@babel/helpers - typeof";return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},_typeof$1($)}function ownKeys($,j){var it=Object.keys($);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols($);j&&(et=et.filter(function(ut){return Object.getOwnPropertyDescriptor($,ut).enumerable})),it.push.apply(it,et)}return it}function _objectSpread($){for(var j=1;j<arguments.length;j++){var it=arguments[j]!=null?arguments[j]:{};j%2?ownKeys(Object(it),!0).forEach(function(et){_defineProperty$1($,et,it[et])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(it)):ownKeys(Object(it)).forEach(function(et){Object.defineProperty($,et,Object.getOwnPropertyDescriptor(it,et))})}return $}function _defineProperty$1($,j,it){return j=_toPropertyKey(j),j in $?Object.defineProperty($,j,{value:it,enumerable:!0,configurable:!0,writable:!0}):$[j]=it,$}function _toPropertyKey($){var j=_toPrimitive($,"string");return _typeof$1(j)==="symbol"?j:String(j)}function _toPrimitive($,j){if(_typeof$1($)!=="object"||$===null)return $;var it=$[Symbol.toPrimitive];if(it!==void 0){var et=it.call($,j||"default");if(_typeof$1(et)!=="object")return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return(j==="string"?String:Number)($)}function computeAccessibleDescription($){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},it=queryIdRefs($,"aria-describedby").map(function(ut){return computeTextAlternative(ut,_objectSpread(_objectSpread({},j),{},{compute:"description"}))}).join(" ");if(it===""){var et=$.getAttribute("title");it=et===null?"":et}return it}function prohibitsNaming($){return hasAnyConcreteRoles($,["caption","code","deletion","emphasis","generic","insertion","paragraph","presentation","strong","subscript","superscript"])}function computeAccessibleName($){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return prohibitsNaming($)?"":computeTextAlternative($,j)}var lib={},ariaPropsMap$1={},iterationDecorator$1={},iteratorProxy$1={};Object.defineProperty(iteratorProxy$1,"__esModule",{value:!0});iteratorProxy$1.default=void 0;function iteratorProxy(){var $=this,j=0,it={"@@iterator":function(){return it},next:function(){if(j<$.length){var ut=$[j];return j=j+1,{done:!1,value:ut}}else return{done:!0}}};return it}var _default$2h=iteratorProxy;iteratorProxy$1.default=_default$2h;Object.defineProperty(iterationDecorator$1,"__esModule",{value:!0});iterationDecorator$1.default=iterationDecorator;var _iteratorProxy=_interopRequireDefault$a(iteratorProxy$1);function _interopRequireDefault$a($){return $&&$.__esModule?$:{default:$}}function _typeof($){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},_typeof($)}function iterationDecorator($,j){return typeof Symbol=="function"&&_typeof(Symbol.iterator)==="symbol"&&Object.defineProperty($,Symbol.iterator,{value:_iteratorProxy.default.bind(j)}),$}Object.defineProperty(ariaPropsMap$1,"__esModule",{value:!0});ariaPropsMap$1.default=void 0;var _iterationDecorator$4=_interopRequireDefault$9(iterationDecorator$1);function _interopRequireDefault$9($){return $&&$.__esModule?$:{default:$}}function _slicedToArray$4($,j){return _arrayWithHoles$4($)||_iterableToArrayLimit$4($,j)||_unsupportedIterableToArray$4($,j)||_nonIterableRest$4()}function _nonIterableRest$4(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArrayLimit$4($,j){var it=$==null?null:typeof Symbol<"u"&&$[Symbol.iterator]||$["@@iterator"];if(it!=null){var et=[],ut=!0,dt=!1,mt,yt;try{for(it=it.call($);!(ut=(mt=it.next()).done)&&(et.push(mt.value),!(j&&et.length===j));ut=!0);}catch(bt){dt=!0,yt=bt}finally{try{!ut&&it.return!=null&&it.return()}finally{if(dt)throw yt}}return et}}function _arrayWithHoles$4($){if(Array.isArray($))return $}function _createForOfIteratorHelper$4($,j){var it=typeof Symbol<"u"&&$[Symbol.iterator]||$["@@iterator"];if(!it){if(Array.isArray($)||(it=_unsupportedIterableToArray$4($))||j&&$&&typeof $.length=="number"){it&&($=it);var et=0,ut=function(){};return{s:ut,n:function(){return et>=$.length?{done:!0}:{done:!1,value:$[et++]}},e:function(Rt){throw Rt},f:ut}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var dt=!0,mt=!1,yt;return{s:function(){it=it.call($)},n:function(){var Rt=it.next();return dt=Rt.done,Rt},e:function(Rt){mt=!0,yt=Rt},f:function(){try{!dt&&it.return!=null&&it.return()}finally{if(mt)throw yt}}}}function _unsupportedIterableToArray$4($,j){if($){if(typeof $=="string")return _arrayLikeToArray$4($,j);var it=Object.prototype.toString.call($).slice(8,-1);if(it==="Object"&&$.constructor&&(it=$.constructor.name),it==="Map"||it==="Set")return Array.from($);if(it==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(it))return _arrayLikeToArray$4($,j)}}function _arrayLikeToArray$4($,j){(j==null||j>$.length)&&(j=$.length);for(var it=0,et=new Array(j);it<j;it++)et[it]=$[it];return et}var properties=[["aria-activedescendant",{type:"id"}],["aria-atomic",{type:"boolean"}],["aria-autocomplete",{type:"token",values:["inline","list","both","none"]}],["aria-busy",{type:"boolean"}],["aria-checked",{type:"tristate"}],["aria-colcount",{type:"integer"}],["aria-colindex",{type:"integer"}],["aria-colspan",{type:"integer"}],["aria-controls",{type:"idlist"}],["aria-current",{type:"token",values:["page","step","location","date","time",!0,!1]}],["aria-describedby",{type:"idlist"}],["aria-details",{type:"id"}],["aria-disabled",{type:"boolean"}],["aria-dropeffect",{type:"tokenlist",values:["copy","execute","link","move","none","popup"]}],["aria-errormessage",{type:"id"}],["aria-expanded",{type:"boolean",allowundefined:!0}],["aria-flowto",{type:"idlist"}],["aria-grabbed",{type:"boolean",allowundefined:!0}],["aria-haspopup",{type:"token",values:[!1,!0,"menu","listbox","tree","grid","dialog"]}],["aria-hidden",{type:"boolean",allowundefined:!0}],["aria-invalid",{type:"token",values:["grammar",!1,"spelling",!0]}],["aria-keyshortcuts",{type:"string"}],["aria-label",{type:"string"}],["aria-labelledby",{type:"idlist"}],["aria-level",{type:"integer"}],["aria-live",{type:"token",values:["assertive","off","polite"]}],["aria-modal",{type:"boolean"}],["aria-multiline",{type:"boolean"}],["aria-multiselectable",{type:"boolean"}],["aria-orientation",{type:"token",values:["vertical","undefined","horizontal"]}],["aria-owns",{type:"idlist"}],["aria-placeholder",{type:"string"}],["aria-posinset",{type:"integer"}],["aria-pressed",{type:"tristate"}],["aria-readonly",{type:"boolean"}],["aria-relevant",{type:"tokenlist",values:["additions","all","removals","text"]}],["aria-required",{type:"boolean"}],["aria-roledescription",{type:"string"}],["aria-rowcount",{type:"integer"}],["aria-rowindex",{type:"integer"}],["aria-rowspan",{type:"integer"}],["aria-selected",{type:"boolean",allowundefined:!0}],["aria-setsize",{type:"integer"}],["aria-sort",{type:"token",values:["ascending","descending","none","other"]}],["aria-valuemax",{type:"number"}],["aria-valuemin",{type:"number"}],["aria-valuenow",{type:"number"}],["aria-valuetext",{type:"string"}]],ariaPropsMap={entries:function $(){return properties},forEach:function $(j){var it=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,et=_createForOfIteratorHelper$4(properties),ut;try{for(et.s();!(ut=et.n()).done;){var dt=_slicedToArray$4(ut.value,2),mt=dt[0],yt=dt[1];j.call(it,yt,mt,properties)}}catch(bt){et.e(bt)}finally{et.f()}},get:function $(j){var it=properties.find(function(et){return et[0]===j});return it&&it[1]},has:function $(j){return!!ariaPropsMap.get(j)},keys:function $(){return properties.map(function(j){var it=_slicedToArray$4(j,1),et=it[0];return et})},values:function $(){return properties.map(function(j){var it=_slicedToArray$4(j,2),et=it[1];return et})}},_default$2g=(0,_iterationDecorator$4.default)(ariaPropsMap,ariaPropsMap.entries());ariaPropsMap$1.default=_default$2g;var domMap$1={};Object.defineProperty(domMap$1,"__esModule",{value:!0});domMap$1.default=void 0;var _iterationDecorator$3=_interopRequireDefault$8(iterationDecorator$1);function _interopRequireDefault$8($){return $&&$.__esModule?$:{default:$}}function _slicedToArray$3($,j){return _arrayWithHoles$3($)||_iterableToArrayLimit$3($,j)||_unsupportedIterableToArray$3($,j)||_nonIterableRest$3()}function _nonIterableRest$3(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArrayLimit$3($,j){var it=$==null?null:typeof Symbol<"u"&&$[Symbol.iterator]||$["@@iterator"];if(it!=null){var et=[],ut=!0,dt=!1,mt,yt;try{for(it=it.call($);!(ut=(mt=it.next()).done)&&(et.push(mt.value),!(j&&et.length===j));ut=!0);}catch(bt){dt=!0,yt=bt}finally{try{!ut&&it.return!=null&&it.return()}finally{if(dt)throw yt}}return et}}function _arrayWithHoles$3($){if(Array.isArray($))return $}function _createForOfIteratorHelper$3($,j){var it=typeof Symbol<"u"&&$[Symbol.iterator]||$["@@iterator"];if(!it){if(Array.isArray($)||(it=_unsupportedIterableToArray$3($))||j&&$&&typeof $.length=="number"){it&&($=it);var et=0,ut=function(){};return{s:ut,n:function(){return et>=$.length?{done:!0}:{done:!1,value:$[et++]}},e:function(Rt){throw Rt},f:ut}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var dt=!0,mt=!1,yt;return{s:function(){it=it.call($)},n:function(){var Rt=it.next();return dt=Rt.done,Rt},e:function(Rt){mt=!0,yt=Rt},f:function(){try{!dt&&it.return!=null&&it.return()}finally{if(mt)throw yt}}}}function _unsupportedIterableToArray$3($,j){if($){if(typeof $=="string")return _arrayLikeToArray$3($,j);var it=Object.prototype.toString.call($).slice(8,-1);if(it==="Object"&&$.constructor&&(it=$.constructor.name),it==="Map"||it==="Set")return Array.from($);if(it==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(it))return _arrayLikeToArray$3($,j)}}function _arrayLikeToArray$3($,j){(j==null||j>$.length)&&(j=$.length);for(var it=0,et=new Array(j);it<j;it++)et[it]=$[it];return et}var dom$1=[["a",{reserved:!1}],["abbr",{reserved:!1}],["acronym",{reserved:!1}],["address",{reserved:!1}],["applet",{reserved:!1}],["area",{reserved:!1}],["article",{reserved:!1}],["aside",{reserved:!1}],["audio",{reserved:!1}],["b",{reserved:!1}],["base",{reserved:!0}],["bdi",{reserved:!1}],["bdo",{reserved:!1}],["big",{reserved:!1}],["blink",{reserved:!1}],["blockquote",{reserved:!1}],["body",{reserved:!1}],["br",{reserved:!1}],["button",{reserved:!1}],["canvas",{reserved:!1}],["caption",{reserved:!1}],["center",{reserved:!1}],["cite",{reserved:!1}],["code",{reserved:!1}],["col",{reserved:!0}],["colgroup",{reserved:!0}],["content",{reserved:!1}],["data",{reserved:!1}],["datalist",{reserved:!1}],["dd",{reserved:!1}],["del",{reserved:!1}],["details",{reserved:!1}],["dfn",{reserved:!1}],["dialog",{reserved:!1}],["dir",{reserved:!1}],["div",{reserved:!1}],["dl",{reserved:!1}],["dt",{reserved:!1}],["em",{reserved:!1}],["embed",{reserved:!1}],["fieldset",{reserved:!1}],["figcaption",{reserved:!1}],["figure",{reserved:!1}],["font",{reserved:!1}],["footer",{reserved:!1}],["form",{reserved:!1}],["frame",{reserved:!1}],["frameset",{reserved:!1}],["h1",{reserved:!1}],["h2",{reserved:!1}],["h3",{reserved:!1}],["h4",{reserved:!1}],["h5",{reserved:!1}],["h6",{reserved:!1}],["head",{reserved:!0}],["header",{reserved:!1}],["hgroup",{reserved:!1}],["hr",{reserved:!1}],["html",{reserved:!0}],["i",{reserved:!1}],["iframe",{reserved:!1}],["img",{reserved:!1}],["input",{reserved:!1}],["ins",{reserved:!1}],["kbd",{reserved:!1}],["keygen",{reserved:!1}],["label",{reserved:!1}],["legend",{reserved:!1}],["li",{reserved:!1}],["link",{reserved:!0}],["main",{reserved:!1}],["map",{reserved:!1}],["mark",{reserved:!1}],["marquee",{reserved:!1}],["menu",{reserved:!1}],["menuitem",{reserved:!1}],["meta",{reserved:!0}],["meter",{reserved:!1}],["nav",{reserved:!1}],["noembed",{reserved:!0}],["noscript",{reserved:!0}],["object",{reserved:!1}],["ol",{reserved:!1}],["optgroup",{reserved:!1}],["option",{reserved:!1}],["output",{reserved:!1}],["p",{reserved:!1}],["param",{reserved:!0}],["picture",{reserved:!0}],["pre",{reserved:!1}],["progress",{reserved:!1}],["q",{reserved:!1}],["rp",{reserved:!1}],["rt",{reserved:!1}],["rtc",{reserved:!1}],["ruby",{reserved:!1}],["s",{reserved:!1}],["samp",{reserved:!1}],["script",{reserved:!0}],["section",{reserved:!1}],["select",{reserved:!1}],["small",{reserved:!1}],["source",{reserved:!0}],["spacer",{reserved:!1}],["span",{reserved:!1}],["strike",{reserved:!1}],["strong",{reserved:!1}],["style",{reserved:!0}],["sub",{reserved:!1}],["summary",{reserved:!1}],["sup",{reserved:!1}],["table",{reserved:!1}],["tbody",{reserved:!1}],["td",{reserved:!1}],["textarea",{reserved:!1}],["tfoot",{reserved:!1}],["th",{reserved:!1}],["thead",{reserved:!1}],["time",{reserved:!1}],["title",{reserved:!0}],["tr",{reserved:!1}],["track",{reserved:!0}],["tt",{reserved:!1}],["u",{reserved:!1}],["ul",{reserved:!1}],["var",{reserved:!1}],["video",{reserved:!1}],["wbr",{reserved:!1}],["xmp",{reserved:!1}]],domMap={entries:function $(){return dom$1},forEach:function $(j){var it=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,et=_createForOfIteratorHelper$3(dom$1),ut;try{for(et.s();!(ut=et.n()).done;){var dt=_slicedToArray$3(ut.value,2),mt=dt[0],yt=dt[1];j.call(it,yt,mt,dom$1)}}catch(bt){et.e(bt)}finally{et.f()}},get:function $(j){var it=dom$1.find(function(et){return et[0]===j});return it&&it[1]},has:function $(j){return!!domMap.get(j)},keys:function $(){return dom$1.map(function(j){var it=_slicedToArray$3(j,1),et=it[0];return et})},values:function $(){return dom$1.map(function(j){var it=_slicedToArray$3(j,2),et=it[1];return et})}},_default$2f=(0,_iterationDecorator$3.default)(domMap,domMap.entries());domMap$1.default=_default$2f;var rolesMap$1={},ariaAbstractRoles$1={},commandRole$1={};Object.defineProperty(commandRole$1,"__esModule",{value:!0});commandRole$1.default=void 0;var commandRole={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},_default$2e=commandRole;commandRole$1.default=_default$2e;var compositeRole$1={};Object.defineProperty(compositeRole$1,"__esModule",{value:!0});compositeRole$1.default=void 0;var compositeRole={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},_default$2d=compositeRole;compositeRole$1.default=_default$2d;var inputRole$1={};Object.defineProperty(inputRole$1,"__esModule",{value:!0});inputRole$1.default=void 0;var inputRole={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null},relatedConcepts:[{concept:{name:"input"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},_default$2c=inputRole;inputRole$1.default=_default$2c;var landmarkRole$1={};Object.defineProperty(landmarkRole$1,"__esModule",{value:!0});landmarkRole$1.default=void 0;var landmarkRole={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$2b=landmarkRole;landmarkRole$1.default=_default$2b;var rangeRole$1={};Object.defineProperty(rangeRole$1,"__esModule",{value:!0});rangeRole$1.default=void 0;var rangeRole={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},_default$2a=rangeRole;rangeRole$1.default=_default$2a;var roletypeRole$1={};Object.defineProperty(roletypeRole$1,"__esModule",{value:!0});roletypeRole$1.default=void 0;var roletypeRole={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{"aria-atomic":null,"aria-busy":null,"aria-controls":null,"aria-current":null,"aria-describedby":null,"aria-details":null,"aria-dropeffect":null,"aria-flowto":null,"aria-grabbed":null,"aria-hidden":null,"aria-keyshortcuts":null,"aria-label":null,"aria-labelledby":null,"aria-live":null,"aria-owns":null,"aria-relevant":null,"aria-roledescription":null},relatedConcepts:[{concept:{name:"rel"},module:"HTML"},{concept:{name:"role"},module:"XHTML"},{concept:{name:"type"},module:"Dublin Core"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]},_default$29=roletypeRole;roletypeRole$1.default=_default$29;var sectionRole$1={};Object.defineProperty(sectionRole$1,"__esModule",{value:!0});sectionRole$1.default=void 0;var sectionRole={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"frontmatter"},module:"DTB"},{concept:{name:"level"},module:"DTB"},{concept:{name:"level"},module:"SMIL"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},_default$28=sectionRole;sectionRole$1.default=_default$28;var sectionheadRole$1={};Object.defineProperty(sectionheadRole$1,"__esModule",{value:!0});sectionheadRole$1.default=void 0;var sectionheadRole={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},_default$27=sectionheadRole;sectionheadRole$1.default=_default$27;var selectRole$1={};Object.defineProperty(selectRole$1,"__esModule",{value:!0});selectRole$1.default=void 0;var selectRole={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","structure","section","group"]]},_default$26=selectRole;selectRole$1.default=_default$26;var structureRole$1={};Object.defineProperty(structureRole$1,"__esModule",{value:!0});structureRole$1.default=void 0;var structureRole={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},_default$25=structureRole;structureRole$1.default=_default$25;var widgetRole$1={};Object.defineProperty(widgetRole$1,"__esModule",{value:!0});widgetRole$1.default=void 0;var widgetRole={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},_default$24=widgetRole;widgetRole$1.default=_default$24;var windowRole$1={};Object.defineProperty(windowRole$1,"__esModule",{value:!0});windowRole$1.default=void 0;var windowRole={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-modal":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},_default$23=windowRole;windowRole$1.default=_default$23;Object.defineProperty(ariaAbstractRoles$1,"__esModule",{value:!0});ariaAbstractRoles$1.default=void 0;var _commandRole=_interopRequireDefault$7(commandRole$1),_compositeRole=_interopRequireDefault$7(compositeRole$1),_inputRole=_interopRequireDefault$7(inputRole$1),_landmarkRole=_interopRequireDefault$7(landmarkRole$1),_rangeRole=_interopRequireDefault$7(rangeRole$1),_roletypeRole=_interopRequireDefault$7(roletypeRole$1),_sectionRole=_interopRequireDefault$7(sectionRole$1),_sectionheadRole=_interopRequireDefault$7(sectionheadRole$1),_selectRole=_interopRequireDefault$7(selectRole$1),_structureRole=_interopRequireDefault$7(structureRole$1),_widgetRole=_interopRequireDefault$7(widgetRole$1),_windowRole=_interopRequireDefault$7(windowRole$1);function _interopRequireDefault$7($){return $&&$.__esModule?$:{default:$}}var ariaAbstractRoles=[["command",_commandRole.default],["composite",_compositeRole.default],["input",_inputRole.default],["landmark",_landmarkRole.default],["range",_rangeRole.default],["roletype",_roletypeRole.default],["section",_sectionRole.default],["sectionhead",_sectionheadRole.default],["select",_selectRole.default],["structure",_structureRole.default],["widget",_widgetRole.default],["window",_windowRole.default]],_default$22=ariaAbstractRoles;ariaAbstractRoles$1.default=_default$22;var ariaLiteralRoles$1={},alertRole$1={};Object.defineProperty(alertRole$1,"__esModule",{value:!0});alertRole$1.default=void 0;var alertRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-atomic":"true","aria-live":"assertive"},relatedConcepts:[{concept:{name:"alert"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$21=alertRole;alertRole$1.default=_default$21;var alertdialogRole$1={};Object.defineProperty(alertdialogRole$1,"__esModule",{value:!0});alertdialogRole$1.default=void 0;var alertdialogRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"alert"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","alert"],["roletype","window","dialog"]]},_default$20=alertdialogRole;alertdialogRole$1.default=_default$20;var applicationRole$1={};Object.defineProperty(applicationRole$1,"__esModule",{value:!0});applicationRole$1.default=void 0;var applicationRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"Device Independence Delivery Unit"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},_default$1$=applicationRole;applicationRole$1.default=_default$1$;var articleRole$1={};Object.defineProperty(articleRole$1,"__esModule",{value:!0});articleRole$1.default=void 0;var articleRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"article"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","document"]]},_default$1_=articleRole;articleRole$1.default=_default$1_;var bannerRole$1={};Object.defineProperty(bannerRole$1,"__esModule",{value:!0});bannerRole$1.default=void 0;var bannerRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:["direct descendant of document"],name:"header"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$1Z=bannerRole;bannerRole$1.default=_default$1Z;var blockquoteRole$1={};Object.defineProperty(blockquoteRole$1,"__esModule",{value:!0});blockquoteRole$1.default=void 0;var blockquoteRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1Y=blockquoteRole;blockquoteRole$1.default=_default$1Y;var buttonRole$1={};Object.defineProperty(buttonRole$1,"__esModule",{value:!0});buttonRole$1.default=void 0;var buttonRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-pressed":null},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-pressed"},{name:"type",value:"checkbox"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"aria-expanded",value:"false"}],name:"summary"},module:"HTML"},{concept:{attributes:[{name:"aria-expanded",value:"true"}],constraints:["direct descendant of details element with the open attribute defined"],name:"summary"},module:"HTML"},{concept:{attributes:[{name:"type",value:"button"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"image"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"reset"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"submit"}],name:"input"},module:"HTML"},{concept:{name:"button"},module:"HTML"},{concept:{name:"trigger"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},_default$1X=buttonRole;buttonRole$1.default=_default$1X;var captionRole$1={};Object.defineProperty(captionRole$1,"__esModule",{value:!0});captionRole$1.default=void 0;var captionRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:["figure","grid","table"],requiredContextRole:["figure","grid","table"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1W=captionRole;captionRole$1.default=_default$1W;var cellRole$1={};Object.defineProperty(cellRole$1,"__esModule",{value:!0});cellRole$1.default=void 0;var cellRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-colindex":null,"aria-colspan":null,"aria-rowindex":null,"aria-rowspan":null},relatedConcepts:[{concept:{constraints:["descendant of table"],name:"td"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1V=cellRole;cellRole$1.default=_default$1V;var checkboxRole$1={};Object.defineProperty(checkboxRole$1,"__esModule",{value:!0});checkboxRole$1.default=void 0;var checkboxRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-errormessage":null,"aria-expanded":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"checkbox"}],name:"input"},module:"HTML"},{concept:{name:"option"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input"]]},_default$1U=checkboxRole;checkboxRole$1.default=_default$1U;var codeRole$1={};Object.defineProperty(codeRole$1,"__esModule",{value:!0});codeRole$1.default=void 0;var codeRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1T=codeRole;codeRole$1.default=_default$1T;var columnheaderRole$1={};Object.defineProperty(columnheaderRole$1,"__esModule",{value:!0});columnheaderRole$1.default=void 0;var columnheaderRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-sort":null},relatedConcepts:[{attributes:[{name:"scope",value:"col"}],concept:{name:"th"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","structure","section","cell","gridcell"],["roletype","widget","gridcell"],["roletype","structure","sectionhead"]]},_default$1S=columnheaderRole;columnheaderRole$1.default=_default$1S;var comboboxRole$1={};Object.defineProperty(comboboxRole$1,"__esModule",{value:!0});comboboxRole$1.default=void 0;var comboboxRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-autocomplete":null,"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-expanded":"false","aria-haspopup":"listbox"},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"email"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"search"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"tel"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"text"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"multiple"},{constraints:["undefined"],name:"size"}],name:"select"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"multiple"},{name:"size",value:1}],name:"select"},module:"HTML"},{concept:{name:"select"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-controls":null,"aria-expanded":"false"},superClass:[["roletype","widget","input"]]},_default$1R=comboboxRole;comboboxRole$1.default=_default$1R;var complementaryRole$1={};Object.defineProperty(complementaryRole$1,"__esModule",{value:!0});complementaryRole$1.default=void 0;var complementaryRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"aside"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$1Q=complementaryRole;complementaryRole$1.default=_default$1Q;var contentinfoRole$1={};Object.defineProperty(contentinfoRole$1,"__esModule",{value:!0});contentinfoRole$1.default=void 0;var contentinfoRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:["direct descendant of document"],name:"footer"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$1P=contentinfoRole;contentinfoRole$1.default=_default$1P;var definitionRole$1={};Object.defineProperty(definitionRole$1,"__esModule",{value:!0});definitionRole$1.default=void 0;var definitionRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dd"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1O=definitionRole;definitionRole$1.default=_default$1O;var deletionRole$1={};Object.defineProperty(deletionRole$1,"__esModule",{value:!0});deletionRole$1.default=void 0;var deletionRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1N=deletionRole;deletionRole$1.default=_default$1N;var dialogRole$1={};Object.defineProperty(dialogRole$1,"__esModule",{value:!0});dialogRole$1.default=void 0;var dialogRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dialog"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","window"]]},_default$1M=dialogRole;dialogRole$1.default=_default$1M;var directoryRole$1={};Object.defineProperty(directoryRole$1,"__esModule",{value:!0});directoryRole$1.default=void 0;var directoryRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{module:"DAISY Guide"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","list"]]},_default$1L=directoryRole;directoryRole$1.default=_default$1L;var documentRole$1={};Object.defineProperty(documentRole$1,"__esModule",{value:!0});documentRole$1.default=void 0;var documentRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"Device Independence Delivery Unit"}},{concept:{name:"body"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},_default$1K=documentRole;documentRole$1.default=_default$1K;var emphasisRole$1={};Object.defineProperty(emphasisRole$1,"__esModule",{value:!0});emphasisRole$1.default=void 0;var emphasisRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1J=emphasisRole;emphasisRole$1.default=_default$1J;var feedRole$1={};Object.defineProperty(feedRole$1,"__esModule",{value:!0});feedRole$1.default=void 0;var feedRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["article"]],requiredProps:{},superClass:[["roletype","structure","section","list"]]},_default$1I=feedRole;feedRole$1.default=_default$1I;var figureRole$1={};Object.defineProperty(figureRole$1,"__esModule",{value:!0});figureRole$1.default=void 0;var figureRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"figure"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1H=figureRole;figureRole$1.default=_default$1H;var formRole$1={};Object.defineProperty(formRole$1,"__esModule",{value:!0});formRole$1.default=void 0;var formRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-label"}],name:"form"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],name:"form"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"name"}],name:"form"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$1G=formRole;formRole$1.default=_default$1G;var genericRole$1={};Object.defineProperty(genericRole$1,"__esModule",{value:!0});genericRole$1.default=void 0;var genericRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"span"},module:"HTML"},{concept:{name:"div"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},_default$1F=genericRole;genericRole$1.default=_default$1F;var gridRole$1={};Object.defineProperty(gridRole$1,"__esModule",{value:!0});gridRole$1.default=void 0;var gridRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-multiselectable":null,"aria-readonly":null},relatedConcepts:[{concept:{attributes:[{name:"role",value:"grid"}],name:"table"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","structure","section","table"]]},_default$1E=gridRole;gridRole$1.default=_default$1E;var gridcellRole$1={};Object.defineProperty(gridcellRole$1,"__esModule",{value:!0});gridcellRole$1.default=void 0;var gridcellRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-selected":null},relatedConcepts:[{concept:{attributes:[{name:"role",value:"gridcell"}],name:"td"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","widget"]]},_default$1D=gridcellRole;gridcellRole$1.default=_default$1D;var groupRole$1={};Object.defineProperty(groupRole$1,"__esModule",{value:!0});groupRole$1.default=void 0;var groupRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null},relatedConcepts:[{concept:{name:"details"},module:"HTML"},{concept:{name:"fieldset"},module:"HTML"},{concept:{name:"optgroup"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1C=groupRole;groupRole$1.default=_default$1C;var headingRole$1={};Object.defineProperty(headingRole$1,"__esModule",{value:!0});headingRole$1.default=void 0;var headingRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-level":"2"},relatedConcepts:[{concept:{name:"h1"},module:"HTML"},{concept:{name:"h2"},module:"HTML"},{concept:{name:"h3"},module:"HTML"},{concept:{name:"h4"},module:"HTML"},{concept:{name:"h5"},module:"HTML"},{concept:{name:"h6"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-level":"2"},superClass:[["roletype","structure","sectionhead"]]},_default$1B=headingRole;headingRole$1.default=_default$1B;var imgRole$1={};Object.defineProperty(imgRole$1,"__esModule",{value:!0});imgRole$1.default=void 0;var imgRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"alt"}],name:"img"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"alt"}],name:"img"},module:"HTML"},{concept:{name:"imggroup"},module:"DTB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1A=imgRole;imgRole$1.default=_default$1A;var insertionRole$1={};Object.defineProperty(insertionRole$1,"__esModule",{value:!0});insertionRole$1.default=void 0;var insertionRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1z=insertionRole;insertionRole$1.default=_default$1z;var linkRole$1={};Object.defineProperty(linkRole$1,"__esModule",{value:!0});linkRole$1.default=void 0;var linkRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null},relatedConcepts:[{concept:{attributes:[{name:"href"}],name:"a"},module:"HTML"},{concept:{attributes:[{name:"href"}],name:"area"},module:"HTML"},{concept:{attributes:[{name:"href"}],name:"link"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},_default$1y=linkRole;linkRole$1.default=_default$1y;var listRole$1={};Object.defineProperty(listRole$1,"__esModule",{value:!0});listRole$1.default=void 0;var listRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menu"},module:"HTML"},{concept:{name:"ol"},module:"HTML"},{concept:{name:"ul"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["listitem"]],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1x=listRole;listRole$1.default=_default$1x;var listboxRole$1={};Object.defineProperty(listboxRole$1,"__esModule",{value:!0});listboxRole$1.default=void 0;var listboxRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-invalid":null,"aria-multiselectable":null,"aria-readonly":null,"aria-required":null,"aria-orientation":"vertical"},relatedConcepts:[{concept:{attributes:[{constraints:[">1"],name:"size"},{name:"multiple"}],name:"select"},module:"HTML"},{concept:{attributes:[{constraints:[">1"],name:"size"}],name:"select"},module:"HTML"},{concept:{attributes:[{name:"multiple"}],name:"select"},module:"HTML"},{concept:{name:"datalist"},module:"HTML"},{concept:{name:"list"},module:"ARIA"},{concept:{name:"select"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["option","group"],["option"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},_default$1w=listboxRole;listboxRole$1.default=_default$1w;var listitemRole$1={};Object.defineProperty(listitemRole$1,"__esModule",{value:!0});listitemRole$1.default=void 0;var listitemRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-level":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{constraints:["direct descendant of ol, ul or menu"],name:"li"},module:"HTML"},{concept:{name:"item"},module:"XForms"}],requireContextRole:["directory","list"],requiredContextRole:["directory","list"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1v=listitemRole;listitemRole$1.default=_default$1v;var logRole$1={};Object.defineProperty(logRole$1,"__esModule",{value:!0});logRole$1.default=void 0;var logRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-live":"polite"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1u=logRole;logRole$1.default=_default$1u;var mainRole$1={};Object.defineProperty(mainRole$1,"__esModule",{value:!0});mainRole$1.default=void 0;var mainRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"main"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$1t=mainRole;mainRole$1.default=_default$1t;var marqueeRole$1={};Object.defineProperty(marqueeRole$1,"__esModule",{value:!0});marqueeRole$1.default=void 0;var marqueeRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1s=marqueeRole;marqueeRole$1.default=_default$1s;var mathRole$1={};Object.defineProperty(mathRole$1,"__esModule",{value:!0});mathRole$1.default=void 0;var mathRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"math"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1r=mathRole;mathRole$1.default=_default$1r;var menuRole$1={};Object.defineProperty(menuRole$1,"__esModule",{value:!0});menuRole$1.default=void 0;var menuRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"vertical"},relatedConcepts:[{concept:{name:"MENU"},module:"JAPI"},{concept:{name:"list"},module:"ARIA"},{concept:{name:"select"},module:"XForms"},{concept:{name:"sidebar"},module:"DTB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["menuitem","group"],["menuitemradio","group"],["menuitemcheckbox","group"],["menuitem"],["menuitemcheckbox"],["menuitemradio"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},_default$1q=menuRole;menuRole$1.default=_default$1q;var menubarRole$1={};Object.defineProperty(menubarRole$1,"__esModule",{value:!0});menubarRole$1.default=void 0;var menubarRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"horizontal"},relatedConcepts:[{concept:{name:"toolbar"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["menuitem","group"],["menuitemradio","group"],["menuitemcheckbox","group"],["menuitem"],["menuitemcheckbox"],["menuitemradio"]],requiredProps:{},superClass:[["roletype","widget","composite","select","menu"],["roletype","structure","section","group","select","menu"]]},_default$1p=menubarRole;menubarRole$1.default=_default$1p;var menuitemRole$1={};Object.defineProperty(menuitemRole$1,"__esModule",{value:!0});menuitemRole$1.default=void 0;var menuitemRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"MENU_ITEM"},module:"JAPI"},{concept:{name:"listitem"},module:"ARIA"},{concept:{name:"menuitem"},module:"HTML"},{concept:{name:"option"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},_default$1o=menuitemRole;menuitemRole$1.default=_default$1o;var menuitemcheckboxRole$1={};Object.defineProperty(menuitemcheckboxRole$1,"__esModule",{value:!0});menuitemcheckboxRole$1.default=void 0;var menuitemcheckboxRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox"],["roletype","widget","command","menuitem"]]},_default$1n=menuitemcheckboxRole;menuitemcheckboxRole$1.default=_default$1n;var menuitemradioRole$1={};Object.defineProperty(menuitemradioRole$1,"__esModule",{value:!0});menuitemradioRole$1.default=void 0;var menuitemradioRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox","menuitemcheckbox"],["roletype","widget","command","menuitem","menuitemcheckbox"],["roletype","widget","input","radio"]]},_default$1m=menuitemradioRole;menuitemradioRole$1.default=_default$1m;var meterRole$1={};Object.defineProperty(meterRole$1,"__esModule",{value:!0});meterRole$1.default=void 0;var meterRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuetext":null,"aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-valuenow":null},superClass:[["roletype","structure","range"]]},_default$1l=meterRole;meterRole$1.default=_default$1l;var navigationRole$1={};Object.defineProperty(navigationRole$1,"__esModule",{value:!0});navigationRole$1.default=void 0;var navigationRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"nav"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$1k=navigationRole;navigationRole$1.default=_default$1k;var noneRole$1={};Object.defineProperty(noneRole$1,"__esModule",{value:!0});noneRole$1.default=void 0;var noneRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]},_default$1j=noneRole;noneRole$1.default=_default$1j;var noteRole$1={};Object.defineProperty(noteRole$1,"__esModule",{value:!0});noteRole$1.default=void 0;var noteRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1i=noteRole;noteRole$1.default=_default$1i;var optionRole$1={};Object.defineProperty(optionRole$1,"__esModule",{value:!0});optionRole$1.default=void 0;var optionRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-posinset":null,"aria-setsize":null,"aria-selected":"false"},relatedConcepts:[{concept:{name:"item"},module:"XForms"},{concept:{name:"listitem"},module:"ARIA"},{concept:{name:"option"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-selected":"false"},superClass:[["roletype","widget","input"]]},_default$1h=optionRole;optionRole$1.default=_default$1h;var paragraphRole$1={};Object.defineProperty(paragraphRole$1,"__esModule",{value:!0});paragraphRole$1.default=void 0;var paragraphRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$1g=paragraphRole;paragraphRole$1.default=_default$1g;var presentationRole$1={};Object.defineProperty(presentationRole$1,"__esModule",{value:!0});presentationRole$1.default=void 0;var presentationRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},_default$1f=presentationRole;presentationRole$1.default=_default$1f;var progressbarRole$1={};Object.defineProperty(progressbarRole$1,"__esModule",{value:!0});progressbarRole$1.default=void 0;var progressbarRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuetext":null},relatedConcepts:[{concept:{name:"progress"},module:"HTML"},{concept:{name:"status"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","range"],["roletype","widget"]]},_default$1e=progressbarRole;progressbarRole$1.default=_default$1e;var radioRole$1={};Object.defineProperty(radioRole$1,"__esModule",{value:!0});radioRole$1.default=void 0;var radioRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"radio"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input"]]},_default$1d=radioRole;radioRole$1.default=_default$1d;var radiogroupRole$1={};Object.defineProperty(radiogroupRole$1,"__esModule",{value:!0});radiogroupRole$1.default=void 0;var radiogroupRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{name:"list"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["radio"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},_default$1c=radiogroupRole;radiogroupRole$1.default=_default$1c;var regionRole$1={};Object.defineProperty(regionRole$1,"__esModule",{value:!0});regionRole$1.default=void 0;var regionRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-label"}],name:"section"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],name:"section"},module:"HTML"},{concept:{name:"Device Independence Glossart perceivable unit"}},{concept:{name:"frame"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$1b=regionRole;regionRole$1.default=_default$1b;var rowRole$1={};Object.defineProperty(rowRole$1,"__esModule",{value:!0});rowRole$1.default=void 0;var rowRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-colindex":null,"aria-expanded":null,"aria-level":null,"aria-posinset":null,"aria-rowindex":null,"aria-selected":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"tr"},module:"HTML"}],requireContextRole:["grid","rowgroup","table","treegrid"],requiredContextRole:["grid","rowgroup","table","treegrid"],requiredOwnedElements:[["cell"],["columnheader"],["gridcell"],["rowheader"]],requiredProps:{},superClass:[["roletype","structure","section","group"],["roletype","widget"]]},_default$1a=rowRole;rowRole$1.default=_default$1a;var rowgroupRole$1={};Object.defineProperty(rowgroupRole$1,"__esModule",{value:!0});rowgroupRole$1.default=void 0;var rowgroupRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"tbody"},module:"HTML"},{concept:{name:"tfoot"},module:"HTML"},{concept:{name:"thead"},module:"HTML"}],requireContextRole:["grid","table","treegrid"],requiredContextRole:["grid","table","treegrid"],requiredOwnedElements:[["row"]],requiredProps:{},superClass:[["roletype","structure"]]},_default$19=rowgroupRole;rowgroupRole$1.default=_default$19;var rowheaderRole$1={};Object.defineProperty(rowheaderRole$1,"__esModule",{value:!0});rowheaderRole$1.default=void 0;var rowheaderRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-sort":null},relatedConcepts:[{concept:{attributes:[{name:"scope",value:"row"}],name:"th"},module:"HTML"},{concept:{attributes:[{name:"scope",value:"rowgroup"}],name:"th"},module:"HTML"}],requireContextRole:["row","rowgroup"],requiredContextRole:["row","rowgroup"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","structure","section","cell","gridcell"],["roletype","widget","gridcell"],["roletype","structure","sectionhead"]]},_default$18=rowheaderRole;rowheaderRole$1.default=_default$18;var scrollbarRole$1={};Object.defineProperty(scrollbarRole$1,"__esModule",{value:!0});scrollbarRole$1.default=void 0;var scrollbarRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-valuetext":null,"aria-orientation":"vertical","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-controls":null,"aria-valuenow":null},superClass:[["roletype","structure","range"],["roletype","widget"]]},_default$17=scrollbarRole;scrollbarRole$1.default=_default$17;var searchRole$1={};Object.defineProperty(searchRole$1,"__esModule",{value:!0});searchRole$1.default=void 0;var searchRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$16=searchRole;searchRole$1.default=_default$16;var searchboxRole$1={};Object.defineProperty(searchboxRole$1,"__esModule",{value:!0});searchboxRole$1.default=void 0;var searchboxRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"search"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","input","textbox"]]},_default$15=searchboxRole;searchboxRole$1.default=_default$15;var separatorRole$1={};Object.defineProperty(separatorRole$1,"__esModule",{value:!0});separatorRole$1.default=void 0;var separatorRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0","aria-valuenow":null,"aria-valuetext":null},relatedConcepts:[{concept:{name:"hr"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},_default$14=separatorRole;separatorRole$1.default=_default$14;var sliderRole$1={};Object.defineProperty(sliderRole$1,"__esModule",{value:!0});sliderRole$1.default=void 0;var sliderRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null,"aria-readonly":null,"aria-valuetext":null,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[{concept:{attributes:[{name:"type",value:"range"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-valuenow":null},superClass:[["roletype","widget","input"],["roletype","structure","range"]]},_default$13=sliderRole;sliderRole$1.default=_default$13;var spinbuttonRole$1={};Object.defineProperty(spinbuttonRole$1,"__esModule",{value:!0});spinbuttonRole$1.default=void 0;var spinbuttonRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-valuetext":null,"aria-valuenow":"0"},relatedConcepts:[{concept:{attributes:[{name:"type",value:"number"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","widget","input"],["roletype","structure","range"]]},_default$12=spinbuttonRole;spinbuttonRole$1.default=_default$12;var statusRole$1={};Object.defineProperty(statusRole$1,"__esModule",{value:!0});statusRole$1.default=void 0;var statusRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-atomic":"true","aria-live":"polite"},relatedConcepts:[{concept:{name:"output"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$11=statusRole;statusRole$1.default=_default$11;var strongRole$1={};Object.defineProperty(strongRole$1,"__esModule",{value:!0});strongRole$1.default=void 0;var strongRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$10=strongRole;strongRole$1.default=_default$10;var subscriptRole$1={};Object.defineProperty(subscriptRole$1,"__esModule",{value:!0});subscriptRole$1.default=void 0;var subscriptRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$$=subscriptRole;subscriptRole$1.default=_default$$;var superscriptRole$1={};Object.defineProperty(superscriptRole$1,"__esModule",{value:!0});superscriptRole$1.default=void 0;var superscriptRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$_=superscriptRole;superscriptRole$1.default=_default$_;var switchRole$1={};Object.defineProperty(switchRole$1,"__esModule",{value:!0});switchRole$1.default=void 0;var switchRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"button"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox"]]},_default$Z=switchRole;switchRole$1.default=_default$Z;var tabRole$1={};Object.defineProperty(tabRole$1,"__esModule",{value:!0});tabRole$1.default=void 0;var tabRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-posinset":null,"aria-setsize":null,"aria-selected":"false"},relatedConcepts:[],requireContextRole:["tablist"],requiredContextRole:["tablist"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","sectionhead"],["roletype","widget"]]},_default$Y=tabRole;tabRole$1.default=_default$Y;var tableRole$1={};Object.defineProperty(tableRole$1,"__esModule",{value:!0});tableRole$1.default=void 0;var tableRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-colcount":null,"aria-rowcount":null},relatedConcepts:[{concept:{name:"table"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$X=tableRole;tableRole$1.default=_default$X;var tablistRole$1={};Object.defineProperty(tablistRole$1,"__esModule",{value:!0});tablistRole$1.default=void 0;var tablistRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-level":null,"aria-multiselectable":null,"aria-orientation":"horizontal"},relatedConcepts:[{module:"DAISY",concept:{name:"guide"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["tab"]],requiredProps:{},superClass:[["roletype","widget","composite"]]},_default$W=tablistRole;tablistRole$1.default=_default$W;var tabpanelRole$1={};Object.defineProperty(tabpanelRole$1,"__esModule",{value:!0});tabpanelRole$1.default=void 0;var tabpanelRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$V=tabpanelRole;tabpanelRole$1.default=_default$V;var termRole$1={};Object.defineProperty(termRole$1,"__esModule",{value:!0});termRole$1.default=void 0;var termRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dfn"},module:"HTML"},{concept:{name:"dt"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$U=termRole;termRole$1.default=_default$U;var textboxRole$1={};Object.defineProperty(textboxRole$1,"__esModule",{value:!0});textboxRole$1.default=void 0;var textboxRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-autocomplete":null,"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null,"aria-multiline":null,"aria-placeholder":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{attributes:[{constraints:["undefined"],name:"type"},{constraints:["undefined"],name:"list"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"email"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"tel"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"text"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{name:"input"},module:"XForms"},{concept:{name:"textarea"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","input"]]},_default$T=textboxRole;textboxRole$1.default=_default$T;var timeRole$1={};Object.defineProperty(timeRole$1,"__esModule",{value:!0});timeRole$1.default=void 0;var timeRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$S=timeRole;timeRole$1.default=_default$S;var timerRole$1={};Object.defineProperty(timerRole$1,"__esModule",{value:!0});timerRole$1.default=void 0;var timerRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","status"]]},_default$R=timerRole;timerRole$1.default=_default$R;var toolbarRole$1={};Object.defineProperty(toolbarRole$1,"__esModule",{value:!0});toolbarRole$1.default=void 0;var toolbarRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"horizontal"},relatedConcepts:[{concept:{name:"menubar"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","group"]]},_default$Q=toolbarRole;toolbarRole$1.default=_default$Q;var tooltipRole$1={};Object.defineProperty(tooltipRole$1,"__esModule",{value:!0});tooltipRole$1.default=void 0;var tooltipRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$P=tooltipRole;tooltipRole$1.default=_default$P;var treeRole$1={};Object.defineProperty(treeRole$1,"__esModule",{value:!0});treeRole$1.default=void 0;var treeRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-multiselectable":null,"aria-required":null,"aria-orientation":"vertical"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["treeitem","group"],["treeitem"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},_default$O=treeRole;treeRole$1.default=_default$O;var treegridRole$1={};Object.defineProperty(treegridRole$1,"__esModule",{value:!0});treegridRole$1.default=void 0;var treegridRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","widget","composite","grid"],["roletype","structure","section","table","grid"],["roletype","widget","composite","select","tree"],["roletype","structure","section","group","select","tree"]]},_default$N=treegridRole;treegridRole$1.default=_default$N;var treeitemRole$1={};Object.defineProperty(treeitemRole$1,"__esModule",{value:!0});treeitemRole$1.default=void 0;var treeitemRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-expanded":null,"aria-haspopup":null},relatedConcepts:[],requireContextRole:["group","tree"],requiredContextRole:["group","tree"],requiredOwnedElements:[],requiredProps:{"aria-selected":null},superClass:[["roletype","structure","section","listitem"],["roletype","widget","input","option"]]},_default$M=treeitemRole;treeitemRole$1.default=_default$M;Object.defineProperty(ariaLiteralRoles$1,"__esModule",{value:!0});ariaLiteralRoles$1.default=void 0;var _alertRole=_interopRequireDefault$6(alertRole$1),_alertdialogRole=_interopRequireDefault$6(alertdialogRole$1),_applicationRole=_interopRequireDefault$6(applicationRole$1),_articleRole=_interopRequireDefault$6(articleRole$1),_bannerRole=_interopRequireDefault$6(bannerRole$1),_blockquoteRole=_interopRequireDefault$6(blockquoteRole$1),_buttonRole=_interopRequireDefault$6(buttonRole$1),_captionRole=_interopRequireDefault$6(captionRole$1),_cellRole=_interopRequireDefault$6(cellRole$1),_checkboxRole=_interopRequireDefault$6(checkboxRole$1),_codeRole=_interopRequireDefault$6(codeRole$1),_columnheaderRole=_interopRequireDefault$6(columnheaderRole$1),_comboboxRole=_interopRequireDefault$6(comboboxRole$1),_complementaryRole=_interopRequireDefault$6(complementaryRole$1),_contentinfoRole=_interopRequireDefault$6(contentinfoRole$1),_definitionRole=_interopRequireDefault$6(definitionRole$1),_deletionRole=_interopRequireDefault$6(deletionRole$1),_dialogRole=_interopRequireDefault$6(dialogRole$1),_directoryRole=_interopRequireDefault$6(directoryRole$1),_documentRole=_interopRequireDefault$6(documentRole$1),_emphasisRole=_interopRequireDefault$6(emphasisRole$1),_feedRole=_interopRequireDefault$6(feedRole$1),_figureRole=_interopRequireDefault$6(figureRole$1),_formRole=_interopRequireDefault$6(formRole$1),_genericRole=_interopRequireDefault$6(genericRole$1),_gridRole=_interopRequireDefault$6(gridRole$1),_gridcellRole=_interopRequireDefault$6(gridcellRole$1),_groupRole=_interopRequireDefault$6(groupRole$1),_headingRole=_interopRequireDefault$6(headingRole$1),_imgRole=_interopRequireDefault$6(imgRole$1),_insertionRole=_interopRequireDefault$6(insertionRole$1),_linkRole=_interopRequireDefault$6(linkRole$1),_listRole=_interopRequireDefault$6(listRole$1),_listboxRole=_interopRequireDefault$6(listboxRole$1),_listitemRole=_interopRequireDefault$6(listitemRole$1),_logRole=_interopRequireDefault$6(logRole$1),_mainRole=_interopRequireDefault$6(mainRole$1),_marqueeRole=_interopRequireDefault$6(marqueeRole$1),_mathRole=_interopRequireDefault$6(mathRole$1),_menuRole=_interopRequireDefault$6(menuRole$1),_menubarRole=_interopRequireDefault$6(menubarRole$1),_menuitemRole=_interopRequireDefault$6(menuitemRole$1),_menuitemcheckboxRole=_interopRequireDefault$6(menuitemcheckboxRole$1),_menuitemradioRole=_interopRequireDefault$6(menuitemradioRole$1),_meterRole=_interopRequireDefault$6(meterRole$1),_navigationRole=_interopRequireDefault$6(navigationRole$1),_noneRole=_interopRequireDefault$6(noneRole$1),_noteRole=_interopRequireDefault$6(noteRole$1),_optionRole=_interopRequireDefault$6(optionRole$1),_paragraphRole=_interopRequireDefault$6(paragraphRole$1),_presentationRole=_interopRequireDefault$6(presentationRole$1),_progressbarRole=_interopRequireDefault$6(progressbarRole$1),_radioRole=_interopRequireDefault$6(radioRole$1),_radiogroupRole=_interopRequireDefault$6(radiogroupRole$1),_regionRole=_interopRequireDefault$6(regionRole$1),_rowRole=_interopRequireDefault$6(rowRole$1),_rowgroupRole=_interopRequireDefault$6(rowgroupRole$1),_rowheaderRole=_interopRequireDefault$6(rowheaderRole$1),_scrollbarRole=_interopRequireDefault$6(scrollbarRole$1),_searchRole=_interopRequireDefault$6(searchRole$1),_searchboxRole=_interopRequireDefault$6(searchboxRole$1),_separatorRole=_interopRequireDefault$6(separatorRole$1),_sliderRole=_interopRequireDefault$6(sliderRole$1),_spinbuttonRole=_interopRequireDefault$6(spinbuttonRole$1),_statusRole=_interopRequireDefault$6(statusRole$1),_strongRole=_interopRequireDefault$6(strongRole$1),_subscriptRole=_interopRequireDefault$6(subscriptRole$1),_superscriptRole=_interopRequireDefault$6(superscriptRole$1),_switchRole=_interopRequireDefault$6(switchRole$1),_tabRole=_interopRequireDefault$6(tabRole$1),_tableRole=_interopRequireDefault$6(tableRole$1),_tablistRole=_interopRequireDefault$6(tablistRole$1),_tabpanelRole=_interopRequireDefault$6(tabpanelRole$1),_termRole=_interopRequireDefault$6(termRole$1),_textboxRole=_interopRequireDefault$6(textboxRole$1),_timeRole=_interopRequireDefault$6(timeRole$1),_timerRole=_interopRequireDefault$6(timerRole$1),_toolbarRole=_interopRequireDefault$6(toolbarRole$1),_tooltipRole=_interopRequireDefault$6(tooltipRole$1),_treeRole=_interopRequireDefault$6(treeRole$1),_treegridRole=_interopRequireDefault$6(treegridRole$1),_treeitemRole=_interopRequireDefault$6(treeitemRole$1);function _interopRequireDefault$6($){return $&&$.__esModule?$:{default:$}}var ariaLiteralRoles=[["alert",_alertRole.default],["alertdialog",_alertdialogRole.default],["application",_applicationRole.default],["article",_articleRole.default],["banner",_bannerRole.default],["blockquote",_blockquoteRole.default],["button",_buttonRole.default],["caption",_captionRole.default],["cell",_cellRole.default],["checkbox",_checkboxRole.default],["code",_codeRole.default],["columnheader",_columnheaderRole.default],["combobox",_comboboxRole.default],["complementary",_complementaryRole.default],["contentinfo",_contentinfoRole.default],["definition",_definitionRole.default],["deletion",_deletionRole.default],["dialog",_dialogRole.default],["directory",_directoryRole.default],["document",_documentRole.default],["emphasis",_emphasisRole.default],["feed",_feedRole.default],["figure",_figureRole.default],["form",_formRole.default],["generic",_genericRole.default],["grid",_gridRole.default],["gridcell",_gridcellRole.default],["group",_groupRole.default],["heading",_headingRole.default],["img",_imgRole.default],["insertion",_insertionRole.default],["link",_linkRole.default],["list",_listRole.default],["listbox",_listboxRole.default],["listitem",_listitemRole.default],["log",_logRole.default],["main",_mainRole.default],["marquee",_marqueeRole.default],["math",_mathRole.default],["menu",_menuRole.default],["menubar",_menubarRole.default],["menuitem",_menuitemRole.default],["menuitemcheckbox",_menuitemcheckboxRole.default],["menuitemradio",_menuitemradioRole.default],["meter",_meterRole.default],["navigation",_navigationRole.default],["none",_noneRole.default],["note",_noteRole.default],["option",_optionRole.default],["paragraph",_paragraphRole.default],["presentation",_presentationRole.default],["progressbar",_progressbarRole.default],["radio",_radioRole.default],["radiogroup",_radiogroupRole.default],["region",_regionRole.default],["row",_rowRole.default],["rowgroup",_rowgroupRole.default],["rowheader",_rowheaderRole.default],["scrollbar",_scrollbarRole.default],["search",_searchRole.default],["searchbox",_searchboxRole.default],["separator",_separatorRole.default],["slider",_sliderRole.default],["spinbutton",_spinbuttonRole.default],["status",_statusRole.default],["strong",_strongRole.default],["subscript",_subscriptRole.default],["superscript",_superscriptRole.default],["switch",_switchRole.default],["tab",_tabRole.default],["table",_tableRole.default],["tablist",_tablistRole.default],["tabpanel",_tabpanelRole.default],["term",_termRole.default],["textbox",_textboxRole.default],["time",_timeRole.default],["timer",_timerRole.default],["toolbar",_toolbarRole.default],["tooltip",_tooltipRole.default],["tree",_treeRole.default],["treegrid",_treegridRole.default],["treeitem",_treeitemRole.default]],_default$L=ariaLiteralRoles;ariaLiteralRoles$1.default=_default$L;var ariaDpubRoles$1={},docAbstractRole$1={};Object.defineProperty(docAbstractRole$1,"__esModule",{value:!0});docAbstractRole$1.default=void 0;var docAbstractRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"abstract [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$K=docAbstractRole;docAbstractRole$1.default=_default$K;var docAcknowledgmentsRole$1={};Object.defineProperty(docAcknowledgmentsRole$1,"__esModule",{value:!0});docAcknowledgmentsRole$1.default=void 0;var docAcknowledgmentsRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"acknowledgments [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$J=docAcknowledgmentsRole;docAcknowledgmentsRole$1.default=_default$J;var docAfterwordRole$1={};Object.defineProperty(docAfterwordRole$1,"__esModule",{value:!0});docAfterwordRole$1.default=void 0;var docAfterwordRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"afterword [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$I=docAfterwordRole;docAfterwordRole$1.default=_default$I;var docAppendixRole$1={};Object.defineProperty(docAppendixRole$1,"__esModule",{value:!0});docAppendixRole$1.default=void 0;var docAppendixRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"appendix [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$H=docAppendixRole;docAppendixRole$1.default=_default$H;var docBacklinkRole$1={};Object.defineProperty(docBacklinkRole$1,"__esModule",{value:!0});docBacklinkRole$1.default=void 0;var docBacklinkRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","content"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"referrer [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},_default$G=docBacklinkRole;docBacklinkRole$1.default=_default$G;var docBiblioentryRole$1={};Object.defineProperty(docBiblioentryRole$1,"__esModule",{value:!0});docBiblioentryRole$1.default=void 0;var docBiblioentryRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"EPUB biblioentry [EPUB-SSV]"},module:"EPUB"}],requireContextRole:["doc-bibliography"],requiredContextRole:["doc-bibliography"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"]]},_default$F=docBiblioentryRole;docBiblioentryRole$1.default=_default$F;var docBibliographyRole$1={};Object.defineProperty(docBibliographyRole$1,"__esModule",{value:!0});docBibliographyRole$1.default=void 0;var docBibliographyRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"bibliography [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["doc-biblioentry"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$E=docBibliographyRole;docBibliographyRole$1.default=_default$E;var docBibliorefRole$1={};Object.defineProperty(docBibliorefRole$1,"__esModule",{value:!0});docBibliorefRole$1.default=void 0;var docBibliorefRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"biblioref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},_default$D=docBibliorefRole;docBibliorefRole$1.default=_default$D;var docChapterRole$1={};Object.defineProperty(docChapterRole$1,"__esModule",{value:!0});docChapterRole$1.default=void 0;var docChapterRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"chapter [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$C=docChapterRole;docChapterRole$1.default=_default$C;var docColophonRole$1={};Object.defineProperty(docColophonRole$1,"__esModule",{value:!0});docColophonRole$1.default=void 0;var docColophonRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"colophon [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$B=docColophonRole;docColophonRole$1.default=_default$B;var docConclusionRole$1={};Object.defineProperty(docConclusionRole$1,"__esModule",{value:!0});docConclusionRole$1.default=void 0;var docConclusionRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"conclusion [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$A=docConclusionRole;docConclusionRole$1.default=_default$A;var docCoverRole$1={};Object.defineProperty(docCoverRole$1,"__esModule",{value:!0});docCoverRole$1.default=void 0;var docCoverRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"cover [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","img"]]},_default$z=docCoverRole;docCoverRole$1.default=_default$z;var docCreditRole$1={};Object.defineProperty(docCreditRole$1,"__esModule",{value:!0});docCreditRole$1.default=void 0;var docCreditRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"credit [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$y=docCreditRole;docCreditRole$1.default=_default$y;var docCreditsRole$1={};Object.defineProperty(docCreditsRole$1,"__esModule",{value:!0});docCreditsRole$1.default=void 0;var docCreditsRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"credits [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$x=docCreditsRole;docCreditsRole$1.default=_default$x;var docDedicationRole$1={};Object.defineProperty(docDedicationRole$1,"__esModule",{value:!0});docDedicationRole$1.default=void 0;var docDedicationRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"dedication [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$w=docDedicationRole;docDedicationRole$1.default=_default$w;var docEndnoteRole$1={};Object.defineProperty(docEndnoteRole$1,"__esModule",{value:!0});docEndnoteRole$1.default=void 0;var docEndnoteRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"rearnote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:["doc-endnotes"],requiredContextRole:["doc-endnotes"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"]]},_default$v=docEndnoteRole;docEndnoteRole$1.default=_default$v;var docEndnotesRole$1={};Object.defineProperty(docEndnotesRole$1,"__esModule",{value:!0});docEndnotesRole$1.default=void 0;var docEndnotesRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"rearnotes [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["doc-endnote"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$u=docEndnotesRole;docEndnotesRole$1.default=_default$u;var docEpigraphRole$1={};Object.defineProperty(docEpigraphRole$1,"__esModule",{value:!0});docEpigraphRole$1.default=void 0;var docEpigraphRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"epigraph [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$t=docEpigraphRole;docEpigraphRole$1.default=_default$t;var docEpilogueRole$1={};Object.defineProperty(docEpilogueRole$1,"__esModule",{value:!0});docEpilogueRole$1.default=void 0;var docEpilogueRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"epilogue [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$s=docEpilogueRole;docEpilogueRole$1.default=_default$s;var docErrataRole$1={};Object.defineProperty(docErrataRole$1,"__esModule",{value:!0});docErrataRole$1.default=void 0;var docErrataRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"errata [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$r=docErrataRole;docErrataRole$1.default=_default$r;var docExampleRole$1={};Object.defineProperty(docExampleRole$1,"__esModule",{value:!0});docExampleRole$1.default=void 0;var docExampleRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$q=docExampleRole;docExampleRole$1.default=_default$q;var docFootnoteRole$1={};Object.defineProperty(docFootnoteRole$1,"__esModule",{value:!0});docFootnoteRole$1.default=void 0;var docFootnoteRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"footnote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$p=docFootnoteRole;docFootnoteRole$1.default=_default$p;var docForewordRole$1={};Object.defineProperty(docForewordRole$1,"__esModule",{value:!0});docForewordRole$1.default=void 0;var docForewordRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"foreword [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$o=docForewordRole;docForewordRole$1.default=_default$o;var docGlossaryRole$1={};Object.defineProperty(docGlossaryRole$1,"__esModule",{value:!0});docGlossaryRole$1.default=void 0;var docGlossaryRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"glossary [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["definition"],["term"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$n=docGlossaryRole;docGlossaryRole$1.default=_default$n;var docGlossrefRole$1={};Object.defineProperty(docGlossrefRole$1,"__esModule",{value:!0});docGlossrefRole$1.default=void 0;var docGlossrefRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"glossref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},_default$m=docGlossrefRole;docGlossrefRole$1.default=_default$m;var docIndexRole$1={};Object.defineProperty(docIndexRole$1,"__esModule",{value:!0});docIndexRole$1.default=void 0;var docIndexRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"index [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},_default$l=docIndexRole;docIndexRole$1.default=_default$l;var docIntroductionRole$1={};Object.defineProperty(docIntroductionRole$1,"__esModule",{value:!0});docIntroductionRole$1.default=void 0;var docIntroductionRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"introduction [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$k=docIntroductionRole;docIntroductionRole$1.default=_default$k;var docNoterefRole$1={};Object.defineProperty(docNoterefRole$1,"__esModule",{value:!0});docNoterefRole$1.default=void 0;var docNoterefRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"noteref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},_default$j=docNoterefRole;docNoterefRole$1.default=_default$j;var docNoticeRole$1={};Object.defineProperty(docNoticeRole$1,"__esModule",{value:!0});docNoticeRole$1.default=void 0;var docNoticeRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"notice [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","note"]]},_default$i=docNoticeRole;docNoticeRole$1.default=_default$i;var docPagebreakRole$1={};Object.defineProperty(docPagebreakRole$1,"__esModule",{value:!0});docPagebreakRole$1.default=void 0;var docPagebreakRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"pagebreak [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","separator"]]},_default$h=docPagebreakRole;docPagebreakRole$1.default=_default$h;var docPagelistRole$1={};Object.defineProperty(docPagelistRole$1,"__esModule",{value:!0});docPagelistRole$1.default=void 0;var docPagelistRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"page-list [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},_default$g=docPagelistRole;docPagelistRole$1.default=_default$g;var docPartRole$1={};Object.defineProperty(docPartRole$1,"__esModule",{value:!0});docPartRole$1.default=void 0;var docPartRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"part [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$f=docPartRole;docPartRole$1.default=_default$f;var docPrefaceRole$1={};Object.defineProperty(docPrefaceRole$1,"__esModule",{value:!0});docPrefaceRole$1.default=void 0;var docPrefaceRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"preface [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$e=docPrefaceRole;docPrefaceRole$1.default=_default$e;var docPrologueRole$1={};Object.defineProperty(docPrologueRole$1,"__esModule",{value:!0});docPrologueRole$1.default=void 0;var docPrologueRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"prologue [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},_default$d=docPrologueRole;docPrologueRole$1.default=_default$d;var docPullquoteRole$1={};Object.defineProperty(docPullquoteRole$1,"__esModule",{value:!0});docPullquoteRole$1.default=void 0;var docPullquoteRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"pullquote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["none"]]},_default$c=docPullquoteRole;docPullquoteRole$1.default=_default$c;var docQnaRole$1={};Object.defineProperty(docQnaRole$1,"__esModule",{value:!0});docQnaRole$1.default=void 0;var docQnaRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"qna [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_default$b=docQnaRole;docQnaRole$1.default=_default$b;var docSubtitleRole$1={};Object.defineProperty(docSubtitleRole$1,"__esModule",{value:!0});docSubtitleRole$1.default=void 0;var docSubtitleRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"subtitle [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","sectionhead"]]},_default$a=docSubtitleRole;docSubtitleRole$1.default=_default$a;var docTipRole$1={};Object.defineProperty(docTipRole$1,"__esModule",{value:!0});docTipRole$1.default=void 0;var docTipRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"help [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","note"]]},_default$9=docTipRole;docTipRole$1.default=_default$9;var docTocRole$1={};Object.defineProperty(docTocRole$1,"__esModule",{value:!0});docTocRole$1.default=void 0;var docTocRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"toc [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},_default$8=docTocRole;docTocRole$1.default=_default$8;Object.defineProperty(ariaDpubRoles$1,"__esModule",{value:!0});ariaDpubRoles$1.default=void 0;var _docAbstractRole=_interopRequireDefault$5(docAbstractRole$1),_docAcknowledgmentsRole=_interopRequireDefault$5(docAcknowledgmentsRole$1),_docAfterwordRole=_interopRequireDefault$5(docAfterwordRole$1),_docAppendixRole=_interopRequireDefault$5(docAppendixRole$1),_docBacklinkRole=_interopRequireDefault$5(docBacklinkRole$1),_docBiblioentryRole=_interopRequireDefault$5(docBiblioentryRole$1),_docBibliographyRole=_interopRequireDefault$5(docBibliographyRole$1),_docBibliorefRole=_interopRequireDefault$5(docBibliorefRole$1),_docChapterRole=_interopRequireDefault$5(docChapterRole$1),_docColophonRole=_interopRequireDefault$5(docColophonRole$1),_docConclusionRole=_interopRequireDefault$5(docConclusionRole$1),_docCoverRole=_interopRequireDefault$5(docCoverRole$1),_docCreditRole=_interopRequireDefault$5(docCreditRole$1),_docCreditsRole=_interopRequireDefault$5(docCreditsRole$1),_docDedicationRole=_interopRequireDefault$5(docDedicationRole$1),_docEndnoteRole=_interopRequireDefault$5(docEndnoteRole$1),_docEndnotesRole=_interopRequireDefault$5(docEndnotesRole$1),_docEpigraphRole=_interopRequireDefault$5(docEpigraphRole$1),_docEpilogueRole=_interopRequireDefault$5(docEpilogueRole$1),_docErrataRole=_interopRequireDefault$5(docErrataRole$1),_docExampleRole=_interopRequireDefault$5(docExampleRole$1),_docFootnoteRole=_interopRequireDefault$5(docFootnoteRole$1),_docForewordRole=_interopRequireDefault$5(docForewordRole$1),_docGlossaryRole=_interopRequireDefault$5(docGlossaryRole$1),_docGlossrefRole=_interopRequireDefault$5(docGlossrefRole$1),_docIndexRole=_interopRequireDefault$5(docIndexRole$1),_docIntroductionRole=_interopRequireDefault$5(docIntroductionRole$1),_docNoterefRole=_interopRequireDefault$5(docNoterefRole$1),_docNoticeRole=_interopRequireDefault$5(docNoticeRole$1),_docPagebreakRole=_interopRequireDefault$5(docPagebreakRole$1),_docPagelistRole=_interopRequireDefault$5(docPagelistRole$1),_docPartRole=_interopRequireDefault$5(docPartRole$1),_docPrefaceRole=_interopRequireDefault$5(docPrefaceRole$1),_docPrologueRole=_interopRequireDefault$5(docPrologueRole$1),_docPullquoteRole=_interopRequireDefault$5(docPullquoteRole$1),_docQnaRole=_interopRequireDefault$5(docQnaRole$1),_docSubtitleRole=_interopRequireDefault$5(docSubtitleRole$1),_docTipRole=_interopRequireDefault$5(docTipRole$1),_docTocRole=_interopRequireDefault$5(docTocRole$1);function _interopRequireDefault$5($){return $&&$.__esModule?$:{default:$}}var ariaDpubRoles=[["doc-abstract",_docAbstractRole.default],["doc-acknowledgments",_docAcknowledgmentsRole.default],["doc-afterword",_docAfterwordRole.default],["doc-appendix",_docAppendixRole.default],["doc-backlink",_docBacklinkRole.default],["doc-biblioentry",_docBiblioentryRole.default],["doc-bibliography",_docBibliographyRole.default],["doc-biblioref",_docBibliorefRole.default],["doc-chapter",_docChapterRole.default],["doc-colophon",_docColophonRole.default],["doc-conclusion",_docConclusionRole.default],["doc-cover",_docCoverRole.default],["doc-credit",_docCreditRole.default],["doc-credits",_docCreditsRole.default],["doc-dedication",_docDedicationRole.default],["doc-endnote",_docEndnoteRole.default],["doc-endnotes",_docEndnotesRole.default],["doc-epigraph",_docEpigraphRole.default],["doc-epilogue",_docEpilogueRole.default],["doc-errata",_docErrataRole.default],["doc-example",_docExampleRole.default],["doc-footnote",_docFootnoteRole.default],["doc-foreword",_docForewordRole.default],["doc-glossary",_docGlossaryRole.default],["doc-glossref",_docGlossrefRole.default],["doc-index",_docIndexRole.default],["doc-introduction",_docIntroductionRole.default],["doc-noteref",_docNoterefRole.default],["doc-notice",_docNoticeRole.default],["doc-pagebreak",_docPagebreakRole.default],["doc-pagelist",_docPagelistRole.default],["doc-part",_docPartRole.default],["doc-preface",_docPrefaceRole.default],["doc-prologue",_docPrologueRole.default],["doc-pullquote",_docPullquoteRole.default],["doc-qna",_docQnaRole.default],["doc-subtitle",_docSubtitleRole.default],["doc-tip",_docTipRole.default],["doc-toc",_docTocRole.default]],_default$7=ariaDpubRoles;ariaDpubRoles$1.default=_default$7;var ariaGraphicsRoles$1={},graphicsDocumentRole$1={};Object.defineProperty(graphicsDocumentRole$1,"__esModule",{value:!0});graphicsDocumentRole$1.default=void 0;var graphicsDocumentRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{module:"GRAPHICS",concept:{name:"graphics-object"}},{module:"ARIA",concept:{name:"img"}},{module:"ARIA",concept:{name:"article"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","document"]]},_default$6=graphicsDocumentRole;graphicsDocumentRole$1.default=_default$6;var graphicsObjectRole$1={};Object.defineProperty(graphicsObjectRole$1,"__esModule",{value:!0});graphicsObjectRole$1.default=void 0;var graphicsObjectRole={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{module:"GRAPHICS",concept:{name:"graphics-document"}},{module:"ARIA",concept:{name:"group"}},{module:"ARIA",concept:{name:"img"}},{module:"GRAPHICS",concept:{name:"graphics-symbol"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","group"]]},_default$5=graphicsObjectRole;graphicsObjectRole$1.default=_default$5;var graphicsSymbolRole$1={};Object.defineProperty(graphicsSymbolRole$1,"__esModule",{value:!0});graphicsSymbolRole$1.default=void 0;var graphicsSymbolRole={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","img"]]},_default$4=graphicsSymbolRole;graphicsSymbolRole$1.default=_default$4;Object.defineProperty(ariaGraphicsRoles$1,"__esModule",{value:!0});ariaGraphicsRoles$1.default=void 0;var _graphicsDocumentRole=_interopRequireDefault$4(graphicsDocumentRole$1),_graphicsObjectRole=_interopRequireDefault$4(graphicsObjectRole$1),_graphicsSymbolRole=_interopRequireDefault$4(graphicsSymbolRole$1);function _interopRequireDefault$4($){return $&&$.__esModule?$:{default:$}}var ariaGraphicsRoles=[["graphics-document",_graphicsDocumentRole.default],["graphics-object",_graphicsObjectRole.default],["graphics-symbol",_graphicsSymbolRole.default]],_default$3=ariaGraphicsRoles;ariaGraphicsRoles$1.default=_default$3;Object.defineProperty(rolesMap$1,"__esModule",{value:!0});rolesMap$1.default=void 0;var _ariaAbstractRoles=_interopRequireDefault$3(ariaAbstractRoles$1),_ariaLiteralRoles=_interopRequireDefault$3(ariaLiteralRoles$1),_ariaDpubRoles=_interopRequireDefault$3(ariaDpubRoles$1),_ariaGraphicsRoles=_interopRequireDefault$3(ariaGraphicsRoles$1),_iterationDecorator$2=_interopRequireDefault$3(iterationDecorator$1);function _interopRequireDefault$3($){return $&&$.__esModule?$:{default:$}}function _defineProperty($,j,it){return j in $?Object.defineProperty($,j,{value:it,enumerable:!0,configurable:!0,writable:!0}):$[j]=it,$}function _createForOfIteratorHelper$2($,j){var it=typeof Symbol<"u"&&$[Symbol.iterator]||$["@@iterator"];if(!it){if(Array.isArray($)||(it=_unsupportedIterableToArray$2($))||j&&$&&typeof $.length=="number"){it&&($=it);var et=0,ut=function(){};return{s:ut,n:function(){return et>=$.length?{done:!0}:{done:!1,value:$[et++]}},e:function(Rt){throw Rt},f:ut}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var dt=!0,mt=!1,yt;return{s:function(){it=it.call($)},n:function(){var Rt=it.next();return dt=Rt.done,Rt},e:function(Rt){mt=!0,yt=Rt},f:function(){try{!dt&&it.return!=null&&it.return()}finally{if(mt)throw yt}}}}function _slicedToArray$2($,j){return _arrayWithHoles$2($)||_iterableToArrayLimit$2($,j)||_unsupportedIterableToArray$2($,j)||_nonIterableRest$2()}function _nonIterableRest$2(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$2($,j){if($){if(typeof $=="string")return _arrayLikeToArray$2($,j);var it=Object.prototype.toString.call($).slice(8,-1);if(it==="Object"&&$.constructor&&(it=$.constructor.name),it==="Map"||it==="Set")return Array.from($);if(it==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(it))return _arrayLikeToArray$2($,j)}}function _arrayLikeToArray$2($,j){(j==null||j>$.length)&&(j=$.length);for(var it=0,et=new Array(j);it<j;it++)et[it]=$[it];return et}function _iterableToArrayLimit$2($,j){var it=$==null?null:typeof Symbol<"u"&&$[Symbol.iterator]||$["@@iterator"];if(it!=null){var et=[],ut=!0,dt=!1,mt,yt;try{for(it=it.call($);!(ut=(mt=it.next()).done)&&(et.push(mt.value),!(j&&et.length===j));ut=!0);}catch(bt){dt=!0,yt=bt}finally{try{!ut&&it.return!=null&&it.return()}finally{if(dt)throw yt}}return et}}function _arrayWithHoles$2($){if(Array.isArray($))return $}var roles$1=[].concat(_ariaAbstractRoles.default,_ariaLiteralRoles.default,_ariaDpubRoles.default,_ariaGraphicsRoles.default);roles$1.forEach(function($){var j=_slicedToArray$2($,2),it=j[1],et=_createForOfIteratorHelper$2(it.superClass),ut;try{for(et.s();!(ut=et.n()).done;){var dt=ut.value,mt=_createForOfIteratorHelper$2(dt),yt;try{var bt=function(){var jt=yt.value,Vt=roles$1.find(function(dr){var Ft=_slicedToArray$2(dr,1),Ht=Ft[0];return Ht===jt});if(Vt)for(var zt=Vt[1],Jt=0,rr=Object.keys(zt.props);Jt<rr.length;Jt++){var Yt=rr[Jt];Object.prototype.hasOwnProperty.call(it.props,Yt)||Object.assign(it.props,_defineProperty({},Yt,zt.props[Yt]))}};for(mt.s();!(yt=mt.n()).done;)bt()}catch(Rt){mt.e(Rt)}finally{mt.f()}}}catch(Rt){et.e(Rt)}finally{et.f()}});var rolesMap={entries:function $(){return roles$1},forEach:function $(j){var it=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,et=_createForOfIteratorHelper$2(roles$1),ut;try{for(et.s();!(ut=et.n()).done;){var dt=_slicedToArray$2(ut.value,2),mt=dt[0],yt=dt[1];j.call(it,yt,mt,roles$1)}}catch(bt){et.e(bt)}finally{et.f()}},get:function $(j){var it=roles$1.find(function(et){return et[0]===j});return it&&it[1]},has:function $(j){return!!rolesMap.get(j)},keys:function $(){return roles$1.map(function(j){var it=_slicedToArray$2(j,1),et=it[0];return et})},values:function $(){return roles$1.map(function(j){var it=_slicedToArray$2(j,2),et=it[1];return et})}},_default$2=(0,_iterationDecorator$2.default)(rolesMap,rolesMap.entries());rolesMap$1.default=_default$2;var elementRoleMap$1={},toStr$9=Object.prototype.toString,isArguments$3=function $(j){var it=toStr$9.call(j),et=it==="[object Arguments]";return et||(et=it!=="[object Array]"&&j!==null&&typeof j=="object"&&typeof j.length=="number"&&j.length>=0&&toStr$9.call(j.callee)==="[object Function]"),et},implementation$b,hasRequiredImplementation;function requireImplementation(){if(hasRequiredImplementation)return implementation$b;hasRequiredImplementation=1;var $;if(!Object.keys){var j=Object.prototype.hasOwnProperty,it=Object.prototype.toString,et=isArguments$3,ut=Object.prototype.propertyIsEnumerable,dt=!ut.call({toString:null},"toString"),mt=ut.call(function(){},"prototype"),yt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],bt=function(zt){var Jt=zt.constructor;return Jt&&Jt.prototype===zt},Rt={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},jt=function(){if(typeof window>"u")return!1;for(var zt in window)try{if(!Rt["$"+zt]&&j.call(window,zt)&&window[zt]!==null&&typeof window[zt]=="object")try{bt(window[zt])}catch{return!0}}catch{return!0}return!1}(),Vt=function(zt){if(typeof window>"u"||!jt)return bt(zt);try{return bt(zt)}catch{return!1}};$=function(Jt){var rr=Jt!==null&&typeof Jt=="object",Yt=it.call(Jt)==="[object Function]",dr=et(Jt),Ft=rr&&it.call(Jt)==="[object String]",Ht=[];if(!rr&&!Yt&&!dr)throw new TypeError("Object.keys called on a non-object");var er=mt&&Yt;if(Ft&&Jt.length>0&&!j.call(Jt,0))for(var pr=0;pr<Jt.length;++pr)Ht.push(String(pr));if(dr&&Jt.length>0)for(var or=0;or<Jt.length;++or)Ht.push(String(or));else for(var ar in Jt)!(er&&ar==="prototype")&&j.call(Jt,ar)&&Ht.push(String(ar));if(dt)for(var Wt=Vt(Jt),Zt=0;Zt<yt.length;++Zt)!(Wt&&yt[Zt]==="constructor")&&j.call(Jt,yt[Zt])&&Ht.push(yt[Zt]);return Ht}}return implementation$b=$,implementation$b}var slice$1=Array.prototype.slice,isArgs=isArguments$3,origKeys=Object.keys,keysShim=origKeys?function $(j){return origKeys(j)}:requireImplementation(),originalKeys=Object.keys;keysShim.shim=function $(){if(Object.keys){var j=function(){var it=Object.keys(arguments);return it&&it.length===arguments.length}(1,2);j||(Object.keys=function(et){return isArgs(et)?originalKeys(slice$1.call(et)):originalKeys(et)})}else Object.keys=keysShim;return Object.keys||keysShim};var objectKeys$2=keysShim,shams$1=function $(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var j={},it=Symbol("test"),et=Object(it);if(typeof it=="string"||Object.prototype.toString.call(it)!=="[object Symbol]"||Object.prototype.toString.call(et)!=="[object Symbol]")return!1;var ut=42;j[it]=ut;for(it in j)return!1;if(typeof Object.keys=="function"&&Object.keys(j).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(j).length!==0)return!1;var dt=Object.getOwnPropertySymbols(j);if(dt.length!==1||dt[0]!==it||!Object.prototype.propertyIsEnumerable.call(j,it))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var mt=Object.getOwnPropertyDescriptor(j,it);if(mt.value!==ut||mt.enumerable!==!0)return!1}return!0},origSymbol=typeof Symbol<"u"&&Symbol,hasSymbolSham=shams$1,hasSymbols$5=function $(){return typeof origSymbol!="function"||typeof Symbol!="function"||typeof origSymbol("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:hasSymbolSham()},ERROR_MESSAGE="Function.prototype.bind called on incompatible ",slice=Array.prototype.slice,toStr$8=Object.prototype.toString,funcType="[object Function]",implementation$a=function $(j){var it=this;if(typeof it!="function"||toStr$8.call(it)!==funcType)throw new TypeError(ERROR_MESSAGE+it);for(var et=slice.call(arguments,1),ut,dt=function(){if(this instanceof ut){var jt=it.apply(this,et.concat(slice.call(arguments)));return Object(jt)===jt?jt:this}else return it.apply(j,et.concat(slice.call(arguments)))},mt=Math.max(0,it.length-et.length),yt=[],bt=0;bt<mt;bt++)yt.push("$"+bt);if(ut=Function("binder","return function ("+yt.join(",")+"){ return binder.apply(this,arguments); }")(dt),it.prototype){var Rt=function(){};Rt.prototype=it.prototype,ut.prototype=new Rt,Rt.prototype=null}return ut},implementation$9=implementation$a,functionBind=Function.prototype.bind||implementation$9,bind$1=functionBind,src=bind$1.call(Function.call,Object.prototype.hasOwnProperty),undefined$1,$SyntaxError$1=SyntaxError,$Function=Function,$TypeError$2=TypeError,getEvalledConstructor=function($){try{return $Function('"use strict"; return ('+$+").constructor;")()}catch{}},$gOPD$2=Object.getOwnPropertyDescriptor;if($gOPD$2)try{$gOPD$2({},"")}catch{$gOPD$2=null}var throwTypeError=function(){throw new $TypeError$2},ThrowTypeError=$gOPD$2?function(){try{return arguments.callee,throwTypeError}catch{try{return $gOPD$2(arguments,"callee").get}catch{return throwTypeError}}}():throwTypeError,hasSymbols$4=hasSymbols$5(),getProto$1=Object.getPrototypeOf||function($){return $.__proto__},needsEval={},TypedArray=typeof Uint8Array>"u"?undefined$1:getProto$1(Uint8Array),INTRINSICS={"%AggregateError%":typeof AggregateError>"u"?undefined$1:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?undefined$1:ArrayBuffer,"%ArrayIteratorPrototype%":hasSymbols$4?getProto$1([][Symbol.iterator]()):undefined$1,"%AsyncFromSyncIteratorPrototype%":undefined$1,"%AsyncFunction%":needsEval,"%AsyncGenerator%":needsEval,"%AsyncGeneratorFunction%":needsEval,"%AsyncIteratorPrototype%":needsEval,"%Atomics%":typeof Atomics>"u"?undefined$1:Atomics,"%BigInt%":typeof BigInt>"u"?undefined$1:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?undefined$1:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?undefined$1:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?undefined$1:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?undefined$1:Float32Array,"%Float64Array%":typeof Float64Array>"u"?undefined$1:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?undefined$1:FinalizationRegistry,"%Function%":$Function,"%GeneratorFunction%":needsEval,"%Int8Array%":typeof Int8Array>"u"?undefined$1:Int8Array,"%Int16Array%":typeof Int16Array>"u"?undefined$1:Int16Array,"%Int32Array%":typeof Int32Array>"u"?undefined$1:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":hasSymbols$4?getProto$1(getProto$1([][Symbol.iterator]())):undefined$1,"%JSON%":typeof JSON=="object"?JSON:undefined$1,"%Map%":typeof Map>"u"?undefined$1:Map,"%MapIteratorPrototype%":typeof Map>"u"||!hasSymbols$4?undefined$1:getProto$1(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?undefined$1:Promise,"%Proxy%":typeof Proxy>"u"?undefined$1:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?undefined$1:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?undefined$1:Set,"%SetIteratorPrototype%":typeof Set>"u"||!hasSymbols$4?undefined$1:getProto$1(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?undefined$1:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":hasSymbols$4?getProto$1(""[Symbol.iterator]()):undefined$1,"%Symbol%":hasSymbols$4?Symbol:undefined$1,"%SyntaxError%":$SyntaxError$1,"%ThrowTypeError%":ThrowTypeError,"%TypedArray%":TypedArray,"%TypeError%":$TypeError$2,"%Uint8Array%":typeof Uint8Array>"u"?undefined$1:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?undefined$1:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?undefined$1:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?undefined$1:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?undefined$1:WeakMap,"%WeakRef%":typeof WeakRef>"u"?undefined$1:WeakRef,"%WeakSet%":typeof WeakSet>"u"?undefined$1:WeakSet};try{null.error}catch($){var errorProto=getProto$1(getProto$1($));INTRINSICS["%Error.prototype%"]=errorProto}var doEval=function $(j){var it;if(j==="%AsyncFunction%")it=getEvalledConstructor("async function () {}");else if(j==="%GeneratorFunction%")it=getEvalledConstructor("function* () {}");else if(j==="%AsyncGeneratorFunction%")it=getEvalledConstructor("async function* () {}");else if(j==="%AsyncGenerator%"){var et=$("%AsyncGeneratorFunction%");et&&(it=et.prototype)}else if(j==="%AsyncIteratorPrototype%"){var ut=$("%AsyncGenerator%");ut&&(it=getProto$1(ut.prototype))}return INTRINSICS[j]=it,it},LEGACY_ALIASES={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},bind=functionBind,hasOwn$1=src,$concat$1=bind.call(Function.call,Array.prototype.concat),$spliceApply=bind.call(Function.apply,Array.prototype.splice),$replace$1=bind.call(Function.call,String.prototype.replace),$strSlice=bind.call(Function.call,String.prototype.slice),$exec$1=bind.call(Function.call,RegExp.prototype.exec),rePropName=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=function $(j){var it=$strSlice(j,0,1),et=$strSlice(j,-1);if(it==="%"&&et!=="%")throw new $SyntaxError$1("invalid intrinsic syntax, expected closing `%`");if(et==="%"&&it!=="%")throw new $SyntaxError$1("invalid intrinsic syntax, expected opening `%`");var ut=[];return $replace$1(j,rePropName,function(dt,mt,yt,bt){ut[ut.length]=yt?$replace$1(bt,reEscapeChar,"$1"):mt||dt}),ut},getBaseIntrinsic=function $(j,it){var et=j,ut;if(hasOwn$1(LEGACY_ALIASES,et)&&(ut=LEGACY_ALIASES[et],et="%"+ut[0]+"%"),hasOwn$1(INTRINSICS,et)){var dt=INTRINSICS[et];if(dt===needsEval&&(dt=doEval(et)),typeof dt>"u"&&!it)throw new $TypeError$2("intrinsic "+j+" exists, but is not available. Please file an issue!");return{alias:ut,name:et,value:dt}}throw new $SyntaxError$1("intrinsic "+j+" does not exist!")},getIntrinsic=function $(j,it){if(typeof j!="string"||j.length===0)throw new $TypeError$2("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof it!="boolean")throw new $TypeError$2('"allowMissing" argument must be a boolean');if($exec$1(/^%?[^%]*%?$/,j)===null)throw new $SyntaxError$1("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var et=stringToPath(j),ut=et.length>0?et[0]:"",dt=getBaseIntrinsic("%"+ut+"%",it),mt=dt.name,yt=dt.value,bt=!1,Rt=dt.alias;Rt&&(ut=Rt[0],$spliceApply(et,$concat$1([0,1],Rt)));for(var jt=1,Vt=!0;jt<et.length;jt+=1){var zt=et[jt],Jt=$strSlice(zt,0,1),rr=$strSlice(zt,-1);if((Jt==='"'||Jt==="'"||Jt==="`"||rr==='"'||rr==="'"||rr==="`")&&Jt!==rr)throw new $SyntaxError$1("property names with quotes must have matching quotes");if((zt==="constructor"||!Vt)&&(bt=!0),ut+="."+zt,mt="%"+ut+"%",hasOwn$1(INTRINSICS,mt))yt=INTRINSICS[mt];else if(yt!=null){if(!(zt in yt)){if(!it)throw new $TypeError$2("base intrinsic for "+j+" exists, but the property is not available.");return}if($gOPD$2&&jt+1>=et.length){var Yt=$gOPD$2(yt,zt);Vt=!!Yt,Vt&&"get"in Yt&&!("originalValue"in Yt.get)?yt=Yt.get:yt=yt[zt]}else Vt=hasOwn$1(yt,zt),yt=yt[zt];Vt&&!bt&&(INTRINSICS[mt]=yt)}}return yt},GetIntrinsic$8=getIntrinsic,$defineProperty=GetIntrinsic$8("%Object.defineProperty%",!0),hasPropertyDescriptors$1=function $(){if($defineProperty)try{return $defineProperty({},"a",{value:1}),!0}catch{return!1}return!1};hasPropertyDescriptors$1.hasArrayLengthDefineBug=function $(){if(!hasPropertyDescriptors$1())return null;try{return $defineProperty([],"length",{value:1}).length!==1}catch{return!0}};var hasPropertyDescriptors_1=hasPropertyDescriptors$1,keys$2=objectKeys$2,hasSymbols$3=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",toStr$7=Object.prototype.toString,concat=Array.prototype.concat,origDefineProperty=Object.defineProperty,isFunction=function($){return typeof $=="function"&&toStr$7.call($)==="[object Function]"},hasPropertyDescriptors=hasPropertyDescriptors_1(),supportsDescriptors$2=origDefineProperty&&hasPropertyDescriptors,defineProperty$1=function($,j,it,et){if(j in $){if(et===!0){if($[j]===it)return}else if(!isFunction(et)||!et())return}supportsDescriptors$2?origDefineProperty($,j,{configurable:!0,enumerable:!1,value:it,writable:!0}):$[j]=it},defineProperties$1=function($,j){var it=arguments.length>2?arguments[2]:{},et=keys$2(j);hasSymbols$3&&(et=concat.call(et,Object.getOwnPropertySymbols(j)));for(var ut=0;ut<et.length;ut+=1)defineProperty$1($,et[ut],j[et[ut]],it[et[ut]])};defineProperties$1.supportsDescriptors=!!supportsDescriptors$2;var defineProperties_1=defineProperties$1,callBind$5={exports:{}};(function($){var j=functionBind,it=getIntrinsic,et=it("%Function.prototype.apply%"),ut=it("%Function.prototype.call%"),dt=it("%Reflect.apply%",!0)||j.call(ut,et),mt=it("%Object.getOwnPropertyDescriptor%",!0),yt=it("%Object.defineProperty%",!0),bt=it("%Math.max%");if(yt)try{yt({},"a",{value:1})}catch{yt=null}$.exports=function(Vt){var zt=dt(j,ut,arguments);if(mt&&yt){var Jt=mt(zt,"length");Jt.configurable&&yt(zt,"length",{value:1+bt(0,Vt.length-(arguments.length-1))})}return zt};var Rt=function(){return dt(j,et,arguments)};yt?yt($.exports,"apply",{value:Rt}):$.exports.apply=Rt})(callBind$5);var callBindExports=callBind$5.exports,GetIntrinsic$7=getIntrinsic,callBind$4=callBindExports,$indexOf$1=callBind$4(GetIntrinsic$7("String.prototype.indexOf")),callBound$c=function $(j,it){var et=GetIntrinsic$7(j,!!it);return typeof et=="function"&&$indexOf$1(j,".prototype.")>-1?callBind$4(et):et},objectKeys$1=objectKeys$2,hasSymbols$2=shams$1(),callBound$b=callBound$c,toObject=Object,$push=callBound$b("Array.prototype.push"),$propIsEnumerable=callBound$b("Object.prototype.propertyIsEnumerable"),originalGetSymbols=hasSymbols$2?Object.getOwnPropertySymbols:null,implementation$8=function $(j,it){if(j==null)throw new TypeError("target must be an object");var et=toObject(j);if(arguments.length===1)return et;for(var ut=1;ut<arguments.length;++ut){var dt=toObject(arguments[ut]),mt=objectKeys$1(dt),yt=hasSymbols$2&&(Object.getOwnPropertySymbols||originalGetSymbols);if(yt)for(var bt=yt(dt),Rt=0;Rt<bt.length;++Rt){var jt=bt[Rt];$propIsEnumerable(dt,jt)&&$push(mt,jt)}for(var Vt=0;Vt<mt.length;++Vt){var zt=mt[Vt];if($propIsEnumerable(dt,zt)){var Jt=dt[zt];et[zt]=Jt}}}return et},implementation$7=implementation$8,lacksProperEnumerationOrder=function(){if(!Object.assign)return!1;for(var $="abcdefghijklmnopqrst",j=$.split(""),it={},et=0;et<j.length;++et)it[j[et]]=j[et];var ut=Object.assign({},it),dt="";for(var mt in ut)dt+=mt;return $!==dt},assignHasPendingExceptions=function(){if(!Object.assign||!Object.preventExtensions)return!1;var $=Object.preventExtensions({1:2});try{Object.assign($,"xy")}catch{return $[1]==="y"}return!1},polyfill$4=function $(){return!Object.assign||lacksProperEnumerationOrder()||assignHasPendingExceptions()?implementation$7:Object.assign},define$3=defineProperties_1,getPolyfill$5=polyfill$4,shim$5=function $(){var j=getPolyfill$5();return define$3(Object,{assign:j},{assign:function(){return Object.assign!==j}}),j},defineProperties=defineProperties_1,callBind$3=callBindExports,implementation$6=implementation$8,getPolyfill$4=polyfill$4,shim$4=shim$5,polyfill$3=callBind$3.apply(getPolyfill$4()),bound=function $(j,it){return polyfill$3(Object,arguments)};defineProperties(bound,{getPolyfill:getPolyfill$4,implementation:implementation$6,shim:shim$4});var object_assign=bound,implementation$5={exports:{}},functionsHaveNames=function $(){return typeof(function(){}).name=="string"},gOPD$4=Object.getOwnPropertyDescriptor;if(gOPD$4)try{gOPD$4([],"length")}catch{gOPD$4=null}functionsHaveNames.functionsHaveConfigurableNames=function $(){if(!functionsHaveNames()||!gOPD$4)return!1;var j=gOPD$4(function(){},"name");return!!j&&!!j.configurable};var $bind=Function.prototype.bind;functionsHaveNames.boundFunctionsHaveNames=function $(){return functionsHaveNames()&&typeof $bind=="function"&&(function(){}).bind().name!==""};var functionsHaveNames_1=functionsHaveNames;(function($){var j=functionsHaveNames_1.functionsHaveConfigurableNames(),it=Object,et=TypeError;$.exports=function(){if(this!=null&&this!==it(this))throw new et("RegExp.prototype.flags getter called on non-object");var dt="";return this.hasIndices&&(dt+="d"),this.global&&(dt+="g"),this.ignoreCase&&(dt+="i"),this.multiline&&(dt+="m"),this.dotAll&&(dt+="s"),this.unicode&&(dt+="u"),this.sticky&&(dt+="y"),dt},j&&Object.defineProperty&&Object.defineProperty($.exports,"name",{value:"get flags"})})(implementation$5);var implementationExports=implementation$5.exports,implementation$4=implementationExports,supportsDescriptors$1=defineProperties_1.supportsDescriptors,$gOPD$1=Object.getOwnPropertyDescriptor,polyfill$2=function $(){if(supportsDescriptors$1&&/a/mig.flags==="gim"){var j=$gOPD$1(RegExp.prototype,"flags");if(j&&typeof j.get=="function"&&typeof RegExp.prototype.dotAll=="boolean"&&typeof RegExp.prototype.hasIndices=="boolean"){var it="",et={};if(Object.defineProperty(et,"hasIndices",{get:function(){it+="d"}}),Object.defineProperty(et,"sticky",{get:function(){it+="y"}}),it==="dy")return j.get}}return implementation$4},supportsDescriptors=defineProperties_1.supportsDescriptors,getPolyfill$3=polyfill$2,gOPD$3=Object.getOwnPropertyDescriptor,defineProperty=Object.defineProperty,TypeErr=TypeError,getProto=Object.getPrototypeOf,regex=/a/,shim$3=function $(){if(!supportsDescriptors||!getProto)throw new TypeErr("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var j=getPolyfill$3(),it=getProto(regex),et=gOPD$3(it,"flags");return(!et||et.get!==j)&&defineProperty(it,"flags",{configurable:!0,enumerable:!1,get:j}),j},define$2=defineProperties_1,callBind$2=callBindExports,implementation$3=implementationExports,getPolyfill$2=polyfill$2,shim$2=shim$3,flagsBound=callBind$2(getPolyfill$2());define$2(flagsBound,{getPolyfill:getPolyfill$2,implementation:implementation$3,shim:shim$2});var regexp_prototype_flags=flagsBound,esGetIterator={exports:{}},hasSymbols$1=shams$1,shams=function $(){return hasSymbols$1()&&!!Symbol.toStringTag},hasToStringTag$8=shams(),callBound$a=callBound$c,$toString$4=callBound$a("Object.prototype.toString"),isStandardArguments=function $(j){return hasToStringTag$8&&j&&typeof j=="object"&&Symbol.toStringTag in j?!1:$toString$4(j)==="[object Arguments]"},isLegacyArguments=function $(j){return isStandardArguments(j)?!0:j!==null&&typeof j=="object"&&typeof j.length=="number"&&j.length>=0&&$toString$4(j)!=="[object Array]"&&$toString$4(j.callee)==="[object Function]"},supportsStandardArguments=function(){return isStandardArguments(arguments)}();isStandardArguments.isLegacyArguments=isLegacyArguments;var isArguments$2=supportsStandardArguments?isStandardArguments:isLegacyArguments;const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$0$1=getAugmentedNamespace(__viteBrowserExternal$1);var hasMap=typeof Map=="function"&&Map.prototype,mapSizeDescriptor=Object.getOwnPropertyDescriptor&&hasMap?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,mapSize=hasMap&&mapSizeDescriptor&&typeof mapSizeDescriptor.get=="function"?mapSizeDescriptor.get:null,mapForEach=hasMap&&Map.prototype.forEach,hasSet=typeof Set=="function"&&Set.prototype,setSizeDescriptor=Object.getOwnPropertyDescriptor&&hasSet?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,setSize=hasSet&&setSizeDescriptor&&typeof setSizeDescriptor.get=="function"?setSizeDescriptor.get:null,setForEach=hasSet&&Set.prototype.forEach,hasWeakMap=typeof WeakMap=="function"&&WeakMap.prototype,weakMapHas=hasWeakMap?WeakMap.prototype.has:null,hasWeakSet=typeof WeakSet=="function"&&WeakSet.prototype,weakSetHas=hasWeakSet?WeakSet.prototype.has:null,hasWeakRef=typeof WeakRef=="function"&&WeakRef.prototype,weakRefDeref=hasWeakRef?WeakRef.prototype.deref:null,booleanValueOf=Boolean.prototype.valueOf,objectToString=Object.prototype.toString,functionToString=Function.prototype.toString,$match=String.prototype.match,$slice$2=String.prototype.slice,$replace=String.prototype.replace,$toUpperCase=String.prototype.toUpperCase,$toLowerCase=String.prototype.toLowerCase,$test=RegExp.prototype.test,$concat=Array.prototype.concat,$join=Array.prototype.join,$arrSlice=Array.prototype.slice,$floor=Math.floor,bigIntValueOf$1=typeof BigInt=="function"?BigInt.prototype.valueOf:null,gOPS=Object.getOwnPropertySymbols,symToString=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,hasShammedSymbols=typeof Symbol=="function"&&typeof Symbol.iterator=="object",toStringTag=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===hasShammedSymbols||"symbol")?Symbol.toStringTag:null,isEnumerable=Object.prototype.propertyIsEnumerable,gPO$1=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function($){return $.__proto__}:null);function addNumericSeparator($,j){if($===1/0||$===-1/0||$!==$||$&&$>-1e3&&$<1e3||$test.call(/e/,j))return j;var it=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof $=="number"){var et=$<0?-$floor(-$):$floor($);if(et!==$){var ut=String(et),dt=$slice$2.call(j,ut.length+1);return $replace.call(ut,it,"$&_")+"."+$replace.call($replace.call(dt,/([0-9]{3})/g,"$&_"),/_$/,"")}}return $replace.call(j,it,"$&_")}var utilInspect=require$$0$1,inspectCustom=utilInspect.custom,inspectSymbol=isSymbol$2(inspectCustom)?inspectCustom:null,objectInspect=function $(j,it,et,ut){var dt=it||{};if(has$2(dt,"quoteStyle")&&dt.quoteStyle!=="single"&&dt.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(has$2(dt,"maxStringLength")&&(typeof dt.maxStringLength=="number"?dt.maxStringLength<0&&dt.maxStringLength!==1/0:dt.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var mt=has$2(dt,"customInspect")?dt.customInspect:!0;if(typeof mt!="boolean"&&mt!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(has$2(dt,"indent")&&dt.indent!==null&&dt.indent!=="	"&&!(parseInt(dt.indent,10)===dt.indent&&dt.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(has$2(dt,"numericSeparator")&&typeof dt.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var yt=dt.numericSeparator;if(typeof j>"u")return"undefined";if(j===null)return"null";if(typeof j=="boolean")return j?"true":"false";if(typeof j=="string")return inspectString(j,dt);if(typeof j=="number"){if(j===0)return 1/0/j>0?"0":"-0";var bt=String(j);return yt?addNumericSeparator(j,bt):bt}if(typeof j=="bigint"){var Rt=String(j)+"n";return yt?addNumericSeparator(j,Rt):Rt}var jt=typeof dt.depth>"u"?5:dt.depth;if(typeof et>"u"&&(et=0),et>=jt&&jt>0&&typeof j=="object")return isArray$2(j)?"[Array]":"[Object]";var Vt=getIndent(dt,et);if(typeof ut>"u")ut=[];else if(indexOf(ut,j)>=0)return"[Circular]";function zt(hn,cn,gn){if(cn&&(ut=$arrSlice.call(ut),ut.push(cn)),gn){var tn={depth:dt.depth};return has$2(dt,"quoteStyle")&&(tn.quoteStyle=dt.quoteStyle),$(hn,tn,et+1,ut)}return $(hn,dt,et+1,ut)}if(typeof j=="function"&&!isRegExp(j)){var Jt=nameOf(j),rr=arrObjKeys(j,zt);return"[Function"+(Jt?": "+Jt:" (anonymous)")+"]"+(rr.length>0?" { "+$join.call(rr,", ")+" }":"")}if(isSymbol$2(j)){var Yt=hasShammedSymbols?$replace.call(String(j),/^(Symbol\(.*\))_[^)]*$/,"$1"):symToString.call(j);return typeof j=="object"&&!hasShammedSymbols?markBoxed(Yt):Yt}if(isElement(j)){for(var dr="<"+$toLowerCase.call(String(j.nodeName)),Ft=j.attributes||[],Ht=0;Ht<Ft.length;Ht++)dr+=" "+Ft[Ht].name+"="+wrapQuotes(quote(Ft[Ht].value),"double",dt);return dr+=">",j.childNodes&&j.childNodes.length&&(dr+="..."),dr+="</"+$toLowerCase.call(String(j.nodeName))+">",dr}if(isArray$2(j)){if(j.length===0)return"[]";var er=arrObjKeys(j,zt);return Vt&&!singleLineValues(er)?"["+indentedJoin(er,Vt)+"]":"[ "+$join.call(er,", ")+" ]"}if(isError(j)){var pr=arrObjKeys(j,zt);return!("cause"in Error.prototype)&&"cause"in j&&!isEnumerable.call(j,"cause")?"{ ["+String(j)+"] "+$join.call($concat.call("[cause]: "+zt(j.cause),pr),", ")+" }":pr.length===0?"["+String(j)+"]":"{ ["+String(j)+"] "+$join.call(pr,", ")+" }"}if(typeof j=="object"&&mt){if(inspectSymbol&&typeof j[inspectSymbol]=="function"&&utilInspect)return utilInspect(j,{depth:jt-et});if(mt!=="symbol"&&typeof j.inspect=="function")return j.inspect()}if(isMap$3(j)){var or=[];return mapForEach&&mapForEach.call(j,function(hn,cn){or.push(zt(cn,j,!0)+" => "+zt(hn,j))}),collectionOf("Map",mapSize.call(j),or,Vt)}if(isSet$3(j)){var ar=[];return setForEach&&setForEach.call(j,function(hn){ar.push(zt(hn,j))}),collectionOf("Set",setSize.call(j),ar,Vt)}if(isWeakMap$1(j))return weakCollectionOf("WeakMap");if(isWeakSet$1(j))return weakCollectionOf("WeakSet");if(isWeakRef(j))return weakCollectionOf("WeakRef");if(isNumber$1(j))return markBoxed(zt(Number(j)));if(isBigInt$1(j))return markBoxed(zt(bigIntValueOf$1.call(j)));if(isBoolean$1(j))return markBoxed(booleanValueOf.call(j));if(isString$3(j))return markBoxed(zt(String(j)));if(!isDate$1(j)&&!isRegExp(j)){var Wt=arrObjKeys(j,zt),Zt=gPO$1?gPO$1(j)===Object.prototype:j instanceof Object||j.constructor===Object,sr=j instanceof Object?"":"null prototype",tr=!Zt&&toStringTag&&Object(j)===j&&toStringTag in j?$slice$2.call(toStr$6(j),8,-1):sr?"Object":"",vr=Zt||typeof j.constructor!="function"?"":j.constructor.name?j.constructor.name+" ":"",Vr=vr+(tr||sr?"["+$join.call($concat.call([],tr||[],sr||[]),": ")+"] ":"");return Wt.length===0?Vr+"{}":Vt?Vr+"{"+indentedJoin(Wt,Vt)+"}":Vr+"{ "+$join.call(Wt,", ")+" }"}return String(j)};function wrapQuotes($,j,it){var et=(it.quoteStyle||j)==="double"?'"':"'";return et+$+et}function quote($){return $replace.call(String($),/"/g,"&quot;")}function isArray$2($){return toStr$6($)==="[object Array]"&&(!toStringTag||!(typeof $=="object"&&toStringTag in $))}function isDate$1($){return toStr$6($)==="[object Date]"&&(!toStringTag||!(typeof $=="object"&&toStringTag in $))}function isRegExp($){return toStr$6($)==="[object RegExp]"&&(!toStringTag||!(typeof $=="object"&&toStringTag in $))}function isError($){return toStr$6($)==="[object Error]"&&(!toStringTag||!(typeof $=="object"&&toStringTag in $))}function isString$3($){return toStr$6($)==="[object String]"&&(!toStringTag||!(typeof $=="object"&&toStringTag in $))}function isNumber$1($){return toStr$6($)==="[object Number]"&&(!toStringTag||!(typeof $=="object"&&toStringTag in $))}function isBoolean$1($){return toStr$6($)==="[object Boolean]"&&(!toStringTag||!(typeof $=="object"&&toStringTag in $))}function isSymbol$2($){if(hasShammedSymbols)return $&&typeof $=="object"&&$ instanceof Symbol;if(typeof $=="symbol")return!0;if(!$||typeof $!="object"||!symToString)return!1;try{return symToString.call($),!0}catch{}return!1}function isBigInt$1($){if(!$||typeof $!="object"||!bigIntValueOf$1)return!1;try{return bigIntValueOf$1.call($),!0}catch{}return!1}var hasOwn=Object.prototype.hasOwnProperty||function($){return $ in this};function has$2($,j){return hasOwn.call($,j)}function toStr$6($){return objectToString.call($)}function nameOf($){if($.name)return $.name;var j=$match.call(functionToString.call($),/^function\s*([\w$]+)/);return j?j[1]:null}function indexOf($,j){if($.indexOf)return $.indexOf(j);for(var it=0,et=$.length;it<et;it++)if($[it]===j)return it;return-1}function isMap$3($){if(!mapSize||!$||typeof $!="object")return!1;try{mapSize.call($);try{setSize.call($)}catch{return!0}return $ instanceof Map}catch{}return!1}function isWeakMap$1($){if(!weakMapHas||!$||typeof $!="object")return!1;try{weakMapHas.call($,weakMapHas);try{weakSetHas.call($,weakSetHas)}catch{return!0}return $ instanceof WeakMap}catch{}return!1}function isWeakRef($){if(!weakRefDeref||!$||typeof $!="object")return!1;try{return weakRefDeref.call($),!0}catch{}return!1}function isSet$3($){if(!setSize||!$||typeof $!="object")return!1;try{setSize.call($);try{mapSize.call($)}catch{return!0}return $ instanceof Set}catch{}return!1}function isWeakSet$1($){if(!weakSetHas||!$||typeof $!="object")return!1;try{weakSetHas.call($,weakSetHas);try{weakMapHas.call($,weakMapHas)}catch{return!0}return $ instanceof WeakSet}catch{}return!1}function isElement($){return!$||typeof $!="object"?!1:typeof HTMLElement<"u"&&$ instanceof HTMLElement?!0:typeof $.nodeName=="string"&&typeof $.getAttribute=="function"}function inspectString($,j){if($.length>j.maxStringLength){var it=$.length-j.maxStringLength,et="... "+it+" more character"+(it>1?"s":"");return inspectString($slice$2.call($,0,j.maxStringLength),j)+et}var ut=$replace.call($replace.call($,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,lowbyte);return wrapQuotes(ut,"single",j)}function lowbyte($){var j=$.charCodeAt(0),it={8:"b",9:"t",10:"n",12:"f",13:"r"}[j];return it?"\\"+it:"\\x"+(j<16?"0":"")+$toUpperCase.call(j.toString(16))}function markBoxed($){return"Object("+$+")"}function weakCollectionOf($){return $+" { ? }"}function collectionOf($,j,it,et){var ut=et?indentedJoin(it,et):$join.call(it,", ");return $+" ("+j+") {"+ut+"}"}function singleLineValues($){for(var j=0;j<$.length;j++)if(indexOf($[j],`
`)>=0)return!1;return!0}function getIndent($,j){var it;if($.indent==="	")it="	";else if(typeof $.indent=="number"&&$.indent>0)it=$join.call(Array($.indent+1)," ");else return null;return{base:it,prev:$join.call(Array(j+1),it)}}function indentedJoin($,j){if($.length===0)return"";var it=`
`+j.prev+j.base;return it+$join.call($,","+it)+`
`+j.prev}function arrObjKeys($,j){var it=isArray$2($),et=[];if(it){et.length=$.length;for(var ut=0;ut<$.length;ut++)et[ut]=has$2($,ut)?j($[ut],$):""}var dt=typeof gOPS=="function"?gOPS($):[],mt;if(hasShammedSymbols){mt={};for(var yt=0;yt<dt.length;yt++)mt["$"+dt[yt]]=dt[yt]}for(var bt in $)has$2($,bt)&&(it&&String(Number(bt))===bt&&bt<$.length||hasShammedSymbols&&mt["$"+bt]instanceof Symbol||($test.call(/[^\w$]/,bt)?et.push(j(bt,$)+": "+j($[bt],$)):et.push(bt+": "+j($[bt],$))));if(typeof gOPS=="function")for(var Rt=0;Rt<dt.length;Rt++)isEnumerable.call($,dt[Rt])&&et.push("["+j(dt[Rt])+"]: "+j($[dt[Rt]],$));return et}var GetIntrinsic$6=getIntrinsic,callBound$9=callBound$c,inspect=objectInspect,$TypeError$1=GetIntrinsic$6("%TypeError%"),$WeakMap$1=GetIntrinsic$6("%WeakMap%",!0),$Map$3=GetIntrinsic$6("%Map%",!0),$weakMapGet=callBound$9("WeakMap.prototype.get",!0),$weakMapSet=callBound$9("WeakMap.prototype.set",!0),$weakMapHas=callBound$9("WeakMap.prototype.has",!0),$mapGet$1=callBound$9("Map.prototype.get",!0),$mapSet=callBound$9("Map.prototype.set",!0),$mapHas$5=callBound$9("Map.prototype.has",!0),listGetNode=function($,j){for(var it=$,et;(et=it.next)!==null;it=et)if(et.key===j)return it.next=et.next,et.next=$.next,$.next=et,et},listGet=function($,j){var it=listGetNode($,j);return it&&it.value},listSet=function($,j,it){var et=listGetNode($,j);et?et.value=it:$.next={key:j,next:$.next,value:it}},listHas=function($,j){return!!listGetNode($,j)},sideChannel=function $(){var j,it,et,ut={assert:function(dt){if(!ut.has(dt))throw new $TypeError$1("Side channel does not contain "+inspect(dt))},get:function(dt){if($WeakMap$1&&dt&&(typeof dt=="object"||typeof dt=="function")){if(j)return $weakMapGet(j,dt)}else if($Map$3){if(it)return $mapGet$1(it,dt)}else if(et)return listGet(et,dt)},has:function(dt){if($WeakMap$1&&dt&&(typeof dt=="object"||typeof dt=="function")){if(j)return $weakMapHas(j,dt)}else if($Map$3){if(it)return $mapHas$5(it,dt)}else if(et)return listHas(et,dt);return!1},set:function(dt,mt){$WeakMap$1&&dt&&(typeof dt=="object"||typeof dt=="function")?(j||(j=new $WeakMap$1),$weakMapSet(j,dt,mt)):$Map$3?(it||(it=new $Map$3),$mapSet(it,dt,mt)):(et||(et={key:{},next:null}),listSet(et,dt,mt))}};return ut},GetIntrinsic$5=getIntrinsic,has$1=src,channel=sideChannel(),$TypeError=GetIntrinsic$5("%TypeError%"),SLOT$1={assert:function($,j){if(!$||typeof $!="object"&&typeof $!="function")throw new $TypeError("`O` is not an object");if(typeof j!="string")throw new $TypeError("`slot` must be a string");if(channel.assert($),!SLOT$1.has($,j))throw new $TypeError("`"+j+"` is not present on `O`")},get:function($,j){if(!$||typeof $!="object"&&typeof $!="function")throw new $TypeError("`O` is not an object");if(typeof j!="string")throw new $TypeError("`slot` must be a string");var it=channel.get($);return it&&it["$"+j]},has:function($,j){if(!$||typeof $!="object"&&typeof $!="function")throw new $TypeError("`O` is not an object");if(typeof j!="string")throw new $TypeError("`slot` must be a string");var it=channel.get($);return!!it&&has$1(it,"$"+j)},set:function($,j,it){if(!$||typeof $!="object"&&typeof $!="function")throw new $TypeError("`O` is not an object");if(typeof j!="string")throw new $TypeError("`slot` must be a string");var et=channel.get($);et||(et={},channel.set($,et)),et["$"+j]=it}};Object.freeze&&Object.freeze(SLOT$1);var internalSlot=SLOT$1,SLOT=internalSlot,$SyntaxError=SyntaxError,$StopIteration=typeof StopIteration=="object"?StopIteration:null,stopIterationIterator=function $(j){if(!$StopIteration)throw new $SyntaxError("this environment lacks StopIteration");SLOT.set(j,"[[Done]]",!1);var it={next:function(){var ut=SLOT.get(this,"[[Iterator]]"),dt=SLOT.get(ut,"[[Done]]");try{return{done:dt,value:dt?void 0:ut.next()}}catch(mt){if(SLOT.set(ut,"[[Done]]",!0),mt!==$StopIteration)throw mt;return{done:!0,value:void 0}}}};return SLOT.set(it,"[[Iterator]]",j),it},toString={}.toString,isarray=Array.isArray||function($){return toString.call($)=="[object Array]"},strValue=String.prototype.valueOf,tryStringObject=function $(j){try{return strValue.call(j),!0}catch{return!1}},toStr$5=Object.prototype.toString,strClass="[object String]",hasToStringTag$7=shams(),isString$2=function $(j){return typeof j=="string"?!0:typeof j!="object"?!1:hasToStringTag$7?tryStringObject(j):toStr$5.call(j)===strClass},$Map$2=typeof Map=="function"&&Map.prototype?Map:null,$Set$3=typeof Set=="function"&&Set.prototype?Set:null,exported$2;$Map$2||(exported$2=function(j){return!1});var $mapHas$4=$Map$2?Map.prototype.has:null,$setHas$4=$Set$3?Set.prototype.has:null;!exported$2&&!$mapHas$4&&(exported$2=function(j){return!1});var isMap$2=exported$2||function $(j){if(!j||typeof j!="object")return!1;try{if($mapHas$4.call(j),$setHas$4)try{$setHas$4.call(j)}catch{return!0}return j instanceof $Map$2}catch{}return!1},$Map$1=typeof Map=="function"&&Map.prototype?Map:null,$Set$2=typeof Set=="function"&&Set.prototype?Set:null,exported$1;$Set$2||(exported$1=function(j){return!1});var $mapHas$3=$Map$1?Map.prototype.has:null,$setHas$3=$Set$2?Set.prototype.has:null;!exported$1&&!$setHas$3&&(exported$1=function(j){return!1});var isSet$2=exported$1||function $(j){if(!j||typeof j!="object")return!1;try{if($setHas$3.call(j),$mapHas$3)try{$mapHas$3.call(j)}catch{return!0}return j instanceof $Set$2}catch{}return!1},isArguments$1=isArguments$2,getStopIterationIterator=stopIterationIterator;if(hasSymbols$5()||shams$1()){var $iterator=Symbol.iterator;esGetIterator.exports=function(j){if(j!=null&&typeof j[$iterator]<"u")return j[$iterator]();if(isArguments$1(j))return Array.prototype[$iterator].call(j)}}else{var isArray$1=isarray,isString$1=isString$2,GetIntrinsic$4=getIntrinsic,$Map=GetIntrinsic$4("%Map%",!0),$Set$1=GetIntrinsic$4("%Set%",!0),callBound$8=callBound$c,$arrayPush=callBound$8("Array.prototype.push"),$charCodeAt=callBound$8("String.prototype.charCodeAt"),$stringSlice=callBound$8("String.prototype.slice"),advanceStringIndex=function(j,it){var et=j.length;if(it+1>=et)return it+1;var ut=$charCodeAt(j,it);if(ut<55296||ut>56319)return it+1;var dt=$charCodeAt(j,it+1);return dt<56320||dt>57343?it+1:it+2},getArrayIterator=function(j){var it=0;return{next:function(){var ut=it>=j.length,dt;return ut||(dt=j[it],it+=1),{done:ut,value:dt}}}},getNonCollectionIterator=function(j,it){if(isArray$1(j)||isArguments$1(j))return getArrayIterator(j);if(isString$1(j)){var et=0;return{next:function(){var dt=advanceStringIndex(j,et),mt=$stringSlice(j,et,dt);return et=dt,{done:dt>j.length,value:mt}}}}if(it&&typeof j["_es6-shim iterator_"]<"u")return j["_es6-shim iterator_"]()};if(!$Map&&!$Set$1)esGetIterator.exports=function(j){if(j!=null)return getNonCollectionIterator(j,!0)};else{var isMap$1=isMap$2,isSet$1=isSet$2,$mapForEach=callBound$8("Map.prototype.forEach",!0),$setForEach=callBound$8("Set.prototype.forEach",!0);if(typeof process>"u"||!process.versions||!process.versions.node)var $mapIterator=callBound$8("Map.prototype.iterator",!0),$setIterator=callBound$8("Set.prototype.iterator",!0);var $mapAtAtIterator=callBound$8("Map.prototype.@@iterator",!0)||callBound$8("Map.prototype._es6-shim iterator_",!0),$setAtAtIterator=callBound$8("Set.prototype.@@iterator",!0)||callBound$8("Set.prototype._es6-shim iterator_",!0),getCollectionIterator=function(j){if(isMap$1(j)){if($mapIterator)return getStopIterationIterator($mapIterator(j));if($mapAtAtIterator)return $mapAtAtIterator(j);if($mapForEach){var it=[];return $mapForEach(j,function(ut,dt){$arrayPush(it,[dt,ut])}),getArrayIterator(it)}}if(isSet$1(j)){if($setIterator)return getStopIterationIterator($setIterator(j));if($setAtAtIterator)return $setAtAtIterator(j);if($setForEach){var et=[];return $setForEach(j,function(ut){$arrayPush(et,ut)}),getArrayIterator(et)}}};esGetIterator.exports=function(j){return getCollectionIterator(j)||getNonCollectionIterator(j)}}}var esGetIteratorExports=esGetIterator.exports,numberIsNaN=function($){return $!==$},implementation$2=function $(j,it){return j===0&&it===0?1/j===1/it:!!(j===it||numberIsNaN(j)&&numberIsNaN(it))},implementation$1=implementation$2,polyfill$1=function $(){return typeof Object.is=="function"?Object.is:implementation$1},getPolyfill$1=polyfill$1,define$1=defineProperties_1,shim$1=function $(){var j=getPolyfill$1();return define$1(Object,{is:j},{is:function(){return Object.is!==j}}),j},define=defineProperties_1,callBind$1=callBindExports,implementation=implementation$2,getPolyfill=polyfill$1,shim=shim$1,polyfill=callBind$1(getPolyfill(),Object);define(polyfill,{getPolyfill,implementation,shim});var objectIs=polyfill,fnToStr=Function.prototype.toString,reflectApply=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,badArrayLike,isCallableMarker;if(typeof reflectApply=="function"&&typeof Object.defineProperty=="function")try{badArrayLike=Object.defineProperty({},"length",{get:function(){throw isCallableMarker}}),isCallableMarker={},reflectApply(function(){throw 42},null,badArrayLike)}catch($){$!==isCallableMarker&&(reflectApply=null)}else reflectApply=null;var constructorRegex=/^\s*class\b/,isES6ClassFn=function $(j){try{var it=fnToStr.call(j);return constructorRegex.test(it)}catch{return!1}},tryFunctionObject=function $(j){try{return isES6ClassFn(j)?!1:(fnToStr.call(j),!0)}catch{return!1}},toStr$4=Object.prototype.toString,objectClass="[object Object]",fnClass="[object Function]",genClass="[object GeneratorFunction]",ddaClass="[object HTMLAllCollection]",ddaClass2="[object HTML document.all class]",ddaClass3="[object HTMLCollection]",hasToStringTag$6=typeof Symbol=="function"&&!!Symbol.toStringTag,isIE68=!(0 in[,]),isDDA=function $(){return!1};if(typeof document=="object"){var all=document.all;toStr$4.call(all)===toStr$4.call(document.all)&&(isDDA=function(j){if((isIE68||!j)&&(typeof j>"u"||typeof j=="object"))try{var it=toStr$4.call(j);return(it===ddaClass||it===ddaClass2||it===ddaClass3||it===objectClass)&&j("")==null}catch{}return!1})}var isCallable$1=reflectApply?function $(j){if(isDDA(j))return!0;if(!j||typeof j!="function"&&typeof j!="object")return!1;try{reflectApply(j,null,badArrayLike)}catch(it){if(it!==isCallableMarker)return!1}return!isES6ClassFn(j)&&tryFunctionObject(j)}:function $(j){if(isDDA(j))return!0;if(!j||typeof j!="function"&&typeof j!="object")return!1;if(hasToStringTag$6)return tryFunctionObject(j);if(isES6ClassFn(j))return!1;var it=toStr$4.call(j);return it!==fnClass&&it!==genClass&&!/^\[object HTML/.test(it)?!1:tryFunctionObject(j)},isCallable=isCallable$1,toStr$3=Object.prototype.toString,hasOwnProperty=Object.prototype.hasOwnProperty,forEachArray=function $(j,it,et){for(var ut=0,dt=j.length;ut<dt;ut++)hasOwnProperty.call(j,ut)&&(et==null?it(j[ut],ut,j):it.call(et,j[ut],ut,j))},forEachString=function $(j,it,et){for(var ut=0,dt=j.length;ut<dt;ut++)et==null?it(j.charAt(ut),ut,j):it.call(et,j.charAt(ut),ut,j)},forEachObject=function $(j,it,et){for(var ut in j)hasOwnProperty.call(j,ut)&&(et==null?it(j[ut],ut,j):it.call(et,j[ut],ut,j))},forEach$2=function $(j,it,et){if(!isCallable(it))throw new TypeError("iterator must be a function");var ut;arguments.length>=3&&(ut=et),toStr$3.call(j)==="[object Array]"?forEachArray(j,it,ut):typeof j=="string"?forEachString(j,it,ut):forEachObject(j,it,ut)},forEach_1=forEach$2,possibleNames=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],g$2=typeof globalThis>"u"?commonjsGlobal:globalThis,availableTypedArrays$2=function $(){for(var j=[],it=0;it<possibleNames.length;it++)typeof g$2[possibleNames[it]]=="function"&&(j[j.length]=possibleNames[it]);return j},GetIntrinsic$3=getIntrinsic,$gOPD=GetIntrinsic$3("%Object.getOwnPropertyDescriptor%",!0);if($gOPD)try{$gOPD([],"length")}catch{$gOPD=null}var gopd=$gOPD,forEach$1=forEach_1,availableTypedArrays$1=availableTypedArrays$2,callBound$7=callBound$c,$toString$3=callBound$7("Object.prototype.toString"),hasToStringTag$5=shams(),gOPD$2=gopd,g$1=typeof globalThis>"u"?commonjsGlobal:globalThis,typedArrays$1=availableTypedArrays$1(),$indexOf=callBound$7("Array.prototype.indexOf",!0)||function $(j,it){for(var et=0;et<j.length;et+=1)if(j[et]===it)return et;return-1},$slice$1=callBound$7("String.prototype.slice"),toStrTags$1={},getPrototypeOf$1=Object.getPrototypeOf;hasToStringTag$5&&gOPD$2&&getPrototypeOf$1&&forEach$1(typedArrays$1,function($){var j=new g$1[$];if(Symbol.toStringTag in j){var it=getPrototypeOf$1(j),et=gOPD$2(it,Symbol.toStringTag);if(!et){var ut=getPrototypeOf$1(it);et=gOPD$2(ut,Symbol.toStringTag)}toStrTags$1[$]=et.get}});var tryTypedArrays$1=function $(j){var it=!1;return forEach$1(toStrTags$1,function(et,ut){if(!it)try{it=et.call(j)===ut}catch{}}),it},isTypedArray$2=function $(j){if(!j||typeof j!="object")return!1;if(!hasToStringTag$5||!(Symbol.toStringTag in j)){var it=$slice$1($toString$3(j),8,-1);return $indexOf(typedArrays$1,it)>-1}return gOPD$2?tryTypedArrays$1(j):!1},callBind=callBindExports,callBound$6=callBound$c,GetIntrinsic$2=getIntrinsic,isTypedArray$1=isTypedArray$2,$ArrayBuffer=GetIntrinsic$2("ArrayBuffer",!0),$Float32Array=GetIntrinsic$2("Float32Array",!0),$byteLength$1=callBound$6("ArrayBuffer.prototype.byteLength",!0),abSlice=$ArrayBuffer&&!$byteLength$1&&new $ArrayBuffer().slice,$abSlice=abSlice&&callBind(abSlice),isArrayBuffer$1=$byteLength$1||$abSlice?function $(j){if(!j||typeof j!="object")return!1;try{return $byteLength$1?$byteLength$1(j):$abSlice(j,0),!0}catch{return!1}}:$Float32Array?function $(j){try{return new $Float32Array(j).buffer===j&&!isTypedArray$1(j)}catch(it){return typeof j=="object"&&it.name==="RangeError"}}:function $(j){return!1},getDay=Date.prototype.getDay,tryDateObject=function $(j){try{return getDay.call(j),!0}catch{return!1}},toStr$2=Object.prototype.toString,dateClass="[object Date]",hasToStringTag$4=shams(),isDateObject=function $(j){return typeof j!="object"||j===null?!1:hasToStringTag$4?tryDateObject(j):toStr$2.call(j)===dateClass},callBound$5=callBound$c,hasToStringTag$3=shams(),has,$exec,isRegexMarker,badStringifier;if(hasToStringTag$3){has=callBound$5("Object.prototype.hasOwnProperty"),$exec=callBound$5("RegExp.prototype.exec"),isRegexMarker={};var throwRegexMarker=function(){throw isRegexMarker};badStringifier={toString:throwRegexMarker,valueOf:throwRegexMarker},typeof Symbol.toPrimitive=="symbol"&&(badStringifier[Symbol.toPrimitive]=throwRegexMarker)}var $toString$2=callBound$5("Object.prototype.toString"),gOPD$1=Object.getOwnPropertyDescriptor,regexClass="[object RegExp]",isRegex$1=hasToStringTag$3?function $(j){if(!j||typeof j!="object")return!1;var it=gOPD$1(j,"lastIndex"),et=it&&has(it,"value");if(!et)return!1;try{$exec(j,badStringifier)}catch(ut){return ut===isRegexMarker}}:function $(j){return!j||typeof j!="object"&&typeof j!="function"?!1:$toString$2(j)===regexClass},callBound$4=callBound$c,$byteLength=callBound$4("SharedArrayBuffer.prototype.byteLength",!0),isSharedArrayBuffer$1=$byteLength?function $(j){if(!j||typeof j!="object")return!1;try{return $byteLength(j),!0}catch{return!1}}:function $(j){return!1},numToStr=Number.prototype.toString,tryNumberObject=function $(j){try{return numToStr.call(j),!0}catch{return!1}},toStr$1=Object.prototype.toString,numClass="[object Number]",hasToStringTag$2=shams(),isNumberObject=function $(j){return typeof j=="number"?!0:typeof j!="object"?!1:hasToStringTag$2?tryNumberObject(j):toStr$1.call(j)===numClass},callBound$3=callBound$c,$boolToStr=callBound$3("Boolean.prototype.toString"),$toString$1=callBound$3("Object.prototype.toString"),tryBooleanObject=function $(j){try{return $boolToStr(j),!0}catch{return!1}},boolClass="[object Boolean]",hasToStringTag$1=shams(),isBooleanObject=function $(j){return typeof j=="boolean"?!0:j===null||typeof j!="object"?!1:hasToStringTag$1&&Symbol.toStringTag in j?tryBooleanObject(j):$toString$1(j)===boolClass},isSymbol$1={exports:{}},toStr=Object.prototype.toString,hasSymbols=hasSymbols$5();if(hasSymbols){var symToStr=Symbol.prototype.toString,symStringRegex=/^Symbol\(.*\)$/,isSymbolObject=function(j){return typeof j.valueOf()!="symbol"?!1:symStringRegex.test(symToStr.call(j))};isSymbol$1.exports=function(j){if(typeof j=="symbol")return!0;if(toStr.call(j)!=="[object Symbol]")return!1;try{return isSymbolObject(j)}catch{return!1}}}else isSymbol$1.exports=function(j){return!1};var isSymbolExports=isSymbol$1.exports,isBigint={exports:{}},$BigInt=typeof BigInt<"u"&&BigInt,hasBigints=function $(){return typeof $BigInt=="function"&&typeof BigInt=="function"&&typeof $BigInt(42)=="bigint"&&typeof BigInt(42)=="bigint"},hasBigInts=hasBigints();if(hasBigInts){var bigIntValueOf=BigInt.prototype.valueOf,tryBigInt=function(j){try{return bigIntValueOf.call(j),!0}catch{}return!1};isBigint.exports=function(j){return j===null||typeof j>"u"||typeof j=="boolean"||typeof j=="string"||typeof j=="number"||typeof j=="symbol"||typeof j=="function"?!1:typeof j=="bigint"?!0:tryBigInt(j)}}else isBigint.exports=function(j){return!1};var isBigintExports=isBigint.exports,isString=isString$2,isNumber=isNumberObject,isBoolean=isBooleanObject,isSymbol=isSymbolExports,isBigInt=isBigintExports,whichBoxedPrimitive$1=function $(j){if(j==null||typeof j!="object"&&typeof j!="function")return null;if(isString(j))return"String";if(isNumber(j))return"Number";if(isBoolean(j))return"Boolean";if(isSymbol(j))return"Symbol";if(isBigInt(j))return"BigInt"},$WeakMap=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,$WeakSet$1=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null,exported;$WeakMap||(exported=function(j){return!1});var $mapHas$2=$WeakMap?$WeakMap.prototype.has:null,$setHas$2=$WeakSet$1?$WeakSet$1.prototype.has:null;!exported&&!$mapHas$2&&(exported=function(j){return!1});var isWeakmap=exported||function $(j){if(!j||typeof j!="object")return!1;try{if($mapHas$2.call(j,$mapHas$2),$setHas$2)try{$setHas$2.call(j,$setHas$2)}catch{return!0}return j instanceof $WeakMap}catch{}return!1},isWeakset={exports:{}},GetIntrinsic$1=getIntrinsic,callBound$2=callBound$c,$WeakSet=GetIntrinsic$1("%WeakSet%",!0),$setHas$1=callBound$2("WeakSet.prototype.has",!0);if($setHas$1){var $mapHas$1=callBound$2("WeakMap.prototype.has",!0);isWeakset.exports=function(j){if(!j||typeof j!="object")return!1;try{if($setHas$1(j,$setHas$1),$mapHas$1)try{$mapHas$1(j,$mapHas$1)}catch{return!0}return j instanceof $WeakSet}catch{}return!1}}else isWeakset.exports=function(j){return!1};var isWeaksetExports=isWeakset.exports,isMap=isMap$2,isSet=isSet$2,isWeakMap=isWeakmap,isWeakSet=isWeaksetExports,whichCollection$1=function $(j){if(j&&typeof j=="object"){if(isMap(j))return"Map";if(isSet(j))return"Set";if(isWeakMap(j))return"WeakMap";if(isWeakSet(j))return"WeakSet"}return!1},forEach=forEach_1,availableTypedArrays=availableTypedArrays$2,callBound$1=callBound$c,gOPD=gopd,$toString=callBound$1("Object.prototype.toString"),hasToStringTag=shams(),g=typeof globalThis>"u"?commonjsGlobal:globalThis,typedArrays=availableTypedArrays(),$slice=callBound$1("String.prototype.slice"),toStrTags={},getPrototypeOf=Object.getPrototypeOf;hasToStringTag&&gOPD&&getPrototypeOf&&forEach(typedArrays,function($){if(typeof g[$]=="function"){var j=new g[$];if(Symbol.toStringTag in j){var it=getPrototypeOf(j),et=gOPD(it,Symbol.toStringTag);if(!et){var ut=getPrototypeOf(it);et=gOPD(ut,Symbol.toStringTag)}toStrTags[$]=et.get}}});var tryTypedArrays=function $(j){var it=!1;return forEach(toStrTags,function(et,ut){if(!it)try{var dt=et.call(j);dt===ut&&(it=dt)}catch{}}),it},isTypedArray=isTypedArray$2,whichTypedArray$1=function $(j){return isTypedArray(j)?!hasToStringTag||!(Symbol.toStringTag in j)?$slice($toString(j),8,-1):tryTypedArrays(j):!1},assign=object_assign,callBound=callBound$c,flags=regexp_prototype_flags,GetIntrinsic=getIntrinsic,getIterator=esGetIteratorExports,getSideChannel=sideChannel,is=objectIs,isArguments=isArguments$2,isArray=isarray,isArrayBuffer=isArrayBuffer$1,isDate=isDateObject,isRegex=isRegex$1,isSharedArrayBuffer=isSharedArrayBuffer$1,objectKeys=objectKeys$2,whichBoxedPrimitive=whichBoxedPrimitive$1,whichCollection=whichCollection$1,whichTypedArray=whichTypedArray$1,byteLength=callBound("ArrayBuffer.prototype.byteLength",!0)||function $(j){return j.byteLength},sabByteLength=callBound("SharedArrayBuffer.prototype.byteLength",!0),$getTime=callBound("Date.prototype.getTime"),gPO=Object.getPrototypeOf,$objToString=callBound("Object.prototype.toString"),$Set=GetIntrinsic("%Set%",!0),$mapHas=callBound("Map.prototype.has",!0),$mapGet=callBound("Map.prototype.get",!0),$mapSize=callBound("Map.prototype.size",!0),$setAdd=callBound("Set.prototype.add",!0),$setDelete=callBound("Set.prototype.delete",!0),$setHas=callBound("Set.prototype.has",!0),$setSize=callBound("Set.prototype.size",!0);function setHasEqualElement($,j,it,et){for(var ut=getIterator($),dt;(dt=ut.next())&&!dt.done;)if(internalDeepEqual(j,dt.value,it,et))return $setDelete($,dt.value),!0;return!1}function findLooseMatchingPrimitives($){if(typeof $>"u")return null;if(typeof $!="object")return typeof $=="symbol"?!1:typeof $=="string"||typeof $=="number"?+$==+$:!0}function mapMightHaveLoosePrim($,j,it,et,ut,dt){var mt=findLooseMatchingPrimitives(it);if(mt!=null)return mt;var yt=$mapGet(j,mt),bt=assign({},ut,{strict:!1});return typeof yt>"u"&&!$mapHas(j,mt)||!internalDeepEqual(et,yt,bt,dt)?!1:!$mapHas($,mt)&&internalDeepEqual(et,yt,bt,dt)}function setMightHaveLoosePrim($,j,it){var et=findLooseMatchingPrimitives(it);return et??($setHas(j,et)&&!$setHas($,et))}function mapHasEqualEntry($,j,it,et,ut,dt){for(var mt=getIterator($),yt,bt;(yt=mt.next())&&!yt.done;)if(bt=yt.value,internalDeepEqual(it,bt,ut,dt)&&internalDeepEqual(et,$mapGet(j,bt),ut,dt))return $setDelete($,bt),!0;return!1}function internalDeepEqual($,j,it,et){var ut=it||{};if(ut.strict?is($,j):$===j)return!0;var dt=whichBoxedPrimitive($),mt=whichBoxedPrimitive(j);if(dt!==mt)return!1;if(!$||!j||typeof $!="object"&&typeof j!="object")return ut.strict?is($,j):$==j;var yt=et.has($),bt=et.has(j),Rt;if(yt&&bt){if(et.get($)===et.get(j))return!0}else Rt={};return yt||et.set($,Rt),bt||et.set(j,Rt),objEquiv($,j,ut,et)}function isBuffer($){return!$||typeof $!="object"||typeof $.length!="number"||typeof $.copy!="function"||typeof $.slice!="function"||$.length>0&&typeof $[0]!="number"?!1:!!($.constructor&&$.constructor.isBuffer&&$.constructor.isBuffer($))}function setEquiv($,j,it,et){if($setSize($)!==$setSize(j))return!1;for(var ut=getIterator($),dt=getIterator(j),mt,yt,bt;(mt=ut.next())&&!mt.done;)if(mt.value&&typeof mt.value=="object")bt||(bt=new $Set),$setAdd(bt,mt.value);else if(!$setHas(j,mt.value)){if(it.strict||!setMightHaveLoosePrim($,j,mt.value))return!1;bt||(bt=new $Set),$setAdd(bt,mt.value)}if(bt){for(;(yt=dt.next())&&!yt.done;)if(yt.value&&typeof yt.value=="object"){if(!setHasEqualElement(bt,yt.value,it.strict,et))return!1}else if(!it.strict&&!$setHas($,yt.value)&&!setHasEqualElement(bt,yt.value,it.strict,et))return!1;return $setSize(bt)===0}return!0}function mapEquiv($,j,it,et){if($mapSize($)!==$mapSize(j))return!1;for(var ut=getIterator($),dt=getIterator(j),mt,yt,bt,Rt,jt,Vt;(mt=ut.next())&&!mt.done;)if(Rt=mt.value[0],jt=mt.value[1],Rt&&typeof Rt=="object")bt||(bt=new $Set),$setAdd(bt,Rt);else if(Vt=$mapGet(j,Rt),typeof Vt>"u"&&!$mapHas(j,Rt)||!internalDeepEqual(jt,Vt,it,et)){if(it.strict||!mapMightHaveLoosePrim($,j,Rt,jt,it,et))return!1;bt||(bt=new $Set),$setAdd(bt,Rt)}if(bt){for(;(yt=dt.next())&&!yt.done;)if(Rt=yt.value[0],Vt=yt.value[1],Rt&&typeof Rt=="object"){if(!mapHasEqualEntry(bt,$,Rt,Vt,it,et))return!1}else if(!it.strict&&(!$.has(Rt)||!internalDeepEqual($mapGet($,Rt),Vt,it,et))&&!mapHasEqualEntry(bt,$,Rt,Vt,assign({},it,{strict:!1}),et))return!1;return $setSize(bt)===0}return!0}function objEquiv($,j,it,et){var ut,dt;if(typeof $!=typeof j||$==null||j==null||$objToString($)!==$objToString(j)||isArguments($)!==isArguments(j))return!1;var mt=isArray($),yt=isArray(j);if(mt!==yt)return!1;var bt=$ instanceof Error,Rt=j instanceof Error;if(bt!==Rt||(bt||Rt)&&($.name!==j.name||$.message!==j.message))return!1;var jt=isRegex($),Vt=isRegex(j);if(jt!==Vt||(jt||Vt)&&($.source!==j.source||flags($)!==flags(j)))return!1;var zt=isDate($),Jt=isDate(j);if(zt!==Jt||(zt||Jt)&&$getTime($)!==$getTime(j)||it.strict&&gPO&&gPO($)!==gPO(j))return!1;var rr=whichTypedArray($),Yt=whichTypedArray(j);if((rr||Yt)&&rr!==Yt)return!1;var dr=isBuffer($),Ft=isBuffer(j);if(dr!==Ft)return!1;if(dr||Ft){if($.length!==j.length)return!1;for(ut=0;ut<$.length;ut++)if($[ut]!==j[ut])return!1;return!0}var Ht=isArrayBuffer($),er=isArrayBuffer(j);if(Ht!==er)return!1;if(Ht||er)return byteLength($)!==byteLength(j)?!1:typeof Uint8Array=="function"&&internalDeepEqual(new Uint8Array($),new Uint8Array(j),it,et);var pr=isSharedArrayBuffer($),or=isSharedArrayBuffer(j);if(pr!==or)return!1;if(pr||or)return sabByteLength($)!==sabByteLength(j)?!1:typeof Uint8Array=="function"&&internalDeepEqual(new Uint8Array($),new Uint8Array(j),it,et);if(typeof $!=typeof j)return!1;var ar=objectKeys($),Wt=objectKeys(j);if(ar.length!==Wt.length)return!1;for(ar.sort(),Wt.sort(),ut=ar.length-1;ut>=0;ut--)if(ar[ut]!=Wt[ut])return!1;for(ut=ar.length-1;ut>=0;ut--)if(dt=ar[ut],!internalDeepEqual($[dt],j[dt],it,et))return!1;var Zt=whichCollection($),sr=whichCollection(j);return Zt!==sr?!1:Zt==="Set"||sr==="Set"?setEquiv($,j,it,et):Zt==="Map"?mapEquiv($,j,it,et):!0}var deepEqual=function $(j,it,et){return internalDeepEqual(j,it,et,getSideChannel())};Object.defineProperty(elementRoleMap$1,"__esModule",{value:!0});elementRoleMap$1.default=void 0;var _deepEqual=_interopRequireDefault$2(deepEqual),_iterationDecorator$1=_interopRequireDefault$2(iterationDecorator$1),_rolesMap$2=_interopRequireDefault$2(rolesMap$1);function _interopRequireDefault$2($){return $&&$.__esModule?$:{default:$}}function _slicedToArray$1($,j){return _arrayWithHoles$1($)||_iterableToArrayLimit$1($,j)||_unsupportedIterableToArray$1($,j)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArrayLimit$1($,j){var it=$==null?null:typeof Symbol<"u"&&$[Symbol.iterator]||$["@@iterator"];if(it!=null){var et=[],ut=!0,dt=!1,mt,yt;try{for(it=it.call($);!(ut=(mt=it.next()).done)&&(et.push(mt.value),!(j&&et.length===j));ut=!0);}catch(bt){dt=!0,yt=bt}finally{try{!ut&&it.return!=null&&it.return()}finally{if(dt)throw yt}}return et}}function _arrayWithHoles$1($){if(Array.isArray($))return $}function _createForOfIteratorHelper$1($,j){var it=typeof Symbol<"u"&&$[Symbol.iterator]||$["@@iterator"];if(!it){if(Array.isArray($)||(it=_unsupportedIterableToArray$1($))||j&&$&&typeof $.length=="number"){it&&($=it);var et=0,ut=function(){};return{s:ut,n:function(){return et>=$.length?{done:!0}:{done:!1,value:$[et++]}},e:function(Rt){throw Rt},f:ut}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var dt=!0,mt=!1,yt;return{s:function(){it=it.call($)},n:function(){var Rt=it.next();return dt=Rt.done,Rt},e:function(Rt){mt=!0,yt=Rt},f:function(){try{!dt&&it.return!=null&&it.return()}finally{if(mt)throw yt}}}}function _unsupportedIterableToArray$1($,j){if($){if(typeof $=="string")return _arrayLikeToArray$1($,j);var it=Object.prototype.toString.call($).slice(8,-1);if(it==="Object"&&$.constructor&&(it=$.constructor.name),it==="Map"||it==="Set")return Array.from($);if(it==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(it))return _arrayLikeToArray$1($,j)}}function _arrayLikeToArray$1($,j){(j==null||j>$.length)&&(j=$.length);for(var it=0,et=new Array(j);it<j;it++)et[it]=$[it];return et}var elementRoles$1=[],keys$1=_rolesMap$2.default.keys();for(var i$1=0;i$1<keys$1.length;i$1++){var key=keys$1[i$1],role=_rolesMap$2.default.get(key);if(role)for(var concepts=[].concat(role.baseConcepts,role.relatedConcepts),k=0;k<concepts.length;k++){var relation=concepts[k];if(relation.module==="HTML"){var concept=relation.concept;concept&&function(){var $=JSON.stringify(concept),j=elementRoles$1.find(function(dt){return JSON.stringify(dt[0])===$}),it=void 0;j?it=j[1]:it=[];for(var et=!0,ut=0;ut<it.length;ut++)if(it[ut]===key){et=!1;break}et&&it.push(key),elementRoles$1.push([concept,it])}()}}}var elementRoleMap={entries:function $(){return elementRoles$1},forEach:function $(j){var it=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,et=_createForOfIteratorHelper$1(elementRoles$1),ut;try{for(et.s();!(ut=et.n()).done;){var dt=_slicedToArray$1(ut.value,2),mt=dt[0],yt=dt[1];j.call(it,yt,mt,elementRoles$1)}}catch(bt){et.e(bt)}finally{et.f()}},get:function $(j){var it=elementRoles$1.find(function(et){return(0,_deepEqual.default)(j,et[0])});return it&&it[1]},has:function $(j){return!!elementRoleMap.get(j)},keys:function $(){return elementRoles$1.map(function(j){var it=_slicedToArray$1(j,1),et=it[0];return et})},values:function $(){return elementRoles$1.map(function(j){var it=_slicedToArray$1(j,2),et=it[1];return et})}},_default$1=(0,_iterationDecorator$1.default)(elementRoleMap,elementRoleMap.entries());elementRoleMap$1.default=_default$1;var roleElementMap$1={};Object.defineProperty(roleElementMap$1,"__esModule",{value:!0});roleElementMap$1.default=void 0;var _iterationDecorator=_interopRequireDefault$1(iterationDecorator$1),_rolesMap$1=_interopRequireDefault$1(rolesMap$1);function _interopRequireDefault$1($){return $&&$.__esModule?$:{default:$}}function _slicedToArray($,j){return _arrayWithHoles($)||_iterableToArrayLimit($,j)||_unsupportedIterableToArray($,j)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArrayLimit($,j){var it=$==null?null:typeof Symbol<"u"&&$[Symbol.iterator]||$["@@iterator"];if(it!=null){var et=[],ut=!0,dt=!1,mt,yt;try{for(it=it.call($);!(ut=(mt=it.next()).done)&&(et.push(mt.value),!(j&&et.length===j));ut=!0);}catch(bt){dt=!0,yt=bt}finally{try{!ut&&it.return!=null&&it.return()}finally{if(dt)throw yt}}return et}}function _arrayWithHoles($){if(Array.isArray($))return $}function _createForOfIteratorHelper($,j){var it=typeof Symbol<"u"&&$[Symbol.iterator]||$["@@iterator"];if(!it){if(Array.isArray($)||(it=_unsupportedIterableToArray($))||j&&$&&typeof $.length=="number"){it&&($=it);var et=0,ut=function(){};return{s:ut,n:function(){return et>=$.length?{done:!0}:{done:!1,value:$[et++]}},e:function(Rt){throw Rt},f:ut}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var dt=!0,mt=!1,yt;return{s:function(){it=it.call($)},n:function(){var Rt=it.next();return dt=Rt.done,Rt},e:function(Rt){mt=!0,yt=Rt},f:function(){try{!dt&&it.return!=null&&it.return()}finally{if(mt)throw yt}}}}function _unsupportedIterableToArray($,j){if($){if(typeof $=="string")return _arrayLikeToArray($,j);var it=Object.prototype.toString.call($).slice(8,-1);if(it==="Object"&&$.constructor&&(it=$.constructor.name),it==="Map"||it==="Set")return Array.from($);if(it==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(it))return _arrayLikeToArray($,j)}}function _arrayLikeToArray($,j){(j==null||j>$.length)&&(j=$.length);for(var it=0,et=new Array(j);it<j;it++)et[it]=$[it];return et}var roleElement=[],keys=_rolesMap$1.default.keys(),_loop=function $(j){var it=keys[j],et=_rolesMap$1.default.get(it);if(et)for(var ut=[].concat(et.baseConcepts,et.relatedConcepts),dt=0;dt<ut.length;dt++){var mt=ut[dt];if(mt.module==="HTML"){var yt=mt.concept;if(yt){var bt=roleElement.find(function(jt){return jt[0]===it}),Rt=void 0;bt?Rt=bt[1]:Rt=[],Rt.push(yt),roleElement.push([it,Rt])}}}};for(var i=0;i<keys.length;i++)_loop(i);var roleElementMap={entries:function $(){return roleElement},forEach:function $(j){var it=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,et=_createForOfIteratorHelper(roleElement),ut;try{for(et.s();!(ut=et.n()).done;){var dt=_slicedToArray(ut.value,2),mt=dt[0],yt=dt[1];j.call(it,yt,mt,roleElement)}}catch(bt){et.e(bt)}finally{et.f()}},get:function $(j){var it=roleElement.find(function(et){return et[0]===j});return it&&it[1]},has:function $(j){return!!roleElementMap.get(j)},keys:function $(){return roleElement.map(function(j){var it=_slicedToArray(j,1),et=it[0];return et})},values:function $(){return roleElement.map(function(j){var it=_slicedToArray(j,2),et=it[1];return et})}},_default=(0,_iterationDecorator.default)(roleElementMap,roleElementMap.entries());roleElementMap$1.default=_default;Object.defineProperty(lib,"__esModule",{value:!0});var roles_1=lib.roles=roleElements_1=lib.roleElements=elementRoles_1=lib.elementRoles=lib.dom=lib.aria=void 0,_ariaPropsMap=_interopRequireDefault(ariaPropsMap$1),_domMap=_interopRequireDefault(domMap$1),_rolesMap=_interopRequireDefault(rolesMap$1),_elementRoleMap=_interopRequireDefault(elementRoleMap$1),_roleElementMap=_interopRequireDefault(roleElementMap$1);function _interopRequireDefault($){return $&&$.__esModule?$:{default:$}}var aria=_ariaPropsMap.default;lib.aria=aria;var dom=_domMap.default;lib.dom=dom;var roles=_rolesMap.default;roles_1=lib.roles=roles;var elementRoles=_elementRoleMap.default,elementRoles_1=lib.elementRoles=elementRoles,roleElements=_roleElementMap.default,roleElements_1=lib.roleElements=roleElements,lzString$1={exports:{}};lzString$1.exports;(function($){var j=function(){var it=String.fromCharCode,et="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ut="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",dt={};function mt(bt,Rt){if(!dt[bt]){dt[bt]={};for(var jt=0;jt<bt.length;jt++)dt[bt][bt.charAt(jt)]=jt}return dt[bt][Rt]}var yt={compressToBase64:function(bt){if(bt==null)return"";var Rt=yt._compress(bt,6,function(jt){return et.charAt(jt)});switch(Rt.length%4){default:case 0:return Rt;case 1:return Rt+"===";case 2:return Rt+"==";case 3:return Rt+"="}},decompressFromBase64:function(bt){return bt==null?"":bt==""?null:yt._decompress(bt.length,32,function(Rt){return mt(et,bt.charAt(Rt))})},compressToUTF16:function(bt){return bt==null?"":yt._compress(bt,15,function(Rt){return it(Rt+32)})+" "},decompressFromUTF16:function(bt){return bt==null?"":bt==""?null:yt._decompress(bt.length,16384,function(Rt){return bt.charCodeAt(Rt)-32})},compressToUint8Array:function(bt){for(var Rt=yt.compress(bt),jt=new Uint8Array(Rt.length*2),Vt=0,zt=Rt.length;Vt<zt;Vt++){var Jt=Rt.charCodeAt(Vt);jt[Vt*2]=Jt>>>8,jt[Vt*2+1]=Jt%256}return jt},decompressFromUint8Array:function(bt){if(bt==null)return yt.decompress(bt);for(var Rt=new Array(bt.length/2),jt=0,Vt=Rt.length;jt<Vt;jt++)Rt[jt]=bt[jt*2]*256+bt[jt*2+1];var zt=[];return Rt.forEach(function(Jt){zt.push(it(Jt))}),yt.decompress(zt.join(""))},compressToEncodedURIComponent:function(bt){return bt==null?"":yt._compress(bt,6,function(Rt){return ut.charAt(Rt)})},decompressFromEncodedURIComponent:function(bt){return bt==null?"":bt==""?null:(bt=bt.replace(/ /g,"+"),yt._decompress(bt.length,32,function(Rt){return mt(ut,bt.charAt(Rt))}))},compress:function(bt){return yt._compress(bt,16,function(Rt){return it(Rt)})},_compress:function(bt,Rt,jt){if(bt==null)return"";var Vt,zt,Jt={},rr={},Yt="",dr="",Ft="",Ht=2,er=3,pr=2,or=[],ar=0,Wt=0,Zt;for(Zt=0;Zt<bt.length;Zt+=1)if(Yt=bt.charAt(Zt),Object.prototype.hasOwnProperty.call(Jt,Yt)||(Jt[Yt]=er++,rr[Yt]=!0),dr=Ft+Yt,Object.prototype.hasOwnProperty.call(Jt,dr))Ft=dr;else{if(Object.prototype.hasOwnProperty.call(rr,Ft)){if(Ft.charCodeAt(0)<256){for(Vt=0;Vt<pr;Vt++)ar=ar<<1,Wt==Rt-1?(Wt=0,or.push(jt(ar)),ar=0):Wt++;for(zt=Ft.charCodeAt(0),Vt=0;Vt<8;Vt++)ar=ar<<1|zt&1,Wt==Rt-1?(Wt=0,or.push(jt(ar)),ar=0):Wt++,zt=zt>>1}else{for(zt=1,Vt=0;Vt<pr;Vt++)ar=ar<<1|zt,Wt==Rt-1?(Wt=0,or.push(jt(ar)),ar=0):Wt++,zt=0;for(zt=Ft.charCodeAt(0),Vt=0;Vt<16;Vt++)ar=ar<<1|zt&1,Wt==Rt-1?(Wt=0,or.push(jt(ar)),ar=0):Wt++,zt=zt>>1}Ht--,Ht==0&&(Ht=Math.pow(2,pr),pr++),delete rr[Ft]}else for(zt=Jt[Ft],Vt=0;Vt<pr;Vt++)ar=ar<<1|zt&1,Wt==Rt-1?(Wt=0,or.push(jt(ar)),ar=0):Wt++,zt=zt>>1;Ht--,Ht==0&&(Ht=Math.pow(2,pr),pr++),Jt[dr]=er++,Ft=String(Yt)}if(Ft!==""){if(Object.prototype.hasOwnProperty.call(rr,Ft)){if(Ft.charCodeAt(0)<256){for(Vt=0;Vt<pr;Vt++)ar=ar<<1,Wt==Rt-1?(Wt=0,or.push(jt(ar)),ar=0):Wt++;for(zt=Ft.charCodeAt(0),Vt=0;Vt<8;Vt++)ar=ar<<1|zt&1,Wt==Rt-1?(Wt=0,or.push(jt(ar)),ar=0):Wt++,zt=zt>>1}else{for(zt=1,Vt=0;Vt<pr;Vt++)ar=ar<<1|zt,Wt==Rt-1?(Wt=0,or.push(jt(ar)),ar=0):Wt++,zt=0;for(zt=Ft.charCodeAt(0),Vt=0;Vt<16;Vt++)ar=ar<<1|zt&1,Wt==Rt-1?(Wt=0,or.push(jt(ar)),ar=0):Wt++,zt=zt>>1}Ht--,Ht==0&&(Ht=Math.pow(2,pr),pr++),delete rr[Ft]}else for(zt=Jt[Ft],Vt=0;Vt<pr;Vt++)ar=ar<<1|zt&1,Wt==Rt-1?(Wt=0,or.push(jt(ar)),ar=0):Wt++,zt=zt>>1;Ht--,Ht==0&&(Ht=Math.pow(2,pr),pr++)}for(zt=2,Vt=0;Vt<pr;Vt++)ar=ar<<1|zt&1,Wt==Rt-1?(Wt=0,or.push(jt(ar)),ar=0):Wt++,zt=zt>>1;for(;;)if(ar=ar<<1,Wt==Rt-1){or.push(jt(ar));break}else Wt++;return or.join("")},decompress:function(bt){return bt==null?"":bt==""?null:yt._decompress(bt.length,32768,function(Rt){return bt.charCodeAt(Rt)})},_decompress:function(bt,Rt,jt){var Vt=[],zt=4,Jt=4,rr=3,Yt="",dr=[],Ft,Ht,er,pr,or,ar,Wt,Zt={val:jt(0),position:Rt,index:1};for(Ft=0;Ft<3;Ft+=1)Vt[Ft]=Ft;for(er=0,or=Math.pow(2,2),ar=1;ar!=or;)pr=Zt.val&Zt.position,Zt.position>>=1,Zt.position==0&&(Zt.position=Rt,Zt.val=jt(Zt.index++)),er|=(pr>0?1:0)*ar,ar<<=1;switch(er){case 0:for(er=0,or=Math.pow(2,8),ar=1;ar!=or;)pr=Zt.val&Zt.position,Zt.position>>=1,Zt.position==0&&(Zt.position=Rt,Zt.val=jt(Zt.index++)),er|=(pr>0?1:0)*ar,ar<<=1;Wt=it(er);break;case 1:for(er=0,or=Math.pow(2,16),ar=1;ar!=or;)pr=Zt.val&Zt.position,Zt.position>>=1,Zt.position==0&&(Zt.position=Rt,Zt.val=jt(Zt.index++)),er|=(pr>0?1:0)*ar,ar<<=1;Wt=it(er);break;case 2:return""}for(Vt[3]=Wt,Ht=Wt,dr.push(Wt);;){if(Zt.index>bt)return"";for(er=0,or=Math.pow(2,rr),ar=1;ar!=or;)pr=Zt.val&Zt.position,Zt.position>>=1,Zt.position==0&&(Zt.position=Rt,Zt.val=jt(Zt.index++)),er|=(pr>0?1:0)*ar,ar<<=1;switch(Wt=er){case 0:for(er=0,or=Math.pow(2,8),ar=1;ar!=or;)pr=Zt.val&Zt.position,Zt.position>>=1,Zt.position==0&&(Zt.position=Rt,Zt.val=jt(Zt.index++)),er|=(pr>0?1:0)*ar,ar<<=1;Vt[Jt++]=it(er),Wt=Jt-1,zt--;break;case 1:for(er=0,or=Math.pow(2,16),ar=1;ar!=or;)pr=Zt.val&Zt.position,Zt.position>>=1,Zt.position==0&&(Zt.position=Rt,Zt.val=jt(Zt.index++)),er|=(pr>0?1:0)*ar,ar<<=1;Vt[Jt++]=it(er),Wt=Jt-1,zt--;break;case 2:return dr.join("")}if(zt==0&&(zt=Math.pow(2,rr),rr++),Vt[Wt])Yt=Vt[Wt];else if(Wt===Jt)Yt=Ht+Ht.charAt(0);else return null;dr.push(Yt),Vt[Jt++]=Ht+Yt.charAt(0),zt--,Ht=Yt,zt==0&&(zt=Math.pow(2,rr),rr++)}}};return yt}();$!=null&&($.exports=j)})(lzString$1);var lzStringExports=lzString$1.exports;const lzString=getDefaultExportFromCjs(lzStringExports);function escapeHTML($){return $.replace(/</g,"&lt;").replace(/>/g,"&gt;")}const printProps=($,j,it,et,ut,dt,mt)=>{const yt=et+it.indent,bt=it.colors;return $.map(Rt=>{const jt=j[Rt];let Vt=mt(jt,it,yt,ut,dt);return typeof jt!="string"&&(Vt.indexOf(`
`)!==-1&&(Vt=it.spacingOuter+yt+Vt+it.spacingOuter+et),Vt="{"+Vt+"}"),it.spacingInner+et+bt.prop.open+Rt+bt.prop.close+"="+bt.value.open+Vt+bt.value.close}).join("")},NodeTypeTextNode=3,printChildren=($,j,it,et,ut,dt)=>$.map(mt=>{const yt=typeof mt=="string"?printText(mt,j):dt(mt,j,it,et,ut);return yt===""&&typeof mt=="object"&&mt!==null&&mt.nodeType!==NodeTypeTextNode?"":j.spacingOuter+it+yt}).join(""),printText=($,j)=>{const it=j.colors.content;return it.open+escapeHTML($)+it.close},printComment=($,j)=>{const it=j.colors.comment;return it.open+"<!--"+escapeHTML($)+"-->"+it.close},printElement=($,j,it,et,ut)=>{const dt=et.colors.tag;return dt.open+"<"+$+(j&&dt.close+j+et.spacingOuter+ut+dt.open)+(it?">"+dt.close+it+et.spacingOuter+ut+dt.open+"</"+$:(j&&!et.min?"":" ")+"/")+">"+dt.close},printElementAsLeaf=($,j)=>{const it=j.colors.tag;return it.open+"<"+$+it.close+" …"+it.open+" />"+it.close},ELEMENT_NODE$1=1,TEXT_NODE$1=3,COMMENT_NODE$1=8,FRAGMENT_NODE=11,ELEMENT_REGEXP=/^((HTML|SVG)\w*)?Element$/,testNode=$=>{const j=$.constructor.name,{nodeType:it,tagName:et}=$,ut=typeof et=="string"&&et.includes("-")||typeof $.hasAttribute=="function"&&$.hasAttribute("is");return it===ELEMENT_NODE$1&&(ELEMENT_REGEXP.test(j)||ut)||it===TEXT_NODE$1&&j==="Text"||it===COMMENT_NODE$1&&j==="Comment"||it===FRAGMENT_NODE&&j==="DocumentFragment"};function nodeIsText($){return $.nodeType===TEXT_NODE$1}function nodeIsComment($){return $.nodeType===COMMENT_NODE$1}function nodeIsFragment($){return $.nodeType===FRAGMENT_NODE}function createDOMElementFilter($){return{test:j=>{var it;return(j==null||(it=j.constructor)==null?void 0:it.name)&&testNode(j)},serialize:(j,it,et,ut,dt,mt)=>{if(nodeIsText(j))return printText(j.data,it);if(nodeIsComment(j))return printComment(j.data,it);const yt=nodeIsFragment(j)?"DocumentFragment":j.tagName.toLowerCase();return++ut>it.maxDepth?printElementAsLeaf(yt,it):printElement(yt,printProps(nodeIsFragment(j)?[]:Array.from(j.attributes).map(bt=>bt.name).sort(),nodeIsFragment(j)?{}:Array.from(j.attributes).reduce((bt,Rt)=>(bt[Rt.name]=Rt.value,bt),{}),it,et+it.indent,ut,dt,mt),printChildren(Array.prototype.slice.call(j.childNodes||j.children).filter($),it,et+it.indent,ut,dt,mt),it,et)}}}let chalk=null,readFileSync=null,codeFrameColumns=null;try{const $=module&&module.require;readFileSync=$.call(module,"fs").readFileSync,codeFrameColumns=$.call(module,"@babel/code-frame").codeFrameColumns,chalk=$.call(module,"chalk")}catch{}function getCodeFrame($){const j=$.indexOf("(")+1,it=$.indexOf(")"),et=$.slice(j,it),ut=et.split(":"),[dt,mt,yt]=[ut[0],parseInt(ut[1],10),parseInt(ut[2],10)];let bt="";try{bt=readFileSync(dt,"utf-8")}catch{return""}const Rt=codeFrameColumns(bt,{start:{line:mt,column:yt}},{highlightCode:!0,linesBelow:0});return chalk.dim(et)+`
`+Rt+`
`}function getUserCodeFrame(){if(!readFileSync||!codeFrameColumns)return"";const j=new Error().stack.split(`
`).slice(1).find(it=>!it.includes("node_modules/"));return getCodeFrame(j)}const TEXT_NODE$2=3;function jestFakeTimersAreEnabled$1(){return typeof jest<"u"&&jest!==null?setTimeout._isMockFunction===!0||Object.prototype.hasOwnProperty.call(setTimeout,"clock"):!1}function getDocument$1(){if(typeof window>"u")throw new Error("Could not find default container");return window.document}function getWindowFromNode$1($){if($.defaultView)return $.defaultView;if($.ownerDocument&&$.ownerDocument.defaultView)return $.ownerDocument.defaultView;if($.window)return $.window;throw $.ownerDocument&&$.ownerDocument.defaultView===null?new Error("It looks like the window object is not available for the provided node."):$.then instanceof Function?new Error("It looks like you passed a Promise object instead of a DOM node. Did you do something like `fireEvent.click(screen.findBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`, or await the findBy query `fireEvent.click(await screen.findBy...`?"):Array.isArray($)?new Error("It looks like you passed an Array instead of a DOM node. Did you do something like `fireEvent.click(screen.getAllBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`?"):typeof $.debug=="function"&&typeof $.logTestingPlaygroundURL=="function"?new Error("It looks like you passed a `screen` object. Did you do something like `fireEvent.click(screen, ...` when you meant to use a query, e.g. `fireEvent.click(screen.getBy..., `?"):new Error("The given node is not an Element, the node type is: "+typeof $+".")}function checkContainerType$1($){if(!$||typeof $.querySelector!="function"||typeof $.querySelectorAll!="function")throw new TypeError("Expected container to be an Element, a Document or a DocumentFragment but got "+j($)+".");function j(it){return typeof it=="object"?it===null?"null":it.constructor.name:typeof it}}const shouldHighlight=()=>{let $;try{var j,it;$=JSON.parse((j=process)==null||(it=j.env)==null?void 0:it.COLORS)}catch{}return typeof $=="boolean"?$:typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0},{DOMCollection}=plugins_1,ELEMENT_NODE=1,COMMENT_NODE=8;function filterCommentsAndDefaultIgnoreTagsTags($){return $.nodeType!==COMMENT_NODE&&($.nodeType!==ELEMENT_NODE||!$.matches(getConfig().defaultIgnore))}function prettyDOM($,j,it){if(it===void 0&&(it={}),$||($=getDocument$1().body),typeof j!="number"&&(j=typeof process<"u"&&{}.DEBUG_PRINT_LIMIT||7e3),j===0)return"";$.documentElement&&($=$.documentElement);let et=typeof $;if(et==="object"?et=$.constructor.name:$={},!("outerHTML"in $))throw new TypeError("Expected an element or document but got "+et);const{filterNode:ut=filterCommentsAndDefaultIgnoreTagsTags,...dt}=it,mt=format_1($,{plugins:[createDOMElementFilter(ut),DOMCollection],printFunctionName:!1,highlight:shouldHighlight(),...dt});return j!==void 0&&$.outerHTML.length>j?mt.slice(0,j)+"...":mt}const logDOM=function(){const $=getUserCodeFrame();console.log($?prettyDOM(...arguments)+`

`+$:prettyDOM(...arguments))};let config={testIdAttribute:"data-testid",asyncUtilTimeout:1e3,asyncWrapper:$=>$(),unstable_advanceTimersWrapper:$=>$(),eventWrapper:$=>$(),defaultHidden:!1,defaultIgnore:"script, style",showOriginalStackTrace:!1,throwSuggestions:!1,getElementError($,j){const it=prettyDOM(j),et=new Error([$,"Ignored nodes: comments, "+config.defaultIgnore+`
`+it].filter(Boolean).join(`

`));return et.name="TestingLibraryElementError",et},_disableExpensiveErrorDiagnostics:!1,computedStyleSupportsPseudoElements:!1};function runWithExpensiveErrorDiagnosticsDisabled($){try{return config._disableExpensiveErrorDiagnostics=!0,$()}finally{config._disableExpensiveErrorDiagnostics=!1}}function configure($){typeof $=="function"&&($=$(config)),config={...config,...$}}function getConfig(){return config}const labelledNodeNames=["button","meter","output","progress","select","textarea","input"];function getTextContent($){return labelledNodeNames.includes($.nodeName.toLowerCase())?"":$.nodeType===TEXT_NODE$2?$.textContent:Array.from($.childNodes).map(j=>getTextContent(j)).join("")}function getLabelContent($){let j;return $.tagName.toLowerCase()==="label"?j=getTextContent($):j=$.value||$.textContent,j}function getRealLabels($){if($.labels!==void 0){var j;return(j=$.labels)!=null?j:[]}if(!isLabelable($))return[];const it=$.ownerDocument.querySelectorAll("label");return Array.from(it).filter(et=>et.control===$)}function isLabelable($){return/BUTTON|METER|OUTPUT|PROGRESS|SELECT|TEXTAREA/.test($.tagName)||$.tagName==="INPUT"&&$.getAttribute("type")!=="hidden"}function getLabels($,j,it){let{selector:et="*"}=it===void 0?{}:it;const ut=j.getAttribute("aria-labelledby"),dt=ut?ut.split(" "):[];return dt.length?dt.map(mt=>{const yt=$.querySelector('[id="'+mt+'"]');return yt?{content:getLabelContent(yt),formControl:null}:{content:"",formControl:null}}):Array.from(getRealLabels(j)).map(mt=>{const yt=getLabelContent(mt),bt="button, input, meter, output, progress, select, textarea",Rt=Array.from(mt.querySelectorAll(bt)).filter(jt=>jt.matches(et))[0];return{content:yt,formControl:Rt}})}function assertNotNullOrUndefined($){if($==null)throw new Error("It looks like "+$+" was passed instead of a matcher. Did you do something like getByText("+$+")?")}function fuzzyMatches($,j,it,et){if(typeof $!="string")return!1;assertNotNullOrUndefined(it);const ut=et($);return typeof it=="string"||typeof it=="number"?ut.toLowerCase().includes(it.toString().toLowerCase()):typeof it=="function"?it(ut,j):matchRegExp(it,ut)}function matches($,j,it,et){if(typeof $!="string")return!1;assertNotNullOrUndefined(it);const ut=et($);return it instanceof Function?it(ut,j):it instanceof RegExp?matchRegExp(it,ut):ut===String(it)}function getDefaultNormalizer($){let{trim:j=!0,collapseWhitespace:it=!0}=$===void 0?{}:$;return et=>{let ut=et;return ut=j?ut.trim():ut,ut=it?ut.replace(/\s+/g," "):ut,ut}}function makeNormalizer($){let{trim:j,collapseWhitespace:it,normalizer:et}=$;if(!et)return getDefaultNormalizer({trim:j,collapseWhitespace:it});if(typeof j<"u"||typeof it<"u")throw new Error('trim and collapseWhitespace are not supported with a normalizer. If you want to use the default trim and collapseWhitespace logic in your normalizer, use "getDefaultNormalizer({trim, collapseWhitespace})" and compose that into your normalizer');return et}function matchRegExp($,j){const it=$.test(j);return $.global&&$.lastIndex!==0&&(console.warn("To match all elements we had to reset the lastIndex of the RegExp because the global flag is enabled. We encourage to remove the global flag from the RegExp."),$.lastIndex=0),it}function getNodeText($){return $.matches("input[type=submit], input[type=button], input[type=reset]")?$.value:Array.from($.childNodes).filter(j=>j.nodeType===TEXT_NODE$2&&!!j.textContent).map(j=>j.textContent).join("")}const elementRoleList=buildElementRoleList(elementRoles_1);function isSubtreeInaccessible($){return $.hidden===!0||$.getAttribute("aria-hidden")==="true"||$.ownerDocument.defaultView.getComputedStyle($).display==="none"}function isInaccessible($,j){j===void 0&&(j={});const{isSubtreeInaccessible:it=isSubtreeInaccessible}=j;if($.ownerDocument.defaultView.getComputedStyle($).visibility==="hidden")return!0;let ut=$;for(;ut;){if(it(ut))return!0;ut=ut.parentElement}return!1}function getImplicitAriaRoles($){for(const{match:j,roles:it}of elementRoleList)if(j($))return[...it];return[]}function buildElementRoleList($){function j(mt){let{name:yt,attributes:bt}=mt;return""+yt+bt.map(Rt=>{let{name:jt,value:Vt,constraints:zt=[]}=Rt;return zt.indexOf("undefined")!==-1?":not(["+jt+"])":Vt?"["+jt+'="'+Vt+'"]':"["+jt+"]"}).join("")}function it(mt){let{attributes:yt=[]}=mt;return yt.length}function et(mt,yt){let{specificity:bt}=mt,{specificity:Rt}=yt;return Rt-bt}function ut(mt){let{attributes:yt=[]}=mt;const bt=yt.findIndex(jt=>jt.value&&jt.name==="type"&&jt.value==="text");bt>=0&&(yt=[...yt.slice(0,bt),...yt.slice(bt+1)]);const Rt=j({...mt,attributes:yt});return jt=>bt>=0&&jt.type!=="text"?!1:jt.matches(Rt)}let dt=[];for(const[mt,yt]of $.entries())dt=[...dt,{match:ut(mt),roles:Array.from(yt),specificity:it(mt)}];return dt.sort(et)}function getRoles($,j){let{hidden:it=!1}=j===void 0?{}:j;function et(ut){return[ut,...Array.from(ut.children).reduce((dt,mt)=>[...dt,...et(mt)],[])]}return et($).filter(ut=>it===!1?isInaccessible(ut)===!1:!0).reduce((ut,dt)=>{let mt=[];return dt.hasAttribute("role")?mt=dt.getAttribute("role").split(" ").slice(0,1):mt=getImplicitAriaRoles(dt),mt.reduce((yt,bt)=>Array.isArray(yt[bt])?{...yt,[bt]:[...yt[bt],dt]}:{...yt,[bt]:[dt]},ut)},{})}function prettyRoles($,j){let{hidden:it,includeDescription:et}=j;const ut=getRoles($,{hidden:it});return Object.entries(ut).filter(dt=>{let[mt]=dt;return mt!=="generic"}).map(dt=>{let[mt,yt]=dt;const bt="-".repeat(50),Rt=yt.map(jt=>{const Vt='Name "'+computeAccessibleName(jt,{computedStyleSupportsPseudoElements:getConfig().computedStyleSupportsPseudoElements})+`":
`,zt=prettyDOM(jt.cloneNode(!1));if(et){const Jt='Description "'+computeAccessibleDescription(jt,{computedStyleSupportsPseudoElements:getConfig().computedStyleSupportsPseudoElements})+`":
`;return""+Vt+Jt+zt}return""+Vt+zt}).join(`

`);return mt+`:

`+Rt+`

`+bt}).join(`
`)}const logRoles=function($,j){let{hidden:it=!1}=j===void 0?{}:j;return console.log(prettyRoles($,{hidden:it}))};function computeAriaSelected($){return $.tagName==="OPTION"?$.selected:checkBooleanAttribute($,"aria-selected")}function computeAriaChecked($){if(!("indeterminate"in $&&$.indeterminate))return"checked"in $?$.checked:checkBooleanAttribute($,"aria-checked")}function computeAriaPressed($){return checkBooleanAttribute($,"aria-pressed")}function computeAriaCurrent($){var j,it;return(j=(it=checkBooleanAttribute($,"aria-current"))!=null?it:$.getAttribute("aria-current"))!=null?j:!1}function computeAriaExpanded($){return checkBooleanAttribute($,"aria-expanded")}function checkBooleanAttribute($,j){const it=$.getAttribute(j);if(it==="true")return!0;if(it==="false")return!1}function computeHeadingLevel($){const j={H1:1,H2:2,H3:3,H4:4,H5:5,H6:6};return $.getAttribute("aria-level")&&Number($.getAttribute("aria-level"))||j[$.tagName]}const normalize=getDefaultNormalizer();function escapeRegExp($){return $.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function getRegExpMatcher($){return new RegExp(escapeRegExp($.toLowerCase()),"i")}function makeSuggestion($,j,it,et){let{variant:ut,name:dt}=et,mt="";const yt={},bt=[["Role","TestId"].includes($)?it:getRegExpMatcher(it)];dt&&(yt.name=getRegExpMatcher(dt)),$==="Role"&&isInaccessible(j)&&(yt.hidden=!0,mt=`Element is inaccessible. This means that the element and all its children are invisible to screen readers.
    If you are using the aria-hidden prop, make sure this is the right choice for your case.
    `),Object.keys(yt).length>0&&bt.push(yt);const Rt=ut+"By"+$;return{queryName:$,queryMethod:Rt,queryArgs:bt,variant:ut,warning:mt,toString(){mt&&console.warn(mt);let[jt,Vt]=bt;return jt=typeof jt=="string"?"'"+jt+"'":jt,Vt=Vt?", { "+Object.entries(Vt).map(zt=>{let[Jt,rr]=zt;return Jt+": "+rr}).join(", ")+" }":"",Rt+"("+jt+Vt+")"}}}function canSuggest($,j,it){return it&&(!j||j.toLowerCase()===$.toLowerCase())}function getSuggestedQuery($,j,it){var et,ut;if(j===void 0&&(j="get"),$.matches(getConfig().defaultIgnore))return;const dt=(et=$.getAttribute("role"))!=null?et:(ut=getImplicitAriaRoles($))==null?void 0:ut[0];if(dt!=="generic"&&canSuggest("Role",it,dt))return makeSuggestion("Role",$,dt,{variant:j,name:computeAccessibleName($,{computedStyleSupportsPseudoElements:getConfig().computedStyleSupportsPseudoElements})});const mt=getLabels(document,$).map(zt=>zt.content).join(" ");if(canSuggest("LabelText",it,mt))return makeSuggestion("LabelText",$,mt,{variant:j});const yt=$.getAttribute("placeholder");if(canSuggest("PlaceholderText",it,yt))return makeSuggestion("PlaceholderText",$,yt,{variant:j});const bt=normalize(getNodeText($));if(canSuggest("Text",it,bt))return makeSuggestion("Text",$,bt,{variant:j});if(canSuggest("DisplayValue",it,$.value))return makeSuggestion("DisplayValue",$,normalize($.value),{variant:j});const Rt=$.getAttribute("alt");if(canSuggest("AltText",it,Rt))return makeSuggestion("AltText",$,Rt,{variant:j});const jt=$.getAttribute("title");if(canSuggest("Title",it,jt))return makeSuggestion("Title",$,jt,{variant:j});const Vt=$.getAttribute(getConfig().testIdAttribute);if(canSuggest("TestId",it,Vt))return makeSuggestion("TestId",$,Vt,{variant:j})}function copyStackTrace($,j){$.stack=j.stack.replace(j.message,$.message)}function waitFor($,j){let{container:it=getDocument$1(),timeout:et=getConfig().asyncUtilTimeout,showOriginalStackTrace:ut=getConfig().showOriginalStackTrace,stackTraceError:dt,interval:mt=50,onTimeout:yt=Rt=>(Rt.message=getConfig().getElementError(Rt.message,it).message,Rt),mutationObserverOptions:bt={subtree:!0,childList:!0,attributes:!0,characterData:!0}}=j;if(typeof $!="function")throw new TypeError("Received `callback` arg must be a function");return new Promise(async(Rt,jt)=>{let Vt,zt,Jt,rr=!1,Yt="idle";const dr=setTimeout(or,et),Ft=jestFakeTimersAreEnabled$1();if(Ft){const{unstable_advanceTimersWrapper:ar}=getConfig();for(pr();!rr;){if(!jestFakeTimersAreEnabled$1()){const Wt=new Error("Changed from using fake timers to real timers while using waitFor. This is not allowed and will result in very strange behavior. Please ensure you're awaiting all async things your test is doing before changing to real timers. For more info, please go to https://github.com/testing-library/dom-testing-library/issues/830");ut||copyStackTrace(Wt,dt),jt(Wt);return}if(ar(()=>{jest.advanceTimersByTime(mt)}),pr(),rr)break;await ar(async()=>{await new Promise(Wt=>{setTimeout(Wt,0),jest.advanceTimersByTime(0)})})}}else{try{checkContainerType$1(it)}catch(Wt){jt(Wt);return}zt=setInterval(er,mt);const{MutationObserver:ar}=getWindowFromNode$1(it);Jt=new ar(er),Jt.observe(it,bt),pr()}function Ht(ar,Wt){rr=!0,clearTimeout(dr),Ft||(clearInterval(zt),Jt.disconnect()),ar?jt(ar):Rt(Wt)}function er(){if(jestFakeTimersAreEnabled$1()){const ar=new Error("Changed from using real timers to fake timers while using waitFor. This is not allowed and will result in very strange behavior. Please ensure you're awaiting all async things your test is doing before changing to fake timers. For more info, please go to https://github.com/testing-library/dom-testing-library/issues/830");return ut||copyStackTrace(ar,dt),jt(ar)}else return pr()}function pr(){if(Yt!=="pending")try{const ar=runWithExpensiveErrorDiagnosticsDisabled($);typeof(ar==null?void 0:ar.then)=="function"?(Yt="pending",ar.then(Wt=>{Yt="resolved",Ht(null,Wt)},Wt=>{Yt="rejected",Vt=Wt})):Ht(null,ar)}catch(ar){Vt=ar}}function or(){let ar;Vt?(ar=Vt,!ut&&ar.name==="TestingLibraryElementError"&&copyStackTrace(ar,dt)):(ar=new Error("Timed out in waitFor."),ut||copyStackTrace(ar,dt)),Ht(yt(ar),null)}})}function waitForWrapper($,j){const it=new Error("STACK_TRACE_MESSAGE");return getConfig().asyncWrapper(()=>waitFor($,{stackTraceError:it,...j}))}function getElementError($,j){return getConfig().getElementError($,j)}function getMultipleElementsFoundError($,j){return getElementError($+"\n\n(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).",j)}function queryAllByAttribute($,j,it,et){let{exact:ut=!0,collapseWhitespace:dt,trim:mt,normalizer:yt}=et===void 0?{}:et;const bt=ut?matches:fuzzyMatches,Rt=makeNormalizer({collapseWhitespace:dt,trim:mt,normalizer:yt});return Array.from(j.querySelectorAll("["+$+"]")).filter(jt=>bt(jt.getAttribute($),jt,it,Rt))}function queryByAttribute($,j,it,et){const ut=queryAllByAttribute($,j,it,et);if(ut.length>1)throw getMultipleElementsFoundError("Found multiple elements by ["+$+"="+it+"]",j);return ut[0]||null}function makeSingleQuery($,j){return function(it){for(var et=arguments.length,ut=new Array(et>1?et-1:0),dt=1;dt<et;dt++)ut[dt-1]=arguments[dt];const mt=$(it,...ut);if(mt.length>1){const yt=mt.map(bt=>getElementError(null,bt).message).join(`

`);throw getMultipleElementsFoundError(j(it,...ut)+`

Here are the matching elements:

`+yt,it)}return mt[0]||null}}function getSuggestionError($,j){return getConfig().getElementError(`A better query is available, try this:
`+$.toString()+`
`,j)}function makeGetAllQuery($,j){return function(it){for(var et=arguments.length,ut=new Array(et>1?et-1:0),dt=1;dt<et;dt++)ut[dt-1]=arguments[dt];const mt=$(it,...ut);if(!mt.length)throw getConfig().getElementError(j(it,...ut),it);return mt}}function makeFindQuery($){return(j,it,et,ut)=>waitForWrapper(()=>$(j,it,et),{container:j,...ut})}const wrapSingleQueryWithSuggestion=($,j,it)=>function(et){for(var ut=arguments.length,dt=new Array(ut>1?ut-1:0),mt=1;mt<ut;mt++)dt[mt-1]=arguments[mt];const yt=$(et,...dt),[{suggest:bt=getConfig().throwSuggestions}={}]=dt.slice(-1);if(yt&&bt){const Rt=getSuggestedQuery(yt,it);if(Rt&&!j.endsWith(Rt.queryName))throw getSuggestionError(Rt.toString(),et)}return yt},wrapAllByQueryWithSuggestion=($,j,it)=>function(et){for(var ut=arguments.length,dt=new Array(ut>1?ut-1:0),mt=1;mt<ut;mt++)dt[mt-1]=arguments[mt];const yt=$(et,...dt),[{suggest:bt=getConfig().throwSuggestions}={}]=dt.slice(-1);if(yt.length&&bt){const Rt=[...new Set(yt.map(jt=>{var Vt;return(Vt=getSuggestedQuery(jt,it))==null?void 0:Vt.toString()}))];if(Rt.length===1&&!j.endsWith(getSuggestedQuery(yt[0],it).queryName))throw getSuggestionError(Rt[0],et)}return yt};function buildQueries($,j,it){const et=wrapSingleQueryWithSuggestion(makeSingleQuery($,j),$.name,"query"),ut=makeGetAllQuery($,it),dt=makeSingleQuery(ut,j),mt=wrapSingleQueryWithSuggestion(dt,$.name,"get"),yt=wrapAllByQueryWithSuggestion(ut,$.name.replace("query","get"),"getAll"),bt=makeFindQuery(wrapAllByQueryWithSuggestion(ut,$.name,"findAll")),Rt=makeFindQuery(wrapSingleQueryWithSuggestion(dt,$.name,"find"));return[et,yt,mt,bt,Rt]}var queryHelpers=Object.freeze({__proto__:null,getElementError,wrapAllByQueryWithSuggestion,wrapSingleQueryWithSuggestion,getMultipleElementsFoundError,queryAllByAttribute,queryByAttribute,makeSingleQuery,makeGetAllQuery,makeFindQuery,buildQueries});function queryAllLabels($){return Array.from($.querySelectorAll("label,input")).map(j=>({node:j,textToMatch:getLabelContent(j)})).filter(j=>{let{textToMatch:it}=j;return it!==null})}const queryAllLabelsByText=function($,j,it){let{exact:et=!0,trim:ut,collapseWhitespace:dt,normalizer:mt}=it===void 0?{}:it;const yt=et?matches:fuzzyMatches,bt=makeNormalizer({collapseWhitespace:dt,trim:ut,normalizer:mt});return queryAllLabels($).filter(jt=>{let{node:Vt,textToMatch:zt}=jt;return yt(zt,Vt,j,bt)}).map(jt=>{let{node:Vt}=jt;return Vt})},queryAllByLabelText=function($,j,it){let{selector:et="*",exact:ut=!0,collapseWhitespace:dt,trim:mt,normalizer:yt}=it===void 0?{}:it;checkContainerType$1($);const bt=ut?matches:fuzzyMatches,Rt=makeNormalizer({collapseWhitespace:dt,trim:mt,normalizer:yt}),jt=Array.from($.querySelectorAll("*")).filter(Vt=>getRealLabels(Vt).length||Vt.hasAttribute("aria-labelledby")).reduce((Vt,zt)=>{const Jt=getLabels($,zt,{selector:et});Jt.filter(Yt=>!!Yt.formControl).forEach(Yt=>{bt(Yt.content,Yt.formControl,j,Rt)&&Yt.formControl&&Vt.push(Yt.formControl)});const rr=Jt.filter(Yt=>!!Yt.content).map(Yt=>Yt.content);return bt(rr.join(" "),zt,j,Rt)&&Vt.push(zt),rr.length>1&&rr.forEach((Yt,dr)=>{bt(Yt,zt,j,Rt)&&Vt.push(zt);const Ft=[...rr];Ft.splice(dr,1),Ft.length>1&&bt(Ft.join(" "),zt,j,Rt)&&Vt.push(zt)}),Vt},[]).concat(queryAllByAttribute("aria-label",$,j,{exact:ut,normalizer:Rt}));return Array.from(new Set(jt)).filter(Vt=>Vt.matches(et))},getAllByLabelText=function($,j){for(var it=arguments.length,et=new Array(it>2?it-2:0),ut=2;ut<it;ut++)et[ut-2]=arguments[ut];const dt=queryAllByLabelText($,j,...et);if(!dt.length){const mt=queryAllLabelsByText($,j,...et);if(mt.length){const yt=mt.map(bt=>getTagNameOfElementAssociatedWithLabelViaFor($,bt)).filter(bt=>!!bt);throw yt.length?getConfig().getElementError(yt.map(bt=>"Found a label with the text of: "+j+", however the element associated with this label (<"+bt+" />) is non-labellable [https://html.spec.whatwg.org/multipage/forms.html#category-label]. If you really need to label a <"+bt+" />, you can use aria-label or aria-labelledby instead.").join(`

`),$):getConfig().getElementError("Found a label with the text of: "+j+`, however no form control was found associated to that label. Make sure you're using the "for" attribute or "aria-labelledby" attribute correctly.`,$)}else throw getConfig().getElementError("Unable to find a label with the text of: "+j,$)}return dt};function getTagNameOfElementAssociatedWithLabelViaFor($,j){const it=j.getAttribute("for");if(!it)return null;const et=$.querySelector('[id="'+it+'"]');return et?et.tagName.toLowerCase():null}const getMultipleError$7=($,j)=>"Found multiple elements with the text of: "+j,queryByLabelText=wrapSingleQueryWithSuggestion(makeSingleQuery(queryAllByLabelText,getMultipleError$7),queryAllByLabelText.name,"query"),getByLabelText=makeSingleQuery(getAllByLabelText,getMultipleError$7),findAllByLabelText=makeFindQuery(wrapAllByQueryWithSuggestion(getAllByLabelText,getAllByLabelText.name,"findAll")),findByLabelText=makeFindQuery(wrapSingleQueryWithSuggestion(getByLabelText,getAllByLabelText.name,"find")),getAllByLabelTextWithSuggestions=wrapAllByQueryWithSuggestion(getAllByLabelText,getAllByLabelText.name,"getAll"),getByLabelTextWithSuggestions=wrapSingleQueryWithSuggestion(getByLabelText,getAllByLabelText.name,"get"),queryAllByLabelTextWithSuggestions=wrapAllByQueryWithSuggestion(queryAllByLabelText,queryAllByLabelText.name,"queryAll"),queryAllByPlaceholderText=function(){for(var $=arguments.length,j=new Array($),it=0;it<$;it++)j[it]=arguments[it];return checkContainerType$1(j[0]),queryAllByAttribute("placeholder",...j)},getMultipleError$6=($,j)=>"Found multiple elements with the placeholder text of: "+j,getMissingError$6=($,j)=>"Unable to find an element with the placeholder text of: "+j,queryAllByPlaceholderTextWithSuggestions=wrapAllByQueryWithSuggestion(queryAllByPlaceholderText,queryAllByPlaceholderText.name,"queryAll"),[queryByPlaceholderText,getAllByPlaceholderText,getByPlaceholderText,findAllByPlaceholderText,findByPlaceholderText]=buildQueries(queryAllByPlaceholderText,getMultipleError$6,getMissingError$6),queryAllByText=function($,j,it){let{selector:et="*",exact:ut=!0,collapseWhitespace:dt,trim:mt,ignore:yt=getConfig().defaultIgnore,normalizer:bt}=it===void 0?{}:it;checkContainerType$1($);const Rt=ut?matches:fuzzyMatches,jt=makeNormalizer({collapseWhitespace:dt,trim:mt,normalizer:bt});let Vt=[];return typeof $.matches=="function"&&$.matches(et)&&(Vt=[$]),[...Vt,...Array.from($.querySelectorAll(et))].filter(zt=>!yt||!zt.matches(yt)).filter(zt=>Rt(getNodeText(zt),zt,j,jt))},getMultipleError$5=($,j)=>"Found multiple elements with the text: "+j,getMissingError$5=function($,j,it){it===void 0&&(it={});const{collapseWhitespace:et,trim:ut,normalizer:dt,selector:mt}=it,bt=makeNormalizer({collapseWhitespace:et,trim:ut,normalizer:dt})(j.toString()),Rt=bt!==j.toString(),jt=(mt??"*")!=="*";return"Unable to find an element with the text: "+(Rt?bt+" (normalized from '"+j+"')":j)+(jt?", which matches selector '"+mt+"'":"")+". This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible."},queryAllByTextWithSuggestions=wrapAllByQueryWithSuggestion(queryAllByText,queryAllByText.name,"queryAll"),[queryByText,getAllByText,getByText,findAllByText,findByText]=buildQueries(queryAllByText,getMultipleError$5,getMissingError$5),queryAllByDisplayValue=function($,j,it){let{exact:et=!0,collapseWhitespace:ut,trim:dt,normalizer:mt}=it===void 0?{}:it;checkContainerType$1($);const yt=et?matches:fuzzyMatches,bt=makeNormalizer({collapseWhitespace:ut,trim:dt,normalizer:mt});return Array.from($.querySelectorAll("input,textarea,select")).filter(Rt=>Rt.tagName==="SELECT"?Array.from(Rt.options).filter(Vt=>Vt.selected).some(Vt=>yt(getNodeText(Vt),Vt,j,bt)):yt(Rt.value,Rt,j,bt))},getMultipleError$4=($,j)=>"Found multiple elements with the display value: "+j+".",getMissingError$4=($,j)=>"Unable to find an element with the display value: "+j+".",queryAllByDisplayValueWithSuggestions=wrapAllByQueryWithSuggestion(queryAllByDisplayValue,queryAllByDisplayValue.name,"queryAll"),[queryByDisplayValue,getAllByDisplayValue,getByDisplayValue,findAllByDisplayValue,findByDisplayValue]=buildQueries(queryAllByDisplayValue,getMultipleError$4,getMissingError$4),VALID_TAG_REGEXP=/^(img|input|area|.+-.+)$/i,queryAllByAltText=function($,j,it){return it===void 0&&(it={}),checkContainerType$1($),queryAllByAttribute("alt",$,j,it).filter(et=>VALID_TAG_REGEXP.test(et.tagName))},getMultipleError$3=($,j)=>"Found multiple elements with the alt text: "+j,getMissingError$3=($,j)=>"Unable to find an element with the alt text: "+j,queryAllByAltTextWithSuggestions=wrapAllByQueryWithSuggestion(queryAllByAltText,queryAllByAltText.name,"queryAll"),[queryByAltText,getAllByAltText,getByAltText,findAllByAltText,findByAltText]=buildQueries(queryAllByAltText,getMultipleError$3,getMissingError$3),isSvgTitle=$=>{var j;return $.tagName.toLowerCase()==="title"&&((j=$.parentElement)==null?void 0:j.tagName.toLowerCase())==="svg"},queryAllByTitle=function($,j,it){let{exact:et=!0,collapseWhitespace:ut,trim:dt,normalizer:mt}=it===void 0?{}:it;checkContainerType$1($);const yt=et?matches:fuzzyMatches,bt=makeNormalizer({collapseWhitespace:ut,trim:dt,normalizer:mt});return Array.from($.querySelectorAll("[title], svg > title")).filter(Rt=>yt(Rt.getAttribute("title"),Rt,j,bt)||isSvgTitle(Rt)&&yt(getNodeText(Rt),Rt,j,bt))},getMultipleError$2=($,j)=>"Found multiple elements with the title: "+j+".",getMissingError$2=($,j)=>"Unable to find an element with the title: "+j+".",queryAllByTitleWithSuggestions=wrapAllByQueryWithSuggestion(queryAllByTitle,queryAllByTitle.name,"queryAll"),[queryByTitle,getAllByTitle,getByTitle,findAllByTitle,findByTitle]=buildQueries(queryAllByTitle,getMultipleError$2,getMissingError$2),queryAllByRole=function($,j,it){let{hidden:et=getConfig().defaultHidden,name:ut,description:dt,queryFallbacks:mt=!1,selected:yt,checked:bt,pressed:Rt,current:jt,level:Vt,expanded:zt}=it===void 0?{}:it;if(checkContainerType$1($),yt!==void 0){var Jt;if(((Jt=roles_1.get(j))==null?void 0:Jt.props["aria-selected"])===void 0)throw new Error('"aria-selected" is not supported on role "'+j+'".')}if(bt!==void 0){var rr;if(((rr=roles_1.get(j))==null?void 0:rr.props["aria-checked"])===void 0)throw new Error('"aria-checked" is not supported on role "'+j+'".')}if(Rt!==void 0){var Yt;if(((Yt=roles_1.get(j))==null?void 0:Yt.props["aria-pressed"])===void 0)throw new Error('"aria-pressed" is not supported on role "'+j+'".')}if(jt!==void 0){var dr;if(((dr=roles_1.get(j))==null?void 0:dr.props["aria-current"])===void 0)throw new Error('"aria-current" is not supported on role "'+j+'".')}if(Vt!==void 0&&j!=="heading")throw new Error('Role "'+j+'" cannot have "level" property.');if(zt!==void 0){var Ft;if(((Ft=roles_1.get(j))==null?void 0:Ft.props["aria-expanded"])===void 0)throw new Error('"aria-expanded" is not supported on role "'+j+'".')}const Ht=new WeakMap;function er(pr){return Ht.has(pr)||Ht.set(pr,isSubtreeInaccessible(pr)),Ht.get(pr)}return Array.from($.querySelectorAll(makeRoleSelector(j))).filter(pr=>{if(pr.hasAttribute("role")){const Wt=pr.getAttribute("role");if(mt)return Wt.split(" ").filter(Boolean).some(sr=>sr===j);const[Zt]=Wt.split(" ");return Zt===j}return getImplicitAriaRoles(pr).some(Wt=>Wt===j)}).filter(pr=>yt!==void 0?yt===computeAriaSelected(pr):bt!==void 0?bt===computeAriaChecked(pr):Rt!==void 0?Rt===computeAriaPressed(pr):jt!==void 0?jt===computeAriaCurrent(pr):zt!==void 0?zt===computeAriaExpanded(pr):Vt!==void 0?Vt===computeHeadingLevel(pr):!0).filter(pr=>ut===void 0?!0:matches(computeAccessibleName(pr,{computedStyleSupportsPseudoElements:getConfig().computedStyleSupportsPseudoElements}),pr,ut,or=>or)).filter(pr=>dt===void 0?!0:matches(computeAccessibleDescription(pr,{computedStyleSupportsPseudoElements:getConfig().computedStyleSupportsPseudoElements}),pr,dt,or=>or)).filter(pr=>et===!1?isInaccessible(pr,{isSubtreeInaccessible:er})===!1:!0)};function makeRoleSelector($){var j;const it='*[role~="'+$+'"]',et=(j=roleElements_1.get($))!=null?j:new Set,ut=new Set(Array.from(et).map(dt=>{let{name:mt}=dt;return mt}));return[it].concat(Array.from(ut)).join(",")}const getNameHint=$=>{let j="";return $===void 0?j="":typeof $=="string"?j=' and name "'+$+'"':j=" and name `"+$+"`",j},getMultipleError$1=function($,j,it){let{name:et}=it===void 0?{}:it;return'Found multiple elements with the role "'+j+'"'+getNameHint(et)},getMissingError$1=function($,j,it){let{hidden:et=getConfig().defaultHidden,name:ut,description:dt}=it===void 0?{}:it;if(getConfig()._disableExpensiveErrorDiagnostics)return'Unable to find role="'+j+'"'+getNameHint(ut);let mt="";Array.from($.children).forEach(jt=>{mt+=prettyRoles(jt,{hidden:et,includeDescription:dt!==void 0})});let yt;mt.length===0?et===!1?yt="There are no accessible roles. But there might be some inaccessible roles. If you wish to access them, then set the `hidden` option to `true`. Learn more about this here: https://testing-library.com/docs/dom-testing-library/api-queries#byrole":yt="There are no available roles.":yt=(`
Here are the `+(et===!1?"accessible":"available")+` roles:

  `+mt.replace(/\n/g,`
  `).replace(/\n\s\s\n/g,`

`)+`
`).trim();let bt="";ut===void 0?bt="":typeof ut=="string"?bt=' and name "'+ut+'"':bt=" and name `"+ut+"`";let Rt="";return dt===void 0?Rt="":typeof dt=="string"?Rt=' and description "'+dt+'"':Rt=" and description `"+dt+"`",(`
Unable to find an `+(et===!1?"accessible ":"")+'element with the role "'+j+'"'+bt+Rt+`

`+yt).trim()},queryAllByRoleWithSuggestions=wrapAllByQueryWithSuggestion(queryAllByRole,queryAllByRole.name,"queryAll"),[queryByRole,getAllByRole,getByRole,findAllByRole,findByRole]=buildQueries(queryAllByRole,getMultipleError$1,getMissingError$1),getTestIdAttribute=()=>getConfig().testIdAttribute,queryAllByTestId=function(){for(var $=arguments.length,j=new Array($),it=0;it<$;it++)j[it]=arguments[it];return checkContainerType$1(j[0]),queryAllByAttribute(getTestIdAttribute(),...j)},getMultipleError=($,j)=>"Found multiple elements by: ["+getTestIdAttribute()+'="'+j+'"]',getMissingError=($,j)=>"Unable to find an element by: ["+getTestIdAttribute()+'="'+j+'"]',queryAllByTestIdWithSuggestions=wrapAllByQueryWithSuggestion(queryAllByTestId,queryAllByTestId.name,"queryAll"),[queryByTestId,getAllByTestId,getByTestId,findAllByTestId,findByTestId]=buildQueries(queryAllByTestId,getMultipleError,getMissingError);var queries=Object.freeze({__proto__:null,queryAllByLabelText:queryAllByLabelTextWithSuggestions,queryByLabelText,getAllByLabelText:getAllByLabelTextWithSuggestions,getByLabelText:getByLabelTextWithSuggestions,findAllByLabelText,findByLabelText,queryByPlaceholderText,queryAllByPlaceholderText:queryAllByPlaceholderTextWithSuggestions,getByPlaceholderText,getAllByPlaceholderText,findAllByPlaceholderText,findByPlaceholderText,queryByText,queryAllByText:queryAllByTextWithSuggestions,getByText,getAllByText,findAllByText,findByText,queryByDisplayValue,queryAllByDisplayValue:queryAllByDisplayValueWithSuggestions,getByDisplayValue,getAllByDisplayValue,findAllByDisplayValue,findByDisplayValue,queryByAltText,queryAllByAltText:queryAllByAltTextWithSuggestions,getByAltText,getAllByAltText,findAllByAltText,findByAltText,queryByTitle,queryAllByTitle:queryAllByTitleWithSuggestions,getByTitle,getAllByTitle,findAllByTitle,findByTitle,queryByRole,queryAllByRole:queryAllByRoleWithSuggestions,getAllByRole,getByRole,findAllByRole,findByRole,queryByTestId,queryAllByTestId:queryAllByTestIdWithSuggestions,getByTestId,getAllByTestId,findAllByTestId,findByTestId});function getQueriesForElement($,j,it){return j===void 0&&(j=queries),it===void 0&&(it={}),Object.keys(j).reduce((et,ut)=>{const dt=j[ut];return et[ut]=dt.bind(null,$),et},it)}const isRemoved=$=>!$||Array.isArray($)&&!$.length;function initialCheck($){if(isRemoved($))throw new Error("The element(s) given to waitForElementToBeRemoved are already removed. waitForElementToBeRemoved requires that the element(s) exist(s) before waiting for removal.")}async function waitForElementToBeRemoved($,j){const it=new Error("Timed out in waitForElementToBeRemoved.");if(typeof $!="function"){initialCheck($);const ut=(Array.isArray($)?$:[$]).map(dt=>{let mt=dt.parentElement;if(mt===null)return()=>null;for(;mt.parentElement;)mt=mt.parentElement;return()=>mt.contains(dt)?dt:null});$=()=>ut.map(dt=>dt()).filter(Boolean)}return initialCheck($()),waitForWrapper(()=>{let et;try{et=$()}catch(ut){if(ut.name==="TestingLibraryElementError")return;throw ut}if(!isRemoved(et))throw it},j)}const eventMap={copy:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},cut:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},paste:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionEnd:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionStart:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionUpdate:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keyDown:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},keyPress:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},keyUp:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},focus:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},blur:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},focusIn:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},focusOut:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},change:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},input:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},invalid:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!0}},submit:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}},reset:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}},click:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,button:0,composed:!0}},contextMenu:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dblClick:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},drag:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragEnd:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragEnter:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragExit:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragLeave:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragOver:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragStart:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},drop:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseDown:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseEnter:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseLeave:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseMove:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseOut:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseOver:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseUp:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},select:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},touchCancel:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},touchEnd:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},touchMove:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},touchStart:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},resize:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},scroll:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},wheel:{EventType:"WheelEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},abort:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},canPlay:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},canPlayThrough:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},durationChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},emptied:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},encrypted:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},ended:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadedData:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadedMetadata:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadStart:{EventType:"ProgressEvent",defaultInit:{bubbles:!1,cancelable:!1}},pause:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},play:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},playing:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},progress:{EventType:"ProgressEvent",defaultInit:{bubbles:!1,cancelable:!1}},rateChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},seeked:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},seeking:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},stalled:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},suspend:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},timeUpdate:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},volumeChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},waiting:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},load:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},error:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},animationStart:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},animationEnd:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},animationIteration:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionCancel:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionEnd:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}},transitionRun:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionStart:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},pointerOver:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerEnter:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},pointerDown:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerMove:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerUp:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerCancel:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},pointerOut:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerLeave:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},gotPointerCapture:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},lostPointerCapture:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},popState:{EventType:"PopStateEvent",defaultInit:{bubbles:!0,cancelable:!1}},offline:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},online:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}}},eventAliasMap={doubleClick:"dblClick"};function fireEvent($,j){return getConfig().eventWrapper(()=>{if(!j)throw new Error("Unable to fire an event - please provide an event object.");if(!$)throw new Error('Unable to fire a "'+j.type+'" event - please provide a DOM element.');return $.dispatchEvent(j)})}function createEvent($,j,it,et){let{EventType:ut="Event",defaultInit:dt={}}=et===void 0?{}:et;if(!j)throw new Error('Unable to fire a "'+$+'" event - please provide a DOM element.');const mt={...dt,...it},{target:{value:yt,files:bt,...Rt}={}}=mt;yt!==void 0&&setNativeValue(j,yt),bt!==void 0&&Object.defineProperty(j,"files",{configurable:!0,enumerable:!0,writable:!0,value:bt}),Object.assign(j,Rt);const jt=getWindowFromNode$1(j),Vt=jt[ut]||jt.Event;let zt;if(typeof Vt=="function")zt=new Vt($,mt);else{zt=jt.document.createEvent(ut);const{bubbles:rr,cancelable:Yt,detail:dr,...Ft}=mt;zt.initEvent($,rr,Yt,dr),Object.keys(Ft).forEach(Ht=>{zt[Ht]=Ft[Ht]})}return["dataTransfer","clipboardData"].forEach(rr=>{const Yt=mt[rr];typeof Yt=="object"&&(typeof jt.DataTransfer=="function"?Object.defineProperty(zt,rr,{value:Object.getOwnPropertyNames(Yt).reduce((dr,Ft)=>(Object.defineProperty(dr,Ft,{value:Yt[Ft]}),dr),new jt.DataTransfer)}):Object.defineProperty(zt,rr,{value:Yt}))}),zt}Object.keys(eventMap).forEach($=>{const{EventType:j,defaultInit:it}=eventMap[$],et=$.toLowerCase();createEvent[$]=(ut,dt)=>createEvent(et,ut,dt,{EventType:j,defaultInit:it}),fireEvent[$]=(ut,dt)=>fireEvent(ut,createEvent[$](ut,dt))});function setNativeValue($,j){const{set:it}=Object.getOwnPropertyDescriptor($,"value")||{},et=Object.getPrototypeOf($),{set:ut}=Object.getOwnPropertyDescriptor(et,"value")||{};if(ut&&it!==ut)ut.call($,j);else if(it)it.call($,j);else throw new Error("The given element does not have a value setter")}Object.keys(eventAliasMap).forEach($=>{const j=eventAliasMap[$];fireEvent[$]=function(){return fireEvent[j](...arguments)}});function unindent($){return $.replace(/[ \t]*[\n][ \t]*/g,`
`)}function encode($){return lzString.compressToEncodedURIComponent(unindent($))}function getPlaygroundUrl($){return"https://testing-playground.com/#markup="+encode($)}const debug=($,j,it)=>Array.isArray($)?$.forEach(et=>logDOM(et,j,it)):logDOM($,j,it),logTestingPlaygroundURL=function($){if($===void 0&&($=getDocument$1().body),!$||!("innerHTML"in $)){console.log("The element you're providing isn't a valid DOM element.");return}if(!$.innerHTML){console.log("The provided element doesn't have any children.");return}const j=getPlaygroundUrl($.innerHTML);return console.log(`Open this URL in your browser

`+j),j},initialValue={debug,logTestingPlaygroundURL},screen$1=typeof document<"u"&&document.body?getQueriesForElement(document.body,queries,initialValue):Object.keys(queries).reduce(($,j)=>($[j]=()=>{throw new TypeError("For queries bound to document.body a global document has to be available... Learn more: https://testing-library.com/s/screen-global-error")},$),initialValue),dom_esm=Object.freeze(Object.defineProperty({__proto__:null,buildQueries,configure,createEvent,findAllByAltText,findAllByDisplayValue,findAllByLabelText,findAllByPlaceholderText,findAllByRole,findAllByTestId,findAllByText,findAllByTitle,findByAltText,findByDisplayValue,findByLabelText,findByPlaceholderText,findByRole,findByTestId,findByText,findByTitle,fireEvent,getAllByAltText,getAllByDisplayValue,getAllByLabelText:getAllByLabelTextWithSuggestions,getAllByPlaceholderText,getAllByRole,getAllByTestId,getAllByText,getAllByTitle,getByAltText,getByDisplayValue,getByLabelText:getByLabelTextWithSuggestions,getByPlaceholderText,getByRole,getByTestId,getByText,getByTitle,getConfig,getDefaultNormalizer,getElementError,getMultipleElementsFoundError,getNodeText,getQueriesForElement,getRoles,getSuggestedQuery,isInaccessible,logDOM,logRoles,makeFindQuery,makeGetAllQuery,makeSingleQuery,prettyDOM,prettyFormat:index$1,queries,queryAllByAltText:queryAllByAltTextWithSuggestions,queryAllByAttribute,queryAllByDisplayValue:queryAllByDisplayValueWithSuggestions,queryAllByLabelText:queryAllByLabelTextWithSuggestions,queryAllByPlaceholderText:queryAllByPlaceholderTextWithSuggestions,queryAllByRole:queryAllByRoleWithSuggestions,queryAllByTestId:queryAllByTestIdWithSuggestions,queryAllByText:queryAllByTextWithSuggestions,queryAllByTitle:queryAllByTitleWithSuggestions,queryByAltText,queryByAttribute,queryByDisplayValue,queryByLabelText,queryByPlaceholderText,queryByRole,queryByTestId,queryByText,queryByTitle,queryHelpers,screen:screen$1,waitFor:waitForWrapper,waitForElementToBeRemoved,within:getQueriesForElement,wrapAllByQueryWithSuggestion,wrapSingleQueryWithSuggestion},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(dom_esm);var utils={},getMouseEventOptions$1={};Object.defineProperty(getMouseEventOptions$1,"__esModule",{value:!0});getMouseEventOptions$1.getMouseEventOptions=getMouseEventOptions;function isMousePressEvent($){return $==="mousedown"||$==="mouseup"||$==="click"||$==="dblclick"}const BUTTONS_NAMES={none:0,primary:1,secondary:2,auxiliary:4},BUTTON_NAMES={primary:0,auxiliary:1,secondary:2};function translateButtonNumber($,j){var it;const[et,ut]=j==="button"?[BUTTON_NAMES,BUTTONS_NAMES]:[BUTTONS_NAMES,BUTTON_NAMES],dt=(it=Object.entries(et).find(([,mt])=>mt===$))==null?void 0:it[0];return dt&&Object.prototype.hasOwnProperty.call(ut,dt)?ut[dt]:0}function convertMouseButtons($,j,it){return isMousePressEvent($)?typeof j[it]=="number"?j[it]:it==="button"&&typeof j.buttons=="number"?translateButtonNumber(j.buttons,"buttons"):it==="buttons"&&typeof j.button=="number"?translateButtonNumber(j.button,"button"):it!="button"&&isMousePressEvent($)?1:0:0}function getMouseEventOptions($,j,it=0){var et;return j=(et=j)!=null?et:{},{...j,detail:$==="mousedown"||$==="mouseup"||$==="click"?1+it:it,buttons:convertMouseButtons($,j,"buttons"),button:convertMouseButtons($,j,"button")}}var isClickableInput$1={},isElementType$1={};Object.defineProperty(isElementType$1,"__esModule",{value:!0});isElementType$1.isElementType=isElementType;function isElementType($,j,it){return $.namespaceURI&&$.namespaceURI!=="http://www.w3.org/1999/xhtml"||(j=Array.isArray(j)?j:[j],!j.includes($.tagName.toLowerCase()))?!1:it?Object.entries(it).every(([et,ut])=>$[et]===ut):!0}Object.defineProperty(isClickableInput$1,"__esModule",{value:!0});isClickableInput$1.isClickableInput=isClickableInput;var _isElementType$5=isElementType$1;const CLICKABLE_INPUT_TYPES=["button","color","file","image","reset","submit","checkbox","radio"];function isClickableInput($){return(0,_isElementType$5.isElementType)($,"button")||(0,_isElementType$5.isElementType)($,"input")&&CLICKABLE_INPUT_TYPES.includes($.type)}var buildTimeValue$1={};Object.defineProperty(buildTimeValue$1,"__esModule",{value:!0});buildTimeValue$1.buildTimeValue=buildTimeValue;function buildTimeValue($){const j=$.replace(/\D/g,"");if(j.length<2)return $;const it=parseInt(j[0],10),et=parseInt(j[1],10);if(it>=3||it===2&&et>=4){let ut;return it>=3?ut=1:ut=2,build(j,ut)}return $.length===2?$:build(j,2)}function build($,j){const it=$.slice(0,j),et=Math.min(parseInt(it,10),23),ut=$.slice(j),dt=parseInt(ut,10),mt=Math.min(dt,59);return`${et.toString().padStart(2,"0")}:${mt.toString().padStart(2,"0")}`}var calculateNewValue$1={},selectionRange={};Object.defineProperty(selectionRange,"__esModule",{value:!0});selectionRange.getSelectionRange=getSelectionRange;selectionRange.hasSelectionSupport=hasSelectionSupport;selectionRange.setSelectionRange=setSelectionRange;var _isElementType$4=isElementType$1,selectionSupportType;(function($){$.text="text",$.search="search",$.url="url",$.tel="tel",$.password="password"})(selectionSupportType||(selectionSupportType={}));const InputSelection=Symbol("inputSelection");function hasSelectionSupport($){return(0,_isElementType$4.isElementType)($,"textarea")||(0,_isElementType$4.isElementType)($,"input")&&!!selectionSupportType[$.type]}function getSelectionRange($){if(hasSelectionSupport($))return{selectionStart:$.selectionStart,selectionEnd:$.selectionEnd};if((0,_isElementType$4.isElementType)($,"input")){var j;return(j=$[InputSelection])!=null?j:{selectionStart:null,selectionEnd:null}}const it=$.ownerDocument.getSelection();if(it!=null&&it.rangeCount&&$.contains(it.focusNode)){const et=it.getRangeAt(0);return{selectionStart:et.startOffset,selectionEnd:et.endOffset}}else return{selectionStart:null,selectionEnd:null}}function setSelectionRange($,j,it){const{selectionStart:et,selectionEnd:ut}=getSelectionRange($);if(et===j&&ut===it||(hasSelectionSupport($)&&$.setSelectionRange(j,it),(0,_isElementType$4.isElementType)($,"input")&&($[InputSelection]={selectionStart:j,selectionEnd:it}),(0,_isElementType$4.isElementType)($,"input")||(0,_isElementType$4.isElementType)($,"textarea")))return;const dt=$.ownerDocument.createRange();dt.selectNodeContents($),$.firstChild&&(dt.setStart($.firstChild,j),dt.setEnd($.firstChild,it));const mt=$.ownerDocument.getSelection();mt&&(mt.removeAllRanges(),mt.addRange(dt))}var getValue$1={},isContentEditable$1={};Object.defineProperty(isContentEditable$1,"__esModule",{value:!0});isContentEditable$1.isContentEditable=isContentEditable;function isContentEditable($){return $.hasAttribute("contenteditable")&&($.getAttribute("contenteditable")=="true"||$.getAttribute("contenteditable")=="")}Object.defineProperty(getValue$1,"__esModule",{value:!0});getValue$1.getValue=getValue;var _isContentEditable$1=isContentEditable$1;function getValue($){return $?(0,_isContentEditable$1.isContentEditable)($)?$.textContent:$.value:null}var isValidDateValue$1={};Object.defineProperty(isValidDateValue$1,"__esModule",{value:!0});isValidDateValue$1.isValidDateValue=isValidDateValue;function isValidDateValue($,j){const it=$.cloneNode();return it.value=j,it.value===j}var isValidInputTimeValue$1={};Object.defineProperty(isValidInputTimeValue$1,"__esModule",{value:!0});isValidInputTimeValue$1.isValidInputTimeValue=isValidInputTimeValue;function isValidInputTimeValue($,j){const it=$.cloneNode();return it.value=j,it.value===j}Object.defineProperty(calculateNewValue$1,"__esModule",{value:!0});calculateNewValue$1.calculateNewValue=calculateNewValue;var _selectionRange$1=selectionRange,_getValue2$1=getValue$1,_isValidDateValue=isValidDateValue$1,_isValidInputTimeValue=isValidInputTimeValue$1;function calculateNewValue($,j,it=(()=>{var dt;return(dt=(0,_getValue2$1.getValue)(j))!=null?dt:""})(),et=(0,_selectionRange$1.getSelectionRange)(j),ut){const dt=et.selectionStart===null?it.length:et.selectionStart,mt=et.selectionEnd===null?it.length:et.selectionEnd,yt=Math.max(0,dt===mt&&ut==="backward"?dt-1:dt),bt=it.substring(0,yt),Rt=Math.min(it.length,dt===mt&&ut==="forward"?mt+1:mt),jt=it.substring(Rt,it.length);let Vt=`${bt}${$}${jt}`;const zt=yt+$.length;return j.type==="date"&&!(0,_isValidDateValue.isValidDateValue)(j,Vt)&&(Vt=it),j.type==="time"&&!(0,_isValidInputTimeValue.isValidInputTimeValue)(j,Vt)&&((0,_isValidInputTimeValue.isValidInputTimeValue)(j,$)?Vt=$:Vt=it),{newValue:Vt,newSelectionStart:zt}}var cursorPosition={};Object.defineProperty(cursorPosition,"__esModule",{value:!0});cursorPosition.isCursorAtEnd=isCursorAtEnd;cursorPosition.isCursorAtStart=isCursorAtStart;var _selectionRange=selectionRange,_getValue2=getValue$1;function isCursorAtEnd($){var j;const{selectionStart:it,selectionEnd:et}=(0,_selectionRange.getSelectionRange)($);return it===et&&(it??0)===((j=(0,_getValue2.getValue)($))!=null?j:"").length}function isCursorAtStart($){const{selectionStart:j,selectionEnd:it}=(0,_selectionRange.getSelectionRange)($);return j===it&&(j??0)===0}var hasUnreliableEmptyValue$1={};Object.defineProperty(hasUnreliableEmptyValue$1,"__esModule",{value:!0});hasUnreliableEmptyValue$1.hasUnreliableEmptyValue=hasUnreliableEmptyValue;var _isElementType$3=isElementType$1,unreliableValueInputTypes;(function($){$.number="number"})(unreliableValueInputTypes||(unreliableValueInputTypes={}));function hasUnreliableEmptyValue($){return(0,_isElementType$3.isElementType)($,"input")&&!!unreliableValueInputTypes[$.type]}var isEditable$1={};Object.defineProperty(isEditable$1,"__esModule",{value:!0});isEditable$1.editableInputTypes=void 0;isEditable$1.isEditable=isEditable;isEditable$1.isEditableInput=isEditableInput;var _isElementType$2=isElementType$1,_isContentEditable=isContentEditable$1;function isEditable($){return isEditableInput($)||(0,_isElementType$2.isElementType)($,"textarea",{readOnly:!1})||(0,_isContentEditable.isContentEditable)($)}let editableInputTypes;isEditable$1.editableInputTypes=editableInputTypes;(function($){$.text="text",$.date="date",$["datetime-local"]="datetime-local",$.email="email",$.month="month",$.number="number",$.password="password",$.search="search",$.tel="tel",$.time="time",$.url="url",$.week="week"})(editableInputTypes||(isEditable$1.editableInputTypes=editableInputTypes={}));function isEditableInput($){return(0,_isElementType$2.isElementType)($,"input",{readOnly:!1})&&!!editableInputTypes[$.type]}var maxLength={};Object.defineProperty(maxLength,"__esModule",{value:!0});maxLength.getSpaceUntilMaxLength=getSpaceUntilMaxLength;var _isElementType$1=isElementType$1,_getValue=getValue$1,maxLengthSupportedTypes;(function($){$.email="email",$.password="password",$.search="search",$.telephone="telephone",$.text="text",$.url="url"})(maxLengthSupportedTypes||(maxLengthSupportedTypes={}));function getSpaceUntilMaxLength($){const j=(0,_getValue.getValue)($);if(j===null)return;const it=getSanitizedMaxLength($);return it?it-j.length:void 0}function getSanitizedMaxLength($){var j;if(!supportsMaxLength($))return;const it=(j=$.getAttribute("maxlength"))!=null?j:"";return/^\d+$/.test(it)&&Number(it)>=0?Number(it):void 0}function supportsMaxLength($){return(0,_isElementType$1.isElementType)($,"textarea")||(0,_isElementType$1.isElementType)($,"input")&&!!maxLengthSupportedTypes[$.type]}var getActiveElement$1={},isDisabled$1={};Object.defineProperty(isDisabled$1,"__esModule",{value:!0});isDisabled$1.isDisabled=isDisabled;function isDisabled($){return!!($&&$.disabled)}Object.defineProperty(getActiveElement$1,"__esModule",{value:!0});getActiveElement$1.getActiveElement=getActiveElement;var _isDisabled$1=isDisabled$1;function getActiveElement($){const j=$.activeElement;return j!=null&&j.shadowRoot?getActiveElement(j.shadowRoot):(0,_isDisabled$1.isDisabled)(j)?$.ownerDocument?$.ownerDocument.body:$.body:j}var isFocusable$1={},isLabelWithInternallyDisabledControl$1={};Object.defineProperty(isLabelWithInternallyDisabledControl$1,"__esModule",{value:!0});isLabelWithInternallyDisabledControl$1.isLabelWithInternallyDisabledControl=isLabelWithInternallyDisabledControl;var _isDisabled=isDisabled$1,_isElementType=isElementType$1;function isLabelWithInternallyDisabledControl($){if(!(0,_isElementType.isElementType)($,"label"))return!1;const j=$.control;return!!(j&&$.contains(j)&&(0,_isDisabled.isDisabled)(j))}var selector={};Object.defineProperty(selector,"__esModule",{value:!0});selector.FOCUSABLE_SELECTOR=void 0;const FOCUSABLE_SELECTOR=["input:not([type=hidden]):not([disabled])","button:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[contenteditable=""]','[contenteditable="true"]',"a[href]","[tabindex]:not([disabled])"].join(", ");selector.FOCUSABLE_SELECTOR=FOCUSABLE_SELECTOR;Object.defineProperty(isFocusable$1,"__esModule",{value:!0});isFocusable$1.isFocusable=isFocusable;var _isLabelWithInternallyDisabledControl=isLabelWithInternallyDisabledControl$1,_selector=selector;function isFocusable($){return!(0,_isLabelWithInternallyDisabledControl.isLabelWithInternallyDisabledControl)($)&&$.matches(_selector.FOCUSABLE_SELECTOR)}var eventWrapper$1={};Object.defineProperty(eventWrapper$1,"__esModule",{value:!0});eventWrapper$1.eventWrapper=eventWrapper;var _dom$c=require$$0;function eventWrapper($){let j;return(0,_dom$c.getConfig)().eventWrapper(()=>{j=$()}),j}var isVisible$1={},helpers={};Object.defineProperty(helpers,"__esModule",{value:!0});helpers.TEXT_NODE=void 0;helpers.checkContainerType=checkContainerType;helpers.getDocument=getDocument;helpers.getWindowFromNode=getWindowFromNode;helpers.jestFakeTimersAreEnabled=jestFakeTimersAreEnabled;const TEXT_NODE=3;helpers.TEXT_NODE=TEXT_NODE;function jestFakeTimersAreEnabled(){return typeof jest<"u"&&jest!==null?setTimeout._isMockFunction===!0||Object.prototype.hasOwnProperty.call(setTimeout,"clock"):!1}function getDocument(){if(typeof window>"u")throw new Error("Could not find default container");return window.document}function getWindowFromNode($){if($.defaultView)return $.defaultView;if($.ownerDocument&&$.ownerDocument.defaultView)return $.ownerDocument.defaultView;if($.window)return $.window;throw $.ownerDocument&&$.ownerDocument.defaultView===null?new Error("It looks like the window object is not available for the provided node."):$.then instanceof Function?new Error("It looks like you passed a Promise object instead of a DOM node. Did you do something like `fireEvent.click(screen.findBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`, or await the findBy query `fireEvent.click(await screen.findBy...`?"):Array.isArray($)?new Error("It looks like you passed an Array instead of a DOM node. Did you do something like `fireEvent.click(screen.getAllBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`?"):typeof $.debug=="function"&&typeof $.logTestingPlaygroundURL=="function"?new Error("It looks like you passed a `screen` object. Did you do something like `fireEvent.click(screen, ...` when you meant to use a query, e.g. `fireEvent.click(screen.getBy..., `?"):new Error(`The given node is not an Element, the node type is: ${typeof $}.`)}function checkContainerType($){if(!$||typeof $.querySelector!="function"||typeof $.querySelectorAll!="function")throw new TypeError(`Expected container to be an Element, a Document or a DocumentFragment but got ${j($)}.`);function j(it){return typeof it=="object"?it===null?"null":it.constructor.name:typeof it}}Object.defineProperty(isVisible$1,"__esModule",{value:!0});isVisible$1.isVisible=isVisible;var _helpers$1=helpers;function isVisible($){const j=(0,_helpers$1.getWindowFromNode)($);for(let et=$;(it=et)!=null&&it.ownerDocument;et=et.parentElement){var it;if(j.getComputedStyle(et).display==="none")return!1}return!0}var isDocument$1={};Object.defineProperty(isDocument$1,"__esModule",{value:!0});isDocument$1.isDocument=isDocument;function isDocument($){return $.nodeType===$.DOCUMENT_NODE}var wait$1={};Object.defineProperty(wait$1,"__esModule",{value:!0});wait$1.wait=wait;function wait($){return new Promise(j=>setTimeout(()=>j(),$))}var hasPointerEvents$1={};Object.defineProperty(hasPointerEvents$1,"__esModule",{value:!0});hasPointerEvents$1.hasPointerEvents=hasPointerEvents;var _helpers=helpers;function hasPointerEvents($){const j=(0,_helpers.getWindowFromNode)($);for(let et=$;(it=et)!=null&&it.ownerDocument;et=et.parentElement){var it;const ut=j.getComputedStyle(et).pointerEvents;if(ut&&!["inherit","unset"].includes(ut))return ut!=="none"}return!0}var hasFormSubmit$1={};Object.defineProperty(hasFormSubmit$1,"__esModule",{value:!0});hasFormSubmit$1.hasFormSubmit=void 0;const hasFormSubmit=$=>!!($&&($.querySelector('input[type="submit"]')||$.querySelector('button[type="submit"]')));hasFormSubmit$1.hasFormSubmit=hasFormSubmit;(function($){Object.defineProperty($,"__esModule",{value:!0});var j=getMouseEventOptions$1;Object.keys(j).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===j[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return j[tr]}})});var it=isClickableInput$1;Object.keys(it).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===it[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return it[tr]}})});var et=buildTimeValue$1;Object.keys(et).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===et[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return et[tr]}})});var ut=calculateNewValue$1;Object.keys(ut).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===ut[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return ut[tr]}})});var dt=cursorPosition;Object.keys(dt).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===dt[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return dt[tr]}})});var mt=getValue$1;Object.keys(mt).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===mt[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return mt[tr]}})});var yt=hasUnreliableEmptyValue$1;Object.keys(yt).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===yt[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return yt[tr]}})});var bt=isContentEditable$1;Object.keys(bt).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===bt[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return bt[tr]}})});var Rt=isEditable$1;Object.keys(Rt).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===Rt[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return Rt[tr]}})});var jt=isValidDateValue$1;Object.keys(jt).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===jt[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return jt[tr]}})});var Vt=isValidInputTimeValue$1;Object.keys(Vt).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===Vt[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return Vt[tr]}})});var zt=maxLength;Object.keys(zt).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===zt[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return zt[tr]}})});var Jt=selectionRange;Object.keys(Jt).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===Jt[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return Jt[tr]}})});var rr=getActiveElement$1;Object.keys(rr).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===rr[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return rr[tr]}})});var Yt=isFocusable$1;Object.keys(Yt).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===Yt[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return Yt[tr]}})});var dr=selector;Object.keys(dr).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===dr[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return dr[tr]}})});var Ft=eventWrapper$1;Object.keys(Ft).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===Ft[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return Ft[tr]}})});var Ht=isElementType$1;Object.keys(Ht).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===Ht[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return Ht[tr]}})});var er=isLabelWithInternallyDisabledControl$1;Object.keys(er).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===er[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return er[tr]}})});var pr=isVisible$1;Object.keys(pr).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===pr[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return pr[tr]}})});var or=isDisabled$1;Object.keys(or).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===or[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return or[tr]}})});var ar=isDocument$1;Object.keys(ar).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===ar[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return ar[tr]}})});var Wt=wait$1;Object.keys(Wt).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===Wt[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return Wt[tr]}})});var Zt=hasPointerEvents$1;Object.keys(Zt).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===Zt[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return Zt[tr]}})});var sr=hasFormSubmit$1;Object.keys(sr).forEach(function(tr){tr==="default"||tr==="__esModule"||tr in $&&$[tr]===sr[tr]||Object.defineProperty($,tr,{enumerable:!0,get:function(){return sr[tr]}})})})(utils);var hover$1={};Object.defineProperty(hover$1,"__esModule",{value:!0});hover$1.hover=hover;hover$1.unhover=unhover;var _dom$b=require$$0,_utils$i=utils;function getParentElements($){const j=[$];let it=$;for(;(it=it.parentElement)!=null;)j.push(it);return j}function hover($,j,{skipPointerEventsCheck:it=!1}={}){if(!it&&!(0,_utils$i.hasPointerEvents)($))throw new Error('unable to hover element as it has or inherits pointer-events set to "none".');if((0,_utils$i.isLabelWithInternallyDisabledControl)($))return;const et=getParentElements($).reverse();_dom$b.fireEvent.pointerOver($,j);for(const ut of et)_dom$b.fireEvent.pointerEnter(ut,j);if(!(0,_utils$i.isDisabled)($)){_dom$b.fireEvent.mouseOver($,(0,_utils$i.getMouseEventOptions)("mouseover",j));for(const ut of et)_dom$b.fireEvent.mouseEnter(ut,(0,_utils$i.getMouseEventOptions)("mouseenter",j))}_dom$b.fireEvent.pointerMove($,j),(0,_utils$i.isDisabled)($)||_dom$b.fireEvent.mouseMove($,(0,_utils$i.getMouseEventOptions)("mousemove",j))}function unhover($,j,{skipPointerEventsCheck:it=!1}={}){if(!it&&!(0,_utils$i.hasPointerEvents)($))throw new Error('unable to unhover element as it has or inherits pointer-events set to "none".');if((0,_utils$i.isLabelWithInternallyDisabledControl)($))return;const et=getParentElements($);_dom$b.fireEvent.pointerMove($,j),(0,_utils$i.isDisabled)($)||_dom$b.fireEvent.mouseMove($,(0,_utils$i.getMouseEventOptions)("mousemove",j)),_dom$b.fireEvent.pointerOut($,j);for(const ut of et)_dom$b.fireEvent.pointerLeave(ut,j);if(!(0,_utils$i.isDisabled)($)){_dom$b.fireEvent.mouseOut($,(0,_utils$i.getMouseEventOptions)("mouseout",j));for(const ut of et)_dom$b.fireEvent.mouseLeave(ut,(0,_utils$i.getMouseEventOptions)("mouseleave",j))}}var blur$1={};Object.defineProperty(blur$1,"__esModule",{value:!0});blur$1.blur=blur;var _utils$h=utils;function blur($){!(0,_utils$h.isFocusable)($)||!((0,_utils$h.getActiveElement)($.ownerDocument)===$)||(0,_utils$h.eventWrapper)(()=>$.blur())}var focus$1={};Object.defineProperty(focus$1,"__esModule",{value:!0});focus$1.focus=focus;var _utils$g=utils;function focus($){!(0,_utils$g.isFocusable)($)||(0,_utils$g.getActiveElement)($.ownerDocument)===$||(0,_utils$g.eventWrapper)(()=>$.focus())}Object.defineProperty(click$1,"__esModule",{value:!0});click$1.click=click;click$1.dblClick=dblClick;var _dom$a=require$$0,_utils$f=utils,_hover$1=hover$1,_blur$2=blur$1,_focus$3=focus$1;function getPreviouslyFocusedElement($){const j=$.ownerDocument.activeElement;return j&&j!==$.ownerDocument.body&&j!==$?j:null}function clickLabel($,j,{clickCount:it}){(0,_utils$f.isLabelWithInternallyDisabledControl)($)||(_dom$a.fireEvent.pointerDown($,j),_dom$a.fireEvent.mouseDown($,(0,_utils$f.getMouseEventOptions)("mousedown",j,it)),_dom$a.fireEvent.pointerUp($,j),_dom$a.fireEvent.mouseUp($,(0,_utils$f.getMouseEventOptions)("mouseup",j,it)),fireClick($,(0,_utils$f.getMouseEventOptions)("click",j,it)),$.control&&(0,_focus$3.focus)($.control))}function clickBooleanElement($,j,{clickCount:it}){_dom$a.fireEvent.pointerDown($,j),$.disabled||_dom$a.fireEvent.mouseDown($,(0,_utils$f.getMouseEventOptions)("mousedown",j,it)),(0,_focus$3.focus)($),_dom$a.fireEvent.pointerUp($,j),$.disabled||(_dom$a.fireEvent.mouseUp($,(0,_utils$f.getMouseEventOptions)("mouseup",j,it)),fireClick($,(0,_utils$f.getMouseEventOptions)("click",j,it)))}function clickElement($,j,{clickCount:it}){const et=getPreviouslyFocusedElement($);if(_dom$a.fireEvent.pointerDown($,j),!(0,_utils$f.isDisabled)($)&&_dom$a.fireEvent.mouseDown($,(0,_utils$f.getMouseEventOptions)("mousedown",j,it))){const dt=findClosest($,_utils$f.isFocusable);et&&!dt?(0,_blur$2.blur)(et):dt&&(0,_focus$3.focus)(dt)}if(_dom$a.fireEvent.pointerUp($,j),!(0,_utils$f.isDisabled)($)){_dom$a.fireEvent.mouseUp($,(0,_utils$f.getMouseEventOptions)("mouseup",j,it)),fireClick($,(0,_utils$f.getMouseEventOptions)("click",j,it));const ut=$.closest("label");ut!=null&&ut.control&&(0,_focus$3.focus)(ut.control)}}function findClosest($,j){let it=$;do{if(j(it))return it;it=it.parentElement}while(it&&it!==$.ownerDocument.body)}function click($,j,{skipHover:it=!1,clickCount:et=0,skipPointerEventsCheck:ut=!1}={}){if(!ut&&!(0,_utils$f.hasPointerEvents)($))throw new Error('unable to click element as it has or inherits pointer-events set to "none".');it||(0,_hover$1.hover)($,j,{skipPointerEventsCheck:!0}),(0,_utils$f.isElementType)($,"label")?clickLabel($,j,{clickCount:et}):(0,_utils$f.isElementType)($,"input")?$.type==="checkbox"||$.type==="radio"?clickBooleanElement($,j,{clickCount:et}):clickElement($,j,{clickCount:et}):clickElement($,j,{clickCount:et})}function fireClick($,j){j.button===2?_dom$a.fireEvent.contextMenu($,j):_dom$a.fireEvent.click($,j)}function dblClick($,j,{skipPointerEventsCheck:it=!1}={}){if(!it&&!(0,_utils$f.hasPointerEvents)($))throw new Error('unable to double-click element as it has or inherits pointer-events set to "none".');(0,_hover$1.hover)($,j,{skipPointerEventsCheck:it}),click($,j,{skipHover:!0,clickCount:0,skipPointerEventsCheck:it}),click($,j,{skipHover:!0,clickCount:1,skipPointerEventsCheck:it}),_dom$a.fireEvent.dblClick($,(0,_utils$f.getMouseEventOptions)("dblclick",j,2))}var type$1={},typeImplementation$1={},keyboard={},keyboardImplementation$1={},getNextKeyDef$1={};Object.defineProperty(getNextKeyDef$1,"__esModule",{value:!0});getNextKeyDef$1.getNextKeyDef=getNextKeyDef;var bracketDict;(function($){$["{"]="}",$["["]="]"})(bracketDict||(bracketDict={}));var legacyModifiers;(function($){$.alt="alt",$.ctrl="ctrl",$.meta="meta",$.shift="shift"})(legacyModifiers||(legacyModifiers={}));var legacyKeyMap;(function($){$.ctrl="Control",$.del="Delete",$.esc="Escape",$.space=" "})(legacyKeyMap||(legacyKeyMap={}));function getNextKeyDef($,j){var it;const{type:et,descriptor:ut,consumedLength:dt,releasePrevious:mt,releaseSelf:yt,repeat:bt}=readNextDescriptor($);return{keyDef:(it=j.keyboardMap.find(jt=>{if(et==="["){var Vt;return((Vt=jt.code)==null?void 0:Vt.toLowerCase())===ut.toLowerCase()}else if(et==="{"){var zt;const Jt=mapLegacyKey(ut);return((zt=jt.key)==null?void 0:zt.toLowerCase())===Jt.toLowerCase()}return jt.key===ut}))!=null?it:{key:"Unknown",code:"Unknown",[et==="["?"code":"key"]:ut},consumedLength:dt,releasePrevious:mt,releaseSelf:yt,repeat:bt}}function readNextDescriptor($){let j=0;const it=$[j]in bracketDict?$[j]:"";j+=it.length;const et=it?$.match(new RegExp(`^\\${it}+`))[0].length:0,dt=et===2||it==="{"&&et>3?"":it;return{type:dt,...dt===""?readPrintableChar($,j):readTag($,j,dt)}}function readPrintableChar($,j){const it=$[j];return assertDescriptor(it,$,j),j+=it.length,{consumedLength:j,descriptor:it,releasePrevious:!1,releaseSelf:!0,repeat:1}}function readTag($,j,it){var et,ut,dt;const mt=$[j]==="/"?"/":"";j+=mt.length;const yt=(et=$.slice(j).match(/^\w+/))==null?void 0:et[0];assertDescriptor(yt,$,j),j+=yt.length;const bt=(ut=(dt=$.slice(j).match(/^>\d+/))==null?void 0:dt[0])!=null?ut:"";j+=bt.length;const Rt=$[j]==="/"||!bt&&$[j]===">"?$[j]:"";j+=Rt.length;const jt=bracketDict[it],Vt=$[j]===jt?jt:"";if(!Vt)throw new Error(getErrorMessage([!bt&&"repeat modifier",!Rt&&"release modifier",`"${jt}"`].filter(Boolean).join(" or "),$[j],$));return j+=Vt.length,{consumedLength:j,descriptor:yt,releasePrevious:!!mt,repeat:bt?Math.max(Number(bt.substr(1)),1):1,releaseSelf:hasReleaseSelf(it,yt,Rt,bt)}}function assertDescriptor($,j,it){if(!$)throw new Error(getErrorMessage("key descriptor",j[it],j))}function getEnumValue($,j){return $[j]}function hasReleaseSelf($,j,it,et){return it?it==="/":!(et||$==="{"&&getEnumValue(legacyModifiers,j.toLowerCase()))}function mapLegacyKey($){var j;return(j=getEnumValue(legacyKeyMap,$))!=null?j:$}function getErrorMessage($,j,it){return`Expected ${$} but found "${j??""}" in "${it}"
    See https://github.com/testing-library/user-event/blob/main/README.md#keyboardtext-options
    for more information about how userEvent parses your input.`}var plugins$1={},arrow={};Object.defineProperty(arrow,"__esModule",{value:!0});arrow.keydownBehavior=void 0;var _utils$e=utils;const keydownBehavior$3=[{matches:($,j)=>($.key==="ArrowLeft"||$.key==="ArrowRight")&&(0,_utils$e.isElementType)(j,["input","textarea"]),handle:($,j)=>{var it;const{selectionStart:et,selectionEnd:ut}=(0,_utils$e.getSelectionRange)(j),dt=$.key==="ArrowLeft"?-1:1,mt=(it=et===ut?(et??0)+dt:dt<0?et:ut)!=null?it:0;(0,_utils$e.setSelectionRange)(j,mt,mt)}}];arrow.keydownBehavior=keydownBehavior$3;var control={},shared={},carryValue$1={};Object.defineProperty(carryValue$1,"__esModule",{value:!0});carryValue$1.carryValue=carryValue;var _utils$d=utils;function carryValue($,j,it){const et=(0,_utils$d.getValue)($);j.carryValue=et!==it&&et===""&&(0,_utils$d.hasUnreliableEmptyValue)($)?it:void 0}var fireChangeForInputTimeIfValid$1={};Object.defineProperty(fireChangeForInputTimeIfValid$1,"__esModule",{value:!0});fireChangeForInputTimeIfValid$1.fireChangeForInputTimeIfValid=fireChangeForInputTimeIfValid;var _dom$9=require$$0,_utils$c=utils;function fireChangeForInputTimeIfValid($,j,it){(0,_utils$c.isValidInputTimeValue)($,it)&&j!==it&&_dom$9.fireEvent.change($,{target:{value:it}})}var fireInputEvent$1={};Object.defineProperty(fireInputEvent$1,"__esModule",{value:!0});fireInputEvent$1.fireInputEvent=fireInputEvent;var _dom$8=require$$0,_utils$b=utils;function fireInputEvent($,{newValue:j,newSelectionStart:it,eventOverrides:et}){if((0,_utils$b.isContentEditable)($))applyNative($,"textContent",j);else if((0,_utils$b.isElementType)($,["input","textarea"]))applyNative($,"value",j);else throw new Error("Invalid Element");setSelectionRangeAfterInput($,it),_dom$8.fireEvent.input($,{...et}),setSelectionRangeAfterInputHandler($,j,it)}function setSelectionRangeAfterInput($,j){(0,_utils$b.setSelectionRange)($,j,j)}function setSelectionRangeAfterInputHandler($,j,it){const et=(0,_utils$b.getValue)($);if(!(et===""&&(0,_utils$b.hasUnreliableEmptyValue)($))&&et===j){const{selectionStart:dt}=(0,_utils$b.getSelectionRange)($);dt===et.length&&(0,_utils$b.setSelectionRange)($,it,it)}}const initial=Symbol("initial input value/textContent"),onBlur=Symbol("onBlur");function applyNative($,j,it){const et=Object.getOwnPropertyDescriptor($,j),ut=Object.getOwnPropertyDescriptor($.constructor.prototype,j);if(et&&ut&&Object.defineProperty($,j,ut),$[initial]===void 0&&($[initial]=String($[j])),$[j]=it,!$[onBlur]){var dt;(dt=$.ownerDocument.defaultView)==null||dt.addEventListener("blur",$[onBlur]=()=>{const mt=$[initial];delete $[onBlur],delete $[initial],String($[j])!==mt&&_dom$8.fireEvent.change($)},{capture:!0,once:!0})}et&&Object.defineProperty($,j,et)}(function($){Object.defineProperty($,"__esModule",{value:!0});var j=carryValue$1;Object.keys(j).forEach(function(ut){ut==="default"||ut==="__esModule"||ut in $&&$[ut]===j[ut]||Object.defineProperty($,ut,{enumerable:!0,get:function(){return j[ut]}})});var it=fireChangeForInputTimeIfValid$1;Object.keys(it).forEach(function(ut){ut==="default"||ut==="__esModule"||ut in $&&$[ut]===it[ut]||Object.defineProperty($,ut,{enumerable:!0,get:function(){return it[ut]}})});var et=fireInputEvent$1;Object.keys(et).forEach(function(ut){ut==="default"||ut==="__esModule"||ut in $&&$[ut]===et[ut]||Object.defineProperty($,ut,{enumerable:!0,get:function(){return et[ut]}})})})(shared);Object.defineProperty(control,"__esModule",{value:!0});control.keydownBehavior=void 0;var _utils$a=utils,_shared$2=shared;const keydownBehavior$2=[{matches:($,j)=>($.key==="Home"||$.key==="End")&&((0,_utils$a.isElementType)(j,["input","textarea"])||(0,_utils$a.isContentEditable)(j)),handle:($,j)=>{if($.key==="Home")(0,_utils$a.setSelectionRange)(j,0,0);else{var it,et;const ut=(it=(et=(0,_utils$a.getValue)(j))==null?void 0:et.length)!=null?it:0;(0,_utils$a.setSelectionRange)(j,ut,ut)}}},{matches:($,j)=>($.key==="PageUp"||$.key==="PageDown")&&(0,_utils$a.isElementType)(j,["input"]),handle:($,j)=>{if($.key==="PageUp")(0,_utils$a.setSelectionRange)(j,0,0);else{var it,et;const ut=(it=(et=(0,_utils$a.getValue)(j))==null?void 0:et.length)!=null?it:0;(0,_utils$a.setSelectionRange)(j,ut,ut)}}},{matches:($,j)=>$.key==="Delete"&&(0,_utils$a.isEditable)(j)&&!(0,_utils$a.isCursorAtEnd)(j),handle:($,j,it,et)=>{const{newValue:ut,newSelectionStart:dt}=(0,_utils$a.calculateNewValue)("",j,et.carryValue,void 0,"forward");(0,_shared$2.fireInputEvent)(j,{newValue:ut,newSelectionStart:dt,eventOverrides:{inputType:"deleteContentForward"}}),(0,_shared$2.carryValue)(j,et,ut)}}];control.keydownBehavior=keydownBehavior$2;var character={};Object.defineProperty(character,"__esModule",{value:!0});character.keypressBehavior=void 0;var _dom$7=require$$0,_shared$1=shared,_utils$9=utils;const keypressBehavior$2=[{matches:($,j)=>{var it;return((it=$.key)==null?void 0:it.length)===1&&(0,_utils$9.isElementType)(j,"input",{type:"time",readOnly:!1})},handle:($,j,it,et)=>{var ut;let dt=$.key;const mt=((ut=et.carryValue)!=null?ut:"")+dt,yt=(0,_utils$9.buildTimeValue)(mt);(0,_utils$9.isValidInputTimeValue)(j,yt)&&(dt=yt);const{newValue:bt,newSelectionStart:Rt}=(0,_utils$9.calculateNewValue)(dt,j),jt=(0,_utils$9.getValue)(j);jt!==bt&&(0,_shared$1.fireInputEvent)(j,{newValue:bt,newSelectionStart:Rt,eventOverrides:{data:$.key,inputType:"insertText"}}),(0,_shared$1.fireChangeForInputTimeIfValid)(j,jt,yt),et.carryValue=mt}},{matches:($,j)=>{var it;return((it=$.key)==null?void 0:it.length)===1&&(0,_utils$9.isElementType)(j,"input",{type:"date",readOnly:!1})},handle:($,j,it,et)=>{var ut;let dt=$.key;const mt=((ut=et.carryValue)!=null?ut:"")+dt,yt=(0,_utils$9.isValidDateValue)(j,mt);yt&&(dt=mt);const{newValue:bt,newSelectionStart:Rt}=(0,_utils$9.calculateNewValue)(dt,j);(0,_utils$9.getValue)(j)!==bt&&(0,_shared$1.fireInputEvent)(j,{newValue:bt,newSelectionStart:Rt,eventOverrides:{data:$.key,inputType:"insertText"}}),yt&&_dom$7.fireEvent.change(j,{target:{value:mt}}),et.carryValue=mt}},{matches:($,j)=>{var it;return((it=$.key)==null?void 0:it.length)===1&&(0,_utils$9.isElementType)(j,"input",{type:"number",readOnly:!1})},handle:($,j,it,et)=>{var ut,dt,mt,yt;if(!/[\d.\-e]/.test($.key))return;const bt=(ut=(dt=et.carryValue)!=null?dt:(0,_utils$9.getValue)(j))!=null?ut:"",{newValue:Rt,newSelectionStart:jt}=(0,_utils$9.calculateNewValue)($.key,j,bt),Vt=Rt.split("e",2);if(Number((mt=Rt.match(/-/g))==null?void 0:mt.length)>2||Number((yt=Rt.match(/\./g))==null?void 0:yt.length)>1||Vt[1]&&!/^-?\d*$/.test(Vt[1]))return;(0,_shared$1.fireInputEvent)(j,{newValue:Rt,newSelectionStart:jt,eventOverrides:{data:$.key,inputType:"insertText"}}),(0,_utils$9.getValue)(j)===Rt?et.carryValue=void 0:et.carryValue=Rt}},{matches:($,j)=>{var it;return((it=$.key)==null?void 0:it.length)===1&&((0,_utils$9.isElementType)(j,["input","textarea"],{readOnly:!1})&&!(0,_utils$9.isClickableInput)(j)||(0,_utils$9.isContentEditable)(j))&&(0,_utils$9.getSpaceUntilMaxLength)(j)!==0},handle:($,j)=>{const{newValue:it,newSelectionStart:et}=(0,_utils$9.calculateNewValue)($.key,j);(0,_shared$1.fireInputEvent)(j,{newValue:it,newSelectionStart:et,eventOverrides:{data:$.key,inputType:"insertText"}})}},{matches:($,j)=>$.key==="Enter"&&((0,_utils$9.isElementType)(j,"textarea",{readOnly:!1})||(0,_utils$9.isContentEditable)(j))&&(0,_utils$9.getSpaceUntilMaxLength)(j)!==0,handle:($,j,it,et)=>{const{newValue:ut,newSelectionStart:dt}=(0,_utils$9.calculateNewValue)(`
`,j),mt=(0,_utils$9.isContentEditable)(j)&&!et.modifiers.shift?"insertParagraph":"insertLineBreak";(0,_shared$1.fireInputEvent)(j,{newValue:ut,newSelectionStart:dt,eventOverrides:{inputType:mt}})}}];character.keypressBehavior=keypressBehavior$2;var functional={},getEventProps={};Object.defineProperty(getEventProps,"__esModule",{value:!0});getEventProps.getKeyEventProps=getKeyEventProps;getEventProps.getMouseEventProps=getMouseEventProps;function getKeyEventProps($,j){var it,et;return{key:$.key,code:$.code,altKey:j.modifiers.alt,ctrlKey:j.modifiers.ctrl,metaKey:j.modifiers.meta,shiftKey:j.modifiers.shift,keyCode:(it=$.keyCode)!=null?it:((et=$.key)==null?void 0:et.length)===1?$.key.charCodeAt(0):void 0}}function getMouseEventProps($){return{altKey:$.modifiers.alt,ctrlKey:$.modifiers.ctrl,metaKey:$.modifiers.meta,shiftKey:$.modifiers.shift}}Object.defineProperty(functional,"__esModule",{value:!0});functional.preKeyupBehavior=functional.preKeydownBehavior=functional.postKeyupBehavior=functional.keyupBehavior=functional.keypressBehavior=functional.keydownBehavior=void 0;var _dom$6=require$$0,_utils$8=utils,_getEventProps$1=getEventProps,_shared=shared;const modifierKeys={Alt:"alt",Control:"ctrl",Shift:"shift",Meta:"meta"},preKeydownBehavior$1=[...Object.entries(modifierKeys).map(([$,j])=>({matches:it=>it.key===$,handle:(it,et,ut,dt)=>{dt.modifiers[j]=!0}})),{matches:$=>$.key==="AltGraph",handle:($,j,it,et)=>{var ut;const dt=(ut=it.keyboardMap.find(mt=>mt.key==="Control"))!=null?ut:{key:"Control",code:"Control"};_dom$6.fireEvent.keyDown(j,(0,_getEventProps$1.getKeyEventProps)(dt,et))}}];functional.preKeydownBehavior=preKeydownBehavior$1;const keydownBehavior$1=[{matches:$=>$.key==="CapsLock",handle:($,j,it,et)=>{et.modifiers.caps=!et.modifiers.caps}},{matches:($,j)=>$.key==="Backspace"&&(0,_utils$8.isEditable)(j)&&!(0,_utils$8.isCursorAtStart)(j),handle:($,j,it,et)=>{const{newValue:ut,newSelectionStart:dt}=(0,_utils$8.calculateNewValue)("",j,et.carryValue,void 0,"backward");(0,_shared.fireInputEvent)(j,{newValue:ut,newSelectionStart:dt,eventOverrides:{inputType:"deleteContentBackward"}}),(0,_shared.carryValue)(j,et,ut)}}];functional.keydownBehavior=keydownBehavior$1;const keypressBehavior$1=[{matches:($,j)=>$.key==="Enter"&&(0,_utils$8.isElementType)(j,"input")&&["checkbox","radio"].includes(j.type),handle:($,j)=>{const it=j.form;(0,_utils$8.hasFormSubmit)(it)&&_dom$6.fireEvent.submit(it)}},{matches:($,j)=>$.key==="Enter"&&((0,_utils$8.isClickableInput)(j)||(0,_utils$8.isElementType)(j,"a")&&!!j.href),handle:($,j,it,et)=>{_dom$6.fireEvent.click(j,(0,_getEventProps$1.getMouseEventProps)(et))}},{matches:($,j)=>$.key==="Enter"&&(0,_utils$8.isElementType)(j,"input"),handle:($,j)=>{const it=j.form;it&&(it.querySelectorAll("input").length===1||(0,_utils$8.hasFormSubmit)(it))&&_dom$6.fireEvent.submit(it)}}];functional.keypressBehavior=keypressBehavior$1;const preKeyupBehavior$1=[...Object.entries(modifierKeys).map(([$,j])=>({matches:it=>it.key===$,handle:(it,et,ut,dt)=>{dt.modifiers[j]=!1}}))];functional.preKeyupBehavior=preKeyupBehavior$1;const keyupBehavior$1=[{matches:($,j)=>$.key===" "&&(0,_utils$8.isClickableInput)(j),handle:($,j,it,et)=>{_dom$6.fireEvent.click(j,(0,_getEventProps$1.getMouseEventProps)(et))}}];functional.keyupBehavior=keyupBehavior$1;const postKeyupBehavior$1=[{matches:$=>$.key==="AltGraph",handle:($,j,it,et)=>{var ut;const dt=(ut=it.keyboardMap.find(mt=>mt.key==="Control"))!=null?ut:{key:"Control",code:"Control"};_dom$6.fireEvent.keyUp(j,(0,_getEventProps$1.getKeyEventProps)(dt,et))}}];functional.postKeyupBehavior=postKeyupBehavior$1;Object.defineProperty(plugins$1,"__esModule",{value:!0});plugins$1.replaceBehavior=plugins$1.preKeyupBehavior=plugins$1.preKeydownBehavior=plugins$1.postKeyupBehavior=plugins$1.keyupBehavior=plugins$1.keypressBehavior=plugins$1.keydownBehavior=void 0;var _utils$7=utils,arrowKeys=_interopRequireWildcard$1(arrow),controlKeys=_interopRequireWildcard$1(control),characterKeys=_interopRequireWildcard$1(character),functionalKeys=_interopRequireWildcard$1(functional);function _getRequireWildcardCache$1($){if(typeof WeakMap!="function")return null;var j=new WeakMap,it=new WeakMap;return(_getRequireWildcardCache$1=function(et){return et?it:j})($)}function _interopRequireWildcard$1($,j){if(!j&&$&&$.__esModule)return $;if($===null||typeof $!="object"&&typeof $!="function")return{default:$};var it=_getRequireWildcardCache$1(j);if(it&&it.has($))return it.get($);var et={},ut=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var dt in $)if(dt!=="default"&&Object.prototype.hasOwnProperty.call($,dt)){var mt=ut?Object.getOwnPropertyDescriptor($,dt):null;mt&&(mt.get||mt.set)?Object.defineProperty(et,dt,mt):et[dt]=$[dt]}return et.default=$,it&&it.set($,et),et}const replaceBehavior=[{matches:($,j)=>$.key==="selectall"&&(0,_utils$7.isElementType)(j,["input","textarea"]),handle:($,j,it,et)=>{var ut;(0,_utils$7.setSelectionRange)(j,0,((ut=et.carryValue)!=null?ut:j.value).length)}}];plugins$1.replaceBehavior=replaceBehavior;const preKeydownBehavior=[...functionalKeys.preKeydownBehavior];plugins$1.preKeydownBehavior=preKeydownBehavior;const keydownBehavior=[...arrowKeys.keydownBehavior,...controlKeys.keydownBehavior,...functionalKeys.keydownBehavior];plugins$1.keydownBehavior=keydownBehavior;const keypressBehavior=[...functionalKeys.keypressBehavior,...characterKeys.keypressBehavior];plugins$1.keypressBehavior=keypressBehavior;const preKeyupBehavior=[...functionalKeys.preKeyupBehavior];plugins$1.preKeyupBehavior=preKeyupBehavior;const keyupBehavior=[...functionalKeys.keyupBehavior];plugins$1.keyupBehavior=keyupBehavior;const postKeyupBehavior=[...functionalKeys.postKeyupBehavior];plugins$1.postKeyupBehavior=postKeyupBehavior;Object.defineProperty(keyboardImplementation$1,"__esModule",{value:!0});keyboardImplementation$1.keyboardImplementation=keyboardImplementation;keyboardImplementation$1.releaseAllKeys=releaseAllKeys;var _dom$5=require$$0,_utils$6=utils,_getNextKeyDef=getNextKeyDef$1,plugins=_interopRequireWildcard(plugins$1),_getEventProps=getEventProps;function _getRequireWildcardCache($){if(typeof WeakMap!="function")return null;var j=new WeakMap,it=new WeakMap;return(_getRequireWildcardCache=function(et){return et?it:j})($)}function _interopRequireWildcard($,j){if(!j&&$&&$.__esModule)return $;if($===null||typeof $!="object"&&typeof $!="function")return{default:$};var it=_getRequireWildcardCache(j);if(it&&it.has($))return it.get($);var et={},ut=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var dt in $)if(dt!=="default"&&Object.prototype.hasOwnProperty.call($,dt)){var mt=ut?Object.getOwnPropertyDescriptor($,dt):null;mt&&(mt.get||mt.set)?Object.defineProperty(et,dt,mt):et[dt]=$[dt]}return et.default=$,it&&it.set($,et),et}async function keyboardImplementation($,j,it){var et;const{document:ut}=j,dt=()=>getActive(ut),{keyDef:mt,consumedLength:yt,releasePrevious:bt,releaseSelf:Rt,repeat:jt}=(et=it.repeatKey)!=null?et:(0,_getNextKeyDef.getNextKeyDef)($,j);if(!applyPlugins(plugins.replaceBehavior,mt,dt(),j,it)){const zt=it.pressed.find(Jt=>Jt.keyDef===mt);if(zt&&!it.repeatKey&&keyup(mt,dt,j,it,zt.unpreventedDefault),!bt){const Jt=keydown(mt,dt,j,it);Jt&&hasKeyPress(mt,it)&&keypress(mt,dt,j,it),Rt&&jt<=1&&keyup(mt,dt,j,it,Jt)}}if(jt>1?it.repeatKey={consumedLength:0,keyDef:mt,releasePrevious:bt,releaseSelf:Rt,repeat:jt-1}:delete it.repeatKey,$.length>yt||jt>1)return j.delay>0&&await(0,_utils$6.wait)(j.delay),keyboardImplementation($.slice(yt),j,it)}function getActive($){var j;return(j=(0,_utils$6.getActiveElement)($))!=null?j:$.body}function releaseAllKeys($,j){const it=()=>getActive($.document);for(const et of j.pressed)keyup(et.keyDef,it,$,j,et.unpreventedDefault)}function keydown($,j,it,et){const ut=j();ut!==et.activeElement&&(et.carryValue=void 0,et.carryChar=""),et.activeElement=ut,applyPlugins(plugins.preKeydownBehavior,$,ut,it,et);const dt=_dom$5.fireEvent.keyDown(ut,(0,_getEventProps.getKeyEventProps)($,et));return et.pressed.push({keyDef:$,unpreventedDefault:dt}),dt&&applyPlugins(plugins.keydownBehavior,$,j(),it,et),dt}function keypress($,j,it,et){const ut=j();_dom$5.fireEvent.keyPress(ut,(0,_getEventProps.getKeyEventProps)($,et))&&applyPlugins(plugins.keypressBehavior,$,j(),it,et)}function keyup($,j,it,et,ut){const dt=j();applyPlugins(plugins.preKeyupBehavior,$,dt,it,et);const mt=_dom$5.fireEvent.keyUp(dt,(0,_getEventProps.getKeyEventProps)($,et));ut&&mt&&applyPlugins(plugins.keyupBehavior,$,j(),it,et),et.pressed=et.pressed.filter(yt=>yt.keyDef!==$),applyPlugins(plugins.postKeyupBehavior,$,dt,it,et)}function applyPlugins($,j,it,et,ut){const dt=$.find(mt=>mt.matches(j,it,et,ut));return dt&&dt.handle(j,it,et,ut),!!dt}function hasKeyPress($,j){var it;return(((it=$.key)==null?void 0:it.length)===1||$.key==="Enter")&&!j.modifiers.ctrl&&!j.modifiers.alt}var keyMap={},types={};Object.defineProperty(types,"__esModule",{value:!0});types.DOM_KEY_LOCATION=void 0;let DOM_KEY_LOCATION;types.DOM_KEY_LOCATION=DOM_KEY_LOCATION;(function($){$[$.STANDARD=0]="STANDARD",$[$.LEFT=1]="LEFT",$[$.RIGHT=2]="RIGHT",$[$.NUMPAD=3]="NUMPAD"})(DOM_KEY_LOCATION||(types.DOM_KEY_LOCATION=DOM_KEY_LOCATION={}));Object.defineProperty(keyMap,"__esModule",{value:!0});keyMap.defaultKeyMap=void 0;var _types=types;const defaultKeyMap=[..."0123456789".split("").map($=>({code:`Digit${$}`,key:$})),...")!@#$%^&*(".split("").map(($,j)=>({code:`Digit${j}`,key:$,shiftKey:!0})),..."abcdefghijklmnopqrstuvwxyz".split("").map($=>({code:`Key${$.toUpperCase()}`,key:$})),..."ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").map($=>({code:`Key${$}`,key:$,shiftKey:!0})),{code:"Space",key:" "},{code:"AltLeft",key:"Alt",location:_types.DOM_KEY_LOCATION.LEFT,keyCode:18},{code:"AltRight",key:"Alt",location:_types.DOM_KEY_LOCATION.RIGHT,keyCode:18},{code:"ShiftLeft",key:"Shift",location:_types.DOM_KEY_LOCATION.LEFT,keyCode:16},{code:"ShiftRight",key:"Shift",location:_types.DOM_KEY_LOCATION.RIGHT,keyCode:16},{code:"ControlLeft",key:"Control",location:_types.DOM_KEY_LOCATION.LEFT,keyCode:17},{code:"ControlRight",key:"Control",location:_types.DOM_KEY_LOCATION.RIGHT,keyCode:17},{code:"MetaLeft",key:"Meta",location:_types.DOM_KEY_LOCATION.LEFT,keyCode:93},{code:"MetaRight",key:"Meta",location:_types.DOM_KEY_LOCATION.RIGHT,keyCode:93},{code:"OSLeft",key:"OS",location:_types.DOM_KEY_LOCATION.LEFT,keyCode:91},{code:"OSRight",key:"OS",location:_types.DOM_KEY_LOCATION.RIGHT,keyCode:91},{code:"CapsLock",key:"CapsLock",keyCode:20},{code:"Backspace",key:"Backspace",keyCode:8},{code:"Enter",key:"Enter",keyCode:13},{code:"Escape",key:"Escape",keyCode:27},{code:"ArrowUp",key:"ArrowUp",keyCode:38},{code:"ArrowDown",key:"ArrowDown",keyCode:40},{code:"ArrowLeft",key:"ArrowLeft",keyCode:37},{code:"ArrowRight",key:"ArrowRight",keyCode:39},{code:"Home",key:"Home",keyCode:36},{code:"End",key:"End",keyCode:35},{code:"Delete",key:"Delete",keyCode:46},{code:"PageUp",key:"PageUp",keyCode:33},{code:"PageDown",key:"PageDown",keyCode:34}];keyMap.defaultKeyMap=defaultKeyMap;var specialCharMap$1={};Object.defineProperty(specialCharMap$1,"__esModule",{value:!0});specialCharMap$1.specialCharMap=void 0;const specialCharMap={arrowLeft:"{arrowleft}",arrowRight:"{arrowright}",arrowDown:"{arrowdown}",arrowUp:"{arrowup}",enter:"{enter}",escape:"{esc}",delete:"{del}",backspace:"{backspace}",home:"{home}",end:"{end}",selectAll:"{selectall}",space:"{space}",whitespace:" ",pageUp:"{pageUp}",pageDown:"{pageDown}"};specialCharMap$1.specialCharMap=specialCharMap;(function($){Object.defineProperty($,"__esModule",{value:!0}),$.keyboard=dt,$.keyboardImplementationWrapper=mt,Object.defineProperty($,"specialCharMap",{enumerable:!0,get:function(){return ut.specialCharMap}});var j=require$$0,it=keyboardImplementation$1,et=keyMap,ut=specialCharMap$1;function dt(bt,Rt){var jt;const{promise:Vt,state:zt}=mt(bt,Rt);return((jt=Rt==null?void 0:Rt.delay)!=null?jt:0)>0?(0,j.getConfig)().asyncWrapper(()=>Vt.then(()=>zt)):(Vt.catch(console.error),zt)}function mt(bt,Rt={}){const{keyboardState:jt=yt(),delay:Vt=0,document:zt=document,autoModify:Jt=!1,keyboardMap:rr=et.defaultKeyMap}=Rt,Yt={delay:Vt,document:zt,autoModify:Jt,keyboardMap:rr};return{promise:(0,it.keyboardImplementation)(bt,Yt,jt),state:jt,releaseAllKeys:()=>(0,it.releaseAllKeys)(Yt,jt)}}function yt(){return{activeElement:null,pressed:[],carryChar:"",modifiers:{alt:!1,caps:!1,ctrl:!1,meta:!1,shift:!1}}}})(keyboard);Object.defineProperty(typeImplementation$1,"__esModule",{value:!0});typeImplementation$1.typeImplementation=typeImplementation;var _utils$5=utils,_click$2=click$1,_keyboard=keyboard;async function typeImplementation($,j,{delay:it,skipClick:et=!1,skipAutoClose:ut=!1,initialSelectionStart:dt=void 0,initialSelectionEnd:mt=void 0}){if($.disabled)return;et||(0,_click$2.click)($);const yt=()=>(0,_utils$5.getActiveElement)($.ownerDocument),bt=(0,_utils$5.getValue)(yt()),{selectionStart:Rt,selectionEnd:jt}=(0,_utils$5.getSelectionRange)($);bt!=null&&(Rt===null||Rt===0)&&(jt===null||jt===0)&&(0,_utils$5.setSelectionRange)(yt(),dt??bt.length,mt??bt.length);const{promise:Vt,releaseAllKeys:zt}=(0,_keyboard.keyboardImplementationWrapper)(j,{delay:it,document:$.ownerDocument});return it>0&&await Vt,ut||zt(),Vt}Object.defineProperty(type$1,"__esModule",{value:!0});type$1.type=type;var _dom$4=require$$0,_typeImplementation=typeImplementation$1;function type($,j,{delay:it=0,...et}={}){return it>0?(0,_dom$4.getConfig)().asyncWrapper(()=>(0,_typeImplementation.typeImplementation)($,j,{delay:it,...et})):void(0,_typeImplementation.typeImplementation)($,j,{delay:it,...et}).catch(console.error)}var clear$1={};Object.defineProperty(clear$1,"__esModule",{value:!0});clear$1.clear=clear;var _utils$4=utils,_type=type$1;function clear($){var j,it;if(!(0,_utils$4.isElementType)($,["input","textarea"]))throw new Error("clear currently only supports input and textarea elements.");if((0,_utils$4.isDisabled)($))return;const et=$.type;et!=="textarea"&&($.type="text"),(0,_type.type)($,"{selectall}{del}",{delay:0,initialSelectionStart:(j=$.selectionStart)!=null?j:void 0,initialSelectionEnd:(it=$.selectionEnd)!=null?it:void 0}),et!=="textarea"&&($.type=et)}var tab$1={};Object.defineProperty(tab$1,"__esModule",{value:!0});tab$1.tab=tab;var _dom$3=require$$0,_utils$3=utils,_focus$2=focus$1,_blur$1=blur$1;function getNextElement($,j,it,et){if((0,_utils$3.isDocument)(et)&&($===0&&j||$===it.length-1&&!j))return et.body;const ut=j?$-1:$+1,dt=j?it.length-1:0;return it[ut]||it[dt]}function tab({shift:$=!1,focusTrap:j}={}){var it,et;const ut=(it=(et=j)==null?void 0:et.ownerDocument)!=null?it:document,dt=(0,_utils$3.getActiveElement)(ut);j||(j=ut);const mt=j.querySelectorAll(_utils$3.FOCUSABLE_SELECTOR),yt=Array.from(mt).filter(Ft=>Ft===dt||Ft.getAttribute("tabindex")!=="-1"&&!(0,_utils$3.isDisabled)(Ft)&&(0,_utils$3.isVisible)(Ft));if(yt.length===0)return;const bt=yt.map((Ft,Ht)=>({el:Ft,idx:Ht})).sort((Ft,Ht)=>{if(dt&&dt.getAttribute("tabindex")==="-1")return Ft.idx-Ht.idx;const er=Number(Ft.el.getAttribute("tabindex")),pr=Number(Ht.el.getAttribute("tabindex")),or=er-pr;return or===0?Ft.idx-Ht.idx:or}).map(({el:Ft})=>Ft),Rt={};let jt=[];bt.forEach(Ft=>{const Ht=Ft;if(Ht.type==="radio"&&Ht.name){const er=dt;if(er&&er.type===Ht.type&&er.name===Ht.name){Ht===er&&jt.push(Ht);return}if(Ht.checked){jt=jt.filter(pr=>pr.type!==Ht.type||pr.name!==Ht.name),jt.push(Ht),Rt[Ht.name]=Ht;return}if(typeof Rt[Ht.name]<"u")return}jt.push(Ht)});const Vt=jt.findIndex(Ft=>Ft===dt),zt=getNextElement(Vt,$,jt,j),Jt={key:"Shift",keyCode:16,shiftKey:!0},rr={key:"Tab",keyCode:9,shiftKey:$};let Yt=!0;dt&&($&&_dom$3.fireEvent.keyDown(dt,{...Jt}),Yt=_dom$3.fireEvent.keyDown(dt,{...rr}));const dr=!Yt&&dt?dt:zt;Yt&&(zt===ut.body?dt&&(0,_blur$1.blur)(dt):(0,_focus$2.focus)(zt)),_dom$3.fireEvent.keyUp(dr,{...rr}),$&&_dom$3.fireEvent.keyUp(dr,{...Jt,shiftKey:!1})}var upload$1={};Object.defineProperty(upload$1,"__esModule",{value:!0});upload$1.upload=upload;var _dom$2=require$$0,_click$1=click$1,_blur=blur$1,_focus$1=focus$1,_utils$2=utils;function upload($,j,it,{applyAccept:et=!1}={}){var ut;const dt=(0,_utils$2.isElementType)($,"label")?$.control:$;if(!dt||!(0,_utils$2.isElementType)(dt,"input",{type:"file"}))throw new TypeError(`The ${dt===$?"given":"associated"} ${dt==null?void 0:dt.tagName} element does not accept file uploads`);if((0,_utils$2.isDisabled)($))return;(0,_click$1.click)($,it==null?void 0:it.clickInit);const mt=(Array.isArray(j)?j:[j]).filter(bt=>!et||isAcceptableFile(bt,dt.accept)).slice(0,dt.multiple?void 0:1);if((0,_blur.blur)($),(0,_focus$1.focus)($),mt.length===((ut=dt.files)==null?void 0:ut.length)&&mt.every((bt,Rt)=>{var jt;return bt===((jt=dt.files)==null?void 0:jt.item(Rt))}))return;const yt={...mt,length:mt.length,item:bt=>mt[bt],[Symbol.iterator](){let bt=0;return{next:()=>({done:bt>=mt.length,value:mt[bt++]})}}};(0,_dom$2.fireEvent)(dt,(0,_dom$2.createEvent)("input",dt,{target:{files:yt},bubbles:!0,cancelable:!1,composed:!0})),_dom$2.fireEvent.change(dt,{target:{files:yt},...it==null?void 0:it.changeInit})}function isAcceptableFile($,j){if(!j)return!0;const it=["audio/*","image/*","video/*"];return j.split(",").some(et=>et.startsWith(".")?$.name.endsWith(et):it.includes(et)?$.type.startsWith(et.substr(0,et.length-1)):$.type===et)}var selectOptions$1={};Object.defineProperty(selectOptions$1,"__esModule",{value:!0});selectOptions$1.selectOptions=selectOptions$1.deselectOptions=void 0;var _dom$1=require$$0,_utils$1=utils,_click=click$1,_focus=focus$1,_hover=hover$1;function selectOptionsBase($,j,it,et,{skipPointerEventsCheck:ut=!1}={}){if(!$&&!j.multiple)throw(0,_dom$1.getConfig)().getElementError("Unable to deselect an option in a non-multiple select. Use selectOptions to change the selection instead.",j);const dt=Array.isArray(it)?it:[it],mt=Array.from(j.querySelectorAll('option, [role="option"]')),yt=dt.map(Rt=>{if(typeof Rt!="string"&&mt.includes(Rt))return Rt;{const jt=mt.find(Vt=>Vt.value===Rt||Vt.innerHTML===Rt);if(jt)return jt;throw(0,_dom$1.getConfig)().getElementError(`Value "${String(Rt)}" not found in options`,j)}}).filter(Rt=>!(0,_utils$1.isDisabled)(Rt));if((0,_utils$1.isDisabled)(j)||!yt.length)return;if((0,_utils$1.isElementType)(j,"select"))if(j.multiple)for(const Rt of yt){const jt=ut?!0:(0,_utils$1.hasPointerEvents)(Rt);jt&&(_dom$1.fireEvent.pointerOver(Rt,et),_dom$1.fireEvent.pointerEnter(j,et),_dom$1.fireEvent.mouseOver(Rt),_dom$1.fireEvent.mouseEnter(j),_dom$1.fireEvent.pointerMove(Rt,et),_dom$1.fireEvent.mouseMove(Rt,et),_dom$1.fireEvent.pointerDown(Rt,et),_dom$1.fireEvent.mouseDown(Rt,et)),(0,_focus.focus)(j),jt&&(_dom$1.fireEvent.pointerUp(Rt,et),_dom$1.fireEvent.mouseUp(Rt,et)),bt(Rt),jt&&_dom$1.fireEvent.click(Rt,et)}else if(yt.length===1){const Rt=ut?!0:(0,_utils$1.hasPointerEvents)(j);Rt?(0,_click.click)(j,et,{skipPointerEventsCheck:ut}):(0,_focus.focus)(j),bt(yt[0]),Rt&&(_dom$1.fireEvent.pointerOver(j,et),_dom$1.fireEvent.pointerEnter(j,et),_dom$1.fireEvent.mouseOver(j),_dom$1.fireEvent.mouseEnter(j),_dom$1.fireEvent.pointerUp(j,et),_dom$1.fireEvent.mouseUp(j,et),_dom$1.fireEvent.click(j,et))}else throw(0,_dom$1.getConfig)().getElementError("Cannot select multiple options on a non-multiple select",j);else if(j.getAttribute("role")==="listbox")yt.forEach(Rt=>{(0,_hover.hover)(Rt,et,{skipPointerEventsCheck:ut}),(0,_click.click)(Rt,et,{skipPointerEventsCheck:ut}),(0,_hover.unhover)(Rt,et,{skipPointerEventsCheck:ut})});else throw(0,_dom$1.getConfig)().getElementError("Cannot select options on elements that are neither select nor listbox elements",j);function bt(Rt){Rt.selected=$,(0,_dom$1.fireEvent)(j,(0,_dom$1.createEvent)("input",j,{bubbles:!0,cancelable:!1,composed:!0,...et})),_dom$1.fireEvent.change(j,et)}}const selectOptions=selectOptionsBase.bind(null,!0);selectOptions$1.selectOptions=selectOptions;const deselectOptions=selectOptionsBase.bind(null,!1);selectOptions$1.deselectOptions=deselectOptions;var paste$1={};Object.defineProperty(paste$1,"__esModule",{value:!0});paste$1.paste=paste;var _dom=require$$0,_utils=utils;function isSupportedElement($){return(0,_utils.isElementType)($,"input")&&!!_utils.editableInputTypes[$.type]||(0,_utils.isElementType)($,"textarea")}function paste($,j,it,{initialSelectionStart:et,initialSelectionEnd:ut}={}){if(!isSupportedElement($))throw new TypeError(`The given ${$.tagName} element is currently unsupported.
      A PR extending this implementation would be very much welcome at https://github.com/testing-library/user-event`);if((0,_utils.isDisabled)($)||((0,_utils.eventWrapper)(()=>$.focus()),$.selectionStart===0&&$.selectionEnd===0&&(0,_utils.setSelectionRange)($,et??$.value.length,ut??$.value.length),_dom.fireEvent.paste($,it),$.readOnly))return;j=j.substr(0,(0,_utils.getSpaceUntilMaxLength)($));const{newValue:dt,newSelectionStart:mt}=(0,_utils.calculateNewValue)(j,$);_dom.fireEvent.input($,{inputType:"insertFromPaste",target:{value:dt}}),(0,_utils.setSelectionRange)($,{newSelectionStart:mt,selectionEnd:mt},{})}(function($){Object.defineProperty($,"__esModule",{value:!0}),$.default=void 0,Object.defineProperty($,"specialChars",{enumerable:!0,get:function(){return Rt.specialCharMap}});var j=click$1,it=type$1,et=clear$1,ut=tab$1,dt=hover$1,mt=upload$1,yt=selectOptions$1,bt=paste$1,Rt=keyboard,Vt={click:j.click,dblClick:j.dblClick,type:it.type,clear:et.clear,tab:ut.tab,hover:dt.hover,unhover:dt.unhover,upload:mt.upload,selectOptions:yt.selectOptions,deselectOptions:yt.deselectOptions,paste:bt.paste,keyboard:Rt.keyboard};$.default=Vt})(dist);const AnimatedLogo="/assets/logo-animated-fcde50a7.gif";function Loader(){return jsx("div",{className:"loader",children:jsx("img",{src:AnimatedLogo,alt:"apple loader",className:"logo"})})}function App(){const $=reactExports.useRef(),j=reactExports.useRef();return jsxs("div",{className:"App",children:[jsx(Loader,{}),jsxs("div",{ref:j,id:"content",children:[jsx(NavigationBar,{}),jsx(DisplaySection,{triggerPreview:()=>{$.current.triggerPreview()}})]}),jsx(WebGiViewer,{contentRef:j,ref:$})]})}const index="";client.createRoot(document.getElementById("root")).render(jsx(App,{}))});export default ZF();
